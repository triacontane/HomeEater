{"uid":"07DD71F113931300","lastModificationTime":1408754634350,"items":{"name":"Scripts","type":"script_collection","scripts":[{"name":"DataOptimizer","content":"# ===================================================================\n#\n#   Script: DataOptimizer\n#     Created on: 2013-05-19\n#\n# \tCopyright (C) 2013 AndrÃ© Radomski. All rights reserved.\n#\n# ===================================================================\n#\n# \tClass: DataOptimizer\n#\n#   Description...\n#\n# ===================================================================\n\nclass DataOptimizer\n    constructor: ->\n        @documentsByUid = {}\n        @documents = []\n        @documentsLoaded = true\n        \n    arrayToNativeArray: (array) ->\n        result = null\n        length = array.length || Object.keys(array).length\n        if array?\n            if window.ArrayBuffer?\n                result = new ArrayBuffer(length * 2)\n                result = new Int16Array(result)\n            else\n                result = new Array(length)\n           \n            \n            for i in [0...length]\n                result[i] = array[i]\n                \n        return result\n    \n    nativeArray16: (size) ->\n        #result = new ArrayBuffer(size * 2)\n        #result = new Int16Array(result)\n        result = new Array(size)\n        return result\n        \n    nativeArray8: (size) ->\n       # result = new ArrayBuffer(size)\n        #result = new Int8Array(size)\n        result = new Array(size)\n        return result\n        \n    optimizeMap: (map) ->\n        if not map.optimized\n            map.mapData = @arrayToNativeArray(map.mapData)\n            map.optimized = yes\n    \n    optimizeTilesetArray: (tileset, attribute) ->\n        length = tileset[attribute].length || Object.keys(tileset[attribute]).length\n  \n        values = @nativeArray8(length + 384 - 8)\n        value = 0\n        for i in [0...384]\n            value = tileset[attribute][Math.floor(i / 48)]\n            values[i] = value\n            \n        for i in [384...values.length]\n            values[i] = tileset[attribute][i - (384 - 8)]\n \n        tileset[attribute] = values\n        \n    optimizeTileset: (tileset) ->\n        if not tileset.optimized\n            @optimizeTilesetArray(tileset, \"passages\")\n            @optimizeTilesetArray(tileset, \"terrainTags\")        \n            @optimizeTilesetArray(tileset, \"priorities\")\n        \n            tileset.optimized = yes\n        \n        \nwindow.DataOptimizer = new DataOptimizer()","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBEYXRhT3B0aW1pemVyOwoKICBEYXRhT3B0aW1pemVyID0gKGZ1bmN0aW9uKCkgewogICAgZnVuY3Rpb24gRGF0YU9wdGltaXplcigpIHsKICAgICAgdGhpcy5kb2N1bWVudHNCeVVpZCA9IHt9OwogICAgICB0aGlzLmRvY3VtZW50cyA9IFtdOwogICAgICB0aGlzLmRvY3VtZW50c0xvYWRlZCA9IHRydWU7CiAgICB9CgogICAgRGF0YU9wdGltaXplci5wcm90b3R5cGUuYXJyYXlUb05hdGl2ZUFycmF5ID0gZnVuY3Rpb24oYXJyYXkpIHsKICAgICAgdmFyIGksIGxlbmd0aCwgcmVzdWx0LCBfaTsKICAgICAgcmVzdWx0ID0gbnVsbDsKICAgICAgbGVuZ3RoID0gYXJyYXkubGVuZ3RoIHx8IE9iamVjdC5rZXlzKGFycmF5KS5sZW5ndGg7CiAgICAgIGlmIChhcnJheSAhPSBudWxsKSB7CiAgICAgICAgaWYgKHdpbmRvdy5BcnJheUJ1ZmZlciAhPSBudWxsKSB7CiAgICAgICAgICByZXN1bHQgPSBuZXcgQXJyYXlCdWZmZXIobGVuZ3RoICogMik7CiAgICAgICAgICByZXN1bHQgPSBuZXcgSW50MTZBcnJheShyZXN1bHQpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXN1bHQgPSBuZXcgQXJyYXkobGVuZ3RoKTsKICAgICAgICB9CiAgICAgICAgZm9yIChpID0gX2kgPSAwOyAwIDw9IGxlbmd0aCA/IF9pIDwgbGVuZ3RoIDogX2kgPiBsZW5ndGg7IGkgPSAwIDw9IGxlbmd0aCA/ICsrX2kgOiAtLV9pKSB7CiAgICAgICAgICByZXN1bHRbaV0gPSBhcnJheVtpXTsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH07CgogICAgRGF0YU9wdGltaXplci5wcm90b3R5cGUubmF0aXZlQXJyYXkxNiA9IGZ1bmN0aW9uKHNpemUpIHsKICAgICAgdmFyIHJlc3VsdDsKICAgICAgcmVzdWx0ID0gbmV3IEFycmF5KHNpemUpOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfTsKCiAgICBEYXRhT3B0aW1pemVyLnByb3RvdHlwZS5uYXRpdmVBcnJheTggPSBmdW5jdGlvbihzaXplKSB7CiAgICAgIHZhciByZXN1bHQ7CiAgICAgIHJlc3VsdCA9IG5ldyBBcnJheShzaXplKTsKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH07CgogICAgRGF0YU9wdGltaXplci5wcm90b3R5cGUub3B0aW1pemVNYXAgPSBmdW5jdGlvbihtYXApIHsKICAgICAgaWYgKCFtYXAub3B0aW1pemVkKSB7CiAgICAgICAgbWFwLm1hcERhdGEgPSB0aGlzLmFycmF5VG9OYXRpdmVBcnJheShtYXAubWFwRGF0YSk7CiAgICAgICAgcmV0dXJuIG1hcC5vcHRpbWl6ZWQgPSB0cnVlOwogICAgICB9CiAgICB9OwoKICAgIERhdGFPcHRpbWl6ZXIucHJvdG90eXBlLm9wdGltaXplVGlsZXNldEFycmF5ID0gZnVuY3Rpb24odGlsZXNldCwgYXR0cmlidXRlKSB7CiAgICAgIHZhciBpLCBsZW5ndGgsIHZhbHVlLCB2YWx1ZXMsIF9pLCBfaiwgX3JlZjsKICAgICAgbGVuZ3RoID0gdGlsZXNldFthdHRyaWJ1dGVdLmxlbmd0aCB8fCBPYmplY3Qua2V5cyh0aWxlc2V0W2F0dHJpYnV0ZV0pLmxlbmd0aDsKICAgICAgdmFsdWVzID0gdGhpcy5uYXRpdmVBcnJheTgobGVuZ3RoICsgMzg0IC0gOCk7CiAgICAgIHZhbHVlID0gMDsKICAgICAgZm9yIChpID0gX2kgPSAwOyBfaSA8IDM4NDsgaSA9ICsrX2kpIHsKICAgICAgICB2YWx1ZSA9IHRpbGVzZXRbYXR0cmlidXRlXVtNYXRoLmZsb29yKGkgLyA0OCldOwogICAgICAgIHZhbHVlc1tpXSA9IHZhbHVlOwogICAgICB9CiAgICAgIGZvciAoaSA9IF9qID0gMzg0LCBfcmVmID0gdmFsdWVzLmxlbmd0aDsgMzg0IDw9IF9yZWYgPyBfaiA8IF9yZWYgOiBfaiA+IF9yZWY7IGkgPSAzODQgPD0gX3JlZiA/ICsrX2ogOiAtLV9qKSB7CiAgICAgICAgdmFsdWVzW2ldID0gdGlsZXNldFthdHRyaWJ1dGVdW2kgLSAoMzg0IC0gOCldOwogICAgICB9CiAgICAgIHJldHVybiB0aWxlc2V0W2F0dHJpYnV0ZV0gPSB2YWx1ZXM7CiAgICB9OwoKICAgIERhdGFPcHRpbWl6ZXIucHJvdG90eXBlLm9wdGltaXplVGlsZXNldCA9IGZ1bmN0aW9uKHRpbGVzZXQpIHsKICAgICAgaWYgKCF0aWxlc2V0Lm9wdGltaXplZCkgewogICAgICAgIHRoaXMub3B0aW1pemVUaWxlc2V0QXJyYXkodGlsZXNldCwgInBhc3NhZ2VzIik7CiAgICAgICAgdGhpcy5vcHRpbWl6ZVRpbGVzZXRBcnJheSh0aWxlc2V0LCAidGVycmFpblRhZ3MiKTsKICAgICAgICB0aGlzLm9wdGltaXplVGlsZXNldEFycmF5KHRpbGVzZXQsICJwcmlvcml0aWVzIik7CiAgICAgICAgcmV0dXJuIHRpbGVzZXQub3B0aW1pemVkID0gdHJ1ZTsKICAgICAgfQogICAgfTsKCiAgICByZXR1cm4gRGF0YU9wdGltaXplcjsKCiAgfSkoKTsKCiAgd2luZG93LkRhdGFPcHRpbWl6ZXIgPSBuZXcgRGF0YU9wdGltaXplcigpOwoKfSkuY2FsbCh0aGlzKTsK","decoded":true,"editSession":null},{"name":"ResourceLoader","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogUmVzb3VyY2VMb2FkZXIKIyAgICAgQ3JlYXRlZCBvbjogMjAxMy0wNS0xOQojCiMgCUNvcHlyaWdodCAoQykgMjAxMyBBbmRy6SBSYWRvbXNraS4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KIwojIAlDbGFzczogUmVzb3VyY2VMb2FkZXIKIwojICAgQSBoZWxwZXIgdG8gcHJlbG9hZCByZXNvdXJjZXMKIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCmNsYXNzIFJlc291cmNlTG9hZGVyCiAgICBjb25zdHJ1Y3RvcjogLT4KICAgIAogICAgbG9hZEl0ZW1BbmltYXRpb25zOiAoaW52ZW50b3J5KSAtPgogICAgICAgIGZvciBpZCBvZiBpbnZlbnRvcnkuaXRlbXMKICAgICAgICAgICAgaXRlbSA9IGludmVudG9yeS5pdGVtc1tpZF0KICAgICAgICAgICAgaWYgaXRlbSBhbmQgaXRlbS5jb3VudCA+IDAKICAgICAgICAgICAgICAgIEBsb2FkQ29tcGxleEFuaW1hdGlvbihSZWNvcmRNYW5hZ2VyLmFuaW1hdGlvbnNbaXRlbS5pdGVtLmFuaW1hdGlvbklkLTFdKQogICAgICAgIAogICAgbG9hZEFjdG9yQmF0dGxlQW5pbWF0aW9uczogKGFjdG9yKSAtPgogICAgICAgIGlmIGFjdG9yLnN0YW5kQW5pbWF0aW9uPyB0aGVuIEBsb2FkU2ltcGxlQW5pbWF0aW9uKGFjdG9yLnN0YW5kQW5pbWF0aW9uLnJlY29yZCkKICAgICAgICBpZiBhY3Rvci5tYWdpY0FuaW1hdGlvbj8gdGhlbiBAbG9hZFNpbXBsZUFuaW1hdGlvbihhY3Rvci5tYWdpY0FuaW1hdGlvbi5yZWNvcmQpCiAgICAgICAgaWYgYWN0b3IuYXR0YWNrQW5pbWF0aW9uPyB0aGVuIEBsb2FkU2ltcGxlQW5pbWF0aW9uKGFjdG9yLmF0dGFja0FuaW1hdGlvbi5yZWNvcmQpCiAgICAgICAgaWYgYWN0b3IuaXRlbUFuaW1hdGlvbj8gdGhlbiBAbG9hZFNpbXBsZUFuaW1hdGlvbihhY3Rvci5pdGVtQW5pbWF0aW9uLnJlY29yZCkKICAgICAgICBpZiBhY3Rvci5ndWFyZEFuaW1hdGlvbj8gdGhlbiBAbG9hZFNpbXBsZUFuaW1hdGlvbihhY3Rvci5ndWFyZEFuaW1hdGlvbi5yZWNvcmQpCiAgICAgICAgaWYgYWN0b3IucHJlTWFnaWNBbmltYXRpb24/IHRoZW4gQGxvYWRTaW1wbGVBbmltYXRpb24oYWN0b3IucHJlTWFnaWNBbmltYXRpb24ucmVjb3JkKQogICAgICAgIGlmIGFjdG9yLnByZUF0dGFja0FuaW1hdGlvbj8gdGhlbiBAbG9hZFNpbXBsZUFuaW1hdGlvbihhY3Rvci5wcmVBdHRhY2tBbmltYXRpb24ucmVjb3JkKQogICAgICAgIGlmIGFjdG9yLmRhbWFnZUFuaW1hdGlvbj8gdGhlbiBAbG9hZFNpbXBsZUFuaW1hdGlvbihhY3Rvci5kYW1hZ2VBbmltYXRpb24ucmVjb3JkKQogICAgICAgIGlmIGFjdG9yLmRlYXRoQW5pbWF0aW9uPyB0aGVuIEBsb2FkU2ltcGxlQW5pbWF0aW9uKGFjdG9yLmRlYXRoQW5pbWF0aW9uLnJlY29yZCkKICAgICAgICBpZiBhY3Rvci5iYWRTdGF0dXNBbmltYXRpb24/IHRoZW4gQGxvYWRTaW1wbGVBbmltYXRpb24oYWN0b3IuYmFkU3RhdHVzQW5pbWF0aW9uLnJlY29yZCkKICAgICAgICAKICAgIGxvYWRBY3RvclNraWxsQW5pbWF0aW9uczogKGFjdG9yKSAtPgogICAgICAgIGZvciBza2lsbFR5cGUgaW4gYWN0b3Iuc2tpbGxUeXBlcwogICAgICAgICAgICAgICAgaWYgc2tpbGxUeXBlPyBhbmQgYWN0b3Iuc2tpbGxzW3NraWxsVHlwZS5pbmRleF0/CiAgICAgICAgICAgICAgICAgICAgZm9yIHNraWxsIGluIGFjdG9yLnNraWxsc1tza2lsbFR5cGUuaW5kZXhdCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHNraWxsPwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uID0gUmVjb3JkTWFuYWdlci5hbmltYXRpb25zW3NraWxsLmFuaW1hdGlvbklkLTFdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBAbG9hZENvbXBsZXhBbmltYXRpb24oYW5pbWF0aW9uKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uID0gUmVjb3JkTWFuYWdlci5hbmltYXRpb25zW3NraWxsLnVzZXJBbmltYXRpb25JZC0xXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgQGxvYWRDb21wbGV4QW5pbWF0aW9uKGFuaW1hdGlvbikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbiA9IFJlY29yZE1hbmFnZXIuYW5pbWF0aW9uc1tza2lsbC5mb3J3YXJkQW5pbWF0aW9uSWQtMV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBsb2FkU2ltcGxlQW5pbWF0aW9uKGFuaW1hdGlvbikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbiA9IFJlY29yZE1hbmFnZXIuYW5pbWF0aW9uc1tza2lsbC5iYWNrd2FyZEFuaW1hdGlvbklkLTFdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBAbG9hZFNpbXBsZUFuaW1hdGlvbihhbmltYXRpb24pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmltYXRpb24gPSBSZWNvcmRNYW5hZ2VyLmFuaW1hdGlvbnNbc2tpbGwudXNlQW5pbWF0aW9uSWQtMV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBsb2FkU2ltcGxlQW5pbWF0aW9uKGFuaW1hdGlvbikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbiA9IFJlY29yZE1hbmFnZXIuYW5pbWF0aW9uc1tza2lsbC5wcmVwYXJlQW5pbWF0aW9uSWQtMV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBsb2FkU2ltcGxlQW5pbWF0aW9uKGFuaW1hdGlvbikKCiAgICBsb2FkQ29tcGxleEFuaW1hdGlvbjogKGFuaW1hdGlvbikgLT4KICAgICAgICBpZiBhbmltYXRpb24/CiAgICAgICAgICAgIGlmIGFuaW1hdGlvbi5ncmFwaGljMT8KICAgICAgICAgICAgICAgIFJlc291cmNlTWFuYWdlci5nZXRCaXRtYXAoIkdyYXBoaWNzL0FuaW1hdGlvbnMvI3thbmltYXRpb24uZ3JhcGhpYzEubmFtZX0iKQogICAgICAgICAgICBpZiBhbmltYXRpb24uZ3JhcGhpYzI/IGFuZCBhbmltYXRpb24uZ3JhcGhpYzIubmFtZSAhPSAiIgogICAgICAgICAgICAgICAgUmVzb3VyY2VNYW5hZ2VyLmdldEJpdG1hcCgiR3JhcGhpY3MvQW5pbWF0aW9ucy8je2FuaW1hdGlvbi5ncmFwaGljMi5uYW1lfSIpCiAgICBsb2FkU2ltcGxlQW5pbWF0aW9uOiAoYW5pbWF0aW9uKSAtPgogICAgICAgIGlmIGFuaW1hdGlvbj8gYW5kIGFuaW1hdGlvbi5ncmFwaGljPwogICAgICAgICAgICBSZXNvdXJjZU1hbmFnZXIuZ2V0Qml0bWFwKCJHcmFwaGljcy9TaW1wbGVBbmltYXRpb25zLyN7YW5pbWF0aW9uLmdyYXBoaWMubmFtZX0iKQogICAgICAgIAp3aW5kb3cuUmVzb3VyY2VMb2FkZXIgPSBuZXcgUmVzb3VyY2VMb2FkZXIoKQ==","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBSZXNvdXJjZUxvYWRlcjsKCiAgUmVzb3VyY2VMb2FkZXIgPSAoZnVuY3Rpb24oKSB7CiAgICBmdW5jdGlvbiBSZXNvdXJjZUxvYWRlcigpIHt9CgogICAgUmVzb3VyY2VMb2FkZXIucHJvdG90eXBlLmxvYWRJdGVtQW5pbWF0aW9ucyA9IGZ1bmN0aW9uKGludmVudG9yeSkgewogICAgICB2YXIgaWQsIGl0ZW0sIF9yZXN1bHRzOwogICAgICBfcmVzdWx0cyA9IFtdOwogICAgICBmb3IgKGlkIGluIGludmVudG9yeS5pdGVtcykgewogICAgICAgIGl0ZW0gPSBpbnZlbnRvcnkuaXRlbXNbaWRdOwogICAgICAgIGlmIChpdGVtICYmIGl0ZW0uY291bnQgPiAwKSB7CiAgICAgICAgICBfcmVzdWx0cy5wdXNoKHRoaXMubG9hZENvbXBsZXhBbmltYXRpb24oUmVjb3JkTWFuYWdlci5hbmltYXRpb25zW2l0ZW0uaXRlbS5hbmltYXRpb25JZCAtIDFdKSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIF9yZXN1bHRzLnB1c2godm9pZCAwKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIF9yZXN1bHRzOwogICAgfTsKCiAgICBSZXNvdXJjZUxvYWRlci5wcm90b3R5cGUubG9hZEFjdG9yQmF0dGxlQW5pbWF0aW9ucyA9IGZ1bmN0aW9uKGFjdG9yKSB7CiAgICAgIGlmIChhY3Rvci5zdGFuZEFuaW1hdGlvbiAhPSBudWxsKSB7CiAgICAgICAgdGhpcy5sb2FkU2ltcGxlQW5pbWF0aW9uKGFjdG9yLnN0YW5kQW5pbWF0aW9uLnJlY29yZCk7CiAgICAgIH0KICAgICAgaWYgKGFjdG9yLm1hZ2ljQW5pbWF0aW9uICE9IG51bGwpIHsKICAgICAgICB0aGlzLmxvYWRTaW1wbGVBbmltYXRpb24oYWN0b3IubWFnaWNBbmltYXRpb24ucmVjb3JkKTsKICAgICAgfQogICAgICBpZiAoYWN0b3IuYXR0YWNrQW5pbWF0aW9uICE9IG51bGwpIHsKICAgICAgICB0aGlzLmxvYWRTaW1wbGVBbmltYXRpb24oYWN0b3IuYXR0YWNrQW5pbWF0aW9uLnJlY29yZCk7CiAgICAgIH0KICAgICAgaWYgKGFjdG9yLml0ZW1BbmltYXRpb24gIT0gbnVsbCkgewogICAgICAgIHRoaXMubG9hZFNpbXBsZUFuaW1hdGlvbihhY3Rvci5pdGVtQW5pbWF0aW9uLnJlY29yZCk7CiAgICAgIH0KICAgICAgaWYgKGFjdG9yLmd1YXJkQW5pbWF0aW9uICE9IG51bGwpIHsKICAgICAgICB0aGlzLmxvYWRTaW1wbGVBbmltYXRpb24oYWN0b3IuZ3VhcmRBbmltYXRpb24ucmVjb3JkKTsKICAgICAgfQogICAgICBpZiAoYWN0b3IucHJlTWFnaWNBbmltYXRpb24gIT0gbnVsbCkgewogICAgICAgIHRoaXMubG9hZFNpbXBsZUFuaW1hdGlvbihhY3Rvci5wcmVNYWdpY0FuaW1hdGlvbi5yZWNvcmQpOwogICAgICB9CiAgICAgIGlmIChhY3Rvci5wcmVBdHRhY2tBbmltYXRpb24gIT0gbnVsbCkgewogICAgICAgIHRoaXMubG9hZFNpbXBsZUFuaW1hdGlvbihhY3Rvci5wcmVBdHRhY2tBbmltYXRpb24ucmVjb3JkKTsKICAgICAgfQogICAgICBpZiAoYWN0b3IuZGFtYWdlQW5pbWF0aW9uICE9IG51bGwpIHsKICAgICAgICB0aGlzLmxvYWRTaW1wbGVBbmltYXRpb24oYWN0b3IuZGFtYWdlQW5pbWF0aW9uLnJlY29yZCk7CiAgICAgIH0KICAgICAgaWYgKGFjdG9yLmRlYXRoQW5pbWF0aW9uICE9IG51bGwpIHsKICAgICAgICB0aGlzLmxvYWRTaW1wbGVBbmltYXRpb24oYWN0b3IuZGVhdGhBbmltYXRpb24ucmVjb3JkKTsKICAgICAgfQogICAgICBpZiAoYWN0b3IuYmFkU3RhdHVzQW5pbWF0aW9uICE9IG51bGwpIHsKICAgICAgICByZXR1cm4gdGhpcy5sb2FkU2ltcGxlQW5pbWF0aW9uKGFjdG9yLmJhZFN0YXR1c0FuaW1hdGlvbi5yZWNvcmQpOwogICAgICB9CiAgICB9OwoKICAgIFJlc291cmNlTG9hZGVyLnByb3RvdHlwZS5sb2FkQWN0b3JTa2lsbEFuaW1hdGlvbnMgPSBmdW5jdGlvbihhY3RvcikgewogICAgICB2YXIgYW5pbWF0aW9uLCBza2lsbCwgc2tpbGxUeXBlLCBfaSwgX2xlbiwgX3JlZiwgX3Jlc3VsdHM7CiAgICAgIF9yZWYgPSBhY3Rvci5za2lsbFR5cGVzOwogICAgICBfcmVzdWx0cyA9IFtdOwogICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICBza2lsbFR5cGUgPSBfcmVmW19pXTsKICAgICAgICBpZiAoKHNraWxsVHlwZSAhPSBudWxsKSAmJiAoYWN0b3Iuc2tpbGxzW3NraWxsVHlwZS5pbmRleF0gIT0gbnVsbCkpIHsKICAgICAgICAgIF9yZXN1bHRzLnB1c2goKGZ1bmN0aW9uKCkgewogICAgICAgICAgICB2YXIgX2osIF9sZW4xLCBfcmVmMSwgX3Jlc3VsdHMxOwogICAgICAgICAgICBfcmVmMSA9IGFjdG9yLnNraWxsc1tza2lsbFR5cGUuaW5kZXhdOwogICAgICAgICAgICBfcmVzdWx0czEgPSBbXTsKICAgICAgICAgICAgZm9yIChfaiA9IDAsIF9sZW4xID0gX3JlZjEubGVuZ3RoOyBfaiA8IF9sZW4xOyBfaisrKSB7CiAgICAgICAgICAgICAgc2tpbGwgPSBfcmVmMVtfal07CiAgICAgICAgICAgICAgaWYgKHNraWxsICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIGFuaW1hdGlvbiA9IFJlY29yZE1hbmFnZXIuYW5pbWF0aW9uc1tza2lsbC5hbmltYXRpb25JZCAtIDFdOwogICAgICAgICAgICAgICAgdGhpcy5sb2FkQ29tcGxleEFuaW1hdGlvbihhbmltYXRpb24pOwogICAgICAgICAgICAgICAgYW5pbWF0aW9uID0gUmVjb3JkTWFuYWdlci5hbmltYXRpb25zW3NraWxsLnVzZXJBbmltYXRpb25JZCAtIDFdOwogICAgICAgICAgICAgICAgdGhpcy5sb2FkQ29tcGxleEFuaW1hdGlvbihhbmltYXRpb24pOwogICAgICAgICAgICAgICAgYW5pbWF0aW9uID0gUmVjb3JkTWFuYWdlci5hbmltYXRpb25zW3NraWxsLmZvcndhcmRBbmltYXRpb25JZCAtIDFdOwogICAgICAgICAgICAgICAgdGhpcy5sb2FkU2ltcGxlQW5pbWF0aW9uKGFuaW1hdGlvbik7CiAgICAgICAgICAgICAgICBhbmltYXRpb24gPSBSZWNvcmRNYW5hZ2VyLmFuaW1hdGlvbnNbc2tpbGwuYmFja3dhcmRBbmltYXRpb25JZCAtIDFdOwogICAgICAgICAgICAgICAgdGhpcy5sb2FkU2ltcGxlQW5pbWF0aW9uKGFuaW1hdGlvbik7CiAgICAgICAgICAgICAgICBhbmltYXRpb24gPSBSZWNvcmRNYW5hZ2VyLmFuaW1hdGlvbnNbc2tpbGwudXNlQW5pbWF0aW9uSWQgLSAxXTsKICAgICAgICAgICAgICAgIHRoaXMubG9hZFNpbXBsZUFuaW1hdGlvbihhbmltYXRpb24pOwogICAgICAgICAgICAgICAgYW5pbWF0aW9uID0gUmVjb3JkTWFuYWdlci5hbmltYXRpb25zW3NraWxsLnByZXBhcmVBbmltYXRpb25JZCAtIDFdOwogICAgICAgICAgICAgICAgX3Jlc3VsdHMxLnB1c2godGhpcy5sb2FkU2ltcGxlQW5pbWF0aW9uKGFuaW1hdGlvbikpOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBfcmVzdWx0czEucHVzaCh2b2lkIDApOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gX3Jlc3VsdHMxOwogICAgICAgICAgfSkuY2FsbCh0aGlzKSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIF9yZXN1bHRzLnB1c2godm9pZCAwKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIF9yZXN1bHRzOwogICAgfTsKCiAgICBSZXNvdXJjZUxvYWRlci5wcm90b3R5cGUubG9hZENvbXBsZXhBbmltYXRpb24gPSBmdW5jdGlvbihhbmltYXRpb24pIHsKICAgICAgaWYgKGFuaW1hdGlvbiAhPSBudWxsKSB7CiAgICAgICAgaWYgKGFuaW1hdGlvbi5ncmFwaGljMSAhPSBudWxsKSB7CiAgICAgICAgICBSZXNvdXJjZU1hbmFnZXIuZ2V0Qml0bWFwKCJHcmFwaGljcy9BbmltYXRpb25zLyIgKyBhbmltYXRpb24uZ3JhcGhpYzEubmFtZSk7CiAgICAgICAgfQogICAgICAgIGlmICgoYW5pbWF0aW9uLmdyYXBoaWMyICE9IG51bGwpICYmIGFuaW1hdGlvbi5ncmFwaGljMi5uYW1lICE9PSAiIikgewogICAgICAgICAgcmV0dXJuIFJlc291cmNlTWFuYWdlci5nZXRCaXRtYXAoIkdyYXBoaWNzL0FuaW1hdGlvbnMvIiArIGFuaW1hdGlvbi5ncmFwaGljMi5uYW1lKTsKICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgUmVzb3VyY2VMb2FkZXIucHJvdG90eXBlLmxvYWRTaW1wbGVBbmltYXRpb24gPSBmdW5jdGlvbihhbmltYXRpb24pIHsKICAgICAgaWYgKChhbmltYXRpb24gIT0gbnVsbCkgJiYgKGFuaW1hdGlvbi5ncmFwaGljICE9IG51bGwpKSB7CiAgICAgICAgcmV0dXJuIFJlc291cmNlTWFuYWdlci5nZXRCaXRtYXAoIkdyYXBoaWNzL1NpbXBsZUFuaW1hdGlvbnMvIiArIGFuaW1hdGlvbi5ncmFwaGljLm5hbWUpOwogICAgICB9CiAgICB9OwoKICAgIHJldHVybiBSZXNvdXJjZUxvYWRlcjsKCiAgfSkoKTsKCiAgd2luZG93LlJlc291cmNlTG9hZGVyID0gbmV3IFJlc291cmNlTG9hZGVyKCk7Cgp9KS5jYWxsKHRoaXMpOwo="},{"name":"Scene","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgICBGaWxlOiBTY2VuZS5jb2ZmZWUKIyAJQ3JlYXRlZCBvbjogMjAxMy0wNS0xOQojCiMgCUNvcHlyaWdodCAoQykgMjAxMyBBbmRy6SBSYWRvbXNraS4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KIwojIAlDbGFzczogU2NlbmUKIwojICAgRGVzY3JpcHRpb24uLi4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCmNsYXNzIFNjZW5lCiAgY29uc3RydWN0b3I6IC0+CgogIGluaXRpYWxpemU6IC0+CgogIGRpc3Bvc2U6IC0+CgogIGxvYWRpbmc6IC0+CiAgICAjIFRPRE86IERpc3BsYXkgbG9hZGluZyBzY3JlZW4KICBwcmVwYXJlOiAtPiAjIFRPRE86IFNvbWUgc3R1ZmYgYWZ0ZXIgbG9hZGluZwoKICB1cGRhdGU6IC0+CiAgICBJbnB1dC51cGRhdGUoKQogICAgR3JhcGhpY3MudXBkYXRlKCkKCndpbmRvdy5TY2VuZSA9IFNjZW5lCg==","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBTY2VuZTsKCiAgU2NlbmUgPSAoZnVuY3Rpb24oKSB7CiAgICBmdW5jdGlvbiBTY2VuZSgpIHt9CgogICAgU2NlbmUucHJvdG90eXBlLmluaXRpYWxpemUgPSBmdW5jdGlvbigpIHt9OwoKICAgIFNjZW5lLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24oKSB7fTsKCiAgICBTY2VuZS5wcm90b3R5cGUubG9hZGluZyA9IGZ1bmN0aW9uKCkge307CgogICAgU2NlbmUucHJvdG90eXBlLnByZXBhcmUgPSBmdW5jdGlvbigpIHt9OwoKICAgIFNjZW5lLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpIHsKICAgICAgSW5wdXQudXBkYXRlKCk7CiAgICAgIHJldHVybiBHcmFwaGljcy51cGRhdGUoKTsKICAgIH07CgogICAgcmV0dXJuIFNjZW5lOwoKICB9KSgpOwoKICB3aW5kb3cuU2NlbmUgPSBTY2VuZTsKCn0pLmNhbGwodGhpcyk7Cg=="},{"name":"ResourceManager","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIEZpbGU6IFJlc291cmNlTWFuYWdlci5jb2ZmZWUKIyAJQ3JlYXRlZCBvbjogMjAxMy0wNS0xOQojCiMgCUNvcHlyaWdodCAoQykgMjAxMyBBbmRy6SBSYWRvbXNraS4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KIwojIAlDbGFzczogUmVzb3VyY2VNYW5hZ2VyCiMKIyAgIERlc2NyaXB0aW9uLi4uCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpjbGFzcyBSZXNvdXJjZU1hbmFnZXIKICBjb25zdHJ1Y3RvcjogLT4KICAgIEBjdXN0b21CaXRtYXBzQnlLZXkgPSB7fQogICAgQHJlc291cmNlc0J5UGF0aCA9IHt9CiAgICBAcmVzb3VyY2VzQnlQYXRoSHVlID0ge30KICAgIEByZXNvdXJjZXMgPSBbXQogICAgQHJlc291cmNlc0xvYWRlZCA9IHRydWUKCiAgbG9hZEZvbnRzOiAtPgogICAgcmVzb3VyY2UgPSB7IGxvYWRlZDogbm8gfQogICAgQHJlc291cmNlcy5wdXNoKHJlc291cmNlKQogICAgQHJlc291cmNlc0J5UGF0aFsiR3JhcGhpY3MvRm9udHMiXSA9IHJlc291cmNlCiAgICAKICAgIHVybCA9ICIiCiAgICBmYW1pbGllcyA9IFtdCiAgICAKICAgIGlmICRQQVJBTVMudGVzdD8KICAgICAgICB1cmwgPSAnL2ludm9rZT9jb250cm9sbGVyPWdzLlJlc291cmNlQ29udHJvbGxlciZtZXRob2Q9bG9hZEZvbnRzU3R5bGVzaGVldCcKICAgICAgICBmYW1pbGllcyA9ICRQQVJBTVMuZm9udEZhbWlsaWVzCiAgICBlbHNlCiAgICAgICAgdXJsID0gJ3Jlc291cmNlcy9mb250cy5jc3MnCiAgICAgICAgcmVzb3VyY2VzID0gR1MuZGF0YUNhY2hlWyJSRVNPVVJDRVMiXS5pdGVtcy5yZXNvdXJjZXMKICAgICAgIAogICAgICAgIGZvciBwYXRoIG9mIHJlc291cmNlcwogICAgICAgICAgICBpZiBwYXRoLnN0YXJ0c1dpdGgoIkdyYXBoaWNzL0ZvbnRzLyIpCiAgICAgICAgICAgICAgICBwYXJ0cyA9IHBhdGguc3BsaXQoIi8iKQogICAgICAgICAgICAgICAgZmFtaWxpZXMucHVzaChwYXJ0c1twYXJ0cy5sZW5ndGgtMV0pCiAgICAgICAKICAgICAgICAKICAgIFdlYkZvbnQubG9hZCh7CiAgICAgICAgICAgIGN1c3RvbTogeyAKICAgICAgICAgICAgICAgIGZhbWlsaWVzOiBmYW1pbGllcywKICAgICAgICAgICAgICAgIHVybHM6IFt1cmxdIH0sCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgYWN0aXZlOiA9PiAKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJsb2FkZWQiKQogICAgICAgICAgICAgICAgQHJlc291cmNlc0J5UGF0aFsiR3JhcGhpY3MvRm9udHMiXS5sb2FkZWQgPSB5ZXMKICAgICAgICB9KQogICAgICAgIAogIGdldEN1c3RvbUJpdG1hcDogKGtleSkgLT4KICAgIHJldHVybiBAY3VzdG9tQml0bWFwc0J5S2V5W2tleV0KICBzZXRDdXN0b21CaXRtYXA6IChrZXksIGJpdG1hcCkgLT4KICAgIEBjdXN0b21CaXRtYXBzQnlLZXlba2V5XSA9IGJpdG1hcAoKICBnZXRGb250OiAobmFtZSwgc2l6ZSkgLT4KICAgICAgcmVzdWx0ID0gbmV3IEZvbnQobmFtZSwgc2l6ZSkKICAgICAgCiAgICAgIEByZXNvdXJjZXMucHVzaChyZXN1bHQpCiAgICAgIEByZXNvdXJjZXNMb2FkZWQgPSBmYWxzZQogICAgICAKICAgICAgcmV0dXJuIHJlc3VsdAogIGdldEJpdG1hcDogKGZpbGVQYXRoLCBodWUsIG9wYWNpdHksIGJsZW5kaW5nLCB0b25lKSAtPgogICAgaWYgZmlsZVBhdGguZW5kc1dpdGgoIi8iKSB0aGVuIHJldHVybiBudWxsCgogICAgaHVlID0gaHVlIHx8IDAKICAgIHJlc3VsdCA9IEByZXNvdXJjZXNCeVBhdGhbZmlsZVBhdGhdCgogICAgaWYgbm90IHJlc3VsdD8KICAgICAgcHJvZmlsZSA9IExhbmd1YWdlTWFuYWdlci5wcm9maWxlCiAgICAgIHJlc3VsdCA9IG5ldyBCaXRtYXAoZmlsZVBhdGgsIChpZiBwcm9maWxlPyBhbmQgcHJvZmlsZS5pdGVtcz8gdGhlbiBwcm9maWxlLml0ZW1zLmNvZGUgZWxzZSBudWxsKSkKICAgICAgcmVzdWx0Lmh1ZSA9IFtodWVdCiAgICAgIHJlc3VsdC5maWxlUGF0aCA9IGZpbGVQYXRoCiAgICAgIEByZXNvdXJjZXNCeVBhdGhbZmlsZVBhdGhdID0gcmVzdWx0CiAgICAgIEByZXNvdXJjZXMucHVzaChyZXN1bHQpCiAgICAgIEByZXNvdXJjZXNMb2FkZWQgPSBmYWxzZQogICAgZWxzZSBpZiBub3QgcmVzdWx0LmxvYWRlZCBhbmQgcmVzdWx0Lmh1ZSAhPSBodWUKICAgICAgcHJvZmlsZSA9IExhbmd1YWdlTWFuYWdlci5wcm9maWxlCiAgICAgIHJlc3VsdCA9IG5ldyBCaXRtYXAoZmlsZVBhdGgsIChpZiBwcm9maWxlPyBhbmQgcHJvZmlsZS5pdGVtcz8gdGhlbiBwcm9maWxlLml0ZW1zLmNvZGUgZWxzZSBudWxsKSkKICAgICAgcmVzdWx0Lmh1ZSA9IGh1ZQogICAgICByZXN1bHQuZmlsZVBhdGggPSBmaWxlUGF0aAogICAgICBAcmVzb3VyY2VzLnB1c2gocmVzdWx0KQogICAgICBAcmVzb3VyY2VzTG9hZGVkID0gZmFsc2UgIAogICAgZWxzZSBpZiBodWUgPiAwCiAgICAgIGh1ZUJpdG1hcCA9IEByZXNvdXJjZXNCeVBhdGhIdWVbZmlsZVBhdGgrIkAiK2h1ZV0KICAgICAgaWYgbm90IGh1ZUJpdG1hcD8KICAgICAgICBodWVCaXRtYXAgPSBuZXcgQml0bWFwKHJlc3VsdC5pbWFnZSkKICAgICAgICBodWVCaXRtYXAuY2hhbmdlSHVlKGh1ZSkKICAgICAgICBAcmVzb3VyY2VzQnlQYXRoSHVlW2ZpbGVQYXRoKyJAIitodWVdID0gaHVlQml0bWFwCiAgICAgIHJlc3VsdCA9IGh1ZUJpdG1hcAogICAgICAKICAgICAgICAKCiAgICByZXR1cm4gcmVzdWx0CgogIGdldEltYWdlOiAoZmlsZVBhdGgpIC0+CiAgICByZXN1bHQgPSBAcmVzb3VyY2VzQnlQYXRoW2ZpbGVQYXRoXQoKICAgIGlmIG5vdCByZXN1bHQ/CiAgICAgIGlmICRQQVJBTVM/IGFuZCAkUEFSQU1TLnRlc3Q/CiAgICAgICAgcmVzdWx0ID0gbmV3IEJpdG1hcCgnL2ludm9rZT9jb250cm9sbGVyPWdzLlJlc291cmNlQ29udHJvbGxlciZtZXRob2Q9bG9hZEdyYXBoaWNSZXNvdXJjZSYnICsgJC5wYXJhbSgKICAgICAgICAgIGRhdGE6CiAgICAgICAgICAgIHJlc291cmNlOgogICAgICAgICAgICAgIHBhdGg6IGZpbGVQYXRoCiAgICAgICAgICAgIHN1cHBvcnRlZEZvcm1hdHM6IFsicG5nIiwgImpwZyJdCiAgICAgICAgKSkKICAgICAgZWxzZQogICAgICAgIHJlc3VsdCA9IG5ldyBCaXRtYXAoInJlc291cmNlcy8je2ZpbGVQYXRofS5wbmciKTsKCiAgICAgIEByZXNvdXJjZXNCeVBhdGhbZmlsZVBhdGhdID0gcmVzdWx0CiAgICAgIEByZXNvdXJjZXMucHVzaChyZXN1bHQpCiAgICAgIEByZXNvdXJjZXNMb2FkZWQgPSBmYWxzZQoKICAgIHJldHVybiByZXN1bHQKCiAgZ2V0QXVkaW9CdWZmZXI6IChmaWxlUGF0aCkgLT4KICAgIHJlc3VsdCA9IEByZXNvdXJjZXNCeVBhdGhbZmlsZVBhdGhdCiAgICBwcm9maWxlID0gTGFuZ3VhZ2VNYW5hZ2VyLnByb2ZpbGUKICAgIGxhbmd1YWdlQ29kZSA9IGlmIHByb2ZpbGU/IGFuZCBwcm9maWxlLml0ZW1zPyB0aGVuIHByb2ZpbGUuaXRlbXMuY29kZSBlbHNlIG51bGwKICAgIAogICAgaWYgbm90IHJlc3VsdD8KICAgICAgaWYgJFBBUkFNUz8gYW5kICRQQVJBTVMudGVzdD8KICAgICAgICByZXN1bHQgPSBuZXcgR1MuQXVkaW9CdWZmZXIoJy9pbnZva2U/Y29udHJvbGxlcj1ncy5SZXNvdXJjZUNvbnRyb2xsZXImbWV0aG9kPWxvYWRBdWRpb1Jlc291cmNlJicgKyAkLnBhcmFtKAogICAgICAgICAgZGF0YToKICAgICAgICAgICAgcmVzb3VyY2U6CiAgICAgICAgICAgICAgcGF0aDogZmlsZVBhdGgKICAgICAgICAgICAgc3VwcG9ydGVkRm9ybWF0czogWyJhYWMiLCAib2dnIiwgIndhdiJdCiAgICAgICAgICAgIGxhbmd1YWdlQ29kZTogbGFuZ3VhZ2VDb2RlCiAgICAgICAgKSkKICAgICAgZWxzZQogICAgICAgIHJlc291cmNlcyA9IEdTLmRhdGFDYWNoZVsiUkVTT1VSQ0VTIl0uaXRlbXMucmVzb3VyY2VzCiAgICAgICAgZmlsZVBhdGhMQyA9IGZpbGVQYXRoICsgIl8iICsgbGFuZ3VhZ2VDb2RlCiAgICAgICAgaWYgcmVzb3VyY2VzW2ZpbGVQYXRoTENdCiAgICAgICAgICAgIGV4dCA9IHJlc291cmNlc1tmaWxlUGF0aExDXSB8fCAiLndhdiI7CiAgICAgICAgICAgIHJlc3VsdCA9IG5ldyBHUy5BdWRpb0J1ZmZlcigicmVzb3VyY2VzLyN7ZmlsZVBhdGhMQ30je2V4dH0iKTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIGV4dCA9IHJlc291cmNlc1tmaWxlUGF0aF0gfHwgIi53YXYiOwogICAgICAgICAgICByZXN1bHQgPSBuZXcgR1MuQXVkaW9CdWZmZXIoInJlc291cmNlcy8je2ZpbGVQYXRofSN7ZXh0fSIpOwogICAgICAgICAgICAKICAgICAgQHJlc291cmNlc0J5UGF0aFtmaWxlUGF0aF0gPSByZXN1bHQKICAgICAgQHJlc291cmNlcy5wdXNoKHJlc3VsdCkKICAgICAgQHJlc291cmNlc0xvYWRlZCA9IGZhbHNlCgogICAgcmV0dXJuIHJlc3VsdAoKICB1cGRhdGU6IC0+CiAgICBpZiBub3QgQHJlc291cmNlc0xvYWRlZAogICAgICBAcmVzb3VyY2VzTG9hZGVkID0gdHJ1ZQogICAgICBmb3IgaSBpbiBbMC4uLkByZXNvdXJjZXMubGVuZ3RoXQogICAgICAgIGlmIG5vdCBAcmVzb3VyY2VzW2ldLmxvYWRlZAogICAgICAgICAgQHJlc291cmNlc0xvYWRlZCA9IGZhbHNlCiAgICAgICAgICBicmVhawogICAgICAgIGVsc2UgaWYgQHJlc291cmNlc1tpXS5odWU/IGFuZCBAcmVzb3VyY2VzW2ldLmh1ZSA+IDAKICAgICAgICAgIGJpdG1hcCA9IG5ldyBCaXRtYXAoQHJlc291cmNlc1tpXS5pbWFnZSkKICAgICAgICAgIAogICAgICAgICAgQHJlc291cmNlc0J5UGF0aFtAcmVzb3VyY2VzW2ldLmZpbGVQYXRoXSA9IGJpdG1hcAogICAgICAgICAgQHJlc291cmNlc1tpXS5jaGFuZ2VIdWUoQHJlc291cmNlc1tpXS5odWUpCiAgICAgICAgICBAcmVzb3VyY2VzQnlQYXRoSHVlW0ByZXNvdXJjZXNbaV0uZmlsZVBhdGgrIkAiK0ByZXNvdXJjZXNbaV0uaHVlXSA9IEByZXNvdXJjZXNbaV0KICAgICAgICAgIGRlbGV0ZSBAcmVzb3VyY2VzW2ldLmZpbGVQYXRoCiAgICAgICAgICBkZWxldGUgQHJlc291cmNlc1tpXS5odWUKCiAgICByZXR1cm4gbnVsbAoKd2luZG93LlJlc291cmNlTWFuYWdlciA9IG5ldyBSZXNvdXJjZU1hbmFnZXIoKQ==","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBSZXNvdXJjZU1hbmFnZXI7CgogIFJlc291cmNlTWFuYWdlciA9IChmdW5jdGlvbigpIHsKICAgIGZ1bmN0aW9uIFJlc291cmNlTWFuYWdlcigpIHsKICAgICAgdGhpcy5jdXN0b21CaXRtYXBzQnlLZXkgPSB7fTsKICAgICAgdGhpcy5yZXNvdXJjZXNCeVBhdGggPSB7fTsKICAgICAgdGhpcy5yZXNvdXJjZXNCeVBhdGhIdWUgPSB7fTsKICAgICAgdGhpcy5yZXNvdXJjZXMgPSBbXTsKICAgICAgdGhpcy5yZXNvdXJjZXNMb2FkZWQgPSB0cnVlOwogICAgfQoKICAgIFJlc291cmNlTWFuYWdlci5wcm90b3R5cGUubG9hZEZvbnRzID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBmYW1pbGllcywgcGFydHMsIHBhdGgsIHJlc291cmNlLCByZXNvdXJjZXMsIHVybCwKICAgICAgICBfdGhpcyA9IHRoaXM7CiAgICAgIHJlc291cmNlID0gewogICAgICAgIGxvYWRlZDogZmFsc2UKICAgICAgfTsKICAgICAgdGhpcy5yZXNvdXJjZXMucHVzaChyZXNvdXJjZSk7CiAgICAgIHRoaXMucmVzb3VyY2VzQnlQYXRoWyJHcmFwaGljcy9Gb250cyJdID0gcmVzb3VyY2U7CiAgICAgIHVybCA9ICIiOwogICAgICBmYW1pbGllcyA9IFtdOwogICAgICBpZiAoJFBBUkFNUy50ZXN0ICE9IG51bGwpIHsKICAgICAgICB1cmwgPSAnL2ludm9rZT9jb250cm9sbGVyPWdzLlJlc291cmNlQ29udHJvbGxlciZtZXRob2Q9bG9hZEZvbnRzU3R5bGVzaGVldCc7CiAgICAgICAgZmFtaWxpZXMgPSAkUEFSQU1TLmZvbnRGYW1pbGllczsKICAgICAgfSBlbHNlIHsKICAgICAgICB1cmwgPSAncmVzb3VyY2VzL2ZvbnRzLmNzcyc7CiAgICAgICAgcmVzb3VyY2VzID0gR1MuZGF0YUNhY2hlWyJSRVNPVVJDRVMiXS5pdGVtcy5yZXNvdXJjZXM7CiAgICAgICAgZm9yIChwYXRoIGluIHJlc291cmNlcykgewogICAgICAgICAgaWYgKHBhdGguc3RhcnRzV2l0aCgiR3JhcGhpY3MvRm9udHMvIikpIHsKICAgICAgICAgICAgcGFydHMgPSBwYXRoLnNwbGl0KCIvIik7CiAgICAgICAgICAgIGZhbWlsaWVzLnB1c2gocGFydHNbcGFydHMubGVuZ3RoIC0gMV0pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gV2ViRm9udC5sb2FkKHsKICAgICAgICBjdXN0b206IHsKICAgICAgICAgIGZhbWlsaWVzOiBmYW1pbGllcywKICAgICAgICAgIHVybHM6IFt1cmxdCiAgICAgICAgfSwKICAgICAgICBhY3RpdmU6IGZ1bmN0aW9uKCkgewogICAgICAgICAgY29uc29sZS5sb2coImxvYWRlZCIpOwogICAgICAgICAgcmV0dXJuIF90aGlzLnJlc291cmNlc0J5UGF0aFsiR3JhcGhpY3MvRm9udHMiXS5sb2FkZWQgPSB0cnVlOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9OwoKICAgIFJlc291cmNlTWFuYWdlci5wcm90b3R5cGUuZ2V0Q3VzdG9tQml0bWFwID0gZnVuY3Rpb24oa2V5KSB7CiAgICAgIHJldHVybiB0aGlzLmN1c3RvbUJpdG1hcHNCeUtleVtrZXldOwogICAgfTsKCiAgICBSZXNvdXJjZU1hbmFnZXIucHJvdG90eXBlLnNldEN1c3RvbUJpdG1hcCA9IGZ1bmN0aW9uKGtleSwgYml0bWFwKSB7CiAgICAgIHJldHVybiB0aGlzLmN1c3RvbUJpdG1hcHNCeUtleVtrZXldID0gYml0bWFwOwogICAgfTsKCiAgICBSZXNvdXJjZU1hbmFnZXIucHJvdG90eXBlLmdldEZvbnQgPSBmdW5jdGlvbihuYW1lLCBzaXplKSB7CiAgICAgIHZhciByZXN1bHQ7CiAgICAgIHJlc3VsdCA9IG5ldyBGb250KG5hbWUsIHNpemUpOwogICAgICB0aGlzLnJlc291cmNlcy5wdXNoKHJlc3VsdCk7CiAgICAgIHRoaXMucmVzb3VyY2VzTG9hZGVkID0gZmFsc2U7CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9OwoKICAgIFJlc291cmNlTWFuYWdlci5wcm90b3R5cGUuZ2V0Qml0bWFwID0gZnVuY3Rpb24oZmlsZVBhdGgsIGh1ZSwgb3BhY2l0eSwgYmxlbmRpbmcsIHRvbmUpIHsKICAgICAgdmFyIGh1ZUJpdG1hcCwgcHJvZmlsZSwgcmVzdWx0OwogICAgICBpZiAoZmlsZVBhdGguZW5kc1dpdGgoIi8iKSkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CiAgICAgIGh1ZSA9IGh1ZSB8fCAwOwogICAgICByZXN1bHQgPSB0aGlzLnJlc291cmNlc0J5UGF0aFtmaWxlUGF0aF07CiAgICAgIGlmIChyZXN1bHQgPT0gbnVsbCkgewogICAgICAgIHByb2ZpbGUgPSBMYW5ndWFnZU1hbmFnZXIucHJvZmlsZTsKICAgICAgICByZXN1bHQgPSBuZXcgQml0bWFwKGZpbGVQYXRoLCAoKHByb2ZpbGUgIT0gbnVsbCkgJiYgKHByb2ZpbGUuaXRlbXMgIT0gbnVsbCkgPyBwcm9maWxlLml0ZW1zLmNvZGUgOiBudWxsKSk7CiAgICAgICAgcmVzdWx0Lmh1ZSA9IFtodWVdOwogICAgICAgIHJlc3VsdC5maWxlUGF0aCA9IGZpbGVQYXRoOwogICAgICAgIHRoaXMucmVzb3VyY2VzQnlQYXRoW2ZpbGVQYXRoXSA9IHJlc3VsdDsKICAgICAgICB0aGlzLnJlc291cmNlcy5wdXNoKHJlc3VsdCk7CiAgICAgICAgdGhpcy5yZXNvdXJjZXNMb2FkZWQgPSBmYWxzZTsKICAgICAgfSBlbHNlIGlmICghcmVzdWx0LmxvYWRlZCAmJiByZXN1bHQuaHVlICE9PSBodWUpIHsKICAgICAgICBwcm9maWxlID0gTGFuZ3VhZ2VNYW5hZ2VyLnByb2ZpbGU7CiAgICAgICAgcmVzdWx0ID0gbmV3IEJpdG1hcChmaWxlUGF0aCwgKChwcm9maWxlICE9IG51bGwpICYmIChwcm9maWxlLml0ZW1zICE9IG51bGwpID8gcHJvZmlsZS5pdGVtcy5jb2RlIDogbnVsbCkpOwogICAgICAgIHJlc3VsdC5odWUgPSBodWU7CiAgICAgICAgcmVzdWx0LmZpbGVQYXRoID0gZmlsZVBhdGg7CiAgICAgICAgdGhpcy5yZXNvdXJjZXMucHVzaChyZXN1bHQpOwogICAgICAgIHRoaXMucmVzb3VyY2VzTG9hZGVkID0gZmFsc2U7CiAgICAgIH0gZWxzZSBpZiAoaHVlID4gMCkgewogICAgICAgIGh1ZUJpdG1hcCA9IHRoaXMucmVzb3VyY2VzQnlQYXRoSHVlW2ZpbGVQYXRoICsgIkAiICsgaHVlXTsKICAgICAgICBpZiAoaHVlQml0bWFwID09IG51bGwpIHsKICAgICAgICAgIGh1ZUJpdG1hcCA9IG5ldyBCaXRtYXAocmVzdWx0LmltYWdlKTsKICAgICAgICAgIGh1ZUJpdG1hcC5jaGFuZ2VIdWUoaHVlKTsKICAgICAgICAgIHRoaXMucmVzb3VyY2VzQnlQYXRoSHVlW2ZpbGVQYXRoICsgIkAiICsgaHVlXSA9IGh1ZUJpdG1hcDsKICAgICAgICB9CiAgICAgICAgcmVzdWx0ID0gaHVlQml0bWFwOwogICAgICB9CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9OwoKICAgIFJlc291cmNlTWFuYWdlci5wcm90b3R5cGUuZ2V0SW1hZ2UgPSBmdW5jdGlvbihmaWxlUGF0aCkgewogICAgICB2YXIgcmVzdWx0OwogICAgICByZXN1bHQgPSB0aGlzLnJlc291cmNlc0J5UGF0aFtmaWxlUGF0aF07CiAgICAgIGlmIChyZXN1bHQgPT0gbnVsbCkgewogICAgICAgIGlmICgodHlwZW9mICRQQVJBTVMgIT09ICJ1bmRlZmluZWQiICYmICRQQVJBTVMgIT09IG51bGwpICYmICgkUEFSQU1TLnRlc3QgIT0gbnVsbCkpIHsKICAgICAgICAgIHJlc3VsdCA9IG5ldyBCaXRtYXAoJy9pbnZva2U/Y29udHJvbGxlcj1ncy5SZXNvdXJjZUNvbnRyb2xsZXImbWV0aG9kPWxvYWRHcmFwaGljUmVzb3VyY2UmJyArICQucGFyYW0oewogICAgICAgICAgICBkYXRhOiB7CiAgICAgICAgICAgICAgcmVzb3VyY2U6IHsKICAgICAgICAgICAgICAgIHBhdGg6IGZpbGVQYXRoCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBzdXBwb3J0ZWRGb3JtYXRzOiBbInBuZyIsICJqcGciXQogICAgICAgICAgICB9CiAgICAgICAgICB9KSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJlc3VsdCA9IG5ldyBCaXRtYXAoInJlc291cmNlcy8iICsgZmlsZVBhdGggKyAiLnBuZyIpOwogICAgICAgIH0KICAgICAgICB0aGlzLnJlc291cmNlc0J5UGF0aFtmaWxlUGF0aF0gPSByZXN1bHQ7CiAgICAgICAgdGhpcy5yZXNvdXJjZXMucHVzaChyZXN1bHQpOwogICAgICAgIHRoaXMucmVzb3VyY2VzTG9hZGVkID0gZmFsc2U7CiAgICAgIH0KICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH07CgogICAgUmVzb3VyY2VNYW5hZ2VyLnByb3RvdHlwZS5nZXRBdWRpb0J1ZmZlciA9IGZ1bmN0aW9uKGZpbGVQYXRoKSB7CiAgICAgIHZhciBleHQsIGZpbGVQYXRoTEMsIGxhbmd1YWdlQ29kZSwgcHJvZmlsZSwgcmVzb3VyY2VzLCByZXN1bHQ7CiAgICAgIHJlc3VsdCA9IHRoaXMucmVzb3VyY2VzQnlQYXRoW2ZpbGVQYXRoXTsKICAgICAgcHJvZmlsZSA9IExhbmd1YWdlTWFuYWdlci5wcm9maWxlOwogICAgICBsYW5ndWFnZUNvZGUgPSAocHJvZmlsZSAhPSBudWxsKSAmJiAocHJvZmlsZS5pdGVtcyAhPSBudWxsKSA/IHByb2ZpbGUuaXRlbXMuY29kZSA6IG51bGw7CiAgICAgIGlmIChyZXN1bHQgPT0gbnVsbCkgewogICAgICAgIGlmICgodHlwZW9mICRQQVJBTVMgIT09ICJ1bmRlZmluZWQiICYmICRQQVJBTVMgIT09IG51bGwpICYmICgkUEFSQU1TLnRlc3QgIT0gbnVsbCkpIHsKICAgICAgICAgIHJlc3VsdCA9IG5ldyBHUy5BdWRpb0J1ZmZlcignL2ludm9rZT9jb250cm9sbGVyPWdzLlJlc291cmNlQ29udHJvbGxlciZtZXRob2Q9bG9hZEF1ZGlvUmVzb3VyY2UmJyArICQucGFyYW0oewogICAgICAgICAgICBkYXRhOiB7CiAgICAgICAgICAgICAgcmVzb3VyY2U6IHsKICAgICAgICAgICAgICAgIHBhdGg6IGZpbGVQYXRoCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBzdXBwb3J0ZWRGb3JtYXRzOiBbImFhYyIsICJvZ2ciLCAid2F2Il0sCiAgICAgICAgICAgICAgbGFuZ3VhZ2VDb2RlOiBsYW5ndWFnZUNvZGUKICAgICAgICAgICAgfQogICAgICAgICAgfSkpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXNvdXJjZXMgPSBHUy5kYXRhQ2FjaGVbIlJFU09VUkNFUyJdLml0ZW1zLnJlc291cmNlczsKICAgICAgICAgIGZpbGVQYXRoTEMgPSBmaWxlUGF0aCArICJfIiArIGxhbmd1YWdlQ29kZTsKICAgICAgICAgIGlmIChyZXNvdXJjZXNbZmlsZVBhdGhMQ10pIHsKICAgICAgICAgICAgZXh0ID0gcmVzb3VyY2VzW2ZpbGVQYXRoTENdIHx8ICIud2F2IjsKICAgICAgICAgICAgcmVzdWx0ID0gbmV3IEdTLkF1ZGlvQnVmZmVyKCJyZXNvdXJjZXMvIiArIGZpbGVQYXRoTEMgKyBleHQpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZXh0ID0gcmVzb3VyY2VzW2ZpbGVQYXRoXSB8fCAiLndhdiI7CiAgICAgICAgICAgIHJlc3VsdCA9IG5ldyBHUy5BdWRpb0J1ZmZlcigicmVzb3VyY2VzLyIgKyBmaWxlUGF0aCArIGV4dCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHRoaXMucmVzb3VyY2VzQnlQYXRoW2ZpbGVQYXRoXSA9IHJlc3VsdDsKICAgICAgICB0aGlzLnJlc291cmNlcy5wdXNoKHJlc3VsdCk7CiAgICAgICAgdGhpcy5yZXNvdXJjZXNMb2FkZWQgPSBmYWxzZTsKICAgICAgfQogICAgICByZXR1cm4gcmVzdWx0OwogICAgfTsKCiAgICBSZXNvdXJjZU1hbmFnZXIucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgYml0bWFwLCBpLCBfaSwgX3JlZjsKICAgICAgaWYgKCF0aGlzLnJlc291cmNlc0xvYWRlZCkgewogICAgICAgIHRoaXMucmVzb3VyY2VzTG9hZGVkID0gdHJ1ZTsKICAgICAgICBmb3IgKGkgPSBfaSA9IDAsIF9yZWYgPSB0aGlzLnJlc291cmNlcy5sZW5ndGg7IDAgPD0gX3JlZiA/IF9pIDwgX3JlZiA6IF9pID4gX3JlZjsgaSA9IDAgPD0gX3JlZiA/ICsrX2kgOiAtLV9pKSB7CiAgICAgICAgICBpZiAoIXRoaXMucmVzb3VyY2VzW2ldLmxvYWRlZCkgewogICAgICAgICAgICB0aGlzLnJlc291cmNlc0xvYWRlZCA9IGZhbHNlOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0gZWxzZSBpZiAoKHRoaXMucmVzb3VyY2VzW2ldLmh1ZSAhPSBudWxsKSAmJiB0aGlzLnJlc291cmNlc1tpXS5odWUgPiAwKSB7CiAgICAgICAgICAgIGJpdG1hcCA9IG5ldyBCaXRtYXAodGhpcy5yZXNvdXJjZXNbaV0uaW1hZ2UpOwogICAgICAgICAgICB0aGlzLnJlc291cmNlc0J5UGF0aFt0aGlzLnJlc291cmNlc1tpXS5maWxlUGF0aF0gPSBiaXRtYXA7CiAgICAgICAgICAgIHRoaXMucmVzb3VyY2VzW2ldLmNoYW5nZUh1ZSh0aGlzLnJlc291cmNlc1tpXS5odWUpOwogICAgICAgICAgICB0aGlzLnJlc291cmNlc0J5UGF0aEh1ZVt0aGlzLnJlc291cmNlc1tpXS5maWxlUGF0aCArICJAIiArIHRoaXMucmVzb3VyY2VzW2ldLmh1ZV0gPSB0aGlzLnJlc291cmNlc1tpXTsKICAgICAgICAgICAgZGVsZXRlIHRoaXMucmVzb3VyY2VzW2ldLmZpbGVQYXRoOwogICAgICAgICAgICBkZWxldGUgdGhpcy5yZXNvdXJjZXNbaV0uaHVlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gbnVsbDsKICAgIH07CgogICAgcmV0dXJuIFJlc291cmNlTWFuYWdlcjsKCiAgfSkoKTsKCiAgd2luZG93LlJlc291cmNlTWFuYWdlciA9IG5ldyBSZXNvdXJjZU1hbmFnZXIoKTsKCn0pLmNhbGwodGhpcyk7Cg=="},{"name":"SceneManager","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIEZpbGU6IFNjZW5lTWFuYWdlci5jb2ZmZWUKIyAJQ3JlYXRlZCBvbjogMjAxMy0wNS0xOQojCiMgCUNvcHlyaWdodCAoQykgMjAxMyBBbmRy6SBSYWRvbXNraS4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KIwojIAlDbGFzczogU2NlbmVNYW5hZ2VyCiMKIyAgIERlc2NyaXB0aW9uLi4uCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpjbGFzcyBTY2VuZU1hbmFnZXIKICBjb25zdHJ1Y3RvcjogLT4KICAgIEBzY2VuZSA9IG51bGwKICAgIEBwcmV2aW91c1NjZW5lcyA9IFtdCiAgICBAbG9hZGluZyA9IHRydWUKICAgIEBsb2FkaW5nRGF0YSA9IHRydWUKICAgIEBsb2FkaW5nUmVzb3VyY2VzID0gdHJ1ZQogICAgQG5leHRTY2VuZSA9IG51bGwKICAgIAogIHN3aXRjaFRvOiAoc2NlbmUsIHNhdmVQcmV2aW91cykgLT4KICAgIGlmIHNhdmVQcmV2aW91cwogICAgICAgIEBwcmV2aW91c1NjZW5lcy5wdXNoKEBzY2VuZSkKICAgIGVsc2UKICAgICAgICBmb3IgcHJldlNjZW5lIGluIEBwcmV2aW91c1NjZW5lcwogICAgICAgICAgICBwcmV2U2NlbmUuZGlzcG9zZSgpCiAgICAgICAgQHByZXZpb3VzU2NlbmVzID0gW10KICAgICAgICAKICAgIEBuZXh0U2NlbmUgPSBzY2VuZQogICAgCiAgcmV0dXJuVG9QcmV2aW91czogLT4KICAgICAgQG5leHRTY2VuZSA9IEBwcmV2aW91c1NjZW5lcy5wb3AoKQogICAgICBAbmV4dFNjZW5lLnNob3coeWVzKQogICAgICAKICB1cGRhdGU6IC0+CiAgICBpZiBAbmV4dFNjZW5lICE9IEBzY2VuZQogICAgICAgIGlmIEBzY2VuZT8KICAgICAgICAgICAgaWYgQHByZXZpb3VzU2NlbmVzLmluZGV4T2YoQHNjZW5lKSA9PSAtMQogICAgICAgICAgICAgICAgQHNjZW5lLmRpc3Bvc2UoKQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBAc2NlbmUuc2hvdyhubykKICAgICAgICAKCiAgICAgICAgQHNjZW5lID0gQG5leHRTY2VuZQogICAgCiAgICAgICAgQGxvYWRpbmcgPSB0cnVlCiAgICAgICAgQGxvYWRpbmdEYXRhID0gdHJ1ZQogICAgICAgIEBsb2FkaW5nUmVzb3VyY2VzID0gdHJ1ZQogICAgICAgIGlmIEBzY2VuZT8gYW5kIG5vdCBAc2NlbmUuaW5pdGlhbGl6ZWQKICAgICAgICAgICAgQHNjZW5lLmluaXRpYWxpemUoKQogICAgICAgIAogICAgaWYgQHNjZW5lPwogICAgICBEYXRhTWFuYWdlci51cGRhdGUoKQogICAgICBSZXNvdXJjZU1hbmFnZXIudXBkYXRlKCkKICAgICAgQXVkaW9NYW5hZ2VyLnVwZGF0ZSgpCiAgICAgIAogICAgICBpZiBEYXRhTWFuYWdlci5kb2N1bWVudHNMb2FkZWQKICAgICAgICBpZiBAbG9hZGluZ0RhdGEgYW5kIG5vdCBAc2NlbmUuaW5pdGlhbGl6ZWQgdGhlbiBAc2NlbmUucHJlcGFyZURhdGEoKQogICAgICAgIEBsb2FkaW5nRGF0YSA9ICFEYXRhTWFuYWdlci5kb2N1bWVudHNMb2FkZWQKICAgICAgICAKICAgICAgaWYgbm90IEBsb2FkaW5nRGF0YSBhbmQgUmVzb3VyY2VNYW5hZ2VyLnJlc291cmNlc0xvYWRlZAogICAgICAgIGlmIEBsb2FkaW5nUmVzb3VyY2VzIGFuZCBub3QgQHNjZW5lLmluaXRpYWxpemVkCiAgICAgICAgICAgIEBzY2VuZS5wcmVwYXJlVmlzdWFsKCkKICAgICAgICAgICAgQHNjZW5lLmluaXRpYWxpemVkID0geWVzCiAgICAgICAgQGxvYWRpbmdSZXNvdXJjZXMgPSBmYWxzZQogICAKICAgICAgICAKICAgICAgICAKICAgICAgaWYgUmVzb3VyY2VNYW5hZ2VyLnJlc291cmNlc0xvYWRlZCBhbmQgRGF0YU1hbmFnZXIuZG9jdW1lbnRzTG9hZGVkCiAgICAgICAgQGxvYWRpbmcgPSBmYWxzZQogICAgICAgIGlmIEdyYXBoaWNzLmZyb3plbgogICAgICAgICAgICBHcmFwaGljcy51cGRhdGUoKQogICAgICAgIGVsc2UKICAgICAgICAgICAgQHNjZW5lLnVwZGF0ZSgpCiAgICAgIGVsc2UKICAgICAgICBAc2NlbmUubG9hZGluZygpCgoKd2luZG93LlNjZW5lTWFuYWdlciA9IG5ldyBTY2VuZU1hbmFnZXIoKQ==","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBTY2VuZU1hbmFnZXI7CgogIFNjZW5lTWFuYWdlciA9IChmdW5jdGlvbigpIHsKICAgIGZ1bmN0aW9uIFNjZW5lTWFuYWdlcigpIHsKICAgICAgdGhpcy5zY2VuZSA9IG51bGw7CiAgICAgIHRoaXMucHJldmlvdXNTY2VuZXMgPSBbXTsKICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTsKICAgICAgdGhpcy5sb2FkaW5nRGF0YSA9IHRydWU7CiAgICAgIHRoaXMubG9hZGluZ1Jlc291cmNlcyA9IHRydWU7CiAgICAgIHRoaXMubmV4dFNjZW5lID0gbnVsbDsKICAgIH0KCiAgICBTY2VuZU1hbmFnZXIucHJvdG90eXBlLnN3aXRjaFRvID0gZnVuY3Rpb24oc2NlbmUsIHNhdmVQcmV2aW91cykgewogICAgICB2YXIgcHJldlNjZW5lLCBfaSwgX2xlbiwgX3JlZjsKICAgICAgaWYgKHNhdmVQcmV2aW91cykgewogICAgICAgIHRoaXMucHJldmlvdXNTY2VuZXMucHVzaCh0aGlzLnNjZW5lKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBfcmVmID0gdGhpcy5wcmV2aW91c1NjZW5lczsKICAgICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICAgIHByZXZTY2VuZSA9IF9yZWZbX2ldOwogICAgICAgICAgcHJldlNjZW5lLmRpc3Bvc2UoKTsKICAgICAgICB9CiAgICAgICAgdGhpcy5wcmV2aW91c1NjZW5lcyA9IFtdOwogICAgICB9CiAgICAgIHJldHVybiB0aGlzLm5leHRTY2VuZSA9IHNjZW5lOwogICAgfTsKCiAgICBTY2VuZU1hbmFnZXIucHJvdG90eXBlLnJldHVyblRvUHJldmlvdXMgPSBmdW5jdGlvbigpIHsKICAgICAgdGhpcy5uZXh0U2NlbmUgPSB0aGlzLnByZXZpb3VzU2NlbmVzLnBvcCgpOwogICAgICByZXR1cm4gdGhpcy5uZXh0U2NlbmUuc2hvdyh0cnVlKTsKICAgIH07CgogICAgU2NlbmVNYW5hZ2VyLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpIHsKICAgICAgaWYgKHRoaXMubmV4dFNjZW5lICE9PSB0aGlzLnNjZW5lKSB7CiAgICAgICAgaWYgKHRoaXMuc2NlbmUgIT0gbnVsbCkgewogICAgICAgICAgaWYgKHRoaXMucHJldmlvdXNTY2VuZXMuaW5kZXhPZih0aGlzLnNjZW5lKSA9PT0gLTEpIHsKICAgICAgICAgICAgdGhpcy5zY2VuZS5kaXNwb3NlKCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aGlzLnNjZW5lLnNob3coZmFsc2UpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICB0aGlzLnNjZW5lID0gdGhpcy5uZXh0U2NlbmU7CiAgICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTsKICAgICAgICB0aGlzLmxvYWRpbmdEYXRhID0gdHJ1ZTsKICAgICAgICB0aGlzLmxvYWRpbmdSZXNvdXJjZXMgPSB0cnVlOwogICAgICAgIGlmICgodGhpcy5zY2VuZSAhPSBudWxsKSAmJiAhdGhpcy5zY2VuZS5pbml0aWFsaXplZCkgewogICAgICAgICAgdGhpcy5zY2VuZS5pbml0aWFsaXplKCk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmICh0aGlzLnNjZW5lICE9IG51bGwpIHsKICAgICAgICBEYXRhTWFuYWdlci51cGRhdGUoKTsKICAgICAgICBSZXNvdXJjZU1hbmFnZXIudXBkYXRlKCk7CiAgICAgICAgQXVkaW9NYW5hZ2VyLnVwZGF0ZSgpOwogICAgICAgIGlmIChEYXRhTWFuYWdlci5kb2N1bWVudHNMb2FkZWQpIHsKICAgICAgICAgIGlmICh0aGlzLmxvYWRpbmdEYXRhICYmICF0aGlzLnNjZW5lLmluaXRpYWxpemVkKSB7CiAgICAgICAgICAgIHRoaXMuc2NlbmUucHJlcGFyZURhdGEoKTsKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMubG9hZGluZ0RhdGEgPSAhRGF0YU1hbmFnZXIuZG9jdW1lbnRzTG9hZGVkOwogICAgICAgIH0KICAgICAgICBpZiAoIXRoaXMubG9hZGluZ0RhdGEgJiYgUmVzb3VyY2VNYW5hZ2VyLnJlc291cmNlc0xvYWRlZCkgewogICAgICAgICAgaWYgKHRoaXMubG9hZGluZ1Jlc291cmNlcyAmJiAhdGhpcy5zY2VuZS5pbml0aWFsaXplZCkgewogICAgICAgICAgICB0aGlzLnNjZW5lLnByZXBhcmVWaXN1YWwoKTsKICAgICAgICAgICAgdGhpcy5zY2VuZS5pbml0aWFsaXplZCA9IHRydWU7CiAgICAgICAgICB9CiAgICAgICAgICB0aGlzLmxvYWRpbmdSZXNvdXJjZXMgPSBmYWxzZTsKICAgICAgICB9CiAgICAgICAgaWYgKFJlc291cmNlTWFuYWdlci5yZXNvdXJjZXNMb2FkZWQgJiYgRGF0YU1hbmFnZXIuZG9jdW1lbnRzTG9hZGVkKSB7CiAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgIGlmIChHcmFwaGljcy5mcm96ZW4pIHsKICAgICAgICAgICAgcmV0dXJuIEdyYXBoaWNzLnVwZGF0ZSgpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2NlbmUudXBkYXRlKCk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVybiB0aGlzLnNjZW5lLmxvYWRpbmcoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgcmV0dXJuIFNjZW5lTWFuYWdlcjsKCiAgfSkoKTsKCiAgd2luZG93LlNjZW5lTWFuYWdlciA9IG5ldyBTY2VuZU1hbmFnZXIoKTsKCn0pLmNhbGwodGhpcyk7Cg=="},{"name":"DataManager","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogRGF0YU1hbmFnZXIKIyAJQ3JlYXRlZCBvbjogMjAxMy0wNS0xOQojCiMgCUNvcHlyaWdodCAoQykgMjAxMyBBbmRy6SBSYWRvbXNraS4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KIwojIAlDbGFzczogRGF0YU1hbmFnZXIKIwojICAgRGVzY3JpcHRpb24uLi4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCmNsYXNzIERhdGFNYW5hZ2VyCiAgICBjb25zdHJ1Y3RvcjogLT4KICAgICAgICBAZG9jdW1lbnRzQnlVaWQgPSB7fQogICAgICAgIEBkb2N1bWVudHMgPSBbXQogICAgICAgIEBkb2N1bWVudHNMb2FkZWQgPSB0cnVlCiAgICAgICAgQGNvdW50ZXIgPSAwCiAgICAgICAgCiAgICBnZXREb2N1bWVudHNCeVR5cGVBdE9uY2U6ICh0eXBlKSAtPgogICAgICAgIAogICAgZ2V0RG9jdW1lbnRzQnlUeXBlOiAodHlwZSkgLT4KICAgICAgICByZXN1bHQgPSBbXQogICAgICAgIAogICAgICAgIGZvciB1aWQgb2YgQHN1bW1hcmllcy5pdGVtcwogICAgICAgICAgICBzdW1tYXJ5ID0gQHN1bW1hcmllcy5pdGVtc1t1aWRdCiAgICAgICAgICAgIGlmIHN1bW1hcnkuaXRlbXM/IGFuZCBzdW1tYXJ5Lml0ZW1zLnR5cGUgPT0gdHlwZQogICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goQGdldERvY3VtZW50KHVpZCkpCiAgICAgICAgY29uc29sZS5sb2cocmVzdWx0KQogICAgICAgIHJldHVybiByZXN1bHQKICAgICAgICAKICAgIGdldERvY3VtZW50czogKHVpZHMpIC0+CiAgICAgICAgCiAgICBnZXREb2N1bWVudDogKHVpZCkgLT4KICAgICAgICByZXN1bHQgPSBAZG9jdW1lbnRzQnlVaWRbdWlkXQogICAgCiAgICAgICAgaWYgbm90IHJlc3VsdD8KICAgICAgICAgICAgaWYgJFBBUkFNUy50ZXN0PwogICAgICAgICAgICAgICAgJC5wb3N0KCIvaW52b2tlIiwgCiAgICAgICAgICAgICAgICB7IGNvbnRyb2xsZXI6ICJncy5Eb2N1bWVudENvbnRyb2xsZXIiLCBtZXRob2Q6ICJsb2FkRG9jdW1lbnQiLCBkYXRhOiBKU09OLnN0cmluZ2lmeSh7IHVpZDogdWlkIH0pfSwKICAgICAgICAgICAgICAgIChkYXRhLCB0ZXh0U3RhdHVzLCB4aHIpID0+IAogICAgICAgICAgICAgICAgICAgIGRhdGFPYmplY3QgPSBKU09OLnBhcnNlKGRhdGEuZGF0YSkKICAgICAgICAgICAgICAgICAgICByID0gQGRvY3VtZW50c0J5VWlkW2RhdGFPYmplY3QudWlkXQogICAgICAgICAgICAgICAgICAgIHIuaXRlbXMgPSBkYXRhT2JqZWN0Lml0ZW1zCiAgICAgICAgICAgICAgICAgICAgci5sb2FkZWQgPSB0cnVlCiAgICAKICAgICAgICAgICAgICAgICwgImpzb24iKQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAkLnBvc3QoIi4vZGF0YS8iICsgdWlkICsgIi5qc29uLmpzIiwge30sIChkYXRhKSA9PiAKICAgICAgICAgICAgICAgICAgICBldmFsKGRhdGEpCiAgICAgICAgICAgICAgICAgICAgZGF0YU9iamVjdCA9IEdTLmRhdGFDYWNoZVt1aWRdCiAgICAgICAgICAgICAgICAgICAgciA9IEBkb2N1bWVudHNCeVVpZFtkYXRhT2JqZWN0LnVpZF0KICAgICAgICAgICAgICAgICAgICByLml0ZW1zID0gZGF0YU9iamVjdC5pdGVtczsKICAgICAgICAgICAgICAgICAgICByLmxvYWRlZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICMjIyBPZmZsaW5lIC0gRmlyZWZveAogICAgICAgICAgICAgICAgcmVxdWlyZShbIi4vZGF0YS8je3VpZH0uanNvbi5qcyJdLAogICAgICAgICAgICAgICAgKGRhdGEpID0+IAogICAgICAgICAgICAgICAgICAgIGRhdGFPYmplY3QgPSBHUy5kYXRhQ2FjaGVbdWlkXQogICAgICAgICAgICAgICAgICAgIHIgPSBAZG9jdW1lbnRzQnlVaWRbZGF0YU9iamVjdC51aWRdCiAgICAgICAgICAgICAgICAgICAgci5pdGVtcyA9IGRhdGFPYmplY3QuaXRlbXMKICAgICAgICAgICAgICAgICAgICByLmxvYWRlZCA9IHRydWUKICAgIAogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgIyMjCiAgICAgICAgICAgIAogICAgICAgICAgICByZXN1bHQgPSB7IHVpZDogdWlkLCBsb2FkZWQ6IGZhbHNlIH0KICAgICAgICAgICAgQGRvY3VtZW50c0J5VWlkW3VpZF0gPSByZXN1bHQKICAgICAgICAgICAgQGRvY3VtZW50cy5wdXNoKHJlc3VsdCkKICAgICAgICAgICAgQGRvY3VtZW50c0xvYWRlZCA9IGZhbHNlCiAgICAgICAgICAgIAogICAgICAgICAgICBpZiB1aWQgPT0gIlNVTU1BUklFUyIgdGhlbiBAc3VtbWFyaWVzID0gcmVzdWx0CiAgICAKICAgICAgICByZXR1cm4gcmVzdWx0CiAgICAKICAgIHVwZGF0ZTogLT4KICAgICAgICBpZiBub3QgQGRvY3VtZW50c0xvYWRlZAogICAgICAgICAgICBAZG9jdW1lbnRzTG9hZGVkID0gdHJ1ZQogICAgCiAgICAgICAgICAgIGZvciBpIGluIFswLi4uQGRvY3VtZW50cy5sZW5ndGhdCiAgICAgICAgICAgICAgICBpZiBub3QgQGRvY3VtZW50c1tpXS5sb2FkZWQKICAgICAgICAgICAgICAgICAgICBAZG9jdW1lbnRzTG9hZGVkID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgIAogICAgICAgIHJldHVybiBudWxsCgp3aW5kb3cuRGF0YU1hbmFnZXIgPSBuZXcgRGF0YU1hbmFnZXIoKQ==","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBEYXRhTWFuYWdlcjsKCiAgRGF0YU1hbmFnZXIgPSAoZnVuY3Rpb24oKSB7CiAgICBmdW5jdGlvbiBEYXRhTWFuYWdlcigpIHsKICAgICAgdGhpcy5kb2N1bWVudHNCeVVpZCA9IHt9OwogICAgICB0aGlzLmRvY3VtZW50cyA9IFtdOwogICAgICB0aGlzLmRvY3VtZW50c0xvYWRlZCA9IHRydWU7CiAgICAgIHRoaXMuY291bnRlciA9IDA7CiAgICB9CgogICAgRGF0YU1hbmFnZXIucHJvdG90eXBlLmdldERvY3VtZW50c0J5VHlwZUF0T25jZSA9IGZ1bmN0aW9uKHR5cGUpIHt9OwoKICAgIERhdGFNYW5hZ2VyLnByb3RvdHlwZS5nZXREb2N1bWVudHNCeVR5cGUgPSBmdW5jdGlvbih0eXBlKSB7CiAgICAgIHZhciByZXN1bHQsIHN1bW1hcnksIHVpZDsKICAgICAgcmVzdWx0ID0gW107CiAgICAgIGZvciAodWlkIGluIHRoaXMuc3VtbWFyaWVzLml0ZW1zKSB7CiAgICAgICAgc3VtbWFyeSA9IHRoaXMuc3VtbWFyaWVzLml0ZW1zW3VpZF07CiAgICAgICAgaWYgKChzdW1tYXJ5Lml0ZW1zICE9IG51bGwpICYmIHN1bW1hcnkuaXRlbXMudHlwZSA9PT0gdHlwZSkgewogICAgICAgICAgcmVzdWx0LnB1c2godGhpcy5nZXREb2N1bWVudCh1aWQpKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgY29uc29sZS5sb2cocmVzdWx0KTsKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH07CgogICAgRGF0YU1hbmFnZXIucHJvdG90eXBlLmdldERvY3VtZW50cyA9IGZ1bmN0aW9uKHVpZHMpIHt9OwoKICAgIERhdGFNYW5hZ2VyLnByb3RvdHlwZS5nZXREb2N1bWVudCA9IGZ1bmN0aW9uKHVpZCkgewogICAgICB2YXIgcmVzdWx0LAogICAgICAgIF90aGlzID0gdGhpczsKICAgICAgcmVzdWx0ID0gdGhpcy5kb2N1bWVudHNCeVVpZFt1aWRdOwogICAgICBpZiAocmVzdWx0ID09IG51bGwpIHsKICAgICAgICBpZiAoJFBBUkFNUy50ZXN0ICE9IG51bGwpIHsKICAgICAgICAgICQucG9zdCgiL2ludm9rZSIsIHsKICAgICAgICAgICAgY29udHJvbGxlcjogImdzLkRvY3VtZW50Q29udHJvbGxlciIsCiAgICAgICAgICAgIG1ldGhvZDogImxvYWREb2N1bWVudCIsCiAgICAgICAgICAgIGRhdGE6IEpTT04uc3RyaW5naWZ5KHsKICAgICAgICAgICAgICB1aWQ6IHVpZAogICAgICAgICAgICB9KQogICAgICAgICAgfSwgZnVuY3Rpb24oZGF0YSwgdGV4dFN0YXR1cywgeGhyKSB7CiAgICAgICAgICAgIHZhciBkYXRhT2JqZWN0LCByOwogICAgICAgICAgICBkYXRhT2JqZWN0ID0gSlNPTi5wYXJzZShkYXRhLmRhdGEpOwogICAgICAgICAgICByID0gX3RoaXMuZG9jdW1lbnRzQnlVaWRbZGF0YU9iamVjdC51aWRdOwogICAgICAgICAgICByLml0ZW1zID0gZGF0YU9iamVjdC5pdGVtczsKICAgICAgICAgICAgcmV0dXJuIHIubG9hZGVkID0gdHJ1ZTsKICAgICAgICAgIH0sICJqc29uIik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICQucG9zdCgiLi9kYXRhLyIgKyB1aWQgKyAiLmpzb24uanMiLCB7fSwgZnVuY3Rpb24oZGF0YSkgewogICAgICAgICAgICB2YXIgZGF0YU9iamVjdCwgcjsKICAgICAgICAgICAgZXZhbChkYXRhKTsKICAgICAgICAgICAgZGF0YU9iamVjdCA9IEdTLmRhdGFDYWNoZVt1aWRdOwogICAgICAgICAgICByID0gX3RoaXMuZG9jdW1lbnRzQnlVaWRbZGF0YU9iamVjdC51aWRdOwogICAgICAgICAgICByLml0ZW1zID0gZGF0YU9iamVjdC5pdGVtczsKICAgICAgICAgICAgcmV0dXJuIHIubG9hZGVkID0gdHJ1ZTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgICAvKiBPZmZsaW5lIC0gRmlyZWZveAogICAgICAgIHJlcXVpcmUoWyIuL2RhdGEvI3t1aWR9Lmpzb24uanMiXSwKICAgICAgICAoZGF0YSkgPT4gCiAgICAgICAgICAgIGRhdGFPYmplY3QgPSBHUy5kYXRhQ2FjaGVbdWlkXQogICAgICAgICAgICByID0gQGRvY3VtZW50c0J5VWlkW2RhdGFPYmplY3QudWlkXQogICAgICAgICAgICByLml0ZW1zID0gZGF0YU9iamVjdC5pdGVtcwogICAgICAgICAgICByLmxvYWRlZCA9IHRydWUKICAgICAgICAgICAgCiAgICAgICAgKQogICAgICAgICovCgogICAgICAgIHJlc3VsdCA9IHsKICAgICAgICAgIHVpZDogdWlkLAogICAgICAgICAgbG9hZGVkOiBmYWxzZQogICAgICAgIH07CiAgICAgICAgdGhpcy5kb2N1bWVudHNCeVVpZFt1aWRdID0gcmVzdWx0OwogICAgICAgIHRoaXMuZG9jdW1lbnRzLnB1c2gocmVzdWx0KTsKICAgICAgICB0aGlzLmRvY3VtZW50c0xvYWRlZCA9IGZhbHNlOwogICAgICAgIGlmICh1aWQgPT09ICJTVU1NQVJJRVMiKSB7CiAgICAgICAgICB0aGlzLnN1bW1hcmllcyA9IHJlc3VsdDsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH07CgogICAgRGF0YU1hbmFnZXIucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgaSwgX2ksIF9yZWY7CiAgICAgIGlmICghdGhpcy5kb2N1bWVudHNMb2FkZWQpIHsKICAgICAgICB0aGlzLmRvY3VtZW50c0xvYWRlZCA9IHRydWU7CiAgICAgICAgZm9yIChpID0gX2kgPSAwLCBfcmVmID0gdGhpcy5kb2N1bWVudHMubGVuZ3RoOyAwIDw9IF9yZWYgPyBfaSA8IF9yZWYgOiBfaSA+IF9yZWY7IGkgPSAwIDw9IF9yZWYgPyArK19pIDogLS1faSkgewogICAgICAgICAgaWYgKCF0aGlzLmRvY3VtZW50c1tpXS5sb2FkZWQpIHsKICAgICAgICAgICAgdGhpcy5kb2N1bWVudHNMb2FkZWQgPSBmYWxzZTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiBudWxsOwogICAgfTsKCiAgICByZXR1cm4gRGF0YU1hbmFnZXI7CgogIH0pKCk7CgogIHdpbmRvdy5EYXRhTWFuYWdlciA9IG5ldyBEYXRhTWFuYWdlcigpOwoKfSkuY2FsbCh0aGlzKTsK"},{"name":"AudioManager","content":"IwojICAgU2NyaXB0OiBBdWRpb01hbmFnZXIKIyAgIENyZWF0ZWQgb246IDIwMTMtMTEtMzAKIwojIAlDb3B5cmlnaHQgKEMpIDIwMTMgQW5kcukgUmFkb21za2kuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAJQ2xhc3M6IEF1ZGlvTWFuYWdlcgojCiMgICBEZXNjcmlwdGlvbi4uLgojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKY2xhc3MgQXVkaW9NYW5hZ2VyCiAgICBjb25zdHJ1Y3RvcjogLT4KICAgICAgICBAYnVmZmVycyA9IFtdCiAgICAgICAgQGJ1ZmZlcnNCeVBhdGggPSB7fQogICAgICAgIEBtdXNpY0J1ZmZlciA9IG51bGwKICAgICAgICBAYmFja2dyb3VuZFNvdW5kQnVmZmVyID0gbnVsbAogICAgICAgIEBzb3VuZFJlZmVyZW5jZXMgPSB7fQogICAgICAgIEBtdXNpYwogICAgICAgIEBiYWNrZ3JvdW5kU291bmQKICAgIAogICAgbG9hZE11c2ljOiAobmFtZSkgLT4gCiAgICAgICAgbmFtZSA9IGlmIG5hbWU/IHRoZW4gKG5hbWUubmFtZSB8fCBuYW1lKSBlbHNlIG5hbWUKICAgICAgICBpZiBuYW1lIGFuZCBuYW1lLmxlbmd0aCA+IDAKICAgICAgICAgICAgUmVzb3VyY2VNYW5hZ2VyLmdldEF1ZGlvQnVmZmVyKCJBdWRpby9NdXNpYy8je25hbWV9IikKICAgICAgICAgICAgCiAgICBsb2FkU291bmQ6IChuYW1lKSAtPiAKICAgICAgICBuYW1lID0gaWYgbmFtZT8gdGhlbiBuYW1lLm5hbWUgfHwgbmFtZSBlbHNlIG5hbWUKICAgICAgICBpZiBuYW1lIGFuZCBuYW1lLmxlbmd0aCA+IDAKICAgICAgICAgICAgUmVzb3VyY2VNYW5hZ2VyLmdldEF1ZGlvQnVmZmVyKCJBdWRpby9Tb3VuZHMvI3tuYW1lfSIpCiAgICBsb2FkQmFja2dyb3VuZFNvdW5kOiAobmFtZSkgLT4gCiAgICAgICAgbmFtZSA9IGlmIG5hbWU/IHRoZW4gKG5hbWUubmFtZSB8fCBuYW1lKSBlbHNlIG5hbWUKICAgICAgICBpZiBuYW1lIGFuZCBuYW1lLmxlbmd0aCA+IDAKICAgICAgICAgICAgUmVzb3VyY2VNYW5hZ2VyLmdldEF1ZGlvQnVmZmVyKCJBdWRpby9CYWNrZ3JvdW5kU291bmRzLyN7bmFtZX0iKQogICAgICAgICAgICAKICAgIHVwZGF0ZTogLT4KICAgICAgICBpZiBAbXVzaWNCdWZmZXI/IHRoZW4gQG11c2ljQnVmZmVyLnVwZGF0ZSgpCiAgICAgICAgCiAgICBjaGFuZ2VNdXNpYzogKG11c2ljKSAtPgogICAgICAgIGlmIG11c2ljPyBhbmQgbXVzaWMubmFtZT8KICAgICAgICAgICAgaWYgQG11c2ljPyBhbmQgQG11c2ljLm5hbWUgIT0gbXVzaWMubmFtZQogICAgICAgICAgICAgICAgQHBsYXlNdXNpYyhtdXNpYykKICAgICAgICAgICAgZWxzZSBpZiBub3QgQG11c2ljPwogICAgICAgICAgICAgICAgQHBsYXlNdXNpYyhtdXNpYykKICAgICAgICBlbHNlCiAgICAgICAgICAgIEBzdG9wTXVzaWMoKQogICAgICAgICAgICAKICAgICAgICAgIyAgIEBkaXNwb3NlTXVzaWMoKQogICAgICAgICAgICAgICAgCiAgICBjaGFuZ2VCYWNrZ3JvdW5kU291bmQ6IChzb3VuZCkgLT4KICAgICAgICBpZiBzb3VuZD8gYW5kIHNvdW5kLm5hbWU/CiAgICAgICAgICAgIGlmIEBiYWNrZ3JvdW5kU291bmQ/IGFuZCBAYmFja2dyb3VuZFNvdW5kLm5hbWUgIT0gc291bmQubmFtZQogICAgICAgICAgICAgICAgQHBsYXlCYWNrZ3JvdW5kU291bmQoc291bmQpCiAgICAgICAgICAgIGVsc2UgaWYgbm90IEBiYWNrZ3JvdW5kU291bmQ/CiAgICAgICAgICAgICAgICBAcGxheUJhY2tncm91bmRTb3VuZChzb3VuZCkKICAgICAgICBlbHNlCiAgICAgICAgICAgIEBzdG9wQmFja2dyb3VuZFNvdW5kKCkKICAgICAgICAgICMgIEBkaXNwb3NlQmFja3JvdW5kU291bmQoKQogICAgICAgICAgICAgICAgCiAgICBwbGF5OiAocGF0aCwgdm9sdW1lLCByYXRlLCBmYWRlSW5UaW1lKSAtPgogICAgICAgCiAgICAgICAgYnVmZmVyID0gUmVzb3VyY2VNYW5hZ2VyLmdldEF1ZGlvQnVmZmVyKHBhdGgpCiAgICAgICAgCgogICAgICAgIGlmIGJ1ZmZlci5kZWNvZGVkCiAgICAgICAgICAgIGJ1ZmZlci52b2x1bWUgPSBpZiB2b2x1bWU/IHRoZW4gdm9sdW1lIC8gMTAwIGVsc2UgMS4wCiAgICAgICAgICAgIGJ1ZmZlci5wbGF5YmFja1JhdGUgPSBpZiByYXRlPyB0aGVuIHJhdGUgLyAxMDAgZWxzZSAxLjAKICAgICAgICAgICAgYnVmZmVyLnBsYXkoZmFkZUluVGltZSkKICAgICAgICBlbHNlCiAgICAgICAgICAgYnVmZmVyLm9uRmluaXNoRGVjb2RlID0gKHNvdXJjZSkgPT4gCiAgICAgICAgICAgICAgIHNvdXJjZS52b2x1bWUgPSBpZiB2b2x1bWU/IHRoZW4gdm9sdW1lIC8gMTAwIGVsc2UgMS4wCiAgICAgICAgICAgICAgIHNvdXJjZS5wbGF5YmFja1JhdGUgPSBpZiByYXRlPyB0aGVuIHJhdGUgLyAxMDAgZWxzZSAxLjAKICAgICAgICAgICAgICAgc291cmNlLnBsYXkoZmFkZUluVGltZSkKICAgICAgICAgICBidWZmZXIuZGVjb2RlKCkKICAgICAgICAgICAKICAgICAgICAgICAKICAgICAgICByZXR1cm4gYnVmZmVyCiAgICAgICAgCiAgICAgICAgCiAgICBwbGF5U291bmQ6IChuYW1lLCB2b2x1bWUsIHJhdGUsIG11c2ljRWZmZWN0KSAtPgogICAgICAgIAogICAgICAgIGlmIG5hbWUubmFtZT8KICAgICAgICAgICAgbmFtZSA9IG5hbWUubmFtZQogICAgICAgICAgICB2b2x1bWUgPSBuYW1lLnZvbHVtZQogICAgICAgICAgICByYXRlID0gbmFtZS5wbGF5YmFja1JhdGUKICAgICAgICAgCiAgICAgICAgaWYgbmFtZS5sZW5ndGggPT0gMCB0aGVuIHJldHVybgogICAgICAgIAogICAgICAgIGlmIG11c2ljRWZmZWN0CiAgICAgICAgICAgIEBzdG9wTXVzaWMoKQogICAgICAgIAogICAgICAgIGlmIG5vdCBAc291bmRSZWZlcmVuY2VzW25hbWVdPwogICAgICAgICAgICBAc291bmRSZWZlcmVuY2VzW25hbWVdID0gW10KICAgICAgICAKICAgICAgICByZWZlcmVuY2UgPSBudWxsCiAgICAgICAgZm9yIHIgaW4gQHNvdW5kUmVmZXJlbmNlc1tuYW1lXQogICAgICAgICAgICBpZiBub3Qgci5pc1BsYXlpbmcKICAgICAgICAgICAgICAgIHJlZmVyZW5jZSA9IHIKICAgICAgICAgICAgICAgIGlmIG11c2ljRWZmZWN0IHRoZW4gcmVmZXJlbmNlLm9uRW5kID0gPT4gQHJlc3VtZU11c2ljKDQwKQogICAgICAgICAgICAgICAgcmVmZXJlbmNlLnBsYXkoKQogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgCiAgICAgICAgaWYgbm90IHJlZmVyZW5jZT8KICAgICAgICAgICAgYnVmZmVyID0gUmVzb3VyY2VNYW5hZ2VyLmdldEF1ZGlvQnVmZmVyKCJBdWRpby9Tb3VuZHMvI3tuYW1lfSIpCiAgICAgICAgICAgIGlmIGJ1ZmZlciBhbmQgYnVmZmVyLmxvYWRlZAogICAgICAgICAgICAgICAgaWYgYnVmZmVyLmRlY29kZWQKICAgICAgICAgICAgICAgICAgICByZWZlcmVuY2UgPSBuZXcgR1MuQXVkaW9CdWZmZXJSZWZlcmVuY2UoYnVmZmVyKQogICAgICAgICAgICAgICAgICAgIGlmIG11c2ljRWZmZWN0IHRoZW4gcmVmZXJlbmNlLm9uRW5kID0gPT4gQHJlc3VtZU11c2ljKDQwKQogICAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZS5wbGF5KCkKICAgICAgICAgICAgICAgICAgICBAc291bmRSZWZlcmVuY2VzW25hbWVdLnB1c2gocmVmZXJlbmNlKQogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIGJ1ZmZlci5uYW1lID0gbmFtZQogICAgICAgICAgICAgICAgICAgIGJ1ZmZlci5vbkRlY29kZUZpbmlzaCA9IChzb3VyY2UpID0+CiAgICAgICAgICAgICAgICAgICAgICAgIHJlZmVyZW5jZSA9IG5ldyBHUy5BdWRpb0J1ZmZlclJlZmVyZW5jZShzb3VyY2UpCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIG11c2ljRWZmZWN0IHRoZW4gcmVmZXJlbmNlLm9uRW5kID0gPT4gQHJlc3VtZU11c2ljKDQwKQogICAgICAgICAgICAgICAgICAgICAgICByZWZlcmVuY2UucGxheSgpCiAgICAgICAgICAgICAgICAgICAgICAgIEBzb3VuZFJlZmVyZW5jZXNbc291cmNlLm5hbWVdLnB1c2gocmVmZXJlbmNlKQogICAgICAgICAgICAgICAgICAgIGJ1ZmZlci5kZWNvZGUoKQogICAgICAgICAgICAgICAgICAgIAogICAgICAgIAogICAgcGxheU11c2ljOiAobmFtZSwgdm9sdW1lLCByYXRlLCBmYWRlSW5UaW1lKSAtPgogICAgICAgIGlmIG5hbWU/IGFuZCBuYW1lLm5hbWU/CiAgICAgICAgICAgIGZhZGVJblRpbWUgPSB2b2x1bWUKICAgICAgICAgICAgdm9sdW1lID0gbmFtZS52b2x1bWUKICAgICAgICAgICAgcmF0ZSA9IG5hbWUucGxheWJhY2tSYXRlCiAgICAgICAgICAgIG5hbWUgPSBuYW1lLm5hbWUKICAgICAgICAgICAgCiAgICAgICAgICAgIAogICAgCiAgICAgICAgICAgICAgCiAgICAgICAgdm9sdW1lID0gaWYgdm9sdW1lPyB0aGVuIHZvbHVtZSBlbHNlIDEwMAogICAgICAgIEBkaXNwb3NlTXVzaWMoKQogICAgICAgIAogICAgICAgIGlmIG5hbWU/IGFuZCBuYW1lLmxlbmd0aCA+IDAKICAgICAgICAgICAgQG11c2ljID0gbmFtZTogbmFtZQogICAgICAgICAgICBAbXVzaWNCdWZmZXIgPSBAcGxheSgiQXVkaW8vTXVzaWMvI3tuYW1lfSIsIHZvbHVtZSwgcmF0ZSwgZmFkZUluVGltZSkKICAgICAgICAgICAgQG11c2ljQnVmZmVyLm9uRW5kID0gPT4gQG11c2ljQnVmZmVyLnBsYXkoKQogICAgICAgICAgICAKICAgIAogICAgcmVzdW1lTXVzaWM6IChmYWRlSW5UaW1lKSAtPgogICAgICAgIGlmIEBtdXNpY0J1ZmZlcj8KICAgICAgICAgICAgQG11c2ljQnVmZmVyLnJlc3VtZShmYWRlSW5UaW1lKQogICAgICAgICAgICAKICAgIHBsYXlCYWNrZ3JvdW5kU291bmQ6IChuYW1lLCB2b2x1bWUsIHJhdGUsIGZhZGVJblRpbWUpIC0+CiAgICAgICAgaWYgbmFtZT8gYW5kIG5hbWUubmFtZT8KICAgICAgICAgICAgZmFkZUluVGltZSA9IHZvbHVtZQogICAgICAgICAgICB2b2x1bWUgPSBuYW1lLnZvbHVtZQogICAgICAgICAgICByYXRlID0gbmFtZS5wbGF5YmFja1JhdGUKICAgICAgICAgICAgbmFtZSA9IG5hbWUubmFtZQogICAgICAgICAgICAgIAogICAgICAgIHZvbHVtZSA9IGlmIHZvbHVtZT8gdGhlbiB2b2x1bWUgZWxzZSAxMDAKICAgICAgICBAZGlzcG9zZUJhY2tncm91bmRTb3VuZCgpCiAgICAgICAgCiAgICAgICAgaWYgbmFtZT8gYW5kIG5hbWUubGVuZ3RoID4gMAogICAgICAgICAgICBAYmFja2dyb3VuZFNvdW5kID0gbmFtZTogbmFtZQogICAgICAgICAgICBAYmFja2dyb3VuZFNvdW5kQnVmZmVyID0gQHBsYXkoIkF1ZGlvL0JhY2tncm91bmRTb3VuZHMvI3tuYW1lfSIsIHZvbHVtZSwgcmF0ZSwgZmFkZUluVGltZSkKICAgICAgICAgICAgQGJhY2tncm91bmRTb3VuZEJ1ZmZlci5vbkVuZCA9ID0+IEBiYWNrZ3JvdW5kU291bmRCdWZmZXIucGxheSgpCiAgICAKICAgIHN0b3BNdXNpYzogKGZhZGVPdXRUaW1lKSAtPiAKICAgICAgICBpZiBAbXVzaWNCdWZmZXI/IHRoZW4gQG11c2ljQnVmZmVyLnN0b3AoZmFkZU91dFRpbWUpCiAgICAgICAgQG11c2ljID0gbnVsbAogICAgICAgIAogICAgc3RvcEJhY2tncm91bmRTb3VuZDogLT4gCiAgICAgICAgaWYgQGJhY2tncm91bmRTb3VuZEJ1ZmZlcj8gdGhlbiBAYmFja2dyb3VuZFNvdW5kQnVmZmVyLnN0b3AoKQogICAgICAgIEBiYWNrZ3JvdW5kU291bmQgPSBudWxsCiAgICAKICAgIGRpc3Bvc2VNdXNpYzogLT4KICAgICAgICBAc3RvcE11c2ljKCkKICAgICAgICBpZiBAbXVzaWNCdWZmZXI/IHRoZW4gQG11c2ljQnVmZmVyLmRpc3Bvc2UoKQogICAgZGlzcG9zZUJhY2tncm91bmRTb3VuZDogLT4KICAgICAgICBAc3RvcEJhY2tncm91bmRTb3VuZCgpCiAgICAgICAgaWYgQGJhY2tncm91bmRTb3VuZEJ1ZmZlcj8gdGhlbiBAYmFja2dyb3VuZFNvdW5kQnVmZmVyLmRpc3Bvc2UoKQogICAgICAgIAp3aW5kb3cuQXVkaW9NYW5hZ2VyID0gbmV3IEF1ZGlvTWFuYWdlcigp","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBBdWRpb01hbmFnZXI7CgogIEF1ZGlvTWFuYWdlciA9IChmdW5jdGlvbigpIHsKICAgIGZ1bmN0aW9uIEF1ZGlvTWFuYWdlcigpIHsKICAgICAgdGhpcy5idWZmZXJzID0gW107CiAgICAgIHRoaXMuYnVmZmVyc0J5UGF0aCA9IHt9OwogICAgICB0aGlzLm11c2ljQnVmZmVyID0gbnVsbDsKICAgICAgdGhpcy5iYWNrZ3JvdW5kU291bmRCdWZmZXIgPSBudWxsOwogICAgICB0aGlzLnNvdW5kUmVmZXJlbmNlcyA9IHt9OwogICAgICB0aGlzLm11c2ljOwogICAgICB0aGlzLmJhY2tncm91bmRTb3VuZDsKICAgIH0KCiAgICBBdWRpb01hbmFnZXIucHJvdG90eXBlLmxvYWRNdXNpYyA9IGZ1bmN0aW9uKG5hbWUpIHsKICAgICAgbmFtZSA9IG5hbWUgIT0gbnVsbCA/IG5hbWUubmFtZSB8fCBuYW1lIDogbmFtZTsKICAgICAgaWYgKG5hbWUgJiYgbmFtZS5sZW5ndGggPiAwKSB7CiAgICAgICAgcmV0dXJuIFJlc291cmNlTWFuYWdlci5nZXRBdWRpb0J1ZmZlcigiQXVkaW8vTXVzaWMvIiArIG5hbWUpOwogICAgICB9CiAgICB9OwoKICAgIEF1ZGlvTWFuYWdlci5wcm90b3R5cGUubG9hZFNvdW5kID0gZnVuY3Rpb24obmFtZSkgewogICAgICBuYW1lID0gbmFtZSAhPSBudWxsID8gbmFtZS5uYW1lIHx8IG5hbWUgOiBuYW1lOwogICAgICBpZiAobmFtZSAmJiBuYW1lLmxlbmd0aCA+IDApIHsKICAgICAgICByZXR1cm4gUmVzb3VyY2VNYW5hZ2VyLmdldEF1ZGlvQnVmZmVyKCJBdWRpby9Tb3VuZHMvIiArIG5hbWUpOwogICAgICB9CiAgICB9OwoKICAgIEF1ZGlvTWFuYWdlci5wcm90b3R5cGUubG9hZEJhY2tncm91bmRTb3VuZCA9IGZ1bmN0aW9uKG5hbWUpIHsKICAgICAgbmFtZSA9IG5hbWUgIT0gbnVsbCA/IG5hbWUubmFtZSB8fCBuYW1lIDogbmFtZTsKICAgICAgaWYgKG5hbWUgJiYgbmFtZS5sZW5ndGggPiAwKSB7CiAgICAgICAgcmV0dXJuIFJlc291cmNlTWFuYWdlci5nZXRBdWRpb0J1ZmZlcigiQXVkaW8vQmFja2dyb3VuZFNvdW5kcy8iICsgbmFtZSk7CiAgICAgIH0KICAgIH07CgogICAgQXVkaW9NYW5hZ2VyLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpIHsKICAgICAgaWYgKHRoaXMubXVzaWNCdWZmZXIgIT0gbnVsbCkgewogICAgICAgIHJldHVybiB0aGlzLm11c2ljQnVmZmVyLnVwZGF0ZSgpOwogICAgICB9CiAgICB9OwoKICAgIEF1ZGlvTWFuYWdlci5wcm90b3R5cGUuY2hhbmdlTXVzaWMgPSBmdW5jdGlvbihtdXNpYykgewogICAgICBpZiAoKG11c2ljICE9IG51bGwpICYmIChtdXNpYy5uYW1lICE9IG51bGwpKSB7CiAgICAgICAgaWYgKCh0aGlzLm11c2ljICE9IG51bGwpICYmIHRoaXMubXVzaWMubmFtZSAhPT0gbXVzaWMubmFtZSkgewogICAgICAgICAgcmV0dXJuIHRoaXMucGxheU11c2ljKG11c2ljKTsKICAgICAgICB9IGVsc2UgaWYgKHRoaXMubXVzaWMgPT0gbnVsbCkgewogICAgICAgICAgcmV0dXJuIHRoaXMucGxheU11c2ljKG11c2ljKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIHRoaXMuc3RvcE11c2ljKCk7CiAgICAgIH0KICAgIH07CgogICAgQXVkaW9NYW5hZ2VyLnByb3RvdHlwZS5jaGFuZ2VCYWNrZ3JvdW5kU291bmQgPSBmdW5jdGlvbihzb3VuZCkgewogICAgICBpZiAoKHNvdW5kICE9IG51bGwpICYmIChzb3VuZC5uYW1lICE9IG51bGwpKSB7CiAgICAgICAgaWYgKCh0aGlzLmJhY2tncm91bmRTb3VuZCAhPSBudWxsKSAmJiB0aGlzLmJhY2tncm91bmRTb3VuZC5uYW1lICE9PSBzb3VuZC5uYW1lKSB7CiAgICAgICAgICByZXR1cm4gdGhpcy5wbGF5QmFja2dyb3VuZFNvdW5kKHNvdW5kKTsKICAgICAgICB9IGVsc2UgaWYgKHRoaXMuYmFja2dyb3VuZFNvdW5kID09IG51bGwpIHsKICAgICAgICAgIHJldHVybiB0aGlzLnBsYXlCYWNrZ3JvdW5kU291bmQoc291bmQpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gdGhpcy5zdG9wQmFja2dyb3VuZFNvdW5kKCk7CiAgICAgIH0KICAgIH07CgogICAgQXVkaW9NYW5hZ2VyLnByb3RvdHlwZS5wbGF5ID0gZnVuY3Rpb24ocGF0aCwgdm9sdW1lLCByYXRlLCBmYWRlSW5UaW1lKSB7CiAgICAgIHZhciBidWZmZXIsCiAgICAgICAgX3RoaXMgPSB0aGlzOwogICAgICBidWZmZXIgPSBSZXNvdXJjZU1hbmFnZXIuZ2V0QXVkaW9CdWZmZXIocGF0aCk7CiAgICAgIGlmIChidWZmZXIuZGVjb2RlZCkgewogICAgICAgIGJ1ZmZlci52b2x1bWUgPSB2b2x1bWUgIT0gbnVsbCA/IHZvbHVtZSAvIDEwMCA6IDEuMDsKICAgICAgICBidWZmZXIucGxheWJhY2tSYXRlID0gcmF0ZSAhPSBudWxsID8gcmF0ZSAvIDEwMCA6IDEuMDsKICAgICAgICBidWZmZXIucGxheShmYWRlSW5UaW1lKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBidWZmZXIub25GaW5pc2hEZWNvZGUgPSBmdW5jdGlvbihzb3VyY2UpIHsKICAgICAgICAgIHNvdXJjZS52b2x1bWUgPSB2b2x1bWUgIT0gbnVsbCA/IHZvbHVtZSAvIDEwMCA6IDEuMDsKICAgICAgICAgIHNvdXJjZS5wbGF5YmFja1JhdGUgPSByYXRlICE9IG51bGwgPyByYXRlIC8gMTAwIDogMS4wOwogICAgICAgICAgcmV0dXJuIHNvdXJjZS5wbGF5KGZhZGVJblRpbWUpOwogICAgICAgIH07CiAgICAgICAgYnVmZmVyLmRlY29kZSgpOwogICAgICB9CiAgICAgIHJldHVybiBidWZmZXI7CiAgICB9OwoKICAgIEF1ZGlvTWFuYWdlci5wcm90b3R5cGUucGxheVNvdW5kID0gZnVuY3Rpb24obmFtZSwgdm9sdW1lLCByYXRlLCBtdXNpY0VmZmVjdCkgewogICAgICB2YXIgYnVmZmVyLCByLCByZWZlcmVuY2UsIF9pLCBfbGVuLCBfcmVmLAogICAgICAgIF90aGlzID0gdGhpczsKICAgICAgaWYgKG5hbWUubmFtZSAhPSBudWxsKSB7CiAgICAgICAgbmFtZSA9IG5hbWUubmFtZTsKICAgICAgICB2b2x1bWUgPSBuYW1lLnZvbHVtZTsKICAgICAgICByYXRlID0gbmFtZS5wbGF5YmFja1JhdGU7CiAgICAgIH0KICAgICAgaWYgKG5hbWUubGVuZ3RoID09PSAwKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGlmIChtdXNpY0VmZmVjdCkgewogICAgICAgIHRoaXMuc3RvcE11c2ljKCk7CiAgICAgIH0KICAgICAgaWYgKHRoaXMuc291bmRSZWZlcmVuY2VzW25hbWVdID09IG51bGwpIHsKICAgICAgICB0aGlzLnNvdW5kUmVmZXJlbmNlc1tuYW1lXSA9IFtdOwogICAgICB9CiAgICAgIHJlZmVyZW5jZSA9IG51bGw7CiAgICAgIF9yZWYgPSB0aGlzLnNvdW5kUmVmZXJlbmNlc1tuYW1lXTsKICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBfcmVmLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7CiAgICAgICAgciA9IF9yZWZbX2ldOwogICAgICAgIGlmICghci5pc1BsYXlpbmcpIHsKICAgICAgICAgIHJlZmVyZW5jZSA9IHI7CiAgICAgICAgICBpZiAobXVzaWNFZmZlY3QpIHsKICAgICAgICAgICAgcmVmZXJlbmNlLm9uRW5kID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnJlc3VtZU11c2ljKDQwKTsKICAgICAgICAgICAgfTsKICAgICAgICAgIH0KICAgICAgICAgIHJlZmVyZW5jZS5wbGF5KCk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKHJlZmVyZW5jZSA9PSBudWxsKSB7CiAgICAgICAgYnVmZmVyID0gUmVzb3VyY2VNYW5hZ2VyLmdldEF1ZGlvQnVmZmVyKCJBdWRpby9Tb3VuZHMvIiArIG5hbWUpOwogICAgICAgIGlmIChidWZmZXIgJiYgYnVmZmVyLmxvYWRlZCkgewogICAgICAgICAgaWYgKGJ1ZmZlci5kZWNvZGVkKSB7CiAgICAgICAgICAgIHJlZmVyZW5jZSA9IG5ldyBHUy5BdWRpb0J1ZmZlclJlZmVyZW5jZShidWZmZXIpOwogICAgICAgICAgICBpZiAobXVzaWNFZmZlY3QpIHsKICAgICAgICAgICAgICByZWZlcmVuY2Uub25FbmQgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5yZXN1bWVNdXNpYyg0MCk7CiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZWZlcmVuY2UucGxheSgpOwogICAgICAgICAgICByZXR1cm4gdGhpcy5zb3VuZFJlZmVyZW5jZXNbbmFtZV0ucHVzaChyZWZlcmVuY2UpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgYnVmZmVyLm5hbWUgPSBuYW1lOwogICAgICAgICAgICBidWZmZXIub25EZWNvZGVGaW5pc2ggPSBmdW5jdGlvbihzb3VyY2UpIHsKICAgICAgICAgICAgICByZWZlcmVuY2UgPSBuZXcgR1MuQXVkaW9CdWZmZXJSZWZlcmVuY2Uoc291cmNlKTsKICAgICAgICAgICAgICBpZiAobXVzaWNFZmZlY3QpIHsKICAgICAgICAgICAgICAgIHJlZmVyZW5jZS5vbkVuZCA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMucmVzdW1lTXVzaWMoNDApOwogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgcmVmZXJlbmNlLnBsYXkoKTsKICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuc291bmRSZWZlcmVuY2VzW3NvdXJjZS5uYW1lXS5wdXNoKHJlZmVyZW5jZSk7CiAgICAgICAgICAgIH07CiAgICAgICAgICAgIHJldHVybiBidWZmZXIuZGVjb2RlKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9OwoKICAgIEF1ZGlvTWFuYWdlci5wcm90b3R5cGUucGxheU11c2ljID0gZnVuY3Rpb24obmFtZSwgdm9sdW1lLCByYXRlLCBmYWRlSW5UaW1lKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIGlmICgobmFtZSAhPSBudWxsKSAmJiAobmFtZS5uYW1lICE9IG51bGwpKSB7CiAgICAgICAgZmFkZUluVGltZSA9IHZvbHVtZTsKICAgICAgICB2b2x1bWUgPSBuYW1lLnZvbHVtZTsKICAgICAgICByYXRlID0gbmFtZS5wbGF5YmFja1JhdGU7CiAgICAgICAgbmFtZSA9IG5hbWUubmFtZTsKICAgICAgfQogICAgICB2b2x1bWUgPSB2b2x1bWUgIT0gbnVsbCA/IHZvbHVtZSA6IDEwMDsKICAgICAgdGhpcy5kaXNwb3NlTXVzaWMoKTsKICAgICAgaWYgKChuYW1lICE9IG51bGwpICYmIG5hbWUubGVuZ3RoID4gMCkgewogICAgICAgIHRoaXMubXVzaWMgPSB7CiAgICAgICAgICBuYW1lOiBuYW1lCiAgICAgICAgfTsKICAgICAgICB0aGlzLm11c2ljQnVmZmVyID0gdGhpcy5wbGF5KCJBdWRpby9NdXNpYy8iICsgbmFtZSwgdm9sdW1lLCByYXRlLCBmYWRlSW5UaW1lKTsKICAgICAgICByZXR1cm4gdGhpcy5tdXNpY0J1ZmZlci5vbkVuZCA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgcmV0dXJuIF90aGlzLm11c2ljQnVmZmVyLnBsYXkoKTsKICAgICAgICB9OwogICAgICB9CiAgICB9OwoKICAgIEF1ZGlvTWFuYWdlci5wcm90b3R5cGUucmVzdW1lTXVzaWMgPSBmdW5jdGlvbihmYWRlSW5UaW1lKSB7CiAgICAgIGlmICh0aGlzLm11c2ljQnVmZmVyICE9IG51bGwpIHsKICAgICAgICByZXR1cm4gdGhpcy5tdXNpY0J1ZmZlci5yZXN1bWUoZmFkZUluVGltZSk7CiAgICAgIH0KICAgIH07CgogICAgQXVkaW9NYW5hZ2VyLnByb3RvdHlwZS5wbGF5QmFja2dyb3VuZFNvdW5kID0gZnVuY3Rpb24obmFtZSwgdm9sdW1lLCByYXRlLCBmYWRlSW5UaW1lKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIGlmICgobmFtZSAhPSBudWxsKSAmJiAobmFtZS5uYW1lICE9IG51bGwpKSB7CiAgICAgICAgZmFkZUluVGltZSA9IHZvbHVtZTsKICAgICAgICB2b2x1bWUgPSBuYW1lLnZvbHVtZTsKICAgICAgICByYXRlID0gbmFtZS5wbGF5YmFja1JhdGU7CiAgICAgICAgbmFtZSA9IG5hbWUubmFtZTsKICAgICAgfQogICAgICB2b2x1bWUgPSB2b2x1bWUgIT0gbnVsbCA/IHZvbHVtZSA6IDEwMDsKICAgICAgdGhpcy5kaXNwb3NlQmFja2dyb3VuZFNvdW5kKCk7CiAgICAgIGlmICgobmFtZSAhPSBudWxsKSAmJiBuYW1lLmxlbmd0aCA+IDApIHsKICAgICAgICB0aGlzLmJhY2tncm91bmRTb3VuZCA9IHsKICAgICAgICAgIG5hbWU6IG5hbWUKICAgICAgICB9OwogICAgICAgIHRoaXMuYmFja2dyb3VuZFNvdW5kQnVmZmVyID0gdGhpcy5wbGF5KCJBdWRpby9CYWNrZ3JvdW5kU291bmRzLyIgKyBuYW1lLCB2b2x1bWUsIHJhdGUsIGZhZGVJblRpbWUpOwogICAgICAgIHJldHVybiB0aGlzLmJhY2tncm91bmRTb3VuZEJ1ZmZlci5vbkVuZCA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgcmV0dXJuIF90aGlzLmJhY2tncm91bmRTb3VuZEJ1ZmZlci5wbGF5KCk7CiAgICAgICAgfTsKICAgICAgfQogICAgfTsKCiAgICBBdWRpb01hbmFnZXIucHJvdG90eXBlLnN0b3BNdXNpYyA9IGZ1bmN0aW9uKGZhZGVPdXRUaW1lKSB7CiAgICAgIGlmICh0aGlzLm11c2ljQnVmZmVyICE9IG51bGwpIHsKICAgICAgICB0aGlzLm11c2ljQnVmZmVyLnN0b3AoZmFkZU91dFRpbWUpOwogICAgICB9CiAgICAgIHJldHVybiB0aGlzLm11c2ljID0gbnVsbDsKICAgIH07CgogICAgQXVkaW9NYW5hZ2VyLnByb3RvdHlwZS5zdG9wQmFja2dyb3VuZFNvdW5kID0gZnVuY3Rpb24oKSB7CiAgICAgIGlmICh0aGlzLmJhY2tncm91bmRTb3VuZEJ1ZmZlciAhPSBudWxsKSB7CiAgICAgICAgdGhpcy5iYWNrZ3JvdW5kU291bmRCdWZmZXIuc3RvcCgpOwogICAgICB9CiAgICAgIHJldHVybiB0aGlzLmJhY2tncm91bmRTb3VuZCA9IG51bGw7CiAgICB9OwoKICAgIEF1ZGlvTWFuYWdlci5wcm90b3R5cGUuZGlzcG9zZU11c2ljID0gZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMuc3RvcE11c2ljKCk7CiAgICAgIGlmICh0aGlzLm11c2ljQnVmZmVyICE9IG51bGwpIHsKICAgICAgICByZXR1cm4gdGhpcy5tdXNpY0J1ZmZlci5kaXNwb3NlKCk7CiAgICAgIH0KICAgIH07CgogICAgQXVkaW9NYW5hZ2VyLnByb3RvdHlwZS5kaXNwb3NlQmFja2dyb3VuZFNvdW5kID0gZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMuc3RvcEJhY2tncm91bmRTb3VuZCgpOwogICAgICBpZiAodGhpcy5iYWNrZ3JvdW5kU291bmRCdWZmZXIgIT0gbnVsbCkgewogICAgICAgIHJldHVybiB0aGlzLmJhY2tncm91bmRTb3VuZEJ1ZmZlci5kaXNwb3NlKCk7CiAgICAgIH0KICAgIH07CgogICAgcmV0dXJuIEF1ZGlvTWFuYWdlcjsKCiAgfSkoKTsKCiAgd2luZG93LkF1ZGlvTWFuYWdlciA9IG5ldyBBdWRpb01hbmFnZXIoKTsKCn0pLmNhbGwodGhpcyk7Cg=="},{"name":"RecordManager","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogUmVjb3JkTWFuYWdlcgojICAgICBDcmVhdGVkIG9uOiAyMDEzLTA1LTE5CiMKIyAJQ29weXJpZ2h0IChDKSAyMDEzIEFuZHLpIFJhZG9tc2tpLiBBbGwgcmlnaHRzIHJlc2VydmVkLgojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQojCiMgCUNsYXNzOiBSZWNvcmRNYW5hZ2VyCiMKIyAgIERlc2NyaXB0aW9uLi4uCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CmNsYXNzIFJlY29yZE1hbmFnZXIKICAgIGNvbnN0cnVjdG9yOiAtPgogICAgICAgIEBkb2N1bWVudHMgPSBudWxsCiAgICAgICAgQGNvbGxlY3Rpb25Eb2N1bWVudHMgPSBbXQogICAgbG9hZDogLT4KICAgICAgICBAZG9jdW1lbnRzID0gRGF0YU1hbmFnZXIuZ2V0RG9jdW1lbnRzQnlUeXBlKCJkYXRhX3JlY29yZCIpCgogICAgcHJlcGFyZTogLT4KICAgICAgICBmb3IgZG9jdW1lbnQgaW4gQGRvY3VtZW50cwogICAgICAgICAgICBpZiBub3QgdGhpc1tkb2N1bWVudC5pdGVtcy5jYXRlZ29yeV0/CiAgICAgICAgICAgICAgICB0aGlzW2RvY3VtZW50Lml0ZW1zLmNhdGVnb3J5XSA9IFtdCiAgICAgICAgICAgICAgICB0aGlzW2RvY3VtZW50Lml0ZW1zLmNhdGVnb3J5ICsgIkNvbGxlY3Rpb24iXSA9IFtdCiAgICAgICAgICAgICAgICBAY29sbGVjdGlvbkRvY3VtZW50cy5wdXNoKHRoaXNbZG9jdW1lbnQuaXRlbXMuY2F0ZWdvcnkgKyAiQ29sbGVjdGlvbiJdKQogICAgICAgICAgICB0aGlzW2RvY3VtZW50Lml0ZW1zLmNhdGVnb3J5XVtkb2N1bWVudC5pdGVtcy5pZF0gPSBkb2N1bWVudC5pdGVtcy5kYXRhCiAgICAgICAgICAgIHRoaXNbZG9jdW1lbnQuaXRlbXMuY2F0ZWdvcnkgKyAiQ29sbGVjdGlvbiJdW2RvY3VtZW50Lml0ZW1zLmlkXSA9IGRvY3VtZW50CiAgICAgICAgICAgIAogICAgICAgIEBhY3RvcnMgPSBAaGVyb3MgIyBOYW1pbmcgbWlzdGFrZS4uLgogICAgICAgIEBzeXN0ZW0gPSBAc3lzdGVtWzBdCiAgICAgICAgQHZvY2FidWxhcnkgPSBAdm9jYWJ1bGFyeVswXQogICAgICAKCndpbmRvdy5SZWNvcmRNYW5hZ2VyID0gbmV3IFJlY29yZE1hbmFnZXIoKQ==","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBSZWNvcmRNYW5hZ2VyOwoKICBSZWNvcmRNYW5hZ2VyID0gKGZ1bmN0aW9uKCkgewogICAgZnVuY3Rpb24gUmVjb3JkTWFuYWdlcigpIHsKICAgICAgdGhpcy5kb2N1bWVudHMgPSBudWxsOwogICAgICB0aGlzLmNvbGxlY3Rpb25Eb2N1bWVudHMgPSBbXTsKICAgIH0KCiAgICBSZWNvcmRNYW5hZ2VyLnByb3RvdHlwZS5sb2FkID0gZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiB0aGlzLmRvY3VtZW50cyA9IERhdGFNYW5hZ2VyLmdldERvY3VtZW50c0J5VHlwZSgiZGF0YV9yZWNvcmQiKTsKICAgIH07CgogICAgUmVjb3JkTWFuYWdlci5wcm90b3R5cGUucHJlcGFyZSA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgZG9jdW1lbnQsIF9pLCBfbGVuLCBfcmVmOwogICAgICBfcmVmID0gdGhpcy5kb2N1bWVudHM7CiAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gX3JlZi5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykgewogICAgICAgIGRvY3VtZW50ID0gX3JlZltfaV07CiAgICAgICAgaWYgKHRoaXNbZG9jdW1lbnQuaXRlbXMuY2F0ZWdvcnldID09IG51bGwpIHsKICAgICAgICAgIHRoaXNbZG9jdW1lbnQuaXRlbXMuY2F0ZWdvcnldID0gW107CiAgICAgICAgICB0aGlzW2RvY3VtZW50Lml0ZW1zLmNhdGVnb3J5ICsgIkNvbGxlY3Rpb24iXSA9IFtdOwogICAgICAgICAgdGhpcy5jb2xsZWN0aW9uRG9jdW1lbnRzLnB1c2godGhpc1tkb2N1bWVudC5pdGVtcy5jYXRlZ29yeSArICJDb2xsZWN0aW9uIl0pOwogICAgICAgIH0KICAgICAgICB0aGlzW2RvY3VtZW50Lml0ZW1zLmNhdGVnb3J5XVtkb2N1bWVudC5pdGVtcy5pZF0gPSBkb2N1bWVudC5pdGVtcy5kYXRhOwogICAgICAgIHRoaXNbZG9jdW1lbnQuaXRlbXMuY2F0ZWdvcnkgKyAiQ29sbGVjdGlvbiJdW2RvY3VtZW50Lml0ZW1zLmlkXSA9IGRvY3VtZW50OwogICAgICB9CiAgICAgIHRoaXMuYWN0b3JzID0gdGhpcy5oZXJvczsKICAgICAgdGhpcy5zeXN0ZW0gPSB0aGlzLnN5c3RlbVswXTsKICAgICAgcmV0dXJuIHRoaXMudm9jYWJ1bGFyeSA9IHRoaXMudm9jYWJ1bGFyeVswXTsKICAgIH07CgogICAgcmV0dXJuIFJlY29yZE1hbmFnZXI7CgogIH0pKCk7CgogIHdpbmRvdy5SZWNvcmRNYW5hZ2VyID0gbmV3IFJlY29yZE1hbmFnZXIoKTsKCn0pLmNhbGwodGhpcyk7Cg=="},{"name":"LanguageManager","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogTGFuZ3VhZ2VNYW5hZ2VyCiMgICBDcmVhdGVkIG9uOiAyMDEzLTExLTA5CiMKIyAgIENvcHlyaWdodCAoQykgMjAxMyBBbmRy6SBSYWRvbXNraS4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KIwojIAlDbGFzczogUmVjb3JkTWFuYWdlcgojCiMgICBEZXNjcmlwdGlvbi4uLgojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpjbGFzcyBMYW5ndWFnZU1hbmFnZXIKICAgIGNvbnN0cnVjdG9yOiAtPgogICAgICAgIEBkZWZhdWx0UHJvZmlsZSA9IG51bGwKICAgICAgICBAcHJvZmlsZSA9IG51bGwKICAgICAgICAKICAgIGluaXRpYWxpemU6IC0+CiAgICAgICAgQGxhbmd1YWdlcyA9IFtdCiAgICAgICAgZG9jdW1lbnRzID0gRGF0YU1hbmFnZXIuZ2V0RG9jdW1lbnRzQnlUeXBlKCJsYW5ndWFnZV9wcm9maWxlIikKICAgICAgICBmb3IgZG9jdW1lbnQgaW4gZG9jdW1lbnRzCiAgICAgICAgICAgIEBsYW5ndWFnZXMucHVzaCh7IG5hbWU6IGRvY3VtZW50Lml0ZW1zLm5hbWUsIHVpZDogZG9jdW1lbnQudWlkLCBpY29uOiBkb2N1bWVudC5pdGVtcy5pY29uIH0pCiAgICAgICAgICAgIGlmIGRvY3VtZW50LnVpZCA9PSAiMDdEREEwNzE2MTYxRjEwNCIKICAgICAgICAgICAgICAgIEBsYW5ndWFnZSA9IEBsYW5ndWFnZXNbQGxhbmd1YWdlcy5sZW5ndGgtMV0KICAgICAgICAgICAgICAgIEBkZWZhdWx0TGFuZ3VhZ2UgPSBAbGFuZ3VhZ2UKICAgICAgICAKICAgIGxvYWQ6IC0+CiAgICAgICAgQHByb2ZpbGUgPSBEYXRhTWFuYWdlci5nZXREb2N1bWVudChAbGFuZ3VhZ2UudWlkKQogICAgICAgIAogICAgICAgIGlmIEBsYW5ndWFnZS51aWQgIT0gQGRlZmF1bHRMYW5ndWFnZS51aWQKICAgICAgICAgICAgQGRlZmF1bHRQcm9maWxlID0gRGF0YU1hbmFnZXIuZ2V0RG9jdW1lbnQoQGRlZmF1bHRMYW5ndWFnZS51aWQpCiAgICAgICAgZWxzZQogICAgICAgICAgICBAZGVmYXVsdFByb2ZpbGUgPSBAcHJvZmlsZQogICAgICAgICAgICAKICAgIGxvYWRCdW5kbGVzOiAtPgogICAgICAgIEBwcm9maWxlLmJ1bmRsZXMgPSBbXQogICAgICAgIEBwcm9maWxlLmJ1bmRsZXNCeVVpZCA9IHt9CiAgICAgICAgCiAgICAgICAgaWYgQGxhbmd1YWdlICE9IEBkZWZhdWx0TGFuZ3VhZ2UKICAgICAgICAgICAgQGRlZmF1bHRQcm9maWxlLmJ1bmRsZXMgPSBbXQogICAgICAgICAgICBAZGVmYXVsdFByb2ZpbGUuYnVuZGxlc0J5VWlkID0ge30KICAgICAgICAKICAgICAgICAgICAgZm9yIGNvbGxlY3Rpb24gaW4gQHByb2ZpbGUuaXRlbXMuZGF0YVJlY29yZENvbGxlY3Rpb25zCiAgICAgICAgICAgICAgICBAcHJvZmlsZS5idW5kbGVzQnlVaWRbY29sbGVjdGlvbl0gPSBEYXRhTWFuYWdlci5nZXREb2N1bWVudChjb2xsZWN0aW9uKQogICAgICAgICAgICAgICAgQHByb2ZpbGUuYnVuZGxlcy5wdXNoKEBwcm9maWxlLmJ1bmRsZXNCeVVpZFtjb2xsZWN0aW9uXSkKICAgICAgICAgICAgZm9yIGNvbGxlY3Rpb25Eb2N1bWVudCBpbiBSZWNvcmRNYW5hZ2VyLmNvbGxlY3Rpb25Eb2N1bWVudHMKICAgICAgICAgICAgICAgIEBkZWZhdWx0UHJvZmlsZS5idW5kbGVzQnlVaWRbY29sbGVjdGlvbkRvY3VtZW50LnVpZF0gPSBjb2xsZWN0aW9uRG9jdW1lbnQKICAgICAgICAgICAgICAgIEBkZWZhdWx0UHJvZmlsZS5idW5kbGVzLnB1c2goY29sbGVjdGlvbkRvY3VtZW50KQogICAgICAgIGVsc2UKICAgICAgICAgICAgZm9yIGNvbGxlY3Rpb25Eb2N1bWVudCBpbiBSZWNvcmRNYW5hZ2VyLmNvbGxlY3Rpb25Eb2N1bWVudHMKICAgICAgICAgICAgICAgIEBwcm9maWxlLmJ1bmRsZXNCeVVpZFtjb2xsZWN0aW9uRG9jdW1lbnQudWlkXSA9IGNvbGxlY3Rpb25Eb2N1bWVudAogICAgICAgICAgICAgICAgQHByb2ZpbGUuYnVuZGxlcy5wdXNoKGNvbGxlY3Rpb25Eb2N1bWVudCkKICAgIAogICAgbG9hZE1hcEJ1bmRsZTogKG1hcFVpZCkgLT4KICAgICAgICBpbmRleCA9IEBkZWZhdWx0UHJvZmlsZS5pdGVtcy5tYXBzLmluZGV4T2YobWFwVWlkKQogICAgICAgIGJ1bmRsZVVpZCA9IEBwcm9maWxlLml0ZW1zLm1hcHNbaW5kZXhdOwogICAgICAgCiAgICAgICAgaWYgaW5kZXggIT0gLTEgYW5kIGJ1bmRsZVVpZD8KICAgICAgICAgICAgQG1hcEJ1bmRsZSA9IERhdGFNYW5hZ2VyLmdldERvY3VtZW50KGJ1bmRsZVVpZCkKICAgICAgICBlbHNlCiAgICAgICAgICAgIEBtYXBCdW5kbGUgPSBEYXRhTWFuYWdlci5nZXREb2N1bWVudChtYXBVaWQpCiAgICAgICAjIGZvciBtYXAgaW4gQHByb2ZpbGUuaXRlbXMubWFwcwogICAgICAgICAgICAKICAgIHByZXBhcmU6IC0+CiAgICAgICAga2V5cyA9IE9iamVjdC5rZXlzKEBwcm9maWxlLmJ1bmRsZXNCeVVpZCkKICAgICAgICBidW5kbGUgPSBudWxsCiAgICAgICAgZm9yIGtleSBpbiBrZXlzCiAgICAgICAgICAgIGJ1bmRsZSA9IEBwcm9maWxlLmJ1bmRsZXNCeVVpZFtrZXldCiAgICAgICAgICAgIGRlbGV0ZSBAcHJvZmlsZS5idW5kbGVzQnlVaWRba2V5XQogICAgICAgICAgICBpZiBidW5kbGUuaXRlbXM/IHRoZW4gQHByb2ZpbGUuYnVuZGxlc0J5VWlkW2J1bmRsZS5pdGVtcy5kZWZhdWx0VWlkXSA9IGJ1bmRsZQogICAgICAgICAgICAKICAgIHNlbGVjdExhbmd1YWdlOiAobGFuZ3VhZ2UpIC0+CiAgICAgICAgQGxhbmd1YWdlID0gbGFuZ3VhZ2UKICAgICAgICAKICAgIHN0cmluZzogKGlkKSAtPiAKICAgICAgICByZXN1bHQgPSBudWxsCiAgICAgICAgZm9yIGJ1bmRsZSBpbiBAcHJvZmlsZS5idW5kbGVzCiAgICAgICAgICAgIGlmIGJ1bmRsZS5pdGVtcz8gYW5kIGJ1bmRsZS5pdGVtcy5sb2NhbGl6YWJsZVN0cmluZ3M/CiAgICAgICAgICAgICAgICByZXN1bHQgPSBidW5kbGUuaXRlbXMubG9jYWxpemFibGVTdHJpbmdzW2lkXQogICAgICAgICAgICAgICAgaWYgcmVzdWx0PwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAKICAgICAgICBpZiBub3QgcmVzdWx0PyBvciByZXN1bHQubGVuZ3RoID09IDAKICAgICAgICAgICAgcmVzdWx0ID0gQHN0cmluZ0Zyb21EZWZhdWx0KGlkKQogICAgICAgICAgICAKICAgICAgICByZXR1cm4gcmVzdWx0CiAgICAgICAgCiAgICBzdHJpbmdGcm9tRGVmYXVsdDogKGlkKSAtPgogICAgICAgIHJlc3VsdCA9IG51bGwKICAgICAgICBmb3IgYnVuZGxlIGluIEBkZWZhdWx0UHJvZmlsZS5idW5kbGVzCiAgICAgICAgICAgIGlmIGJ1bmRsZS5pdGVtcz8gYW5kIGJ1bmRsZS5pdGVtcy5sb2NhbGl6YWJsZVN0cmluZ3M/CiAgICAgICAgICAgICAgICByZXN1bHQgPSBidW5kbGUuaXRlbXMubG9jYWxpemFibGVTdHJpbmdzW2lkXQogICAgICAgICAgICAgICAgaWYgcmVzdWx0PwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAKICAgICAgICAjaWYgbm90IHJlc3VsdD8gb3IgcmVzdWx0Lmxlbmd0aCA9PSAwCiAgICAgICAgIyAgICByZXN1bHQgPSAiTk9UIEZPVU5EOiAje2lkfSIKICAgICAgICAgICAgCiAgICAgICAgcmV0dXJuIHJlc3VsdAogICAgICAgIAogICAgc3RyaW5nRnJvbUJ1bmRsZTogKGlkLCBidW5kbGUpIC0+CiAgICAgICAgcmVzdWx0ID0gbnVsbAogICAgICAgIAogICAgICAgIGlmIGJ1bmRsZS5pdGVtcy5sb2NhbGl6YWJsZVN0cmluZ3M/CiAgICAgICAgICAgIHJlc3VsdCA9IGJ1bmRsZS5pdGVtcy5sb2NhbGl6YWJsZVN0cmluZ3NbaWRdCiAgICAKICAgICAgICByZXR1cm4gcmVzdWx0CiAgICAgICAgCiAgICBzdHJpbmdGcm9tQnVuZGxlV2l0aFVpZDogKGlkLCBidW5kbGVVaWQpIC0+CiAgICAgICAgYnVuZGxlID0gQHByb2ZpbGUuYnVuZGxlc0J5VWlkW2J1bmRsZVVpZF0KICAgICAgICAKICAgICAgICByZXR1cm4gQHN0cmluZ0Zyb21CdW5kbGUoaWQsIGJ1bmRsZSkKIAp3aW5kb3cuTGFuZ3VhZ2VNYW5hZ2VyID0gbmV3IExhbmd1YWdlTWFuYWdlcigpCgp3aW5kb3cubGNzID0gKHZhbHVlKSAtPiByZXR1cm4gaWYgdmFsdWUubGNJZD8gdGhlbiB3aW5kb3cuTGFuZ3VhZ2VNYW5hZ2VyLnN0cmluZyh2YWx1ZS5sY0lkKSB8fCB2YWx1ZS5kZWZhdWx0VGV4dCBlbHNlIHZhbHVlCndpbmRvdy5sY3NtID0gKHZhbHVlKSAtPiByZXR1cm4gaWYgdmFsdWUubGNJZD8gdGhlbiB3aW5kb3cuTGFuZ3VhZ2VNYW5hZ2VyLnN0cmluZ0Zyb21CdW5kbGUodmFsdWUubGNJZCwgd2luZG93Lkxhbmd1YWdlTWFuYWdlci5tYXBCdW5kbGUpIHx8IHZhbHVlLmRlZmF1bHRUZXh0IGVsc2UgdmFsdWUKd2luZG93Lmxjc2QgPSAodmFsdWUsIHVpZCkgLT4gcmV0dXJuIGlmIHZhbHVlLmxjSWQ/IHRoZW4gd2luZG93Lkxhbmd1YWdlTWFuYWdlci5zdHJpbmdGcm9tQnVuZGxlV2l0aFVpZCh2YWx1ZS5sY0lkLCB1aWQpIHx8IHZhbHVlLmRlZmF1bHRUZXh0IGVsc2UgdmFsdWUKd2luZG93Lmxjc2RBY3RvcnMgPSAodmFsdWUpIC0+IHJldHVybiBsY3NkKHZhbHVlLCBSZWNvcmRNYW5hZ2VyLmFjdG9yc0NvbGxlY3Rpb24udWlkKQp3aW5kb3cubGNzZEVuZW1pZXMgPSAodmFsdWUpIC0+IHJldHVybiBsY3NkKHZhbHVlLCBSZWNvcmRNYW5hZ2VyLmVuZW1pZXNDb2xsZWN0aW9uLnVpZCkKd2luZG93Lmxjc2RJdGVtcyA9ICh2YWx1ZSkgLT4gcmV0dXJuIGxjc2QodmFsdWUsIFJlY29yZE1hbmFnZXIuaXRlbXNDb2xsZWN0aW9uLnVpZCkKd2luZG93Lmxjc2RXZWFwb25zID0gKHZhbHVlKSAtPiByZXR1cm4gbGNzZCh2YWx1ZSwgUmVjb3JkTWFuYWdlci53ZWFwb25zQ29sbGVjdGlvbi51aWQpCndpbmRvdy5sY3NkQXJtb3JzID0gKHZhbHVlKSAtPiByZXR1cm4gbGNzZCh2YWx1ZSwgUmVjb3JkTWFuYWdlci5hcm1vcnNDb2xsZWN0aW9uLnVpZCkKd2luZG93Lmxjc2RTdGF0ZXMgPSAodmFsdWUpIC0+IHJldHVybiBsY3NkKHZhbHVlLCBSZWNvcmRNYW5hZ2VyLnN0YXRlc0NvbGxlY3Rpb24udWlkKQp3aW5kb3cubGNzZFNraWxscyA9ICh2YWx1ZSkgLT4gcmV0dXJuIGxjc2QodmFsdWUsIFJlY29yZE1hbmFnZXIuc2tpbGxzQ29sbGVjdGlvbi51aWQpCndpbmRvdy5sY3NkU2tpbGxUeXBlcyA9ICh2YWx1ZSkgLT4gcmV0dXJuIGxjc2QodmFsdWUsIFJlY29yZE1hbmFnZXIuc2tpbGxUeXBlc0NvbGxlY3Rpb24udWlkKQp3aW5kb3cubGNzZFdlYXBvblR5cGVzID0gKHZhbHVlKSAtPiByZXR1cm4gbGNzZCh2YWx1ZSwgUmVjb3JkTWFuYWdlci53ZWFwb25UeXBlc0NvbGxlY3Rpb24udWlkKQp3aW5kb3cubGNzZENsYXNzZXMgPSAodmFsdWUpIC0+IHJldHVybiBsY3NkKHZhbHVlLCBSZWNvcmRNYW5hZ2VyLmNsYXNzZXNDb2xsZWN0aW9uLnVpZCkKd2luZG93Lmxjc2RUcm9vcHMgPSAodmFsdWUpIC0+IHJldHVybiBsY3NkKHZhbHVlLCBSZWNvcmRNYW5hZ2VyLnRyb29wc0NvbGxlY3Rpb24udWlkKQp3aW5kb3cubGNzZFRpbGVzZXRzID0gKHZhbHVlKSAtPiByZXR1cm4gbGNzZCh2YWx1ZSwgUmVjb3JkTWFuYWdlci50aWxlc2V0c0NvbGxlY3Rpb24udWlkKQp3aW5kb3cubGNzZEFuaW1hdGlvbnMgPSAodmFsdWUpIC0+IHJldHVybiBsY3NkKHZhbHVlLCBSZWNvcmRNYW5hZ2VyLmFuaW1hdGlvbnNDb2xsZWN0aW9uLnVpZCkKd2luZG93Lmxjc2RTaW1wbGVBbmltYXRpb25zID0gKHZhbHVlKSAtPiByZXR1cm4gbGNzZCh2YWx1ZSwgUmVjb3JkTWFuYWdlci5zaW1wbGVBbmltYXRpb25zQ29sbGVjdGlvbi51aWQpCndpbmRvdy5sY3NkU3lzdGVtID0gKHZhbHVlKSAtPiByZXR1cm4gbGNzZCh2YWx1ZSwgUmVjb3JkTWFuYWdlci5zeXN0ZW1Db2xsZWN0aW9uLnVpZCkKd2luZG93Lmxjc2RFdmVudFRlbXBsYXRlcyA9ICh2YWx1ZSkgLT4gcmV0dXJuIGxjc2QodmFsdWUsIFJlY29yZE1hbmFnZXIuZXZlbnRUZW1wbGF0ZXNDb2xsZWN0aW9uLnVpZCkKCiAgICAgICAgCg==","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBMYW5ndWFnZU1hbmFnZXI7CgogIExhbmd1YWdlTWFuYWdlciA9IChmdW5jdGlvbigpIHsKICAgIGZ1bmN0aW9uIExhbmd1YWdlTWFuYWdlcigpIHsKICAgICAgdGhpcy5kZWZhdWx0UHJvZmlsZSA9IG51bGw7CiAgICAgIHRoaXMucHJvZmlsZSA9IG51bGw7CiAgICB9CgogICAgTGFuZ3VhZ2VNYW5hZ2VyLnByb3RvdHlwZS5pbml0aWFsaXplID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBkb2N1bWVudCwgZG9jdW1lbnRzLCBfaSwgX2xlbiwgX3Jlc3VsdHM7CiAgICAgIHRoaXMubGFuZ3VhZ2VzID0gW107CiAgICAgIGRvY3VtZW50cyA9IERhdGFNYW5hZ2VyLmdldERvY3VtZW50c0J5VHlwZSgibGFuZ3VhZ2VfcHJvZmlsZSIpOwogICAgICBfcmVzdWx0cyA9IFtdOwogICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IGRvY3VtZW50cy5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykgewogICAgICAgIGRvY3VtZW50ID0gZG9jdW1lbnRzW19pXTsKICAgICAgICB0aGlzLmxhbmd1YWdlcy5wdXNoKHsKICAgICAgICAgIG5hbWU6IGRvY3VtZW50Lml0ZW1zLm5hbWUsCiAgICAgICAgICB1aWQ6IGRvY3VtZW50LnVpZCwKICAgICAgICAgIGljb246IGRvY3VtZW50Lml0ZW1zLmljb24KICAgICAgICB9KTsKICAgICAgICBpZiAoZG9jdW1lbnQudWlkID09PSAiMDdEREEwNzE2MTYxRjEwNCIpIHsKICAgICAgICAgIHRoaXMubGFuZ3VhZ2UgPSB0aGlzLmxhbmd1YWdlc1t0aGlzLmxhbmd1YWdlcy5sZW5ndGggLSAxXTsKICAgICAgICAgIF9yZXN1bHRzLnB1c2godGhpcy5kZWZhdWx0TGFuZ3VhZ2UgPSB0aGlzLmxhbmd1YWdlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgX3Jlc3VsdHMucHVzaCh2b2lkIDApOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gX3Jlc3VsdHM7CiAgICB9OwoKICAgIExhbmd1YWdlTWFuYWdlci5wcm90b3R5cGUubG9hZCA9IGZ1bmN0aW9uKCkgewogICAgICB0aGlzLnByb2ZpbGUgPSBEYXRhTWFuYWdlci5nZXREb2N1bWVudCh0aGlzLmxhbmd1YWdlLnVpZCk7CiAgICAgIGlmICh0aGlzLmxhbmd1YWdlLnVpZCAhPT0gdGhpcy5kZWZhdWx0TGFuZ3VhZ2UudWlkKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuZGVmYXVsdFByb2ZpbGUgPSBEYXRhTWFuYWdlci5nZXREb2N1bWVudCh0aGlzLmRlZmF1bHRMYW5ndWFnZS51aWQpOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiB0aGlzLmRlZmF1bHRQcm9maWxlID0gdGhpcy5wcm9maWxlOwogICAgICB9CiAgICB9OwoKICAgIExhbmd1YWdlTWFuYWdlci5wcm90b3R5cGUubG9hZEJ1bmRsZXMgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGNvbGxlY3Rpb24sIGNvbGxlY3Rpb25Eb2N1bWVudCwgX2ksIF9qLCBfaywgX2xlbiwgX2xlbjEsIF9sZW4yLCBfcmVmLCBfcmVmMSwgX3JlZjIsIF9yZXN1bHRzLCBfcmVzdWx0czE7CiAgICAgIHRoaXMucHJvZmlsZS5idW5kbGVzID0gW107CiAgICAgIHRoaXMucHJvZmlsZS5idW5kbGVzQnlVaWQgPSB7fTsKICAgICAgaWYgKHRoaXMubGFuZ3VhZ2UgIT09IHRoaXMuZGVmYXVsdExhbmd1YWdlKSB7CiAgICAgICAgdGhpcy5kZWZhdWx0UHJvZmlsZS5idW5kbGVzID0gW107CiAgICAgICAgdGhpcy5kZWZhdWx0UHJvZmlsZS5idW5kbGVzQnlVaWQgPSB7fTsKICAgICAgICBfcmVmID0gdGhpcy5wcm9maWxlLml0ZW1zLmRhdGFSZWNvcmRDb2xsZWN0aW9uczsKICAgICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICAgIGNvbGxlY3Rpb24gPSBfcmVmW19pXTsKICAgICAgICAgIHRoaXMucHJvZmlsZS5idW5kbGVzQnlVaWRbY29sbGVjdGlvbl0gPSBEYXRhTWFuYWdlci5nZXREb2N1bWVudChjb2xsZWN0aW9uKTsKICAgICAgICAgIHRoaXMucHJvZmlsZS5idW5kbGVzLnB1c2godGhpcy5wcm9maWxlLmJ1bmRsZXNCeVVpZFtjb2xsZWN0aW9uXSk7CiAgICAgICAgfQogICAgICAgIF9yZWYxID0gUmVjb3JkTWFuYWdlci5jb2xsZWN0aW9uRG9jdW1lbnRzOwogICAgICAgIF9yZXN1bHRzID0gW107CiAgICAgICAgZm9yIChfaiA9IDAsIF9sZW4xID0gX3JlZjEubGVuZ3RoOyBfaiA8IF9sZW4xOyBfaisrKSB7CiAgICAgICAgICBjb2xsZWN0aW9uRG9jdW1lbnQgPSBfcmVmMVtfal07CiAgICAgICAgICB0aGlzLmRlZmF1bHRQcm9maWxlLmJ1bmRsZXNCeVVpZFtjb2xsZWN0aW9uRG9jdW1lbnQudWlkXSA9IGNvbGxlY3Rpb25Eb2N1bWVudDsKICAgICAgICAgIF9yZXN1bHRzLnB1c2godGhpcy5kZWZhdWx0UHJvZmlsZS5idW5kbGVzLnB1c2goY29sbGVjdGlvbkRvY3VtZW50KSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBfcmVzdWx0czsKICAgICAgfSBlbHNlIHsKICAgICAgICBfcmVmMiA9IFJlY29yZE1hbmFnZXIuY29sbGVjdGlvbkRvY3VtZW50czsKICAgICAgICBfcmVzdWx0czEgPSBbXTsKICAgICAgICBmb3IgKF9rID0gMCwgX2xlbjIgPSBfcmVmMi5sZW5ndGg7IF9rIDwgX2xlbjI7IF9rKyspIHsKICAgICAgICAgIGNvbGxlY3Rpb25Eb2N1bWVudCA9IF9yZWYyW19rXTsKICAgICAgICAgIHRoaXMucHJvZmlsZS5idW5kbGVzQnlVaWRbY29sbGVjdGlvbkRvY3VtZW50LnVpZF0gPSBjb2xsZWN0aW9uRG9jdW1lbnQ7CiAgICAgICAgICBfcmVzdWx0czEucHVzaCh0aGlzLnByb2ZpbGUuYnVuZGxlcy5wdXNoKGNvbGxlY3Rpb25Eb2N1bWVudCkpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gX3Jlc3VsdHMxOwogICAgICB9CiAgICB9OwoKICAgIExhbmd1YWdlTWFuYWdlci5wcm90b3R5cGUubG9hZE1hcEJ1bmRsZSA9IGZ1bmN0aW9uKG1hcFVpZCkgewogICAgICB2YXIgYnVuZGxlVWlkLCBpbmRleDsKICAgICAgaW5kZXggPSB0aGlzLmRlZmF1bHRQcm9maWxlLml0ZW1zLm1hcHMuaW5kZXhPZihtYXBVaWQpOwogICAgICBidW5kbGVVaWQgPSB0aGlzLnByb2ZpbGUuaXRlbXMubWFwc1tpbmRleF07CiAgICAgIGlmIChpbmRleCAhPT0gLTEgJiYgKGJ1bmRsZVVpZCAhPSBudWxsKSkgewogICAgICAgIHJldHVybiB0aGlzLm1hcEJ1bmRsZSA9IERhdGFNYW5hZ2VyLmdldERvY3VtZW50KGJ1bmRsZVVpZCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIHRoaXMubWFwQnVuZGxlID0gRGF0YU1hbmFnZXIuZ2V0RG9jdW1lbnQobWFwVWlkKTsKICAgICAgfQogICAgfTsKCiAgICBMYW5ndWFnZU1hbmFnZXIucHJvdG90eXBlLnByZXBhcmUgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGJ1bmRsZSwga2V5LCBrZXlzLCBfaSwgX2xlbiwgX3Jlc3VsdHM7CiAgICAgIGtleXMgPSBPYmplY3Qua2V5cyh0aGlzLnByb2ZpbGUuYnVuZGxlc0J5VWlkKTsKICAgICAgYnVuZGxlID0gbnVsbDsKICAgICAgX3Jlc3VsdHMgPSBbXTsKICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBrZXlzLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7CiAgICAgICAga2V5ID0ga2V5c1tfaV07CiAgICAgICAgYnVuZGxlID0gdGhpcy5wcm9maWxlLmJ1bmRsZXNCeVVpZFtrZXldOwogICAgICAgIGRlbGV0ZSB0aGlzLnByb2ZpbGUuYnVuZGxlc0J5VWlkW2tleV07CiAgICAgICAgaWYgKGJ1bmRsZS5pdGVtcyAhPSBudWxsKSB7CiAgICAgICAgICBfcmVzdWx0cy5wdXNoKHRoaXMucHJvZmlsZS5idW5kbGVzQnlVaWRbYnVuZGxlLml0ZW1zLmRlZmF1bHRVaWRdID0gYnVuZGxlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgX3Jlc3VsdHMucHVzaCh2b2lkIDApOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gX3Jlc3VsdHM7CiAgICB9OwoKICAgIExhbmd1YWdlTWFuYWdlci5wcm90b3R5cGUuc2VsZWN0TGFuZ3VhZ2UgPSBmdW5jdGlvbihsYW5ndWFnZSkgewogICAgICByZXR1cm4gdGhpcy5sYW5ndWFnZSA9IGxhbmd1YWdlOwogICAgfTsKCiAgICBMYW5ndWFnZU1hbmFnZXIucHJvdG90eXBlLnN0cmluZyA9IGZ1bmN0aW9uKGlkKSB7CiAgICAgIHZhciBidW5kbGUsIHJlc3VsdCwgX2ksIF9sZW4sIF9yZWY7CiAgICAgIHJlc3VsdCA9IG51bGw7CiAgICAgIF9yZWYgPSB0aGlzLnByb2ZpbGUuYnVuZGxlczsKICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBfcmVmLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7CiAgICAgICAgYnVuZGxlID0gX3JlZltfaV07CiAgICAgICAgaWYgKChidW5kbGUuaXRlbXMgIT0gbnVsbCkgJiYgKGJ1bmRsZS5pdGVtcy5sb2NhbGl6YWJsZVN0cmluZ3MgIT0gbnVsbCkpIHsKICAgICAgICAgIHJlc3VsdCA9IGJ1bmRsZS5pdGVtcy5sb2NhbGl6YWJsZVN0cmluZ3NbaWRdOwogICAgICAgICAgaWYgKHJlc3VsdCAhPSBudWxsKSB7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICBpZiAoKHJlc3VsdCA9PSBudWxsKSB8fCByZXN1bHQubGVuZ3RoID09PSAwKSB7CiAgICAgICAgcmVzdWx0ID0gdGhpcy5zdHJpbmdGcm9tRGVmYXVsdChpZCk7CiAgICAgIH0KICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH07CgogICAgTGFuZ3VhZ2VNYW5hZ2VyLnByb3RvdHlwZS5zdHJpbmdGcm9tRGVmYXVsdCA9IGZ1bmN0aW9uKGlkKSB7CiAgICAgIHZhciBidW5kbGUsIHJlc3VsdCwgX2ksIF9sZW4sIF9yZWY7CiAgICAgIHJlc3VsdCA9IG51bGw7CiAgICAgIF9yZWYgPSB0aGlzLmRlZmF1bHRQcm9maWxlLmJ1bmRsZXM7CiAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gX3JlZi5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykgewogICAgICAgIGJ1bmRsZSA9IF9yZWZbX2ldOwogICAgICAgIGlmICgoYnVuZGxlLml0ZW1zICE9IG51bGwpICYmIChidW5kbGUuaXRlbXMubG9jYWxpemFibGVTdHJpbmdzICE9IG51bGwpKSB7CiAgICAgICAgICByZXN1bHQgPSBidW5kbGUuaXRlbXMubG9jYWxpemFibGVTdHJpbmdzW2lkXTsKICAgICAgICAgIGlmIChyZXN1bHQgIT0gbnVsbCkgewogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH07CgogICAgTGFuZ3VhZ2VNYW5hZ2VyLnByb3RvdHlwZS5zdHJpbmdGcm9tQnVuZGxlID0gZnVuY3Rpb24oaWQsIGJ1bmRsZSkgewogICAgICB2YXIgcmVzdWx0OwogICAgICByZXN1bHQgPSBudWxsOwogICAgICBpZiAoYnVuZGxlLml0ZW1zLmxvY2FsaXphYmxlU3RyaW5ncyAhPSBudWxsKSB7CiAgICAgICAgcmVzdWx0ID0gYnVuZGxlLml0ZW1zLmxvY2FsaXphYmxlU3RyaW5nc1tpZF07CiAgICAgIH0KICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH07CgogICAgTGFuZ3VhZ2VNYW5hZ2VyLnByb3RvdHlwZS5zdHJpbmdGcm9tQnVuZGxlV2l0aFVpZCA9IGZ1bmN0aW9uKGlkLCBidW5kbGVVaWQpIHsKICAgICAgdmFyIGJ1bmRsZTsKICAgICAgYnVuZGxlID0gdGhpcy5wcm9maWxlLmJ1bmRsZXNCeVVpZFtidW5kbGVVaWRdOwogICAgICByZXR1cm4gdGhpcy5zdHJpbmdGcm9tQnVuZGxlKGlkLCBidW5kbGUpOwogICAgfTsKCiAgICByZXR1cm4gTGFuZ3VhZ2VNYW5hZ2VyOwoKICB9KSgpOwoKICB3aW5kb3cuTGFuZ3VhZ2VNYW5hZ2VyID0gbmV3IExhbmd1YWdlTWFuYWdlcigpOwoKICB3aW5kb3cubGNzID0gZnVuY3Rpb24odmFsdWUpIHsKICAgIGlmICh2YWx1ZS5sY0lkICE9IG51bGwpIHsKICAgICAgcmV0dXJuIHdpbmRvdy5MYW5ndWFnZU1hbmFnZXIuc3RyaW5nKHZhbHVlLmxjSWQpIHx8IHZhbHVlLmRlZmF1bHRUZXh0OwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIHZhbHVlOwogICAgfQogIH07CgogIHdpbmRvdy5sY3NtID0gZnVuY3Rpb24odmFsdWUpIHsKICAgIGlmICh2YWx1ZS5sY0lkICE9IG51bGwpIHsKICAgICAgcmV0dXJuIHdpbmRvdy5MYW5ndWFnZU1hbmFnZXIuc3RyaW5nRnJvbUJ1bmRsZSh2YWx1ZS5sY0lkLCB3aW5kb3cuTGFuZ3VhZ2VNYW5hZ2VyLm1hcEJ1bmRsZSkgfHwgdmFsdWUuZGVmYXVsdFRleHQ7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gdmFsdWU7CiAgICB9CiAgfTsKCiAgd2luZG93Lmxjc2QgPSBmdW5jdGlvbih2YWx1ZSwgdWlkKSB7CiAgICBpZiAodmFsdWUubGNJZCAhPSBudWxsKSB7CiAgICAgIHJldHVybiB3aW5kb3cuTGFuZ3VhZ2VNYW5hZ2VyLnN0cmluZ0Zyb21CdW5kbGVXaXRoVWlkKHZhbHVlLmxjSWQsIHVpZCkgfHwgdmFsdWUuZGVmYXVsdFRleHQ7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gdmFsdWU7CiAgICB9CiAgfTsKCiAgd2luZG93Lmxjc2RBY3RvcnMgPSBmdW5jdGlvbih2YWx1ZSkgewogICAgcmV0dXJuIGxjc2QodmFsdWUsIFJlY29yZE1hbmFnZXIuYWN0b3JzQ29sbGVjdGlvbi51aWQpOwogIH07CgogIHdpbmRvdy5sY3NkRW5lbWllcyA9IGZ1bmN0aW9uKHZhbHVlKSB7CiAgICByZXR1cm4gbGNzZCh2YWx1ZSwgUmVjb3JkTWFuYWdlci5lbmVtaWVzQ29sbGVjdGlvbi51aWQpOwogIH07CgogIHdpbmRvdy5sY3NkSXRlbXMgPSBmdW5jdGlvbih2YWx1ZSkgewogICAgcmV0dXJuIGxjc2QodmFsdWUsIFJlY29yZE1hbmFnZXIuaXRlbXNDb2xsZWN0aW9uLnVpZCk7CiAgfTsKCiAgd2luZG93Lmxjc2RXZWFwb25zID0gZnVuY3Rpb24odmFsdWUpIHsKICAgIHJldHVybiBsY3NkKHZhbHVlLCBSZWNvcmRNYW5hZ2VyLndlYXBvbnNDb2xsZWN0aW9uLnVpZCk7CiAgfTsKCiAgd2luZG93Lmxjc2RBcm1vcnMgPSBmdW5jdGlvbih2YWx1ZSkgewogICAgcmV0dXJuIGxjc2QodmFsdWUsIFJlY29yZE1hbmFnZXIuYXJtb3JzQ29sbGVjdGlvbi51aWQpOwogIH07CgogIHdpbmRvdy5sY3NkU3RhdGVzID0gZnVuY3Rpb24odmFsdWUpIHsKICAgIHJldHVybiBsY3NkKHZhbHVlLCBSZWNvcmRNYW5hZ2VyLnN0YXRlc0NvbGxlY3Rpb24udWlkKTsKICB9OwoKICB3aW5kb3cubGNzZFNraWxscyA9IGZ1bmN0aW9uKHZhbHVlKSB7CiAgICByZXR1cm4gbGNzZCh2YWx1ZSwgUmVjb3JkTWFuYWdlci5za2lsbHNDb2xsZWN0aW9uLnVpZCk7CiAgfTsKCiAgd2luZG93Lmxjc2RTa2lsbFR5cGVzID0gZnVuY3Rpb24odmFsdWUpIHsKICAgIHJldHVybiBsY3NkKHZhbHVlLCBSZWNvcmRNYW5hZ2VyLnNraWxsVHlwZXNDb2xsZWN0aW9uLnVpZCk7CiAgfTsKCiAgd2luZG93Lmxjc2RXZWFwb25UeXBlcyA9IGZ1bmN0aW9uKHZhbHVlKSB7CiAgICByZXR1cm4gbGNzZCh2YWx1ZSwgUmVjb3JkTWFuYWdlci53ZWFwb25UeXBlc0NvbGxlY3Rpb24udWlkKTsKICB9OwoKICB3aW5kb3cubGNzZENsYXNzZXMgPSBmdW5jdGlvbih2YWx1ZSkgewogICAgcmV0dXJuIGxjc2QodmFsdWUsIFJlY29yZE1hbmFnZXIuY2xhc3Nlc0NvbGxlY3Rpb24udWlkKTsKICB9OwoKICB3aW5kb3cubGNzZFRyb29wcyA9IGZ1bmN0aW9uKHZhbHVlKSB7CiAgICByZXR1cm4gbGNzZCh2YWx1ZSwgUmVjb3JkTWFuYWdlci50cm9vcHNDb2xsZWN0aW9uLnVpZCk7CiAgfTsKCiAgd2luZG93Lmxjc2RUaWxlc2V0cyA9IGZ1bmN0aW9uKHZhbHVlKSB7CiAgICByZXR1cm4gbGNzZCh2YWx1ZSwgUmVjb3JkTWFuYWdlci50aWxlc2V0c0NvbGxlY3Rpb24udWlkKTsKICB9OwoKICB3aW5kb3cubGNzZEFuaW1hdGlvbnMgPSBmdW5jdGlvbih2YWx1ZSkgewogICAgcmV0dXJuIGxjc2QodmFsdWUsIFJlY29yZE1hbmFnZXIuYW5pbWF0aW9uc0NvbGxlY3Rpb24udWlkKTsKICB9OwoKICB3aW5kb3cubGNzZFNpbXBsZUFuaW1hdGlvbnMgPSBmdW5jdGlvbih2YWx1ZSkgewogICAgcmV0dXJuIGxjc2QodmFsdWUsIFJlY29yZE1hbmFnZXIuc2ltcGxlQW5pbWF0aW9uc0NvbGxlY3Rpb24udWlkKTsKICB9OwoKICB3aW5kb3cubGNzZFN5c3RlbSA9IGZ1bmN0aW9uKHZhbHVlKSB7CiAgICByZXR1cm4gbGNzZCh2YWx1ZSwgUmVjb3JkTWFuYWdlci5zeXN0ZW1Db2xsZWN0aW9uLnVpZCk7CiAgfTsKCiAgd2luZG93Lmxjc2RFdmVudFRlbXBsYXRlcyA9IGZ1bmN0aW9uKHZhbHVlKSB7CiAgICByZXR1cm4gbGNzZCh2YWx1ZSwgUmVjb3JkTWFuYWdlci5ldmVudFRlbXBsYXRlc0NvbGxlY3Rpb24udWlkKTsKICB9OwoKfSkuY2FsbCh0aGlzKTsK"},{"name":"Colors","content":"# ===================================================================\n#\n#   Script: Colors\n#   Created on: 2013-09-19\n#\n#   Copyright (C) 2013 AndrÃ© Radomski. All rights reserved.\n#\n# ===================================================================\n#\n# \tClass: Colors\n#\n#   Common used colors\n#\n# ===================================================================\n\nclass Colors\n    @WHITE = new Color(255, 255, 255)\n    @BLACK = new Color(0, 0, 0)\n    @DARK_GREY = new Color(160, 160, 160)\n    @GREEN = new Color(0, 255, 0)\n    @RED = new Color(255, 0, 0)\n    @BLUE = new Color(0, 0, 255)\n    @YELLOW = new Color(255, 255, 0)\n    @ORANGE = new Color(255, 200, 0)\n    @TEXT_NORMAL = new Color(255, 255, 255)\n    @EXP_GAUGE1 = new Color(0, 120, 130)\n    @EXP_GAUGE2 = new Color(0, 160, 170)\n    @LP_GAUGE1 = new Color(255, 0, 0)\n    @LP_GAUGE2 = new Color(255, 150, 0)\n    @MP_GAUGE1 = new Color(0, 0, 255)\n    @MP_GAUGE2 = new Color(0, 150, 255)\n    @LP_DAMAGE = @RED\n    @MP_DAMAGE = new Color(0, 150, 255)\n    @BATTLER_SELECTION = new Color(255, 0, 0, 60)\n    @ENABLED_ITEM = new Color(255, 255, 255)\n    @DISABLED_ITEM = new Color(200, 200, 200)\n    @RAIN_PARTICLE = new Color(245, 245, 255)\n    @STORM_PARTICLE = @RAIN_PARTICLE\n    @SNOW_PARTICLE_FACE = new Color(255, 255, 255)\n    @SNOW_PARTICLE_EDGE = new Color(255, 255, 255, 0.5)\n    \n    \nwindow.Colors = Colors","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBDb2xvcnM7CgogIENvbG9ycyA9IChmdW5jdGlvbigpIHsKICAgIGZ1bmN0aW9uIENvbG9ycygpIHt9CgogICAgQ29sb3JzLldISVRFID0gbmV3IENvbG9yKDI1NSwgMjU1LCAyNTUpOwoKICAgIENvbG9ycy5CTEFDSyA9IG5ldyBDb2xvcigwLCAwLCAwKTsKCiAgICBDb2xvcnMuREFSS19HUkVZID0gbmV3IENvbG9yKDE2MCwgMTYwLCAxNjApOwoKICAgIENvbG9ycy5HUkVFTiA9IG5ldyBDb2xvcigwLCAyNTUsIDApOwoKICAgIENvbG9ycy5SRUQgPSBuZXcgQ29sb3IoMjU1LCAwLCAwKTsKCiAgICBDb2xvcnMuQkxVRSA9IG5ldyBDb2xvcigwLCAwLCAyNTUpOwoKICAgIENvbG9ycy5ZRUxMT1cgPSBuZXcgQ29sb3IoMjU1LCAyNTUsIDApOwoKICAgIENvbG9ycy5PUkFOR0UgPSBuZXcgQ29sb3IoMjU1LCAyMDAsIDApOwoKICAgIENvbG9ycy5URVhUX05PUk1BTCA9IG5ldyBDb2xvcigyNTUsIDI1NSwgMjU1KTsKCiAgICBDb2xvcnMuRVhQX0dBVUdFMSA9IG5ldyBDb2xvcigwLCAxMjAsIDEzMCk7CgogICAgQ29sb3JzLkVYUF9HQVVHRTIgPSBuZXcgQ29sb3IoMCwgMTYwLCAxNzApOwoKICAgIENvbG9ycy5MUF9HQVVHRTEgPSBuZXcgQ29sb3IoMjU1LCAwLCAwKTsKCiAgICBDb2xvcnMuTFBfR0FVR0UyID0gbmV3IENvbG9yKDI1NSwgMTUwLCAwKTsKCiAgICBDb2xvcnMuTVBfR0FVR0UxID0gbmV3IENvbG9yKDAsIDAsIDI1NSk7CgogICAgQ29sb3JzLk1QX0dBVUdFMiA9IG5ldyBDb2xvcigwLCAxNTAsIDI1NSk7CgogICAgQ29sb3JzLkxQX0RBTUFHRSA9IENvbG9ycy5SRUQ7CgogICAgQ29sb3JzLk1QX0RBTUFHRSA9IG5ldyBDb2xvcigwLCAxNTAsIDI1NSk7CgogICAgQ29sb3JzLkJBVFRMRVJfU0VMRUNUSU9OID0gbmV3IENvbG9yKDI1NSwgMCwgMCwgNjApOwoKICAgIENvbG9ycy5FTkFCTEVEX0lURU0gPSBuZXcgQ29sb3IoMjU1LCAyNTUsIDI1NSk7CgogICAgQ29sb3JzLkRJU0FCTEVEX0lURU0gPSBuZXcgQ29sb3IoMjAwLCAyMDAsIDIwMCk7CgogICAgQ29sb3JzLlJBSU5fUEFSVElDTEUgPSBuZXcgQ29sb3IoMjQ1LCAyNDUsIDI1NSk7CgogICAgQ29sb3JzLlNUT1JNX1BBUlRJQ0xFID0gQ29sb3JzLlJBSU5fUEFSVElDTEU7CgogICAgQ29sb3JzLlNOT1dfUEFSVElDTEVfRkFDRSA9IG5ldyBDb2xvcigyNTUsIDI1NSwgMjU1KTsKCiAgICBDb2xvcnMuU05PV19QQVJUSUNMRV9FREdFID0gbmV3IENvbG9yKDI1NSwgMjU1LCAyNTUsIDAuNSk7CgogICAgcmV0dXJuIENvbG9yczsKCiAgfSkoKTsKCiAgd2luZG93LkNvbG9ycyA9IENvbG9yczsKCn0pLmNhbGwodGhpcyk7Cg==","decoded":true},{"name":"Fonts","content":"# ===================================================================\n#\n#   Script: Fonts\n#   Created on: 2013-10-06\n#\n#   Copyright (C) 2013 AndrÃ© Radomski. All rights reserved.\n#\n# ===================================================================\n#\n#   Class: Fonts\n#\n#   Common used fonts\n#\n# ===================================================================\n\nclass Fonts\n    @DAMAGE = new Font(\"Verdana\", 12)\n    @TEXT = new Font(\"Verdana\", 11)\n    \n    @initialize: ->\n        size = if Graphics.width == 320 then 8 else 16\n        nameFont = RecordManager.system.nameFont\n        uiFont = RecordManager.system.uiFont\n        \n        @NAME = new Font(nameFont.name, size)\n        \n        #@NAME = ResourceManager.getFont(\"output_gsf\", 8) #new Font(nameFont.name, size)\n        @ACTION = @NAME #ResourceManager.getFont(\"output.gsf\", 8) #new Font(uiFont.name, size)\n        \n        @ACTION.border = uiFont.decoration.type == 2\n        @ACTION.shadow = uiFont.decoration.type == 1\n        @ACTION.color = new Color(uiFont.color)\n        @ACTION.borderColor = new Color(uiFont.decoration.color)\n        \n        @NAME.border = nameFont.decoration.type == 2\n        @NAME.shadow = nameFont.decoration.type == 1\n        @NAME.color = new Color(nameFont.color)\n        @NAME.borderColor = new Color(nameFont.decoration.color)\n        \n        @GAUGE = @ACTION\n        @MEMBER_NAME = @NAME\n        @DAMAGE = new Font(@ACTION)\n        @DAMAGE.border = yes\n        @TEXT = @ACTION # @DAMAGE #@actionFont\n    \nwindow.Fonts = Fonts","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBGb250czsKCiAgRm9udHMgPSAoZnVuY3Rpb24oKSB7CiAgICBmdW5jdGlvbiBGb250cygpIHt9CgogICAgRm9udHMuREFNQUdFID0gbmV3IEZvbnQoIlZlcmRhbmEiLCAxMik7CgogICAgRm9udHMuVEVYVCA9IG5ldyBGb250KCJWZXJkYW5hIiwgMTEpOwoKICAgIEZvbnRzLmluaXRpYWxpemUgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIG5hbWVGb250LCBzaXplLCB1aUZvbnQ7CiAgICAgIHNpemUgPSBHcmFwaGljcy53aWR0aCA9PT0gMzIwID8gOCA6IDE2OwogICAgICBuYW1lRm9udCA9IFJlY29yZE1hbmFnZXIuc3lzdGVtLm5hbWVGb250OwogICAgICB1aUZvbnQgPSBSZWNvcmRNYW5hZ2VyLnN5c3RlbS51aUZvbnQ7CiAgICAgIHRoaXMuTkFNRSA9IG5ldyBGb250KG5hbWVGb250Lm5hbWUsIHNpemUpOwogICAgICB0aGlzLkFDVElPTiA9IHRoaXMuTkFNRTsKICAgICAgdGhpcy5BQ1RJT04uYm9yZGVyID0gdWlGb250LmRlY29yYXRpb24udHlwZSA9PT0gMjsKICAgICAgdGhpcy5BQ1RJT04uc2hhZG93ID0gdWlGb250LmRlY29yYXRpb24udHlwZSA9PT0gMTsKICAgICAgdGhpcy5BQ1RJT04uY29sb3IgPSBuZXcgQ29sb3IodWlGb250LmNvbG9yKTsKICAgICAgdGhpcy5BQ1RJT04uYm9yZGVyQ29sb3IgPSBuZXcgQ29sb3IodWlGb250LmRlY29yYXRpb24uY29sb3IpOwogICAgICB0aGlzLk5BTUUuYm9yZGVyID0gbmFtZUZvbnQuZGVjb3JhdGlvbi50eXBlID09PSAyOwogICAgICB0aGlzLk5BTUUuc2hhZG93ID0gbmFtZUZvbnQuZGVjb3JhdGlvbi50eXBlID09PSAxOwogICAgICB0aGlzLk5BTUUuY29sb3IgPSBuZXcgQ29sb3IobmFtZUZvbnQuY29sb3IpOwogICAgICB0aGlzLk5BTUUuYm9yZGVyQ29sb3IgPSBuZXcgQ29sb3IobmFtZUZvbnQuZGVjb3JhdGlvbi5jb2xvcik7CiAgICAgIHRoaXMuR0FVR0UgPSB0aGlzLkFDVElPTjsKICAgICAgdGhpcy5NRU1CRVJfTkFNRSA9IHRoaXMuTkFNRTsKICAgICAgdGhpcy5EQU1BR0UgPSBuZXcgRm9udCh0aGlzLkFDVElPTik7CiAgICAgIHRoaXMuREFNQUdFLmJvcmRlciA9IHRydWU7CiAgICAgIHJldHVybiB0aGlzLlRFWFQgPSB0aGlzLkFDVElPTjsKICAgIH07CgogICAgcmV0dXJuIEZvbnRzOwoKICB9KSgpOwoKICB3aW5kb3cuRm9udHMgPSBGb250czsKCn0pLmNhbGwodGhpcyk7Cg==","decoded":true},{"name":"Logic_VariableStore","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogTG9naWNfVmFyaWFibGVTdG9yZQojICAgQ3JlYXRlZCBvbjogMjAxMy0xMi0wOQojCiMgICBDb3B5cmlnaHQgKEMpIDIwMTMgQW5kcukgUmFkb21za2kuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIENsYXNzOiBMb2dpY19WYXJpYWJsZVN0b3JlCiMKIyAgIEEgYmFzZSBjbGFzcyBmb3IgYWxsIG90aGVyIHdpbmRvdyBjbGFzc2VzLgojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKY2xhc3MgTG9naWNfVmFyaWFibGVTdG9yZQogICAgY29uc3RydWN0b3I6ICgpIC0+CiAgICAgICAgQG51bWJlcnMgPSBuZXcgQXJyYXkoNTAwMCkKICAgICAgICBAYm9vbGVhbnMgPSBuZXcgQXJyYXkoNTAwMCkKICAgICAgICBAc3RyaW5ncyA9IG5ldyBBcnJheSg1MDAwKQogICAgICAgIEBsb2NhbE51bWJlcnMgPSB7fQogICAgICAgIEBsb2NhbFN0cmluZ3MgPSB7fQogICAgICAgIEBsb2NhbEJvb2xlYW5zID0ge30KICAgICAgICBAdGVtcE51bWJlcnMgPSBudWxsCiAgICAgICAgQHRlbXBTdHJpbmdzID0gbnVsbAogICAgICAgIEB0ZW1wQm9vbGVhbnMgPSBudWxsCiAgICAgICAgCiAgICAgICAgCiAgICBzZXR1cDogKG1hcCkgLT4KICAgICAgICBAbWFwID0gbWFwCiAgICAgICAgCiAgICAgICAgQHNldHVwRXZlbnRWYXJpYWJsZXMoImxvY2FsTnVtYmVycyIsIDApCiAgICAgICAgQHNldHVwRXZlbnRWYXJpYWJsZXMoImxvY2FsU3RyaW5ncyIsICIiKQogICAgICAgIEBzZXR1cEV2ZW50VmFyaWFibGVzKCJsb2NhbEJvb2xlYW5zIiwgbm8pCiAgICAgICAgCiAgICAgICAgQHNldHVwQ29tbW9uRXZlbnRWYXJpYWJsZXMoImxvY2FsTnVtYmVycyIsIDApCiAgICAgICAgQHNldHVwQ29tbW9uRXZlbnRWYXJpYWJsZXMoImxvY2FsU3RyaW5ncyIsICIiKQogICAgICAgIEBzZXR1cENvbW1vbkV2ZW50VmFyaWFibGVzKCJsb2NhbEJvb2xlYW5zIiwgbm8pCiAgICAKICAgIHNldHVwRXZlbnRWYXJpYWJsZXM6IChwcm9wZXJ0eSwgZGVmYXVsdFZhbHVlKSAtPgogICAgICAgIGlmIG5vdCB0aGlzW3Byb3BlcnR5XVtAbWFwLmlkXT8KICAgICAgICAgICAgdGhpc1twcm9wZXJ0eV1bQG1hcC5pZF0gPSBbXQogICAgICAgIAogICAgICAgIGZvciBldmVudCBpbiBAbWFwLmV2ZW50cwogICAgICAgICAgICBpZiBub3QgdGhpc1twcm9wZXJ0eV1bQG1hcC5pZF1bZXZlbnQuaWRdPwogICAgICAgICAgICAgICAgdGhpc1twcm9wZXJ0eV1bQG1hcC5pZF1bZXZlbnQuaWRdID0gW2RlZmF1bHRWYWx1ZV0KICAgIAogICAgc2V0dXBDb21tb25FdmVudFZhcmlhYmxlczogKHByb3BlcnR5LCBkZWZhdWx0VmFsdWUpIC0+CiAgICAgICAgaWYgbm90IHRoaXNbcHJvcGVydHldWydDLUVWRU5UUyddPwogICAgICAgICAgICB0aGlzW3Byb3BlcnR5XVsnQy1FVkVOVFMnXSA9IFtdCiAgICAgICAgCiAgICAgICAgZm9yIGV2ZW50IGluIEdhbWVNYW5hZ2VyLmNvbW1vbkV2ZW50cwogICAgICAgICAgICBpZiBub3QgdGhpc1twcm9wZXJ0eV1bJ0MtRVZFTlRTJ11bZXZlbnQuaWRdPwogICAgICAgICAgICAgICAgdGhpc1twcm9wZXJ0eV1bJ0MtRVZFTlRTJ11bZXZlbnQuaWRdID0gW2RlZmF1bHRWYWx1ZV0KICAgICAgICAgICAgICAgIAogICAgc2V0TnVtYmVyVmFsdWVBdEluZGV4OiAoc2NvcGUsIGluZGV4LCB2YWx1ZSkgLT4KICAgICAgICBpZiBzY29wZSA9PSAxCiAgICAgICAgICAgIEBudW1iZXJzW2luZGV4XSA9IHZhbHVlCiAgICAgICAgZWxzZQogICAgICAgICAgICBpZiBAdGVtcE51bWJlcnM/CiAgICAgICAgICAgICAgICBAdGVtcE51bWJlcnNbaW5kZXhdID0gdmFsdWUKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgQGxvY2FsTnVtYmVyc1tAbWFwLmlkXVtAbWFwLmN1cnJlbnRFdmVudC5pZF1baW5kZXhdID0gdmFsdWUKICAgICAgICAgICAgCiAgICBzZXROdW1iZXJWYWx1ZVRvOiAodmFyaWFibGUsIHZhbHVlLCBldmVudElkLCBtYXBJZCkgLT4KICAgICAgICBpZiB2YXJpYWJsZS5zY29wZSA9PSAxCiAgICAgICAgICAgIEBudW1iZXJzW3ZhcmlhYmxlLmluZGV4XSA9IHZhbHVlCiAgICAgICAgZWxzZQogICAgICAgICAgICBpZiBAdGVtcE51bWJlcnM/CiAgICAgICAgICAgICAgICBAdGVtcE51bWJlcnNbdmFyaWFibGUuaW5kZXhdID0gdmFsdWUKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgZXZlbnRzID0gQGxvY2FsTnVtYmVyc1ttYXBJZCB8fCAoaWYgQG1hcC5jdXJyZW50RXZlbnQucGFyYW1ldGVycz8gdGhlbiAiQy1FVkVOVFMiIGVsc2UgQG1hcC5pZCldCiAgICAgICAgICAgICAgICBudW1iZXJzID0gZXZlbnRzW2V2ZW50SWQgfHwgQG1hcC5jdXJyZW50RXZlbnQuaWRdCiAgICAgICAgICAgICAgICBpZiBub3QgbnVtYmVycz8KICAgICAgICAgICAgICAgICAgICBudW1iZXJzID0gW10KICAgICAgICAgICAgICAgICAgICBldmVudHNbZXZlbnRJZCB8fCBAbWFwLmN1cnJlbnRFdmVudC5pZF0gPSBudW1iZXJzCiAgICAgICAgICAgICAgICBudW1iZXJzW3ZhcmlhYmxlLmluZGV4XSA9IHZhbHVlCiAgICBzZXRCb29sZWFuVmFsdWVUbzogKHZhcmlhYmxlLCB2YWx1ZSwgZXZlbnRJZCwgbWFwSWQpIC0+CiAgICAgICAgaWYgdmFyaWFibGUuc2NvcGUgPT0gMQogICAgICAgICAgICBAYm9vbGVhbnNbdmFyaWFibGUuaW5kZXhdID0gdmFsdWUKICAgICAgICBlbHNlCiAgICAgICAgICAgIGlmIEB0ZW1wQm9vbGVhbnM/CiAgICAgICAgICAgICAgICBAdGVtcEJvb2xlYW5zW3ZhcmlhYmxlLmluZGV4XSA9IHZhbHVlCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIGV2ZW50cyA9IEBsb2NhbEJvb2xlYW5zW21hcElkIHx8IChpZiBAbWFwLmN1cnJlbnRFdmVudC5wYXJhbWV0ZXJzPyB0aGVuICJDLUVWRU5UUyIgZWxzZSBAbWFwLmlkKV0KICAgICAgICAgICAgICAgIGJvb2xlYW5zID0gZXZlbnRzW2V2ZW50SWQgfHwgQG1hcC5jdXJyZW50RXZlbnQuaWRdCiAgICAgICAgICAgICAgICBpZiBub3QgYm9vbGVhbnMKICAgICAgICAgICAgICAgICAgICBib29sZWFucyA9IFtdCiAgICAgICAgICAgICAgICAgICAgZXZlbnRzW2V2ZW50SWQgfHwgQG1hcC5jdXJyZW50RXZlbnQuaWRdID0gYm9vbGVhbnMKICAgICAgICAgICAgICAgIGJvb2xlYW5zW3ZhcmlhYmxlLmluZGV4XSA9IHZhbHVlCiAgICBzZXRTdHJpbmdWYWx1ZVRvOiAodmFyaWFibGUsIHZhbHVlLCBldmVudElkLCBtYXBJZCkgLT4KICAgICAgICBpZiB2YXJpYWJsZS5zY29wZSA9PSAxCiAgICAgICAgICAgIEBzdHJpbmdzW3ZhcmlhYmxlLmluZGV4XSA9IHZhbHVlCiAgICAgICAgZWxzZQogICAgICAgICAgICBpZiBAdGVtcFN0cmluZ3M/CiAgICAgICAgICAgICAgICBAdGVtcFN0cmluZ3NbdmFyaWFibGUuaW5kZXhdID0gdmFsdWUKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgZXZlbnRzID0gQGxvY2FsU3RyaW5nc1ttYXBJZCB8fCAoaWYgQG1hcC5jdXJyZW50RXZlbnQucGFyYW1ldGVycz8gdGhlbiAiQy1FVkVOVFMiIGVsc2UgQG1hcC5pZCldCiAgICAgICAgICAgICAgICBzdHJpbmdzID0gZXZlbnRzW2V2ZW50SWQgfHwgQG1hcC5jdXJyZW50RXZlbnQuaWRdCiAgICAgICAgICAgICAgICBpZiBub3Qgc3RyaW5ncwogICAgICAgICAgICAgICAgICAgIHN0cmluZ3MgPSBbXQogICAgICAgICAgICAgICAgICAgIGV2ZW50c1tldmVudElkIHx8IEBtYXAuY3VycmVudEV2ZW50LmlkXSA9IHN0cmluZ3MKICAgICAgICAgICAgICAgIHN0cmluZ3NbdmFyaWFibGUuaW5kZXhdID0gdmFsdWUKICAgIAogICAgbnVtYmVyVmFsdWVBdEluZGV4OiAoc2NvcGUsIGluZGV4KSAtPgogICAgICAgIHJlc3VsdCA9IDAKICAgICAgICAKICAgICAgICBpZiBzY29wZSA9PSAxCiAgICAgICAgICAgIHJlc3VsdCA9IEBudW1iZXJzW2luZGV4XQogICAgICAgIGVsc2UKICAgICAgICAgICAgaWYgQHRlbXBOdW1iZXJzPwogICAgICAgICAgICAgICAgcmVzdWx0ID0gQHRlbXBOdW1iZXJzW2luZGV4XQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICByZXN1bHQgPSBAbG9jYWxOdW1iZXJzW0BtYXAuaWRdW0BtYXAuY3VycmVudEV2ZW50LmlkXVtpbmRleF0KICAgCiAgICAgICAgICAgIAogICAgICAgIHJldHVybiByZXN1bHQKICAgICAgICAKICAgIG51bWJlclZhbHVlT2Y6IChvYmplY3QpIC0+CiAgICAgICAgcmVzdWx0ID0gMAogICAgICAgIGlmIG9iamVjdD8gYW5kIG9iamVjdC5pbmRleD8KICAgICAgICAgICAgaWYgb2JqZWN0LnNjb3BlID09IDEKICAgICAgICAgICAgICAgIHJlc3VsdCA9IEBudW1iZXJzW29iamVjdC5pbmRleF0KICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgaWYgQHRlbXBOdW1iZXJzPwogICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IEB0ZW1wTnVtYmVyc1tvYmplY3QuaW5kZXhdCiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgZXZlbnRzID0gQGxvY2FsTnVtYmVyc1tpZiBAbWFwLmN1cnJlbnRFdmVudC5wYXJhbWV0ZXJzPyB0aGVuICJDLUVWRU5UUyIgZWxzZSBAbWFwLmlkXQogICAgICAgICAgICAgICAgICAgIG51bWJlcnMgPSBldmVudHNbQG1hcC5jdXJyZW50RXZlbnQuaWRdCiAgICAgICAgICAgICAgICAgICAgaWYgbnVtYmVycz8KICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gZXZlbnRzW0BtYXAuY3VycmVudEV2ZW50LmlkXVtvYmplY3QuaW5kZXhdCiAgICAgICAgZWxzZQogICAgICAgICAgICByZXN1bHQgPSBvYmplY3QKICAgICAgICAgICAgCiAgICAgICAgcmV0dXJuIHJlc3VsdCB8fCAwCiAgICAgICAgCiAgICBzdHJpbmdWYWx1ZU9mOiAob2JqZWN0KSAtPgogICAgICAgIHJlc3VsdCA9ICIiCiAgICAgICAgaWYgb2JqZWN0PyBhbmQgb2JqZWN0LmluZGV4PwogICAgICAgICAgICBpZiBvYmplY3Quc2NvcGUgPT0gMQogICAgICAgICAgICAgICAgcmVzdWx0ID0gQHN0cmluZ3Nbb2JqZWN0LmluZGV4XQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBpZiBAdGVtcFN0cmluZ3M/CiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gQHRlbXBTdHJpbmdzW29iamVjdC5pbmRleF0KICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBAbG9jYWxTdHJpbmdzW0BtYXAuaWRdW0BtYXAuY3VycmVudEV2ZW50LmlkXVtvYmplY3QuaW5kZXhdCiAgICAgICAgZWxzZQogICAgICAgICAgICByZXN1bHQgPSBvYmplY3QKICAgICAgICAgICAgCiAgICAgICAgcmV0dXJuIHJlc3VsdCB8fCAiIgogICAgICAgIAogICAgYm9vbGVhblZhbHVlT2Y6IChvYmplY3QpIC0+CiAgICAgICAgcmVzdWx0ID0gbm8KICAgICAgICBpZiBvYmplY3Q/IGFuZCBvYmplY3QuaW5kZXg/CiAgICAgICAgICAgIGlmIG9iamVjdC5zY29wZSA9PSAxCiAgICAgICAgICAgICAgICByZXN1bHQgPSBAYm9vbGVhbnNbb2JqZWN0LmluZGV4XQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBpZiBAdGVtcEJvb2xlYW5zPwogICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IEB0ZW1wQm9vbGVhbnNbb2JqZWN0LmluZGV4XQogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIGJvb2xlYW5zID0gQGxvY2FsQm9vbGVhbnNbQG1hcC5pZF1bQG1hcC5jdXJyZW50RXZlbnQuaWRdCiAgICAgICAgICAgICAgICAgICAgaWYgbm90IGJvb2xlYW5zCiAgICAgICAgICAgICAgICAgICAgICAgIGJvb2xlYW5zID0gW10KICAgICAgICAgICAgICAgICAgICAgICAgQGxvY2FsQm9vbGVhbnNbQG1hcC5pZF1bQG1hcC5jdXJyZW50RXZlbnQuaWRdID0gYm9vbGVhbnMKICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBib29sZWFuc1tvYmplY3QuaW5kZXhdCiAgICAgICAgZWxzZQogICAgICAgICAgICByZXN1bHQgPSBvYmplY3QKICAgICAgICAgICAgCiAgICAgICAgcmV0dXJuIHJlc3VsdAogICAgICAgIAp3aW5kb3cuTG9naWNfVmFyaWFibGVTdG9yZSA9IExvZ2ljX1ZhcmlhYmxlU3RvcmU=","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBMb2dpY19WYXJpYWJsZVN0b3JlOwoKICBMb2dpY19WYXJpYWJsZVN0b3JlID0gKGZ1bmN0aW9uKCkgewogICAgZnVuY3Rpb24gTG9naWNfVmFyaWFibGVTdG9yZSgpIHsKICAgICAgdGhpcy5udW1iZXJzID0gbmV3IEFycmF5KDUwMDApOwogICAgICB0aGlzLmJvb2xlYW5zID0gbmV3IEFycmF5KDUwMDApOwogICAgICB0aGlzLnN0cmluZ3MgPSBuZXcgQXJyYXkoNTAwMCk7CiAgICAgIHRoaXMubG9jYWxOdW1iZXJzID0ge307CiAgICAgIHRoaXMubG9jYWxTdHJpbmdzID0ge307CiAgICAgIHRoaXMubG9jYWxCb29sZWFucyA9IHt9OwogICAgICB0aGlzLnRlbXBOdW1iZXJzID0gbnVsbDsKICAgICAgdGhpcy50ZW1wU3RyaW5ncyA9IG51bGw7CiAgICAgIHRoaXMudGVtcEJvb2xlYW5zID0gbnVsbDsKICAgIH0KCiAgICBMb2dpY19WYXJpYWJsZVN0b3JlLnByb3RvdHlwZS5zZXR1cCA9IGZ1bmN0aW9uKG1hcCkgewogICAgICB0aGlzLm1hcCA9IG1hcDsKICAgICAgdGhpcy5zZXR1cEV2ZW50VmFyaWFibGVzKCJsb2NhbE51bWJlcnMiLCAwKTsKICAgICAgdGhpcy5zZXR1cEV2ZW50VmFyaWFibGVzKCJsb2NhbFN0cmluZ3MiLCAiIik7CiAgICAgIHRoaXMuc2V0dXBFdmVudFZhcmlhYmxlcygibG9jYWxCb29sZWFucyIsIGZhbHNlKTsKICAgICAgdGhpcy5zZXR1cENvbW1vbkV2ZW50VmFyaWFibGVzKCJsb2NhbE51bWJlcnMiLCAwKTsKICAgICAgdGhpcy5zZXR1cENvbW1vbkV2ZW50VmFyaWFibGVzKCJsb2NhbFN0cmluZ3MiLCAiIik7CiAgICAgIHJldHVybiB0aGlzLnNldHVwQ29tbW9uRXZlbnRWYXJpYWJsZXMoImxvY2FsQm9vbGVhbnMiLCBmYWxzZSk7CiAgICB9OwoKICAgIExvZ2ljX1ZhcmlhYmxlU3RvcmUucHJvdG90eXBlLnNldHVwRXZlbnRWYXJpYWJsZXMgPSBmdW5jdGlvbihwcm9wZXJ0eSwgZGVmYXVsdFZhbHVlKSB7CiAgICAgIHZhciBldmVudCwgX2ksIF9sZW4sIF9yZWYsIF9yZXN1bHRzOwogICAgICBpZiAodGhpc1twcm9wZXJ0eV1bdGhpcy5tYXAuaWRdID09IG51bGwpIHsKICAgICAgICB0aGlzW3Byb3BlcnR5XVt0aGlzLm1hcC5pZF0gPSBbXTsKICAgICAgfQogICAgICBfcmVmID0gdGhpcy5tYXAuZXZlbnRzOwogICAgICBfcmVzdWx0cyA9IFtdOwogICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICBldmVudCA9IF9yZWZbX2ldOwogICAgICAgIGlmICh0aGlzW3Byb3BlcnR5XVt0aGlzLm1hcC5pZF1bZXZlbnQuaWRdID09IG51bGwpIHsKICAgICAgICAgIF9yZXN1bHRzLnB1c2godGhpc1twcm9wZXJ0eV1bdGhpcy5tYXAuaWRdW2V2ZW50LmlkXSA9IFtkZWZhdWx0VmFsdWVdKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgX3Jlc3VsdHMucHVzaCh2b2lkIDApOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gX3Jlc3VsdHM7CiAgICB9OwoKICAgIExvZ2ljX1ZhcmlhYmxlU3RvcmUucHJvdG90eXBlLnNldHVwQ29tbW9uRXZlbnRWYXJpYWJsZXMgPSBmdW5jdGlvbihwcm9wZXJ0eSwgZGVmYXVsdFZhbHVlKSB7CiAgICAgIHZhciBldmVudCwgX2ksIF9sZW4sIF9yZWYsIF9yZXN1bHRzOwogICAgICBpZiAodGhpc1twcm9wZXJ0eV1bJ0MtRVZFTlRTJ10gPT0gbnVsbCkgewogICAgICAgIHRoaXNbcHJvcGVydHldWydDLUVWRU5UUyddID0gW107CiAgICAgIH0KICAgICAgX3JlZiA9IEdhbWVNYW5hZ2VyLmNvbW1vbkV2ZW50czsKICAgICAgX3Jlc3VsdHMgPSBbXTsKICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBfcmVmLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7CiAgICAgICAgZXZlbnQgPSBfcmVmW19pXTsKICAgICAgICBpZiAodGhpc1twcm9wZXJ0eV1bJ0MtRVZFTlRTJ11bZXZlbnQuaWRdID09IG51bGwpIHsKICAgICAgICAgIF9yZXN1bHRzLnB1c2godGhpc1twcm9wZXJ0eV1bJ0MtRVZFTlRTJ11bZXZlbnQuaWRdID0gW2RlZmF1bHRWYWx1ZV0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBfcmVzdWx0cy5wdXNoKHZvaWQgMCk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiBfcmVzdWx0czsKICAgIH07CgogICAgTG9naWNfVmFyaWFibGVTdG9yZS5wcm90b3R5cGUuc2V0TnVtYmVyVmFsdWVBdEluZGV4ID0gZnVuY3Rpb24oc2NvcGUsIGluZGV4LCB2YWx1ZSkgewogICAgICBpZiAoc2NvcGUgPT09IDEpIHsKICAgICAgICByZXR1cm4gdGhpcy5udW1iZXJzW2luZGV4XSA9IHZhbHVlOwogICAgICB9IGVsc2UgewogICAgICAgIGlmICh0aGlzLnRlbXBOdW1iZXJzICE9IG51bGwpIHsKICAgICAgICAgIHJldHVybiB0aGlzLnRlbXBOdW1iZXJzW2luZGV4XSA9IHZhbHVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXR1cm4gdGhpcy5sb2NhbE51bWJlcnNbdGhpcy5tYXAuaWRdW3RoaXMubWFwLmN1cnJlbnRFdmVudC5pZF1baW5kZXhdID0gdmFsdWU7CiAgICAgICAgfQogICAgICB9CiAgICB9OwoKICAgIExvZ2ljX1ZhcmlhYmxlU3RvcmUucHJvdG90eXBlLnNldE51bWJlclZhbHVlVG8gPSBmdW5jdGlvbih2YXJpYWJsZSwgdmFsdWUsIGV2ZW50SWQsIG1hcElkKSB7CiAgICAgIHZhciBldmVudHMsIG51bWJlcnM7CiAgICAgIGlmICh2YXJpYWJsZS5zY29wZSA9PT0gMSkgewogICAgICAgIHJldHVybiB0aGlzLm51bWJlcnNbdmFyaWFibGUuaW5kZXhdID0gdmFsdWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKHRoaXMudGVtcE51bWJlcnMgIT0gbnVsbCkgewogICAgICAgICAgcmV0dXJuIHRoaXMudGVtcE51bWJlcnNbdmFyaWFibGUuaW5kZXhdID0gdmFsdWU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGV2ZW50cyA9IHRoaXMubG9jYWxOdW1iZXJzW21hcElkIHx8ICh0aGlzLm1hcC5jdXJyZW50RXZlbnQucGFyYW1ldGVycyAhPSBudWxsID8gIkMtRVZFTlRTIiA6IHRoaXMubWFwLmlkKV07CiAgICAgICAgICBudW1iZXJzID0gZXZlbnRzW2V2ZW50SWQgfHwgdGhpcy5tYXAuY3VycmVudEV2ZW50LmlkXTsKICAgICAgICAgIGlmIChudW1iZXJzID09IG51bGwpIHsKICAgICAgICAgICAgbnVtYmVycyA9IFtdOwogICAgICAgICAgICBldmVudHNbZXZlbnRJZCB8fCB0aGlzLm1hcC5jdXJyZW50RXZlbnQuaWRdID0gbnVtYmVyczsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBudW1iZXJzW3ZhcmlhYmxlLmluZGV4XSA9IHZhbHVlOwogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICBMb2dpY19WYXJpYWJsZVN0b3JlLnByb3RvdHlwZS5zZXRCb29sZWFuVmFsdWVUbyA9IGZ1bmN0aW9uKHZhcmlhYmxlLCB2YWx1ZSwgZXZlbnRJZCwgbWFwSWQpIHsKICAgICAgdmFyIGJvb2xlYW5zLCBldmVudHM7CiAgICAgIGlmICh2YXJpYWJsZS5zY29wZSA9PT0gMSkgewogICAgICAgIHJldHVybiB0aGlzLmJvb2xlYW5zW3ZhcmlhYmxlLmluZGV4XSA9IHZhbHVlOwogICAgICB9IGVsc2UgewogICAgICAgIGlmICh0aGlzLnRlbXBCb29sZWFucyAhPSBudWxsKSB7CiAgICAgICAgICByZXR1cm4gdGhpcy50ZW1wQm9vbGVhbnNbdmFyaWFibGUuaW5kZXhdID0gdmFsdWU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGV2ZW50cyA9IHRoaXMubG9jYWxCb29sZWFuc1ttYXBJZCB8fCAodGhpcy5tYXAuY3VycmVudEV2ZW50LnBhcmFtZXRlcnMgIT0gbnVsbCA/ICJDLUVWRU5UUyIgOiB0aGlzLm1hcC5pZCldOwogICAgICAgICAgYm9vbGVhbnMgPSBldmVudHNbZXZlbnRJZCB8fCB0aGlzLm1hcC5jdXJyZW50RXZlbnQuaWRdOwogICAgICAgICAgaWYgKCFib29sZWFucykgewogICAgICAgICAgICBib29sZWFucyA9IFtdOwogICAgICAgICAgICBldmVudHNbZXZlbnRJZCB8fCB0aGlzLm1hcC5jdXJyZW50RXZlbnQuaWRdID0gYm9vbGVhbnM7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gYm9vbGVhbnNbdmFyaWFibGUuaW5kZXhdID0gdmFsdWU7CiAgICAgICAgfQogICAgICB9CiAgICB9OwoKICAgIExvZ2ljX1ZhcmlhYmxlU3RvcmUucHJvdG90eXBlLnNldFN0cmluZ1ZhbHVlVG8gPSBmdW5jdGlvbih2YXJpYWJsZSwgdmFsdWUsIGV2ZW50SWQsIG1hcElkKSB7CiAgICAgIHZhciBldmVudHMsIHN0cmluZ3M7CiAgICAgIGlmICh2YXJpYWJsZS5zY29wZSA9PT0gMSkgewogICAgICAgIHJldHVybiB0aGlzLnN0cmluZ3NbdmFyaWFibGUuaW5kZXhdID0gdmFsdWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKHRoaXMudGVtcFN0cmluZ3MgIT0gbnVsbCkgewogICAgICAgICAgcmV0dXJuIHRoaXMudGVtcFN0cmluZ3NbdmFyaWFibGUuaW5kZXhdID0gdmFsdWU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGV2ZW50cyA9IHRoaXMubG9jYWxTdHJpbmdzW21hcElkIHx8ICh0aGlzLm1hcC5jdXJyZW50RXZlbnQucGFyYW1ldGVycyAhPSBudWxsID8gIkMtRVZFTlRTIiA6IHRoaXMubWFwLmlkKV07CiAgICAgICAgICBzdHJpbmdzID0gZXZlbnRzW2V2ZW50SWQgfHwgdGhpcy5tYXAuY3VycmVudEV2ZW50LmlkXTsKICAgICAgICAgIGlmICghc3RyaW5ncykgewogICAgICAgICAgICBzdHJpbmdzID0gW107CiAgICAgICAgICAgIGV2ZW50c1tldmVudElkIHx8IHRoaXMubWFwLmN1cnJlbnRFdmVudC5pZF0gPSBzdHJpbmdzOwogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuIHN0cmluZ3NbdmFyaWFibGUuaW5kZXhdID0gdmFsdWU7CiAgICAgICAgfQogICAgICB9CiAgICB9OwoKICAgIExvZ2ljX1ZhcmlhYmxlU3RvcmUucHJvdG90eXBlLm51bWJlclZhbHVlQXRJbmRleCA9IGZ1bmN0aW9uKHNjb3BlLCBpbmRleCkgewogICAgICB2YXIgcmVzdWx0OwogICAgICByZXN1bHQgPSAwOwogICAgICBpZiAoc2NvcGUgPT09IDEpIHsKICAgICAgICByZXN1bHQgPSB0aGlzLm51bWJlcnNbaW5kZXhdOwogICAgICB9IGVsc2UgewogICAgICAgIGlmICh0aGlzLnRlbXBOdW1iZXJzICE9IG51bGwpIHsKICAgICAgICAgIHJlc3VsdCA9IHRoaXMudGVtcE51bWJlcnNbaW5kZXhdOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXN1bHQgPSB0aGlzLmxvY2FsTnVtYmVyc1t0aGlzLm1hcC5pZF1bdGhpcy5tYXAuY3VycmVudEV2ZW50LmlkXVtpbmRleF07CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9OwoKICAgIExvZ2ljX1ZhcmlhYmxlU3RvcmUucHJvdG90eXBlLm51bWJlclZhbHVlT2YgPSBmdW5jdGlvbihvYmplY3QpIHsKICAgICAgdmFyIGV2ZW50cywgbnVtYmVycywgcmVzdWx0OwogICAgICByZXN1bHQgPSAwOwogICAgICBpZiAoKG9iamVjdCAhPSBudWxsKSAmJiAob2JqZWN0LmluZGV4ICE9IG51bGwpKSB7CiAgICAgICAgaWYgKG9iamVjdC5zY29wZSA9PT0gMSkgewogICAgICAgICAgcmVzdWx0ID0gdGhpcy5udW1iZXJzW29iamVjdC5pbmRleF07CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmICh0aGlzLnRlbXBOdW1iZXJzICE9IG51bGwpIHsKICAgICAgICAgICAgcmVzdWx0ID0gdGhpcy50ZW1wTnVtYmVyc1tvYmplY3QuaW5kZXhdOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZXZlbnRzID0gdGhpcy5sb2NhbE51bWJlcnNbdGhpcy5tYXAuY3VycmVudEV2ZW50LnBhcmFtZXRlcnMgIT0gbnVsbCA/ICJDLUVWRU5UUyIgOiB0aGlzLm1hcC5pZF07CiAgICAgICAgICAgIG51bWJlcnMgPSBldmVudHNbdGhpcy5tYXAuY3VycmVudEV2ZW50LmlkXTsKICAgICAgICAgICAgaWYgKG51bWJlcnMgIT0gbnVsbCkgewogICAgICAgICAgICAgIHJlc3VsdCA9IGV2ZW50c1t0aGlzLm1hcC5jdXJyZW50RXZlbnQuaWRdW29iamVjdC5pbmRleF07CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmVzdWx0ID0gb2JqZWN0OwogICAgICB9CiAgICAgIHJldHVybiByZXN1bHQgfHwgMDsKICAgIH07CgogICAgTG9naWNfVmFyaWFibGVTdG9yZS5wcm90b3R5cGUuc3RyaW5nVmFsdWVPZiA9IGZ1bmN0aW9uKG9iamVjdCkgewogICAgICB2YXIgcmVzdWx0OwogICAgICByZXN1bHQgPSAiIjsKICAgICAgaWYgKChvYmplY3QgIT0gbnVsbCkgJiYgKG9iamVjdC5pbmRleCAhPSBudWxsKSkgewogICAgICAgIGlmIChvYmplY3Quc2NvcGUgPT09IDEpIHsKICAgICAgICAgIHJlc3VsdCA9IHRoaXMuc3RyaW5nc1tvYmplY3QuaW5kZXhdOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpZiAodGhpcy50ZW1wU3RyaW5ncyAhPSBudWxsKSB7CiAgICAgICAgICAgIHJlc3VsdCA9IHRoaXMudGVtcFN0cmluZ3Nbb2JqZWN0LmluZGV4XTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJlc3VsdCA9IHRoaXMubG9jYWxTdHJpbmdzW3RoaXMubWFwLmlkXVt0aGlzLm1hcC5jdXJyZW50RXZlbnQuaWRdW29iamVjdC5pbmRleF07CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHJlc3VsdCA9IG9iamVjdDsKICAgICAgfQogICAgICByZXR1cm4gcmVzdWx0IHx8ICIiOwogICAgfTsKCiAgICBMb2dpY19WYXJpYWJsZVN0b3JlLnByb3RvdHlwZS5ib29sZWFuVmFsdWVPZiA9IGZ1bmN0aW9uKG9iamVjdCkgewogICAgICB2YXIgYm9vbGVhbnMsIHJlc3VsdDsKICAgICAgcmVzdWx0ID0gZmFsc2U7CiAgICAgIGlmICgob2JqZWN0ICE9IG51bGwpICYmIChvYmplY3QuaW5kZXggIT0gbnVsbCkpIHsKICAgICAgICBpZiAob2JqZWN0LnNjb3BlID09PSAxKSB7CiAgICAgICAgICByZXN1bHQgPSB0aGlzLmJvb2xlYW5zW29iamVjdC5pbmRleF07CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmICh0aGlzLnRlbXBCb29sZWFucyAhPSBudWxsKSB7CiAgICAgICAgICAgIHJlc3VsdCA9IHRoaXMudGVtcEJvb2xlYW5zW29iamVjdC5pbmRleF07CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBib29sZWFucyA9IHRoaXMubG9jYWxCb29sZWFuc1t0aGlzLm1hcC5pZF1bdGhpcy5tYXAuY3VycmVudEV2ZW50LmlkXTsKICAgICAgICAgICAgaWYgKCFib29sZWFucykgewogICAgICAgICAgICAgIGJvb2xlYW5zID0gW107CiAgICAgICAgICAgICAgdGhpcy5sb2NhbEJvb2xlYW5zW3RoaXMubWFwLmlkXVt0aGlzLm1hcC5jdXJyZW50RXZlbnQuaWRdID0gYm9vbGVhbnM7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmVzdWx0ID0gYm9vbGVhbnNbb2JqZWN0LmluZGV4XTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmVzdWx0ID0gb2JqZWN0OwogICAgICB9CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9OwoKICAgIHJldHVybiBMb2dpY19WYXJpYWJsZVN0b3JlOwoKICB9KSgpOwoKICB3aW5kb3cuTG9naWNfVmFyaWFibGVTdG9yZSA9IExvZ2ljX1ZhcmlhYmxlU3RvcmU7Cgp9KS5jYWxsKHRoaXMpOwo="},{"name":"Logic_Screen","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogTG9naWNfU2NyZWVuCiMgICBDcmVhdGVkIG9uOiAyMDEzLTEyLTAxCiMKIyAgIENvcHlyaWdodCAoQykgMjAxMyBBbmRy6SBSYWRvbXNraS4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KIwojICAgQ2xhc3M6IExvZ2ljX1NjcmVlbgojCiMgICBBIGNsYXNzIGZvciB0aGUgc2NyZWVuIHRvIGhhbmRsZSBzaGFraW5nLCB0aW50aW5nLCBldGMuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpjbGFzcyBMb2dpY19TY3JlZW4KICAgIGNvbnN0cnVjdG9yOiAtPgogICAgICAgIEBzaGFrZVBvd2VyID0gMAogICAgICAgIEBzaGFrZVNwZWVkID0gMQogICAgICAgIEBzaGFrZUR1cmF0aW9uID0gLTEKICAgICAgICBAb3ggPSAwCiAgICAgICAgQG95ID0gMAogICAgICAgIEB4ID0gMAogICAgICAgIEB5ID0gMAogICAgICAgIEB0b25lID0gbmV3IFRvbmUoMCwgMCwgMCwgMCkKICAgICAgICBAdGludER1cmF0aW9uID0gMAogICAgICAgIEB0aW50VG9uZSA9IG5ldyBUb25lKDAsIDAsIDAsIDApCiAgICAgICAgQHRpbnRDb3VudGVyID0gMAogICAgICAgIAogICAgc3RhcnRTaGFrZTogKHBvd2VyLCBzcGVlZCwgZHVyYXRpb24pIC0+CiAgICAgICAgQHNoYWtlUmFuZ2UgPSAwCiAgICAgICAgQHNoYWtlUG93ZXIgPSBwb3dlciAqIDIKICAgICAgICBAc2hha2VTcGVlZCA9IHNwZWVkCiAgICAgICAgQHNoYWtlRHVyYXRpb24gPSBkdXJhdGlvbgogICAgc3RvcFNoYWtlOiAtPgogICAgICAgIEBzaGFrZVBvd2VyID0gMAogICAgICAgIEBzaGFrZVJhbmdlID0gMAogICAgICAgIAogICAgdGludDogKHRvbmUsIGR1cmF0aW9uKSAtPgogICAgICAgIEB0aW50VG9uZSA9IHRvbmUKICAgICAgICBAdGludER1cmF0aW9uID0gZHVyYXRpb24KICAgICAgICBAdGludENvdW50ZXIgPSBkdXJhdGlvbgogICAgICAgIGlmIEB0aW50RHVyYXRpb24gPT0gMAogICAgICAgICAgICBAdG9uZSA9IEB0aW50VG9uZQogICAgICAgICAgICAKICAgIHNjcm9sbDogKHN0ZXBzWCwgc3RlcHNZLCBkdXJhdGlvbikgLT4KICAgICAgICBtYXAgPSBHYW1lTWFuYWdlci5tYXAKICAgICAgICBAc2Nyb2xsU3RlcHNYID0gc3RlcHNYICogbWFwLnRpbGVTaXplCiAgICAgICAgQHNjcm9sbFN0ZXBzWSA9IHN0ZXBzWSAqIG1hcC50aWxlU2l6ZQogICAgICAgIEBzY3JvbGxEdXJhdGlvbiA9IGR1cmF0aW9uCiAgICAgICAgCiAgICAgICAgZHggPSAoQG94ICsgQHNjcm9sbFN0ZXBzWCkgLSBAb3gKICAgICAgICBkeSA9IChAb3kgKyBAc2Nyb2xsU3RlcHNZKSAtIEBveQogICAgICAgIAogICAgICAgIEBzY3JvbGxTcGVlZFggPSBkeCAvIGR1cmF0aW9uCiAgICAgICAgQHNjcm9sbFNwZWVkWSA9IGR5IC8gZHVyYXRpb24KICAgICAgICAKICAgIGNlbnRlck9uUGxheWVyOiAtPiBAY2VudGVyT24oR2FtZU1hbmFnZXIucGxheWVyLngsIEdhbWVNYW5hZ2VyLnBsYXllci55KQogICAgY2VudGVyT246ICh4LCB5KSAtPgogICAgICAgIG1hcCA9IEdhbWVNYW5hZ2VyLm1hcAogICAgICAgIHNwcml0ZSA9IFNjZW5lTWFuYWdlci5zY2VuZS5tYXAucGxheWVyCiAgICAgICAgcHcgPSBzcHJpdGUuc3JjUmVjdC53aWR0aAogICAgICAgIHBoID0gc3ByaXRlLnNyY1JlY3QuaGVpZ2h0CiAgICAgICAgCiAgICAgICAgeCA9IE1hdGguZmxvb3IoeCAtIChwdyAtIG1hcC50aWxlU2l6ZSkgLyAyKQoKICAgICAgICBAb3ggPSB4IC0gR3JhcGhpY3Mud2lkdGggLyAyICsgTWF0aC5jZWlsKHB3IC8gMikKICAgICAgICBAb3kgPSB5IC0gKEdyYXBoaWNzLmhlaWdodCAtIHBoKSAvIDIgLSBtYXAudGlsZVNpemUKICAgICAgICAKICAgICAgICBAb3ggPSBpZiBtYXAubG9vcFR5cGUgPT0gMiBvciBtYXAubG9vcFR5cGUgPT0gMyB0aGVuIEBveCBlbHNlIE1hdGgubWluKE1hdGgubWF4KEBveCwgMCksIG1hcC53aWR0aCptYXAudGlsZVNpemUtR3JhcGhpY3Mud2lkdGgpIAogICAgICAgIEBveSA9IGlmIG1hcC5sb29wVHlwZSA9PSAxIG9yIG1hcC5sb29wVHlwZSA9PSAzIHRoZW4gQG95IGVsc2UgTWF0aC5taW4oTWF0aC5tYXgoQG95LCAwKSwgbWFwLmhlaWdodCptYXAudGlsZVNpemUtR3JhcGhpY3MuaGVpZ2h0KQogICAgICAgICAgICAKICAgIHVwZGF0ZTogLT4KICAgICAgICAKICAgICAgICBAdXBkYXRlVGludGluZygpCiAgICAgICAgQHVwZGF0ZVNjcm9sbGluZygpCiAgICAgICAgQHVwZGF0ZVBsYXllclNjcm9sbGluZygpCiAgICAgICAgQHVwZGF0ZVNoYWtpbmcoKQogICAgICAgIAogICAgdXBkYXRlU2hha2luZzogLT4KICAgICAgICBpZiBAc2hha2VQb3dlciA9PSAwCiAgICAgICAgICAgIEBzaGFrZVJhbmdlID0gMAogICAgICAgICAgICByZXR1cm4KICAgICAgICAKICAgICAgICBAc2hha2VSYW5nZSArPSBAc2hha2VTcGVlZAogICAgCiAgICAgICAgaWYgQHNoYWtlUmFuZ2UgPj0gQHNoYWtlUG93ZXIgb3IgQHNoYWtlUmFuZ2UgPD0gLUBzaGFrZVBvd2VyCiAgICAgICAgICAgIEBzaGFrZVNwZWVkID0gQHNoYWtlU3BlZWQgKiAtMQogICAgIAogICAgICAgIGlmIEBzaGFrZUR1cmF0aW9uID4gMCB0aGVuIEBzaGFrZUR1cmF0aW9uLS0KICAgICAgICBpZiBAc2hha2VEdXJhdGlvbiA9PSAwCiAgICAgICAgICAgIEBzaGFrZVBvd2VyID0gMAogICAgICAgICAgCiAgICAgICAgCiAgICB1cGRhdGVUaW50aW5nOiAtPgogICAgICAgIGlmIEB0aW50RHVyYXRpb24gPT0gMCB0aGVuIHJldHVybgogICAgICAgIGEgPSAoQHRpbnRDb3VudGVyIC8gQHRpbnREdXJhdGlvbikgKiAyNTUKICAgICAgICAKICAgICAgICBAdG9uZS5yZWQgPSBNYXRoLmZsb29yKChAdG9uZS5yZWQgKiBhICsgQHRpbnRUb25lLnJlZCAqICgyNTUgLSBhKSkgLyAyNTUpCiAgICAgICAgQHRvbmUuZ3JlZW4gPSBNYXRoLmZsb29yKChAdG9uZS5ncmVlbiAqIGEgKyBAdGludFRvbmUuZ3JlZW4gKiAoMjU1IC0gYSkpIC8gMjU1KQogICAgICAgIEB0b25lLmJsdWUgPSBNYXRoLmZsb29yKChAdG9uZS5ibHVlICogYSArIEB0aW50VG9uZS5ibHVlICogKDI1NSAtIGEpKSAvIDI1NSkKICAgICAgICBAdG9uZS5ncmV5ID0gTWF0aC5mbG9vcigoQHRvbmUuZ3JleSAqIGEgKyBAdGludFRvbmUuZ3JleSAqICgyNTUgLSBhKSkgLyAyNTUpCiAgICAgICAgCiAgICAgICAgQHRpbnRDb3VudGVyLS0KICAgICAgICAKICAgICAgICBpZiBAdGludENvdW50ZXIgPD0gMAogICAgICAgICAgICBAdGludENvdW50ZXIgPSAwCiAgICAgICAgICAgIEB0aW50RHVyYXRpb24gPSAwCiAgICAgICAgICAgIEB0b25lID0gQHRpbnRUb25lCiAgICAgICAgICAgIAogICAgdXBkYXRlU2Nyb2xsaW5nOiAtPgogICAgICAgIGlmIEBzY3JvbGxEdXJhdGlvbiA+IDAKICAgICAgICAgICAgbWFwID0gR2FtZU1hbmFnZXIubWFwCiAgICAgICAgICAgIEBzY3JvbGxEdXJhdGlvbi0tCiAgICAgICAgICAgIAogICAgICAgICAgICBAb3ggKz0gQHNjcm9sbFNwZWVkWAogICAgICAgICAgICBAb3kgKz0gQHNjcm9sbFNwZWVkWQogICAgICAgICAgICAKICAgICAgICAgICAgaWYgQHNjcm9sbER1cmF0aW9uID09IDAKICAgICAgICAgICAgICAgIEBveCA9IE1hdGguZmxvb3IoQG94IC8gbWFwLnRpbGVTaXplKSAqIG1hcC50aWxlU2l6ZQogICAgICAgICAgICAgICAgQG95ID0gTWF0aC5mbG9vcihAb3kgLyBtYXAudGlsZVNpemUpICogbWFwLnRpbGVTaXplCiAgICAgICAgICAgICAgICAKICAgIHVwZGF0ZVBsYXllclNjcm9sbGluZzogLT4KICAgICAgICBwbGF5ZXIgPSBHYW1lTWFuYWdlci5wbGF5ZXIKICAgICAgICBtYXAgPSBHYW1lTWFuYWdlci5tYXAKICAgICAgICAKICAgICAgICBpZiBub3QgbWFwPyBvciBub3QgcGxheWVyPyBvciBub3QgU2NlbmVNYW5hZ2VyLnNjZW5lLm1hcD8gdGhlbiByZXR1cm4KICAgICAgICAKICAgICAgICBzcHJpdGUgPSBTY2VuZU1hbmFnZXIuc2NlbmUubWFwLnBsYXllcgogICAgICAgIHB3ID0gc3ByaXRlLnNyY1JlY3Qud2lkdGgKICAgICAgICBwaCA9IHNwcml0ZS5zcmNSZWN0LmhlaWdodAogICAgICAgIGNlbnRlclggPSBHcmFwaGljcy53aWR0aCAvIDIKICAgICAgICBjZW50ZXJZID0gR3JhcGhpY3MuaGVpZ2h0IC8gMgogICAgICAgIHBsYXllckNlbnRlclggPSBzcHJpdGUueC1zcHJpdGUudmlld3BvcnQub3gtc3ByaXRlLm94ICsgTWF0aC5jZWlsKHB3IC8gMikKICAgICAgICBwbGF5ZXJDZW50ZXJZID0gc3ByaXRlLnktc3ByaXRlLnZpZXdwb3J0Lm95LXNwcml0ZS5veSArIE1hdGguZmxvb3IocGggLyAyKQogICAgICAgIGxvb3BUeXBlID0gbWFwLmxvb3BUeXBlCiAgICAgICAgCgogICAgICAgIGlmIHBsYXllci5pc01vdmluZwogICAgICAgICAgICBpZiBwbGF5ZXJDZW50ZXJZIDw9IGNlbnRlclkgYW5kIHBsYXllci5kaXJlY3Rpb24gPT0gNiAKICAgICAgICAgICAgICAgIEBveSA9IGlmIGxvb3BUeXBlID09IDEgb3IgbG9vcFR5cGUgPT0gMyB0aGVuIChAb3kgLSBwbGF5ZXIubW92ZVNwZWVkKSAlIChtYXAuaGVpZ2h0Km1hcC50aWxlU2l6ZSkgZWxzZSBNYXRoLm1heChAb3kgLSBwbGF5ZXIubW92ZVNwZWVkLCAwKQogICAgICAgICAgICBpZiBwbGF5ZXJDZW50ZXJZID49IGNlbnRlclkgYW5kIHBsYXllci5kaXJlY3Rpb24gPT0gMgogICAgICAgICAgICAgICAgQG95ID0gaWYgbG9vcFR5cGUgPT0gMSBvciBsb29wVHlwZSA9PSAzIHRoZW4gKEBveSArIHBsYXllci5tb3ZlU3BlZWQpICUgKG1hcC5oZWlnaHQqbWFwLnRpbGVTaXplKSBlbHNlIE1hdGgubWluKEBveSArIHBsYXllci5tb3ZlU3BlZWQsIG1hcC5oZWlnaHQgKiBtYXAudGlsZVNpemUgLSBHcmFwaGljcy5oZWlnaHQpCiAgICAgICAgICAgIGlmIHBsYXllckNlbnRlclggPD0gY2VudGVyWCBhbmQgcGxheWVyLmRpcmVjdGlvbiA9PSA0CiAgICAgICAgICAgICAgICBAb3ggPSBpZiBsb29wVHlwZSA9PSAyIG9yIGxvb3BUeXBlID09IDMgdGhlbiAoQG94IC0gcGxheWVyLm1vdmVTcGVlZCkgJSAobWFwLndpZHRoKm1hcC50aWxlU2l6ZSkgZWxzZSBNYXRoLm1heChAb3ggLSBwbGF5ZXIubW92ZVNwZWVkLCAwKQogICAgICAgICAgICBpZiBwbGF5ZXJDZW50ZXJYID49IGNlbnRlclggIGFuZCBwbGF5ZXIuZGlyZWN0aW9uID09IDgKICAgICAgICAgICAgICAgIEBveCA9IGlmIGxvb3BUeXBlID09IDIgb3IgbG9vcFR5cGUgPT0gMyB0aGVuIChAb3ggKyBwbGF5ZXIubW92ZVNwZWVkKSAlIChtYXAud2lkdGgqbWFwLnRpbGVTaXplKSBlbHNlIE1hdGgubWluKEBveCArIHBsYXllci5tb3ZlU3BlZWQsIG1hcC53aWR0aCAqIG1hcC50aWxlU2l6ZSAtIEdyYXBoaWNzLndpZHRoKQogICAgIAogICAgIAogICAgICAgIEBveCA9IGlmIGxvb3BUeXBlID09IDIgb3IgbG9vcFR5cGUgPT0gMyB0aGVuIEBveCBlbHNlIE1hdGgubWF4KEBveCwgMCkKICAgICAgICBAb3kgPSBpZiBsb29wVHlwZSA9PSAxIG9yIGxvb3BUeXBlID09IDMgdGhlbiBAb3kgZWxzZSBNYXRoLm1heChAb3ksIDApCiAgICAgICAgCiAgICAgICAgCiAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAKd2luZG93LkxvZ2ljX1NjcmVlbiA9IExvZ2ljX1NjcmVlbg==","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBMb2dpY19TY3JlZW47CgogIExvZ2ljX1NjcmVlbiA9IChmdW5jdGlvbigpIHsKICAgIGZ1bmN0aW9uIExvZ2ljX1NjcmVlbigpIHsKICAgICAgdGhpcy5zaGFrZVBvd2VyID0gMDsKICAgICAgdGhpcy5zaGFrZVNwZWVkID0gMTsKICAgICAgdGhpcy5zaGFrZUR1cmF0aW9uID0gLTE7CiAgICAgIHRoaXMub3ggPSAwOwogICAgICB0aGlzLm95ID0gMDsKICAgICAgdGhpcy54ID0gMDsKICAgICAgdGhpcy55ID0gMDsKICAgICAgdGhpcy50b25lID0gbmV3IFRvbmUoMCwgMCwgMCwgMCk7CiAgICAgIHRoaXMudGludER1cmF0aW9uID0gMDsKICAgICAgdGhpcy50aW50VG9uZSA9IG5ldyBUb25lKDAsIDAsIDAsIDApOwogICAgICB0aGlzLnRpbnRDb3VudGVyID0gMDsKICAgIH0KCiAgICBMb2dpY19TY3JlZW4ucHJvdG90eXBlLnN0YXJ0U2hha2UgPSBmdW5jdGlvbihwb3dlciwgc3BlZWQsIGR1cmF0aW9uKSB7CiAgICAgIHRoaXMuc2hha2VSYW5nZSA9IDA7CiAgICAgIHRoaXMuc2hha2VQb3dlciA9IHBvd2VyICogMjsKICAgICAgdGhpcy5zaGFrZVNwZWVkID0gc3BlZWQ7CiAgICAgIHJldHVybiB0aGlzLnNoYWtlRHVyYXRpb24gPSBkdXJhdGlvbjsKICAgIH07CgogICAgTG9naWNfU2NyZWVuLnByb3RvdHlwZS5zdG9wU2hha2UgPSBmdW5jdGlvbigpIHsKICAgICAgdGhpcy5zaGFrZVBvd2VyID0gMDsKICAgICAgcmV0dXJuIHRoaXMuc2hha2VSYW5nZSA9IDA7CiAgICB9OwoKICAgIExvZ2ljX1NjcmVlbi5wcm90b3R5cGUudGludCA9IGZ1bmN0aW9uKHRvbmUsIGR1cmF0aW9uKSB7CiAgICAgIHRoaXMudGludFRvbmUgPSB0b25lOwogICAgICB0aGlzLnRpbnREdXJhdGlvbiA9IGR1cmF0aW9uOwogICAgICB0aGlzLnRpbnRDb3VudGVyID0gZHVyYXRpb247CiAgICAgIGlmICh0aGlzLnRpbnREdXJhdGlvbiA9PT0gMCkgewogICAgICAgIHJldHVybiB0aGlzLnRvbmUgPSB0aGlzLnRpbnRUb25lOwogICAgICB9CiAgICB9OwoKICAgIExvZ2ljX1NjcmVlbi5wcm90b3R5cGUuc2Nyb2xsID0gZnVuY3Rpb24oc3RlcHNYLCBzdGVwc1ksIGR1cmF0aW9uKSB7CiAgICAgIHZhciBkeCwgZHksIG1hcDsKICAgICAgbWFwID0gR2FtZU1hbmFnZXIubWFwOwogICAgICB0aGlzLnNjcm9sbFN0ZXBzWCA9IHN0ZXBzWCAqIG1hcC50aWxlU2l6ZTsKICAgICAgdGhpcy5zY3JvbGxTdGVwc1kgPSBzdGVwc1kgKiBtYXAudGlsZVNpemU7CiAgICAgIHRoaXMuc2Nyb2xsRHVyYXRpb24gPSBkdXJhdGlvbjsKICAgICAgZHggPSAodGhpcy5veCArIHRoaXMuc2Nyb2xsU3RlcHNYKSAtIHRoaXMub3g7CiAgICAgIGR5ID0gKHRoaXMub3kgKyB0aGlzLnNjcm9sbFN0ZXBzWSkgLSB0aGlzLm95OwogICAgICB0aGlzLnNjcm9sbFNwZWVkWCA9IGR4IC8gZHVyYXRpb247CiAgICAgIHJldHVybiB0aGlzLnNjcm9sbFNwZWVkWSA9IGR5IC8gZHVyYXRpb247CiAgICB9OwoKICAgIExvZ2ljX1NjcmVlbi5wcm90b3R5cGUuY2VudGVyT25QbGF5ZXIgPSBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIHRoaXMuY2VudGVyT24oR2FtZU1hbmFnZXIucGxheWVyLngsIEdhbWVNYW5hZ2VyLnBsYXllci55KTsKICAgIH07CgogICAgTG9naWNfU2NyZWVuLnByb3RvdHlwZS5jZW50ZXJPbiA9IGZ1bmN0aW9uKHgsIHkpIHsKICAgICAgdmFyIG1hcCwgcGgsIHB3LCBzcHJpdGU7CiAgICAgIG1hcCA9IEdhbWVNYW5hZ2VyLm1hcDsKICAgICAgc3ByaXRlID0gU2NlbmVNYW5hZ2VyLnNjZW5lLm1hcC5wbGF5ZXI7CiAgICAgIHB3ID0gc3ByaXRlLnNyY1JlY3Qud2lkdGg7CiAgICAgIHBoID0gc3ByaXRlLnNyY1JlY3QuaGVpZ2h0OwogICAgICB4ID0gTWF0aC5mbG9vcih4IC0gKHB3IC0gbWFwLnRpbGVTaXplKSAvIDIpOwogICAgICB0aGlzLm94ID0geCAtIEdyYXBoaWNzLndpZHRoIC8gMiArIE1hdGguY2VpbChwdyAvIDIpOwogICAgICB0aGlzLm95ID0geSAtIChHcmFwaGljcy5oZWlnaHQgLSBwaCkgLyAyIC0gbWFwLnRpbGVTaXplOwogICAgICB0aGlzLm94ID0gbWFwLmxvb3BUeXBlID09PSAyIHx8IG1hcC5sb29wVHlwZSA9PT0gMyA/IHRoaXMub3ggOiBNYXRoLm1pbihNYXRoLm1heCh0aGlzLm94LCAwKSwgbWFwLndpZHRoICogbWFwLnRpbGVTaXplIC0gR3JhcGhpY3Mud2lkdGgpOwogICAgICByZXR1cm4gdGhpcy5veSA9IG1hcC5sb29wVHlwZSA9PT0gMSB8fCBtYXAubG9vcFR5cGUgPT09IDMgPyB0aGlzLm95IDogTWF0aC5taW4oTWF0aC5tYXgodGhpcy5veSwgMCksIG1hcC5oZWlnaHQgKiBtYXAudGlsZVNpemUgLSBHcmFwaGljcy5oZWlnaHQpOwogICAgfTsKCiAgICBMb2dpY19TY3JlZW4ucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkgewogICAgICB0aGlzLnVwZGF0ZVRpbnRpbmcoKTsKICAgICAgdGhpcy51cGRhdGVTY3JvbGxpbmcoKTsKICAgICAgdGhpcy51cGRhdGVQbGF5ZXJTY3JvbGxpbmcoKTsKICAgICAgcmV0dXJuIHRoaXMudXBkYXRlU2hha2luZygpOwogICAgfTsKCiAgICBMb2dpY19TY3JlZW4ucHJvdG90eXBlLnVwZGF0ZVNoYWtpbmcgPSBmdW5jdGlvbigpIHsKICAgICAgaWYgKHRoaXMuc2hha2VQb3dlciA9PT0gMCkgewogICAgICAgIHRoaXMuc2hha2VSYW5nZSA9IDA7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHRoaXMuc2hha2VSYW5nZSArPSB0aGlzLnNoYWtlU3BlZWQ7CiAgICAgIGlmICh0aGlzLnNoYWtlUmFuZ2UgPj0gdGhpcy5zaGFrZVBvd2VyIHx8IHRoaXMuc2hha2VSYW5nZSA8PSAtdGhpcy5zaGFrZVBvd2VyKSB7CiAgICAgICAgdGhpcy5zaGFrZVNwZWVkID0gdGhpcy5zaGFrZVNwZWVkICogLTE7CiAgICAgIH0KICAgICAgaWYgKHRoaXMuc2hha2VEdXJhdGlvbiA+IDApIHsKICAgICAgICB0aGlzLnNoYWtlRHVyYXRpb24tLTsKICAgICAgfQogICAgICBpZiAodGhpcy5zaGFrZUR1cmF0aW9uID09PSAwKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuc2hha2VQb3dlciA9IDA7CiAgICAgIH0KICAgIH07CgogICAgTG9naWNfU2NyZWVuLnByb3RvdHlwZS51cGRhdGVUaW50aW5nID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBhOwogICAgICBpZiAodGhpcy50aW50RHVyYXRpb24gPT09IDApIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgYSA9ICh0aGlzLnRpbnRDb3VudGVyIC8gdGhpcy50aW50RHVyYXRpb24pICogMjU1OwogICAgICB0aGlzLnRvbmUucmVkID0gTWF0aC5mbG9vcigodGhpcy50b25lLnJlZCAqIGEgKyB0aGlzLnRpbnRUb25lLnJlZCAqICgyNTUgLSBhKSkgLyAyNTUpOwogICAgICB0aGlzLnRvbmUuZ3JlZW4gPSBNYXRoLmZsb29yKCh0aGlzLnRvbmUuZ3JlZW4gKiBhICsgdGhpcy50aW50VG9uZS5ncmVlbiAqICgyNTUgLSBhKSkgLyAyNTUpOwogICAgICB0aGlzLnRvbmUuYmx1ZSA9IE1hdGguZmxvb3IoKHRoaXMudG9uZS5ibHVlICogYSArIHRoaXMudGludFRvbmUuYmx1ZSAqICgyNTUgLSBhKSkgLyAyNTUpOwogICAgICB0aGlzLnRvbmUuZ3JleSA9IE1hdGguZmxvb3IoKHRoaXMudG9uZS5ncmV5ICogYSArIHRoaXMudGludFRvbmUuZ3JleSAqICgyNTUgLSBhKSkgLyAyNTUpOwogICAgICB0aGlzLnRpbnRDb3VudGVyLS07CiAgICAgIGlmICh0aGlzLnRpbnRDb3VudGVyIDw9IDApIHsKICAgICAgICB0aGlzLnRpbnRDb3VudGVyID0gMDsKICAgICAgICB0aGlzLnRpbnREdXJhdGlvbiA9IDA7CiAgICAgICAgcmV0dXJuIHRoaXMudG9uZSA9IHRoaXMudGludFRvbmU7CiAgICAgIH0KICAgIH07CgogICAgTG9naWNfU2NyZWVuLnByb3RvdHlwZS51cGRhdGVTY3JvbGxpbmcgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIG1hcDsKICAgICAgaWYgKHRoaXMuc2Nyb2xsRHVyYXRpb24gPiAwKSB7CiAgICAgICAgbWFwID0gR2FtZU1hbmFnZXIubWFwOwogICAgICAgIHRoaXMuc2Nyb2xsRHVyYXRpb24tLTsKICAgICAgICB0aGlzLm94ICs9IHRoaXMuc2Nyb2xsU3BlZWRYOwogICAgICAgIHRoaXMub3kgKz0gdGhpcy5zY3JvbGxTcGVlZFk7CiAgICAgICAgaWYgKHRoaXMuc2Nyb2xsRHVyYXRpb24gPT09IDApIHsKICAgICAgICAgIHRoaXMub3ggPSBNYXRoLmZsb29yKHRoaXMub3ggLyBtYXAudGlsZVNpemUpICogbWFwLnRpbGVTaXplOwogICAgICAgICAgcmV0dXJuIHRoaXMub3kgPSBNYXRoLmZsb29yKHRoaXMub3kgLyBtYXAudGlsZVNpemUpICogbWFwLnRpbGVTaXplOwogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICBMb2dpY19TY3JlZW4ucHJvdG90eXBlLnVwZGF0ZVBsYXllclNjcm9sbGluZyA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgY2VudGVyWCwgY2VudGVyWSwgbG9vcFR5cGUsIG1hcCwgcGgsIHBsYXllciwgcGxheWVyQ2VudGVyWCwgcGxheWVyQ2VudGVyWSwgcHcsIHNwcml0ZTsKICAgICAgcGxheWVyID0gR2FtZU1hbmFnZXIucGxheWVyOwogICAgICBtYXAgPSBHYW1lTWFuYWdlci5tYXA7CiAgICAgIGlmICgobWFwID09IG51bGwpIHx8IChwbGF5ZXIgPT0gbnVsbCkgfHwgKFNjZW5lTWFuYWdlci5zY2VuZS5tYXAgPT0gbnVsbCkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgc3ByaXRlID0gU2NlbmVNYW5hZ2VyLnNjZW5lLm1hcC5wbGF5ZXI7CiAgICAgIHB3ID0gc3ByaXRlLnNyY1JlY3Qud2lkdGg7CiAgICAgIHBoID0gc3ByaXRlLnNyY1JlY3QuaGVpZ2h0OwogICAgICBjZW50ZXJYID0gR3JhcGhpY3Mud2lkdGggLyAyOwogICAgICBjZW50ZXJZID0gR3JhcGhpY3MuaGVpZ2h0IC8gMjsKICAgICAgcGxheWVyQ2VudGVyWCA9IHNwcml0ZS54IC0gc3ByaXRlLnZpZXdwb3J0Lm94IC0gc3ByaXRlLm94ICsgTWF0aC5jZWlsKHB3IC8gMik7CiAgICAgIHBsYXllckNlbnRlclkgPSBzcHJpdGUueSAtIHNwcml0ZS52aWV3cG9ydC5veSAtIHNwcml0ZS5veSArIE1hdGguZmxvb3IocGggLyAyKTsKICAgICAgbG9vcFR5cGUgPSBtYXAubG9vcFR5cGU7CiAgICAgIGlmIChwbGF5ZXIuaXNNb3ZpbmcpIHsKICAgICAgICBpZiAocGxheWVyQ2VudGVyWSA8PSBjZW50ZXJZICYmIHBsYXllci5kaXJlY3Rpb24gPT09IDYpIHsKICAgICAgICAgIHRoaXMub3kgPSBsb29wVHlwZSA9PT0gMSB8fCBsb29wVHlwZSA9PT0gMyA/ICh0aGlzLm95IC0gcGxheWVyLm1vdmVTcGVlZCkgJSAobWFwLmhlaWdodCAqIG1hcC50aWxlU2l6ZSkgOiBNYXRoLm1heCh0aGlzLm95IC0gcGxheWVyLm1vdmVTcGVlZCwgMCk7CiAgICAgICAgfQogICAgICAgIGlmIChwbGF5ZXJDZW50ZXJZID49IGNlbnRlclkgJiYgcGxheWVyLmRpcmVjdGlvbiA9PT0gMikgewogICAgICAgICAgdGhpcy5veSA9IGxvb3BUeXBlID09PSAxIHx8IGxvb3BUeXBlID09PSAzID8gKHRoaXMub3kgKyBwbGF5ZXIubW92ZVNwZWVkKSAlIChtYXAuaGVpZ2h0ICogbWFwLnRpbGVTaXplKSA6IE1hdGgubWluKHRoaXMub3kgKyBwbGF5ZXIubW92ZVNwZWVkLCBtYXAuaGVpZ2h0ICogbWFwLnRpbGVTaXplIC0gR3JhcGhpY3MuaGVpZ2h0KTsKICAgICAgICB9CiAgICAgICAgaWYgKHBsYXllckNlbnRlclggPD0gY2VudGVyWCAmJiBwbGF5ZXIuZGlyZWN0aW9uID09PSA0KSB7CiAgICAgICAgICB0aGlzLm94ID0gbG9vcFR5cGUgPT09IDIgfHwgbG9vcFR5cGUgPT09IDMgPyAodGhpcy5veCAtIHBsYXllci5tb3ZlU3BlZWQpICUgKG1hcC53aWR0aCAqIG1hcC50aWxlU2l6ZSkgOiBNYXRoLm1heCh0aGlzLm94IC0gcGxheWVyLm1vdmVTcGVlZCwgMCk7CiAgICAgICAgfQogICAgICAgIGlmIChwbGF5ZXJDZW50ZXJYID49IGNlbnRlclggJiYgcGxheWVyLmRpcmVjdGlvbiA9PT0gOCkgewogICAgICAgICAgdGhpcy5veCA9IGxvb3BUeXBlID09PSAyIHx8IGxvb3BUeXBlID09PSAzID8gKHRoaXMub3ggKyBwbGF5ZXIubW92ZVNwZWVkKSAlIChtYXAud2lkdGggKiBtYXAudGlsZVNpemUpIDogTWF0aC5taW4odGhpcy5veCArIHBsYXllci5tb3ZlU3BlZWQsIG1hcC53aWR0aCAqIG1hcC50aWxlU2l6ZSAtIEdyYXBoaWNzLndpZHRoKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgdGhpcy5veCA9IGxvb3BUeXBlID09PSAyIHx8IGxvb3BUeXBlID09PSAzID8gdGhpcy5veCA6IE1hdGgubWF4KHRoaXMub3gsIDApOwogICAgICByZXR1cm4gdGhpcy5veSA9IGxvb3BUeXBlID09PSAxIHx8IGxvb3BUeXBlID09PSAzID8gdGhpcy5veSA6IE1hdGgubWF4KHRoaXMub3ksIDApOwogICAgfTsKCiAgICByZXR1cm4gTG9naWNfU2NyZWVuOwoKICB9KSgpOwoKICB3aW5kb3cuTG9naWNfU2NyZWVuID0gTG9naWNfU2NyZWVuOwoKfSkuY2FsbCh0aGlzKTsK"},{"name":"Logic_Character","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogTG9naWNfQ2hhcmFjdGVyCiMgICBDcmVhdGVkIG9uOiAyMDEzLTA5LTAxCiMKIyAgIENvcHlyaWdodCAoQykgMjAxMyBBbmRy6SBSYWRvbXNraS4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KIwojICAgQ2xhc3M6IExvZ2ljX0NoYXJhY3RlcgojCiMgICBBIGJhc2UgY2xhc3MgZm9yIGFsbCBvdGhlciB3aW5kb3cgY2xhc3Nlcy4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCmNsYXNzIExvZ2ljX0NoYXJhY3RlcgogICAgY29uc3RydWN0b3I6IC0+CiAgICAgICAgcyA9IFdpbmRvd19CYXNlLnNjYWxlCiAgICAgICAgQGlzTW92aW5nID0gbm8KICAgICAgICBAaXNGbHlpbmcgPSBubwogICAgICAgIEBpc1NvYXJpbmcgPSBubwogICAgICAgIEBpc0xhbmRpbmcgPSBubwogICAgICAgIEBpc0p1bXBpbmcgPSBubwogICAgICAgIEBidXNoRmxhZyA9IG5vCiAgICAgICAgQGRpcmVjdGlvbiA9IDAKICAgICAgICBAZGlyZWN0aW9ucyA9IFsyLCA0LCA2LCA4XQogICAgICAgIEBzcGVlZHMgPSAgICAgICBbMC41KnMsIDEqcywgMipzLCA0KnMsIDgqc10KICAgICAgICBAZnJlcXVlbmNpZXMgPSAgWzAuMDMxMjUsIDAuMDYyNSwgMC4xMjUsIDAuMjUsIDAuNV0KICAgICAgICBAbW92ZVJvdXRlRnJlcXVlbmNpZXMgPSBbMjQwLCAxMjAsIDYwLCAzMCwgMF0KICAgICAgICBAbW92ZVNwZWVkID0gQHNwZWVkc1syXQogICAgICAgIEBmcmVxdWVuY3kgPSBAZnJlcXVlbmNpZXNbMl0KICAgICAgICBAbW92ZVJvdXRlRnJlcXVlbmN5ID0gQG1vdmVSb3V0ZUZyZXF1ZW5jaWVzWzJdCiAgICAgICAgQHggPSAwCiAgICAgICAgQHkgPSAzMgogICAgICAgIEBwYXR0ZXJuID0gMAogICAgICAgIEBzdWJQYXR0ZXJuID0gMAogICAgICAgIEBjdXJyZW50U3ViUGF0dGVybiA9IDAKICAgICAgICBAbW92ZVN0ZXBzID0gMAogICAgICAgIEBwYXR0ZXJuQ291bnQgPSAwCiAgICAgICAgQGxhc3RQYXR0ZXJuQ291bnQgPSAwCiAgICAgICAgQG1hcERhdGEgPSBudWxsCiAgICAgICAgQG1hcCA9IG51bGwKICAgICAgICBAdGlsZXNldCA9IG51bGwKICAgICAgICBAdGVycmFpblRhZyA9IDAKICAgICAgICBAcm91dGUgPSBudWxsCiAgICAgICAgQHJvdXRlUG9pbnRlciA9IDAKICAgICAgICBAcm91dGVXYWl0Q291bnRlciA9IDAKICAgICAgICBAcHJlZGVmaW5lZFJvdXRlcyA9IFt7IGNvbW1hbmRzOiBbeyBpZDogOCB9XSwgcmVwZWF0OiB5ZXMsIHNraXA6IHllcyB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgY29tbWFuZHM6IFt7IGlkOiA5IH1dLCByZXBlYXQ6IHllcywgc2tpcDogeWVzIH1dCiAgICAgICAgQGNvbGxpc2lvbk1hcCA9IG51bGwKICAgICAgICBAYWx0aXR1ZGUgPSAwCiAgICAgICAgQGFuaW1hdGlvbkNvdW50ZXIgPSAwCiAgICAgICAgQHdhbGtpbmdBbmltYXRpb24gPSB5ZXMKICAgICAgICBAc3RlcHBpbmdBbmltYXRpb24gPSBubwogICAgICAgIEB0aHJvdWdoID0gbm8KICAgICAgICBAZGlyZWN0aW9uRml4ID0gbm8KICAgICAgICBAZ3JhcGhpYyA9IG51bGwKICAgICAgICBAb3BhY2l0eSA9IDI1NQogICAgICAgIEBibGVuZGluZyA9IDAKICAgICAgICBAdG9uZSA9IG5ldyBUb25lKDAsIDAsIDAsIDApCiAgICAgICAgQHZpc2libGUgPSB5ZXMKICAgICAgICBAbW90aW9uQmx1ciA9IG5vCiAgICAgICAgQG1vdGlvbkJsdXJMZW5ndGggPSAzCiAgICAgICAgQG1vdGlvbkJsdXJPcGFjaXR5ID0gMTAwCiAgICAgICAgQG1vdGlvbkJsdXJGaXhlZE9wYWNpdHkgPSBubwogICAgICAgIEBtb3Rpb25CbHVyQ29sb3IgPSBDb2xvci5UUkFOU1BBUkVOVAogICAgICAgIEBwYXNzYWdlcyA9IG51bGwKICAgICAgICBAaXNMb2NrZWQgPSBubwogICAgdXBkYXRlOiAtPiAKICAgICAgICBAdXBkYXRlUm91dGUoKQogICAgICAgIEB1cGRhdGVQYXR0ZXJuKCkKICAgICAgICBAdXBkYXRlTW92ZSgpCiAgICAgICAgCiAgICAgICAgQHVwZGF0ZVNvYXJpbmcoKQogICAgICAgIEB1cGRhdGVMYW5kaW5nKCkKICAgICAgICBAdXBkYXRlSnVtcCgpCiAgICAgICAgCiAgICAgICAgd2lkdGggPSBAbWFwLndpZHRoICogQG1hcC50aWxlU2l6ZQogICAgICAgIGhlaWdodCA9IEBtYXAuaGVpZ2h0ICogQG1hcC50aWxlU2l6ZQogICAgICAgIAogICAgICAgIGlmIEBtYXAubG9vcFR5cGUgPT0gMiBvciBAbWFwLmxvb3BUeXBlID09IDMKICAgICAgICAgICAgQHggPSBpZiBAeCA8IDAgdGhlbiBAeCsod2lkdGgpIGVsc2UgQHgKICAgICAgICAgICAgQHggPSBpZiBAeCA+PSB3aWR0aCB0aGVuIEB4LXdpZHRoIGVsc2UgQHgKICAgICAgICBlbHNlCiAgICAgICAgICAgIEB4ID0gTWF0aC5taW4oTWF0aC5tYXgoQHgsIDApLCB3aWR0aC1AbWFwLnRpbGVTaXplKQogICAgICAgICAgICAKICAgICAgICBpZiBAbWFwLmxvb3BUeXBlID09IDEgb3IgQG1hcC5sb29wVHlwZSA9PSAzCiAgICAgICAgICAgIEB5ID0gaWYgQHkgPCAwIHRoZW4gQHkrKGhlaWdodCkgZWxzZSBAeQogICAgICAgICAgICBAeSA9IGlmIEB5ID49IGhlaWdodCB0aGVuIEB5LWhlaWdodCBlbHNlIEB5CiAgICAgICAgZWxzZQogICAgICAgICAgICBAeSA9IE1hdGgubWluKE1hdGgubWF4KEB5LCAwKSwgaGVpZ2h0LUBtYXAudGlsZVNpemUpCiAgICAgICAgCiAgICB1cGRhdGVTb2FyaW5nOiAtPgogICAgICAgIGlmIEBpc1NvYXJpbmcKICAgICAgICAgICBAeSAtPSBAbW92ZVNwZWVkCiAgICAgICAgICAgQGFuaW1hdGlvbkNvdW50ZXIgLT0gQG1vdmVTcGVlZAogICAgICAgICAgIEBpc1NvYXJpbmcgPSBAYW5pbWF0aW9uQ291bnRlciA+IDAKICAgIHVwZGF0ZUxhbmRpbmc6IC0+CiAgICAgICAgaWYgQGlzTGFuZGluZwogICAgICAgICAgICBAeSArPSBAbW92ZVNwZWVkCiAgICAgICAgICAgIEBhbmltYXRpb25Db3VudGVyIC09IEBtb3ZlU3BlZWQKICAgICAgICAgICAgQGlzTGFuZGluZyA9IEBhbmltYXRpb25Db3VudGVyID4gMAogICAgICAgICAgIAogICAgICAgICAgICBpZiBub3QgQGlzTGFuZGluZwogICAgICAgICAgICAgICAgdHggPSBAdHgoKQogICAgICAgICAgICAgICAgdHkgPSBAdHkoKQogICAgICAgICAgICAgICAgQGNvbGxpc2lvbk1hcFsodHktMSkgKiBAbWFwLndpZHRoICsgdHhdLnJlbW92ZSh0aGlzKQogICAgICAgICAgICAgICAgQGNvbGxpc2lvbk1hcFsodHkpICogQG1hcC53aWR0aCArIHR4XS5wdXNoKHRoaXMpCiAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAKICAgIHVwZGF0ZUZseTogLT4KCiAgICB1cGRhdGVKdW1wOiAtPiAgICAgICAKICAgICAgICBpZiBAaXNKdW1waW5nCiAgICAgICAgICAgIEBqdW1wQ291bnRlci0tCiAgICAgICAgICAgIEB4ID0gKEB4ICogQGp1bXBDb3VudGVyICsgQGp1bXBYKSAvIChAanVtcENvdW50ZXIrMSkKICAgICAgICAgICAgQHNoYWRvd1kgPSAoQHNoYWRvd1kgKiBAanVtcENvdW50ZXIgKyBAanVtcFkpIC8gKEBqdW1wQ291bnRlcisxKQoKICAgICAgICAgICAgaWYgKEBqdW1wQ291bnRlcikgPj0gQGp1bXBDb3VudGVySGFsZgogICAgICAgICAgICAgICAgQGp1bXBIZWlnaHQgKz0gTWF0aC5yb3VuZChAanVtcFZhbHVlICogKChAanVtcENvdW50ZXIgLSBAanVtcENvdW50ZXJIYWxmKSAvIEBqdW1wQ291bnRlckhhbGYpKQogICAgICAgICAgICAgICAgQHkgPSBAc2hhZG93WSAtIEBqdW1wSGVpZ2h0CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIEBqdW1wSGVpZ2h0ID0gTWF0aC5tYXgoQGp1bXBIZWlnaHQgLSBNYXRoLnJvdW5kKEBqdW1wVmFsdWUgKiAoKEBqdW1wQ291bnRlckhhbGYgLSBAanVtcENvdW50ZXIpIC8gQGp1bXBDb3VudGVySGFsZikpLCAwKQogICAgICAgICAgICAgICAgQHkgPSBAc2hhZG93WSAtIEBqdW1wSGVpZ2h0CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgaWYgQGlzSnVtcGluZyBhbmQgQGp1bXBDb3VudGVyID09IDAKICAgICAgICAgICAgICAgIEBpc0p1bXBpbmcgPSBubwogICAgICAgICAgICAgICAgQHggPSBNYXRoLnJvdW5kKEB4IC8gQG1hcC50aWxlU2l6ZSkgKiBAbWFwLnRpbGVTaXplCiAgICAgICAgICAgICAgICBAeSA9IE1hdGgucm91bmQoQG1hcC50aWxlU2l6ZSkgKiBAbWFwLnRpbGVTaXplICAgCiAgICAgICAgICAgICAgICAgICAgICAgCiAgICB1cGRhdGVNb3ZlOiAtPgogICAgICAgIGlmIEBpc01vdmluZwogICAgICAgICAgICBAbW92ZVN0ZXBzICs9IEBtb3ZlU3BlZWQKICAgICAgICAgICAgc3dpdGNoIEBkaXJlY3Rpb24KICAgICAgICAgICAgICAgIHdoZW4gMiAjIERPV04KICAgICAgICAgICAgICAgICAgICBAeSArPSBAbW92ZVNwZWVkCiAgICAgICAgICAgICAgICAgICAgaWYgQG1vdmVTdGVwcyA+PSBAbWFwLnRpbGVTaXplIHRoZW4gQHkgLT0gQG1vdmVTdGVwcyAtIEBtYXAudGlsZVNpemUKICAgICAgICAgICAgICAgIHdoZW4gNCAjIExFRlQKICAgICAgICAgICAgICAgICAgICBAeCAtPSBAbW92ZVNwZWVkCiAgICAgICAgICAgICAgICAgICAgaWYgQG1vdmVTdGVwcyA+PSBAbWFwLnRpbGVTaXplIHRoZW4gQHggKz0gQG1vdmVTdGVwcyAtIEBtYXAudGlsZVNpemUKICAgICAgICAgICAgICAgIHdoZW4gNiAjIFVQCiAgICAgICAgICAgICAgICAgICAgQHkgLT0gQG1vdmVTcGVlZAogICAgICAgICAgICAgICAgICAgIGlmIEBtb3ZlU3RlcHMgPj0gQG1hcC50aWxlU2l6ZSB0aGVuIEB5ICs9IEBtb3ZlU3RlcHMgLSBAbWFwLnRpbGVTaXplCiAgICAgICAgICAgICAgICB3aGVuIDggIyBSSUdIVAogICAgICAgICAgICAgICAgICAgIEB4ICs9IEBtb3ZlU3BlZWQKICAgICAgICAgICAgICAgICAgICBpZiBAbW92ZVN0ZXBzID49IEBtYXAudGlsZVNpemUgdGhlbiBAeCAtPSBAbW92ZVN0ZXBzIC0gQG1hcC50aWxlU2l6ZQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICBpZiBAbW92ZVN0ZXBzID49IEBtYXAudGlsZVNpemUKICAgICAgICAgICAgICAgIEBtb3ZlU3RlcHMgPSAwCiAgICAgICAgICAgICAgICBAaXNNb3ZpbmcgPSBubwogICAgICAgICAgICAgICAgQG9uTW92ZUZpbmlzaCgpCiAgICAgICAgZWxzZSBpZiBub3QgQHN0ZXBwaW5nQW5pbWF0aW9uCiAgICAgICAgICAgIHAgPSBNYXRoLmZsb29yKEBsYXN0UGF0dGVybkNvdW50ICogQGZyZXF1ZW5jeSkgJSA0CiAgICAgICAgICAgIGlmICBwID09IDAgfHwgcCA9PSAzCiAgICAgICAgICAgICAgICBAcGF0dGVybkNvdW50ID0gTWF0aC5mbG9vcigxIC8gQGZyZXF1ZW5jeSkgCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIEBwYXR0ZXJuQ291bnQgPSBNYXRoLmZsb29yKDMgLyBAZnJlcXVlbmN5KSAKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgCiAgICBvbk1vdmVGaW5pc2g6IC0+ICMgSW1wbGVtZW50IGluIGRlcml2ZWQgY2xhc3NlcwogICAgICAgIAogICAgc3ViUGF0dGVybkNvbHVtbjogLT4gaWYgQHdhbGtpbmdBbmltYXRpb24gdGhlbiAwIGVsc2UgQHN1YlBhdHRlcm4gJSA0CiAgICB1cGRhdGVQYXR0ZXJuOiAtPgogICAgICAgIG1vdmluZyA9IChAaXNNb3ZpbmcgYW5kIEB3YWxraW5nQW5pbWF0aW9uKSBvciBAc3RlcHBpbmdBbmltYXRpb24KICAgICAgICBkaXJlY3Rpb24gPSBpZiBAZGlyZWN0aW9uRml4ZWQgYW5kIG1vdmluZyB0aGVuIEBkaXJlY3Rpb25zWyhNYXRoLmZsb29yKChAc3ViUGF0dGVybikgLyA0KSsyKSAlIDRdIGVsc2UgQGRpcmVjdGlvbgogICAgICAgIGNvbHVtbiA9IEBzdWJQYXR0ZXJuQ29sdW1uKCkKICAgICAgICAKICAgICAgICBzd2l0Y2ggZGlyZWN0aW9uCiAgICAgICAgICAgIHdoZW4gMiAjIERPV04gICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBAc3ViUGF0dGVybiA9IGlmIG1vdmluZyB0aGVuIDAgKyAoTWF0aC5mbG9vcihAcGF0dGVybkNvdW50ICogQGZyZXF1ZW5jeSkgJSA0KSBlbHNlIGNvbHVtbgogICAgICAgICAgICAgICAgI2lmIEBzdWJQYXR0ZXJuID09IDkgdGhlbiBAc3ViUGF0dGVybiA9IDcKICAgICAgICAgICAgd2hlbiA0ICMgTEVGVAogICAgICAgICAgICAgICAgQHN1YlBhdHRlcm4gPSBpZiBtb3ZpbmcgdGhlbiA0ICsgKE1hdGguZmxvb3IoQHBhdHRlcm5Db3VudCAqIEBmcmVxdWVuY3kpICUgNCkgZWxzZSBjb2x1bW4rNAogICAgICAgICAgICAgICAgI2lmIEBzdWJQYXR0ZXJuID09IDEyIHRoZW4gQHN1YlBhdHRlcm4gPSAxMAogICAgICAgICAgICB3aGVuIDYgIyBVUAogICAgICAgICAgICAgICAgQHN1YlBhdHRlcm4gPSBpZiBtb3ZpbmcgdGhlbiAxMiArIChNYXRoLmZsb29yKEBwYXR0ZXJuQ291bnQgKiBAZnJlcXVlbmN5KSAlIDQpIGVsc2UgY29sdW1uKzEyCiAgICAgICAgICAgICAgICAjaWYgQHN1YlBhdHRlcm4gPT0gMyB0aGVuIEBzdWJQYXR0ZXJuID0gMQogICAgICAgICAgICB3aGVuIDggIyBSSUdIVAogICAgICAgICAgICAgICAgQHN1YlBhdHRlcm4gPSBpZiBtb3ZpbmcgdGhlbiA4ICsgKE1hdGguZmxvb3IoQHBhdHRlcm5Db3VudCAqIEBmcmVxdWVuY3kpICUgNCkgZWxzZSBjb2x1bW4rOAogICAgICAgICAgICAgICAgI2lmIEBzdWJQYXR0ZXJuID09IDYgdGhlbiBAc3ViUGF0dGVybiA9IDQKICAgICAgICAgICAgICAgIAogICAgICAgIAogICAgICAgIGlmIG1vdmluZwogICAgICAgICAgICBAbGFzdFBhdHRlcm5Db3VudCA9IEBwYXR0ZXJuQ291bnQKICAgICAgICAgICAgQHBhdHRlcm5Db3VudCsrCiAgICAgIAogICAgdXBkYXRlUm91dGU6IC0+CiAgICAgICAgY29tbWFuZCA9IG51bGwKICAgICAgICBtb3ZlZCA9IHllcwogIAogICAgICAgIGlmIEByb3V0ZT8gYW5kIG5vdCBAaXNNb3ZpbmcgYW5kIG5vdCBAaXNKdW1waW5nCiAgICAgICAgICAgIAogICAgICAgICAgICBpZiBAcm91dGVXYWl0Q291bnRlciA+IDAKICAgICAgICAgICAgICAgIEByb3V0ZVdhaXRDb3VudGVyLS0KICAgICAgICAgICAgCiAgICAgICAgICAgIHdoaWxlIG1vdmVkIGFuZCBub3QgQGlzTW92aW5nIGFuZCBub3QgQGlzU29hcmluZyBhbmQgbm90IEBpc0xhbmRpbmcgYW5kIG5vdCBAaXNKdW1waW5nIGFuZCAoQHJvdXRlV2FpdENvdW50ZXIgPT0gMCkgYW5kIEByb3V0ZT8KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaWYgQHJvdXRlUG9pbnRlciA+PSBAcm91dGUuY29tbWFuZHMubGVuZ3RoIGFuZCBAcm91dGVXYWl0Q291bnRlciA8PSAwCiAgICAgICAgICAgICAgICAgICAgQHJvdXRlUG9pbnRlciA9IDAKICAgICAgICAgICAgICAgICAgICBpZiBub3QgQHJvdXRlLnJlcGVhdAogICAgICAgICAgICAgICAgICAgICAgICBAcm91dGUgPSBudWxsCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIEBvblJvdXRlRmluaXNoPyB0aGVuIEBvblJvdXRlRmluaXNoKCkKICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBjb21tYW5kID0gQHJvdXRlLmNvbW1hbmRzW0Byb3V0ZVBvaW50ZXJdCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIHN3aXRjaCBjb21tYW5kLmlkCiAgICAgICAgICAgICAgICAgICAgIyBNb3ZlIERvd24KICAgICAgICAgICAgICAgICAgICB3aGVuIDAgdGhlbiBtb3ZlZCA9IEBtb3ZlKDIpCiAgICAgICAgICAgICAgICAgICAgIyBNb3ZlIExlZnQKICAgICAgICAgICAgICAgICAgICB3aGVuIDEgdGhlbiBtb3ZlZCA9IEBtb3ZlKDQpCiAgICAgICAgICAgICAgICAgICAgIyBNb3ZlIFVwCiAgICAgICAgICAgICAgICAgICAgd2hlbiAyIHRoZW4gbW92ZWQgPSBAbW92ZSg2KQogICAgICAgICAgICAgICAgICAgICMgTW92ZSBSaWdodAogICAgICAgICAgICAgICAgICAgIHdoZW4gMyB0aGVuIG1vdmVkID0gQG1vdmUoOCkKICAgICAgICAgICAgICAgICAgICAjIE1vdmUgTG93ZXIgTGVmdAogICAgICAgICAgICAgICAgICAgIHdoZW4gNAogICAgICAgICAgICAgICAgICAgICAgICBAcm91dGUuY29tbWFuZHMuc3BsaWNlKEByb3V0ZVBvaW50ZXIsIDEsIHsgaWQ6IDAgfSwgeyBpZDogMSB9KQogICAgICAgICAgICAgICAgICAgICAgICBAcm91dGVQb2ludGVyLS0gICAgCiAgICAgICAgICAgICAgICAgICAgIyBNb3ZlIExvd2VyIFJpZ2h0CiAgICAgICAgICAgICAgICAgICAgd2hlbiA1CiAgICAgICAgICAgICAgICAgICAgICAgIEByb3V0ZS5jb21tYW5kcy5zcGxpY2UoQHJvdXRlUG9pbnRlciwgMSwgeyBpZDogMCB9LCB7IGlkOiAzIH0pCiAgICAgICAgICAgICAgICAgICAgICAgIEByb3V0ZVBvaW50ZXItLQogICAgICAgICAgICAgICAgICAgICMgTW92ZSBVcHBlciBMZWZ0CiAgICAgICAgICAgICAgICAgICAgd2hlbiA2CiAgICAgICAgICAgICAgICAgICAgICAgIEByb3V0ZS5jb21tYW5kcy5zcGxpY2UoQHJvdXRlUG9pbnRlciwgMSwgeyBpZDogMiB9LCB7IGlkOiAxIH0pCiAgICAgICAgICAgICAgICAgICAgICAgIEByb3V0ZVBvaW50ZXItLQogICAgICAgICAgICAgICAgICAgICMgTW92ZSBVcHBlciBSaWdodAogICAgICAgICAgICAgICAgICAgIHdoZW4gNwogICAgICAgICAgICAgICAgICAgICAgICBAcm91dGUuY29tbWFuZHMuc3BsaWNlKEByb3V0ZVBvaW50ZXIsIDEsIHsgaWQ6IDIgfSwgeyBpZDogMyB9KQogICAgICAgICAgICAgICAgICAgICAgICBAcm91dGVQb2ludGVyLS0KICAgICAgICAgICAgICAgICAgICAjIE1vdmUgUmFuZG9tCiAgICAgICAgICAgICAgICAgICAgd2hlbiA4IHRoZW4gbW92ZWQgPSBAbW92ZShbMiwgNCwgNiwgOF1bTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNCldKQogICAgICAgICAgICAgICAgICAgICMgTW92ZSB0b3dhcmQgUGxheWVyCiAgICAgICAgICAgICAgICAgICAgd2hlbiA5CiAgICAgICAgICAgICAgICAgICAgICAgIHBsYXllciA9IEdhbWVNYW5hZ2VyLnBsYXllcgogICAgICAgICAgICAgICAgICAgICAgICBkeCA9IEB4IC0gcGxheWVyLngKICAgICAgICAgICAgICAgICAgICAgICAgZHkgPSBAeSAtIHBsYXllci55CiAgICAgICAgICAgICAgICAgICAgICAgIG1vdmVkID0gbm8KICAgICAgICAgICAgICAgICAgICAgICAgaWYgTWF0aC5hYnMoZHgpIDwgTWF0aC5hYnMoZHkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBkeSA+IDAgdGhlbiBtb3ZlZCA9IEBtb3ZlKDYpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBkeSA8IDAgdGhlbiBtb3ZlZCA9IEBtb3ZlKDIpICAKICAgICAgICAgICAgICAgICAgICAgICAgaWYgTWF0aC5hYnMoZHgpID49IE1hdGguYWJzKGR5KSBvciBub3QgbW92ZWQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGR4ID4gMCB0aGVuIG1vdmVkID0gQG1vdmUoNCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGR4IDwgMCB0aGVuIG1vdmVkID0gQG1vdmUoOCkKICAgICAgICAgICAgICAgICAgICAgICAgaWYgbm90IG1vdmVkCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBkeSA+IDAgdGhlbiBtb3ZlZCA9IEBtb3ZlKDYpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBkeSA8IDAgdGhlbiBtb3ZlZCA9IEBtb3ZlKDIpIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgIyBNb3ZlIGF3YXkgZnJvbSBQbGF5ZXIKICAgICAgICAgICAgICAgICAgICB3aGVuIDEwCiAgICAgICAgICAgICAgICAgICAgICAgIHBsYXllciA9IEdhbWVNYW5hZ2VyLnBsYXllcgogICAgICAgICAgICAgICAgICAgICAgICBkeCA9IEB4IC0gcGxheWVyLngKICAgICAgICAgICAgICAgICAgICAgICAgZHkgPSBAeSAtIHBsYXllci55CiAgICAgICAgICAgICAgICAgICAgICAgIG1vdmVkID0gbm8KICAgICAgICAgICAgICAgICAgICAgICAgaWYgTWF0aC5hYnMoZHgpIDwgTWF0aC5hYnMoZHkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBkeCA+IDAgdGhlbiBtb3ZlZCA9IEBtb3ZlKDgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBkeCA8IDAgdGhlbiBtb3ZlZCA9IEBtb3ZlKDQpCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIE1hdGguYWJzKGR4KSA+PSBNYXRoLmFicyhkeSkgb3Igbm90IG1vdmVkCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBkeSA+IDAgdGhlbiBtb3ZlZCA9IEBtb3ZlKDIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBkeSA8IDAgdGhlbiBtb3ZlZCA9IEBtb3ZlKDYpICAKICAgICAgICAgICAgICAgICAgICAgICAgaWYgbm90IG1vdmVkCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBkeCA+IDAgdGhlbiBtb3ZlZCA9IEBtb3ZlKDgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBkeCA8IDAgdGhlbiBtb3ZlZCA9IEBtb3ZlKDQpCiAgICAgICAgICAgICAgICAgICAgIyBNb3ZlIEZvcndhcmQKICAgICAgICAgICAgICAgICAgICB3aGVuIDExIHRoZW4gbW92ZWQgPSBAbW92ZShAZGlyZWN0aW9uKQogICAgICAgICAgICAgICAgICAgICMgTW92ZSBCYWNrd2FyZAogICAgICAgICAgICAgICAgICAgIHdoZW4gMTIgdGhlbiBtb3ZlZCA9IEBtb3ZlKEBkaXJlY3Rpb25zWyhAZGlyZWN0aW9ucy5pbmRleE9mKEBkaXJlY3Rpb24pICsgMikgJSA0XSkKICAgICAgICAgICAgICAgICAgICAjIFdhaXQKICAgICAgICAgICAgICAgICAgICB3aGVuIDEzIHRoZW4gQHJvdXRlV2FpdENvdW50ZXIgPSBjb21tYW5kLnRpbWUKICAgICAgICAgICAgICAgICAgICAjIEp1bXAKICAgICAgICAgICAgICAgICAgICB3aGVuIDE0IHRoZW4gQGp1bXAoY29tbWFuZC5zdGVwc1ggKiBAbWFwLnRpbGVTaXplLCBjb21tYW5kLnN0ZXBzWSAqIEBtYXAudGlsZVNpemUpCiAgICAgICAgICAgICAgICAgICAgIyBUdXJuIERvd24KICAgICAgICAgICAgICAgICAgICB3aGVuIDE1IHRoZW4gQGRpcmVjdGlvbiA9IDIKICAgICAgICAgICAgICAgICAgICAjIFR1cm4gTGVmdAogICAgICAgICAgICAgICAgICAgIHdoZW4gMTYgdGhlbiBAZGlyZWN0aW9uID0gNAogICAgICAgICAgICAgICAgICAgICMgVHVybiBVcAogICAgICAgICAgICAgICAgICAgIHdoZW4gMTcgdGhlbiBAZGlyZWN0aW9uID0gNgogICAgICAgICAgICAgICAgICAgICMgVHVybiBSaWdodAogICAgICAgICAgICAgICAgICAgIHdoZW4gMTggdGhlbiBAZGlyZWN0aW9uID0gOAogICAgICAgICAgICAgICAgICAgICMgVHVybiA5MLAgTGVmdAogICAgICAgICAgICAgICAgICAgIHdoZW4gMTkgdGhlbiBAZGlyZWN0aW9uID0gQGRpcmVjdGlvbnNbKEBkaXJlY3Rpb25zLmluZGV4T2YoQGRpcmVjdGlvbikgLSAxKSAlIDRdCiAgICAgICAgICAgICAgICAgICAgIyBUdXJuIDkwsCBSaWdodAogICAgICAgICAgICAgICAgICAgIHdoZW4gMjAgdGhlbiBAZGlyZWN0aW9uID0gQGRpcmVjdGlvbnNbKEBkaXJlY3Rpb25zLmluZGV4T2YoQGRpcmVjdGlvbikgKyAxKSAlIDRdCiAgICAgICAgICAgICAgICAgICAgIyBUdXJuIDkwsCBMZWZ0IG9yIFJpZ2h0CiAgICAgICAgICAgICAgICAgICAgd2hlbiAyMSB0aGVuIEBkaXJlY3Rpb24gPSBAZGlyZWN0aW9uc1soQGRpcmVjdGlvbnMuaW5kZXhPZihAZGlyZWN0aW9uKSArICgtMSAqIE1hdGgucm91bmQoTWF0aC5yYW5kb20oKSkpKSAlIDRdCiAgICAgICAgICAgICAgICAgICAgIyBUdXJuIDE4MLAKICAgICAgICAgICAgICAgICAgICB3aGVuIDIyIHRoZW4gQGRpcmVjdGlvbiA9IEBkaXJlY3Rpb25zWyhAZGlyZWN0aW9ucy5pbmRleE9mKEBkaXJlY3Rpb24pICsgMikgJSA0XQogICAgICAgICAgICAgICAgICAgICMgVHVybiBSYW5kb20KICAgICAgICAgICAgICAgICAgICB3aGVuIDIzIHRoZW4gQGRpcmVjdGlvbiA9IEBkaXJlY3Rpb25zW01hdGgucm91bmQoTWF0aC5yYW5kb20oKSAqIDMpXQogICAgICAgICAgICAgICAgICAgICMgVHVybiB0b3dhcmQgUGxheWVyCiAgICAgICAgICAgICAgICAgICAgd2hlbiAyNCB0aGVuIEBkaXJlY3Rpb24gPSBAZGlyZWN0aW9uVG93YXJkRXZlbnQoR2FtZU1hbmFnZXIucGxheWVyKQogICAgICAgICAgICAgICAgICAgICMgVHVybiBhd2F5IGZyb20gUGxheWVyCiAgICAgICAgICAgICAgICAgICAgd2hlbiAyNSB0aGVuIEBkaXJlY3Rpb24gPSBAZGlyZWN0aW9uQXdheUZyb21FdmVudChHYW1lTWFuYWdlci5wbGF5ZXIpCiAgICAgICAgICAgICAgICAgICAgIyBTd2l0Y2ggT04KICAgICAgICAgICAgICAgICAgICB3aGVuIDI2CiAgICAgICAgICAgICAgICAgICAgICAgIGJvb2xlYW5zID0gaWYgY29tbWFuZC5zd2l0Y2guc2NvcGUgPT0gImdsb2JhbCIgdGhlbiBHYW1lTWFuYWdlci5ib29sZWFucyBlbHNlIEBib29sZWFucwogICAgICAgICAgICAgICAgICAgICAgICBib29sZWFuc1tjb21tYW5kLnN3aXRjaC5pbmRleF0gPSB5ZXMKICAgICAgICAgICAgICAgICAgICB3aGVuIDI3CiAgICAgICAgICAgICAgICAgICAgIyBTd2l0Y2ggT0ZGCiAgICAgICAgICAgICAgICAgICAgICAgIGJvb2xlYW5zID0gaWYgY29tbWFuZC5zd2l0Y2guc2NvcGUgPT0gImdsb2JhbCIgdGhlbiBHYW1lTWFuYWdlci5ib29sZWFucyBlbHNlIEBib29sZWFucwogICAgICAgICAgICAgICAgICAgICAgICBib29sZWFuc1tjb21tYW5kLnN3aXRjaC5pbmRleF0gPSBubwogICAgICAgICAgICAgICAgICAgICMgQ2hhbmdlIFNwZWVkCiAgICAgICAgICAgICAgICAgICAgd2hlbiAyOCB0aGVuIEBtb3ZlU3BlZWQgPSBAc3BlZWRzW2NvbW1hbmQuc3BlZWRdCiAgICAgICAgICAgICAgICAgICAgIyBDaGFuZ2UgRnJlcXVlbmN5CiAgICAgICAgICAgICAgICAgICAgd2hlbiAyOSB0aGVuIEBmcmVxdWVuY3kgPSBAZnJlcXVlbmNpZXNbY29tbWFuZC5mcmVxdWVuY3ldCiAgICAgICAgICAgICAgICAgICAgIyBXYWxraW5nIEFuaW1hdGlvbiBPTgogICAgICAgICAgICAgICAgICAgIHdoZW4gMzAgdGhlbiBAd2Fsa2luZ0FuaW1hdGlvbiA9IHllcwogICAgICAgICAgICAgICAgICAgICMgV2Fsa2luZyBBbmltYXRpb24gT0ZGCiAgICAgICAgICAgICAgICAgICAgd2hlbiAzMSB0aGVuIEB3YWxraW5nQW5pbWF0aW9uID0gbm8KICAgICAgICAgICAgICAgICAgICAjIFN0ZXBwaW5nIEFuaW1hdGlvbiBPTgogICAgICAgICAgICAgICAgICAgIHdoZW4gMzIgdGhlbiBAc3RlcHBpbmdBbmltYXRpb24gPSB5ZXMKICAgICAgICAgICAgICAgICAgICAjIFN0ZXBwaW5nIEFuaW1hdGlvbiBPRkYKICAgICAgICAgICAgICAgICAgICB3aGVuIDMzIHRoZW4gQHN0ZXBwaW5nQW5pbWF0aW9uID0gbm8KICAgICAgICAgICAgICAgICAgICAjIERpcmVjdGlvbiBGaXggT04KICAgICAgICAgICAgICAgICAgICB3aGVuIDM0IHRoZW4gQGRpcmVjdGlvbkZpeCA9IHllcwogICAgICAgICAgICAgICAgICAgICMgRGlyZWN0aW9uIEZpeCBPRkYKICAgICAgICAgICAgICAgICAgICB3aGVuIDM1IHRoZW4gQGRpcmVjdGlvbkZpeCA9IG5vCiAgICAgICAgICAgICAgICAgICAgIyBUaHJvdWdoIE9OCiAgICAgICAgICAgICAgICAgICAgd2hlbiAzNiB0aGVuIEB0aHJvdWdoID0geWVzCiAgICAgICAgICAgICAgICAgICAgIyBUaHJvdWdoIE9GRgogICAgICAgICAgICAgICAgICAgIHdoZW4gMzcgdGhlbiBAdGhyb3VnaCA9IG5vCiAgICAgICAgICAgICAgICAgICAgIyBUcmFuc3BhcmVudCBPTgogICAgICAgICAgICAgICAgICAgIHdoZW4gMzggdGhlbiBAb3BhY2l0eSA9IDEyOAogICAgICAgICAgICAgICAgICAgICMgVHJhbnNwYXJlbnQgT0ZGCiAgICAgICAgICAgICAgICAgICAgd2hlbiAzOSB0aGVuIEBvcGFjaXR5ID0gMjU1CiAgICAgICAgICAgICAgICAgICAgIyBNb3Rpb24tQmx1ciBPTgogICAgICAgICAgICAgICAgICAgIHdoZW4gNDAgdGhlbiBAbW90aW9uQmx1ciA9IHllcwogICAgICAgICAgICAgICAgICAgICMgTW90aW9uLUJsdXIgT0ZGCiAgICAgICAgICAgICAgICAgICAgd2hlbiA0MSB0aGVuIEBtb3Rpb25CbHVyID0gbm8KICAgICAgICAgICAgICAgICAgICAjIENoYW5nZSBNb3Rpb24tQmx1cgogICAgICAgICAgICAgICAgICAgIHdoZW4gNDIKICAgICAgICAgICAgICAgICAgICAgICAgQG1vdGlvbkJsdXJMZW5ndGggPSBjb21tYW5kLnNoYWRvd0NvdW50CiAgICAgICAgICAgICAgICAgICAgICAgIEBtb3Rpb25CbHVyT3BhY2l0eSA9IGNvbW1hbmQub3BhY2l0eQogICAgICAgICAgICAgICAgICAgICAgICBAbW90aW9uQmx1ckZpeGVkT3BhY2l0eSA9IGNvbW1hbmQuZml4ZWRPcGFjaXR5CiAgICAgICAgICAgICAgICAgICAgICAgIEBtb3Rpb25CbHVyQ29sb3IgPSBuZXcgQ29sb3IoY29tbWFuZC5jb2xvcikKICAgICAgICAgICAgICAgICAgICAjIEZseQogICAgICAgICAgICAgICAgICAgIHdoZW4gNDMgdGhlbiBAZmx5KGNvbW1hbmQuYWx0aXR1ZGUpCiAgICAgICAgICAgICAgICAgICAgIyBDaGFuZ2UgR3JhcGhpYwogICAgICAgICAgICAgICAgICAgIHdoZW4gNDQKICAgICAgICAgICAgICAgICAgICAgICAgQGdyYXBoaWMgPSBjb21tYW5kLnJlc291cmNlCiAgICAgICAgICAgICAgICAgICAgIyBDaGFuZ2UgT3BhY2l0eQogICAgICAgICAgICAgICAgICAgIHdoZW4gNDUgdGhlbiBAb3BhY2l0eSA9IGNvbW1hbmQub3BhY2l0eQogICAgICAgICAgICAgICAgICAgICMgQ2hhbmdlIEJsZW5kaW5nCiAgICAgICAgICAgICAgICAgICAgd2hlbiA0NiB0aGVuIEBibGVuZGluZyA9IGNvbW1hbmQuYmxlbmRpbmcKICAgICAgICAgICAgICAgICAgICAjIFBsYXkgU291bmQKICAgICAgICAgICAgICAgICAgICB3aGVuIDQ3IHRoZW4gQXVkaW9NYW5hZ2VyLnBsYXlTb3VuZChjb21tYW5kLnJlc291cmNlKQogICAgICAgICAgICAgICAgICAgICMgTGFuZAogICAgICAgICAgICAgICAgICAgIHdoZW4gNDggdGhlbiBAbGFuZCgpCiAgICAgICAgICAgICAgICAgICAgIyBDaGFuZ2UgVG9uZQogICAgICAgICAgICAgICAgICAgIHdoZW4gNDkgdGhlbiBAdG9uZSA9IG5ldyBUb25lKGNvbW1hbmQudG9uZS5yZWQsIGNvbW1hbmQudG9uZS5ncmVlbiwgY29tbWFuZC50b25lLmJsdWUsIGNvbW1hbmQudG9uZS5ncmV5KQogICAgICAgICAgICAgICAgICAgICMgU2NyaXB0CiAgICAgICAgICAgICAgICAgICAgd2hlbiA1MCB0aGVuIGV2YWwoY29tbWFuZC5zY3JpcHQpICMgRklYTUU6IFNob3VsZCBiZSBjb21waWxlZCBpbnRvIGEgZnVuY3Rpb24uIAogICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaWYgbW92ZWQgb3IgQHJvdXRlLnNraXAKICAgICAgICAgICAgICAgICAgICBAcm91dGVQb2ludGVyKysKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgIAogICAgZGlyZWN0aW9uVG93YXJkRXZlbnQ6IChldmVudCkgLT4KICAgICAgICBkeCA9IEB4IC0gZXZlbnQueAogICAgICAgIGR5ID0gQHkgLSBldmVudC55CiAgICAgICAgcmVzdWx0ID0gMAogICAgICAgIGlmIE1hdGguYWJzKGR4KSA8IE1hdGguYWJzKGR5KQogICAgICAgICAgICBpZiBkeSA+IDAgdGhlbiByZXN1bHQgPSA2CiAgICAgICAgICAgIGlmIGR5IDwgMCB0aGVuIHJlc3VsdCA9IDIKICAgICAgICBpZiBNYXRoLmFicyhkeCkgPj0gTWF0aC5hYnMoZHkpCiAgICAgICAgICAgIGlmIGR4ID4gMCB0aGVuIHJlc3VsdCA9IDQKICAgICAgICAgICAgaWYgZHggPCAwIHRoZW4gcmVzdWx0ID0gOAogICAgICAgIAogICAgICAgIHJldHVybiByZXN1bHQKICAgICAgICAKICAgIGRpcmVjdGlvbkF3YXlGcm9tRXZlbnQ6IChldmVudCkgLT4KICAgICAgICBkeCA9IEB4IC0gZXZlbnQueAogICAgICAgIGR5ID0gQHkgLSBldmVudC55CiAgICAgICAgcmVzdWx0ID0gMAogICAgICAgIGlmIE1hdGguYWJzKGR4KSA8IE1hdGguYWJzKGR5KQogICAgICAgICAgICBpZiBkeSA+IDAgdGhlbiByZXN1bHQgPSAyCiAgICAgICAgICAgIGlmIGR5IDwgMCB0aGVuIHJlc3VsdCA9IDYKICAgICAgICBpZiBNYXRoLmFicyhkeCkgPj0gTWF0aC5hYnMoZHkpCiAgICAgICAgICAgIGlmIGR4ID4gMCB0aGVuIHJlc3VsdCA9IDgKICAgICAgICAgICAgaWYgZHggPCAwIHRoZW4gcmVzdWx0ID0gNCAKICAgICAgICAgICAgCiAgICAgICAgcmV0dXJuIHJlc3VsdAogICAgICAgICAgICAKICAgIGN1cnJlbnRQb3NpdGlvbkluZGV4OiAtPgogICAgICAgIHR4ID0gTWF0aC5mbG9vcihAeCAvIEBtYXAudGlsZVNpemUpCiAgICAgICAgdHkgPSBNYXRoLmZsb29yKEB5IC8gQG1hcC50aWxlU2l6ZSkKICAgICAgICAKICAgICAgICByZXR1cm4gdHkgKiBAbWFwLndpZHRoICsgdHgKICAgICAgICAKICAgIG5leHRQb3NpdGlvbkluZGV4OiAoZGlyZWN0aW9uLCBhbGxvd0NvdW50ZXJGbGFncykgLT4KICAgICAgICB0eCA9IE1hdGguZmxvb3IoQHggLyBAbWFwLnRpbGVTaXplKQogICAgICAgIHR5ID0gTWF0aC5mbG9vcihAeSAvIEBtYXAudGlsZVNpemUpCiAgICAgICAgcG9zaXRpb24gPSBudWxsCiAgICAgICAgbG9vcEggPSBAbWFwTG9naWMubG9vcFR5cGUgPj0gMgogICAgICAgIGxvb3BWID0gQG1hcExvZ2ljLmxvb3BUeXBlID09IDEgb3IgQG1hcExvZ2ljLmxvb3BUeXBlID09IDMKICAgICAgICAgICAgCiAgICAgICAgbG9vcAogICAgICAgICAgICBzd2l0Y2ggZGlyZWN0aW9uCiAgICAgICAgICAgICAgICB3aGVuIDIgdGhlbiB0eSA9IChpZiBsb29wViB0aGVuIChpZiB0eSA9PSBAbWFwLmhlaWdodC0xIHRoZW4gMCBlbHNlIHR5KzEpIGVsc2UgIE1hdGgubWluKHR5KzEsIEBtYXAuaGVpZ2h0LTEpKQogICAgICAgICAgICAgICAgd2hlbiA0IHRoZW4gdHggPSAoaWYgbG9vcEggdGhlbiAoaWYgdHggPT0gMCB0aGVuIEBtYXAud2lkdGgtMSBlbHNlIHR4LTEpIGVsc2UgTWF0aC5tYXgodHgtMSwgMCkpCiAgICAgICAgICAgICAgICB3aGVuIDYgdGhlbiB0eSA9IChpZiBsb29wViB0aGVuIChpZiB0eSA9PSAwIHRoZW4gQG1hcC5oZWlnaHQtMSBlbHNlIHR5LTEpIGVsc2UgTWF0aC5tYXgodHktMSwgMCkpCiAgICAgICAgICAgICAgICB3aGVuIDggdGhlbiB0eCA9IChpZiBsb29wSCB0aGVuIChpZiB0eCA9PSBAbWFwLndpZHRoLTEgdGhlbiAwIGVsc2UgdHgrMSkgZWxzZSBNYXRoLm1pbih0eCsxLCBAbWFwLndpZHRoLTEpKQoKICAgICAgICAgICAgcG9zaXRpb24gPSB0eSAqIEBtYXAud2lkdGggKyB0eCAgICAgICAgCiAgICAgICAgICAgIGJyZWFrIGlmIG5vdCBhbGxvd0NvdW50ZXJGbGFncyBvciBub3QgQGNoZWNrQ291bnRlckZsYWcocG9zaXRpb24pCiAgICAgICAgCiAgICAgICAgcmV0dXJuIHBvc2l0aW9uCiAgICBmbHk6IChhbHRpdHVkZSkgLT4KICAgICAgICBAaXNGbHlpbmcgPSB5ZXMKICAgICAgICBAaXNTb2FyaW5nID0geWVzCiAgICAgICAgQGFuaW1hdGlvbkNvdW50ZXIgPSBhbHRpdHVkZSAqIEBtYXAudGlsZVNpemUKICAgICAgICBAYWx0aXR1ZGUgPSBhbHRpdHVkZQogICAgICAgIAogICAgbGFuZDogLT4KICAgICAgICBAaXNGbHlpbmcgPSBubwogICAgICAgIEBpc1NvYXJpbmcgPSBubwogICAgICAgIEBpc0xhbmRpbmcgPSB5ZXMKICAgICAgICBAYW5pbWF0aW9uQ291bnRlciA9IEBhbHRpdHVkZSAqIEBtYXAudGlsZVNpemUKICAgICAgICBAYWx0aXR1ZGUgPSAwCiAgICAgICAgCiAgICB0eDogLT4gTWF0aC5mbG9vcihAeCAvIEBtYXAudGlsZVNpemUpCiAgICB0eTogLT4gTWF0aC5mbG9vcihAeSAvIEBtYXAudGlsZVNpemUpCiAgICAgICAgCiAgICBzZXRUaWxlTG9jYXRpb246ICh4LCB5KSAtPgogICAgICAgIHggPSBNYXRoLm1heChNYXRoLm1pbih4LCBAbWFwLndpZHRoLTEpLCAwKQogICAgICAgIHkgPSBNYXRoLm1heChNYXRoLm1pbih5LCBAbWFwLmhlaWdodC0xKSwgMCkKICAgICAgICAKICAgICAgICB0eCA9IE1hdGguZmxvb3IoQHggLyBAbWFwLnRpbGVTaXplKQogICAgICAgIHR5ID0gTWF0aC5mbG9vcihAeSAvIEBtYXAudGlsZVNpemUpCiAgICAKICAgICAgICBAY29sbGlzaW9uTWFwW3R5ICogQG1hcC53aWR0aCArIHR4XS5yZW1vdmUodGhpcykKICAgICAgICBAY29sbGlzaW9uTWFwW3kgKiBAbWFwLndpZHRoICsgeF0ucHVzaCh0aGlzKQogICAgICAgICAgICAKICAgICAgICBAeCA9IHggKiBAbWFwLnRpbGVTaXplCiAgICAgICAgQHkgPSB5ICogQG1hcC50aWxlU2l6ZQogICAgICAgIAogICAganVtcDogKHgsIHkpIC0+CiAgICAgICAgaWYgTWF0aC5hYnMoeCkgPCBNYXRoLmFicyh5KQogICAgICAgICAgICBpZiB5ID4gMCB0aGVuIEBkaXJlY3Rpb24gPSAyCiAgICAgICAgICAgIGlmIHkgPCAwIHRoZW4gQGRpcmVjdGlvbiA9IDYgIAogICAgICAgIGVsc2UKICAgICAgICAgICAgaWYgeCA+IDAgdGhlbiBAZGlyZWN0aW9uID0gOAogICAgICAgICAgICBpZiB4IDwgMCB0aGVuIEBkaXJlY3Rpb24gPSA0CiAgICAgICAgICAgIAogICAgICAgIEBpc0p1bXBpbmcgPSB5ZXMKICAgICAgICAKICAgICAgICBkaXN0YW5jZSA9IE1hdGgucm91bmQoTWF0aC5zcXJ0KHggKiB4ICsgeSAqIHkpKQogICAgICAgIEBzaGFkb3dZID0gQHkKICAgICAgICBAanVtcFggPSBAeCArIHgKICAgICAgICBAanVtcFkgPSBAeSArIHkKICAgICAgICBAanVtcFBlYWsgPSAxMDAgKyBkaXN0YW5jZQogICAgICAgIEBqdW1wQ291bnRlciA9IE1hdGgucm91bmQoQGp1bXBQZWFrIC8gKEBtb3ZlU3BlZWQqMykpCiAgICAgICAgQGp1bXBDb3VudGVySGFsZiA9IE1hdGgucm91bmQoQGp1bXBDb3VudGVyIC8gMikKICAgICAgICBAanVtcFZhbHVlID0gTWF0aC5yb3VuZChAanVtcFBlYWsgLyBAanVtcENvdW50ZXJIYWxmKQogICAgICAgIEBqdW1wSGVpZ2h0ID0gMAogICAgbW92ZTogKGRpcmVjdGlvbikgLT4KICAgICAgICBpZiBub3QgQGlzTW92aW5nIGFuZCBub3QgQGlzTG9ja2VkCiAgICAgICAgICAgIEBpc01vdmluZyA9IHllcwogICAgICAgICAgICBAZGlyZWN0aW9uID0gZGlyZWN0aW9uCiAgICAgICAgICAgIAogICAgICAgICAgICB0eCA9IE1hdGguZmxvb3IoQHggLyBAbWFwLnRpbGVTaXplKQogICAgICAgICAgICB0eSA9IE1hdGguZmxvb3IoQHkgLyBAbWFwLnRpbGVTaXplKQogICAgICAgICAgICBwb3NpdGlvbiA9IEBuZXh0UG9zaXRpb25JbmRleChkaXJlY3Rpb24pCiAgICAgICAgICAgIAogICAgICAgICAgICBAY2hlY2tCdXNoRmxhZyhwb3NpdGlvbikKICAgCiAgICAgICAgICAgIEBjb2xsaXNpb25NYXBbdHkgKiBAbWFwLndpZHRoICsgdHhdLnJlbW92ZSh0aGlzKQogICAgICAgICAgICBAY29sbGlzaW9uTWFwW3Bvc2l0aW9uXS5wdXNoKHRoaXMpCiAgICAgICAgICAgIAogICAgICAgICAgICByZXR1cm4geWVzICAgCiAgICAgICAgZWxzZQogICAgICAgICAgICByZXR1cm4gbm8KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgIAogICAgbW92ZVJvdXRlOiAocm91dGUpIC0+CiAgICAgICAgQHJvdXRlID0gcm91dGUKICAgICAgICBAcm91dGVQb2ludGVyID0gMAogICAgICAgIEByb3V0ZVdhaXRDb3VudGVyID0gMAogICAgICAgICAgICAKICAgIGNhbk1vdmU6IChkaXJlY3Rpb24pIC0+CiAgICAgICAgb2Zmc2V0ID0gMAogICAgICAgIHRpbGUgPSAwCiAgICAgICAgc2l6ZSA9IDAKICAgICAgICByZXN1bHQgPSBubwogICAgICAgIHBvc2l0aW9uID0gQG5leHRQb3NpdGlvbkluZGV4KGRpcmVjdGlvbikKICAgICAgICBjdXJyZW50ID0gQGN1cnJlbnRQb3NpdGlvbkluZGV4KCkKICAgICAgICAKICAgICAgICBpZiBAdGhyb3VnaAogICAgICAgICAgICByZXN1bHQgPSBwb3NpdGlvbiA+PSAwIGFuZCBwb3NpdGlvbiA8IChAbWFwLndpZHRoICogQG1hcC5oZWlnaHQpCiAgICAgICAgZWxzZQogICAgICAgICAgICBzaXplID0gQG1hcC53aWR0aCAqIEBtYXAuaGVpZ2h0CiAgICAgICAgICAgIGZvciBpIGluIFswLi4uQG1hcC5kZXB0aF0KICAgICAgICAgICAgICAgIHRpbGUgPSBAbWFwRGF0YVtwb3NpdGlvbiArIGkgKiBzaXplXQogICAgICAgICAgICAgICAgY3VycmVudFRpbGUgPSBAbWFwRGF0YVtjdXJyZW50ICsgaSAqIHNpemVdCiAgICAgICAgICAgICAgICB0YWcgPSBAdGlsZXNldC50ZXJyYWluVGFnc1t0aWxlXQogICAgICAgICAgICAgICAgaWYgQHBhc3NhZ2VzPyBhbmQgQHBhc3NhZ2VzLmxlbmd0aCA+IDAgYW5kIHRhZyA+IDAgIyBTcGVjaWFsIFBhc3NhZ2VzIC0gSWdub3JlIFRpbGVzZXQgUGFzc2FnZXMgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIHRlcnJhaW4gPSBAdGVycmFpbnNbdGFnXQogICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IG5vCiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gaWYgdGVycmFpbj8gYW5kIEBwYXNzYWdlc1t0ZXJyYWluLmluZGV4XT8gdGhlbiBAcGFzc2FnZXNbdGVycmFpbi5pbmRleF0gPT0gMCBlbHNlIHJlc3VsdAogICAgICAgICAgICAgICAgICAgIGlmIG5vdCByZXN1bHQgdGhlbiBicmVhawogICAgICAgICAgICAgICAgZWxzZSAjIFVzZSBUaWxlc2V0IFBhc3NhZ2VzCiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gQGNoZWNrUGFzc2FnZShAdGlsZXNldC5wYXNzYWdlc1t0aWxlXSwgZGlyZWN0aW9uKQogICAgICAgICAgICAgICAgICAgIGlmIHJlc3VsdCB0aGVuIHJlc3VsdCA9IEBjaGVja1Bhc3NhZ2VSZXZlcnNlKEB0aWxlc2V0LnBhc3NhZ2VzW2N1cnJlbnRUaWxlXSwgZGlyZWN0aW9uKQogICAgICAgICAgICAgICAgICAgIGlmIG5vdCByZXN1bHQgdGhlbiBicmVhawogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICBpZiByZXN1bHQKICAgICAgICAgICAgICAgIHJlc3VsdCA9IEBjb2xsaXNpb25NYXBbcG9zaXRpb25dPyBhbmQgQGNvbGxpc2lvbk1hcFtwb3NpdGlvbl0ubGVuZ3RoID09IDAgb3IgQGNhbk1vdmVUaHJvdWdoKEBjb2xsaXNpb25NYXBbcG9zaXRpb25dKQogICAgICAgICAgICAKICAgICAgICByZXR1cm4gcmVzdWx0CiAgICAgICAgCiAgICBjYW5Nb3ZlVGhyb3VnaDogKGNoYXJhY3RlcnMpIC0+CiAgICAgICAgcmVzdWx0ID0geWVzCiAgICAgICAgCiAgICAgICAgaWYgY2hhcmFjdGVycz8gCiAgICAgICAgICAgIGZvciBjaGFyYWN0ZXIgaW4gY2hhcmFjdGVycwogICAgCiAgICAgICAgICAgICAgICBpZiBub3QgY2hhcmFjdGVyLnRocm91Z2gKICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBjaGFyYWN0ZXIubGF5ZXIgIT0gQGxheWVyCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAKICAgICAgICByZXR1cm4gcmVzdWx0CiAgICAgICAgCiAgICBjaGVja1Bhc3NhZ2U6IChwYXNzYWdlLCBkaXJlY3Rpb24pIC0+CiAgICAgICAgcmVzdWx0ID0gcGFzc2FnZSA9PSAwCiAgICAgICAgCiAgICAgICAgaWYgbm90IHJlc3VsdAogICAgICAgICAgICBzd2l0Y2ggZGlyZWN0aW9uCiAgICAgICAgICAgICAgICB3aGVuIDIgdGhlbiByZXN1bHQgPSBub3QgKHBhc3NhZ2UgJiAweDA4KQogICAgICAgICAgICAgICAgd2hlbiA0IHRoZW4gcmVzdWx0ID0gbm90IChwYXNzYWdlICYgMHgwNCkKICAgICAgICAgICAgICAgIHdoZW4gNiB0aGVuIHJlc3VsdCA9IG5vdCAocGFzc2FnZSAmIDB4MDEpCiAgICAgICAgICAgICAgICB3aGVuIDggdGhlbiByZXN1bHQgPSBub3QgKHBhc3NhZ2UgJiAweDAyKQogICAgICAgICAgICAKICAgICAgICByZXR1cm4gcmVzdWx0CiAgICAgICAgCiAgICBjaGVja1Bhc3NhZ2VSZXZlcnNlOiAocGFzc2FnZSwgZGlyZWN0aW9uKSAtPgogICAgICAgIHJlc3VsdCA9IHBhc3NhZ2UgPT0gMAogICAgICAgIAogICAgICAgIGlmIG5vdCByZXN1bHQKICAgICAgICAgICAgc3dpdGNoIGRpcmVjdGlvbgogICAgICAgICAgICAgICAgd2hlbiA2IHRoZW4gcmVzdWx0ID0gbm90IChwYXNzYWdlICYgMHgwOCkKICAgICAgICAgICAgICAgIHdoZW4gOCB0aGVuIHJlc3VsdCA9IG5vdCAocGFzc2FnZSAmIDB4MDQpCiAgICAgICAgICAgICAgICB3aGVuIDIgdGhlbiByZXN1bHQgPSBub3QgKHBhc3NhZ2UgJiAweDAxKQogICAgICAgICAgICAgICAgd2hlbiA0IHRoZW4gcmVzdWx0ID0gbm90IChwYXNzYWdlICYgMHgwMikKICAgICAgICAgICAgCiAgICAgICAgcmV0dXJuIHJlc3VsdAogICAgICAgIAogICAgY2hlY2tDb3VudGVyRmxhZzogKHBvc2l0aW9uKSAtPgogICAgICAgIHNpemUgPSBAbWFwLndpZHRoICogQG1hcC5oZWlnaHQKICAgICAgICBmb3IgaSBpbiBbMC4uLkBtYXAuZGVwdGhdCiAgICAgICAgICAgIHJlc3VsdCA9IEB0aWxlc2V0LnBhc3NhZ2VzW0BtYXBEYXRhW3Bvc2l0aW9uICsgaSAqIHNpemVdXSAmIDB4ODAKICAgICAgICAgICAgaWYgcmVzdWx0IHRoZW4gYnJlYWsKICAgICAgICAKICAgICAgICByZXR1cm4gcmVzdWx0CiAgICAgICAgCiAgICBjaGVja0J1c2hGbGFnOiAocG9zaXRpb24pIC0+CiAgICAgICAgc2l6ZSA9IEBtYXAud2lkdGggKiBAbWFwLmhlaWdodAogICAgICAgIHBvc2l0aW9uID0gaWYgcG9zaXRpb24/IHRoZW4gcG9zaXRpb24gZWxzZSBAY3VycmVudFBvc2l0aW9uSW5kZXgoKQogICAgICAgIEBidXNoRmxhZyA9IG5vCiAgICAgICAgZm9yIGkgaW4gWzAuLi5AbWFwLmRlcHRoXQogICAgICAgICAgICB0aWxlID0gQG1hcERhdGFbcG9zaXRpb24gKyBpICogc2l6ZV0KICAgICAgICAgICAgYnVzaEZsYWcgPSBAdGlsZXNldC5wYXNzYWdlc1t0aWxlXSAmIDB4NDAKICAgICAgICAgICAgaWYgYnVzaEZsYWcKICAgICAgICAgICAgICAgIEBidXNoRmxhZyA9IHllcwogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAKd2luZG93LkxvZ2ljX0NoYXJhY3RlciA9IExvZ2ljX0NoYXJhY3Rlcg==","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBMb2dpY19DaGFyYWN0ZXI7CgogIExvZ2ljX0NoYXJhY3RlciA9IChmdW5jdGlvbigpIHsKICAgIGZ1bmN0aW9uIExvZ2ljX0NoYXJhY3RlcigpIHsKICAgICAgdmFyIHM7CiAgICAgIHMgPSBXaW5kb3dfQmFzZS5zY2FsZTsKICAgICAgdGhpcy5pc01vdmluZyA9IGZhbHNlOwogICAgICB0aGlzLmlzRmx5aW5nID0gZmFsc2U7CiAgICAgIHRoaXMuaXNTb2FyaW5nID0gZmFsc2U7CiAgICAgIHRoaXMuaXNMYW5kaW5nID0gZmFsc2U7CiAgICAgIHRoaXMuaXNKdW1waW5nID0gZmFsc2U7CiAgICAgIHRoaXMuYnVzaEZsYWcgPSBmYWxzZTsKICAgICAgdGhpcy5kaXJlY3Rpb24gPSAwOwogICAgICB0aGlzLmRpcmVjdGlvbnMgPSBbMiwgNCwgNiwgOF07CiAgICAgIHRoaXMuc3BlZWRzID0gWzAuNSAqIHMsIDEgKiBzLCAyICogcywgNCAqIHMsIDggKiBzXTsKICAgICAgdGhpcy5mcmVxdWVuY2llcyA9IFswLjAzMTI1LCAwLjA2MjUsIDAuMTI1LCAwLjI1LCAwLjVdOwogICAgICB0aGlzLm1vdmVSb3V0ZUZyZXF1ZW5jaWVzID0gWzI0MCwgMTIwLCA2MCwgMzAsIDBdOwogICAgICB0aGlzLm1vdmVTcGVlZCA9IHRoaXMuc3BlZWRzWzJdOwogICAgICB0aGlzLmZyZXF1ZW5jeSA9IHRoaXMuZnJlcXVlbmNpZXNbMl07CiAgICAgIHRoaXMubW92ZVJvdXRlRnJlcXVlbmN5ID0gdGhpcy5tb3ZlUm91dGVGcmVxdWVuY2llc1syXTsKICAgICAgdGhpcy54ID0gMDsKICAgICAgdGhpcy55ID0gMzI7CiAgICAgIHRoaXMucGF0dGVybiA9IDA7CiAgICAgIHRoaXMuc3ViUGF0dGVybiA9IDA7CiAgICAgIHRoaXMuY3VycmVudFN1YlBhdHRlcm4gPSAwOwogICAgICB0aGlzLm1vdmVTdGVwcyA9IDA7CiAgICAgIHRoaXMucGF0dGVybkNvdW50ID0gMDsKICAgICAgdGhpcy5sYXN0UGF0dGVybkNvdW50ID0gMDsKICAgICAgdGhpcy5tYXBEYXRhID0gbnVsbDsKICAgICAgdGhpcy5tYXAgPSBudWxsOwogICAgICB0aGlzLnRpbGVzZXQgPSBudWxsOwogICAgICB0aGlzLnRlcnJhaW5UYWcgPSAwOwogICAgICB0aGlzLnJvdXRlID0gbnVsbDsKICAgICAgdGhpcy5yb3V0ZVBvaW50ZXIgPSAwOwogICAgICB0aGlzLnJvdXRlV2FpdENvdW50ZXIgPSAwOwogICAgICB0aGlzLnByZWRlZmluZWRSb3V0ZXMgPSBbCiAgICAgICAgewogICAgICAgICAgY29tbWFuZHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIGlkOiA4CiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICByZXBlYXQ6IHRydWUsCiAgICAgICAgICBza2lwOiB0cnVlCiAgICAgICAgfSwgewogICAgICAgICAgY29tbWFuZHM6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgIGlkOiA5CiAgICAgICAgICAgIH0KICAgICAgICAgIF0sCiAgICAgICAgICByZXBlYXQ6IHRydWUsCiAgICAgICAgICBza2lwOiB0cnVlCiAgICAgICAgfQogICAgICBdOwogICAgICB0aGlzLmNvbGxpc2lvbk1hcCA9IG51bGw7CiAgICAgIHRoaXMuYWx0aXR1ZGUgPSAwOwogICAgICB0aGlzLmFuaW1hdGlvbkNvdW50ZXIgPSAwOwogICAgICB0aGlzLndhbGtpbmdBbmltYXRpb24gPSB0cnVlOwogICAgICB0aGlzLnN0ZXBwaW5nQW5pbWF0aW9uID0gZmFsc2U7CiAgICAgIHRoaXMudGhyb3VnaCA9IGZhbHNlOwogICAgICB0aGlzLmRpcmVjdGlvbkZpeCA9IGZhbHNlOwogICAgICB0aGlzLmdyYXBoaWMgPSBudWxsOwogICAgICB0aGlzLm9wYWNpdHkgPSAyNTU7CiAgICAgIHRoaXMuYmxlbmRpbmcgPSAwOwogICAgICB0aGlzLnRvbmUgPSBuZXcgVG9uZSgwLCAwLCAwLCAwKTsKICAgICAgdGhpcy52aXNpYmxlID0gdHJ1ZTsKICAgICAgdGhpcy5tb3Rpb25CbHVyID0gZmFsc2U7CiAgICAgIHRoaXMubW90aW9uQmx1ckxlbmd0aCA9IDM7CiAgICAgIHRoaXMubW90aW9uQmx1ck9wYWNpdHkgPSAxMDA7CiAgICAgIHRoaXMubW90aW9uQmx1ckZpeGVkT3BhY2l0eSA9IGZhbHNlOwogICAgICB0aGlzLm1vdGlvbkJsdXJDb2xvciA9IENvbG9yLlRSQU5TUEFSRU5UOwogICAgICB0aGlzLnBhc3NhZ2VzID0gbnVsbDsKICAgICAgdGhpcy5pc0xvY2tlZCA9IGZhbHNlOwogICAgfQoKICAgIExvZ2ljX0NoYXJhY3Rlci5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBoZWlnaHQsIHdpZHRoOwogICAgICB0aGlzLnVwZGF0ZVJvdXRlKCk7CiAgICAgIHRoaXMudXBkYXRlUGF0dGVybigpOwogICAgICB0aGlzLnVwZGF0ZU1vdmUoKTsKICAgICAgdGhpcy51cGRhdGVTb2FyaW5nKCk7CiAgICAgIHRoaXMudXBkYXRlTGFuZGluZygpOwogICAgICB0aGlzLnVwZGF0ZUp1bXAoKTsKICAgICAgd2lkdGggPSB0aGlzLm1hcC53aWR0aCAqIHRoaXMubWFwLnRpbGVTaXplOwogICAgICBoZWlnaHQgPSB0aGlzLm1hcC5oZWlnaHQgKiB0aGlzLm1hcC50aWxlU2l6ZTsKICAgICAgaWYgKHRoaXMubWFwLmxvb3BUeXBlID09PSAyIHx8IHRoaXMubWFwLmxvb3BUeXBlID09PSAzKSB7CiAgICAgICAgdGhpcy54ID0gdGhpcy54IDwgMCA/IHRoaXMueCArIHdpZHRoIDogdGhpcy54OwogICAgICAgIHRoaXMueCA9IHRoaXMueCA+PSB3aWR0aCA/IHRoaXMueCAtIHdpZHRoIDogdGhpcy54OwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMueCA9IE1hdGgubWluKE1hdGgubWF4KHRoaXMueCwgMCksIHdpZHRoIC0gdGhpcy5tYXAudGlsZVNpemUpOwogICAgICB9CiAgICAgIGlmICh0aGlzLm1hcC5sb29wVHlwZSA9PT0gMSB8fCB0aGlzLm1hcC5sb29wVHlwZSA9PT0gMykgewogICAgICAgIHRoaXMueSA9IHRoaXMueSA8IDAgPyB0aGlzLnkgKyBoZWlnaHQgOiB0aGlzLnk7CiAgICAgICAgcmV0dXJuIHRoaXMueSA9IHRoaXMueSA+PSBoZWlnaHQgPyB0aGlzLnkgLSBoZWlnaHQgOiB0aGlzLnk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIHRoaXMueSA9IE1hdGgubWluKE1hdGgubWF4KHRoaXMueSwgMCksIGhlaWdodCAtIHRoaXMubWFwLnRpbGVTaXplKTsKICAgICAgfQogICAgfTsKCiAgICBMb2dpY19DaGFyYWN0ZXIucHJvdG90eXBlLnVwZGF0ZVNvYXJpbmcgPSBmdW5jdGlvbigpIHsKICAgICAgaWYgKHRoaXMuaXNTb2FyaW5nKSB7CiAgICAgICAgdGhpcy55IC09IHRoaXMubW92ZVNwZWVkOwogICAgICAgIHRoaXMuYW5pbWF0aW9uQ291bnRlciAtPSB0aGlzLm1vdmVTcGVlZDsKICAgICAgICByZXR1cm4gdGhpcy5pc1NvYXJpbmcgPSB0aGlzLmFuaW1hdGlvbkNvdW50ZXIgPiAwOwogICAgICB9CiAgICB9OwoKICAgIExvZ2ljX0NoYXJhY3Rlci5wcm90b3R5cGUudXBkYXRlTGFuZGluZyA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgdHgsIHR5OwogICAgICBpZiAodGhpcy5pc0xhbmRpbmcpIHsKICAgICAgICB0aGlzLnkgKz0gdGhpcy5tb3ZlU3BlZWQ7CiAgICAgICAgdGhpcy5hbmltYXRpb25Db3VudGVyIC09IHRoaXMubW92ZVNwZWVkOwogICAgICAgIHRoaXMuaXNMYW5kaW5nID0gdGhpcy5hbmltYXRpb25Db3VudGVyID4gMDsKICAgICAgICBpZiAoIXRoaXMuaXNMYW5kaW5nKSB7CiAgICAgICAgICB0eCA9IHRoaXMudHgoKTsKICAgICAgICAgIHR5ID0gdGhpcy50eSgpOwogICAgICAgICAgdGhpcy5jb2xsaXNpb25NYXBbKHR5IC0gMSkgKiB0aGlzLm1hcC53aWR0aCArIHR4XS5yZW1vdmUodGhpcyk7CiAgICAgICAgICByZXR1cm4gdGhpcy5jb2xsaXNpb25NYXBbdHkgKiB0aGlzLm1hcC53aWR0aCArIHR4XS5wdXNoKHRoaXMpOwogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICBMb2dpY19DaGFyYWN0ZXIucHJvdG90eXBlLnVwZGF0ZUZseSA9IGZ1bmN0aW9uKCkge307CgogICAgTG9naWNfQ2hhcmFjdGVyLnByb3RvdHlwZS51cGRhdGVKdW1wID0gZnVuY3Rpb24oKSB7CiAgICAgIGlmICh0aGlzLmlzSnVtcGluZykgewogICAgICAgIHRoaXMuanVtcENvdW50ZXItLTsKICAgICAgICB0aGlzLnggPSAodGhpcy54ICogdGhpcy5qdW1wQ291bnRlciArIHRoaXMuanVtcFgpIC8gKHRoaXMuanVtcENvdW50ZXIgKyAxKTsKICAgICAgICB0aGlzLnNoYWRvd1kgPSAodGhpcy5zaGFkb3dZICogdGhpcy5qdW1wQ291bnRlciArIHRoaXMuanVtcFkpIC8gKHRoaXMuanVtcENvdW50ZXIgKyAxKTsKICAgICAgICBpZiAodGhpcy5qdW1wQ291bnRlciA+PSB0aGlzLmp1bXBDb3VudGVySGFsZikgewogICAgICAgICAgdGhpcy5qdW1wSGVpZ2h0ICs9IE1hdGgucm91bmQodGhpcy5qdW1wVmFsdWUgKiAoKHRoaXMuanVtcENvdW50ZXIgLSB0aGlzLmp1bXBDb3VudGVySGFsZikgLyB0aGlzLmp1bXBDb3VudGVySGFsZikpOwogICAgICAgICAgdGhpcy55ID0gdGhpcy5zaGFkb3dZIC0gdGhpcy5qdW1wSGVpZ2h0OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLmp1bXBIZWlnaHQgPSBNYXRoLm1heCh0aGlzLmp1bXBIZWlnaHQgLSBNYXRoLnJvdW5kKHRoaXMuanVtcFZhbHVlICogKCh0aGlzLmp1bXBDb3VudGVySGFsZiAtIHRoaXMuanVtcENvdW50ZXIpIC8gdGhpcy5qdW1wQ291bnRlckhhbGYpKSwgMCk7CiAgICAgICAgICB0aGlzLnkgPSB0aGlzLnNoYWRvd1kgLSB0aGlzLmp1bXBIZWlnaHQ7CiAgICAgICAgfQogICAgICAgIGlmICh0aGlzLmlzSnVtcGluZyAmJiB0aGlzLmp1bXBDb3VudGVyID09PSAwKSB7CiAgICAgICAgICB0aGlzLmlzSnVtcGluZyA9IGZhbHNlOwogICAgICAgICAgdGhpcy54ID0gTWF0aC5yb3VuZCh0aGlzLnggLyB0aGlzLm1hcC50aWxlU2l6ZSkgKiB0aGlzLm1hcC50aWxlU2l6ZTsKICAgICAgICAgIHJldHVybiB0aGlzLnkgPSBNYXRoLnJvdW5kKHRoaXMubWFwLnRpbGVTaXplKSAqIHRoaXMubWFwLnRpbGVTaXplOwogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICBMb2dpY19DaGFyYWN0ZXIucHJvdG90eXBlLnVwZGF0ZU1vdmUgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIHA7CiAgICAgIGlmICh0aGlzLmlzTW92aW5nKSB7CiAgICAgICAgdGhpcy5tb3ZlU3RlcHMgKz0gdGhpcy5tb3ZlU3BlZWQ7CiAgICAgICAgc3dpdGNoICh0aGlzLmRpcmVjdGlvbikgewogICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICB0aGlzLnkgKz0gdGhpcy5tb3ZlU3BlZWQ7CiAgICAgICAgICAgIGlmICh0aGlzLm1vdmVTdGVwcyA+PSB0aGlzLm1hcC50aWxlU2l6ZSkgewogICAgICAgICAgICAgIHRoaXMueSAtPSB0aGlzLm1vdmVTdGVwcyAtIHRoaXMubWFwLnRpbGVTaXplOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICB0aGlzLnggLT0gdGhpcy5tb3ZlU3BlZWQ7CiAgICAgICAgICAgIGlmICh0aGlzLm1vdmVTdGVwcyA+PSB0aGlzLm1hcC50aWxlU2l6ZSkgewogICAgICAgICAgICAgIHRoaXMueCArPSB0aGlzLm1vdmVTdGVwcyAtIHRoaXMubWFwLnRpbGVTaXplOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICB0aGlzLnkgLT0gdGhpcy5tb3ZlU3BlZWQ7CiAgICAgICAgICAgIGlmICh0aGlzLm1vdmVTdGVwcyA+PSB0aGlzLm1hcC50aWxlU2l6ZSkgewogICAgICAgICAgICAgIHRoaXMueSArPSB0aGlzLm1vdmVTdGVwcyAtIHRoaXMubWFwLnRpbGVTaXplOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICB0aGlzLnggKz0gdGhpcy5tb3ZlU3BlZWQ7CiAgICAgICAgICAgIGlmICh0aGlzLm1vdmVTdGVwcyA+PSB0aGlzLm1hcC50aWxlU2l6ZSkgewogICAgICAgICAgICAgIHRoaXMueCAtPSB0aGlzLm1vdmVTdGVwcyAtIHRoaXMubWFwLnRpbGVTaXplOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmICh0aGlzLm1vdmVTdGVwcyA+PSB0aGlzLm1hcC50aWxlU2l6ZSkgewogICAgICAgICAgdGhpcy5tb3ZlU3RlcHMgPSAwOwogICAgICAgICAgdGhpcy5pc01vdmluZyA9IGZhbHNlOwogICAgICAgICAgcmV0dXJuIHRoaXMub25Nb3ZlRmluaXNoKCk7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKCF0aGlzLnN0ZXBwaW5nQW5pbWF0aW9uKSB7CiAgICAgICAgcCA9IE1hdGguZmxvb3IodGhpcy5sYXN0UGF0dGVybkNvdW50ICogdGhpcy5mcmVxdWVuY3kpICUgNDsKICAgICAgICBpZiAocCA9PT0gMCB8fCBwID09PSAzKSB7CiAgICAgICAgICByZXR1cm4gdGhpcy5wYXR0ZXJuQ291bnQgPSBNYXRoLmZsb29yKDEgLyB0aGlzLmZyZXF1ZW5jeSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVybiB0aGlzLnBhdHRlcm5Db3VudCA9IE1hdGguZmxvb3IoMyAvIHRoaXMuZnJlcXVlbmN5KTsKICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgTG9naWNfQ2hhcmFjdGVyLnByb3RvdHlwZS5vbk1vdmVGaW5pc2ggPSBmdW5jdGlvbigpIHt9OwoKICAgIExvZ2ljX0NoYXJhY3Rlci5wcm90b3R5cGUuc3ViUGF0dGVybkNvbHVtbiA9IGZ1bmN0aW9uKCkgewogICAgICBpZiAodGhpcy53YWxraW5nQW5pbWF0aW9uKSB7CiAgICAgICAgcmV0dXJuIDA7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIHRoaXMuc3ViUGF0dGVybiAlIDQ7CiAgICAgIH0KICAgIH07CgogICAgTG9naWNfQ2hhcmFjdGVyLnByb3RvdHlwZS51cGRhdGVQYXR0ZXJuID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBjb2x1bW4sIGRpcmVjdGlvbiwgbW92aW5nOwogICAgICBtb3ZpbmcgPSAodGhpcy5pc01vdmluZyAmJiB0aGlzLndhbGtpbmdBbmltYXRpb24pIHx8IHRoaXMuc3RlcHBpbmdBbmltYXRpb247CiAgICAgIGRpcmVjdGlvbiA9IHRoaXMuZGlyZWN0aW9uRml4ZWQgJiYgbW92aW5nID8gdGhpcy5kaXJlY3Rpb25zWyhNYXRoLmZsb29yKHRoaXMuc3ViUGF0dGVybiAvIDQpICsgMikgJSA0XSA6IHRoaXMuZGlyZWN0aW9uOwogICAgICBjb2x1bW4gPSB0aGlzLnN1YlBhdHRlcm5Db2x1bW4oKTsKICAgICAgc3dpdGNoIChkaXJlY3Rpb24pIHsKICAgICAgICBjYXNlIDI6CiAgICAgICAgICB0aGlzLnN1YlBhdHRlcm4gPSBtb3ZpbmcgPyAwICsgKE1hdGguZmxvb3IodGhpcy5wYXR0ZXJuQ291bnQgKiB0aGlzLmZyZXF1ZW5jeSkgJSA0KSA6IGNvbHVtbjsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgNDoKICAgICAgICAgIHRoaXMuc3ViUGF0dGVybiA9IG1vdmluZyA/IDQgKyAoTWF0aC5mbG9vcih0aGlzLnBhdHRlcm5Db3VudCAqIHRoaXMuZnJlcXVlbmN5KSAlIDQpIDogY29sdW1uICsgNDsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgNjoKICAgICAgICAgIHRoaXMuc3ViUGF0dGVybiA9IG1vdmluZyA/IDEyICsgKE1hdGguZmxvb3IodGhpcy5wYXR0ZXJuQ291bnQgKiB0aGlzLmZyZXF1ZW5jeSkgJSA0KSA6IGNvbHVtbiArIDEyOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSA4OgogICAgICAgICAgdGhpcy5zdWJQYXR0ZXJuID0gbW92aW5nID8gOCArIChNYXRoLmZsb29yKHRoaXMucGF0dGVybkNvdW50ICogdGhpcy5mcmVxdWVuY3kpICUgNCkgOiBjb2x1bW4gKyA4OwogICAgICB9CiAgICAgIGlmIChtb3ZpbmcpIHsKICAgICAgICB0aGlzLmxhc3RQYXR0ZXJuQ291bnQgPSB0aGlzLnBhdHRlcm5Db3VudDsKICAgICAgICByZXR1cm4gdGhpcy5wYXR0ZXJuQ291bnQrKzsKICAgICAgfQogICAgfTsKCiAgICBMb2dpY19DaGFyYWN0ZXIucHJvdG90eXBlLnVwZGF0ZVJvdXRlID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBib29sZWFucywgY29tbWFuZCwgZHgsIGR5LCBtb3ZlZCwgcGxheWVyLCBfcmVzdWx0czsKICAgICAgY29tbWFuZCA9IG51bGw7CiAgICAgIG1vdmVkID0gdHJ1ZTsKICAgICAgaWYgKCh0aGlzLnJvdXRlICE9IG51bGwpICYmICF0aGlzLmlzTW92aW5nICYmICF0aGlzLmlzSnVtcGluZykgewogICAgICAgIGlmICh0aGlzLnJvdXRlV2FpdENvdW50ZXIgPiAwKSB7CiAgICAgICAgICB0aGlzLnJvdXRlV2FpdENvdW50ZXItLTsKICAgICAgICB9CiAgICAgICAgX3Jlc3VsdHMgPSBbXTsKICAgICAgICB3aGlsZSAobW92ZWQgJiYgIXRoaXMuaXNNb3ZpbmcgJiYgIXRoaXMuaXNTb2FyaW5nICYmICF0aGlzLmlzTGFuZGluZyAmJiAhdGhpcy5pc0p1bXBpbmcgJiYgKHRoaXMucm91dGVXYWl0Q291bnRlciA9PT0gMCkgJiYgKHRoaXMucm91dGUgIT0gbnVsbCkpIHsKICAgICAgICAgIGlmICh0aGlzLnJvdXRlUG9pbnRlciA+PSB0aGlzLnJvdXRlLmNvbW1hbmRzLmxlbmd0aCAmJiB0aGlzLnJvdXRlV2FpdENvdW50ZXIgPD0gMCkgewogICAgICAgICAgICB0aGlzLnJvdXRlUG9pbnRlciA9IDA7CiAgICAgICAgICAgIGlmICghdGhpcy5yb3V0ZS5yZXBlYXQpIHsKICAgICAgICAgICAgICB0aGlzLnJvdXRlID0gbnVsbDsKICAgICAgICAgICAgICBpZiAodGhpcy5vblJvdXRlRmluaXNoICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIHRoaXMub25Sb3V0ZUZpbmlzaCgpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgY29tbWFuZCA9IHRoaXMucm91dGUuY29tbWFuZHNbdGhpcy5yb3V0ZVBvaW50ZXJdOwogICAgICAgICAgc3dpdGNoIChjb21tYW5kLmlkKSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBtb3ZlZCA9IHRoaXMubW92ZSgyKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgIG1vdmVkID0gdGhpcy5tb3ZlKDQpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgbW92ZWQgPSB0aGlzLm1vdmUoNik7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICBtb3ZlZCA9IHRoaXMubW92ZSg4KTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgIHRoaXMucm91dGUuY29tbWFuZHMuc3BsaWNlKHRoaXMucm91dGVQb2ludGVyLCAxLCB7CiAgICAgICAgICAgICAgICBpZDogMAogICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIGlkOiAxCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgdGhpcy5yb3V0ZVBvaW50ZXItLTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgIHRoaXMucm91dGUuY29tbWFuZHMuc3BsaWNlKHRoaXMucm91dGVQb2ludGVyLCAxLCB7CiAgICAgICAgICAgICAgICBpZDogMAogICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIGlkOiAzCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgdGhpcy5yb3V0ZVBvaW50ZXItLTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgIHRoaXMucm91dGUuY29tbWFuZHMuc3BsaWNlKHRoaXMucm91dGVQb2ludGVyLCAxLCB7CiAgICAgICAgICAgICAgICBpZDogMgogICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIGlkOiAxCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgdGhpcy5yb3V0ZVBvaW50ZXItLTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgIHRoaXMucm91dGUuY29tbWFuZHMuc3BsaWNlKHRoaXMucm91dGVQb2ludGVyLCAxLCB7CiAgICAgICAgICAgICAgICBpZDogMgogICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIGlkOiAzCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgdGhpcy5yb3V0ZVBvaW50ZXItLTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgIG1vdmVkID0gdGhpcy5tb3ZlKFsyLCA0LCA2LCA4XVtNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA0KV0pOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgcGxheWVyID0gR2FtZU1hbmFnZXIucGxheWVyOwogICAgICAgICAgICAgIGR4ID0gdGhpcy54IC0gcGxheWVyLng7CiAgICAgICAgICAgICAgZHkgPSB0aGlzLnkgLSBwbGF5ZXIueTsKICAgICAgICAgICAgICBtb3ZlZCA9IGZhbHNlOwogICAgICAgICAgICAgIGlmIChNYXRoLmFicyhkeCkgPCBNYXRoLmFicyhkeSkpIHsKICAgICAgICAgICAgICAgIGlmIChkeSA+IDApIHsKICAgICAgICAgICAgICAgICAgbW92ZWQgPSB0aGlzLm1vdmUoNik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoZHkgPCAwKSB7CiAgICAgICAgICAgICAgICAgIG1vdmVkID0gdGhpcy5tb3ZlKDIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBpZiAoTWF0aC5hYnMoZHgpID49IE1hdGguYWJzKGR5KSB8fCAhbW92ZWQpIHsKICAgICAgICAgICAgICAgIGlmIChkeCA+IDApIHsKICAgICAgICAgICAgICAgICAgbW92ZWQgPSB0aGlzLm1vdmUoNCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoZHggPCAwKSB7CiAgICAgICAgICAgICAgICAgIG1vdmVkID0gdGhpcy5tb3ZlKDgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBpZiAoIW1vdmVkKSB7CiAgICAgICAgICAgICAgICBpZiAoZHkgPiAwKSB7CiAgICAgICAgICAgICAgICAgIG1vdmVkID0gdGhpcy5tb3ZlKDYpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKGR5IDwgMCkgewogICAgICAgICAgICAgICAgICBtb3ZlZCA9IHRoaXMubW92ZSgyKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgcGxheWVyID0gR2FtZU1hbmFnZXIucGxheWVyOwogICAgICAgICAgICAgIGR4ID0gdGhpcy54IC0gcGxheWVyLng7CiAgICAgICAgICAgICAgZHkgPSB0aGlzLnkgLSBwbGF5ZXIueTsKICAgICAgICAgICAgICBtb3ZlZCA9IGZhbHNlOwogICAgICAgICAgICAgIGlmIChNYXRoLmFicyhkeCkgPCBNYXRoLmFicyhkeSkpIHsKICAgICAgICAgICAgICAgIGlmIChkeCA+IDApIHsKICAgICAgICAgICAgICAgICAgbW92ZWQgPSB0aGlzLm1vdmUoOCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoZHggPCAwKSB7CiAgICAgICAgICAgICAgICAgIG1vdmVkID0gdGhpcy5tb3ZlKDQpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBpZiAoTWF0aC5hYnMoZHgpID49IE1hdGguYWJzKGR5KSB8fCAhbW92ZWQpIHsKICAgICAgICAgICAgICAgIGlmIChkeSA+IDApIHsKICAgICAgICAgICAgICAgICAgbW92ZWQgPSB0aGlzLm1vdmUoMik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoZHkgPCAwKSB7CiAgICAgICAgICAgICAgICAgIG1vdmVkID0gdGhpcy5tb3ZlKDYpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBpZiAoIW1vdmVkKSB7CiAgICAgICAgICAgICAgICBpZiAoZHggPiAwKSB7CiAgICAgICAgICAgICAgICAgIG1vdmVkID0gdGhpcy5tb3ZlKDgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKGR4IDwgMCkgewogICAgICAgICAgICAgICAgICBtb3ZlZCA9IHRoaXMubW92ZSg0KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgICAgbW92ZWQgPSB0aGlzLm1vdmUodGhpcy5kaXJlY3Rpb24pOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDEyOgogICAgICAgICAgICAgIG1vdmVkID0gdGhpcy5tb3ZlKHRoaXMuZGlyZWN0aW9uc1sodGhpcy5kaXJlY3Rpb25zLmluZGV4T2YodGhpcy5kaXJlY3Rpb24pICsgMikgJSA0XSk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgMTM6CiAgICAgICAgICAgICAgdGhpcy5yb3V0ZVdhaXRDb3VudGVyID0gY29tbWFuZC50aW1lOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICAgIHRoaXMuanVtcChjb21tYW5kLnN0ZXBzWCAqIHRoaXMubWFwLnRpbGVTaXplLCBjb21tYW5kLnN0ZXBzWSAqIHRoaXMubWFwLnRpbGVTaXplKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAxNToKICAgICAgICAgICAgICB0aGlzLmRpcmVjdGlvbiA9IDI7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgMTY6CiAgICAgICAgICAgICAgdGhpcy5kaXJlY3Rpb24gPSA0OwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDE3OgogICAgICAgICAgICAgIHRoaXMuZGlyZWN0aW9uID0gNjsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAxODoKICAgICAgICAgICAgICB0aGlzLmRpcmVjdGlvbiA9IDg7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgMTk6CiAgICAgICAgICAgICAgdGhpcy5kaXJlY3Rpb24gPSB0aGlzLmRpcmVjdGlvbnNbKHRoaXMuZGlyZWN0aW9ucy5pbmRleE9mKHRoaXMuZGlyZWN0aW9uKSAtIDEpICUgNF07CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgMjA6CiAgICAgICAgICAgICAgdGhpcy5kaXJlY3Rpb24gPSB0aGlzLmRpcmVjdGlvbnNbKHRoaXMuZGlyZWN0aW9ucy5pbmRleE9mKHRoaXMuZGlyZWN0aW9uKSArIDEpICUgNF07CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgMjE6CiAgICAgICAgICAgICAgdGhpcy5kaXJlY3Rpb24gPSB0aGlzLmRpcmVjdGlvbnNbKHRoaXMuZGlyZWN0aW9ucy5pbmRleE9mKHRoaXMuZGlyZWN0aW9uKSArICgtMSAqIE1hdGgucm91bmQoTWF0aC5yYW5kb20oKSkpKSAlIDRdOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDIyOgogICAgICAgICAgICAgIHRoaXMuZGlyZWN0aW9uID0gdGhpcy5kaXJlY3Rpb25zWyh0aGlzLmRpcmVjdGlvbnMuaW5kZXhPZih0aGlzLmRpcmVjdGlvbikgKyAyKSAlIDRdOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDIzOgogICAgICAgICAgICAgIHRoaXMuZGlyZWN0aW9uID0gdGhpcy5kaXJlY3Rpb25zW01hdGgucm91bmQoTWF0aC5yYW5kb20oKSAqIDMpXTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAyNDoKICAgICAgICAgICAgICB0aGlzLmRpcmVjdGlvbiA9IHRoaXMuZGlyZWN0aW9uVG93YXJkRXZlbnQoR2FtZU1hbmFnZXIucGxheWVyKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAyNToKICAgICAgICAgICAgICB0aGlzLmRpcmVjdGlvbiA9IHRoaXMuZGlyZWN0aW9uQXdheUZyb21FdmVudChHYW1lTWFuYWdlci5wbGF5ZXIpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDI2OgogICAgICAgICAgICAgIGJvb2xlYW5zID0gY29tbWFuZFsic3dpdGNoIl0uc2NvcGUgPT09ICJnbG9iYWwiID8gR2FtZU1hbmFnZXIuYm9vbGVhbnMgOiB0aGlzLmJvb2xlYW5zOwogICAgICAgICAgICAgIGJvb2xlYW5zW2NvbW1hbmRbInN3aXRjaCJdLmluZGV4XSA9IHRydWU7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgMjc6CiAgICAgICAgICAgICAgYm9vbGVhbnMgPSBjb21tYW5kWyJzd2l0Y2giXS5zY29wZSA9PT0gImdsb2JhbCIgPyBHYW1lTWFuYWdlci5ib29sZWFucyA6IHRoaXMuYm9vbGVhbnM7CiAgICAgICAgICAgICAgYm9vbGVhbnNbY29tbWFuZFsic3dpdGNoIl0uaW5kZXhdID0gZmFsc2U7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgMjg6CiAgICAgICAgICAgICAgdGhpcy5tb3ZlU3BlZWQgPSB0aGlzLnNwZWVkc1tjb21tYW5kLnNwZWVkXTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAyOToKICAgICAgICAgICAgICB0aGlzLmZyZXF1ZW5jeSA9IHRoaXMuZnJlcXVlbmNpZXNbY29tbWFuZC5mcmVxdWVuY3ldOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDMwOgogICAgICAgICAgICAgIHRoaXMud2Fsa2luZ0FuaW1hdGlvbiA9IHRydWU7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgMzE6CiAgICAgICAgICAgICAgdGhpcy53YWxraW5nQW5pbWF0aW9uID0gZmFsc2U7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgMzI6CiAgICAgICAgICAgICAgdGhpcy5zdGVwcGluZ0FuaW1hdGlvbiA9IHRydWU7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgMzM6CiAgICAgICAgICAgICAgdGhpcy5zdGVwcGluZ0FuaW1hdGlvbiA9IGZhbHNlOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDM0OgogICAgICAgICAgICAgIHRoaXMuZGlyZWN0aW9uRml4ID0gdHJ1ZTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAzNToKICAgICAgICAgICAgICB0aGlzLmRpcmVjdGlvbkZpeCA9IGZhbHNlOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDM2OgogICAgICAgICAgICAgIHRoaXMudGhyb3VnaCA9IHRydWU7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgMzc6CiAgICAgICAgICAgICAgdGhpcy50aHJvdWdoID0gZmFsc2U7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgMzg6CiAgICAgICAgICAgICAgdGhpcy5vcGFjaXR5ID0gMTI4OwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDM5OgogICAgICAgICAgICAgIHRoaXMub3BhY2l0eSA9IDI1NTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSA0MDoKICAgICAgICAgICAgICB0aGlzLm1vdGlvbkJsdXIgPSB0cnVlOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDQxOgogICAgICAgICAgICAgIHRoaXMubW90aW9uQmx1ciA9IGZhbHNlOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDQyOgogICAgICAgICAgICAgIHRoaXMubW90aW9uQmx1ckxlbmd0aCA9IGNvbW1hbmQuc2hhZG93Q291bnQ7CiAgICAgICAgICAgICAgdGhpcy5tb3Rpb25CbHVyT3BhY2l0eSA9IGNvbW1hbmQub3BhY2l0eTsKICAgICAgICAgICAgICB0aGlzLm1vdGlvbkJsdXJGaXhlZE9wYWNpdHkgPSBjb21tYW5kLmZpeGVkT3BhY2l0eTsKICAgICAgICAgICAgICB0aGlzLm1vdGlvbkJsdXJDb2xvciA9IG5ldyBDb2xvcihjb21tYW5kLmNvbG9yKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSA0MzoKICAgICAgICAgICAgICB0aGlzLmZseShjb21tYW5kLmFsdGl0dWRlKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSA0NDoKICAgICAgICAgICAgICB0aGlzLmdyYXBoaWMgPSBjb21tYW5kLnJlc291cmNlOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDQ1OgogICAgICAgICAgICAgIHRoaXMub3BhY2l0eSA9IGNvbW1hbmQub3BhY2l0eTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSA0NjoKICAgICAgICAgICAgICB0aGlzLmJsZW5kaW5nID0gY29tbWFuZC5ibGVuZGluZzsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSA0NzoKICAgICAgICAgICAgICBBdWRpb01hbmFnZXIucGxheVNvdW5kKGNvbW1hbmQucmVzb3VyY2UpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDQ4OgogICAgICAgICAgICAgIHRoaXMubGFuZCgpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDQ5OgogICAgICAgICAgICAgIHRoaXMudG9uZSA9IG5ldyBUb25lKGNvbW1hbmQudG9uZS5yZWQsIGNvbW1hbmQudG9uZS5ncmVlbiwgY29tbWFuZC50b25lLmJsdWUsIGNvbW1hbmQudG9uZS5ncmV5KTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSA1MDoKICAgICAgICAgICAgICBldmFsKGNvbW1hbmQuc2NyaXB0KTsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChtb3ZlZCB8fCB0aGlzLnJvdXRlLnNraXApIHsKICAgICAgICAgICAgX3Jlc3VsdHMucHVzaCh0aGlzLnJvdXRlUG9pbnRlcisrKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIF9yZXN1bHRzLnB1c2godm9pZCAwKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIF9yZXN1bHRzOwogICAgICB9CiAgICB9OwoKICAgIExvZ2ljX0NoYXJhY3Rlci5wcm90b3R5cGUuZGlyZWN0aW9uVG93YXJkRXZlbnQgPSBmdW5jdGlvbihldmVudCkgewogICAgICB2YXIgZHgsIGR5LCByZXN1bHQ7CiAgICAgIGR4ID0gdGhpcy54IC0gZXZlbnQueDsKICAgICAgZHkgPSB0aGlzLnkgLSBldmVudC55OwogICAgICByZXN1bHQgPSAwOwogICAgICBpZiAoTWF0aC5hYnMoZHgpIDwgTWF0aC5hYnMoZHkpKSB7CiAgICAgICAgaWYgKGR5ID4gMCkgewogICAgICAgICAgcmVzdWx0ID0gNjsKICAgICAgICB9CiAgICAgICAgaWYgKGR5IDwgMCkgewogICAgICAgICAgcmVzdWx0ID0gMjsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKE1hdGguYWJzKGR4KSA+PSBNYXRoLmFicyhkeSkpIHsKICAgICAgICBpZiAoZHggPiAwKSB7CiAgICAgICAgICByZXN1bHQgPSA0OwogICAgICAgIH0KICAgICAgICBpZiAoZHggPCAwKSB7CiAgICAgICAgICByZXN1bHQgPSA4OwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gcmVzdWx0OwogICAgfTsKCiAgICBMb2dpY19DaGFyYWN0ZXIucHJvdG90eXBlLmRpcmVjdGlvbkF3YXlGcm9tRXZlbnQgPSBmdW5jdGlvbihldmVudCkgewogICAgICB2YXIgZHgsIGR5LCByZXN1bHQ7CiAgICAgIGR4ID0gdGhpcy54IC0gZXZlbnQueDsKICAgICAgZHkgPSB0aGlzLnkgLSBldmVudC55OwogICAgICByZXN1bHQgPSAwOwogICAgICBpZiAoTWF0aC5hYnMoZHgpIDwgTWF0aC5hYnMoZHkpKSB7CiAgICAgICAgaWYgKGR5ID4gMCkgewogICAgICAgICAgcmVzdWx0ID0gMjsKICAgICAgICB9CiAgICAgICAgaWYgKGR5IDwgMCkgewogICAgICAgICAgcmVzdWx0ID0gNjsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKE1hdGguYWJzKGR4KSA+PSBNYXRoLmFicyhkeSkpIHsKICAgICAgICBpZiAoZHggPiAwKSB7CiAgICAgICAgICByZXN1bHQgPSA4OwogICAgICAgIH0KICAgICAgICBpZiAoZHggPCAwKSB7CiAgICAgICAgICByZXN1bHQgPSA0OwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gcmVzdWx0OwogICAgfTsKCiAgICBMb2dpY19DaGFyYWN0ZXIucHJvdG90eXBlLmN1cnJlbnRQb3NpdGlvbkluZGV4ID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciB0eCwgdHk7CiAgICAgIHR4ID0gTWF0aC5mbG9vcih0aGlzLnggLyB0aGlzLm1hcC50aWxlU2l6ZSk7CiAgICAgIHR5ID0gTWF0aC5mbG9vcih0aGlzLnkgLyB0aGlzLm1hcC50aWxlU2l6ZSk7CiAgICAgIHJldHVybiB0eSAqIHRoaXMubWFwLndpZHRoICsgdHg7CiAgICB9OwoKICAgIExvZ2ljX0NoYXJhY3Rlci5wcm90b3R5cGUubmV4dFBvc2l0aW9uSW5kZXggPSBmdW5jdGlvbihkaXJlY3Rpb24sIGFsbG93Q291bnRlckZsYWdzKSB7CiAgICAgIHZhciBsb29wSCwgbG9vcFYsIHBvc2l0aW9uLCB0eCwgdHk7CiAgICAgIHR4ID0gTWF0aC5mbG9vcih0aGlzLnggLyB0aGlzLm1hcC50aWxlU2l6ZSk7CiAgICAgIHR5ID0gTWF0aC5mbG9vcih0aGlzLnkgLyB0aGlzLm1hcC50aWxlU2l6ZSk7CiAgICAgIHBvc2l0aW9uID0gbnVsbDsKICAgICAgbG9vcEggPSB0aGlzLm1hcExvZ2ljLmxvb3BUeXBlID49IDI7CiAgICAgIGxvb3BWID0gdGhpcy5tYXBMb2dpYy5sb29wVHlwZSA9PT0gMSB8fCB0aGlzLm1hcExvZ2ljLmxvb3BUeXBlID09PSAzOwogICAgICB3aGlsZSAodHJ1ZSkgewogICAgICAgIHN3aXRjaCAoZGlyZWN0aW9uKSB7CiAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgIHR5ID0gKGxvb3BWID8gKHR5ID09PSB0aGlzLm1hcC5oZWlnaHQgLSAxID8gMCA6IHR5ICsgMSkgOiBNYXRoLm1pbih0eSArIDEsIHRoaXMubWFwLmhlaWdodCAtIDEpKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgIHR4ID0gKGxvb3BIID8gKHR4ID09PSAwID8gdGhpcy5tYXAud2lkdGggLSAxIDogdHggLSAxKSA6IE1hdGgubWF4KHR4IC0gMSwgMCkpOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgdHkgPSAobG9vcFYgPyAodHkgPT09IDAgPyB0aGlzLm1hcC5oZWlnaHQgLSAxIDogdHkgLSAxKSA6IE1hdGgubWF4KHR5IC0gMSwgMCkpOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgdHggPSAobG9vcEggPyAodHggPT09IHRoaXMubWFwLndpZHRoIC0gMSA/IDAgOiB0eCArIDEpIDogTWF0aC5taW4odHggKyAxLCB0aGlzLm1hcC53aWR0aCAtIDEpKTsKICAgICAgICB9CiAgICAgICAgcG9zaXRpb24gPSB0eSAqIHRoaXMubWFwLndpZHRoICsgdHg7CiAgICAgICAgaWYgKCFhbGxvd0NvdW50ZXJGbGFncyB8fCAhdGhpcy5jaGVja0NvdW50ZXJGbGFnKHBvc2l0aW9uKSkgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiBwb3NpdGlvbjsKICAgIH07CgogICAgTG9naWNfQ2hhcmFjdGVyLnByb3RvdHlwZS5mbHkgPSBmdW5jdGlvbihhbHRpdHVkZSkgewogICAgICB0aGlzLmlzRmx5aW5nID0gdHJ1ZTsKICAgICAgdGhpcy5pc1NvYXJpbmcgPSB0cnVlOwogICAgICB0aGlzLmFuaW1hdGlvbkNvdW50ZXIgPSBhbHRpdHVkZSAqIHRoaXMubWFwLnRpbGVTaXplOwogICAgICByZXR1cm4gdGhpcy5hbHRpdHVkZSA9IGFsdGl0dWRlOwogICAgfTsKCiAgICBMb2dpY19DaGFyYWN0ZXIucHJvdG90eXBlLmxhbmQgPSBmdW5jdGlvbigpIHsKICAgICAgdGhpcy5pc0ZseWluZyA9IGZhbHNlOwogICAgICB0aGlzLmlzU29hcmluZyA9IGZhbHNlOwogICAgICB0aGlzLmlzTGFuZGluZyA9IHRydWU7CiAgICAgIHRoaXMuYW5pbWF0aW9uQ291bnRlciA9IHRoaXMuYWx0aXR1ZGUgKiB0aGlzLm1hcC50aWxlU2l6ZTsKICAgICAgcmV0dXJuIHRoaXMuYWx0aXR1ZGUgPSAwOwogICAgfTsKCiAgICBMb2dpY19DaGFyYWN0ZXIucHJvdG90eXBlLnR4ID0gZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiBNYXRoLmZsb29yKHRoaXMueCAvIHRoaXMubWFwLnRpbGVTaXplKTsKICAgIH07CgogICAgTG9naWNfQ2hhcmFjdGVyLnByb3RvdHlwZS50eSA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gTWF0aC5mbG9vcih0aGlzLnkgLyB0aGlzLm1hcC50aWxlU2l6ZSk7CiAgICB9OwoKICAgIExvZ2ljX0NoYXJhY3Rlci5wcm90b3R5cGUuc2V0VGlsZUxvY2F0aW9uID0gZnVuY3Rpb24oeCwgeSkgewogICAgICB2YXIgdHgsIHR5OwogICAgICB4ID0gTWF0aC5tYXgoTWF0aC5taW4oeCwgdGhpcy5tYXAud2lkdGggLSAxKSwgMCk7CiAgICAgIHkgPSBNYXRoLm1heChNYXRoLm1pbih5LCB0aGlzLm1hcC5oZWlnaHQgLSAxKSwgMCk7CiAgICAgIHR4ID0gTWF0aC5mbG9vcih0aGlzLnggLyB0aGlzLm1hcC50aWxlU2l6ZSk7CiAgICAgIHR5ID0gTWF0aC5mbG9vcih0aGlzLnkgLyB0aGlzLm1hcC50aWxlU2l6ZSk7CiAgICAgIHRoaXMuY29sbGlzaW9uTWFwW3R5ICogdGhpcy5tYXAud2lkdGggKyB0eF0ucmVtb3ZlKHRoaXMpOwogICAgICB0aGlzLmNvbGxpc2lvbk1hcFt5ICogdGhpcy5tYXAud2lkdGggKyB4XS5wdXNoKHRoaXMpOwogICAgICB0aGlzLnggPSB4ICogdGhpcy5tYXAudGlsZVNpemU7CiAgICAgIHJldHVybiB0aGlzLnkgPSB5ICogdGhpcy5tYXAudGlsZVNpemU7CiAgICB9OwoKICAgIExvZ2ljX0NoYXJhY3Rlci5wcm90b3R5cGUuanVtcCA9IGZ1bmN0aW9uKHgsIHkpIHsKICAgICAgdmFyIGRpc3RhbmNlOwogICAgICBpZiAoTWF0aC5hYnMoeCkgPCBNYXRoLmFicyh5KSkgewogICAgICAgIGlmICh5ID4gMCkgewogICAgICAgICAgdGhpcy5kaXJlY3Rpb24gPSAyOwogICAgICAgIH0KICAgICAgICBpZiAoeSA8IDApIHsKICAgICAgICAgIHRoaXMuZGlyZWN0aW9uID0gNjsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKHggPiAwKSB7CiAgICAgICAgICB0aGlzLmRpcmVjdGlvbiA9IDg7CiAgICAgICAgfQogICAgICAgIGlmICh4IDwgMCkgewogICAgICAgICAgdGhpcy5kaXJlY3Rpb24gPSA0OwogICAgICAgIH0KICAgICAgfQogICAgICB0aGlzLmlzSnVtcGluZyA9IHRydWU7CiAgICAgIGRpc3RhbmNlID0gTWF0aC5yb3VuZChNYXRoLnNxcnQoeCAqIHggKyB5ICogeSkpOwogICAgICB0aGlzLnNoYWRvd1kgPSB0aGlzLnk7CiAgICAgIHRoaXMuanVtcFggPSB0aGlzLnggKyB4OwogICAgICB0aGlzLmp1bXBZID0gdGhpcy55ICsgeTsKICAgICAgdGhpcy5qdW1wUGVhayA9IDEwMCArIGRpc3RhbmNlOwogICAgICB0aGlzLmp1bXBDb3VudGVyID0gTWF0aC5yb3VuZCh0aGlzLmp1bXBQZWFrIC8gKHRoaXMubW92ZVNwZWVkICogMykpOwogICAgICB0aGlzLmp1bXBDb3VudGVySGFsZiA9IE1hdGgucm91bmQodGhpcy5qdW1wQ291bnRlciAvIDIpOwogICAgICB0aGlzLmp1bXBWYWx1ZSA9IE1hdGgucm91bmQodGhpcy5qdW1wUGVhayAvIHRoaXMuanVtcENvdW50ZXJIYWxmKTsKICAgICAgcmV0dXJuIHRoaXMuanVtcEhlaWdodCA9IDA7CiAgICB9OwoKICAgIExvZ2ljX0NoYXJhY3Rlci5wcm90b3R5cGUubW92ZSA9IGZ1bmN0aW9uKGRpcmVjdGlvbikgewogICAgICB2YXIgcG9zaXRpb24sIHR4LCB0eTsKICAgICAgaWYgKCF0aGlzLmlzTW92aW5nICYmICF0aGlzLmlzTG9ja2VkKSB7CiAgICAgICAgdGhpcy5pc01vdmluZyA9IHRydWU7CiAgICAgICAgdGhpcy5kaXJlY3Rpb24gPSBkaXJlY3Rpb247CiAgICAgICAgdHggPSBNYXRoLmZsb29yKHRoaXMueCAvIHRoaXMubWFwLnRpbGVTaXplKTsKICAgICAgICB0eSA9IE1hdGguZmxvb3IodGhpcy55IC8gdGhpcy5tYXAudGlsZVNpemUpOwogICAgICAgIHBvc2l0aW9uID0gdGhpcy5uZXh0UG9zaXRpb25JbmRleChkaXJlY3Rpb24pOwogICAgICAgIHRoaXMuY2hlY2tCdXNoRmxhZyhwb3NpdGlvbik7CiAgICAgICAgdGhpcy5jb2xsaXNpb25NYXBbdHkgKiB0aGlzLm1hcC53aWR0aCArIHR4XS5yZW1vdmUodGhpcyk7CiAgICAgICAgdGhpcy5jb2xsaXNpb25NYXBbcG9zaXRpb25dLnB1c2godGhpcyk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICB9OwoKICAgIExvZ2ljX0NoYXJhY3Rlci5wcm90b3R5cGUubW92ZVJvdXRlID0gZnVuY3Rpb24ocm91dGUpIHsKICAgICAgdGhpcy5yb3V0ZSA9IHJvdXRlOwogICAgICB0aGlzLnJvdXRlUG9pbnRlciA9IDA7CiAgICAgIHJldHVybiB0aGlzLnJvdXRlV2FpdENvdW50ZXIgPSAwOwogICAgfTsKCiAgICBMb2dpY19DaGFyYWN0ZXIucHJvdG90eXBlLmNhbk1vdmUgPSBmdW5jdGlvbihkaXJlY3Rpb24pIHsKICAgICAgdmFyIGN1cnJlbnQsIGN1cnJlbnRUaWxlLCBpLCBvZmZzZXQsIHBvc2l0aW9uLCByZXN1bHQsIHNpemUsIHRhZywgdGVycmFpbiwgdGlsZSwgX2ksIF9yZWY7CiAgICAgIG9mZnNldCA9IDA7CiAgICAgIHRpbGUgPSAwOwogICAgICBzaXplID0gMDsKICAgICAgcmVzdWx0ID0gZmFsc2U7CiAgICAgIHBvc2l0aW9uID0gdGhpcy5uZXh0UG9zaXRpb25JbmRleChkaXJlY3Rpb24pOwogICAgICBjdXJyZW50ID0gdGhpcy5jdXJyZW50UG9zaXRpb25JbmRleCgpOwogICAgICBpZiAodGhpcy50aHJvdWdoKSB7CiAgICAgICAgcmVzdWx0ID0gcG9zaXRpb24gPj0gMCAmJiBwb3NpdGlvbiA8ICh0aGlzLm1hcC53aWR0aCAqIHRoaXMubWFwLmhlaWdodCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgc2l6ZSA9IHRoaXMubWFwLndpZHRoICogdGhpcy5tYXAuaGVpZ2h0OwogICAgICAgIGZvciAoaSA9IF9pID0gMCwgX3JlZiA9IHRoaXMubWFwLmRlcHRoOyAwIDw9IF9yZWYgPyBfaSA8IF9yZWYgOiBfaSA+IF9yZWY7IGkgPSAwIDw9IF9yZWYgPyArK19pIDogLS1faSkgewogICAgICAgICAgdGlsZSA9IHRoaXMubWFwRGF0YVtwb3NpdGlvbiArIGkgKiBzaXplXTsKICAgICAgICAgIGN1cnJlbnRUaWxlID0gdGhpcy5tYXBEYXRhW2N1cnJlbnQgKyBpICogc2l6ZV07CiAgICAgICAgICB0YWcgPSB0aGlzLnRpbGVzZXQudGVycmFpblRhZ3NbdGlsZV07CiAgICAgICAgICBpZiAoKHRoaXMucGFzc2FnZXMgIT0gbnVsbCkgJiYgdGhpcy5wYXNzYWdlcy5sZW5ndGggPiAwICYmIHRhZyA+IDApIHsKICAgICAgICAgICAgdGVycmFpbiA9IHRoaXMudGVycmFpbnNbdGFnXTsKICAgICAgICAgICAgcmVzdWx0ID0gZmFsc2U7CiAgICAgICAgICAgIHJlc3VsdCA9ICh0ZXJyYWluICE9IG51bGwpICYmICh0aGlzLnBhc3NhZ2VzW3RlcnJhaW4uaW5kZXhdICE9IG51bGwpID8gdGhpcy5wYXNzYWdlc1t0ZXJyYWluLmluZGV4XSA9PT0gMCA6IHJlc3VsdDsKICAgICAgICAgICAgaWYgKCFyZXN1bHQpIHsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmVzdWx0ID0gdGhpcy5jaGVja1Bhc3NhZ2UodGhpcy50aWxlc2V0LnBhc3NhZ2VzW3RpbGVdLCBkaXJlY3Rpb24pOwogICAgICAgICAgICBpZiAocmVzdWx0KSB7CiAgICAgICAgICAgICAgcmVzdWx0ID0gdGhpcy5jaGVja1Bhc3NhZ2VSZXZlcnNlKHRoaXMudGlsZXNldC5wYXNzYWdlc1tjdXJyZW50VGlsZV0sIGRpcmVjdGlvbik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKCFyZXN1bHQpIHsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAocmVzdWx0KSB7CiAgICAgICAgICByZXN1bHQgPSAodGhpcy5jb2xsaXNpb25NYXBbcG9zaXRpb25dICE9IG51bGwpICYmIHRoaXMuY29sbGlzaW9uTWFwW3Bvc2l0aW9uXS5sZW5ndGggPT09IDAgfHwgdGhpcy5jYW5Nb3ZlVGhyb3VnaCh0aGlzLmNvbGxpc2lvbk1hcFtwb3NpdGlvbl0pOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gcmVzdWx0OwogICAgfTsKCiAgICBMb2dpY19DaGFyYWN0ZXIucHJvdG90eXBlLmNhbk1vdmVUaHJvdWdoID0gZnVuY3Rpb24oY2hhcmFjdGVycykgewogICAgICB2YXIgY2hhcmFjdGVyLCByZXN1bHQsIF9pLCBfbGVuOwogICAgICByZXN1bHQgPSB0cnVlOwogICAgICBpZiAoY2hhcmFjdGVycyAhPSBudWxsKSB7CiAgICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBjaGFyYWN0ZXJzLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7CiAgICAgICAgICBjaGFyYWN0ZXIgPSBjaGFyYWN0ZXJzW19pXTsKICAgICAgICAgIGlmICghY2hhcmFjdGVyLnRocm91Z2gpIHsKICAgICAgICAgICAgcmVzdWx0ID0gY2hhcmFjdGVyLmxheWVyICE9PSB0aGlzLmxheWVyOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH07CgogICAgTG9naWNfQ2hhcmFjdGVyLnByb3RvdHlwZS5jaGVja1Bhc3NhZ2UgPSBmdW5jdGlvbihwYXNzYWdlLCBkaXJlY3Rpb24pIHsKICAgICAgdmFyIHJlc3VsdDsKICAgICAgcmVzdWx0ID0gcGFzc2FnZSA9PT0gMDsKICAgICAgaWYgKCFyZXN1bHQpIHsKICAgICAgICBzd2l0Y2ggKGRpcmVjdGlvbikgewogICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICByZXN1bHQgPSAhKHBhc3NhZ2UgJiAweDA4KTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgIHJlc3VsdCA9ICEocGFzc2FnZSAmIDB4MDQpOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgcmVzdWx0ID0gIShwYXNzYWdlICYgMHgwMSk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICByZXN1bHQgPSAhKHBhc3NhZ2UgJiAweDAyKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH07CgogICAgTG9naWNfQ2hhcmFjdGVyLnByb3RvdHlwZS5jaGVja1Bhc3NhZ2VSZXZlcnNlID0gZnVuY3Rpb24ocGFzc2FnZSwgZGlyZWN0aW9uKSB7CiAgICAgIHZhciByZXN1bHQ7CiAgICAgIHJlc3VsdCA9IHBhc3NhZ2UgPT09IDA7CiAgICAgIGlmICghcmVzdWx0KSB7CiAgICAgICAgc3dpdGNoIChkaXJlY3Rpb24pIHsKICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgcmVzdWx0ID0gIShwYXNzYWdlICYgMHgwOCk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICByZXN1bHQgPSAhKHBhc3NhZ2UgJiAweDA0KTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgIHJlc3VsdCA9ICEocGFzc2FnZSAmIDB4MDEpOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgcmVzdWx0ID0gIShwYXNzYWdlICYgMHgwMik7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9OwoKICAgIExvZ2ljX0NoYXJhY3Rlci5wcm90b3R5cGUuY2hlY2tDb3VudGVyRmxhZyA9IGZ1bmN0aW9uKHBvc2l0aW9uKSB7CiAgICAgIHZhciBpLCByZXN1bHQsIHNpemUsIF9pLCBfcmVmOwogICAgICBzaXplID0gdGhpcy5tYXAud2lkdGggKiB0aGlzLm1hcC5oZWlnaHQ7CiAgICAgIGZvciAoaSA9IF9pID0gMCwgX3JlZiA9IHRoaXMubWFwLmRlcHRoOyAwIDw9IF9yZWYgPyBfaSA8IF9yZWYgOiBfaSA+IF9yZWY7IGkgPSAwIDw9IF9yZWYgPyArK19pIDogLS1faSkgewogICAgICAgIHJlc3VsdCA9IHRoaXMudGlsZXNldC5wYXNzYWdlc1t0aGlzLm1hcERhdGFbcG9zaXRpb24gKyBpICogc2l6ZV1dICYgMHg4MDsKICAgICAgICBpZiAocmVzdWx0KSB7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH07CgogICAgTG9naWNfQ2hhcmFjdGVyLnByb3RvdHlwZS5jaGVja0J1c2hGbGFnID0gZnVuY3Rpb24ocG9zaXRpb24pIHsKICAgICAgdmFyIGJ1c2hGbGFnLCBpLCBzaXplLCB0aWxlLCBfaSwgX3JlZiwgX3Jlc3VsdHM7CiAgICAgIHNpemUgPSB0aGlzLm1hcC53aWR0aCAqIHRoaXMubWFwLmhlaWdodDsKICAgICAgcG9zaXRpb24gPSBwb3NpdGlvbiAhPSBudWxsID8gcG9zaXRpb24gOiB0aGlzLmN1cnJlbnRQb3NpdGlvbkluZGV4KCk7CiAgICAgIHRoaXMuYnVzaEZsYWcgPSBmYWxzZTsKICAgICAgX3Jlc3VsdHMgPSBbXTsKICAgICAgZm9yIChpID0gX2kgPSAwLCBfcmVmID0gdGhpcy5tYXAuZGVwdGg7IDAgPD0gX3JlZiA/IF9pIDwgX3JlZiA6IF9pID4gX3JlZjsgaSA9IDAgPD0gX3JlZiA/ICsrX2kgOiAtLV9pKSB7CiAgICAgICAgdGlsZSA9IHRoaXMubWFwRGF0YVtwb3NpdGlvbiArIGkgKiBzaXplXTsKICAgICAgICBidXNoRmxhZyA9IHRoaXMudGlsZXNldC5wYXNzYWdlc1t0aWxlXSAmIDB4NDA7CiAgICAgICAgaWYgKGJ1c2hGbGFnKSB7CiAgICAgICAgICB0aGlzLmJ1c2hGbGFnID0gdHJ1ZTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBfcmVzdWx0cy5wdXNoKHZvaWQgMCk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiBfcmVzdWx0czsKICAgIH07CgogICAgcmV0dXJuIExvZ2ljX0NoYXJhY3RlcjsKCiAgfSkoKTsKCiAgd2luZG93LkxvZ2ljX0NoYXJhY3RlciA9IExvZ2ljX0NoYXJhY3RlcjsKCn0pLmNhbGwodGhpcyk7Cg=="},{"name":"Logic_Event","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogTG9naWNfRXZlbnQKIyAgIENyZWF0ZWQgb246IDIwMTMtMDktMDEKIwojICAgQ29weXJpZ2h0IChDKSAyMDEzIEFuZHLpIFJhZG9tc2tpLiBBbGwgcmlnaHRzIHJlc2VydmVkLgojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQojCiMgICBDbGFzczogTG9naWNfRXZlbnQKIwojICAgQSBiYXNlIGNsYXNzIGZvciBhbGwgb3RoZXIgd2luZG93IGNsYXNzZXMuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpjbGFzcyBMb2dpY19FdmVudCBleHRlbmRzIExvZ2ljX0NoYXJhY3RlcgogICAgY29uc3RydWN0b3I6IChldmVudCwgaWQpIC0+CiAgICAgICAgc3VwZXIoKQogICAgICAgIEBpZCA9IGlkCiAgICAgICAgQGV2ZW50ID0gZXZlbnQKICAgICAgICBAeCA9IGV2ZW50LnggKiAoaWYgJFBBUkFNUy5yZXNvbHV0aW9uLndpZHRoID09IDMyMCB0aGVuIDE2IGVsc2UgMzIpCiAgICAgICAgQHkgPSBldmVudC55ICogKGlmICRQQVJBTVMucmVzb2x1dGlvbi53aWR0aCA9PSAzMjAgdGhlbiAxNiBlbHNlIDMyKQogICAgICAgIAogICAgICAgIEBwYWdlcyA9IFt7IG5hbWU6ICJJTlZJU0lCTEUiLCB3YWxrVGhyb3VnaDogeWVzLCBjb21tYW5kczogW10sIHN0YXJ0Q29uZGl0aW9uOiAwfV0KICAgICAgICBwYWdlcyA9IG51bGwKICAgICAgICBpZiBldmVudC50ZW1wbGF0ZUlkPyAKICAgICAgICAgICAgQHRlbXBsYXRlID0gUmVjb3JkTWFuYWdlci5ldmVudFRlbXBsYXRlc1tldmVudC50ZW1wbGF0ZUlkXQogICAgICAgICAgICBwYWdlcyA9IEB0ZW1wbGF0ZS5wYWdlcwogICAgICAgIGVsc2UKICAgICAgICAgICAgcGFnZXMgPSBldmVudC5wYWdlcyB8fCBbXQogICAgICAgIGZvciBwYWdlIGluIHBhZ2VzCiAgICAgICAgICAgIEBwYWdlcy5wdXNoKHBhZ2UpCiAgICAgICAgICAgIAogICAgICAgIGlmIEBwYWdlcy5sZW5ndGggPT0gMQogICAgICAgICAgICBAcGFnZXMucHVzaCh7fSkKICAgICAgICAgICAgCiAgICAgICAgQGxheWVyID0gMQogICAgICAgIEBpbnRlcnByZXRlciA9IG51bGwKICAgICAgICBAYXV0b01vdmVtZW50Um91dGUgPSBudWxsCiAgICAgICAgQHN3aXRjaFBhZ2UoQHBhZ2VzWzFdKQogICAgICAgIAogICAgICAgIEBsb2NhbE51bWJlcnMgPSBldmVudC5sb2NhbE51bWJlcnMgfHwgW10KICAgICAgICBAbG9jYWxCb29sZWFucyA9IGV2ZW50LmxvY2FsQm9vbGVhbnMgfHwgW10KICAgICAgICBAbG9jYWxTdHJpbmdzID0gZXZlbnQubG9jYWxTdHJpbmdzIHx8IFtdCiAgICAgICAgCiAgICAgICAgcGFyYW1ldGVycyA9IEBldmVudC5wYXJhbWV0ZXJzCiAgICAgICAgaWYgcGFyYW1ldGVycz8gYW5kIHBhcmFtZXRlcnMudmFsdWVzPwogICAgICAgICAgICBmb3IgaSBpbiBbMC4uLnBhcmFtZXRlcnMudmFsdWVzLmxlbmd0aF0KICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHBhcmFtZXRlcnMudmFsdWVzW2ldCiAgICAgICAgICAgICAgICAgICAgcGFyYW1ldGVyID0gQHRlbXBsYXRlLnBhcmFtZXRlcnNbaV0KICAgICAgICAgICAgICAgICAgICBpZiBwYXJhbWV0ZXI/IGFuZCB2YWx1ZT8KICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIHBhcmFtZXRlci50eXBlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGVuIDEgIyBOdW1iZXIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IEdhbWVNYW5hZ2VyLnZhcmlhYmxlU3RvcmUubnVtYmVyVmFsdWVPZih2YWx1ZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBHYW1lTWFuYWdlci52YXJpYWJsZVN0b3JlLnNldE51bWJlclZhbHVlVG8ocGFyYW1ldGVyLm51bWJlclZhcmlhYmxlLCB2YWx1ZSwgaWQsIEdhbWVNYW5hZ2VyLm1hcC5pZCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoZW4gMiAjIEJvb2xlYW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IEdhbWVNYW5hZ2VyLnZhcmlhYmxlU3RvcmUuYm9vbGVhblZhbHVlT2YodmFsdWUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgR2FtZU1hbmFnZXIudmFyaWFibGVTdG9yZS5zZXRCb29sZWFuVmFsdWVUbyhwYXJhbWV0ZXIuYm9vbGVhblZhcmlhYmxlLCB2YWx1ZSwgaWQsIEdhbWVNYW5hZ2VyLm1hcC5pZCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoZW4gMyAjIFN0cmluZwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gR2FtZU1hbmFnZXIudmFyaWFibGVTdG9yZS5zdHJpbmdWYWx1ZU9mKHZhbHVlKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdhbWVNYW5hZ2VyLnZhcmlhYmxlU3RvcmUuc2V0U3RyaW5nVmFsdWVUbyhwYXJhbWV0ZXIuc3RyaW5nVmFyaWFibGUsIHZhbHVlLCBpZCwgR2FtZU1hbmFnZXIubWFwLmlkKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hlbiA0ICMgTWFwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFwSWQgPSBHYW1lTWFuYWdlci52YXJpYWJsZVN0b3JlLnN0cmluZ1ZhbHVlT2YodmFsdWUubWFwLnVpZCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXBYID0gR2FtZU1hbmFnZXIudmFyaWFibGVTdG9yZS5zdHJpbmdWYWx1ZU9mKHZhbHVlLmxvY2F0aW9uLngpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFwWSA9IEdhbWVNYW5hZ2VyLnZhcmlhYmxlU3RvcmUuc3RyaW5nVmFsdWVPZih2YWx1ZS5sb2NhdGlvbi55KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdhbWVNYW5hZ2VyLnZhcmlhYmxlU3RvcmUuc2V0U3RyaW5nVmFsdWVUbyhwYXJhbWV0ZXIubWFwVWlkVmFyaWFibGUsIG1hcElkLCBpZCwgR2FtZU1hbmFnZXIubWFwLmlkKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdhbWVNYW5hZ2VyLnZhcmlhYmxlU3RvcmUuc2V0TnVtYmVyVmFsdWVUbyhwYXJhbWV0ZXIubWFwVmFyaWFibGVYLCBtYXBYLCBpZCwgR2FtZU1hbmFnZXIubWFwLmlkKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdhbWVNYW5hZ2VyLnZhcmlhYmxlU3RvcmUuc2V0TnVtYmVyVmFsdWVUbyhwYXJhbWV0ZXIubWFwVmFyaWFibGVZLCBtYXBZLCBpZCwgR2FtZU1hbmFnZXIubWFwLmlkKQogICAgICAgIAogICAgCiAgICBzdGFydDogLT4KICAgICAgICByZXR1cm4gaWYgQGlzTW92aW5nCiAgICAgICAgCiAgICAgICAgQGludGVycHJldGVyID0gaWYgbm90IEBwYXJhbGxlbCB0aGVuIEdhbWVNYW5hZ2VyLmludGVycHJldGVyIGVsc2UgQGludGVycHJldGVyCiAgICAgICAgaWYgQGludGVycHJldGVyPyBhbmQgbm90IEBpbnRlcnByZXRlci5pc1J1bm5pbmcgYW5kIEBjdXJyZW50UGFnZS5jb21tYW5kcyBhbmQgQGN1cnJlbnRQYWdlLmNvbW1hbmRzLmxlbmd0aCA+IDEKICAgICAgICAgICAgQGludGVycHJldGVyLnJlcGVhdCA9IEBzdGFydENvbmRpdGlvbiA9PSA0CiAgICAgICAgICAgIEBpbnRlcnByZXRlci5jb21tYW5kcyA9IEBjdXJyZW50UGFnZS5jb21tYW5kcwogICAgICAgICAgICBAaW50ZXJwcmV0ZXIucGFyZW50T2JqZWN0ID0gdGhpcwogICAgICAgICAgICBAaW50ZXJwcmV0ZXIuc3RhcnQoKQogICAgICAgICAgICBpZiBub3QgQGRpcmVjdGlvbkZpeGVkIGFuZCAoQHN0YXJ0Q29uZGl0aW9uID49IDAgb3IgQHN0YXJ0Q29uZGl0aW9uIDw9IDEpCiAgICAgICAgICAgICAgICBAb3JpZ2luYWxEaXJlY3Rpb24gPSBAZGlyZWN0aW9uCiAgICAgICAgICAgICAgICBAZGlyZWN0aW9uID0gKChHYW1lTWFuYWdlci5wbGF5ZXIuZGlyZWN0aW9uICsgNCkgJSA4KSB8fCA4CiAgICAgICAgZWxzZQogICAgICAgICAgICBAaW50ZXJwcmV0ZXIgPSBudWxsCiAgICAgICAgICAgIAogICAgc3RvcDogLT4KICAgICAgICBAaW50ZXJwcmV0ZXIgPSBpZiBub3QgQHBhcmFsbGVsIHRoZW4gR2FtZU1hbmFnZXIuaW50ZXJwcmV0ZXIgZWxzZSBAaW50ZXJwcmV0ZXIKICAgICAgICBpZiBAaW50ZXJwcmV0ZXI/IGFuZCBAaW50ZXJwcmV0ZXIuaXNSdW5uaW5nCiAgICAgICAgICAgIEBpbnRlcnByZXRlci5zdG9wKCkKICAKICAgIHVwZGF0ZTogLT4KICAgICAgICBzdXBlcgogICAgICAgIGlmIEBpbnRlcnByZXRlcj8KICAgICAgICAgICAgaWYgQGludGVycHJldGVyLnBhcmVudE9iamVjdD8KICAgICAgICAgICAgICAgIEBpbnRlcnByZXRlci5wYXJlbnRPYmplY3QuaXNMb2NrZWQgPSB5ZXMKICAgICAgICAgICAgQGludGVycHJldGVyLnVwZGF0ZSgpCiAgICAgICAgZWxzZSBpZiBAb3JpZ2luYWxEaXJlY3Rpb24/IGFuZCBub3QgQGlzTW92aW5nCiAgICAgICAgICAgIEBkaXJlY3Rpb24gPSBAb3JpZ2luYWxEaXJlY3Rpb24KICAgICAgICAgICAgQG9yaWdpbmFsRGlyZWN0aW9uID0gbnVsbAogICAgICAgICAgICAKICAgICAgICBpZiBAaW50ZXJwcmV0ZXI/IGFuZCBub3QgQGludGVycHJldGVyLmlzUnVubmluZyBhbmQgbm90IEBwYXJhbGxlbAogICAgICAgICAgICBpZiBAaW50ZXJwcmV0ZXIucGFyZW50T2JqZWN0PwogICAgICAgICAgICAgICAgQGludGVycHJldGVyLnBhcmVudE9iamVjdC5pc0xvY2tlZCA9IG5vCiAgICAgICAgICAgIEBpbnRlcnByZXRlciA9IG51bGwKICAgICAgICAgICAgCiAgICAgICAgICAgIAogICAgICAgIGZvciBwYWdlIGluIEBwYWdlcyBieSAtMQogICAgICAgICAgICBpZiBAY2hlY2tQYWdlQ29uZGl0aW9ucyhwYWdlKQogICAgICAgICAgICAgICAgQHN3aXRjaFBhZ2UocGFnZSkKICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAKICAgIHN1YlBhdHRlcm5Db2x1bW46IC0+IEBncmFwaGljUGF0dGVybiAlIDQKICAgICAgICAgICAgICAgIAogICAgc3dpdGNoUGFnZTogKHBhZ2UpIC0+CiAgICAgICAgaWYgQGN1cnJlbnRQYWdlID09IHBhZ2UgdGhlbiByZXR1cm4KICAgICAgICAKICAgICAgICBpZiBAaW50ZXJwcmV0ZXI/CiAgICAgICAgICAgIEBpbnRlcnByZXRlci5zdG9wKCkKICAgICAgICAgICAgQGludGVycHJldGVyLnJlcGVhdCA9IG5vCiAgICAgICAgICAgIEBpbnRlcnByZXRlciA9IG51bGwKICAgICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgICAgIAogICAgICAgIEBjdXJyZW50UGFnZSA9IHBhZ2UKICAgCiAgICAgICAgICAgIAogICAgICAgIEBzdGFydENvbmRpdGlvbiA9IGlmIEBjdXJyZW50UGFnZS5zdGFydENvbmRpdGlvbj8gdGhlbiBAY3VycmVudFBhZ2Uuc3RhcnRDb25kaXRpb24gZWxzZSAwCiAgICAgICAgQG1vdmVTcGVlZCA9IGlmIEBjdXJyZW50UGFnZS5zcGVlZD8gdGhlbiBAc3BlZWRzW0BjdXJyZW50UGFnZS5zcGVlZF0gZWxzZSBAc3BlZWRzWzJdCiAgICAgICAgQGZyZXF1ZW5jeSA9IGlmIEBjdXJyZW50UGFnZS5zcGVlZD8gdGhlbiBAZnJlcXVlbmNpZXNbQGN1cnJlbnRQYWdlLnNwZWVkXSBlbHNlIEBmcmVxdWVuY2llc1syXQogICAgICAgIAogICAgICAgIEB3YWxraW5nQW5pbWF0aW9uID0gaWYgQGN1cnJlbnRQYWdlLndhbGtpbmdBbmltYXRpb24/IHRoZW4gQGN1cnJlbnRQYWdlLndhbGtpbmdBbmltYXRpb24gZWxzZSB5ZXMKICAgICAgICBAc3RlcHBpbmdBbmltYXRpb24gPSBpZiBAY3VycmVudFBhZ2Uuc3RlcHBpbmdBbmltYXRpb24/IHRoZW4gQGN1cnJlbnRQYWdlLnN0ZXBwaW5nQW5pbWF0aW9uIGVsc2Ugbm8KICAgICAgICBAdGhyb3VnaCA9IGlmIEBjdXJyZW50UGFnZS53YWxrVGhyb3VnaD8gdGhlbiBAY3VycmVudFBhZ2Uud2Fsa1Rocm91Z2ggZWxzZSBubwogICAgICAgIEBkaXJlY3Rpb25GaXhlZCA9IGlmIEBjdXJyZW50UGFnZS5kaXJlY3Rpb25GaXhlZD8gdGhlbiBAY3VycmVudFBhZ2UuZGlyZWN0aW9uRml4ZWQgZWxzZSBubwogICAgICAgIEBwYXJhbGxlbCA9IGlmIEBjdXJyZW50UGFnZS5wYXJhbGxlbD8gdGhlbiBAY3VycmVudFBhZ2UucGFyYWxsZWwgZWxzZSBubwogICAgICAgIEBpbnRlcnByZXRlciA9IGlmIEBwYXJhbGxlbCB0aGVuIG5ldyBDb21tYW5kSW50ZXJwcmV0ZXIoQGN1cnJlbnRQYWdlLmNvbW1hbmRzKSBlbHNlIG51bGwKICAgICAgICBAbGF5ZXIgPSBpZiBAY3VycmVudFBhZ2UubGF5ZXI/IHRoZW4gQGN1cnJlbnRQYWdlLmxheWVyIGVsc2UgMQogICAgICAgIHBhdHRlcm4gPSAwCiAgICAgICAgaW5kZXggPSBAcGFnZXMuaW5kZXhPZihAY3VycmVudFBhZ2UpCiAgICAgICAgaWYgQGV2ZW50LnBhZ2VEYXRhPyBhbmQgQGV2ZW50LnBhZ2VEYXRhLmxlbmd0aCA+IGluZGV4IGFuZCBAZXZlbnQucGFnZURhdGFbaW5kZXhdLmdyYXBoaWM/CiAgICAgICAgICAgIEBncmFwaGljID0gQGV2ZW50LnBhZ2VEYXRhW2luZGV4XS5ncmFwaGljCiAgICAgICAgICAgIHBhdHRlcm4gPSBAZXZlbnQucGFnZURhdGFbaW5kZXhdLnBhdHRlcm4KICAgICAgICBlbHNlCiAgICAgICAgICAgIEBncmFwaGljID0gQGN1cnJlbnRQYWdlLmdyYXBoaWMKICAgICAgICAgICAgcGF0dGVybiA9IEBjdXJyZW50UGFnZS5ncmFwaGljUGF0dGVybgogICAgICAgICAgICAKICAgICAgICBjb2x1bW4gPSBNYXRoLmZsb29yKChwYXR0ZXJuICUgNCkpCiAgICAgICAgcm93ID0gTWF0aC5mbG9vcihwYXR0ZXJuIC8gNCkKICAgICAgICAKICAgICAgICBpZiBAY3VycmVudFBhZ2UucGFzc2FnZXMgYW5kIEBjdXJyZW50UGFnZS5wYXNzYWdlcy5wYXNzYWdlcy5sZW5ndGggPiAwCiAgICAgICAgICAgIEBwYXNzYWdlcyA9IFtdCiAgICAgICAgICAgIGZvciBwYXNzYWdlIGluIEBjdXJyZW50UGFnZS5wYXNzYWdlcy5wYXNzYWdlcwogICAgICAgICAgICAgICAgQHBhc3NhZ2VzW3Bhc3NhZ2UudGVycmFpbklkXSA9IHBhc3NhZ2UucGFzc2FnZQogICAgICAgIGVsc2UKICAgICAgICAgICAgQHBhc3NhZ2VzID0gbnVsbAogICAgICAgIAogICAgICAgIAogICAgICAgIEBwYXR0ZXJuID0gMCNyb3cgKiA0ICsgY29sdW1uCiAgICAgICAgQHN1YlBhdHRlcm4gPSBwYXR0ZXJuICNyb3cgKiA0ICsgY29sdW1uICNNYXRoLmZsb29yKHBhdHRlcm4gLyAxMiAlIDQpICogMyArIChwYXR0ZXJuICUgMykKICAgICAgICBAZ3JhcGhpY1BhdHRlcm4gPSBwYXR0ZXJuCiAgICAgICAgCiAgICAgICAgc3dpdGNoIChNYXRoLmZsb29yKEBzdWJQYXR0ZXJuIC8gNCkpCiAgICAgICAgICAgIHdoZW4gMCB0aGVuIEBkaXJlY3Rpb24gPSAyCiAgICAgICAgICAgIHdoZW4gMSB0aGVuIEBkaXJlY3Rpb24gPSA0CiAgICAgICAgICAgIHdoZW4gMiB0aGVuIEBkaXJlY3Rpb24gPSA4CiAgICAgICAgICAgIHdoZW4gMyB0aGVuIEBkaXJlY3Rpb24gPSA2CiAgICAKICAgICAgICAKICAgICAgICByb3V0ZSA9IG51bGwKICAgICAgICAKICAgICAgICBzd2l0Y2ggQGN1cnJlbnRQYWdlLm1vdmVtZW50VHlwZQogICAgICAgICAgICB3aGVuIDEgIyBSYW5kb20KICAgICAgICAgICAgICAgIHJvdXRlID0gQHByZWRlZmluZWRSb3V0ZXNbQGN1cnJlbnRQYWdlLm1vdmVtZW50VHlwZS0xXQogICAgICAgICAgICB3aGVuIDIgIyBUb3dhcmQgUGxheWVyCiAgICAgICAgICAgICAgICByb3V0ZSA9IEBwcmVkZWZpbmVkUm91dGVzW0BjdXJyZW50UGFnZS5tb3ZlbWVudFR5cGUtMV0KICAgICAgICAgICAgd2hlbiAzICMgUm91dGUKICAgICAgICAgICAgICAgIHJvdXRlID0gQGN1cnJlbnRQYWdlLnJvdXRlCiAgICAgICAgICAKICAgICAgICBAYXV0b01vdmVtZW50Um91dGUgPSByb3V0ZSAgICAgIAogICAgICAgIEBtb3ZlUm91dGVGcmVxdWVuY3kgPSBpZiBAY3VycmVudFBhZ2UuZnJlcXVlbmN5PyB0aGVuIEBtb3ZlUm91dGVGcmVxdWVuY2llc1tAY3VycmVudFBhZ2UuZnJlcXVlbmN5XSBlbHNlIEBtb3ZlUm91dGVGcmVxdWVuY2llc1syXQogICAgICAgIEBtb3ZlUm91dGUocm91dGUpCiAgICAgICAgCiAgICAgICAgCiAgICAKICAgICAgICBpZiBAc3RhcnRDb25kaXRpb24gPT0gNCB0aGVuIEBzdGFydCgpCiAgICBjaGVja1BhZ2VDb25kaXRpb25zOiAocGFnZSkgLT4KICAgICAgICByZXN1bHQgPSB5ZXMKICAgICAgICBzdG9yZSA9IEdhbWVNYW5hZ2VyLnZhcmlhYmxlU3RvcmUKICAgICAgICAKICAgICAgICBpZiBwYWdlLnZhcmlhYmxlRW5hYmxlZDEKICAgICAgICAgICAgcmVzdWx0ID0gc3RvcmUubnVtYmVyVmFsdWVPZihwYWdlLnZhcmlhYmxlMSkgPT0gcGFnZS52YXJpYWJsZVZhbHVlMQogICAgICAgIGlmIHJlc3VsdCBhbmQgcGFnZS52YXJpYWJsZUVuYWJsZWQyCiAgICAgICAgICAgIHJlc3VsdCA9IHN0b3JlLm51bWJlclZhbHVlT2YocGFnZS52YXJpYWJsZTIpID09IHBhZ2UudmFyaWFibGVWYWx1ZTIKICAgICAgICBpZiByZXN1bHQgYW5kIHBhZ2Uuc3dpdGNoRW5hYmxlZDEKICAgICAgICAgICAgcmVzdWx0ID0gc3RvcmUuYm9vbGVhblZhbHVlT2YocGFnZS5zd2l0Y2gxKSA9PSBwYWdlLnN3aXRjaFZhbHVlMQogICAgICAgIAogICAgICAgIHJldHVybiByZXN1bHQKICAgICAgICAgICAgCiAgICBlcmFzZTogLT4KICAgICAgICBpbmRleCA9IEdhbWVNYW5hZ2VyLm1hcC5ldmVudHMuaW5kZXhPZih0aGlzKQogICAgICAgIGlmIGluZGV4ID09IC0xIHRoZW4gcmV0dXJuCiAgICAgICAgCiAgICAgICAgdHggPSBNYXRoLmZsb29yKEB4IC8gR2FtZU1hbmFnZXIubWFwLnRpbGVTaXplKQogICAgICAgIHR5ID0gTWF0aC5mbG9vcihAeSAvIEdhbWVNYW5hZ2VyLm1hcC50aWxlU2l6ZSkKICAgIAogICAgICAgIEBjb2xsaXNpb25NYXBbdHkgKiBAbWFwLndpZHRoICsgdHhdLnJlbW92ZSh0aGlzKQogICAgICAgIEdhbWVNYW5hZ2VyLm1hcC5ldmVudHMucmVtb3ZlKHRoaXMpCiAgICAgICAgZGVsZXRlIEdhbWVNYW5hZ2VyLm1hcC5ldmVudHNCeUlkW0BpZF0KICAgIAogICAgb25Nb3ZlRmluaXNoOiAtPgogICAgICAgIGlmIEBldmVudHNUb1N0YXJ0PwogICAgICAgICAgICBmb3IgZXZlbnQgaW4gQGV2ZW50c1RvU3RhcnQKICAgICAgICAgICAgICAgIGV2ZW50LnN0YXJ0KCkKICAgICAgICAgICAgQGV2ZW50c1RvU3RhcnQgPSBbXQogICAgICAgICAgICAKICAgIG1vdmU6IChkaXJlY3Rpb24pIC0+CiAgICAgICAgY2FuID0gQGNhbk1vdmUoZGlyZWN0aW9uKQogICAgICAgIGlmIG5vdCBAaXNNb3ZpbmcgYW5kIG5vdCBAaXNMb2NrZWQKICAgICAgICAgICAgcG9zaXRpb24gPSBAbmV4dFBvc2l0aW9uSW5kZXgoZGlyZWN0aW9uKQogICAgICAgICAgICBldmVudHMgPSBAY29sbGlzaW9uTWFwW3Bvc2l0aW9uXQogICAgICAgICAgICBAZXZlbnRzVG9TdGFydCA9IFtdCiAgICAgICAgICAgIGlmIGNhbgogICAgICAgICAgICAgICAgaWYgZXZlbnRzPwogICAgICAgICAgICAgICAgICAgIGZvciBldmVudCBpbiBldmVudHMKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50LmlzUGxheWVyIGFuZCBAc3RhcnRDb25kaXRpb24gPT0gMikgb3IgQHN0YXJ0Q29uZGl0aW9uID09IDMKICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBldmVudHNUb1N0YXJ0LnB1c2godGhpcykKICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIEBpc1BsYXllciBhbmQgKGV2ZW50LnN0YXJ0Q29uZGl0aW9uID09IDMgb3IgZXZlbnQuc3RhcnRDb25kaXRpb24gPT0gMiBvciBldmVudC5zdGFydENvbmRpdGlvbiA9PSAxKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgQGV2ZW50c1RvU3RhcnQucHVzaChldmVudCkKICAgICAgICAgICAgICAgIGNhbiA9IHN1cGVyKGRpcmVjdGlvbikKICAgICAgICAgICAgICAgIGlmIGNhbiB0aGVuIEBvcmlnaW5hbERpcmVjdGlvbiA9IG51bGwKICAgICAgICAgICAgICAgIGlmIEByb3V0ZT8gYW5kIEByb3V0ZSA9PSBAYXV0b01vdmVtZW50Um91dGUgdGhlbiBAcm91dGVXYWl0Q291bnRlciA9IEBtb3ZlUm91dGVGcmVxdWVuY3kKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgaWYgZXZlbnRzPwogICAgICAgICAgICAgICAgICAgIGZvciBldmVudCBpbiBldmVudHMKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50LmlzUGxheWVyIGFuZCBAc3RhcnRDb25kaXRpb24gPT0gMikgb3IgQHN0YXJ0Q29uZGl0aW9uID09IDMKICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBzdGFydCgpCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIEBpc1BsYXllciBhbmQgKGV2ZW50LnN0YXJ0Q29uZGl0aW9uID09IDMgb3IgZXZlbnQuc3RhcnRDb25kaXRpb24gPT0gMiBvciBldmVudC5zdGFydENvbmRpdGlvbiA9PSAxKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQuc3RhcnQoKQogICAgICAgIGVsc2UKICAgICAgICAgICAgY2FuID0gbm8KICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgIHJldHVybiBjYW4KICAgICAgICAKICAgICAgICAKd2luZG93LkxvZ2ljX0V2ZW50ID0gTG9naWNfRXZlbnQ=","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBMb2dpY19FdmVudCwKICAgIF9faGFzUHJvcCA9IHt9Lmhhc093blByb3BlcnR5LAogICAgX19leHRlbmRzID0gZnVuY3Rpb24oY2hpbGQsIHBhcmVudCkgeyBmb3IgKHZhciBrZXkgaW4gcGFyZW50KSB7IGlmIChfX2hhc1Byb3AuY2FsbChwYXJlbnQsIGtleSkpIGNoaWxkW2tleV0gPSBwYXJlbnRba2V5XTsgfSBmdW5jdGlvbiBjdG9yKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gY2hpbGQ7IH0gY3Rvci5wcm90b3R5cGUgPSBwYXJlbnQucHJvdG90eXBlOyBjaGlsZC5wcm90b3R5cGUgPSBuZXcgY3RvcigpOyBjaGlsZC5fX3N1cGVyX18gPSBwYXJlbnQucHJvdG90eXBlOyByZXR1cm4gY2hpbGQ7IH07CgogIExvZ2ljX0V2ZW50ID0gKGZ1bmN0aW9uKF9zdXBlcikgewogICAgX19leHRlbmRzKExvZ2ljX0V2ZW50LCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIExvZ2ljX0V2ZW50KGV2ZW50LCBpZCkgewogICAgICB2YXIgaSwgbWFwSWQsIG1hcFgsIG1hcFksIHBhZ2UsIHBhZ2VzLCBwYXJhbWV0ZXIsIHBhcmFtZXRlcnMsIHZhbHVlLCBfaSwgX2osIF9sZW4sIF9yZWY7CiAgICAgIExvZ2ljX0V2ZW50Ll9fc3VwZXJfXy5jb25zdHJ1Y3Rvci5jYWxsKHRoaXMpOwogICAgICB0aGlzLmlkID0gaWQ7CiAgICAgIHRoaXMuZXZlbnQgPSBldmVudDsKICAgICAgdGhpcy54ID0gZXZlbnQueCAqICgkUEFSQU1TLnJlc29sdXRpb24ud2lkdGggPT09IDMyMCA/IDE2IDogMzIpOwogICAgICB0aGlzLnkgPSBldmVudC55ICogKCRQQVJBTVMucmVzb2x1dGlvbi53aWR0aCA9PT0gMzIwID8gMTYgOiAzMik7CiAgICAgIHRoaXMucGFnZXMgPSBbCiAgICAgICAgewogICAgICAgICAgbmFtZTogIklOVklTSUJMRSIsCiAgICAgICAgICB3YWxrVGhyb3VnaDogdHJ1ZSwKICAgICAgICAgIGNvbW1hbmRzOiBbXSwKICAgICAgICAgIHN0YXJ0Q29uZGl0aW9uOiAwCiAgICAgICAgfQogICAgICBdOwogICAgICBwYWdlcyA9IG51bGw7CiAgICAgIGlmIChldmVudC50ZW1wbGF0ZUlkICE9IG51bGwpIHsKICAgICAgICB0aGlzLnRlbXBsYXRlID0gUmVjb3JkTWFuYWdlci5ldmVudFRlbXBsYXRlc1tldmVudC50ZW1wbGF0ZUlkXTsKICAgICAgICBwYWdlcyA9IHRoaXMudGVtcGxhdGUucGFnZXM7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcGFnZXMgPSBldmVudC5wYWdlcyB8fCBbXTsKICAgICAgfQogICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IHBhZ2VzLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7CiAgICAgICAgcGFnZSA9IHBhZ2VzW19pXTsKICAgICAgICB0aGlzLnBhZ2VzLnB1c2gocGFnZSk7CiAgICAgIH0KICAgICAgaWYgKHRoaXMucGFnZXMubGVuZ3RoID09PSAxKSB7CiAgICAgICAgdGhpcy5wYWdlcy5wdXNoKHt9KTsKICAgICAgfQogICAgICB0aGlzLmxheWVyID0gMTsKICAgICAgdGhpcy5pbnRlcnByZXRlciA9IG51bGw7CiAgICAgIHRoaXMuYXV0b01vdmVtZW50Um91dGUgPSBudWxsOwogICAgICB0aGlzLnN3aXRjaFBhZ2UodGhpcy5wYWdlc1sxXSk7CiAgICAgIHRoaXMubG9jYWxOdW1iZXJzID0gZXZlbnQubG9jYWxOdW1iZXJzIHx8IFtdOwogICAgICB0aGlzLmxvY2FsQm9vbGVhbnMgPSBldmVudC5sb2NhbEJvb2xlYW5zIHx8IFtdOwogICAgICB0aGlzLmxvY2FsU3RyaW5ncyA9IGV2ZW50LmxvY2FsU3RyaW5ncyB8fCBbXTsKICAgICAgcGFyYW1ldGVycyA9IHRoaXMuZXZlbnQucGFyYW1ldGVyczsKICAgICAgaWYgKChwYXJhbWV0ZXJzICE9IG51bGwpICYmIChwYXJhbWV0ZXJzLnZhbHVlcyAhPSBudWxsKSkgewogICAgICAgIGZvciAoaSA9IF9qID0gMCwgX3JlZiA9IHBhcmFtZXRlcnMudmFsdWVzLmxlbmd0aDsgMCA8PSBfcmVmID8gX2ogPCBfcmVmIDogX2ogPiBfcmVmOyBpID0gMCA8PSBfcmVmID8gKytfaiA6IC0tX2opIHsKICAgICAgICAgIHZhbHVlID0gcGFyYW1ldGVycy52YWx1ZXNbaV07CiAgICAgICAgICBwYXJhbWV0ZXIgPSB0aGlzLnRlbXBsYXRlLnBhcmFtZXRlcnNbaV07CiAgICAgICAgICBpZiAoKHBhcmFtZXRlciAhPSBudWxsKSAmJiAodmFsdWUgIT0gbnVsbCkpIHsKICAgICAgICAgICAgc3dpdGNoIChwYXJhbWV0ZXIudHlwZSkgewogICAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICAgIHZhbHVlID0gR2FtZU1hbmFnZXIudmFyaWFibGVTdG9yZS5udW1iZXJWYWx1ZU9mKHZhbHVlKTsKICAgICAgICAgICAgICAgIEdhbWVNYW5hZ2VyLnZhcmlhYmxlU3RvcmUuc2V0TnVtYmVyVmFsdWVUbyhwYXJhbWV0ZXIubnVtYmVyVmFyaWFibGUsIHZhbHVlLCBpZCwgR2FtZU1hbmFnZXIubWFwLmlkKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgIHZhbHVlID0gR2FtZU1hbmFnZXIudmFyaWFibGVTdG9yZS5ib29sZWFuVmFsdWVPZih2YWx1ZSk7CiAgICAgICAgICAgICAgICBHYW1lTWFuYWdlci52YXJpYWJsZVN0b3JlLnNldEJvb2xlYW5WYWx1ZVRvKHBhcmFtZXRlci5ib29sZWFuVmFyaWFibGUsIHZhbHVlLCBpZCwgR2FtZU1hbmFnZXIubWFwLmlkKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIHZhbHVlID0gR2FtZU1hbmFnZXIudmFyaWFibGVTdG9yZS5zdHJpbmdWYWx1ZU9mKHZhbHVlKTsKICAgICAgICAgICAgICAgIEdhbWVNYW5hZ2VyLnZhcmlhYmxlU3RvcmUuc2V0U3RyaW5nVmFsdWVUbyhwYXJhbWV0ZXIuc3RyaW5nVmFyaWFibGUsIHZhbHVlLCBpZCwgR2FtZU1hbmFnZXIubWFwLmlkKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgIG1hcElkID0gR2FtZU1hbmFnZXIudmFyaWFibGVTdG9yZS5zdHJpbmdWYWx1ZU9mKHZhbHVlLm1hcC51aWQpOwogICAgICAgICAgICAgICAgbWFwWCA9IEdhbWVNYW5hZ2VyLnZhcmlhYmxlU3RvcmUuc3RyaW5nVmFsdWVPZih2YWx1ZS5sb2NhdGlvbi54KTsKICAgICAgICAgICAgICAgIG1hcFkgPSBHYW1lTWFuYWdlci52YXJpYWJsZVN0b3JlLnN0cmluZ1ZhbHVlT2YodmFsdWUubG9jYXRpb24ueSk7CiAgICAgICAgICAgICAgICBHYW1lTWFuYWdlci52YXJpYWJsZVN0b3JlLnNldFN0cmluZ1ZhbHVlVG8ocGFyYW1ldGVyLm1hcFVpZFZhcmlhYmxlLCBtYXBJZCwgaWQsIEdhbWVNYW5hZ2VyLm1hcC5pZCk7CiAgICAgICAgICAgICAgICBHYW1lTWFuYWdlci52YXJpYWJsZVN0b3JlLnNldE51bWJlclZhbHVlVG8ocGFyYW1ldGVyLm1hcFZhcmlhYmxlWCwgbWFwWCwgaWQsIEdhbWVNYW5hZ2VyLm1hcC5pZCk7CiAgICAgICAgICAgICAgICBHYW1lTWFuYWdlci52YXJpYWJsZVN0b3JlLnNldE51bWJlclZhbHVlVG8ocGFyYW1ldGVyLm1hcFZhcmlhYmxlWSwgbWFwWSwgaWQsIEdhbWVNYW5hZ2VyLm1hcC5pZCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBMb2dpY19FdmVudC5wcm90b3R5cGUuc3RhcnQgPSBmdW5jdGlvbigpIHsKICAgICAgaWYgKHRoaXMuaXNNb3ZpbmcpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdGhpcy5pbnRlcnByZXRlciA9ICF0aGlzLnBhcmFsbGVsID8gR2FtZU1hbmFnZXIuaW50ZXJwcmV0ZXIgOiB0aGlzLmludGVycHJldGVyOwogICAgICBpZiAoKHRoaXMuaW50ZXJwcmV0ZXIgIT0gbnVsbCkgJiYgIXRoaXMuaW50ZXJwcmV0ZXIuaXNSdW5uaW5nICYmIHRoaXMuY3VycmVudFBhZ2UuY29tbWFuZHMgJiYgdGhpcy5jdXJyZW50UGFnZS5jb21tYW5kcy5sZW5ndGggPiAxKSB7CiAgICAgICAgdGhpcy5pbnRlcnByZXRlci5yZXBlYXQgPSB0aGlzLnN0YXJ0Q29uZGl0aW9uID09PSA0OwogICAgICAgIHRoaXMuaW50ZXJwcmV0ZXIuY29tbWFuZHMgPSB0aGlzLmN1cnJlbnRQYWdlLmNvbW1hbmRzOwogICAgICAgIHRoaXMuaW50ZXJwcmV0ZXIucGFyZW50T2JqZWN0ID0gdGhpczsKICAgICAgICB0aGlzLmludGVycHJldGVyLnN0YXJ0KCk7CiAgICAgICAgaWYgKCF0aGlzLmRpcmVjdGlvbkZpeGVkICYmICh0aGlzLnN0YXJ0Q29uZGl0aW9uID49IDAgfHwgdGhpcy5zdGFydENvbmRpdGlvbiA8PSAxKSkgewogICAgICAgICAgdGhpcy5vcmlnaW5hbERpcmVjdGlvbiA9IHRoaXMuZGlyZWN0aW9uOwogICAgICAgICAgcmV0dXJuIHRoaXMuZGlyZWN0aW9uID0gKChHYW1lTWFuYWdlci5wbGF5ZXIuZGlyZWN0aW9uICsgNCkgJSA4KSB8fCA4OwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gdGhpcy5pbnRlcnByZXRlciA9IG51bGw7CiAgICAgIH0KICAgIH07CgogICAgTG9naWNfRXZlbnQucHJvdG90eXBlLnN0b3AgPSBmdW5jdGlvbigpIHsKICAgICAgdGhpcy5pbnRlcnByZXRlciA9ICF0aGlzLnBhcmFsbGVsID8gR2FtZU1hbmFnZXIuaW50ZXJwcmV0ZXIgOiB0aGlzLmludGVycHJldGVyOwogICAgICBpZiAoKHRoaXMuaW50ZXJwcmV0ZXIgIT0gbnVsbCkgJiYgdGhpcy5pbnRlcnByZXRlci5pc1J1bm5pbmcpIHsKICAgICAgICByZXR1cm4gdGhpcy5pbnRlcnByZXRlci5zdG9wKCk7CiAgICAgIH0KICAgIH07CgogICAgTG9naWNfRXZlbnQucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgcGFnZSwgX2ksIF9yZWYsIF9yZXN1bHRzOwogICAgICBMb2dpY19FdmVudC5fX3N1cGVyX18udXBkYXRlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIGlmICh0aGlzLmludGVycHJldGVyICE9IG51bGwpIHsKICAgICAgICBpZiAodGhpcy5pbnRlcnByZXRlci5wYXJlbnRPYmplY3QgIT0gbnVsbCkgewogICAgICAgICAgdGhpcy5pbnRlcnByZXRlci5wYXJlbnRPYmplY3QuaXNMb2NrZWQgPSB0cnVlOwogICAgICAgIH0KICAgICAgICB0aGlzLmludGVycHJldGVyLnVwZGF0ZSgpOwogICAgICB9IGVsc2UgaWYgKCh0aGlzLm9yaWdpbmFsRGlyZWN0aW9uICE9IG51bGwpICYmICF0aGlzLmlzTW92aW5nKSB7CiAgICAgICAgdGhpcy5kaXJlY3Rpb24gPSB0aGlzLm9yaWdpbmFsRGlyZWN0aW9uOwogICAgICAgIHRoaXMub3JpZ2luYWxEaXJlY3Rpb24gPSBudWxsOwogICAgICB9CiAgICAgIGlmICgodGhpcy5pbnRlcnByZXRlciAhPSBudWxsKSAmJiAhdGhpcy5pbnRlcnByZXRlci5pc1J1bm5pbmcgJiYgIXRoaXMucGFyYWxsZWwpIHsKICAgICAgICBpZiAodGhpcy5pbnRlcnByZXRlci5wYXJlbnRPYmplY3QgIT0gbnVsbCkgewogICAgICAgICAgdGhpcy5pbnRlcnByZXRlci5wYXJlbnRPYmplY3QuaXNMb2NrZWQgPSBmYWxzZTsKICAgICAgICB9CiAgICAgICAgdGhpcy5pbnRlcnByZXRlciA9IG51bGw7CiAgICAgIH0KICAgICAgX3JlZiA9IHRoaXMucGFnZXM7CiAgICAgIF9yZXN1bHRzID0gW107CiAgICAgIGZvciAoX2kgPSBfcmVmLmxlbmd0aCAtIDE7IF9pID49IDA7IF9pICs9IC0xKSB7CiAgICAgICAgcGFnZSA9IF9yZWZbX2ldOwogICAgICAgIGlmICh0aGlzLmNoZWNrUGFnZUNvbmRpdGlvbnMocGFnZSkpIHsKICAgICAgICAgIHRoaXMuc3dpdGNoUGFnZShwYWdlKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBfcmVzdWx0cy5wdXNoKHZvaWQgMCk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiBfcmVzdWx0czsKICAgIH07CgogICAgTG9naWNfRXZlbnQucHJvdG90eXBlLnN1YlBhdHRlcm5Db2x1bW4gPSBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIHRoaXMuZ3JhcGhpY1BhdHRlcm4gJSA0OwogICAgfTsKCiAgICBMb2dpY19FdmVudC5wcm90b3R5cGUuc3dpdGNoUGFnZSA9IGZ1bmN0aW9uKHBhZ2UpIHsKICAgICAgdmFyIGNvbHVtbiwgaW5kZXgsIHBhc3NhZ2UsIHBhdHRlcm4sIHJvdXRlLCByb3csIF9pLCBfbGVuLCBfcmVmOwogICAgICBpZiAodGhpcy5jdXJyZW50UGFnZSA9PT0gcGFnZSkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBpZiAodGhpcy5pbnRlcnByZXRlciAhPSBudWxsKSB7CiAgICAgICAgdGhpcy5pbnRlcnByZXRlci5zdG9wKCk7CiAgICAgICAgdGhpcy5pbnRlcnByZXRlci5yZXBlYXQgPSBmYWxzZTsKICAgICAgICB0aGlzLmludGVycHJldGVyID0gbnVsbDsKICAgICAgfQogICAgICB0aGlzLmN1cnJlbnRQYWdlID0gcGFnZTsKICAgICAgdGhpcy5zdGFydENvbmRpdGlvbiA9IHRoaXMuY3VycmVudFBhZ2Uuc3RhcnRDb25kaXRpb24gIT0gbnVsbCA/IHRoaXMuY3VycmVudFBhZ2Uuc3RhcnRDb25kaXRpb24gOiAwOwogICAgICB0aGlzLm1vdmVTcGVlZCA9IHRoaXMuY3VycmVudFBhZ2Uuc3BlZWQgIT0gbnVsbCA/IHRoaXMuc3BlZWRzW3RoaXMuY3VycmVudFBhZ2Uuc3BlZWRdIDogdGhpcy5zcGVlZHNbMl07CiAgICAgIHRoaXMuZnJlcXVlbmN5ID0gdGhpcy5jdXJyZW50UGFnZS5zcGVlZCAhPSBudWxsID8gdGhpcy5mcmVxdWVuY2llc1t0aGlzLmN1cnJlbnRQYWdlLnNwZWVkXSA6IHRoaXMuZnJlcXVlbmNpZXNbMl07CiAgICAgIHRoaXMud2Fsa2luZ0FuaW1hdGlvbiA9IHRoaXMuY3VycmVudFBhZ2Uud2Fsa2luZ0FuaW1hdGlvbiAhPSBudWxsID8gdGhpcy5jdXJyZW50UGFnZS53YWxraW5nQW5pbWF0aW9uIDogdHJ1ZTsKICAgICAgdGhpcy5zdGVwcGluZ0FuaW1hdGlvbiA9IHRoaXMuY3VycmVudFBhZ2Uuc3RlcHBpbmdBbmltYXRpb24gIT0gbnVsbCA/IHRoaXMuY3VycmVudFBhZ2Uuc3RlcHBpbmdBbmltYXRpb24gOiBmYWxzZTsKICAgICAgdGhpcy50aHJvdWdoID0gdGhpcy5jdXJyZW50UGFnZS53YWxrVGhyb3VnaCAhPSBudWxsID8gdGhpcy5jdXJyZW50UGFnZS53YWxrVGhyb3VnaCA6IGZhbHNlOwogICAgICB0aGlzLmRpcmVjdGlvbkZpeGVkID0gdGhpcy5jdXJyZW50UGFnZS5kaXJlY3Rpb25GaXhlZCAhPSBudWxsID8gdGhpcy5jdXJyZW50UGFnZS5kaXJlY3Rpb25GaXhlZCA6IGZhbHNlOwogICAgICB0aGlzLnBhcmFsbGVsID0gdGhpcy5jdXJyZW50UGFnZS5wYXJhbGxlbCAhPSBudWxsID8gdGhpcy5jdXJyZW50UGFnZS5wYXJhbGxlbCA6IGZhbHNlOwogICAgICB0aGlzLmludGVycHJldGVyID0gdGhpcy5wYXJhbGxlbCA/IG5ldyBDb21tYW5kSW50ZXJwcmV0ZXIodGhpcy5jdXJyZW50UGFnZS5jb21tYW5kcykgOiBudWxsOwogICAgICB0aGlzLmxheWVyID0gdGhpcy5jdXJyZW50UGFnZS5sYXllciAhPSBudWxsID8gdGhpcy5jdXJyZW50UGFnZS5sYXllciA6IDE7CiAgICAgIHBhdHRlcm4gPSAwOwogICAgICBpbmRleCA9IHRoaXMucGFnZXMuaW5kZXhPZih0aGlzLmN1cnJlbnRQYWdlKTsKICAgICAgaWYgKCh0aGlzLmV2ZW50LnBhZ2VEYXRhICE9IG51bGwpICYmIHRoaXMuZXZlbnQucGFnZURhdGEubGVuZ3RoID4gaW5kZXggJiYgKHRoaXMuZXZlbnQucGFnZURhdGFbaW5kZXhdLmdyYXBoaWMgIT0gbnVsbCkpIHsKICAgICAgICB0aGlzLmdyYXBoaWMgPSB0aGlzLmV2ZW50LnBhZ2VEYXRhW2luZGV4XS5ncmFwaGljOwogICAgICAgIHBhdHRlcm4gPSB0aGlzLmV2ZW50LnBhZ2VEYXRhW2luZGV4XS5wYXR0ZXJuOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuZ3JhcGhpYyA9IHRoaXMuY3VycmVudFBhZ2UuZ3JhcGhpYzsKICAgICAgICBwYXR0ZXJuID0gdGhpcy5jdXJyZW50UGFnZS5ncmFwaGljUGF0dGVybjsKICAgICAgfQogICAgICBjb2x1bW4gPSBNYXRoLmZsb29yKHBhdHRlcm4gJSA0KTsKICAgICAgcm93ID0gTWF0aC5mbG9vcihwYXR0ZXJuIC8gNCk7CiAgICAgIGlmICh0aGlzLmN1cnJlbnRQYWdlLnBhc3NhZ2VzICYmIHRoaXMuY3VycmVudFBhZ2UucGFzc2FnZXMucGFzc2FnZXMubGVuZ3RoID4gMCkgewogICAgICAgIHRoaXMucGFzc2FnZXMgPSBbXTsKICAgICAgICBfcmVmID0gdGhpcy5jdXJyZW50UGFnZS5wYXNzYWdlcy5wYXNzYWdlczsKICAgICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICAgIHBhc3NhZ2UgPSBfcmVmW19pXTsKICAgICAgICAgIHRoaXMucGFzc2FnZXNbcGFzc2FnZS50ZXJyYWluSWRdID0gcGFzc2FnZS5wYXNzYWdlOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnBhc3NhZ2VzID0gbnVsbDsKICAgICAgfQogICAgICB0aGlzLnBhdHRlcm4gPSAwOwogICAgICB0aGlzLnN1YlBhdHRlcm4gPSBwYXR0ZXJuOwogICAgICB0aGlzLmdyYXBoaWNQYXR0ZXJuID0gcGF0dGVybjsKICAgICAgc3dpdGNoIChNYXRoLmZsb29yKHRoaXMuc3ViUGF0dGVybiAvIDQpKSB7CiAgICAgICAgY2FzZSAwOgogICAgICAgICAgdGhpcy5kaXJlY3Rpb24gPSAyOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAxOgogICAgICAgICAgdGhpcy5kaXJlY3Rpb24gPSA0OwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAyOgogICAgICAgICAgdGhpcy5kaXJlY3Rpb24gPSA4OwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAzOgogICAgICAgICAgdGhpcy5kaXJlY3Rpb24gPSA2OwogICAgICB9CiAgICAgIHJvdXRlID0gbnVsbDsKICAgICAgc3dpdGNoICh0aGlzLmN1cnJlbnRQYWdlLm1vdmVtZW50VHlwZSkgewogICAgICAgIGNhc2UgMToKICAgICAgICAgIHJvdXRlID0gdGhpcy5wcmVkZWZpbmVkUm91dGVzW3RoaXMuY3VycmVudFBhZ2UubW92ZW1lbnRUeXBlIC0gMV07CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDI6CiAgICAgICAgICByb3V0ZSA9IHRoaXMucHJlZGVmaW5lZFJvdXRlc1t0aGlzLmN1cnJlbnRQYWdlLm1vdmVtZW50VHlwZSAtIDFdOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAzOgogICAgICAgICAgcm91dGUgPSB0aGlzLmN1cnJlbnRQYWdlLnJvdXRlOwogICAgICB9CiAgICAgIHRoaXMuYXV0b01vdmVtZW50Um91dGUgPSByb3V0ZTsKICAgICAgdGhpcy5tb3ZlUm91dGVGcmVxdWVuY3kgPSB0aGlzLmN1cnJlbnRQYWdlLmZyZXF1ZW5jeSAhPSBudWxsID8gdGhpcy5tb3ZlUm91dGVGcmVxdWVuY2llc1t0aGlzLmN1cnJlbnRQYWdlLmZyZXF1ZW5jeV0gOiB0aGlzLm1vdmVSb3V0ZUZyZXF1ZW5jaWVzWzJdOwogICAgICB0aGlzLm1vdmVSb3V0ZShyb3V0ZSk7CiAgICAgIGlmICh0aGlzLnN0YXJ0Q29uZGl0aW9uID09PSA0KSB7CiAgICAgICAgcmV0dXJuIHRoaXMuc3RhcnQoKTsKICAgICAgfQogICAgfTsKCiAgICBMb2dpY19FdmVudC5wcm90b3R5cGUuY2hlY2tQYWdlQ29uZGl0aW9ucyA9IGZ1bmN0aW9uKHBhZ2UpIHsKICAgICAgdmFyIHJlc3VsdCwgc3RvcmU7CiAgICAgIHJlc3VsdCA9IHRydWU7CiAgICAgIHN0b3JlID0gR2FtZU1hbmFnZXIudmFyaWFibGVTdG9yZTsKICAgICAgaWYgKHBhZ2UudmFyaWFibGVFbmFibGVkMSkgewogICAgICAgIHJlc3VsdCA9IHN0b3JlLm51bWJlclZhbHVlT2YocGFnZS52YXJpYWJsZTEpID09PSBwYWdlLnZhcmlhYmxlVmFsdWUxOwogICAgICB9CiAgICAgIGlmIChyZXN1bHQgJiYgcGFnZS52YXJpYWJsZUVuYWJsZWQyKSB7CiAgICAgICAgcmVzdWx0ID0gc3RvcmUubnVtYmVyVmFsdWVPZihwYWdlLnZhcmlhYmxlMikgPT09IHBhZ2UudmFyaWFibGVWYWx1ZTI7CiAgICAgIH0KICAgICAgaWYgKHJlc3VsdCAmJiBwYWdlLnN3aXRjaEVuYWJsZWQxKSB7CiAgICAgICAgcmVzdWx0ID0gc3RvcmUuYm9vbGVhblZhbHVlT2YocGFnZS5zd2l0Y2gxKSA9PT0gcGFnZS5zd2l0Y2hWYWx1ZTE7CiAgICAgIH0KICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH07CgogICAgTG9naWNfRXZlbnQucHJvdG90eXBlLmVyYXNlID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBpbmRleCwgdHgsIHR5OwogICAgICBpbmRleCA9IEdhbWVNYW5hZ2VyLm1hcC5ldmVudHMuaW5kZXhPZih0aGlzKTsKICAgICAgaWYgKGluZGV4ID09PSAtMSkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICB0eCA9IE1hdGguZmxvb3IodGhpcy54IC8gR2FtZU1hbmFnZXIubWFwLnRpbGVTaXplKTsKICAgICAgdHkgPSBNYXRoLmZsb29yKHRoaXMueSAvIEdhbWVNYW5hZ2VyLm1hcC50aWxlU2l6ZSk7CiAgICAgIHRoaXMuY29sbGlzaW9uTWFwW3R5ICogdGhpcy5tYXAud2lkdGggKyB0eF0ucmVtb3ZlKHRoaXMpOwogICAgICBHYW1lTWFuYWdlci5tYXAuZXZlbnRzLnJlbW92ZSh0aGlzKTsKICAgICAgcmV0dXJuIGRlbGV0ZSBHYW1lTWFuYWdlci5tYXAuZXZlbnRzQnlJZFt0aGlzLmlkXTsKICAgIH07CgogICAgTG9naWNfRXZlbnQucHJvdG90eXBlLm9uTW92ZUZpbmlzaCA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgZXZlbnQsIF9pLCBfbGVuLCBfcmVmOwogICAgICBpZiAodGhpcy5ldmVudHNUb1N0YXJ0ICE9IG51bGwpIHsKICAgICAgICBfcmVmID0gdGhpcy5ldmVudHNUb1N0YXJ0OwogICAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gX3JlZi5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykgewogICAgICAgICAgZXZlbnQgPSBfcmVmW19pXTsKICAgICAgICAgIGV2ZW50LnN0YXJ0KCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0aGlzLmV2ZW50c1RvU3RhcnQgPSBbXTsKICAgICAgfQogICAgfTsKCiAgICBMb2dpY19FdmVudC5wcm90b3R5cGUubW92ZSA9IGZ1bmN0aW9uKGRpcmVjdGlvbikgewogICAgICB2YXIgY2FuLCBldmVudCwgZXZlbnRzLCBwb3NpdGlvbiwgX2ksIF9qLCBfbGVuLCBfbGVuMTsKICAgICAgY2FuID0gdGhpcy5jYW5Nb3ZlKGRpcmVjdGlvbik7CiAgICAgIGlmICghdGhpcy5pc01vdmluZyAmJiAhdGhpcy5pc0xvY2tlZCkgewogICAgICAgIHBvc2l0aW9uID0gdGhpcy5uZXh0UG9zaXRpb25JbmRleChkaXJlY3Rpb24pOwogICAgICAgIGV2ZW50cyA9IHRoaXMuY29sbGlzaW9uTWFwW3Bvc2l0aW9uXTsKICAgICAgICB0aGlzLmV2ZW50c1RvU3RhcnQgPSBbXTsKICAgICAgICBpZiAoY2FuKSB7CiAgICAgICAgICBpZiAoZXZlbnRzICE9IG51bGwpIHsKICAgICAgICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBldmVudHMubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICAgICAgICBldmVudCA9IGV2ZW50c1tfaV07CiAgICAgICAgICAgICAgaWYgKChldmVudC5pc1BsYXllciAmJiB0aGlzLnN0YXJ0Q29uZGl0aW9uID09PSAyKSB8fCB0aGlzLnN0YXJ0Q29uZGl0aW9uID09PSAzKSB7CiAgICAgICAgICAgICAgICB0aGlzLmV2ZW50c1RvU3RhcnQucHVzaCh0aGlzKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgaWYgKHRoaXMuaXNQbGF5ZXIgJiYgKGV2ZW50LnN0YXJ0Q29uZGl0aW9uID09PSAzIHx8IGV2ZW50LnN0YXJ0Q29uZGl0aW9uID09PSAyIHx8IGV2ZW50LnN0YXJ0Q29uZGl0aW9uID09PSAxKSkgewogICAgICAgICAgICAgICAgdGhpcy5ldmVudHNUb1N0YXJ0LnB1c2goZXZlbnQpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgY2FuID0gTG9naWNfRXZlbnQuX19zdXBlcl9fLm1vdmUuY2FsbCh0aGlzLCBkaXJlY3Rpb24pOwogICAgICAgICAgaWYgKGNhbikgewogICAgICAgICAgICB0aGlzLm9yaWdpbmFsRGlyZWN0aW9uID0gbnVsbDsKICAgICAgICAgIH0KICAgICAgICAgIGlmICgodGhpcy5yb3V0ZSAhPSBudWxsKSAmJiB0aGlzLnJvdXRlID09PSB0aGlzLmF1dG9Nb3ZlbWVudFJvdXRlKSB7CiAgICAgICAgICAgIHRoaXMucm91dGVXYWl0Q291bnRlciA9IHRoaXMubW92ZVJvdXRlRnJlcXVlbmN5OwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpZiAoZXZlbnRzICE9IG51bGwpIHsKICAgICAgICAgICAgZm9yIChfaiA9IDAsIF9sZW4xID0gZXZlbnRzLmxlbmd0aDsgX2ogPCBfbGVuMTsgX2orKykgewogICAgICAgICAgICAgIGV2ZW50ID0gZXZlbnRzW19qXTsKICAgICAgICAgICAgICBpZiAoKGV2ZW50LmlzUGxheWVyICYmIHRoaXMuc3RhcnRDb25kaXRpb24gPT09IDIpIHx8IHRoaXMuc3RhcnRDb25kaXRpb24gPT09IDMpIHsKICAgICAgICAgICAgICAgIHRoaXMuc3RhcnQoKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgaWYgKHRoaXMuaXNQbGF5ZXIgJiYgKGV2ZW50LnN0YXJ0Q29uZGl0aW9uID09PSAzIHx8IGV2ZW50LnN0YXJ0Q29uZGl0aW9uID09PSAyIHx8IGV2ZW50LnN0YXJ0Q29uZGl0aW9uID09PSAxKSkgewogICAgICAgICAgICAgICAgZXZlbnQuc3RhcnQoKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY2FuID0gZmFsc2U7CiAgICAgIH0KICAgICAgcmV0dXJuIGNhbjsKICAgIH07CgogICAgcmV0dXJuIExvZ2ljX0V2ZW50OwoKICB9KShMb2dpY19DaGFyYWN0ZXIpOwoKICB3aW5kb3cuTG9naWNfRXZlbnQgPSBMb2dpY19FdmVudDsKCn0pLmNhbGwodGhpcyk7Cg=="},{"name":"Logic_GlobalEvent","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogTG9naWNfR2xvYmFsRXZlbnQKIyAgIENyZWF0ZWQgb246IDIwMTMtMTEtMDMKIwojICAgQ29weXJpZ2h0IChDKSAyMDEzIEFuZHLpIFJhZG9tc2tpLiBBbGwgcmlnaHRzIHJlc2VydmVkLgojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQojCiMgICBDbGFzczogTG9naWNfR2xvYmFsRXZlbnQKIwojICAgQSBiYXNlIGNsYXNzIGZvciBhbGwgb3RoZXIgd2luZG93IGNsYXNzZXMuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpjbGFzcyBMb2dpY19HbG9iYWxFdmVudCBleHRlbmRzIExvZ2ljX0V2ZW50CiAgICBjb25zdHJ1Y3RvcjogKGV2ZW50LCBpZCkgLT4KICAgICAgICBzdXBlcihldmVudCwgaWQpCiAgICAgICAgQG1hcFVpZCA9IGV2ZW50Lm1hcFVpZAogICAgICAgIEBtYXBJZCA9IEBtYXBVaWQKICAgICAgICBAc3RlcHMgPSAwCiAgICAgICAgQGlzUGxheWVyID0gbm8KICAgIAogICAgdXBkYXRlOiAtPgogICAgICAgIHN1cGVyKCkgCiAgICAgICAgCiAgICAgICAgaWYgQGlzUGxheWVyCiAgICAgICAgICAgIEB1cGRhdGVQbGF5ZXIoKQogICAgICAgICAgICBAdXBkYXRlVGVycmFpblRhZygpCiAgICAgICAgICAKICAgIHVwZGF0ZVRlcnJhaW5UYWc6IC0+CiAgICAgICAgcG9zaXRpb24gPSBAY3VycmVudFBvc2l0aW9uSW5kZXgoKQogICAgICAgIG9mZnNldCA9IEBtYXAud2lkdGggKiBAbWFwLmhlaWdodAogICAgICAgIAogICAgICAgIGZvciBpIGluIFtAbWFwLmRlcHRoLi4uMF0KICAgICAgICAgICAgdGlsZSA9IEBtYXBEYXRhW3Bvc2l0aW9uICsgb2Zmc2V0KihpLTEpXQogICAgICAgICAgICBAdGVycmFpblRhZyA9IEB0aWxlc2V0LnRlcnJhaW5UYWdzW3RpbGVdCiAgICAgICAgICAgIGlmIEB0ZXJyYWluVGFnICE9IDAgdGhlbiBicmVhawogICAgICAgIAogICAgdXBkYXRlUGxheWVyOiAtPgogICAgICAgIGRpcmVjdGlvbiA9IElucHV0LmRpcjQoKQogICAgICAgIHBvc2l0aW9uID0gMAogICAgICAgIGV2ZW50cyA9IG51bGwKICAgICAgICBjaGFyYWN0ZXJzID0gbnVsbAogICAgCiAgICAgICAgCiAgICAgICAgaWYgZGlyZWN0aW9uID4gMCBhbmQgbm90IEBpc01vdmluZwogICAgICAgICAgICBAZGlyZWN0aW9uID0gZGlyZWN0aW9uCiAgICAgICAgICAgIAogICAgICAgICAgICBtb3ZlZCA9IEBtb3ZlKGRpcmVjdGlvbikKICAgICAgICAgICAgaWYgbW92ZWQgdGhlbiBAc3RlcHMrKwogICAgICAgICAgICBAYXBwbHlUZXJyYWluKEB0ZXJyYWluKQogICAgICAgICAgICAKICAgICAgICAgICAgaWYgbW92ZWQKICAgICAgICAgICAgICAgIGZvciBtZW1iZXIgaW4gR2FtZU1hbmFnZXIucGFydHkubWVtYmVycwogICAgICAgICAgICAgICAgICAgIG1lbWJlci5jaGVja1N0YXRlcyhubywgbm8sIG5vLCAwLCBAc3RlcHMsIDApCiAgICAgICAgICAgIAogICAgICAgIGlmIElucHV0LnRyaWdnZXIoSW5wdXQuQykgYW5kIG5vdCBAaXNNb3ZpbmcKICAgICAgICAgICAgcG9zaXRpb24gPSBAbmV4dFBvc2l0aW9uSW5kZXgoQGRpcmVjdGlvbiwgeWVzKQogICAgICAgICAgICBldmVudHMgPSBAY29sbGlzaW9uTWFwW3Bvc2l0aW9uXQogICAgICAgICAgICBzdGFydGVkID0gbm8KICAgICAgICAgICAgaWYgZXZlbnRzPwogICAgICAgICAgICAgICAgZm9yIGV2ZW50IGluIGV2ZW50cwogICAgICAgICAgICAgICAgICAgIGlmIGV2ZW50LnN0YXJ0Q29uZGl0aW9uID09IDAKICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnRlZCA9IHllcwogICAgICAgICAgICAgICAgICAgICAgICBJbnB1dC5jbGVhcigpCiAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LnN0YXJ0KCkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaWYgKG5vdCBzdGFydGVkKSBhbmQgQHN0YXJ0Q29uZGl0aW9uID09IDAgYW5kIEBjdXJyZW50UGFnZS5jb21tYW5kcz8gYW5kIEBjdXJyZW50UGFnZS5jb21tYW5kcy5sZW5ndGggPiAwCiAgICAgICAgICAgICAgICAgICAgSW5wdXQuY2xlYXIoKQogICAgICAgICAgICAgICAgICAgIEBzdGFydCgpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAKICAgIGFwcGx5VGVycmFpbjogKHRlcnJhaW4pIC0+CiAgICAgICAgaWYgbm90IHRlcnJhaW4/IHRoZW4gcmV0dXJuCiAgICAgICAgCiAgICAgICAgaWYgdGVycmFpbi5kYW1hZ2UudHlwZSA+IDAKICAgICAgICAgICAgZm9yIG1lbWJlciBpbiBHYW1lTWFuYWdlci5wYXJ0eS5tZW1iZXJzCiAgICAgICAgICAgICAgICBtZW1iZXIudGFrZURhbWFnZSh0ZXJyYWluLmRhbWFnZSkKICAgICAgICAgICAgICAgIGlmIHRlcnJhaW4ucGxheVNvdW5kT25EYW1hZ2UKICAgICAgICAgICAgICAgICAgICBBdWRpb01hbmFnZXIucGxheVNvdW5kKHRlcnJhaW4uc291bmQpCiAgICAgICAgCiAgICAgICAgaWYgbm90IHRlcnJhaW4ucGxheVNvdW5kT25EYW1hZ2UKICAgICAgICAgICAgQXVkaW9NYW5hZ2VyLnBsYXlTb3VuZCh0ZXJyYWluLnNvdW5kKQogICAgICAgICAgICAKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgCndpbmRvdy5Mb2dpY19HbG9iYWxFdmVudCA9IExvZ2ljX0dsb2JhbEV2ZW50","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBMb2dpY19HbG9iYWxFdmVudCwKICAgIF9faGFzUHJvcCA9IHt9Lmhhc093blByb3BlcnR5LAogICAgX19leHRlbmRzID0gZnVuY3Rpb24oY2hpbGQsIHBhcmVudCkgeyBmb3IgKHZhciBrZXkgaW4gcGFyZW50KSB7IGlmIChfX2hhc1Byb3AuY2FsbChwYXJlbnQsIGtleSkpIGNoaWxkW2tleV0gPSBwYXJlbnRba2V5XTsgfSBmdW5jdGlvbiBjdG9yKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gY2hpbGQ7IH0gY3Rvci5wcm90b3R5cGUgPSBwYXJlbnQucHJvdG90eXBlOyBjaGlsZC5wcm90b3R5cGUgPSBuZXcgY3RvcigpOyBjaGlsZC5fX3N1cGVyX18gPSBwYXJlbnQucHJvdG90eXBlOyByZXR1cm4gY2hpbGQ7IH07CgogIExvZ2ljX0dsb2JhbEV2ZW50ID0gKGZ1bmN0aW9uKF9zdXBlcikgewogICAgX19leHRlbmRzKExvZ2ljX0dsb2JhbEV2ZW50LCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIExvZ2ljX0dsb2JhbEV2ZW50KGV2ZW50LCBpZCkgewogICAgICBMb2dpY19HbG9iYWxFdmVudC5fX3N1cGVyX18uY29uc3RydWN0b3IuY2FsbCh0aGlzLCBldmVudCwgaWQpOwogICAgICB0aGlzLm1hcFVpZCA9IGV2ZW50Lm1hcFVpZDsKICAgICAgdGhpcy5tYXBJZCA9IHRoaXMubWFwVWlkOwogICAgICB0aGlzLnN0ZXBzID0gMDsKICAgICAgdGhpcy5pc1BsYXllciA9IGZhbHNlOwogICAgfQoKICAgIExvZ2ljX0dsb2JhbEV2ZW50LnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpIHsKICAgICAgTG9naWNfR2xvYmFsRXZlbnQuX19zdXBlcl9fLnVwZGF0ZS5jYWxsKHRoaXMpOwogICAgICBpZiAodGhpcy5pc1BsYXllcikgewogICAgICAgIHRoaXMudXBkYXRlUGxheWVyKCk7CiAgICAgICAgcmV0dXJuIHRoaXMudXBkYXRlVGVycmFpblRhZygpOwogICAgICB9CiAgICB9OwoKICAgIExvZ2ljX0dsb2JhbEV2ZW50LnByb3RvdHlwZS51cGRhdGVUZXJyYWluVGFnID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBpLCBvZmZzZXQsIHBvc2l0aW9uLCB0aWxlLCBfaSwgX3JlZiwgX3Jlc3VsdHM7CiAgICAgIHBvc2l0aW9uID0gdGhpcy5jdXJyZW50UG9zaXRpb25JbmRleCgpOwogICAgICBvZmZzZXQgPSB0aGlzLm1hcC53aWR0aCAqIHRoaXMubWFwLmhlaWdodDsKICAgICAgX3Jlc3VsdHMgPSBbXTsKICAgICAgZm9yIChpID0gX2kgPSBfcmVmID0gdGhpcy5tYXAuZGVwdGg7IF9yZWYgPD0gMCA/IF9pIDwgMCA6IF9pID4gMDsgaSA9IF9yZWYgPD0gMCA/ICsrX2kgOiAtLV9pKSB7CiAgICAgICAgdGlsZSA9IHRoaXMubWFwRGF0YVtwb3NpdGlvbiArIG9mZnNldCAqIChpIC0gMSldOwogICAgICAgIHRoaXMudGVycmFpblRhZyA9IHRoaXMudGlsZXNldC50ZXJyYWluVGFnc1t0aWxlXTsKICAgICAgICBpZiAodGhpcy50ZXJyYWluVGFnICE9PSAwKSB7CiAgICAgICAgICBicmVhazsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgX3Jlc3VsdHMucHVzaCh2b2lkIDApOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gX3Jlc3VsdHM7CiAgICB9OwoKICAgIExvZ2ljX0dsb2JhbEV2ZW50LnByb3RvdHlwZS51cGRhdGVQbGF5ZXIgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGNoYXJhY3RlcnMsIGRpcmVjdGlvbiwgZXZlbnQsIGV2ZW50cywgbWVtYmVyLCBtb3ZlZCwgcG9zaXRpb24sIHN0YXJ0ZWQsIF9pLCBfaiwgX2xlbiwgX2xlbjEsIF9yZWY7CiAgICAgIGRpcmVjdGlvbiA9IElucHV0LmRpcjQoKTsKICAgICAgcG9zaXRpb24gPSAwOwogICAgICBldmVudHMgPSBudWxsOwogICAgICBjaGFyYWN0ZXJzID0gbnVsbDsKICAgICAgaWYgKGRpcmVjdGlvbiA+IDAgJiYgIXRoaXMuaXNNb3ZpbmcpIHsKICAgICAgICB0aGlzLmRpcmVjdGlvbiA9IGRpcmVjdGlvbjsKICAgICAgICBtb3ZlZCA9IHRoaXMubW92ZShkaXJlY3Rpb24pOwogICAgICAgIGlmIChtb3ZlZCkgewogICAgICAgICAgdGhpcy5zdGVwcysrOwogICAgICAgIH0KICAgICAgICB0aGlzLmFwcGx5VGVycmFpbih0aGlzLnRlcnJhaW4pOwogICAgICAgIGlmIChtb3ZlZCkgewogICAgICAgICAgX3JlZiA9IEdhbWVNYW5hZ2VyLnBhcnR5Lm1lbWJlcnM7CiAgICAgICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICAgICAgbWVtYmVyID0gX3JlZltfaV07CiAgICAgICAgICAgIG1lbWJlci5jaGVja1N0YXRlcyhmYWxzZSwgZmFsc2UsIGZhbHNlLCAwLCB0aGlzLnN0ZXBzLCAwKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKElucHV0LnRyaWdnZXIoSW5wdXQuQykgJiYgIXRoaXMuaXNNb3ZpbmcpIHsKICAgICAgICBwb3NpdGlvbiA9IHRoaXMubmV4dFBvc2l0aW9uSW5kZXgodGhpcy5kaXJlY3Rpb24sIHRydWUpOwogICAgICAgIGV2ZW50cyA9IHRoaXMuY29sbGlzaW9uTWFwW3Bvc2l0aW9uXTsKICAgICAgICBzdGFydGVkID0gZmFsc2U7CiAgICAgICAgaWYgKGV2ZW50cyAhPSBudWxsKSB7CiAgICAgICAgICBmb3IgKF9qID0gMCwgX2xlbjEgPSBldmVudHMubGVuZ3RoOyBfaiA8IF9sZW4xOyBfaisrKSB7CiAgICAgICAgICAgIGV2ZW50ID0gZXZlbnRzW19qXTsKICAgICAgICAgICAgaWYgKGV2ZW50LnN0YXJ0Q29uZGl0aW9uID09PSAwKSB7CiAgICAgICAgICAgICAgc3RhcnRlZCA9IHRydWU7CiAgICAgICAgICAgICAgSW5wdXQuY2xlYXIoKTsKICAgICAgICAgICAgICBldmVudC5zdGFydCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoKCFzdGFydGVkKSAmJiB0aGlzLnN0YXJ0Q29uZGl0aW9uID09PSAwICYmICh0aGlzLmN1cnJlbnRQYWdlLmNvbW1hbmRzICE9IG51bGwpICYmIHRoaXMuY3VycmVudFBhZ2UuY29tbWFuZHMubGVuZ3RoID4gMCkgewogICAgICAgICAgICBJbnB1dC5jbGVhcigpOwogICAgICAgICAgICByZXR1cm4gdGhpcy5zdGFydCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICBMb2dpY19HbG9iYWxFdmVudC5wcm90b3R5cGUuYXBwbHlUZXJyYWluID0gZnVuY3Rpb24odGVycmFpbikgewogICAgICB2YXIgbWVtYmVyLCBfaSwgX2xlbiwgX3JlZjsKICAgICAgaWYgKHRlcnJhaW4gPT0gbnVsbCkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBpZiAodGVycmFpbi5kYW1hZ2UudHlwZSA+IDApIHsKICAgICAgICBfcmVmID0gR2FtZU1hbmFnZXIucGFydHkubWVtYmVyczsKICAgICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICAgIG1lbWJlciA9IF9yZWZbX2ldOwogICAgICAgICAgbWVtYmVyLnRha2VEYW1hZ2UodGVycmFpbi5kYW1hZ2UpOwogICAgICAgICAgaWYgKHRlcnJhaW4ucGxheVNvdW5kT25EYW1hZ2UpIHsKICAgICAgICAgICAgQXVkaW9NYW5hZ2VyLnBsYXlTb3VuZCh0ZXJyYWluLnNvdW5kKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKCF0ZXJyYWluLnBsYXlTb3VuZE9uRGFtYWdlKSB7CiAgICAgICAgcmV0dXJuIEF1ZGlvTWFuYWdlci5wbGF5U291bmQodGVycmFpbi5zb3VuZCk7CiAgICAgIH0KICAgIH07CgogICAgcmV0dXJuIExvZ2ljX0dsb2JhbEV2ZW50OwoKICB9KShMb2dpY19FdmVudCk7CgogIHdpbmRvdy5Mb2dpY19HbG9iYWxFdmVudCA9IExvZ2ljX0dsb2JhbEV2ZW50OwoKfSkuY2FsbCh0aGlzKTsK"},{"name":"Logic_CommonEvent","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogTG9naWNfQ29tbW9uRXZlbnQKIyAgIENyZWF0ZWQgb246IDIwMTMtMTItMTMKIwojICAgQ29weXJpZ2h0IChDKSAyMDEzIEFuZHLpIFJhZG9tc2tpLiBBbGwgcmlnaHRzIHJlc2VydmVkLgojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQojCiMgICBDbGFzczogTG9naWNfQ29tbW9uRXZlbnQKIwojICAgQSBiYXNlIGNsYXNzIGZvciBhbGwgb3RoZXIgd2luZG93IGNsYXNzZXMuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpjbGFzcyBMb2dpY19Db21tb25FdmVudAogICAgY29uc3RydWN0b3I6IChldmVudCwgaWQpIC0+CiAgICAgICAgQGlkID0gaWQKICAgICAgICBAZXZlbnQgPSBldmVudAogICAgICAgICAKICAgICAgICBAaW50ZXJwcmV0ZXIgPSBudWxsCiAgIAogICAgICAgIAogICAgICAgIEBwYXJhbWV0ZXJzID0gaWYgQGV2ZW50LnBhcmFtZXRlcnM/IHRoZW4gQGV2ZW50LnBhcmFtZXRlcnMgZWxzZSBbXQogICAgICAgIEBzdGFydENvbmRpdGlvbiA9IGlmIEBldmVudC5zdGFydENvbmRpdGlvbj8gdGhlbiBAZXZlbnQuc3RhcnRDb25kaXRpb24gZWxzZSAwCiAgICAgICAgQHBhcmFsbGVsID0gaWYgQGV2ZW50LnBhcmFsbGVsPyB0aGVuIEBldmVudC5wYXJhbGxlbCBlbHNlIG5vCiAgICAgICAgQGNvbmRpdGlvblN3aXRjaCA9IGlmIEBldmVudC5jb25kaXRpb25Td2l0Y2g/IHRoZW4gQGV2ZW50LmNvbmRpdGlvblN3aXRjaCBlbHNlIG51bGwKICAgICAgICBAaGFzQ29uZGl0aW9uID0gQGV2ZW50LmNvbmRpdGlvbkVuYWJsZWQKICAgICAgICBAaW50ZXJwcmV0ZXIgPSBpZiBAc3RhcnRDb25kaXRpb24gPT0gMSBhbmQgbm90IEBwYXJhbGxlbCB0aGVuIEdhbWVNYW5hZ2VyLmludGVycHJldGVyIGVsc2UgbmV3IENvbW1hbmRJbnRlcnByZXRlcihAZXZlbnQuY29tbWFuZHMpCiAgICAgICAgQHJlYWR5VG9TdGFydCA9IG5vCiAgICBzdGFydDogKHBhcmFtZXRlcnMpIC0+CiAgICAgICAgQHN0YXJ0UGFyYW1ldGVycyA9IHBhcmFtZXRlcnMgICAgICAgIAogICAgICAgICAgICAgICAgCiAgICAgICAgaWYgQGludGVycHJldGVyPyBhbmQgbm90IEBpbnRlcnByZXRlci5pc1J1bm5pbmcKICAgICAgICAgICAgQGludGVycHJldGVyLnJlcGVhdCA9IEBzdGFydENvbmRpdGlvbiA9PSAxCiAgICAgICAgICAgIEBpbnRlcnByZXRlci5jb21tYW5kcyA9IEBldmVudC5jb21tYW5kcwogICAgICAgICAgICBAcmVhZHlUb1N0YXJ0ID0geWVzCiAgICAgICAgICAgIAogICAgICAgICAgICAKICAgICAgICBpZiBAcGFyYWxsZWwgYW5kIEBvbkZpbmlzaD8gdGhlbiBAb25GaW5pc2godGhpcykKICAKICAgIGNhbGw6IChwYXJhbWV0ZXJzKSAtPgogICAgICAgIGludGVycHJldGVyID0gbmV3IENvbW1hbmRJbnRlcnByZXRlcihAZXZlbnQuY29tbWFuZHMpCiAgICAgICAgaW50ZXJwcmV0ZXIudGVtcE51bWJlcnMgPSBbXQogICAgICAgIGludGVycHJldGVyLnRlbXBTdHJpbmdzID0gW10KICAgICAgICBpbnRlcnByZXRlci50ZW1wQm9vbGVhbnMgPSBbXQogICAgICAgIAogICAgICAgIEdhbWVNYW5hZ2VyLnZhcmlhYmxlU3RvcmUudGVtcE51bWJlcnMgPSBpbnRlcnByZXRlci50ZW1wTnVtYmVycwogICAgICAgIEdhbWVNYW5hZ2VyLnZhcmlhYmxlU3RvcmUudGVtcFN0cmluZ3MgPSBpbnRlcnByZXRlci50ZW1wU3RyaW5ncwogICAgICAgIEdhbWVNYW5hZ2VyLnZhcmlhYmxlU3RvcmUudGVtcEJvb2xlYW5zID0gaW50ZXJwcmV0ZXIudGVtcEJvb2xlYW5zCiAgICAgICAgCiAgICAgICAgaWYgcGFyYW1ldGVycz8gYW5kIHBhcmFtZXRlcnMudmFsdWVzPwogICAgICAgICAgICBmb3IgaSBpbiBbMC4uLnBhcmFtZXRlcnMudmFsdWVzLmxlbmd0aF0KICAgICAgICAgICAgICAgIHZhbHVlID0gcGFyYW1ldGVycy52YWx1ZXNbaV0KICAgICAgICAgICAgICAgIHBhcmFtZXRlciA9IEBwYXJhbWV0ZXJzW2ldCiAgICAgICAgICAgICAgICBpZiBwYXJhbWV0ZXI/IGFuZCB2YWx1ZT8KICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggcGFyYW1ldGVyLnR5cGUKICAgICAgICAgICAgICAgICAgICAgICAgd2hlbiAxICMgTnVtYmVyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBHYW1lTWFuYWdlci52YXJpYWJsZVN0b3JlLnNldE51bWJlclZhbHVlVG8ocGFyYW1ldGVyLm51bWJlclZhcmlhYmxlLCB2YWx1ZSkKICAgICAgICAgICAgICAgICAgICAgICAgd2hlbiAyICMgQm9vbGVhbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgR2FtZU1hbmFnZXIudmFyaWFibGVTdG9yZS5zZXRCb29sZWFuVmFsdWVUbyhwYXJhbWV0ZXIuYm9vbGVhblZhcmlhYmxlLCB2YWx1ZSkKICAgICAgICAgICAgICAgICAgICAgICAgd2hlbiAzICMgU3RyaW5nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBHYW1lTWFuYWdlci52YXJpYWJsZVN0b3JlLnNldFN0cmluZ1ZhbHVlVG8ocGFyYW1ldGVyLnN0cmluZ1ZhcmlhYmxlLCB2YWx1ZSkKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAKICAgICAgICByZXR1cm4gaW50ZXJwcmV0ZXIKICAgICAgICAKICAgIHVwZGF0ZTogLT4KICAgICAgICBpZiBAaW50ZXJwcmV0ZXI/IGFuZCBAcmVhZHlUb1N0YXJ0CiAgICAgICAgICAgIEByZWFkeVRvU3RhcnQgPSBubwogICAgICAgICAgICBwYXJhbWV0ZXJzID0gQHN0YXJ0UGFyYW1ldGVycwogICAgICAgICAgICBpZiBwYXJhbWV0ZXJzPyBhbmQgcGFyYW1ldGVycy52YWx1ZXM/CiAgICAgICAgICAgICAgICBmb3IgaSBpbiBbMC4uLnBhcmFtZXRlcnMudmFsdWVzLmxlbmd0aF0KICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHBhcmFtZXRlcnMudmFsdWVzW2ldCiAgICAgICAgICAgICAgICAgICAgcGFyYW1ldGVyID0gQHBhcmFtZXRlcnNbaV0KICAgICAgICAgICAgICAgICAgICBpZiBwYXJhbWV0ZXI/IGFuZCB2YWx1ZT8KICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIHBhcmFtZXRlci50eXBlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGVuIDEgIyBOdW1iZXIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBHYW1lTWFuYWdlci52YXJpYWJsZVN0b3JlLnNldE51bWJlclZhbHVlVG8ocGFyYW1ldGVyLm51bWJlclZhcmlhYmxlLCB2YWx1ZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoZW4gMiAjIEJvb2xlYW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBHYW1lTWFuYWdlci52YXJpYWJsZVN0b3JlLnNldEJvb2xlYW5WYWx1ZVRvKHBhcmFtZXRlci5ib29sZWFuVmFyaWFibGUsIHZhbHVlKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hlbiAzICMgU3RyaW5nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgR2FtZU1hbmFnZXIudmFyaWFibGVTdG9yZS5zZXRTdHJpbmdWYWx1ZVRvKHBhcmFtZXRlci5zdHJpbmdWYXJpYWJsZSwgdmFsdWUpCiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICBAaW50ZXJwcmV0ZXIuc3RhcnQoKQogICAgICAgICAgICAKICAgICAgICBpZiBAaW50ZXJwcmV0ZXI/CiAgICAgICAgICAgIEBpbnRlcnByZXRlci51cGRhdGUoKQogICAgICAgICAgICAKICAgICAgICBpZiBAaW50ZXJwcmV0ZXI/IGFuZCBub3QgQGludGVycHJldGVyLmlzUnVubmluZyBhbmQgbm90IEBwYXJhbGxlbAogICAgICAgICAgICBpZiBub3QgQHBhcmFsbGVsIGFuZCBAb25GaW5pc2g/IHRoZW4gQG9uRmluaXNoKHRoaXMpCiAgICAgICAgICAgIAogICAgICAgIGlmIEBpbnRlcnByZXRlcj8gYW5kIEBzdGFydENvbmRpdGlvbiA9PSAxIGFuZCBub3QgQGludGVycHJldGVyLmlzUnVubmluZwogICAgICAgICAgICBpZiBAaGFzQ29uZGl0aW9uCiAgICAgICAgICAgICAgICBpZiBHYW1lTWFuYWdlci52YXJpYWJsZVN0b3JlLmJvb2xlYW5WYWx1ZU9mKEBjb25kaXRpb25Td2l0Y2gpCiAgICAgICAgICAgICAgICAgICAgQHN0YXJ0KCkKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgQHN0YXJ0KCkKICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgCiAgICAgICAgICAgIAogICAgZXJhc2U6IC0+CiAgICAgICAgCndpbmRvdy5Mb2dpY19Db21tb25FdmVudCA9IExvZ2ljX0NvbW1vbkV2ZW50","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBMb2dpY19Db21tb25FdmVudDsKCiAgTG9naWNfQ29tbW9uRXZlbnQgPSAoZnVuY3Rpb24oKSB7CiAgICBmdW5jdGlvbiBMb2dpY19Db21tb25FdmVudChldmVudCwgaWQpIHsKICAgICAgdGhpcy5pZCA9IGlkOwogICAgICB0aGlzLmV2ZW50ID0gZXZlbnQ7CiAgICAgIHRoaXMuaW50ZXJwcmV0ZXIgPSBudWxsOwogICAgICB0aGlzLnBhcmFtZXRlcnMgPSB0aGlzLmV2ZW50LnBhcmFtZXRlcnMgIT0gbnVsbCA/IHRoaXMuZXZlbnQucGFyYW1ldGVycyA6IFtdOwogICAgICB0aGlzLnN0YXJ0Q29uZGl0aW9uID0gdGhpcy5ldmVudC5zdGFydENvbmRpdGlvbiAhPSBudWxsID8gdGhpcy5ldmVudC5zdGFydENvbmRpdGlvbiA6IDA7CiAgICAgIHRoaXMucGFyYWxsZWwgPSB0aGlzLmV2ZW50LnBhcmFsbGVsICE9IG51bGwgPyB0aGlzLmV2ZW50LnBhcmFsbGVsIDogZmFsc2U7CiAgICAgIHRoaXMuY29uZGl0aW9uU3dpdGNoID0gdGhpcy5ldmVudC5jb25kaXRpb25Td2l0Y2ggIT0gbnVsbCA/IHRoaXMuZXZlbnQuY29uZGl0aW9uU3dpdGNoIDogbnVsbDsKICAgICAgdGhpcy5oYXNDb25kaXRpb24gPSB0aGlzLmV2ZW50LmNvbmRpdGlvbkVuYWJsZWQ7CiAgICAgIHRoaXMuaW50ZXJwcmV0ZXIgPSB0aGlzLnN0YXJ0Q29uZGl0aW9uID09PSAxICYmICF0aGlzLnBhcmFsbGVsID8gR2FtZU1hbmFnZXIuaW50ZXJwcmV0ZXIgOiBuZXcgQ29tbWFuZEludGVycHJldGVyKHRoaXMuZXZlbnQuY29tbWFuZHMpOwogICAgICB0aGlzLnJlYWR5VG9TdGFydCA9IGZhbHNlOwogICAgfQoKICAgIExvZ2ljX0NvbW1vbkV2ZW50LnByb3RvdHlwZS5zdGFydCA9IGZ1bmN0aW9uKHBhcmFtZXRlcnMpIHsKICAgICAgdGhpcy5zdGFydFBhcmFtZXRlcnMgPSBwYXJhbWV0ZXJzOwogICAgICBpZiAoKHRoaXMuaW50ZXJwcmV0ZXIgIT0gbnVsbCkgJiYgIXRoaXMuaW50ZXJwcmV0ZXIuaXNSdW5uaW5nKSB7CiAgICAgICAgdGhpcy5pbnRlcnByZXRlci5yZXBlYXQgPSB0aGlzLnN0YXJ0Q29uZGl0aW9uID09PSAxOwogICAgICAgIHRoaXMuaW50ZXJwcmV0ZXIuY29tbWFuZHMgPSB0aGlzLmV2ZW50LmNvbW1hbmRzOwogICAgICAgIHRoaXMucmVhZHlUb1N0YXJ0ID0gdHJ1ZTsKICAgICAgfQogICAgICBpZiAodGhpcy5wYXJhbGxlbCAmJiAodGhpcy5vbkZpbmlzaCAhPSBudWxsKSkgewogICAgICAgIHJldHVybiB0aGlzLm9uRmluaXNoKHRoaXMpOwogICAgICB9CiAgICB9OwoKICAgIExvZ2ljX0NvbW1vbkV2ZW50LnByb3RvdHlwZS5jYWxsID0gZnVuY3Rpb24ocGFyYW1ldGVycykgewogICAgICB2YXIgaSwgaW50ZXJwcmV0ZXIsIHBhcmFtZXRlciwgdmFsdWUsIF9pLCBfcmVmOwogICAgICBpbnRlcnByZXRlciA9IG5ldyBDb21tYW5kSW50ZXJwcmV0ZXIodGhpcy5ldmVudC5jb21tYW5kcyk7CiAgICAgIGludGVycHJldGVyLnRlbXBOdW1iZXJzID0gW107CiAgICAgIGludGVycHJldGVyLnRlbXBTdHJpbmdzID0gW107CiAgICAgIGludGVycHJldGVyLnRlbXBCb29sZWFucyA9IFtdOwogICAgICBHYW1lTWFuYWdlci52YXJpYWJsZVN0b3JlLnRlbXBOdW1iZXJzID0gaW50ZXJwcmV0ZXIudGVtcE51bWJlcnM7CiAgICAgIEdhbWVNYW5hZ2VyLnZhcmlhYmxlU3RvcmUudGVtcFN0cmluZ3MgPSBpbnRlcnByZXRlci50ZW1wU3RyaW5nczsKICAgICAgR2FtZU1hbmFnZXIudmFyaWFibGVTdG9yZS50ZW1wQm9vbGVhbnMgPSBpbnRlcnByZXRlci50ZW1wQm9vbGVhbnM7CiAgICAgIGlmICgocGFyYW1ldGVycyAhPSBudWxsKSAmJiAocGFyYW1ldGVycy52YWx1ZXMgIT0gbnVsbCkpIHsKICAgICAgICBmb3IgKGkgPSBfaSA9IDAsIF9yZWYgPSBwYXJhbWV0ZXJzLnZhbHVlcy5sZW5ndGg7IDAgPD0gX3JlZiA/IF9pIDwgX3JlZiA6IF9pID4gX3JlZjsgaSA9IDAgPD0gX3JlZiA/ICsrX2kgOiAtLV9pKSB7CiAgICAgICAgICB2YWx1ZSA9IHBhcmFtZXRlcnMudmFsdWVzW2ldOwogICAgICAgICAgcGFyYW1ldGVyID0gdGhpcy5wYXJhbWV0ZXJzW2ldOwogICAgICAgICAgaWYgKChwYXJhbWV0ZXIgIT0gbnVsbCkgJiYgKHZhbHVlICE9IG51bGwpKSB7CiAgICAgICAgICAgIHN3aXRjaCAocGFyYW1ldGVyLnR5cGUpIHsKICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgICBHYW1lTWFuYWdlci52YXJpYWJsZVN0b3JlLnNldE51bWJlclZhbHVlVG8ocGFyYW1ldGVyLm51bWJlclZhcmlhYmxlLCB2YWx1ZSk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICBHYW1lTWFuYWdlci52YXJpYWJsZVN0b3JlLnNldEJvb2xlYW5WYWx1ZVRvKHBhcmFtZXRlci5ib29sZWFuVmFyaWFibGUsIHZhbHVlKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIEdhbWVNYW5hZ2VyLnZhcmlhYmxlU3RvcmUuc2V0U3RyaW5nVmFsdWVUbyhwYXJhbWV0ZXIuc3RyaW5nVmFyaWFibGUsIHZhbHVlKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gaW50ZXJwcmV0ZXI7CiAgICB9OwoKICAgIExvZ2ljX0NvbW1vbkV2ZW50LnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGksIHBhcmFtZXRlciwgcGFyYW1ldGVycywgdmFsdWUsIF9pLCBfcmVmOwogICAgICBpZiAoKHRoaXMuaW50ZXJwcmV0ZXIgIT0gbnVsbCkgJiYgdGhpcy5yZWFkeVRvU3RhcnQpIHsKICAgICAgICB0aGlzLnJlYWR5VG9TdGFydCA9IGZhbHNlOwogICAgICAgIHBhcmFtZXRlcnMgPSB0aGlzLnN0YXJ0UGFyYW1ldGVyczsKICAgICAgICBpZiAoKHBhcmFtZXRlcnMgIT0gbnVsbCkgJiYgKHBhcmFtZXRlcnMudmFsdWVzICE9IG51bGwpKSB7CiAgICAgICAgICBmb3IgKGkgPSBfaSA9IDAsIF9yZWYgPSBwYXJhbWV0ZXJzLnZhbHVlcy5sZW5ndGg7IDAgPD0gX3JlZiA/IF9pIDwgX3JlZiA6IF9pID4gX3JlZjsgaSA9IDAgPD0gX3JlZiA/ICsrX2kgOiAtLV9pKSB7CiAgICAgICAgICAgIHZhbHVlID0gcGFyYW1ldGVycy52YWx1ZXNbaV07CiAgICAgICAgICAgIHBhcmFtZXRlciA9IHRoaXMucGFyYW1ldGVyc1tpXTsKICAgICAgICAgICAgaWYgKChwYXJhbWV0ZXIgIT0gbnVsbCkgJiYgKHZhbHVlICE9IG51bGwpKSB7CiAgICAgICAgICAgICAgc3dpdGNoIChwYXJhbWV0ZXIudHlwZSkgewogICAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgICAgICBHYW1lTWFuYWdlci52YXJpYWJsZVN0b3JlLnNldE51bWJlclZhbHVlVG8ocGFyYW1ldGVyLm51bWJlclZhcmlhYmxlLCB2YWx1ZSk7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICBHYW1lTWFuYWdlci52YXJpYWJsZVN0b3JlLnNldEJvb2xlYW5WYWx1ZVRvKHBhcmFtZXRlci5ib29sZWFuVmFyaWFibGUsIHZhbHVlKTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICAgIEdhbWVNYW5hZ2VyLnZhcmlhYmxlU3RvcmUuc2V0U3RyaW5nVmFsdWVUbyhwYXJhbWV0ZXIuc3RyaW5nVmFyaWFibGUsIHZhbHVlKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgdGhpcy5pbnRlcnByZXRlci5zdGFydCgpOwogICAgICB9CiAgICAgIGlmICh0aGlzLmludGVycHJldGVyICE9IG51bGwpIHsKICAgICAgICB0aGlzLmludGVycHJldGVyLnVwZGF0ZSgpOwogICAgICB9CiAgICAgIGlmICgodGhpcy5pbnRlcnByZXRlciAhPSBudWxsKSAmJiAhdGhpcy5pbnRlcnByZXRlci5pc1J1bm5pbmcgJiYgIXRoaXMucGFyYWxsZWwpIHsKICAgICAgICBpZiAoIXRoaXMucGFyYWxsZWwgJiYgKHRoaXMub25GaW5pc2ggIT0gbnVsbCkpIHsKICAgICAgICAgIHRoaXMub25GaW5pc2godGhpcyk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmICgodGhpcy5pbnRlcnByZXRlciAhPSBudWxsKSAmJiB0aGlzLnN0YXJ0Q29uZGl0aW9uID09PSAxICYmICF0aGlzLmludGVycHJldGVyLmlzUnVubmluZykgewogICAgICAgIGlmICh0aGlzLmhhc0NvbmRpdGlvbikgewogICAgICAgICAgaWYgKEdhbWVNYW5hZ2VyLnZhcmlhYmxlU3RvcmUuYm9vbGVhblZhbHVlT2YodGhpcy5jb25kaXRpb25Td2l0Y2gpKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0YXJ0KCk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVybiB0aGlzLnN0YXJ0KCk7CiAgICAgICAgfQogICAgICB9CiAgICB9OwoKICAgIExvZ2ljX0NvbW1vbkV2ZW50LnByb3RvdHlwZS5lcmFzZSA9IGZ1bmN0aW9uKCkge307CgogICAgcmV0dXJuIExvZ2ljX0NvbW1vbkV2ZW50OwoKICB9KSgpOwoKICB3aW5kb3cuTG9naWNfQ29tbW9uRXZlbnQgPSBMb2dpY19Db21tb25FdmVudDsKCn0pLmNhbGwodGhpcyk7Cg=="},{"name":"Logic_Player","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogTG9naWNfUGxheWVyCiMgICBDcmVhdGVkIG9uOiAyMDEzLTA5LTAxCiMKIyAgIENvcHlyaWdodCAoQykgMjAxMyBBbmRy6SBSYWRvbXNraS4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KIwojICAgQ2xhc3M6IExvZ2ljX1BsYXllcgojCiMgICBBIGJhc2UgY2xhc3MgZm9yIGFsbCBvdGhlciB3aW5kb3cgY2xhc3Nlcy4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCmNsYXNzIExvZ2ljX1BsYXllciBleHRlbmRzIExvZ2ljX0NoYXJhY3RlcgogICAgY29uc3RydWN0b3I6IC0+CiAgICAgICAgc3VwZXIoKQogICAgICAgIEBncmFwaGljID0gbmFtZTogImNoYXJhY3RlcnMyIgogICAgICAgIEBwYXR0ZXJuID0gNAogICAgICAgIEBzdWJQYXR0ZXJuID0gMQogICAgICAgIEBzdGVwcyA9IDAKICAgIHVwZGF0ZTogLT4KICAgICAgICBzdXBlcgogICAgICAgIAogICAgICAgIGRpcmVjdGlvbiA9IElucHV0LmRpcjQoKQogICAgICAgIHBvc2l0aW9uID0gMAogICAgICAgIGV2ZW50cyA9IG51bGwKICAgICAgICBjaGFyYWN0ZXJzID0gbnVsbAogICAgICAgIAogICAgICAgIGlmIGRpcmVjdGlvbiA+IDAgYW5kIG5vdCBAaXNNb3ZpbmcKICAgICAgICAgICAgQGRpcmVjdGlvbiA9IGRpcmVjdGlvbgogICAgICAgICAgICBpZiBAY2FuTW92ZShkaXJlY3Rpb24pCiAgICAgICAgICAgICAgICBAbW92ZShkaXJlY3Rpb24pCiAgICAgICAgICAgICAgICBAc3RlcHMrKwogICAgICAgICAgICBwb3NpdGlvbiA9IEBuZXh0UG9zaXRpb25JbmRleChkaXJlY3Rpb24pCiAgICAgICAgICAgIGNoYXJhY3RlcnMgPSBAY29sbGlzaW9uTWFwW3Bvc2l0aW9uXQogICAgICAgICAgICBmb3IgY2hhcmFjdGVyIGluIGNoYXJhY3RlcnMKICAgICAgICAgICAgICAgIGlmIGNoYXJhY3RlciAhPSB0aGlzIGFuZCBjaGFyYWN0ZXIuY3VycmVudFBhZ2Uuc3RhcnRDb25kaXRpb24gPT0gMgogICAgICAgICAgICAgICAgICAgIGNoYXJhY3Rlci5zdGFydCgpCiAgICAgICAgICAgIAogICAgICAgIGlmIElucHV0LnRyaWdnZXIoSW5wdXQuQykgYW5kIG5vdCBAaXNNb3ZpbmcKICAgICAgICAgICAgcG9zaXRpb24gPSBAbmV4dFBvc2l0aW9uSW5kZXgoQGRpcmVjdGlvbikKICAgICAgICAgICAgZXZlbnRzID0gQGNvbGxpc2lvbk1hcFtwb3NpdGlvbl0KICAgICAgICAgICAgZm9yIGV2ZW50IGluIGV2ZW50cwogICAgICAgICAgICAgICAgaWYgZXZlbnQuY3VycmVudFBhZ2Uuc3RhcnRDb25kaXRpb24gPT0gMAogICAgICAgICAgICAgICAgICAgIGV2ZW50LnN0YXJ0KCkKICAgICAgICAgICAgICAgICAgICAKICAgIAogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAKd2luZG93LkxvZ2ljX1BsYXllciA9IExvZ2ljX1BsYXllcg==","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBMb2dpY19QbGF5ZXIsCiAgICBfX2hhc1Byb3AgPSB7fS5oYXNPd25Qcm9wZXJ0eSwKICAgIF9fZXh0ZW5kcyA9IGZ1bmN0aW9uKGNoaWxkLCBwYXJlbnQpIHsgZm9yICh2YXIga2V5IGluIHBhcmVudCkgeyBpZiAoX19oYXNQcm9wLmNhbGwocGFyZW50LCBrZXkpKSBjaGlsZFtrZXldID0gcGFyZW50W2tleV07IH0gZnVuY3Rpb24gY3RvcigpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGNoaWxkOyB9IGN0b3IucHJvdG90eXBlID0gcGFyZW50LnByb3RvdHlwZTsgY2hpbGQucHJvdG90eXBlID0gbmV3IGN0b3IoKTsgY2hpbGQuX19zdXBlcl9fID0gcGFyZW50LnByb3RvdHlwZTsgcmV0dXJuIGNoaWxkOyB9OwoKICBMb2dpY19QbGF5ZXIgPSAoZnVuY3Rpb24oX3N1cGVyKSB7CiAgICBfX2V4dGVuZHMoTG9naWNfUGxheWVyLCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIExvZ2ljX1BsYXllcigpIHsKICAgICAgTG9naWNfUGxheWVyLl9fc3VwZXJfXy5jb25zdHJ1Y3Rvci5jYWxsKHRoaXMpOwogICAgICB0aGlzLmdyYXBoaWMgPSB7CiAgICAgICAgbmFtZTogImNoYXJhY3RlcnMyIgogICAgICB9OwogICAgICB0aGlzLnBhdHRlcm4gPSA0OwogICAgICB0aGlzLnN1YlBhdHRlcm4gPSAxOwogICAgICB0aGlzLnN0ZXBzID0gMDsKICAgIH0KCiAgICBMb2dpY19QbGF5ZXIucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgY2hhcmFjdGVyLCBjaGFyYWN0ZXJzLCBkaXJlY3Rpb24sIGV2ZW50LCBldmVudHMsIHBvc2l0aW9uLCBfaSwgX2osIF9sZW4sIF9sZW4xLCBfcmVzdWx0czsKICAgICAgTG9naWNfUGxheWVyLl9fc3VwZXJfXy51cGRhdGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgZGlyZWN0aW9uID0gSW5wdXQuZGlyNCgpOwogICAgICBwb3NpdGlvbiA9IDA7CiAgICAgIGV2ZW50cyA9IG51bGw7CiAgICAgIGNoYXJhY3RlcnMgPSBudWxsOwogICAgICBpZiAoZGlyZWN0aW9uID4gMCAmJiAhdGhpcy5pc01vdmluZykgewogICAgICAgIHRoaXMuZGlyZWN0aW9uID0gZGlyZWN0aW9uOwogICAgICAgIGlmICh0aGlzLmNhbk1vdmUoZGlyZWN0aW9uKSkgewogICAgICAgICAgdGhpcy5tb3ZlKGRpcmVjdGlvbik7CiAgICAgICAgICB0aGlzLnN0ZXBzKys7CiAgICAgICAgfQogICAgICAgIHBvc2l0aW9uID0gdGhpcy5uZXh0UG9zaXRpb25JbmRleChkaXJlY3Rpb24pOwogICAgICAgIGNoYXJhY3RlcnMgPSB0aGlzLmNvbGxpc2lvbk1hcFtwb3NpdGlvbl07CiAgICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBjaGFyYWN0ZXJzLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7CiAgICAgICAgICBjaGFyYWN0ZXIgPSBjaGFyYWN0ZXJzW19pXTsKICAgICAgICAgIGlmIChjaGFyYWN0ZXIgIT09IHRoaXMgJiYgY2hhcmFjdGVyLmN1cnJlbnRQYWdlLnN0YXJ0Q29uZGl0aW9uID09PSAyKSB7CiAgICAgICAgICAgIGNoYXJhY3Rlci5zdGFydCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICBpZiAoSW5wdXQudHJpZ2dlcihJbnB1dC5DKSAmJiAhdGhpcy5pc01vdmluZykgewogICAgICAgIHBvc2l0aW9uID0gdGhpcy5uZXh0UG9zaXRpb25JbmRleCh0aGlzLmRpcmVjdGlvbik7CiAgICAgICAgZXZlbnRzID0gdGhpcy5jb2xsaXNpb25NYXBbcG9zaXRpb25dOwogICAgICAgIF9yZXN1bHRzID0gW107CiAgICAgICAgZm9yIChfaiA9IDAsIF9sZW4xID0gZXZlbnRzLmxlbmd0aDsgX2ogPCBfbGVuMTsgX2orKykgewogICAgICAgICAgZXZlbnQgPSBldmVudHNbX2pdOwogICAgICAgICAgaWYgKGV2ZW50LmN1cnJlbnRQYWdlLnN0YXJ0Q29uZGl0aW9uID09PSAwKSB7CiAgICAgICAgICAgIF9yZXN1bHRzLnB1c2goZXZlbnQuc3RhcnQoKSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBfcmVzdWx0cy5wdXNoKHZvaWQgMCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBfcmVzdWx0czsKICAgICAgfQogICAgfTsKCiAgICByZXR1cm4gTG9naWNfUGxheWVyOwoKICB9KShMb2dpY19DaGFyYWN0ZXIpOwoKICB3aW5kb3cuTG9naWNfUGxheWVyID0gTG9naWNfUGxheWVyOwoKfSkuY2FsbCh0aGlzKTsK"},{"name":"Logic_Map","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogTG9naWNfTWFwCiMgICBDcmVhdGVkIG9uOiAyMDEzLTA5LTAxCiMKIyAgIENvcHlyaWdodCAoQykgMjAxMyBBbmRy6SBSYWRvbXNraS4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KIwojICAgQ2xhc3M6IExvZ2ljX01hcAojCiMgICBBIGJhc2UgY2xhc3MgZm9yIGFsbCBvdGhlciB3aW5kb3cgY2xhc3Nlcy4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCmNsYXNzIExvZ2ljX01hcAogICAgY29uc3RydWN0b3I6IChtYXBVaWQpIC0+CiAgICAgICAgQGlkID0gbWFwVWlkCiAgICAgICAgQG1hcCA9IERhdGFNYW5hZ2VyLmdldERvY3VtZW50KG1hcFVpZCkKICAgICAgICBAZXZlbnRzID0gW10KICAgICAgICBAZXZlbnRzQnlJZCA9IHt9CiAgICAgICAgQHBsYXllciA9IG51bGwKICAgICAgICBAY29sbGlzaW9uTWFwID0gbnVsbAogICAgICAgIEBjdXJyZW50RXZlbnQgPSBudWxsCiAgICAgICAgQHN0ZXBzID0gMAogICAgICAgIEB0aWxlU2l6ZSA9IGlmIFJlY29yZE1hbmFnZXIuc3lzdGVtLnJlc29sdXRpb24gPT0gMCB0aGVuIDE2IGVsc2UgMzIKICAgICAgICBAcmFuZG9tUmF0ZSA9IEByYW5kb21FbmNvdW50ZXJSYXRlKCkKICAgICAgICBAY2FjaGVJbmRpY2VzID0gW10KICAgICAgICBAYmF0dGxlU3RhcnQgPSBubwogICAgcHJlcGFyZTogLT4KICAgICAgICBEYXRhT3B0aW1pemVyLm9wdGltaXplTWFwKEBtYXAuaXRlbXMpCiAgICAgIAogICAgICAgIEBtYXAuaXRlbXMudGlsZVNpemUgPSBAdGlsZVNpemUKICAgICAgICBAd2lkdGggPSBAbWFwLml0ZW1zLndpZHRoCiAgICAgICAgQGhlaWdodCA9IEBtYXAuaXRlbXMuaGVpZ2h0CiAgICAgICAgQGRlcHRoID0gQG1hcC5pdGVtcy5kZXB0aAogICAgICAgIEBtYXBEYXRhID0gQG1hcC5pdGVtcy5tYXBEYXRhCiAgICAgICAgQHJlZ2lvbkRhdGEgPSBAbWFwLml0ZW1zLnJlZ2lvbkRhdGEKICAgICAgICBAc3RlcHNBdmVyYWdlID0gQG1hcC5pdGVtcy5zdGVwc0F2ZXJhZ2UKICAgICAgICBAZW5jb3VudGVycyA9IEBtYXAuaXRlbXMuZW5jb3VudGVycwogICAgICAgIEB0aWxlc2V0ID0gUmVjb3JkTWFuYWdlci50aWxlc2V0c1tAbWFwLml0ZW1zLnRpbGVzZXRJZF0KICAgICAgICBAY3VycmVudFRpbGVzZXQgPSBAdGlsZXNldAogICAgICAgIEBhdXRvdGlsZXMgPSBAdGlsZXNldC5hdXRvdGlsZUdyYXBoaWNzCiAgICAgICAgQHBhcmFsbGF4QmFja2dyb3VuZCA9IEBtYXAuaXRlbXMucGFyYWxsYXhCYWNrZ3JvdW5kCiAgICAgICAgQHZlcnRpY2FsUGFyYWxsYXhTY3JvbGwgPSBAbWFwLml0ZW1zLnZlcnRpY2FsUGFyYWxsYXhTY3JvbGwKICAgICAgICBAaG9yaXpvbnRhbFBhcmFsbGF4U2Nyb2xsID0gQG1hcC5pdGVtcy5ob3Jpem9udGFsUGFyYWxsYXhTY3JvbGwKICAgICAgICBAbG9vcFBhcmFsbGF4VmVydGljYWwgPSBAbWFwLml0ZW1zLmxvb3BQYXJhbGxheFZlcnRpY2FsCiAgICAgICAgQGxvb3BQYXJhbGxheEhvcml6b250YWwgPSBAbWFwLml0ZW1zLmxvb3BQYXJhbGxheEhvcml6b250YWwKICAgICAgICBAbG9vcFR5cGUgPSBAbWFwLml0ZW1zLmxvb3BUeXBlCiAgICAgICAgQHRlcnJhaW5zID0gW10KICAgICAgICBAZXZlbnREZWxldGlvbnMgPSBHYW1lTWFuYWdlci5ldmVudERlbGV0aW9uc1tAaWRdIHx8IFtdCiAgICAgICAgQGV2ZW50Q3JlYXRpb25zID0gR2FtZU1hbmFnZXIuZXZlbnRDcmVhdGlvbnNbQGlkXSB8fCBbXQogICAgICAgIEBhdXRvUGxheU11c2ljID0gQG1hcC5pdGVtcy5hdXRvUGxheU11c2ljCiAgICAgICAgQGF1dG9QbGF5QmFja2dyb3VuZFNvdW5kID0gQG1hcC5pdGVtcy5hdXRvUGxheUJhY2tncm91bmRTb3VuZAogICAgICAgIEBtdXNpYyA9IEBtYXAuaXRlbXMubXVzaWMKICAgICAgICBAYmFja2dyb3VuZFNvdW5kID0gQG1hcC5pdGVtcy5iYWNrZ3JvdW5kU291bmQKICAgICAgICAKICAgICAgICBmb3IgdGVycmFpbiBpbiBAdGlsZXNldC50ZXJyYWlucwogICAgICAgICAgICBAdGVycmFpbnNbdGVycmFpbi50YWddID0gUmVjb3JkTWFuYWdlci50ZXJyYWluc1t0ZXJyYWluLnRlcnJhaW5JZF0KICAgICAgICAKICAgICAgICBAY29sbGlzaW9uTWFwID0gbmV3IEFycmF5KEB3aWR0aCAqIEBoZWlnaHQpCiAgICAgICAgZm9yIGkgaW4gWzAuLi5AY29sbGlzaW9uTWFwLmxlbmd0aF0KICAgICAgICAgICAgQGNvbGxpc2lvbk1hcFtpXSA9IFtdCiAgICAgICAgICAgIAogICAgICAgIERhdGFPcHRpbWl6ZXIub3B0aW1pemVUaWxlc2V0KEB0aWxlc2V0KQogICAgICAgICAgICAKICAgICAgICBAcGxheWVyID0gR2FtZU1hbmFnZXIucGxheWVyCiAgICAgICAgQHBsYXllci5tYXAgPSBAbWFwLml0ZW1zCiAgICAgICAgQHBsYXllci5tYXBEYXRhID0gQG1hcERhdGEKICAgICAgICBAcGxheWVyLm1hcExvZ2ljID0gdGhpcwogICAgICAgIEBwbGF5ZXIudGlsZXNldCA9IEB0aWxlc2V0CiAgICAgICAgQHBsYXllci5jb2xsaXNpb25NYXAgPSBAY29sbGlzaW9uTWFwCiAgICAgICAgQHBsYXllci54ID0gQHBsYXllci5ldmVudC54ICogQHRpbGVTaXplCiAgICAgICAgQHBsYXllci55ID0gQHBsYXllci5ldmVudC55ICogQHRpbGVTaXplCiAgICAgICAgQHBsYXllci5jaGVja0J1c2hGbGFnKCkKCiAgICAgICAgcGxheWVySW5kZXggPSBAcGxheWVyLmV2ZW50LnkgKiBAd2lkdGggKyBAcGxheWVyLmV2ZW50LngKICAgICAgICBAY29sbGlzaW9uTWFwW3BsYXllckluZGV4XS5wdXNoKEBwbGF5ZXIpCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgZm9yIGkgaW4gWzAuLi5AbWFwLml0ZW1zLmV2ZW50cy5sZW5ndGhdCiAgICAgICAgICAgIEBhZGRFdmVudEZyb21EYXRhKEBtYXAuaXRlbXMuZXZlbnRzW2ldKQogICAgICAgICAgICAKICAgICAgICBmb3IgZXZlbnQgaW4gR2FtZU1hbmFnZXIuZ2xvYmFsRXZlbnRzCiAgICAgICAgICAgIGlmIGV2ZW50ICE9IEdhbWVNYW5hZ2VyLnBsYXllciBhbmQgZXZlbnQubWFwVWlkID09IEBpZAogICAgICAgICAgICAgICAgZXZlbnQubWFwID0gQG1hcC5pdGVtcwogICAgICAgICAgICAgICAgZXZlbnQubWFwRGF0YSA9IEBtYXBEYXRhCiAgICAgICAgICAgICAgICBldmVudC5tYXBMb2dpYyA9IHRoaXMKICAgICAgICAgICAgICAgIGV2ZW50LmNvbGxpc2lvbk1hcCA9IEBjb2xsaXNpb25NYXAKICAgICAgICAgICAgICAgIGV2ZW50LnRpbGVzZXQgPSBAdGlsZXNldAogICAgICAgICAgICAgICAgQGNvbGxpc2lvbk1hcFtldmVudC5ldmVudC55ICogQHdpZHRoICsgZXZlbnQuZXZlbnQueF0ucHVzaChldmVudCkKICAgICAgICAgICAgICAgIGV2ZW50LmNoZWNrQnVzaEZsYWcoKQogICAgICAgICAgICAgICAgCiAgICAgICAgZm9yIGRlbGV0aW9uIGluIEBldmVudERlbGV0aW9ucwogICAgICAgICAgICBldmVudCA9IEBldmVudHNCeUlkW2RlbGV0aW9uLmV2ZW50SWRdCiAgICAgICAgICAgIGlmIGV2ZW50PyB0aGVuIGV2ZW50LmVyYXNlKCkKICAgICAgICAgICAgCiAgICAgICAgZm9yIGNyZWF0aW9uIGluIEBldmVudENyZWF0aW9ucwogICAgICAgICAgICBAYWRkRXZlbnRGcm9tRGF0YShjcmVhdGlvbikKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgQXVkaW9NYW5hZ2VyLmxvYWRNdXNpYyhAbXVzaWMpCiAgICAgICAgQXVkaW9NYW5hZ2VyLmxvYWRCYWNrZ3JvdW5kU291bmQoQGJhY2tncm91bmRTb3VuZCkKICAgICAgICAKICAgICAgICAKICAgICAgICByZXR1cm4gbnVsbAogICAgdXBkYXRlOiAtPgogICAgICAgIHRlcnJhaW4gPSBAdGVycmFpbnNbQHBsYXllci50ZXJyYWluVGFnXQogICAgICAgIGVuY291bnRlclJhdGUgPSBpZiB0ZXJyYWluPyB0aGVuIHRlcnJhaW4uZW5jb3VudGVyUmF0ZSBlbHNlIDEwMAogICAgICAgIAogICAgICAgIAogICAgICAgIGZvciBwaWN0dXJlIGluIEdhbWVNYW5hZ2VyLnBpY3R1cmVzCiAgICAgICAgICAgIGlmIHBpY3R1cmU/IHRoZW4gcGljdHVyZS5sb2dpYy51cGRhdGUoKQogICAgICAgIGZvciB0ZXh0IGluIEdhbWVNYW5hZ2VyLnRleHRzCiAgICAgICAgICAgIGlmIHRleHQ/IHRoZW4gdGV4dC5sb2dpYy51cGRhdGUoKQogICAgICAgIGlmIEdhbWVNYW5hZ2VyLm1hcEVuY291bnRlciBhbmQgQHN0ZXBzQXZlcmFnZSA+IDAgYW5kIEByZWdpb25EYXRhPyBhbmQgKEBwbGF5ZXIuc3RlcHMgLSBAc3RlcHMpID09IE1hdGguZmxvb3IoKEBzdGVwc0F2ZXJhZ2UrQHN0ZXBzQXZlcmFnZSpAcmFuZG9tUmF0ZSkgKiAoZW5jb3VudGVyUmF0ZSAvIDEwMCkpCiAgICAgICAgICAgIEBzdGVwcyA9IEBwbGF5ZXIuc3RlcHMKICAgICAgICAgICAgQGJhdHRsZVN0YXJ0ID0geWVzCiAgICAgICAgICAgIEByYW5kb21SYXRlID0gQHJhbmRvbUVuY291bnRlclJhdGUoKQogICAgICAgICAgICBAcGxheWVyLmlzTG9ja2VkID0geWVzCiAgICAgICAgZm9yIGkgaW4gWzAuLi5AZXZlbnRzLmxlbmd0aF0KICAgICAgICAgICAgZXZlbnQgPSBAZXZlbnRzW2ldCiAgICAgICAgICAgIGlmIGV2ZW50PwogICAgICAgICAgICAgICAgQGN1cnJlbnRFdmVudCA9IGV2ZW50CiAgICAgICAgICAgICAgICBldmVudC50ZXJyYWlucyA9IEB0ZXJyYWlucwogICAgICAgICAgICAgICAgZXZlbnQudXBkYXRlKCkKICAgICAgICAgICAgICAgIAogICAgICAgIGZvciBldmVudCBpbiBHYW1lTWFuYWdlci5nbG9iYWxFdmVudHMKICAgICAgICAgICAgaWYgZXZlbnQubWFwVWlkID09IEBpZAogICAgICAgICAgICAgICAgQGN1cnJlbnRFdmVudCA9IGV2ZW50CiAgICAgICAgICAgICAgICBldmVudC50ZXJyYWlucyA9IEB0ZXJyYWlucwogICAgICAgICAgICAgICAgZXZlbnQudXBkYXRlKCkKICAgICAgICAgICAgICAgIAogICAgICAgIGlmIEBiYXR0bGVTdGFydCBhbmQgbm90IEBwbGF5ZXIuaXNNb3ZpbmcKICAgICAgICAgICAgQGJhdHRsZVN0YXJ0ID0gbm8KICAgICAgICAgICAgdHJvb3AgPSBAc2VsZWN0VHJvb3AoQHJlZ2lvbkRhdGFbTWF0aC5mbG9vcihAcGxheWVyLnkgLyBAdGlsZVNpemUpICogQHdpZHRoICsgTWF0aC5mbG9vcihAcGxheWVyLnggLyBAdGlsZVNpemUpXSkKICAgICAgICAgICAgaWYgdHJvb3A/IHRoZW4gQHN0YXJ0QmF0dGxlKHRyb29wKQogICAgICAgICAgICBAcGxheWVyLmlzTG9ja2VkID0gbm8KICAgICAgICAgICAgICAgIAogICAgICAgIEBwbGF5ZXIgPSBHYW1lTWFuYWdlci5wbGF5ZXIKICAgICAgICBHYW1lTWFuYWdlci5wbGF5ZXIuaXNQbGF5ZXIgPSAhR2FtZU1hbmFnZXIuaW50ZXJwcmV0ZXIuaXNSdW5uaW5nCiAgICAgICAgI0BwbGF5ZXIudXBkYXRlKCkgICAgCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgR2FtZU1hbmFnZXIuYmF0dGxlVGVycmFpbiA9IHRlcnJhaW4KICAgICAgICBHYW1lTWFuYWdlci5wbGF5ZXIudGVycmFpbiA9IHRlcnJhaW4KICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICByZXR1cm4gbnVsbAogICAgICAgIAogICAgc2V0VGlsZTogKHgsIHksIHosIHRpbGUpIC0+CiAgICAgICAgeiA9IE1hdGgubWF4KE1hdGgubWluKHosIEBkZXB0aC0xKSwgMCkKICAgICAgICBvZmZzZXQgPSBAd2lkdGggKiBAaGVpZ2h0ICogegogICAgICAgIAogICAgICAgIGlmIHRpbGU/CiAgICAgICAgICAgIHggPSBNYXRoLm1heChNYXRoLm1pbih4LCBAd2lkdGgtMSksIDApCiAgICAgICAgICAgIHkgPSBNYXRoLm1heChNYXRoLm1pbih5LCBAaGVpZ2h0LTEpLCAwKQogICAgICAgICAgICBpbmRleCA9IHkgKiBAd2lkdGggKyB4ICsgb2Zmc2V0CiAgICAgICAgICAgIEBtYXBEYXRhW2luZGV4XSA9IHRpbGUKICAgICAgICAgICAgQGNhY2hlSW5kaWNlcy5wdXNoKGluZGV4KQogICAgICAgIGVsc2UKICAgICAgICAgICAgZm9yIGkgaW4gWzAuLi5Ad2lkdGhdCiAgICAgICAgICAgICAgICBmb3IgaiBpbiBbMC4uLkBoZWlnaHRdCiAgICAgICAgICAgICAgICAgICAgaW5kZXggPSBqICogQHdpZHRoICsgaSArIG9mZnNldAogICAgICAgICAgICAgICAgICAgIGlmIEBtYXBEYXRhW2luZGV4XSA9PSB4ICMgVGFyZ2V0IFRpbGUKICAgICAgICAgICAgICAgICAgICAgICAgQG1hcERhdGFbaW5kZXhdID0geSAjIFNvdXJjZSBUaWxlCiAgICAgICAgICAgICAgICAgICAgICAgIEBjYWNoZUluZGljZXMucHVzaChpbmRleCkKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgCiAgICAgCiAgICAgICAgcmV0dXJuIG51bGwKICAgICAgICAKICAgIHJhbmRvbUVuY291bnRlclJhdGU6IC0+IChNYXRoLnJhbmRvbSgpICogMjUgLSBNYXRoLnJhbmRvbSgpICogMjUpIC8gMTAwCiAgICAgICAgCiAgICBhZGRFdmVudEZyb21EYXRhOiAoZGF0YSkgLT4KICAgICAgICBldmVudCA9IGRhdGEKICAgICAgICBsb2dpYyA9IG5ldyBMb2dpY19FdmVudChldmVudCwgZXZlbnQuaWQpCiAgICAgICAgbG9naWMubWFwID0gQG1hcC5pdGVtcwogICAgICAgIGxvZ2ljLm1hcERhdGEgPSBAbWFwRGF0YQogICAgICAgIGxvZ2ljLm1hcExvZ2ljID0gdGhpcwogICAgICAgIGxvZ2ljLmNvbGxpc2lvbk1hcCA9IEBjb2xsaXNpb25NYXAKICAgICAgICBsb2dpYy50aWxlc2V0ID0gQHRpbGVzZXQKICAgICAgICBAY29sbGlzaW9uTWFwW2V2ZW50LnkgKiBAd2lkdGggKyBldmVudC54XS5wdXNoKGxvZ2ljKQogICAgICAgIAogICAgICAgIEBldmVudHMucHVzaChsb2dpYykKICAgICAgICBAZXZlbnRzQnlJZFtldmVudC5pZF0gPSBsb2dpYwogICAgICAgIGxvZ2ljLmNoZWNrQnVzaEZsYWcoKQogICAgICAgICAgICAKICAgIHNlbGVjdFRyb29wOiAocmVnaW9uKSAtPgogICAgICAgIGlmIHJlZ2lvbiA9PSAwIHRoZW4gcmV0dXJuIG51bGwKICAgICAgICAKICAgICAgICBlbmNvdW50ZXJzID0gW10KICAgICAgICByYXRlU3VtID0gMAogICAgICAgIHZhbHVlID0gMAogICAgICAgIHRyb29wID0gbnVsbAogICAgICAgIAogICAgICAgIGZvciBlbmNvdW50ZXIgaW4gQGVuY291bnRlcnMKICAgICAgICAgICAgaWYgZW5jb3VudGVyLnJlZ2lvbjEgPT0gcmVnaW9uIG9yIGVuY291bnRlci5yZWdpb24yID09IHJlZ2lvbiBvciBlbmNvdW50ZXIucmVnaW9uMyA9PSByZWdpb24KICAgICAgICAgICAgICAgIGVuY291bnRlcnMucHVzaChlbmNvdW50ZXIpCiAgICAgICAgICAgICAgICByYXRlU3VtICs9IGVuY291bnRlci5yYXRlCiAgICAgICAgICAgICAgICAKICAgICAgICB2YWx1ZSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHJhdGVTdW0pCiAgICAgICAgCiAgICAgICAgZm9yIGVuY291bnRlciBpbiBlbmNvdW50ZXJzCiAgICAgICAgICAgIGlmIHZhbHVlIDw9IGVuY291bnRlci5yYXRlCiAgICAgICAgICAgICAgICB0cm9vcCA9IFJlY29yZE1hbmFnZXIudHJvb3BzW2VuY291bnRlci50cm9vcElkXQogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgdmFsdWUgLT0gZW5jb3VudGVyLnJhdGUKICAgICAgICAgICAgCiAgICAgICAgcmV0dXJuIHRyb29wCiAgICAgICAgCiAgICBzdGFydEJhdHRsZTogKHRyb29wKSAtPgogICAgICAgIEdhbWVNYW5hZ2VyLnRyb29wID0gdHJvb3AKICAgICAgICBTY2VuZU1hbmFnZXIuc3dpdGNoVG8obmV3IFNjZW5lX0JhdHRsZSgpKQogICAgICAgIAogICAgbG9jYXRpb25EYXRhOiAoeCwgeSwgdHlwZSkgLT4KICAgICAgICByZXN1bHQgPSAwCiAgICAgICAgdGlsZSA9IDAKICAgICAgICBwb3NpdGlvbiA9IHkgKiBAd2lkdGggKyB4CiAgICAgICAgdGlsZUlkID0gQG1hcERhdGFbcG9zaXRpb25dCiAgICAgICAgCiAgICAgICAgc3dpdGNoKHR5cGUpCiAgICAgICAgICAgIHdoZW4gMCAjIFRlcnJhaW4gSUQKICAgICAgICAgICAgICAgIHJlc3VsdCA9IEB0aWxlc2V0LnRlcnJhaW5UYWdzW3RpbGVJZF0KICAgICAgICAgICAgd2hlbiAxICMgUmVnaW9uIElECiAgICAgICAgICAgICAgICByZXN1bHQgPSBAcmVnaW9uRGF0YVtwb3NpdGlvbl0KICAgICAgICAgICAgd2hlbiAyICMgVGlsZSBJRCAtIExheWVyIDEKICAgICAgICAgICAgICAgIHJlc3VsdCA9IEBtYXBEYXRhW3Bvc2l0aW9uXQogICAgICAgICAgICB3aGVuIDMgIyBUaWxlIElEIC0gTGF5ZXIgMgogICAgICAgICAgICAgICAgcmVzdWx0ID0gQG1hcERhdGFbcG9zaXRpb24gKyBAd2lkdGggKiBAaGVpZ2h0XQogICAgICAgICAgICB3aGVuIDQgIyBUaWxlIElEIC0gTGF5ZXIgMwogICAgICAgICAgICAgICAgcmVzdWx0ID0gQG1hcERhdGFbcG9zaXRpb24gKyBAd2lkdGggKiBAaGVpZ2h0ICogMl0KICAgICAgICAgICAgd2hlbiA1ICMgUGFzc2FnZQogICAgICAgICAgICAgICAgc2l6ZSA9IEB3aWR0aCAqIEBoZWlnaHQKICAgICAgICAgICAgICAgIGZvciBpIGluIFswLi4uQGRlcHRoXQogICAgICAgICAgICAgICAgICAgIHRpbGUgPSBAbWFwRGF0YVtwb3NpdGlvbiArIGkgKiBzaXplXQogICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IEB0aWxlc2V0LnBhc3NhZ2VzW3RpbGVdCiAgICAgICAgICAgICAgICAgICAgaWYgcmVzdWx0ICE9IDAgdGhlbiBicmVhawoKICAgICAgICByZXR1cm4gcmVzdWx0Cgp3aW5kb3cuTG9naWNfTWFwID0gTG9naWNfTWFw","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBMb2dpY19NYXA7CgogIExvZ2ljX01hcCA9IChmdW5jdGlvbigpIHsKICAgIGZ1bmN0aW9uIExvZ2ljX01hcChtYXBVaWQpIHsKICAgICAgdGhpcy5pZCA9IG1hcFVpZDsKICAgICAgdGhpcy5tYXAgPSBEYXRhTWFuYWdlci5nZXREb2N1bWVudChtYXBVaWQpOwogICAgICB0aGlzLmV2ZW50cyA9IFtdOwogICAgICB0aGlzLmV2ZW50c0J5SWQgPSB7fTsKICAgICAgdGhpcy5wbGF5ZXIgPSBudWxsOwogICAgICB0aGlzLmNvbGxpc2lvbk1hcCA9IG51bGw7CiAgICAgIHRoaXMuY3VycmVudEV2ZW50ID0gbnVsbDsKICAgICAgdGhpcy5zdGVwcyA9IDA7CiAgICAgIHRoaXMudGlsZVNpemUgPSBSZWNvcmRNYW5hZ2VyLnN5c3RlbS5yZXNvbHV0aW9uID09PSAwID8gMTYgOiAzMjsKICAgICAgdGhpcy5yYW5kb21SYXRlID0gdGhpcy5yYW5kb21FbmNvdW50ZXJSYXRlKCk7CiAgICAgIHRoaXMuY2FjaGVJbmRpY2VzID0gW107CiAgICAgIHRoaXMuYmF0dGxlU3RhcnQgPSBmYWxzZTsKICAgIH0KCiAgICBMb2dpY19NYXAucHJvdG90eXBlLnByZXBhcmUgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGNyZWF0aW9uLCBkZWxldGlvbiwgZXZlbnQsIGksIHBsYXllckluZGV4LCB0ZXJyYWluLCBfaSwgX2osIF9rLCBfbCwgX2xlbiwgX2xlbjEsIF9sZW4yLCBfbGVuMywgX20sIF9uLCBfcmVmLCBfcmVmMSwgX3JlZjIsIF9yZWYzLCBfcmVmNCwgX3JlZjU7CiAgICAgIERhdGFPcHRpbWl6ZXIub3B0aW1pemVNYXAodGhpcy5tYXAuaXRlbXMpOwogICAgICB0aGlzLm1hcC5pdGVtcy50aWxlU2l6ZSA9IHRoaXMudGlsZVNpemU7CiAgICAgIHRoaXMud2lkdGggPSB0aGlzLm1hcC5pdGVtcy53aWR0aDsKICAgICAgdGhpcy5oZWlnaHQgPSB0aGlzLm1hcC5pdGVtcy5oZWlnaHQ7CiAgICAgIHRoaXMuZGVwdGggPSB0aGlzLm1hcC5pdGVtcy5kZXB0aDsKICAgICAgdGhpcy5tYXBEYXRhID0gdGhpcy5tYXAuaXRlbXMubWFwRGF0YTsKICAgICAgdGhpcy5yZWdpb25EYXRhID0gdGhpcy5tYXAuaXRlbXMucmVnaW9uRGF0YTsKICAgICAgdGhpcy5zdGVwc0F2ZXJhZ2UgPSB0aGlzLm1hcC5pdGVtcy5zdGVwc0F2ZXJhZ2U7CiAgICAgIHRoaXMuZW5jb3VudGVycyA9IHRoaXMubWFwLml0ZW1zLmVuY291bnRlcnM7CiAgICAgIHRoaXMudGlsZXNldCA9IFJlY29yZE1hbmFnZXIudGlsZXNldHNbdGhpcy5tYXAuaXRlbXMudGlsZXNldElkXTsKICAgICAgdGhpcy5jdXJyZW50VGlsZXNldCA9IHRoaXMudGlsZXNldDsKICAgICAgdGhpcy5hdXRvdGlsZXMgPSB0aGlzLnRpbGVzZXQuYXV0b3RpbGVHcmFwaGljczsKICAgICAgdGhpcy5wYXJhbGxheEJhY2tncm91bmQgPSB0aGlzLm1hcC5pdGVtcy5wYXJhbGxheEJhY2tncm91bmQ7CiAgICAgIHRoaXMudmVydGljYWxQYXJhbGxheFNjcm9sbCA9IHRoaXMubWFwLml0ZW1zLnZlcnRpY2FsUGFyYWxsYXhTY3JvbGw7CiAgICAgIHRoaXMuaG9yaXpvbnRhbFBhcmFsbGF4U2Nyb2xsID0gdGhpcy5tYXAuaXRlbXMuaG9yaXpvbnRhbFBhcmFsbGF4U2Nyb2xsOwogICAgICB0aGlzLmxvb3BQYXJhbGxheFZlcnRpY2FsID0gdGhpcy5tYXAuaXRlbXMubG9vcFBhcmFsbGF4VmVydGljYWw7CiAgICAgIHRoaXMubG9vcFBhcmFsbGF4SG9yaXpvbnRhbCA9IHRoaXMubWFwLml0ZW1zLmxvb3BQYXJhbGxheEhvcml6b250YWw7CiAgICAgIHRoaXMubG9vcFR5cGUgPSB0aGlzLm1hcC5pdGVtcy5sb29wVHlwZTsKICAgICAgdGhpcy50ZXJyYWlucyA9IFtdOwogICAgICB0aGlzLmV2ZW50RGVsZXRpb25zID0gR2FtZU1hbmFnZXIuZXZlbnREZWxldGlvbnNbdGhpcy5pZF0gfHwgW107CiAgICAgIHRoaXMuZXZlbnRDcmVhdGlvbnMgPSBHYW1lTWFuYWdlci5ldmVudENyZWF0aW9uc1t0aGlzLmlkXSB8fCBbXTsKICAgICAgdGhpcy5hdXRvUGxheU11c2ljID0gdGhpcy5tYXAuaXRlbXMuYXV0b1BsYXlNdXNpYzsKICAgICAgdGhpcy5hdXRvUGxheUJhY2tncm91bmRTb3VuZCA9IHRoaXMubWFwLml0ZW1zLmF1dG9QbGF5QmFja2dyb3VuZFNvdW5kOwogICAgICB0aGlzLm11c2ljID0gdGhpcy5tYXAuaXRlbXMubXVzaWM7CiAgICAgIHRoaXMuYmFja2dyb3VuZFNvdW5kID0gdGhpcy5tYXAuaXRlbXMuYmFja2dyb3VuZFNvdW5kOwogICAgICBfcmVmID0gdGhpcy50aWxlc2V0LnRlcnJhaW5zOwogICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICB0ZXJyYWluID0gX3JlZltfaV07CiAgICAgICAgdGhpcy50ZXJyYWluc1t0ZXJyYWluLnRhZ10gPSBSZWNvcmRNYW5hZ2VyLnRlcnJhaW5zW3RlcnJhaW4udGVycmFpbklkXTsKICAgICAgfQogICAgICB0aGlzLmNvbGxpc2lvbk1hcCA9IG5ldyBBcnJheSh0aGlzLndpZHRoICogdGhpcy5oZWlnaHQpOwogICAgICBmb3IgKGkgPSBfaiA9IDAsIF9yZWYxID0gdGhpcy5jb2xsaXNpb25NYXAubGVuZ3RoOyAwIDw9IF9yZWYxID8gX2ogPCBfcmVmMSA6IF9qID4gX3JlZjE7IGkgPSAwIDw9IF9yZWYxID8gKytfaiA6IC0tX2opIHsKICAgICAgICB0aGlzLmNvbGxpc2lvbk1hcFtpXSA9IFtdOwogICAgICB9CiAgICAgIERhdGFPcHRpbWl6ZXIub3B0aW1pemVUaWxlc2V0KHRoaXMudGlsZXNldCk7CiAgICAgIHRoaXMucGxheWVyID0gR2FtZU1hbmFnZXIucGxheWVyOwogICAgICB0aGlzLnBsYXllci5tYXAgPSB0aGlzLm1hcC5pdGVtczsKICAgICAgdGhpcy5wbGF5ZXIubWFwRGF0YSA9IHRoaXMubWFwRGF0YTsKICAgICAgdGhpcy5wbGF5ZXIubWFwTG9naWMgPSB0aGlzOwogICAgICB0aGlzLnBsYXllci50aWxlc2V0ID0gdGhpcy50aWxlc2V0OwogICAgICB0aGlzLnBsYXllci5jb2xsaXNpb25NYXAgPSB0aGlzLmNvbGxpc2lvbk1hcDsKICAgICAgdGhpcy5wbGF5ZXIueCA9IHRoaXMucGxheWVyLmV2ZW50LnggKiB0aGlzLnRpbGVTaXplOwogICAgICB0aGlzLnBsYXllci55ID0gdGhpcy5wbGF5ZXIuZXZlbnQueSAqIHRoaXMudGlsZVNpemU7CiAgICAgIHRoaXMucGxheWVyLmNoZWNrQnVzaEZsYWcoKTsKICAgICAgcGxheWVySW5kZXggPSB0aGlzLnBsYXllci5ldmVudC55ICogdGhpcy53aWR0aCArIHRoaXMucGxheWVyLmV2ZW50Lng7CiAgICAgIHRoaXMuY29sbGlzaW9uTWFwW3BsYXllckluZGV4XS5wdXNoKHRoaXMucGxheWVyKTsKICAgICAgZm9yIChpID0gX2sgPSAwLCBfcmVmMiA9IHRoaXMubWFwLml0ZW1zLmV2ZW50cy5sZW5ndGg7IDAgPD0gX3JlZjIgPyBfayA8IF9yZWYyIDogX2sgPiBfcmVmMjsgaSA9IDAgPD0gX3JlZjIgPyArK19rIDogLS1faykgewogICAgICAgIHRoaXMuYWRkRXZlbnRGcm9tRGF0YSh0aGlzLm1hcC5pdGVtcy5ldmVudHNbaV0pOwogICAgICB9CiAgICAgIF9yZWYzID0gR2FtZU1hbmFnZXIuZ2xvYmFsRXZlbnRzOwogICAgICBmb3IgKF9sID0gMCwgX2xlbjEgPSBfcmVmMy5sZW5ndGg7IF9sIDwgX2xlbjE7IF9sKyspIHsKICAgICAgICBldmVudCA9IF9yZWYzW19sXTsKICAgICAgICBpZiAoZXZlbnQgIT09IEdhbWVNYW5hZ2VyLnBsYXllciAmJiBldmVudC5tYXBVaWQgPT09IHRoaXMuaWQpIHsKICAgICAgICAgIGV2ZW50Lm1hcCA9IHRoaXMubWFwLml0ZW1zOwogICAgICAgICAgZXZlbnQubWFwRGF0YSA9IHRoaXMubWFwRGF0YTsKICAgICAgICAgIGV2ZW50Lm1hcExvZ2ljID0gdGhpczsKICAgICAgICAgIGV2ZW50LmNvbGxpc2lvbk1hcCA9IHRoaXMuY29sbGlzaW9uTWFwOwogICAgICAgICAgZXZlbnQudGlsZXNldCA9IHRoaXMudGlsZXNldDsKICAgICAgICAgIHRoaXMuY29sbGlzaW9uTWFwW2V2ZW50LmV2ZW50LnkgKiB0aGlzLndpZHRoICsgZXZlbnQuZXZlbnQueF0ucHVzaChldmVudCk7CiAgICAgICAgICBldmVudC5jaGVja0J1c2hGbGFnKCk7CiAgICAgICAgfQogICAgICB9CiAgICAgIF9yZWY0ID0gdGhpcy5ldmVudERlbGV0aW9uczsKICAgICAgZm9yIChfbSA9IDAsIF9sZW4yID0gX3JlZjQubGVuZ3RoOyBfbSA8IF9sZW4yOyBfbSsrKSB7CiAgICAgICAgZGVsZXRpb24gPSBfcmVmNFtfbV07CiAgICAgICAgZXZlbnQgPSB0aGlzLmV2ZW50c0J5SWRbZGVsZXRpb24uZXZlbnRJZF07CiAgICAgICAgaWYgKGV2ZW50ICE9IG51bGwpIHsKICAgICAgICAgIGV2ZW50LmVyYXNlKCk7CiAgICAgICAgfQogICAgICB9CiAgICAgIF9yZWY1ID0gdGhpcy5ldmVudENyZWF0aW9uczsKICAgICAgZm9yIChfbiA9IDAsIF9sZW4zID0gX3JlZjUubGVuZ3RoOyBfbiA8IF9sZW4zOyBfbisrKSB7CiAgICAgICAgY3JlYXRpb24gPSBfcmVmNVtfbl07CiAgICAgICAgdGhpcy5hZGRFdmVudEZyb21EYXRhKGNyZWF0aW9uKTsKICAgICAgfQogICAgICBBdWRpb01hbmFnZXIubG9hZE11c2ljKHRoaXMubXVzaWMpOwogICAgICBBdWRpb01hbmFnZXIubG9hZEJhY2tncm91bmRTb3VuZCh0aGlzLmJhY2tncm91bmRTb3VuZCk7CiAgICAgIHJldHVybiBudWxsOwogICAgfTsKCiAgICBMb2dpY19NYXAucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgZW5jb3VudGVyUmF0ZSwgZXZlbnQsIGksIHBpY3R1cmUsIHRlcnJhaW4sIHRleHQsIHRyb29wLCBfaSwgX2osIF9rLCBfbCwgX2xlbiwgX2xlbjEsIF9sZW4yLCBfcmVmLCBfcmVmMSwgX3JlZjIsIF9yZWYzOwogICAgICB0ZXJyYWluID0gdGhpcy50ZXJyYWluc1t0aGlzLnBsYXllci50ZXJyYWluVGFnXTsKICAgICAgZW5jb3VudGVyUmF0ZSA9IHRlcnJhaW4gIT0gbnVsbCA/IHRlcnJhaW4uZW5jb3VudGVyUmF0ZSA6IDEwMDsKICAgICAgX3JlZiA9IEdhbWVNYW5hZ2VyLnBpY3R1cmVzOwogICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICBwaWN0dXJlID0gX3JlZltfaV07CiAgICAgICAgaWYgKHBpY3R1cmUgIT0gbnVsbCkgewogICAgICAgICAgcGljdHVyZS5sb2dpYy51cGRhdGUoKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgX3JlZjEgPSBHYW1lTWFuYWdlci50ZXh0czsKICAgICAgZm9yIChfaiA9IDAsIF9sZW4xID0gX3JlZjEubGVuZ3RoOyBfaiA8IF9sZW4xOyBfaisrKSB7CiAgICAgICAgdGV4dCA9IF9yZWYxW19qXTsKICAgICAgICBpZiAodGV4dCAhPSBudWxsKSB7CiAgICAgICAgICB0ZXh0LmxvZ2ljLnVwZGF0ZSgpOwogICAgICAgIH0KICAgICAgfQogICAgICBpZiAoR2FtZU1hbmFnZXIubWFwRW5jb3VudGVyICYmIHRoaXMuc3RlcHNBdmVyYWdlID4gMCAmJiAodGhpcy5yZWdpb25EYXRhICE9IG51bGwpICYmICh0aGlzLnBsYXllci5zdGVwcyAtIHRoaXMuc3RlcHMpID09PSBNYXRoLmZsb29yKCh0aGlzLnN0ZXBzQXZlcmFnZSArIHRoaXMuc3RlcHNBdmVyYWdlICogdGhpcy5yYW5kb21SYXRlKSAqIChlbmNvdW50ZXJSYXRlIC8gMTAwKSkpIHsKICAgICAgICB0aGlzLnN0ZXBzID0gdGhpcy5wbGF5ZXIuc3RlcHM7CiAgICAgICAgdGhpcy5iYXR0bGVTdGFydCA9IHRydWU7CiAgICAgICAgdGhpcy5yYW5kb21SYXRlID0gdGhpcy5yYW5kb21FbmNvdW50ZXJSYXRlKCk7CiAgICAgICAgdGhpcy5wbGF5ZXIuaXNMb2NrZWQgPSB0cnVlOwogICAgICB9CiAgICAgIGZvciAoaSA9IF9rID0gMCwgX3JlZjIgPSB0aGlzLmV2ZW50cy5sZW5ndGg7IDAgPD0gX3JlZjIgPyBfayA8IF9yZWYyIDogX2sgPiBfcmVmMjsgaSA9IDAgPD0gX3JlZjIgPyArK19rIDogLS1faykgewogICAgICAgIGV2ZW50ID0gdGhpcy5ldmVudHNbaV07CiAgICAgICAgaWYgKGV2ZW50ICE9IG51bGwpIHsKICAgICAgICAgIHRoaXMuY3VycmVudEV2ZW50ID0gZXZlbnQ7CiAgICAgICAgICBldmVudC50ZXJyYWlucyA9IHRoaXMudGVycmFpbnM7CiAgICAgICAgICBldmVudC51cGRhdGUoKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgX3JlZjMgPSBHYW1lTWFuYWdlci5nbG9iYWxFdmVudHM7CiAgICAgIGZvciAoX2wgPSAwLCBfbGVuMiA9IF9yZWYzLmxlbmd0aDsgX2wgPCBfbGVuMjsgX2wrKykgewogICAgICAgIGV2ZW50ID0gX3JlZjNbX2xdOwogICAgICAgIGlmIChldmVudC5tYXBVaWQgPT09IHRoaXMuaWQpIHsKICAgICAgICAgIHRoaXMuY3VycmVudEV2ZW50ID0gZXZlbnQ7CiAgICAgICAgICBldmVudC50ZXJyYWlucyA9IHRoaXMudGVycmFpbnM7CiAgICAgICAgICBldmVudC51cGRhdGUoKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKHRoaXMuYmF0dGxlU3RhcnQgJiYgIXRoaXMucGxheWVyLmlzTW92aW5nKSB7CiAgICAgICAgdGhpcy5iYXR0bGVTdGFydCA9IGZhbHNlOwogICAgICAgIHRyb29wID0gdGhpcy5zZWxlY3RUcm9vcCh0aGlzLnJlZ2lvbkRhdGFbTWF0aC5mbG9vcih0aGlzLnBsYXllci55IC8gdGhpcy50aWxlU2l6ZSkgKiB0aGlzLndpZHRoICsgTWF0aC5mbG9vcih0aGlzLnBsYXllci54IC8gdGhpcy50aWxlU2l6ZSldKTsKICAgICAgICBpZiAodHJvb3AgIT0gbnVsbCkgewogICAgICAgICAgdGhpcy5zdGFydEJhdHRsZSh0cm9vcCk7CiAgICAgICAgfQogICAgICAgIHRoaXMucGxheWVyLmlzTG9ja2VkID0gZmFsc2U7CiAgICAgIH0KICAgICAgdGhpcy5wbGF5ZXIgPSBHYW1lTWFuYWdlci5wbGF5ZXI7CiAgICAgIEdhbWVNYW5hZ2VyLnBsYXllci5pc1BsYXllciA9ICFHYW1lTWFuYWdlci5pbnRlcnByZXRlci5pc1J1bm5pbmc7CiAgICAgIEdhbWVNYW5hZ2VyLmJhdHRsZVRlcnJhaW4gPSB0ZXJyYWluOwogICAgICBHYW1lTWFuYWdlci5wbGF5ZXIudGVycmFpbiA9IHRlcnJhaW47CiAgICAgIHJldHVybiBudWxsOwogICAgfTsKCiAgICBMb2dpY19NYXAucHJvdG90eXBlLnNldFRpbGUgPSBmdW5jdGlvbih4LCB5LCB6LCB0aWxlKSB7CiAgICAgIHZhciBpLCBpbmRleCwgaiwgb2Zmc2V0LCBfaSwgX2osIF9yZWYsIF9yZWYxOwogICAgICB6ID0gTWF0aC5tYXgoTWF0aC5taW4oeiwgdGhpcy5kZXB0aCAtIDEpLCAwKTsKICAgICAgb2Zmc2V0ID0gdGhpcy53aWR0aCAqIHRoaXMuaGVpZ2h0ICogejsKICAgICAgaWYgKHRpbGUgIT0gbnVsbCkgewogICAgICAgIHggPSBNYXRoLm1heChNYXRoLm1pbih4LCB0aGlzLndpZHRoIC0gMSksIDApOwogICAgICAgIHkgPSBNYXRoLm1heChNYXRoLm1pbih5LCB0aGlzLmhlaWdodCAtIDEpLCAwKTsKICAgICAgICBpbmRleCA9IHkgKiB0aGlzLndpZHRoICsgeCArIG9mZnNldDsKICAgICAgICB0aGlzLm1hcERhdGFbaW5kZXhdID0gdGlsZTsKICAgICAgICB0aGlzLmNhY2hlSW5kaWNlcy5wdXNoKGluZGV4KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBmb3IgKGkgPSBfaSA9IDAsIF9yZWYgPSB0aGlzLndpZHRoOyAwIDw9IF9yZWYgPyBfaSA8IF9yZWYgOiBfaSA+IF9yZWY7IGkgPSAwIDw9IF9yZWYgPyArK19pIDogLS1faSkgewogICAgICAgICAgZm9yIChqID0gX2ogPSAwLCBfcmVmMSA9IHRoaXMuaGVpZ2h0OyAwIDw9IF9yZWYxID8gX2ogPCBfcmVmMSA6IF9qID4gX3JlZjE7IGogPSAwIDw9IF9yZWYxID8gKytfaiA6IC0tX2opIHsKICAgICAgICAgICAgaW5kZXggPSBqICogdGhpcy53aWR0aCArIGkgKyBvZmZzZXQ7CiAgICAgICAgICAgIGlmICh0aGlzLm1hcERhdGFbaW5kZXhdID09PSB4KSB7CiAgICAgICAgICAgICAgdGhpcy5tYXBEYXRhW2luZGV4XSA9IHk7CiAgICAgICAgICAgICAgdGhpcy5jYWNoZUluZGljZXMucHVzaChpbmRleCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIG51bGw7CiAgICB9OwoKICAgIExvZ2ljX01hcC5wcm90b3R5cGUucmFuZG9tRW5jb3VudGVyUmF0ZSA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gKE1hdGgucmFuZG9tKCkgKiAyNSAtIE1hdGgucmFuZG9tKCkgKiAyNSkgLyAxMDA7CiAgICB9OwoKICAgIExvZ2ljX01hcC5wcm90b3R5cGUuYWRkRXZlbnRGcm9tRGF0YSA9IGZ1bmN0aW9uKGRhdGEpIHsKICAgICAgdmFyIGV2ZW50LCBsb2dpYzsKICAgICAgZXZlbnQgPSBkYXRhOwogICAgICBsb2dpYyA9IG5ldyBMb2dpY19FdmVudChldmVudCwgZXZlbnQuaWQpOwogICAgICBsb2dpYy5tYXAgPSB0aGlzLm1hcC5pdGVtczsKICAgICAgbG9naWMubWFwRGF0YSA9IHRoaXMubWFwRGF0YTsKICAgICAgbG9naWMubWFwTG9naWMgPSB0aGlzOwogICAgICBsb2dpYy5jb2xsaXNpb25NYXAgPSB0aGlzLmNvbGxpc2lvbk1hcDsKICAgICAgbG9naWMudGlsZXNldCA9IHRoaXMudGlsZXNldDsKICAgICAgdGhpcy5jb2xsaXNpb25NYXBbZXZlbnQueSAqIHRoaXMud2lkdGggKyBldmVudC54XS5wdXNoKGxvZ2ljKTsKICAgICAgdGhpcy5ldmVudHMucHVzaChsb2dpYyk7CiAgICAgIHRoaXMuZXZlbnRzQnlJZFtldmVudC5pZF0gPSBsb2dpYzsKICAgICAgcmV0dXJuIGxvZ2ljLmNoZWNrQnVzaEZsYWcoKTsKICAgIH07CgogICAgTG9naWNfTWFwLnByb3RvdHlwZS5zZWxlY3RUcm9vcCA9IGZ1bmN0aW9uKHJlZ2lvbikgewogICAgICB2YXIgZW5jb3VudGVyLCBlbmNvdW50ZXJzLCByYXRlU3VtLCB0cm9vcCwgdmFsdWUsIF9pLCBfaiwgX2xlbiwgX2xlbjEsIF9yZWY7CiAgICAgIGlmIChyZWdpb24gPT09IDApIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQogICAgICBlbmNvdW50ZXJzID0gW107CiAgICAgIHJhdGVTdW0gPSAwOwogICAgICB2YWx1ZSA9IDA7CiAgICAgIHRyb29wID0gbnVsbDsKICAgICAgX3JlZiA9IHRoaXMuZW5jb3VudGVyczsKICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBfcmVmLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7CiAgICAgICAgZW5jb3VudGVyID0gX3JlZltfaV07CiAgICAgICAgaWYgKGVuY291bnRlci5yZWdpb24xID09PSByZWdpb24gfHwgZW5jb3VudGVyLnJlZ2lvbjIgPT09IHJlZ2lvbiB8fCBlbmNvdW50ZXIucmVnaW9uMyA9PT0gcmVnaW9uKSB7CiAgICAgICAgICBlbmNvdW50ZXJzLnB1c2goZW5jb3VudGVyKTsKICAgICAgICAgIHJhdGVTdW0gKz0gZW5jb3VudGVyLnJhdGU7CiAgICAgICAgfQogICAgICB9CiAgICAgIHZhbHVlID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogcmF0ZVN1bSk7CiAgICAgIGZvciAoX2ogPSAwLCBfbGVuMSA9IGVuY291bnRlcnMubGVuZ3RoOyBfaiA8IF9sZW4xOyBfaisrKSB7CiAgICAgICAgZW5jb3VudGVyID0gZW5jb3VudGVyc1tfal07CiAgICAgICAgaWYgKHZhbHVlIDw9IGVuY291bnRlci5yYXRlKSB7CiAgICAgICAgICB0cm9vcCA9IFJlY29yZE1hbmFnZXIudHJvb3BzW2VuY291bnRlci50cm9vcElkXTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgICB2YWx1ZSAtPSBlbmNvdW50ZXIucmF0ZTsKICAgICAgfQogICAgICByZXR1cm4gdHJvb3A7CiAgICB9OwoKICAgIExvZ2ljX01hcC5wcm90b3R5cGUuc3RhcnRCYXR0bGUgPSBmdW5jdGlvbih0cm9vcCkgewogICAgICBHYW1lTWFuYWdlci50cm9vcCA9IHRyb29wOwogICAgICByZXR1cm4gU2NlbmVNYW5hZ2VyLnN3aXRjaFRvKG5ldyBTY2VuZV9CYXR0bGUoKSk7CiAgICB9OwoKICAgIExvZ2ljX01hcC5wcm90b3R5cGUubG9jYXRpb25EYXRhID0gZnVuY3Rpb24oeCwgeSwgdHlwZSkgewogICAgICB2YXIgaSwgcG9zaXRpb24sIHJlc3VsdCwgc2l6ZSwgdGlsZSwgdGlsZUlkLCBfaSwgX3JlZjsKICAgICAgcmVzdWx0ID0gMDsKICAgICAgdGlsZSA9IDA7CiAgICAgIHBvc2l0aW9uID0geSAqIHRoaXMud2lkdGggKyB4OwogICAgICB0aWxlSWQgPSB0aGlzLm1hcERhdGFbcG9zaXRpb25dOwogICAgICBzd2l0Y2ggKHR5cGUpIHsKICAgICAgICBjYXNlIDA6CiAgICAgICAgICByZXN1bHQgPSB0aGlzLnRpbGVzZXQudGVycmFpblRhZ3NbdGlsZUlkXTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgMToKICAgICAgICAgIHJlc3VsdCA9IHRoaXMucmVnaW9uRGF0YVtwb3NpdGlvbl07CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDI6CiAgICAgICAgICByZXN1bHQgPSB0aGlzLm1hcERhdGFbcG9zaXRpb25dOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAzOgogICAgICAgICAgcmVzdWx0ID0gdGhpcy5tYXBEYXRhW3Bvc2l0aW9uICsgdGhpcy53aWR0aCAqIHRoaXMuaGVpZ2h0XTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgNDoKICAgICAgICAgIHJlc3VsdCA9IHRoaXMubWFwRGF0YVtwb3NpdGlvbiArIHRoaXMud2lkdGggKiB0aGlzLmhlaWdodCAqIDJdOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSA1OgogICAgICAgICAgc2l6ZSA9IHRoaXMud2lkdGggKiB0aGlzLmhlaWdodDsKICAgICAgICAgIGZvciAoaSA9IF9pID0gMCwgX3JlZiA9IHRoaXMuZGVwdGg7IDAgPD0gX3JlZiA/IF9pIDwgX3JlZiA6IF9pID4gX3JlZjsgaSA9IDAgPD0gX3JlZiA/ICsrX2kgOiAtLV9pKSB7CiAgICAgICAgICAgIHRpbGUgPSB0aGlzLm1hcERhdGFbcG9zaXRpb24gKyBpICogc2l6ZV07CiAgICAgICAgICAgIHJlc3VsdCA9IHRoaXMudGlsZXNldC5wYXNzYWdlc1t0aWxlXTsKICAgICAgICAgICAgaWYgKHJlc3VsdCAhPT0gMCkgewogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH07CgogICAgcmV0dXJuIExvZ2ljX01hcDsKCiAgfSkoKTsKCiAgd2luZG93LkxvZ2ljX01hcCA9IExvZ2ljX01hcDsKCn0pLmNhbGwodGhpcyk7Cg=="},{"name":"Logic_Actor","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogTG9naWNfQWN0b3IKIyAgIENyZWF0ZWQgb246IDIwMTMtMTAtMDUKIwojICAgQ29weXJpZ2h0IChDKSAyMDEzIEFuZHLpIFJhZG9tc2tpLiBBbGwgcmlnaHRzIHJlc2VydmVkLgojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQojCiMgICBDbGFzczogTG9naWNfQWN0b3IKIwojICAgQSBiYXNlIGNsYXNzIGZvciBhbGwgb3RoZXIgd2luZG93IGNsYXNzZXMuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpjbGFzcyBMb2dpY19BY3RvcgogICAgY29uc3RydWN0b3I6IChhY3RvciwgZGF0YSkgLT4KICAgICAgICBpZiBhY3Rvcj8KICAgICAgICAgICAgZGF0YSB8fD0ge30KICAgICAgICAgICAgQGFjdG9ySWQgPSBhY3Rvci5pbmRleAogICAgICAgICAgICBAYWN0b3IgPSBhY3RvcgogICAgICAgICAgICBAbmFtZSA9IGRhdGEubmFtZSB8fCBAYWN0b3IubmFtZQogICAgICAgICAgICBAZ3JhcGhpYyA9IGRhdGEuZ3JhcGhpYyB8fCBAYWN0b3IuZ3JhcGhpYwogICAgICAgICAgICBAZmFjZUdyYXBoaWMgPSBkYXRhLmZhY2VHcmFwaGljIHx8IEBhY3Rvci5mYWNlR3JhcGhpYwogICAgICAgICAgICBAZmFjZVBhdHRlcm4gPSBkYXRhLmZhY2VQYXR0ZXJuIHx8IEBhY3Rvci5mYWNlUGF0dGVybgogICAgICAgICAgICBAY2hhcmFjdGVyR3JhcGhpYyA9IGRhdGEuY2hhcmFjdGVyR3JhcGhpYyB8fCBAYWN0b3IuY2hhcmFjdGVyR3JhcGhpYwogICAgICAgICAgICBAY2hhcmFjdGVyUGF0dGVybiA9IGRhdGEuY2hhcmFjdGVyUGF0dGVybiB8fCBAYWN0b3IuY2hhcmFjdGVyUGF0dGVybgogICAgICAgICAgICBAY2xhc3MgPSBSZWNvcmRNYW5hZ2VyLmNsYXNzZXNbQGFjdG9yLmNsYXNzSWRdCiAgICAgICAgICAgIEBsZXZlbCA9IGRhdGEubGV2ZWwgfHwgQGFjdG9yLmluaXRpYWxMZXZlbAogICAgICAgICAgICBAbWF4TGV2ZWwgPSBAYWN0b3IubWF4TGV2ZWwKICAgICAgICAgICAgQHBhcmFtcyA9IGRhdGEucGFyYW1zIHx8IEBjbGFzcy5wYXJhbXMKICAgICAgICAgICAgQGJhdHRsZVBvc2l0aW9uID0gKGRhdGEuYmF0dGxlUG9zaXRpb24gfHwgQGFjdG9yLmJhdHRsZVBvc2l0aW9uIHx8IFt7eDogMCwgeTogMH1dKVswXQogICAgICAgICAgICBAbWxwID0gQHBhcmFtc1swXVtAbGV2ZWxdCiAgICAgICAgICAgIEBtbXAgPSBAcGFyYW1zWzFdW0BsZXZlbF0KICAgICAgICAgICAgQGxwID0gQG1scAogICAgICAgICAgICBAbXAgPSBAbW1wCiAgICAgICAgICAgIEBhdGsgPSBAcGFyYW1zWzJdW0BsZXZlbF0KICAgICAgICAgICAgQGRlZiA9IEBwYXJhbXNbM11bQGxldmVsXQogICAgICAgICAgICBAbWF0ID0gQHBhcmFtc1s0XVtAbGV2ZWxdCiAgICAgICAgICAgIEBtZGYgPSBAcGFyYW1zWzVdW0BsZXZlbF0KICAgICAgICAgICAgQGFnaSA9IEBwYXJhbXNbNl1bQGxldmVsXQogICAgICAgICAgICBAbHVrID0gQHBhcmFtc1s3XVtAbGV2ZWxdCiAgICAgICAgICAgIEB4UGFyYW1ldGVycyA9IFswLCAwLCAwLCAwLCAwLCAwLCAwXQogICAgICAgICAgICBAc1BhcmFtZXRlcnMgPSBbMTAwLCAxMDAsIDEwMCwgMTAwLCAxMDAsIDEwMF0KICAgICAgICAgICAgCiAgICAgICAgICAgIEBoaXRSYXRlID0gMTAwCiAgICAgICAgICAgIEBkZWZlbnNlUmF0ZSA9IDEwMAogICAgICAgICAgICAKICAgICAgICAgICAgQGV2YXNpb25SYXRlID0gMAogICAgICAgICAgICBAY3JpdGljYWxIaXRSYXRlID0gMAogICAgICAgICAgICBAY3JpdGljYWxFdmFzaW9uUmF0ZSA9IDAKICAgICAgICAgICAgQG1hZ2ljRXZhc2lvblJhdGUgPSAwCiAgICAgICAgICAgIEBtYWdpY1JlZmxlY3Rpb25SYXRlID0gMAogICAgICAgICAgICBAY291bnRlclJhdGUgPSAwCiAgICAgICAgICAgIEBscFJlZ2VuZXJhdGlvblJhdGUgPSAwCiAgICAgICAgICAgIEBtcFJlZ2VuZXJhdGlvblJhdGUgPSAwCiAgICAgICAgICAgIEBlbGVtZW50UmF0ZXMgPSBbXQogICAgICAgICAgICBAZXF1aXBtZW50U2xvdHMgPSBbeyBmaXhlZDogbm8sIHNlYWxlZDogbm99LCB7IGZpeGVkOiBubywgc2VhbGVkOiBub30sIHsgZml4ZWQ6IG5vLCBzZWFsZWQ6IG5vfSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IGZpeGVkOiBubywgc2VhbGVkOiBub30sIHsgZml4ZWQ6IG5vLCBzZWFsZWQ6IG5vfV0KICAgICAgICAgICAgQHNsb3RUeXBlID0gMAogICAgICAgICAgICBAYWN0aW9uVGltZSA9IDEwMAogICAgICAgICAgICBAZ3VhcmQgPSBubwogICAgICAgICAgICBAYmFkU3RhdHVzID0gbm8KICAgICAgICAgICAgCiAgICAgCiAgICAgICAgICAgIEB3ZWFwb24gPSBSZWNvcmRNYW5hZ2VyLndlYXBvbnNbZGF0YS53ZWFwb25JZCB8fCBAYWN0b3Iud2VhcG9uSWRdCiAgICAgICAgICAgIEBzaGllbGQgPSBSZWNvcmRNYW5hZ2VyLmFybW9yc1tkYXRhLnNoaWVsZElkIHx8IEBhY3Rvci5zaGllbGRJZF0KICAgICAgICAgICAgQGhlYWQgPSBSZWNvcmRNYW5hZ2VyLmFybW9yc1tkYXRhLmhlYWRBcm1vcklkIHx8IEBhY3Rvci5oZWFkQXJtb3JJZF0KICAgICAgICAgICAgQGJvZHkgPSBSZWNvcmRNYW5hZ2VyLmFybW9yc1tkYXRhLmJvZHlBcm1vcklkIHx8IEBhY3Rvci5ib2R5QXJtb3JJZF0KICAgICAgICAgICAgQGFjY2Vzc29yeSA9IFJlY29yZE1hbmFnZXIuYXJtb3JzW2RhdGEuYWNjZXNzb3J5SWQgfHwgQGFjdG9yLmFjY2Vzc29yeUlkXQoKICAgICAgICAgICAgQGlzQWxpdmUgPSB5ZXMKICAgICAgICAgICAgQGJhc2VQcm9wZXJ0aWVzID0gZGF0YS5wcm9wZXJ0aWVzIHx8IEBhY3Rvci5wcm9wZXJ0aWVzCiAgICAgICAgICAgIEBwcm9wZXJ0aWVzID0gZGF0YS5wcm9wZXJ0aWVzIHx8IEBhY3Rvci5wcm9wZXJ0aWVzCiAgICAgICAgICAgIEBleHAgPSBAY2xhc3MuZXhwQ3VydmUudmFsdWVzW0BsZXZlbC0xXQogICAgICAgICAgICBAZXhwVG9OZXh0TGV2ZWwgPSBAY2xhc3MuZXhwQ3VydmUudmFsdWVzW0BsZXZlbF0KICAgICAgICAgICAgQHNraWxsVHlwZXMgPSBbXQogICAgICAgICAgICBAd2VhcG9uVHlwZXMgPSBbXQogICAgICAgICAgICBAYXJtb3JUeXBlcyA9IFtdCiAgICAgICAgICAgIEBza2lsbHMgPSBkYXRhLnNraWxscyB8fCBbXQogICAgICAgICAgICBAYnVmZnMgPSBbW10sW10sW10sW10sW10sW10sW10sW11dCiAgICAgICAgICAgIEBkZWJ1ZmZzID0gW1tdLFtdLFtdLFtdLFtdLFtdLFtdLFtdXQogICAgICAgICAgICBAc3RhdGVzID0gW10KICAgICAgICAgICAgQGF0dGFja1NraWxsID0gT2JqZWN0LmNvcHkoUmVjb3JkTWFuYWdlci5za2lsbHNbMF0pCiAgICAgICAgICAgIEBhbmltYXRpb25zID0gW10KICAgICAgICAgICAgQGFuaW1hdGlvbnNCeVNraWxsID0gW10KCiAgICAgICAgICAgIGlmIEBhY3Rvci5zdGFuZEFuaW1hdGlvbklkPyBhbmQgUmVjb3JkTWFuYWdlci5zaW1wbGVBbmltYXRpb25zW0BhY3Rvci5zdGFuZEFuaW1hdGlvbklkXT8KICAgICAgICAgICAgICAgIEBzdGFuZEFuaW1hdGlvbiA9IG5ldyBMb2dpY19TaW1wbGVBbmltYXRpb24oUmVjb3JkTWFuYWdlci5zaW1wbGVBbmltYXRpb25zW0BhY3Rvci5zdGFuZEFuaW1hdGlvbklkXSkKICAgICAgICAgICAgaWYgQGFjdG9yLm1hZ2ljQW5pbWF0aW9uSWQ/IGFuZCBSZWNvcmRNYW5hZ2VyLnNpbXBsZUFuaW1hdGlvbnNbQGFjdG9yLm1hZ2ljQW5pbWF0aW9uSWRdPwogICAgICAgICAgICAgICAgQG1hZ2ljQW5pbWF0aW9uID0gbmV3IExvZ2ljX1NpbXBsZUFuaW1hdGlvbihSZWNvcmRNYW5hZ2VyLnNpbXBsZUFuaW1hdGlvbnNbQGFjdG9yLm1hZ2ljQW5pbWF0aW9uSWRdKQogICAgICAgICAgICBpZiBAYWN0b3IuYXR0YWNrQW5pbWF0aW9uSWQ/IGFuZCBSZWNvcmRNYW5hZ2VyLnNpbXBsZUFuaW1hdGlvbnNbQGFjdG9yLmF0dGFja0FuaW1hdGlvbklkXT8KICAgICAgICAgICAgICAgIEBhdHRhY2tBbmltYXRpb24gPSBuZXcgTG9naWNfU2ltcGxlQW5pbWF0aW9uKFJlY29yZE1hbmFnZXIuc2ltcGxlQW5pbWF0aW9uc1tAYWN0b3IuYXR0YWNrQW5pbWF0aW9uSWRdKQogICAgICAgICAgICBpZiBAYWN0b3IuaXRlbUFuaW1hdGlvbklkPyBhbmQgUmVjb3JkTWFuYWdlci5zaW1wbGVBbmltYXRpb25zW0BhY3Rvci5pdGVtQW5pbWF0aW9uSWRdPwogICAgICAgICAgICAgICAgQGl0ZW1BbmltYXRpb24gPSBuZXcgTG9naWNfU2ltcGxlQW5pbWF0aW9uKFJlY29yZE1hbmFnZXIuc2ltcGxlQW5pbWF0aW9uc1tAYWN0b3IuaXRlbUFuaW1hdGlvbklkXSkKICAgICAgICAgICAgaWYgQGFjdG9yLmd1YXJkQW5pbWF0aW9uSWQ/IGFuZCBSZWNvcmRNYW5hZ2VyLnNpbXBsZUFuaW1hdGlvbnNbQGFjdG9yLmd1YXJkQW5pbWF0aW9uSWRdPwogICAgICAgICAgICAgICAgQGd1YXJkQW5pbWF0aW9uID0gbmV3IExvZ2ljX1NpbXBsZUFuaW1hdGlvbihSZWNvcmRNYW5hZ2VyLnNpbXBsZUFuaW1hdGlvbnNbQGFjdG9yLmd1YXJkQW5pbWF0aW9uSWRdKQogICAgICAgICAgICBpZiBAYWN0b3IucHJlTWFnaWNBbmltYXRpb25JZD8gYW5kIFJlY29yZE1hbmFnZXIuc2ltcGxlQW5pbWF0aW9uc1tAYWN0b3IucHJlTWFnaWNBbmltYXRpb25JZF0/CiAgICAgICAgICAgICAgICBAcHJlTWFnaWNBbmltYXRpb24gPSBuZXcgTG9naWNfU2ltcGxlQW5pbWF0aW9uKFJlY29yZE1hbmFnZXIuc2ltcGxlQW5pbWF0aW9uc1tAYWN0b3IucHJlTWFnaWNBbmltYXRpb25JZF0pCiAgICAgICAgICAgIGlmIEBhY3Rvci5wcmVBdHRhY2tBbmltYXRpb25JZD8gYW5kIFJlY29yZE1hbmFnZXIuc2ltcGxlQW5pbWF0aW9uc1tAYWN0b3IucHJlQXR0YWNrQW5pbWF0aW9uSWRdPwogICAgICAgICAgICAgICAgQHByZUF0dGFja0FuaW1hdGlvbiA9IG5ldyBMb2dpY19TaW1wbGVBbmltYXRpb24oUmVjb3JkTWFuYWdlci5zaW1wbGVBbmltYXRpb25zW0BhY3Rvci5wcmVBdHRhY2tBbmltYXRpb25JZF0pCiAgICAgICAgICAgIGlmIEBhY3Rvci5kYW1hZ2VBbmltYXRpb25JZD8gYW5kIFJlY29yZE1hbmFnZXIuc2ltcGxlQW5pbWF0aW9uc1tAYWN0b3IuZGFtYWdlQW5pbWF0aW9uSWRdPwogICAgICAgICAgICAgICAgQGRhbWFnZUFuaW1hdGlvbiA9IG5ldyBMb2dpY19TaW1wbGVBbmltYXRpb24oUmVjb3JkTWFuYWdlci5zaW1wbGVBbmltYXRpb25zW0BhY3Rvci5kYW1hZ2VBbmltYXRpb25JZF0pCiAgICAgICAgICAgIGlmIEBhY3Rvci5kZWF0aEFuaW1hdGlvbklkPyBhbmQgUmVjb3JkTWFuYWdlci5zaW1wbGVBbmltYXRpb25zW0BhY3Rvci5kZWF0aEFuaW1hdGlvbklkXT8KICAgICAgICAgICAgICAgIEBkZWF0aEFuaW1hdGlvbiA9IG5ldyBMb2dpY19TaW1wbGVBbmltYXRpb24oUmVjb3JkTWFuYWdlci5zaW1wbGVBbmltYXRpb25zW0BhY3Rvci5kZWF0aEFuaW1hdGlvbklkXSkKICAgICAgICAgICAgaWYgQGFjdG9yLmJhZFN0YXR1c0FuaW1hdGlvbklkPyBhbmQgUmVjb3JkTWFuYWdlci5zaW1wbGVBbmltYXRpb25zW0BhY3Rvci5iYWRTdGF0dXNBbmltYXRpb25JZF0/CiAgICAgICAgICAgICAgICBAYmFkU3RhdHVzQW5pbWF0aW9uID0gbmV3IExvZ2ljX1NpbXBsZUFuaW1hdGlvbihSZWNvcmRNYW5hZ2VyLnNpbXBsZUFuaW1hdGlvbnNbQGFjdG9yLmJhZFN0YXR1c0FuaW1hdGlvbklkXSkKICAgICAgICAgICAgICAgCiAgICAgICAgICAgIEByZWZyZXNoKCkKICAgICAgICAKICAgIHRvRGF0YUJ1bmRsZTogLT4KICAgICAgICBidW5kbGUgPSAKICAgICAgICB7CiAgICAgICAgICAgIGFjdG9ySWQ6IEBhY3RvcklkLAogICAgICAgICAgICBuYW1lOiBAbmFtZSwKICAgICAgICAgICAgbGV2ZWw6IEBsZXZlbCwKICAgICAgICAgICAgbHA6IEBscCwKICAgICAgICAgICAgbXA6IEBtcCwKICAgICAgICAgICAgc2tpbGxzOiBAc2tpbGxzCiAgICAgICAgICAgIHdlYXBvbklkOiBpZiBAd2VhcG9uPyB0aGVuIEB3ZWFwb24uaW5kZXggZWxzZSBudWxsLAogICAgICAgICAgICBzaGllbGRJZDogaWYgQHNoaWVsZD8gdGhlbiBAc2hpZWxkLmluZGV4IGVsc2UgbnVsbCwKICAgICAgICAgICAgaGVhZElkOiBpZiBAaGVhZD8gdGhlbiBAaGVhZC5pbmRleCBlbHNlIG51bGwsCiAgICAgICAgICAgIGJvZHlJZDogaWYgQGJvZHk/IHRoZW4gQGJvZHkuaW5kZXggZWxzZSBudWxsLAogICAgICAgICAgICBhY2Nlc3NvcnlJZDogaWYgQGFjY2Vzc29yeT8gdGhlbiBAYWNjZXNzb3J5LmluZGV4IGVsc2UgbnVsbAogICAgICAgIH0KICAgICAgICAKICAgICAgICByZXR1cm4gYnVuZGxlCiAgICAgICAgCiAgICB1cGRhdGU6IC0+CiAgICAgICAgCiAgICBlcXVpcHBlZEl0ZW06IChzbG90KSAtPgogICAgICAgIHN3aXRjaCBzbG90CiAgICAgICAgICAgIHdoZW4gMCB0aGVuIHJldHVybiBAd2VhcG9uCiAgICAgICAgICAgIHdoZW4gMSB0aGVuIHJldHVybiBAc2hpZWxkCiAgICAgICAgICAgIHdoZW4gMiB0aGVuIHJldHVybiBAaGVhZEFybW9yCiAgICAgICAgICAgIHdoZW4gMyB0aGVuIHJldHVybiBAYm9keUFybW9yCiAgICAgICAgICAgIHdoZW4gNCB0aGVuIHJldHVybiBAYWNjZXNzb3J5CiAgICAgICAgICAgIAogICAgY2hhbmdlTHA6KGluY3JlbWVudCkgLT4KICAgICAgICBAbHAgPSBNYXRoLm1pbihNYXRoLm1heChAbHAgKyBpbmNyZW1lbnQsIDApLCBAbWxwKQogICAgY2hhbmdlTXA6KGluY3JlbWVudCkgLT4KICAgICAgICBAbXAgPSBNYXRoLm1pbihNYXRoLm1heChAbXAgKyBpbmNyZW1lbnQsIDApLCBAbW1wKQogICAgY2hhbmdlRXhwOihpbmNyZW1lbnQpIC0+CiAgICAgICAgQGV4cCA9IE1hdGgubWluKE1hdGgubWF4KEBleHAgKyBpbmNyZW1lbnQsIDApLCBAY2xhc3MuZXhwQ3VydmUudmFsdWVzW0BtYXhMZXZlbC0xXSkKICAgIGNoYW5nZUxldmVsOihpbmNyZW1lbnQpIC0+CiAgICAgICAgQGxldmVsID0gTWF0aC5taW4oTWF0aC5tYXgoQGxldmVsICsgaW5jcmVtZW50LCAxKSwgQG1heExldmVsKQogICAgICAgIAogICAgcGFyYW1ldGVyOiAoaW5kZXgpIC0+CiAgICAgICAgc3dpdGNoIGluZGV4CiAgICAgICAgICAgIHdoZW4gMCB0aGVuIHJldHVybiBAbWxwCiAgICAgICAgICAgIHdoZW4gMSB0aGVuIHJldHVybiBAbW1wCiAgICAgICAgICAgIHdoZW4gMiB0aGVuIHJldHVybiBAYXRrCiAgICAgICAgICAgIHdoZW4gMyB0aGVuIHJldHVybiBAbWF0CiAgICAgICAgICAgIHdoZW4gNCB0aGVuIHJldHVybiBAZGVmCiAgICAgICAgICAgIHdoZW4gNSB0aGVuIHJldHVybiBAbWRmCiAgICAgICAgICAgIHdoZW4gNiB0aGVuIHJldHVybiBAYWdpCiAgICAgICAgICAgIHdoZW4gNyB0aGVuIHJldHVybiBAbHVrCiAgICAgICAgICAgIAogICAgYmFzZVBhcmFtZXRlcjogKGluZGV4KSAtPiBAcGFyYW1zW2luZGV4XVtAbGV2ZWxdIAogICAgc2V0QmFzZVBhcmFtZXRlcjogKGluZGV4LCB2YWx1ZSkgLT4gQHBhcmFtc1tpbmRleF1bQGxldmVsXSA9IHZhbHVlCiAgICAgICAgCiAgICBiYXNlTWxwOiAtPiBAYmFzZVBhcmFtZXRlcigwKQogICAgYmFzZU1tcDogLT4gQGJhc2VQYXJhbWV0ZXIoMSkKICAgIGJhc2VBdGs6IC0+IEBiYXNlUGFyYW1ldGVyKDIpCiAgICBiYXNlTWF0OiAtPiBAYmFzZVBhcmFtZXRlcig0KQogICAgYmFzZURlZjogLT4gQGJhc2VQYXJhbWV0ZXIoMykKICAgIGJhc2VNZGY6IC0+IEBiYXNlUGFyYW1ldGVyKDUpCiAgICBiYXNlQWdpOiAtPiBAYmFzZVBhcmFtZXRlcig2KQogICAgYmFzZUx1azogLT4gQGJhc2VQYXJhbWV0ZXIoNykgICAgCiAgICAKICAgIGhncjogLT4gQGV4UGFyYW1ldGVyc1syXQogICAgbWdyOiAtPiBAZXhQYXJhbWV0ZXJzWzNdCiAgICBldmE6IC0+IEBleFBhcmFtZXRlcnNbMV0KICAgIAogICAgcmVmcmVzaDogLT4KICAgICAgICBpZiBAY2xhc3M/CiAgICAgICAgICAgIEBleHBUb05leHRMZXZlbCA9IEBjbGFzcy5leHBDdXJ2ZS52YWx1ZXNbQGxldmVsXQogICAgICAgIEBza2lsbFR5cGVzID0gW10KICAgICAgICBAd2VhcG9uVHlwZXMgPSBbXQogICAgICAgIEBhcm1vclR5cGVzID0gW10KICAgICAgICAKICAgICAgICBAYXR0YWNrU2tpbGwgPSBPYmplY3QuY29weShSZWNvcmRNYW5hZ2VyLnNraWxsc1swXSkKICAgICAgICBAZ3VhcmQgPSBubwogICAgICAgIEBiYWRTdGF0dXMgPSBubwogICAgICAgIGlmIEBjbGFzcz8KICAgICAgICAgICAgd2hpbGUgQGV4cCA+PSBAZXhwVG9OZXh0TGV2ZWwgYW5kIEBleHBUb05leHRMZXZlbCA+IDAKICAgICAgICAgICAgICAgIEBsZXZlbCsrCiAgICAgICAgICAgICAgICBAZXhwVG9OZXh0TGV2ZWwgPSBAY2xhc3MuZXhwQ3VydmUudmFsdWVzW0BsZXZlbC0xXQogICAgICAgICAgICAgICAgQGxwID0gQGJhc2VNbHAoKQogICAgICAgICAgICAgICAgQG1wID0gQGJhc2VNbXAoKQogICAgICAgIAogICAgIAogICAgICAgIEB4UGFyYW1ldGVycyA9IFsxMDAsIDEwMCwgMTAwLCAxMDAsIDEwMCwgMTAwLCAxMDBdCiAgICAgICAgQHNQYXJhbWV0ZXJzID0gWzAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDBdCiAgICAgICAgCiAgICAgICAgY2xhc3NQcm9wZXJ0aWVzID0gaWYgQGNsYXNzPyB0aGVuIEBjbGFzcy5wcm9wZXJ0aWVzIGVsc2UgW10KICAgICAgICBAcHJvcGVydGllcyA9IGNsYXNzUHJvcGVydGllcy5jb25jYXQoQGJhc2VQcm9wZXJ0aWVzKQogICAgICAgIAogICAgICAgIGlmIEB3ZWFwb24/IHRoZW4gQHByb3BlcnRpZXMgPSBAcHJvcGVydGllcy5jb25jYXQoQHdlYXBvbi5wcm9wZXJ0aWVzKQogICAgICAgIGlmIEBzaGllbGQ/IHRoZW4gQHByb3BlcnRpZXMgPSBAcHJvcGVydGllcy5jb25jYXQoQHNoaWVsZC5wcm9wZXJ0aWVzKQogICAgICAgIGlmIEBoZWFkPyB0aGVuIEBwcm9wZXJ0aWVzID0gQHByb3BlcnRpZXMuY29uY2F0KEBoZWFkLnByb3BlcnRpZXMpCiAgICAgICAgaWYgQGJvZHk/IHRoZW4gQHByb3BlcnRpZXMgPSBAcHJvcGVydGllcy5jb25jYXQoQGJvZHkucHJvcGVydGllcykKICAgICAgICBpZiBAYWNjZXNzb3J5PyB0aGVuIEBwcm9wZXJ0aWVzID0gQHByb3BlcnRpZXMuY29uY2F0KEBhY2Nlc3NvcnkucHJvcGVydGllcykKICAgICAgICBpZiBAY2xhc3M/IHRoZW4gQHByb3BlcnRpZXMgPSBAcHJvcGVydGllcy5jb25jYXQoQGNsYXNzLnByb3BlcnRpZXMpCiAgICAgICAgCiAgICAgICAgZm9yIHN0YXRlIGluIEBzdGF0ZXMKICAgICAgICAgICAgQHByb3BlcnRpZXMgPSBAcHJvcGVydGllcy5jb25jYXQoc3RhdGUucHJvcGVydGllcykKICAgICAgICAgICAgaWYgc3RhdGUuYmFkU3RhdHVzCiAgICAgICAgICAgICAgICBAYmFkU3RhdHVzID0geWVzCiAgICAgICAgICAgIAogICAgCiAgICAgICAgcGFyYW1CdWZmcyA9IFswLCAwLCAwLCAwLCAwLCAwLCAwLCAwXQogICAgICAgIGZvciBwcm9wZXJ0eSBpbiBAcHJvcGVydGllcwogICAgICAgICAgICBzd2l0Y2ggcHJvcGVydHkuY29kZQogICAgICAgICAgICAgICAgd2hlbiAwICMgRWxlbWVudCBSYXRlCiAgICAgICAgICAgICAgICAgICAgaWYgbm90IEBlbGVtZW50UmF0ZXNbcHJvcGVydHkuaWRdPyB0aGVuIEBlbGVtZW50UmF0ZXNbcHJvcGVydHkuaWRdID0gMTAwCiAgICAgICAgICAgICAgICAgICAgQGVsZW1lbnRSYXRlc1twcm9wZXJ0eS5pZF0gKj0gcHJvcGVydHkudmFsdWUgLyAxMDAKICAgICAgICAgICAgICAgIHdoZW4gMSAjIERlYnVmZiBSYXRlCiAgICAgICAgICAgICAgICAgICAgQGRlYnVmZnNbcHJvcGVydHkuaWRdLnB1c2gocHJvcGVydHkudmFsdWUpCiAgICAgICAgICAgICAgICB3aGVuIDQgIyBQYXJhbWV0ZXIKICAgICAgICAgICAgICAgICAgICBwYXJhbUJ1ZmZzW3Byb3BlcnR5LmlkXSArPSBNYXRoLmZsb29yKEBiYXNlUGFyYW1ldGVyKHByb3BlcnR5LmlkKSAqIChwcm9wZXJ0eS52YWx1ZSAvIDEwMCkpCiAgICAgICAgICAgICAgICB3aGVuIDUgICMgUy1QYXJhbWV0ZXIKICAgICAgICAgICAgICAgICAgICBAc1BhcmFtZXRlcnNbcHJvcGVydHkuaWRdICs9IHByb3BlcnR5LnZhbHVlCiAgICAgICAgICAgICAgICB3aGVuIDYgICMgWC1QYXJhbWV0ZXIKICAgICAgICAgICAgICAgICAgICBAeFBhcmFtZXRlcnNbcHJvcGVydHkuaWRdICo9IChwcm9wZXJ0eS52YWx1ZSAvIDEwMCkKICAgICAgICAgICAgICAgIHdoZW4gMTEgIyBBZGQgU2tpbGwtVHlwZSAKICAgICAgICAgICAgICAgICAgICBAc2tpbGxUeXBlc1twcm9wZXJ0eS5pZF0gPSBSZWNvcmRNYW5hZ2VyLnNraWxsVHlwZXNbcHJvcGVydHkuaWRdCiAgICAgICAgICAgICAgICAgICAgaWYgbm90IEBza2lsbHNbcHJvcGVydHkuaWRdPwogICAgICAgICAgICAgICAgICAgICAgICBAc2tpbGxzW3Byb3BlcnR5LmlkXSA9IFtdCiAgICAgICAgICAgICAgICB3aGVuIDEyICMgUmVtb3ZlIFNraWxsIFR5cGUKICAgICAgICAgICAgICAgICAgICBAc2tpbGxUeXBlc1twcm9wZXJ0eS5pZF0gPSBudWxsCiAgICAgICAgICAgICAgICAgICAgQHNraWxsc1twcm9wZXJ0eS5pZF0gPSBbXQogICAgICAgICAgICAgICAgd2hlbiAxMyAjIEFkZCBTa2lsbAogICAgICAgICAgICAgICAgICAgIHNraWxsID0gUmVjb3JkTWFuYWdlci5za2lsbHNbcHJvcGVydHkuaWRdCgogICAgICAgICAgICAgICAgICAgIGlmIEBza2lsbHNbc2tpbGwuc2tpbGxUeXBlXT8KICAgICAgICAgICAgICAgICAgICAgICAgQHNraWxsc1tza2lsbC5za2lsbFR5cGVdW3NraWxsLmluZGV4XSA9IHNraWxsCiAgICAgICAgICAgICAgICB3aGVuIDE0ICMgUmVtb3ZlIFNraWxsCiAgICAgICAgICAgICAgICAgICAgc2tpbGwgPSBSZWNvcmRNYW5hZ2VyLnNraWxsc1twcm9wZXJ0eS5pZF0KICAgICAgICAgICAgICAgICAgICBpZiBAc2tpbGxzW3NraWxsLnNraWxsVHlwZV0/CiAgICAgICAgICAgICAgICAgICAgICAgIEBza2lsbHNbc2tpbGwuc2tpbGxUeXBlXVtza2lsbC5pbmRleF0gPSBudWxsCiAgICAgICAgICAgICAgICB3aGVuIDE1ICMgRXF1aXAgV2VhcG9uCiAgICAgICAgICAgICAgICAgICAgQHdlYXBvblR5cGVzW3Byb3BlcnR5LmlkXSA9IFJlY29yZE1hbmFnZXIud2VhcG9uVHlwZXNbcHJvcGVydHkuaWRdCiAgICAgICAgICAgICAgICB3aGVuIDE2ICMgRXF1aXAgQXJtb3IKICAgICAgICAgICAgICAgICAgICBAYXJtb3JUeXBlc1twcm9wZXJ0eS5pZF0gPSBSZWNvcmRNYW5hZ2VyLmFybW9yVHlwZXNbcHJvcGVydHkuaWRdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIHdoZW4gMTcgIyBGaXggRXF1aXBtZW50IFNsb3QKICAgICAgICAgICAgICAgICAgICBAZXF1aXBtZW50U2xvdHNbcHJvcGVydHkuaWRdLmZpeGVkID0geWVzCiAgICAgICAgICAgICAgICB3aGVuIDE4ICMgU2VhbCBFcXVpcG1lbnQgU2xvdAogICAgICAgICAgICAgICAgICAgIEBlcXVpcG1lbnRTbG90c1twcm9wZXJ0eS5pZF0uc2VhbGVkID0geWVzCiAgICAgICAgICAgICAgICB3aGVuIDE5ICMgU2xvdCBUeXBlCiAgICAgICAgICAgICAgICAgICAgQHNsb3RUeXBlID0gcHJvcGVydHkuaWQKICAgICAgICAgICAgICAgIHdoZW4gMjAgIyBBY3Rpb25zIHBlciBUdXJuCiAgICAgICAgICAgICAgICAgICAgQGFjdGlvblRpbWUgKz0gcHJvcGVydHkudmFsdWUKICAgICAgICAgICAgICAgIHdoZW4gMjEgIyBTcGVjaWFsCiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIHByb3BlcnR5LmlkCiAgICAgICAgICAgICAgICAgICAgICAgIHdoZW4gMCAjIEF1dG8gQmF0dGxlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBAYXV0b0JhdHRsZSA9IHllcwogICAgICAgICAgICAgICAgICAgICAgICB3aGVuIDEKICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBndWFyZCA9IHllcwogICAgICAgICAgICAgICAgd2hlbiAyMiAjIEF0dGFjayBTa2lsbAogICAgICAgICAgICAgICAgICAgIEBhdHRhY2tTa2lsbCA9IFJlY29yZE1hbmFnZXIuc2tpbGxzW3Byb3BlcnR5LmlkXSB8fCBSZWNvcmRNYW5hZ2VyLnNraWxsc1swXQogICAgICAgICAgICAgICAgd2hlbiAyMyAjIEF0dGFjayBFbGVtZW50CiAgICAgICAgICAgICAgICAgICAgQGF0dGFja1NraWxsLmRhbWFnZS5lbGVtZW50SWQgPSBSZWNvcmRNYW5hZ2VyLmVsZW1lbnRzW3Byb3BlcnR5LmlkXSB8fCBSZWNvcmRNYW5hZ2VyLmVsZW1lbnRzWzBdCiAgICAgICAgICAgICAgICB3aGVuIDI0ICMgQXR0YWNrIFN0YXRlCiAgICAgICAgICAgICAgICAgICAgQGF0dGFja1NraWxsLmVmZmVjdHMucHVzaCh7IGNvZGU6IDQsIGlkOiBwcm9wZXJ0eS5pZCwgdmFsdWUxOiBwcm9wZXJ0eS52YWx1ZSB9KQogICAgICAgICAgICAgICAgd2hlbiAyNSAjIEF0dGFjayBTcGVlZAogICAgICAgICAgICAgICAgICAgIEBhdHRhY2tTa2lsbC5zcGVlZCA9IHByb3BlcnR5LnZhbHVlCiAgICAgICAgICAgICAgICB3aGVuIDI2ICMgQXR0YWNrIFRpbWVzCiAgICAgICAgICAgICAgICAgICAgQGF0dGFja1NraWxsLnJlcGVhdHMgPSBwcm9wZXJ0eS52YWx1ZQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIAogICAgICAgIGZvciBpIGluIFswLi4uOF0KICAgICAgICAgICAgdmFsdWUgPSBwYXJhbUJ1ZmZzW2ldICsgQGJhc2VQYXJhbWV0ZXIoaSkgCiAgICAgICAgICAgIGlmIEB3ZWFwb24/IHRoZW4gdmFsdWUgPSB2YWx1ZSArIEB3ZWFwb24ucGFyYW1zW2ldCiAgICAgICAgICAgIGlmIEBzaGllbGQ/IHRoZW4gdmFsdWUgPSB2YWx1ZSArIEBzaGllbGQucGFyYW1zW2ldCiAgICAgICAgICAgIGlmIEBoZWFkPyB0aGVuIHZhbHVlID0gdmFsdWUgKyBAaGVhZC5wYXJhbXNbaV0KICAgICAgICAgICAgaWYgQGJvZHk/IHRoZW4gdmFsdWUgPSB2YWx1ZSArIEBib2R5LnBhcmFtc1tpXQogICAgICAgICAgICBpZiBAYWNjZXNzb3J5PyB0aGVuIHZhbHVlID0gdmFsdWUgKyBAYWNjZXNzb3J5LnBhcmFtc1tpXQogICAgICAgICAgICAKICAgICAgICAgICAgZm9yIGJ1ZmYgaW4gQGJ1ZmZzW2ldCiAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlICsgdmFsdWUgKiAoYnVmZi52YWx1ZSAvIDEwMCkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICBmb3IgZGVidWZmIGluIEBkZWJ1ZmZzW2ldCiAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlIC0gdmFsdWUgKiAoZGVidWZmLnZhbHVlIC8gMTAwKQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICBzd2l0Y2ggaQogICAgICAgICAgICAgICAgd2hlbiAwIHRoZW4gQG1scCA9IE1hdGgubWF4KHZhbHVlLCAxKQogICAgICAgICAgICAgICAgd2hlbiAxIHRoZW4gQG1tcCA9IE1hdGgubWF4KHZhbHVlLCAxKQogICAgICAgICAgICAgICAgd2hlbiAyIHRoZW4gQGF0ayA9IE1hdGgubWF4KHZhbHVlLCAxKQogICAgICAgICAgICAgICAgd2hlbiAzIHRoZW4gQGRlZiA9IE1hdGgubWF4KHZhbHVlLCAxKQogICAgICAgICAgICAgICAgd2hlbiA0IHRoZW4gQG1hdCA9IE1hdGgubWF4KHZhbHVlLCAxKQogICAgICAgICAgICAgICAgd2hlbiA1IHRoZW4gQG1kZiA9IE1hdGgubWF4KHZhbHVlLCAxKQogICAgICAgICAgICAgICAgd2hlbiA2IHRoZW4gQGFnaSA9IE1hdGgubWF4KHZhbHVlLCAxKQogICAgICAgICAgICAgICAgd2hlbiA3IHRoZW4gQGx1ayA9IE1hdGgubWF4KHZhbHVlLCAxKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAKICAgICAgICBAbHAgPSBNYXRoLm1pbihAbHAsIEBtbHApCiAgICAgICAgQG1wID0gTWF0aC5taW4oQG1wLCBAbW1wKQogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgIAogICAgICAgIGlmIEBjbGFzcz8KICAgICAgICAgICAgZm9yIGxlYXJuYWJsZVNraWxsIGluIEBjbGFzcy5sZWFybmFibGVTa2lsbHMKICAgICAgICAgICAgICAgIGlmIEBsZXZlbCA+PSBsZWFybmFibGVTa2lsbC5sZXZlbAogICAgICAgICAgICAgICAgICAgIHNraWxsID0gUmVjb3JkTWFuYWdlci5za2lsbHNbbGVhcm5hYmxlU2tpbGwuc2tpbGxJZF0KICAgICAgICAgICAgICAgICAgICBpZiBAc2tpbGxzW3NraWxsLnNraWxsVHlwZV0/CiAgICAgICAgICAgICAgICAgICAgICAgIEBza2lsbHNbc2tpbGwuc2tpbGxUeXBlXVtza2lsbC5pbmRleF0gPSBza2lsbAogICAgICAgICAgICAgICAgICAgIAogICAgICAgIEBoaXRSYXRlID0gQHhQYXJhbWV0ZXJzWzBdCiAgICAgICAgQGRlZmVuc2VSYXRlID0gQHhQYXJhbWV0ZXJzWzFdCiAgICAgICAgCiAgICAgICAgQGV2YXNpb25SYXRlID0gQHNQYXJhbWV0ZXJzWzFdCiAgICAgICAgQGNyaXRpY2FsSGl0UmF0ZSA9IEBzUGFyYW1ldGVyc1syXQogICAgICAgIEBjcml0aWNhbEV2YXNpb25SYXRlID0gQHNQYXJhbWV0ZXJzWzNdCiAgICAgICAgQG1hZ2ljRXZhc2lvblJhdGUgPSBAc1BhcmFtZXRlcnNbNF0KICAgICAgICBAbWFnaWNSZWZsZWN0aW9uUmF0ZSA9IEBzUGFyYW1ldGVyc1s1XQogICAgICAgIEBjb3VudGVyUmF0ZSA9IEBzUGFyYW1ldGVyc1s2XQogICAgICAgIEBscFJlZ2VuZXJhdGlvblJhdGUgPSBAc1BhcmFtZXRlcnNbN10KICAgICAgICBAbXBSZWdlbmVyYXRpb25SYXRlID0gQHNQYXJhbWV0ZXJzWzhdCiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgIEBjaGVja0ZvckRlYXRoKCkKICAgIAogICAgCiAgICBsZXZlbFVwOiAobGV2ZWwpIC0+CiAgICAgICAgQGxldmVsID0gbGV2ZWwKICAgICAgICBAZXhwID0gQGNsYXNzLmV4cEN1cnZlLnZhbHVlc1tAbGV2ZWwtMV0KICAgICAgICAKICAgIGNoZWNrU3RhdGVzOiAoYWN0aW9uRW5kLCB0dXJuRW5kLCBiYXR0bGVFbmQsIHR1cm5zLCBzdGVwcywgZGFtYWdlKSAtPgogICAgICAgIGkgPSAwCiAgICAgICAgcmVtb3ZlZFN0YXRlcyA9IFtdCiAgICAgICAgd2hpbGUgaSA8IEBzdGF0ZXMubGVuZ3RoCiAgICAgICAgICAgIHN0YXRlID0gQHN0YXRlc1tpXQogICAgICAgICAgICByZW1vdmUgPSBubwogICAgICAgICAgICAKICAgICAgICAgICAgc3dpdGNoIHN0YXRlLmF1dG9SZW1vdmUKICAgICAgICAgICAgICAgIHdoZW4gMSAjIEFjdGlvbiBFbmQKICAgICAgICAgICAgICAgICAgICByZW1vdmUgPSBhY3Rpb25FbmQKICAgICAgICAgICAgICAgIHdoZW4gMiAjIFR1cm4gRW5kCiAgICAgICAgICAgICAgICAgICAgcmVtb3ZlID0gdHVybkVuZAoKICAgICAgICAgICAgaWYgbm90IHJlbW92ZSBhbmQgbm90IChzdGF0ZS5taW5EdXJhdGlvbiA9PSAwKQogICAgICAgICAgICAgICAgZHVyYXRpb24gPSBzdGF0ZS5taW5EdXJhdGlvbiArIE1hdGgucm91bmQoKE1hdGgucmFuZG9tKCkgKiBNYXRoLm1heCgwLCBzdGF0ZS5tYXhEdXJhdGlvbiAtIHN0YXRlLm1pbkR1cmF0aW9uKSkpCiAgICAgICAgICAgICAgICByZW1vdmUgPSAodHVybnMgLSBzdGF0ZS50dXJuQWRkZWQpID49IGR1cmF0aW9uCiAgICAgICAgICAgIGlmIG5vdCByZW1vdmUgYW5kIHN0YXRlLnJlbW92ZUJ5V2Fsa2luZwogICAgICAgICAgICAgICAgcmVtb3ZlID0gKHN0ZXBzIC0gKHN0YXRlLnN0ZXBzIHx8IDApKSA+PSBzdGF0ZS5yZW1vdmVCeVdhbGtpbmdWYWx1ZQogICAgICAgICAgICBpZiBub3QgcmVtb3ZlIGFuZCBzdGF0ZS5yZW1vdmVCeURhbWFnZQogICAgICAgICAgICAgICAgcmVtb3ZlID0gZGFtYWdlID49IHN0YXRlLnJlbW92ZUJ5RGFtYWdlVmFsdWUKICAgICAgICAgICAgaWYgbm90IHJlbW92ZSBhbmQgc3RhdGUucmVtb3ZlQXRCYXR0bGVFbmQKICAgICAgICAgICAgICAgIHJlbW92ZSA9IGJhdHRsZUVuZAogICAgICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIHJlbW92ZQogICAgICAgICAgICAgICAgQHN0YXRlcy5zcGxpY2UoaSwgMSkKICAgICAgICAgICAgICAgIHJlbW92ZWRTdGF0ZXMucHVzaChzdGF0ZSkKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgaSsrCiAgICAgICAgICAgICAgICAKICAgICAgICByZXR1cm4gcmVtb3ZlZFN0YXRlcwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgIAogICAgICAgICAgICAKICAgIGNoZWNrU3RhdGVSZXNpc3RhbmNlOiAoc3RhdGUpIC0+CiAgICAgICAgcmVzdWx0ID0gbm8KICAgICAgICBmb3IgcHJvcGVydHkgaW4gQHByb3BlcnRpZXMKICAgICAgICAgICAgaWYgcHJvcGVydHkuY29kZSA9PSAzIGFuZCBwcm9wZXJ0eS5pZCA9PSBzdGF0ZS5pbmRleAogICAgICAgICAgICAgICAgcmVzdWx0ID0geWVzCiAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgCiAgICAgICAgcmV0dXJuIHJlc3VsdAogICAgICAgIAogICAgYWRkU2tpbGw6IChza2lsbCkgLT4KICAgICAgICBpZiBAc2tpbGxUeXBlc1tza2lsbC5za2lsbFR5cGVdPwogICAgICAgICAgICBAc2tpbGxzW3NraWxsLnNraWxsVHlwZV1bc2tpbGwuaW5kZXhdID0gc2tpbGwKICAgICAgICAKICAgIHJlbW92ZVNraWxsOiAoc2tpbGwpIC0+CiAgICAgICAgaWYgQHNraWxsVHlwZXNbc2tpbGwuc2tpbGxUeXBlXT8KICAgICAgICAgICAgQHNraWxsc1tza2lsbC5za2lsbFR5cGVdW3NraWxsLmluZGV4XSA9IG51bGwKICAgICAgICAKICAgIGFkZFN0YXRlOiAoc3RhdGUpIC0+CiAgICAgICAgaWYgc3RhdGU/IGFuZCBAc3RhdGVzLmluZGV4T2Yoc3RhdGUpID09IC0xCiAgICAgICAgICAgIHN0YXRlLnN0ZXBzID0gR2FtZU1hbmFnZXIucGxheWVyLnN0ZXBzCiAgICAgICAgICAgIGlmIFNjZW5lTWFuYWdlci5zY2VuZS50dXJuPwogICAgICAgICAgICAgICAgc3RhdGUudHVybkFkZGVkID0gU2NlbmVNYW5hZ2VyLnNjZW5lLnR1cm4KICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgc3RhdGUudHVybkFkZGVkID0gMAogICAgICAgICAgICBAc3RhdGVzLnB1c2goc3RhdGUpCiAgICAgICAgICAgIEBzdGF0ZXMuc29ydCAoYSwgYikgPT4KICAgICAgICAgICAgICAgIGlmIGEucHJpb3JpdHkgPiBiLnByaW9yaXR5CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDEKICAgICAgICAgICAgICAgIGVsc2UgaWYgYS5wcmlvcml0eSA8IGIucHJpb3JpdHkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gLTEKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICByZXR1cm4gMAogICAgaGFzU3RhdGU6IChzdGF0ZSkgLT4gQHN0YXRlcy5pbmRleE9mKHN0YXRlKSAhPSAtMQogICAgcmVtb3ZlU3RhdGU6IChzdGF0ZSkgLT4KICAgICAgICBAc3RhdGVzLnJlbW92ZShzdGF0ZSkKICAgICAgICAKICAgIGhhc1N0YXRlOiAoc3RhdGUpIC0+IEBzdGF0ZXMuaW5kZXhPZihzdGF0ZSkgIT0gLTEKICAgIGFkZEJ1ZmY6IChwYXJhbSwgdHVybnMsIHZhbHVlKSAtPgogICAgICAgIEBidWZmc1twYXJhbV0ucHVzaCh7IHR1cm5zOiB0dXJucywgdmFsdWU6IHZhbHVlIH0pCiAgICAgICAgCiAgICBhZGREZWJ1ZmY6IChwYXJhbSwgdHVybnMsIHZhbHVlKSAtPgogICAgICAgIEBkZWJ1ZmZzW3BhcmFtXS5wdXNoKHsgdHVybnM6IHR1cm5zLCB2YWx1ZTogdmFsdWUgfSkKICAgICAgICAKICAgIHJlbW92ZUJ1ZmY6IChwYXJhbSkgLT4KICAgICAgICBAYnVmZnNbcGFyYW1dID0gW10KICAgICAgICAKICAgIHJlbW92ZURlYnVmZjogKHBhcmFtKSAtPgogICAgICAgIEBkZWJ1ZmZzW3BhcmFtXSA9IFtdCiAgICAgICAgCiAgICBhcHBseUVmZmVjdDogKGVmZmVjdCkgLT4KICAgICAgICBpbmZvID0gbnVsbAogICAgICAgIHZhbHVlID0gZWZmZWN0LnZhbHVlMQogICAgICAgIHN1Y2Nlc3MgPSB5ZXMKICAgICAgICBpZCA9IGVmZmVjdC5pZAogICAgICAgIAogICAgICAgIHN3aXRjaCBlZmZlY3QuY29kZQogICAgICAgICAgICB3aGVuIDAgIyBDaGFuZ2UgTFAKICAgICAgICAgICAgICAgIGxwID0gQGxwCiAgICAgICAgICAgICAgICBAY2hhbmdlTHAoQG1scCAqIChlZmZlY3QudmFsdWUxIC8gMTAwKSkKICAgICAgICAgICAgICAgIEBjaGFuZ2VMcChlZmZlY3QudmFsdWUyKQogICAgICAgICAgICAgICAgdmFsdWUgPSBAbHAgLSBscAogICAgICAgICAgICB3aGVuIDEgIyBDaGFuZ2UgTVAKICAgICAgICAgICAgICAgIG1wID0gQG1wCiAgICAgICAgICAgICAgICBAY2hhbmdlTXAoQG1tcCAqIChlZmZlY3QudmFsdWUxIC8gMTAwKSkKICAgICAgICAgICAgICAgIEBjaGFuZ2VNcChlZmZlY3QudmFsdWUyKQogICAgICAgICAgICAgICAgdmFsdWUgPSBAbXAgLSBscAogICAgICAgICAgICAjd2hlbiAyICMgQ2hhbmdlIENQCiAgICAgICAgICAgIHdoZW4gMyAjIEFkZCBTdGF0ZQogICAgICAgICAgICAgICAgc3RhdGUgPSBSZWNvcmRNYW5hZ2VyLnN0YXRlc1tlZmZlY3QuaWRdCiAgICAgICAgICAgICAgICBpZiBub3QgQGNoZWNrU3RhdGVSZXNpc3RhbmNlKHN0YXRlKSBhbmQgbm90IEBoYXNTdGF0ZShzdGF0ZSkgYW5kIE1hdGgucmFuZG9tKCkgKiAxMDAgPCBlZmZlY3QudmFsdWUxCiAgICAgICAgICAgICAgICAgICAgQGFkZFN0YXRlKHN0YXRlKQogICAgICAgICAgICAgICAgICAgIHZhbHVlID0gc3RhdGUKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICBzdWNjZXNzID0gbm8KICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgd2hlbiA0ICMgUmVtb3ZlIFN0YXRlCiAgICAgICAgICAgICAgICBpZiBNYXRoLnJhbmRvbSgpICogMTAwIDwgZWZmZWN0LnZhbHVlMQogICAgICAgICAgICAgICAgICAgIEByZW1vdmVTdGF0ZShSZWNvcmRNYW5hZ2VyLnN0YXRlc1tlZmZlY3QuaWRdKQogICAgICAgICAgICAgICAgICAgIHZhbHVlID0gUmVjb3JkTWFuYWdlci5zdGF0ZXNbZWZmZWN0LmlkXQogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3MgPSBubwogICAgICAgICAgICB3aGVuIDUgIyBBZGQgQnVmZgogICAgICAgICAgICAgICAgQGFkZEJ1ZmYoZWZmZWN0LmlkLCBlZmZlY3QudmFsdWUyLCBlZmZlY3QudmFsdWUxKQogICAgICAgICAgICB3aGVuIDYgIyBBZGQgRGVidWZmCiAgICAgICAgICAgICAgICBAYWRkRGVidWZmKGVmZmVjdC5pZCwgZWZmZWN0LnZhbHVlMiwgZWZmZWN0LnZhbHVlMSkKICAgICAgICAgICAgd2hlbiA3ICMgUmVtb3ZlIEJ1ZmYKICAgICAgICAgICAgICAgIEByZW1vdmVCdWZmKGVmZmVjdC5pZCkKICAgICAgICAgICAgd2hlbiA4ICMgUmVtb3ZlIERlYnVmZgogICAgICAgICAgICAgICAgQHJlbW92ZURlYnVmZihlZmZlY3QuaWQpCiAgICAgICAgICAgIHdoZW4gOSAjIFNwZWNpYWwgRWZmZWN0CiAgICAgICAgICAgICAgICBpZiBHYW1lTWFuYWdlci5zY2VuZSBpbnN0YW5jZW9mIFNjZW5lX0JhdHRsZQogICAgICAgICAgICAgICAgICAgIEdhbWVNYW5hZ2VyLnNjZW5lLmVzY2FwZSgpCiAgICAgICAgICAgIHdoZW4gMTAgIyBMZWFybiBTa2lsbAogICAgICAgICAgICAgICAgc2tpbGwgPSBSZWNvcmRNYW5hZ2VyLnNraWxsc1tlZmZlY3QuaWRdCiAgICAgICAgICAgICAgICBpZiBAc2tpbGxzW3NraWxsLnNraWxsVHlwZV0/CiAgICAgICAgICAgICAgICAgICAgQHNraWxsc1tza2lsbC5za2lsbFR5cGVdW2VmZmVjdC5pZF0gPSBza2lsbAogICAgICAgICAgICB3aGVuIDExICMgQ29tbW9uIEV2ZW50CiAgICAgICAgICAgICAgICBldmVudElkID0gZWZmZWN0LmlkCiAgICAgICAgICAgICAgICBjb21tb25FdmVudCA9IEdhbWVNYW5hZ2VyLmNvbW1vbkV2ZW50c1tldmVudElkXQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBpZiBjb21tb25FdmVudD8KICAgICAgICAgICAgICAgICAgICBjb21tb25FdmVudC5zdGFydChlZmZlY3QucGFyYW1ldGVycyB8fCBbXSkKICAgICAgICAgICAgd2hlbiAxMiAjIENoYW5nZSBQYXJhbWV0ZXIgcGVybWFuZW50bHkKICAgICAgICAgICAgICAgIGZvciBpIGluIFswLi4uQG1heExldmVsXQogICAgICAgICAgICAgICAgICAgIEBwYXJhbXNbZWZmZWN0LmlkXVtpXSArPSBlZmZlY3QudmFsdWUxCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAKICAgICAgICByZXR1cm4geyBjb2RlOiBlZmZlY3QuY29kZSwgdmFsdWU6IHZhbHVlLCBpZDogaWQsIHN1Y2Nlc3M6IHN1Y2Nlc3MgfQogICAgICAgICAgICAKICAgIGFwcGx5RXhQYXJhbWV0ZXJzOiAtPgogICAgICAgIEBscCA9IE1hdGgubWF4KEBscCArIE1hdGguZmxvb3IoQG1scCAqICgoQGxwUmVnZW5lcmF0aW9uUmF0ZSkgLyAxMDApKSwgMCkKICAgICAgICBAbXAgPSBNYXRoLm1heChAbXAgKyBNYXRoLmZsb29yKEBtbXAgKiAoKEBtcFJlZ2VuZXJhdGlvblJhdGUpIC8gMTAwKSksIDApCiAgICAgICAgCiAgICAKICAgICAgICAgICAgICAgIAogICAgYXR0YWNrOiAodGFyZ2V0KSAtPgogICAgICAgIHRhcmdldC5scCA9IE1hdGguZmxvb3IoTWF0aC5tYXgodGFyZ2V0LmxwIC0gTWF0aC5tYXgoQGF0ayAtIHRhcmdldC5kZWYgKiAwLjUsIDApLCAwKSkgICAgCiAKICAgIHVzZVNraWxsOiAoc2tpbGwsIHRhcmdldCkgLT4gQHVzZUl0ZW0oc2tpbGwsIHRhcmdldCkKICAgIAogICAgICAgIAogICAgdGFrZURhbWFnZTogKGRhbWFnZSwgYSwgYiwgY3JpdGljYWwpIC0+CiAgICAgICAgaWYgZGFtYWdlLnR5cGUgPT0gMCB0aGVuIHJldHVybiAwCiAgICAgICAgCiAgICAgICAgdmFsdWUgPSAwCiAgICAgICAgYiA9IGIgfHwgdGhpcwogICAgICAgIGlmIGRhbWFnZS5wZXJjZW50YWdlPyAjIEZsb29yIERhbWFnZQogICAgICAgICAgICBzd2l0Y2ggZGFtYWdlLnR5cGUKICAgICAgICAgICAgICAgIHdoZW4gMSBvciAzCiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBNYXRoLm1heChAbWxwIC8gMTAwICogZGFtYWdlLnBlcmNlbnRhZ2UsIDApICsgZGFtYWdlLnZhbHVlCiAgICAgICAgICAgICAgICB3aGVuIDIgb3IgNAogICAgICAgICAgICAgICAgICAgIHZhbHVlID0gTWF0aC5tYXgoQG1tcCAvIDEwMCAqIGRhbWFnZS5wZXJjZW50YWdlLCAwKSArIGRhbWFnZS52YWx1ZQogCiAgICAgICAgZWxzZSBpZiBkYW1hZ2UuZm9ybXVsYS50cmltKCkgIT0gIiIgIyBOb3JtYWwgRGFtYWdlCiAgICAgICAgICAgIHZhbHVlID0gZXZhbChkYW1hZ2UuZm9ybXVsYSkKICAgICAgICAgCiAgICAgICAgIyBWYXJpYW5jZSAKICAgICAgICBtaW4gPSBkYW1hZ2UudmFyaWFuY2UgLyAxMDAgKiB2YWx1ZQogICAgICAgIG1pbiA9ICgxICsgTWF0aC5yYW5kb20oKSAqIG1pbikgKyAoMSArIE1hdGgucmFuZG9tKCkgKiBtaW4pIC0gbWluCiAgICAgICAgdmFsdWUgPSBNYXRoLmZsb29yKGlmIHZhbHVlID49IDAgdGhlbiB2YWx1ZSArIG1pbiBlbHNlIHZhbHVlIC0gbWluKQogICAgICAgIGVsZW1lbnRSYXRlID0gKGIuZWxlbWVudFJhdGVzW2RhbWFnZS5lbGVtZW50SWRdIHx8IDEwMCkgLyAxMDAKICAgICAgICAgCiAgICAgICAgdmFsdWUgKj0gZWxlbWVudFJhdGUKICAgICAgICAKICAgICAgICBpZiBkYW1hZ2UuY3JpdGljYWwgYW5kIGNyaXRpY2FsCiAgICAgICAgICAgIHZhbHVlICo9IDMKICAgICAgICAgICAgCiAgICAgICAgaWYgQGd1YXJkCiAgICAgICAgICAgIHZhbHVlID0gdmFsdWUgKiAoMTAwIC8gQGRlZmVuc2VSYXRlKQogICAgICAgICAgICAKICAgICAgICBzd2l0Y2ggZGFtYWdlLnR5cGUKICAgICAgICAgICAgd2hlbiAxCiAgICAgICAgICAgICAgICBAbHAgPSBNYXRoLm1pbihNYXRoLm1heChAbHAgLSBNYXRoLm1heCh2YWx1ZSwgMCksIDApLCBAbWxwKQogICAgICAgICAgICB3aGVuIDIKICAgICAgICAgICAgICAgIEBtcCA9IE1hdGgubWluKE1hdGgubWF4KEBtcCAtIE1hdGgubWF4KHZhbHVlLCAwKSwgMCksIEBtbXApCiAgICAgICAgICAgIHdoZW4gMwogICAgICAgICAgICAgICAgQGxwID0gTWF0aC5tYXgoTWF0aC5taW4oQGxwICsgTWF0aC5tYXgodmFsdWUsIDApLCBAbWxwKSwgMCkKICAgICAgICAgICAgd2hlbiA0CiAgICAgICAgICAgICAgICBAbXAgPSBNYXRoLm1heChNYXRoLm1pbihAbXAgKyBNYXRoLm1heCh2YWx1ZSwgMCksIEBtbXApLCAwKQogICAgICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgQGNoZWNrU3RhdGVzKG5vLCBubywgbm8sIDAsIDAsIE1hdGguZmxvb3IodmFsdWUpKQogICAgICAgIEBjaGVja0ZvckRlYXRoKCkKICAgICAgICAKICAgICAgICByZXR1cm4gTWF0aC5mbG9vcih2YWx1ZSkKICAgICAgICAKICAgIGNoZWNrRm9yRGVhdGg6IC0+CiAgICAgICAgQGlzQWxpdmUgPSBAbHAgPiAwCiAgICAgICAgaWYgbm90IEBpc0FsaXZlIGFuZCBub3QgQGNoZWNrU3RhdGVSZXNpc3RhbmNlKFJlY29yZE1hbmFnZXIuc3RhdGVzWzBdKQogICAgICAgICAgICAjIERlYXRoIHN0YXRlIGlzIGFsd2F5cyB0aGUgc3RhdGUgYXQgaW5kZXggemVyby4KICAgICAgICAgICAgQHN0YXRlcyA9IFtdCiAgICAgICAgICAgIEBhZGRTdGF0ZShSZWNvcmRNYW5hZ2VyLnN0YXRlc1swXSkKICAgICAgICBlbHNlCiAgICAgICAgICAgIEByZW1vdmVTdGF0ZShSZWNvcmRNYW5hZ2VyLnN0YXRlc1swXSkKICAgICAgICAgICAgQGlzQWxpdmUgPSB5ZXMKICAgICAgICAgICAgCiAgICB1c2VJdGVtOiAoaXRlbSwgdGFyZ2V0KSAtPgogICAgICAgIEBtcCA9IE1hdGgubWF4KEBtcCAtIGl0ZW0ubXBDb3N0LCAwKQogICAgICAgIAogICAgICAgIHZhbHVlID0gMAogICAgICAgIGhpdCA9IHllcwogICAgICAgIGNvdW50ZXIgPSBubwogICAgICAgIGVmZmVjdEluZm9zID0gW10KICAgICAgICBzdWNjZXNzID0gTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpICogMTAwKSA8PSBpdGVtLnN1Y2Nlc3MKICAgICAgICAKICAgICAgICBzd2l0Y2ggaXRlbS5oaXRUeXBlCiAgICAgICAgICAgIHdoZW4gMSAjIFBoeXNpY2FsCiAgICAgICAgICAgICAgICBoaXRSYXRlID0gTWF0aC5tYXgoTWF0aC5taW4oQGhpdFJhdGUgLSAodGFyZ2V0LmV2YXNpb25SYXRlKSwgMTAwKSwgMCkKICAgICAgICAgICAgICAgIGhpdCA9IE1hdGgucm91bmQoTWF0aC5yYW5kb20oKSAqIDEwMCkgPD0gaGl0UmF0ZQogICAgICAgICAgICAgICAgaWYgaGl0IAogICAgICAgICAgICAgICAgICAgIGNvdW50ZXIgPSBNYXRoLnJvdW5kKE1hdGgucmFuZG9tKCkgKiAxMDApIDwgKHRhcmdldC5jb3VudGVyUmF0ZSAtIDEwMCkKICAgICAgICAgICAgICAgICAgICBoaXQgPSBub3QgY291bnRlcgogICAgICAgICAgICB3aGVuIDIgIyBNYWdpY2FsCiAgICAgICAgICAgICAgICBoaXRSYXRlID0gTWF0aC5tYXgoTWF0aC5taW4oQGhpdFJhdGUgLSAodGFyZ2V0Lm1hZ2ljRXZhc2lvblJhdGUpLCAxMDApLCAwKQogICAgICAgICAgICAgICAgaGl0ID0gTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpICogMTAwKSA8PSBoaXRSYXRlCiAgICAgICAgICAgICAgICBpZiBoaXQKICAgICAgICAgICAgICAgICAgICBjb3VudGVyID0gTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpICogMTAwKSA8ICh0YXJnZXQubWFnaWNSZWZsZWN0aW9uUmF0ZSkKICAgICAgICAgICAgICAgICAgICBoaXQgPSBub3QgY291bnRlcgogICAgICAgICAgICAgICAKICAgICAgICBjcml0aWNhbEhpdFJhdGUgPSBNYXRoLm1heChNYXRoLm1pbihAY3JpdGljYWxIaXRSYXRlIC0gKHRhcmdldC5jcml0aWNhbEV2YXNpb25SYXRlKSwgMTAwKSwgMCkKICAgICAgICBjcml0aWNhbCA9IE1hdGgucm91bmQoTWF0aC5yYW5kb20oKSAqIDEwMCkgPD0gY3JpdGljYWxIaXRSYXRlCiAgICAgICAgCiAgICAgICAgaWYgaGl0IGFuZCBzdWNjZXNzCiAgICAgICAgICAgIHZhbHVlID0gdGFyZ2V0LnRha2VEYW1hZ2UoaXRlbS5kYW1hZ2UsIHRoaXMsIHRhcmdldCwgY3JpdGljYWwpCiAgICAgICAgICAgICAgICAKICAgICAgICBmb3IgZWZmZWN0IGluIGl0ZW0uZWZmZWN0cwogICAgICAgICAgICBpbmZvID0gdGFyZ2V0LmFwcGx5RWZmZWN0KGVmZmVjdCkKICAgICAgICAgICAgZWZmZWN0SW5mb3MucHVzaChpbmZvKQogICAgICAgICAgICAgICAgCiAgICAgICAgcmV0dXJuIHsgdmFsdWU6IHZhbHVlLCBlZmZlY3RJbmZvczogZWZmZWN0SW5mb3MsIGhpdDogaGl0IGFuZCBzdWNjZXNzLCBjb3VudGVyOiBjb3VudGVyLCBjcml0aWNhbDogaXRlbS5kYW1hZ2UuY3JpdGljYWwgYW5kIGNyaXRpY2FsIH0KICAgICAgICAKd2luZG93LkxvZ2ljX0FjdG9yID0gTG9naWNfQWN0b3I=","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBMb2dpY19BY3RvcjsKCiAgTG9naWNfQWN0b3IgPSAoZnVuY3Rpb24oKSB7CiAgICBmdW5jdGlvbiBMb2dpY19BY3RvcihhY3RvciwgZGF0YSkgewogICAgICBpZiAoYWN0b3IgIT0gbnVsbCkgewogICAgICAgIGRhdGEgfHwgKGRhdGEgPSB7fSk7CiAgICAgICAgdGhpcy5hY3RvcklkID0gYWN0b3IuaW5kZXg7CiAgICAgICAgdGhpcy5hY3RvciA9IGFjdG9yOwogICAgICAgIHRoaXMubmFtZSA9IGRhdGEubmFtZSB8fCB0aGlzLmFjdG9yLm5hbWU7CiAgICAgICAgdGhpcy5ncmFwaGljID0gZGF0YS5ncmFwaGljIHx8IHRoaXMuYWN0b3IuZ3JhcGhpYzsKICAgICAgICB0aGlzLmZhY2VHcmFwaGljID0gZGF0YS5mYWNlR3JhcGhpYyB8fCB0aGlzLmFjdG9yLmZhY2VHcmFwaGljOwogICAgICAgIHRoaXMuZmFjZVBhdHRlcm4gPSBkYXRhLmZhY2VQYXR0ZXJuIHx8IHRoaXMuYWN0b3IuZmFjZVBhdHRlcm47CiAgICAgICAgdGhpcy5jaGFyYWN0ZXJHcmFwaGljID0gZGF0YS5jaGFyYWN0ZXJHcmFwaGljIHx8IHRoaXMuYWN0b3IuY2hhcmFjdGVyR3JhcGhpYzsKICAgICAgICB0aGlzLmNoYXJhY3RlclBhdHRlcm4gPSBkYXRhLmNoYXJhY3RlclBhdHRlcm4gfHwgdGhpcy5hY3Rvci5jaGFyYWN0ZXJQYXR0ZXJuOwogICAgICAgIHRoaXNbImNsYXNzIl0gPSBSZWNvcmRNYW5hZ2VyLmNsYXNzZXNbdGhpcy5hY3Rvci5jbGFzc0lkXTsKICAgICAgICB0aGlzLmxldmVsID0gZGF0YS5sZXZlbCB8fCB0aGlzLmFjdG9yLmluaXRpYWxMZXZlbDsKICAgICAgICB0aGlzLm1heExldmVsID0gdGhpcy5hY3Rvci5tYXhMZXZlbDsKICAgICAgICB0aGlzLnBhcmFtcyA9IGRhdGEucGFyYW1zIHx8IHRoaXNbImNsYXNzIl0ucGFyYW1zOwogICAgICAgIHRoaXMuYmF0dGxlUG9zaXRpb24gPSAoZGF0YS5iYXR0bGVQb3NpdGlvbiB8fCB0aGlzLmFjdG9yLmJhdHRsZVBvc2l0aW9uIHx8IFsKICAgICAgICAgIHsKICAgICAgICAgICAgeDogMCwKICAgICAgICAgICAgeTogMAogICAgICAgICAgfQogICAgICAgIF0pWzBdOwogICAgICAgIHRoaXMubWxwID0gdGhpcy5wYXJhbXNbMF1bdGhpcy5sZXZlbF07CiAgICAgICAgdGhpcy5tbXAgPSB0aGlzLnBhcmFtc1sxXVt0aGlzLmxldmVsXTsKICAgICAgICB0aGlzLmxwID0gdGhpcy5tbHA7CiAgICAgICAgdGhpcy5tcCA9IHRoaXMubW1wOwogICAgICAgIHRoaXMuYXRrID0gdGhpcy5wYXJhbXNbMl1bdGhpcy5sZXZlbF07CiAgICAgICAgdGhpcy5kZWYgPSB0aGlzLnBhcmFtc1szXVt0aGlzLmxldmVsXTsKICAgICAgICB0aGlzLm1hdCA9IHRoaXMucGFyYW1zWzRdW3RoaXMubGV2ZWxdOwogICAgICAgIHRoaXMubWRmID0gdGhpcy5wYXJhbXNbNV1bdGhpcy5sZXZlbF07CiAgICAgICAgdGhpcy5hZ2kgPSB0aGlzLnBhcmFtc1s2XVt0aGlzLmxldmVsXTsKICAgICAgICB0aGlzLmx1ayA9IHRoaXMucGFyYW1zWzddW3RoaXMubGV2ZWxdOwogICAgICAgIHRoaXMueFBhcmFtZXRlcnMgPSBbMCwgMCwgMCwgMCwgMCwgMCwgMF07CiAgICAgICAgdGhpcy5zUGFyYW1ldGVycyA9IFsxMDAsIDEwMCwgMTAwLCAxMDAsIDEwMCwgMTAwXTsKICAgICAgICB0aGlzLmhpdFJhdGUgPSAxMDA7CiAgICAgICAgdGhpcy5kZWZlbnNlUmF0ZSA9IDEwMDsKICAgICAgICB0aGlzLmV2YXNpb25SYXRlID0gMDsKICAgICAgICB0aGlzLmNyaXRpY2FsSGl0UmF0ZSA9IDA7CiAgICAgICAgdGhpcy5jcml0aWNhbEV2YXNpb25SYXRlID0gMDsKICAgICAgICB0aGlzLm1hZ2ljRXZhc2lvblJhdGUgPSAwOwogICAgICAgIHRoaXMubWFnaWNSZWZsZWN0aW9uUmF0ZSA9IDA7CiAgICAgICAgdGhpcy5jb3VudGVyUmF0ZSA9IDA7CiAgICAgICAgdGhpcy5scFJlZ2VuZXJhdGlvblJhdGUgPSAwOwogICAgICAgIHRoaXMubXBSZWdlbmVyYXRpb25SYXRlID0gMDsKICAgICAgICB0aGlzLmVsZW1lbnRSYXRlcyA9IFtdOwogICAgICAgIHRoaXMuZXF1aXBtZW50U2xvdHMgPSBbCiAgICAgICAgICB7CiAgICAgICAgICAgIGZpeGVkOiBmYWxzZSwKICAgICAgICAgICAgc2VhbGVkOiBmYWxzZQogICAgICAgICAgfSwgewogICAgICAgICAgICBmaXhlZDogZmFsc2UsCiAgICAgICAgICAgIHNlYWxlZDogZmFsc2UKICAgICAgICAgIH0sIHsKICAgICAgICAgICAgZml4ZWQ6IGZhbHNlLAogICAgICAgICAgICBzZWFsZWQ6IGZhbHNlCiAgICAgICAgICB9LCB7CiAgICAgICAgICAgIGZpeGVkOiBmYWxzZSwKICAgICAgICAgICAgc2VhbGVkOiBmYWxzZQogICAgICAgICAgfSwgewogICAgICAgICAgICBmaXhlZDogZmFsc2UsCiAgICAgICAgICAgIHNlYWxlZDogZmFsc2UKICAgICAgICAgIH0KICAgICAgICBdOwogICAgICAgIHRoaXMuc2xvdFR5cGUgPSAwOwogICAgICAgIHRoaXMuYWN0aW9uVGltZSA9IDEwMDsKICAgICAgICB0aGlzLmd1YXJkID0gZmFsc2U7CiAgICAgICAgdGhpcy5iYWRTdGF0dXMgPSBmYWxzZTsKICAgICAgICB0aGlzLndlYXBvbiA9IFJlY29yZE1hbmFnZXIud2VhcG9uc1tkYXRhLndlYXBvbklkIHx8IHRoaXMuYWN0b3Iud2VhcG9uSWRdOwogICAgICAgIHRoaXMuc2hpZWxkID0gUmVjb3JkTWFuYWdlci5hcm1vcnNbZGF0YS5zaGllbGRJZCB8fCB0aGlzLmFjdG9yLnNoaWVsZElkXTsKICAgICAgICB0aGlzLmhlYWQgPSBSZWNvcmRNYW5hZ2VyLmFybW9yc1tkYXRhLmhlYWRBcm1vcklkIHx8IHRoaXMuYWN0b3IuaGVhZEFybW9ySWRdOwogICAgICAgIHRoaXMuYm9keSA9IFJlY29yZE1hbmFnZXIuYXJtb3JzW2RhdGEuYm9keUFybW9ySWQgfHwgdGhpcy5hY3Rvci5ib2R5QXJtb3JJZF07CiAgICAgICAgdGhpcy5hY2Nlc3NvcnkgPSBSZWNvcmRNYW5hZ2VyLmFybW9yc1tkYXRhLmFjY2Vzc29yeUlkIHx8IHRoaXMuYWN0b3IuYWNjZXNzb3J5SWRdOwogICAgICAgIHRoaXMuaXNBbGl2ZSA9IHRydWU7CiAgICAgICAgdGhpcy5iYXNlUHJvcGVydGllcyA9IGRhdGEucHJvcGVydGllcyB8fCB0aGlzLmFjdG9yLnByb3BlcnRpZXM7CiAgICAgICAgdGhpcy5wcm9wZXJ0aWVzID0gZGF0YS5wcm9wZXJ0aWVzIHx8IHRoaXMuYWN0b3IucHJvcGVydGllczsKICAgICAgICB0aGlzLmV4cCA9IHRoaXNbImNsYXNzIl0uZXhwQ3VydmUudmFsdWVzW3RoaXMubGV2ZWwgLSAxXTsKICAgICAgICB0aGlzLmV4cFRvTmV4dExldmVsID0gdGhpc1siY2xhc3MiXS5leHBDdXJ2ZS52YWx1ZXNbdGhpcy5sZXZlbF07CiAgICAgICAgdGhpcy5za2lsbFR5cGVzID0gW107CiAgICAgICAgdGhpcy53ZWFwb25UeXBlcyA9IFtdOwogICAgICAgIHRoaXMuYXJtb3JUeXBlcyA9IFtdOwogICAgICAgIHRoaXMuc2tpbGxzID0gZGF0YS5za2lsbHMgfHwgW107CiAgICAgICAgdGhpcy5idWZmcyA9IFtbXSwgW10sIFtdLCBbXSwgW10sIFtdLCBbXSwgW11dOwogICAgICAgIHRoaXMuZGVidWZmcyA9IFtbXSwgW10sIFtdLCBbXSwgW10sIFtdLCBbXSwgW11dOwogICAgICAgIHRoaXMuc3RhdGVzID0gW107CiAgICAgICAgdGhpcy5hdHRhY2tTa2lsbCA9IE9iamVjdC5jb3B5KFJlY29yZE1hbmFnZXIuc2tpbGxzWzBdKTsKICAgICAgICB0aGlzLmFuaW1hdGlvbnMgPSBbXTsKICAgICAgICB0aGlzLmFuaW1hdGlvbnNCeVNraWxsID0gW107CiAgICAgICAgaWYgKCh0aGlzLmFjdG9yLnN0YW5kQW5pbWF0aW9uSWQgIT0gbnVsbCkgJiYgKFJlY29yZE1hbmFnZXIuc2ltcGxlQW5pbWF0aW9uc1t0aGlzLmFjdG9yLnN0YW5kQW5pbWF0aW9uSWRdICE9IG51bGwpKSB7CiAgICAgICAgICB0aGlzLnN0YW5kQW5pbWF0aW9uID0gbmV3IExvZ2ljX1NpbXBsZUFuaW1hdGlvbihSZWNvcmRNYW5hZ2VyLnNpbXBsZUFuaW1hdGlvbnNbdGhpcy5hY3Rvci5zdGFuZEFuaW1hdGlvbklkXSk7CiAgICAgICAgfQogICAgICAgIGlmICgodGhpcy5hY3Rvci5tYWdpY0FuaW1hdGlvbklkICE9IG51bGwpICYmIChSZWNvcmRNYW5hZ2VyLnNpbXBsZUFuaW1hdGlvbnNbdGhpcy5hY3Rvci5tYWdpY0FuaW1hdGlvbklkXSAhPSBudWxsKSkgewogICAgICAgICAgdGhpcy5tYWdpY0FuaW1hdGlvbiA9IG5ldyBMb2dpY19TaW1wbGVBbmltYXRpb24oUmVjb3JkTWFuYWdlci5zaW1wbGVBbmltYXRpb25zW3RoaXMuYWN0b3IubWFnaWNBbmltYXRpb25JZF0pOwogICAgICAgIH0KICAgICAgICBpZiAoKHRoaXMuYWN0b3IuYXR0YWNrQW5pbWF0aW9uSWQgIT0gbnVsbCkgJiYgKFJlY29yZE1hbmFnZXIuc2ltcGxlQW5pbWF0aW9uc1t0aGlzLmFjdG9yLmF0dGFja0FuaW1hdGlvbklkXSAhPSBudWxsKSkgewogICAgICAgICAgdGhpcy5hdHRhY2tBbmltYXRpb24gPSBuZXcgTG9naWNfU2ltcGxlQW5pbWF0aW9uKFJlY29yZE1hbmFnZXIuc2ltcGxlQW5pbWF0aW9uc1t0aGlzLmFjdG9yLmF0dGFja0FuaW1hdGlvbklkXSk7CiAgICAgICAgfQogICAgICAgIGlmICgodGhpcy5hY3Rvci5pdGVtQW5pbWF0aW9uSWQgIT0gbnVsbCkgJiYgKFJlY29yZE1hbmFnZXIuc2ltcGxlQW5pbWF0aW9uc1t0aGlzLmFjdG9yLml0ZW1BbmltYXRpb25JZF0gIT0gbnVsbCkpIHsKICAgICAgICAgIHRoaXMuaXRlbUFuaW1hdGlvbiA9IG5ldyBMb2dpY19TaW1wbGVBbmltYXRpb24oUmVjb3JkTWFuYWdlci5zaW1wbGVBbmltYXRpb25zW3RoaXMuYWN0b3IuaXRlbUFuaW1hdGlvbklkXSk7CiAgICAgICAgfQogICAgICAgIGlmICgodGhpcy5hY3Rvci5ndWFyZEFuaW1hdGlvbklkICE9IG51bGwpICYmIChSZWNvcmRNYW5hZ2VyLnNpbXBsZUFuaW1hdGlvbnNbdGhpcy5hY3Rvci5ndWFyZEFuaW1hdGlvbklkXSAhPSBudWxsKSkgewogICAgICAgICAgdGhpcy5ndWFyZEFuaW1hdGlvbiA9IG5ldyBMb2dpY19TaW1wbGVBbmltYXRpb24oUmVjb3JkTWFuYWdlci5zaW1wbGVBbmltYXRpb25zW3RoaXMuYWN0b3IuZ3VhcmRBbmltYXRpb25JZF0pOwogICAgICAgIH0KICAgICAgICBpZiAoKHRoaXMuYWN0b3IucHJlTWFnaWNBbmltYXRpb25JZCAhPSBudWxsKSAmJiAoUmVjb3JkTWFuYWdlci5zaW1wbGVBbmltYXRpb25zW3RoaXMuYWN0b3IucHJlTWFnaWNBbmltYXRpb25JZF0gIT0gbnVsbCkpIHsKICAgICAgICAgIHRoaXMucHJlTWFnaWNBbmltYXRpb24gPSBuZXcgTG9naWNfU2ltcGxlQW5pbWF0aW9uKFJlY29yZE1hbmFnZXIuc2ltcGxlQW5pbWF0aW9uc1t0aGlzLmFjdG9yLnByZU1hZ2ljQW5pbWF0aW9uSWRdKTsKICAgICAgICB9CiAgICAgICAgaWYgKCh0aGlzLmFjdG9yLnByZUF0dGFja0FuaW1hdGlvbklkICE9IG51bGwpICYmIChSZWNvcmRNYW5hZ2VyLnNpbXBsZUFuaW1hdGlvbnNbdGhpcy5hY3Rvci5wcmVBdHRhY2tBbmltYXRpb25JZF0gIT0gbnVsbCkpIHsKICAgICAgICAgIHRoaXMucHJlQXR0YWNrQW5pbWF0aW9uID0gbmV3IExvZ2ljX1NpbXBsZUFuaW1hdGlvbihSZWNvcmRNYW5hZ2VyLnNpbXBsZUFuaW1hdGlvbnNbdGhpcy5hY3Rvci5wcmVBdHRhY2tBbmltYXRpb25JZF0pOwogICAgICAgIH0KICAgICAgICBpZiAoKHRoaXMuYWN0b3IuZGFtYWdlQW5pbWF0aW9uSWQgIT0gbnVsbCkgJiYgKFJlY29yZE1hbmFnZXIuc2ltcGxlQW5pbWF0aW9uc1t0aGlzLmFjdG9yLmRhbWFnZUFuaW1hdGlvbklkXSAhPSBudWxsKSkgewogICAgICAgICAgdGhpcy5kYW1hZ2VBbmltYXRpb24gPSBuZXcgTG9naWNfU2ltcGxlQW5pbWF0aW9uKFJlY29yZE1hbmFnZXIuc2ltcGxlQW5pbWF0aW9uc1t0aGlzLmFjdG9yLmRhbWFnZUFuaW1hdGlvbklkXSk7CiAgICAgICAgfQogICAgICAgIGlmICgodGhpcy5hY3Rvci5kZWF0aEFuaW1hdGlvbklkICE9IG51bGwpICYmIChSZWNvcmRNYW5hZ2VyLnNpbXBsZUFuaW1hdGlvbnNbdGhpcy5hY3Rvci5kZWF0aEFuaW1hdGlvbklkXSAhPSBudWxsKSkgewogICAgICAgICAgdGhpcy5kZWF0aEFuaW1hdGlvbiA9IG5ldyBMb2dpY19TaW1wbGVBbmltYXRpb24oUmVjb3JkTWFuYWdlci5zaW1wbGVBbmltYXRpb25zW3RoaXMuYWN0b3IuZGVhdGhBbmltYXRpb25JZF0pOwogICAgICAgIH0KICAgICAgICBpZiAoKHRoaXMuYWN0b3IuYmFkU3RhdHVzQW5pbWF0aW9uSWQgIT0gbnVsbCkgJiYgKFJlY29yZE1hbmFnZXIuc2ltcGxlQW5pbWF0aW9uc1t0aGlzLmFjdG9yLmJhZFN0YXR1c0FuaW1hdGlvbklkXSAhPSBudWxsKSkgewogICAgICAgICAgdGhpcy5iYWRTdGF0dXNBbmltYXRpb24gPSBuZXcgTG9naWNfU2ltcGxlQW5pbWF0aW9uKFJlY29yZE1hbmFnZXIuc2ltcGxlQW5pbWF0aW9uc1t0aGlzLmFjdG9yLmJhZFN0YXR1c0FuaW1hdGlvbklkXSk7CiAgICAgICAgfQogICAgICAgIHRoaXMucmVmcmVzaCgpOwogICAgICB9CiAgICB9CgogICAgTG9naWNfQWN0b3IucHJvdG90eXBlLnRvRGF0YUJ1bmRsZSA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgYnVuZGxlOwogICAgICBidW5kbGUgPSB7CiAgICAgICAgYWN0b3JJZDogdGhpcy5hY3RvcklkLAogICAgICAgIG5hbWU6IHRoaXMubmFtZSwKICAgICAgICBsZXZlbDogdGhpcy5sZXZlbCwKICAgICAgICBscDogdGhpcy5scCwKICAgICAgICBtcDogdGhpcy5tcCwKICAgICAgICBza2lsbHM6IHRoaXMuc2tpbGxzLAogICAgICAgIHdlYXBvbklkOiB0aGlzLndlYXBvbiAhPSBudWxsID8gdGhpcy53ZWFwb24uaW5kZXggOiBudWxsLAogICAgICAgIHNoaWVsZElkOiB0aGlzLnNoaWVsZCAhPSBudWxsID8gdGhpcy5zaGllbGQuaW5kZXggOiBudWxsLAogICAgICAgIGhlYWRJZDogdGhpcy5oZWFkICE9IG51bGwgPyB0aGlzLmhlYWQuaW5kZXggOiBudWxsLAogICAgICAgIGJvZHlJZDogdGhpcy5ib2R5ICE9IG51bGwgPyB0aGlzLmJvZHkuaW5kZXggOiBudWxsLAogICAgICAgIGFjY2Vzc29yeUlkOiB0aGlzLmFjY2Vzc29yeSAhPSBudWxsID8gdGhpcy5hY2Nlc3NvcnkuaW5kZXggOiBudWxsCiAgICAgIH07CiAgICAgIHJldHVybiBidW5kbGU7CiAgICB9OwoKICAgIExvZ2ljX0FjdG9yLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpIHt9OwoKICAgIExvZ2ljX0FjdG9yLnByb3RvdHlwZS5lcXVpcHBlZEl0ZW0gPSBmdW5jdGlvbihzbG90KSB7CiAgICAgIHN3aXRjaCAoc2xvdCkgewogICAgICAgIGNhc2UgMDoKICAgICAgICAgIHJldHVybiB0aGlzLndlYXBvbjsKICAgICAgICBjYXNlIDE6CiAgICAgICAgICByZXR1cm4gdGhpcy5zaGllbGQ7CiAgICAgICAgY2FzZSAyOgogICAgICAgICAgcmV0dXJuIHRoaXMuaGVhZEFybW9yOwogICAgICAgIGNhc2UgMzoKICAgICAgICAgIHJldHVybiB0aGlzLmJvZHlBcm1vcjsKICAgICAgICBjYXNlIDQ6CiAgICAgICAgICByZXR1cm4gdGhpcy5hY2Nlc3Nvcnk7CiAgICAgIH0KICAgIH07CgogICAgTG9naWNfQWN0b3IucHJvdG90eXBlLmNoYW5nZUxwID0gZnVuY3Rpb24oaW5jcmVtZW50KSB7CiAgICAgIHJldHVybiB0aGlzLmxwID0gTWF0aC5taW4oTWF0aC5tYXgodGhpcy5scCArIGluY3JlbWVudCwgMCksIHRoaXMubWxwKTsKICAgIH07CgogICAgTG9naWNfQWN0b3IucHJvdG90eXBlLmNoYW5nZU1wID0gZnVuY3Rpb24oaW5jcmVtZW50KSB7CiAgICAgIHJldHVybiB0aGlzLm1wID0gTWF0aC5taW4oTWF0aC5tYXgodGhpcy5tcCArIGluY3JlbWVudCwgMCksIHRoaXMubW1wKTsKICAgIH07CgogICAgTG9naWNfQWN0b3IucHJvdG90eXBlLmNoYW5nZUV4cCA9IGZ1bmN0aW9uKGluY3JlbWVudCkgewogICAgICByZXR1cm4gdGhpcy5leHAgPSBNYXRoLm1pbihNYXRoLm1heCh0aGlzLmV4cCArIGluY3JlbWVudCwgMCksIHRoaXNbImNsYXNzIl0uZXhwQ3VydmUudmFsdWVzW3RoaXMubWF4TGV2ZWwgLSAxXSk7CiAgICB9OwoKICAgIExvZ2ljX0FjdG9yLnByb3RvdHlwZS5jaGFuZ2VMZXZlbCA9IGZ1bmN0aW9uKGluY3JlbWVudCkgewogICAgICByZXR1cm4gdGhpcy5sZXZlbCA9IE1hdGgubWluKE1hdGgubWF4KHRoaXMubGV2ZWwgKyBpbmNyZW1lbnQsIDEpLCB0aGlzLm1heExldmVsKTsKICAgIH07CgogICAgTG9naWNfQWN0b3IucHJvdG90eXBlLnBhcmFtZXRlciA9IGZ1bmN0aW9uKGluZGV4KSB7CiAgICAgIHN3aXRjaCAoaW5kZXgpIHsKICAgICAgICBjYXNlIDA6CiAgICAgICAgICByZXR1cm4gdGhpcy5tbHA7CiAgICAgICAgY2FzZSAxOgogICAgICAgICAgcmV0dXJuIHRoaXMubW1wOwogICAgICAgIGNhc2UgMjoKICAgICAgICAgIHJldHVybiB0aGlzLmF0azsKICAgICAgICBjYXNlIDM6CiAgICAgICAgICByZXR1cm4gdGhpcy5tYXQ7CiAgICAgICAgY2FzZSA0OgogICAgICAgICAgcmV0dXJuIHRoaXMuZGVmOwogICAgICAgIGNhc2UgNToKICAgICAgICAgIHJldHVybiB0aGlzLm1kZjsKICAgICAgICBjYXNlIDY6CiAgICAgICAgICByZXR1cm4gdGhpcy5hZ2k7CiAgICAgICAgY2FzZSA3OgogICAgICAgICAgcmV0dXJuIHRoaXMubHVrOwogICAgICB9CiAgICB9OwoKICAgIExvZ2ljX0FjdG9yLnByb3RvdHlwZS5iYXNlUGFyYW1ldGVyID0gZnVuY3Rpb24oaW5kZXgpIHsKICAgICAgcmV0dXJuIHRoaXMucGFyYW1zW2luZGV4XVt0aGlzLmxldmVsXTsKICAgIH07CgogICAgTG9naWNfQWN0b3IucHJvdG90eXBlLnNldEJhc2VQYXJhbWV0ZXIgPSBmdW5jdGlvbihpbmRleCwgdmFsdWUpIHsKICAgICAgcmV0dXJuIHRoaXMucGFyYW1zW2luZGV4XVt0aGlzLmxldmVsXSA9IHZhbHVlOwogICAgfTsKCiAgICBMb2dpY19BY3Rvci5wcm90b3R5cGUuYmFzZU1scCA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gdGhpcy5iYXNlUGFyYW1ldGVyKDApOwogICAgfTsKCiAgICBMb2dpY19BY3Rvci5wcm90b3R5cGUuYmFzZU1tcCA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gdGhpcy5iYXNlUGFyYW1ldGVyKDEpOwogICAgfTsKCiAgICBMb2dpY19BY3Rvci5wcm90b3R5cGUuYmFzZUF0ayA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gdGhpcy5iYXNlUGFyYW1ldGVyKDIpOwogICAgfTsKCiAgICBMb2dpY19BY3Rvci5wcm90b3R5cGUuYmFzZU1hdCA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gdGhpcy5iYXNlUGFyYW1ldGVyKDQpOwogICAgfTsKCiAgICBMb2dpY19BY3Rvci5wcm90b3R5cGUuYmFzZURlZiA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gdGhpcy5iYXNlUGFyYW1ldGVyKDMpOwogICAgfTsKCiAgICBMb2dpY19BY3Rvci5wcm90b3R5cGUuYmFzZU1kZiA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gdGhpcy5iYXNlUGFyYW1ldGVyKDUpOwogICAgfTsKCiAgICBMb2dpY19BY3Rvci5wcm90b3R5cGUuYmFzZUFnaSA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gdGhpcy5iYXNlUGFyYW1ldGVyKDYpOwogICAgfTsKCiAgICBMb2dpY19BY3Rvci5wcm90b3R5cGUuYmFzZUx1ayA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gdGhpcy5iYXNlUGFyYW1ldGVyKDcpOwogICAgfTsKCiAgICBMb2dpY19BY3Rvci5wcm90b3R5cGUuaGdyID0gZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiB0aGlzLmV4UGFyYW1ldGVyc1syXTsKICAgIH07CgogICAgTG9naWNfQWN0b3IucHJvdG90eXBlLm1nciA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gdGhpcy5leFBhcmFtZXRlcnNbM107CiAgICB9OwoKICAgIExvZ2ljX0FjdG9yLnByb3RvdHlwZS5ldmEgPSBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIHRoaXMuZXhQYXJhbWV0ZXJzWzFdOwogICAgfTsKCiAgICBMb2dpY19BY3Rvci5wcm90b3R5cGUucmVmcmVzaCA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgYnVmZiwgY2xhc3NQcm9wZXJ0aWVzLCBkZWJ1ZmYsIGksIGxlYXJuYWJsZVNraWxsLCBwYXJhbUJ1ZmZzLCBwcm9wZXJ0eSwgc2tpbGwsIHN0YXRlLCB2YWx1ZSwgX2ksIF9qLCBfaywgX2wsIF9sZW4sIF9sZW4xLCBfbGVuMiwgX2xlbjMsIF9sZW40LCBfbSwgX24sIF9yZWYsIF9yZWYxLCBfcmVmMiwgX3JlZjMsIF9yZWY0OwogICAgICBpZiAodGhpc1siY2xhc3MiXSAhPSBudWxsKSB7CiAgICAgICAgdGhpcy5leHBUb05leHRMZXZlbCA9IHRoaXNbImNsYXNzIl0uZXhwQ3VydmUudmFsdWVzW3RoaXMubGV2ZWxdOwogICAgICB9CiAgICAgIHRoaXMuc2tpbGxUeXBlcyA9IFtdOwogICAgICB0aGlzLndlYXBvblR5cGVzID0gW107CiAgICAgIHRoaXMuYXJtb3JUeXBlcyA9IFtdOwogICAgICB0aGlzLmF0dGFja1NraWxsID0gT2JqZWN0LmNvcHkoUmVjb3JkTWFuYWdlci5za2lsbHNbMF0pOwogICAgICB0aGlzLmd1YXJkID0gZmFsc2U7CiAgICAgIHRoaXMuYmFkU3RhdHVzID0gZmFsc2U7CiAgICAgIGlmICh0aGlzWyJjbGFzcyJdICE9IG51bGwpIHsKICAgICAgICB3aGlsZSAodGhpcy5leHAgPj0gdGhpcy5leHBUb05leHRMZXZlbCAmJiB0aGlzLmV4cFRvTmV4dExldmVsID4gMCkgewogICAgICAgICAgdGhpcy5sZXZlbCsrOwogICAgICAgICAgdGhpcy5leHBUb05leHRMZXZlbCA9IHRoaXNbImNsYXNzIl0uZXhwQ3VydmUudmFsdWVzW3RoaXMubGV2ZWwgLSAxXTsKICAgICAgICAgIHRoaXMubHAgPSB0aGlzLmJhc2VNbHAoKTsKICAgICAgICAgIHRoaXMubXAgPSB0aGlzLmJhc2VNbXAoKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgdGhpcy54UGFyYW1ldGVycyA9IFsxMDAsIDEwMCwgMTAwLCAxMDAsIDEwMCwgMTAwLCAxMDBdOwogICAgICB0aGlzLnNQYXJhbWV0ZXJzID0gWzAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDBdOwogICAgICBjbGFzc1Byb3BlcnRpZXMgPSB0aGlzWyJjbGFzcyJdICE9IG51bGwgPyB0aGlzWyJjbGFzcyJdLnByb3BlcnRpZXMgOiBbXTsKICAgICAgdGhpcy5wcm9wZXJ0aWVzID0gY2xhc3NQcm9wZXJ0aWVzLmNvbmNhdCh0aGlzLmJhc2VQcm9wZXJ0aWVzKTsKICAgICAgaWYgKHRoaXMud2VhcG9uICE9IG51bGwpIHsKICAgICAgICB0aGlzLnByb3BlcnRpZXMgPSB0aGlzLnByb3BlcnRpZXMuY29uY2F0KHRoaXMud2VhcG9uLnByb3BlcnRpZXMpOwogICAgICB9CiAgICAgIGlmICh0aGlzLnNoaWVsZCAhPSBudWxsKSB7CiAgICAgICAgdGhpcy5wcm9wZXJ0aWVzID0gdGhpcy5wcm9wZXJ0aWVzLmNvbmNhdCh0aGlzLnNoaWVsZC5wcm9wZXJ0aWVzKTsKICAgICAgfQogICAgICBpZiAodGhpcy5oZWFkICE9IG51bGwpIHsKICAgICAgICB0aGlzLnByb3BlcnRpZXMgPSB0aGlzLnByb3BlcnRpZXMuY29uY2F0KHRoaXMuaGVhZC5wcm9wZXJ0aWVzKTsKICAgICAgfQogICAgICBpZiAodGhpcy5ib2R5ICE9IG51bGwpIHsKICAgICAgICB0aGlzLnByb3BlcnRpZXMgPSB0aGlzLnByb3BlcnRpZXMuY29uY2F0KHRoaXMuYm9keS5wcm9wZXJ0aWVzKTsKICAgICAgfQogICAgICBpZiAodGhpcy5hY2Nlc3NvcnkgIT0gbnVsbCkgewogICAgICAgIHRoaXMucHJvcGVydGllcyA9IHRoaXMucHJvcGVydGllcy5jb25jYXQodGhpcy5hY2Nlc3NvcnkucHJvcGVydGllcyk7CiAgICAgIH0KICAgICAgaWYgKHRoaXNbImNsYXNzIl0gIT0gbnVsbCkgewogICAgICAgIHRoaXMucHJvcGVydGllcyA9IHRoaXMucHJvcGVydGllcy5jb25jYXQodGhpc1siY2xhc3MiXS5wcm9wZXJ0aWVzKTsKICAgICAgfQogICAgICBfcmVmID0gdGhpcy5zdGF0ZXM7CiAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gX3JlZi5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykgewogICAgICAgIHN0YXRlID0gX3JlZltfaV07CiAgICAgICAgdGhpcy5wcm9wZXJ0aWVzID0gdGhpcy5wcm9wZXJ0aWVzLmNvbmNhdChzdGF0ZS5wcm9wZXJ0aWVzKTsKICAgICAgICBpZiAoc3RhdGUuYmFkU3RhdHVzKSB7CiAgICAgICAgICB0aGlzLmJhZFN0YXR1cyA9IHRydWU7CiAgICAgICAgfQogICAgICB9CiAgICAgIHBhcmFtQnVmZnMgPSBbMCwgMCwgMCwgMCwgMCwgMCwgMCwgMF07CiAgICAgIF9yZWYxID0gdGhpcy5wcm9wZXJ0aWVzOwogICAgICBmb3IgKF9qID0gMCwgX2xlbjEgPSBfcmVmMS5sZW5ndGg7IF9qIDwgX2xlbjE7IF9qKyspIHsKICAgICAgICBwcm9wZXJ0eSA9IF9yZWYxW19qXTsKICAgICAgICBzd2l0Y2ggKHByb3BlcnR5LmNvZGUpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgaWYgKHRoaXMuZWxlbWVudFJhdGVzW3Byb3BlcnR5LmlkXSA9PSBudWxsKSB7CiAgICAgICAgICAgICAgdGhpcy5lbGVtZW50UmF0ZXNbcHJvcGVydHkuaWRdID0gMTAwOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXMuZWxlbWVudFJhdGVzW3Byb3BlcnR5LmlkXSAqPSBwcm9wZXJ0eS52YWx1ZSAvIDEwMDsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgIHRoaXMuZGVidWZmc1twcm9wZXJ0eS5pZF0ucHVzaChwcm9wZXJ0eS52YWx1ZSk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICBwYXJhbUJ1ZmZzW3Byb3BlcnR5LmlkXSArPSBNYXRoLmZsb29yKHRoaXMuYmFzZVBhcmFtZXRlcihwcm9wZXJ0eS5pZCkgKiAocHJvcGVydHkudmFsdWUgLyAxMDApKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgIHRoaXMuc1BhcmFtZXRlcnNbcHJvcGVydHkuaWRdICs9IHByb3BlcnR5LnZhbHVlOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgdGhpcy54UGFyYW1ldGVyc1twcm9wZXJ0eS5pZF0gKj0gcHJvcGVydHkudmFsdWUgLyAxMDA7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgdGhpcy5za2lsbFR5cGVzW3Byb3BlcnR5LmlkXSA9IFJlY29yZE1hbmFnZXIuc2tpbGxUeXBlc1twcm9wZXJ0eS5pZF07CiAgICAgICAgICAgIGlmICh0aGlzLnNraWxsc1twcm9wZXJ0eS5pZF0gPT0gbnVsbCkgewogICAgICAgICAgICAgIHRoaXMuc2tpbGxzW3Byb3BlcnR5LmlkXSA9IFtdOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAxMjoKICAgICAgICAgICAgdGhpcy5za2lsbFR5cGVzW3Byb3BlcnR5LmlkXSA9IG51bGw7CiAgICAgICAgICAgIHRoaXMuc2tpbGxzW3Byb3BlcnR5LmlkXSA9IFtdOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgMTM6CiAgICAgICAgICAgIHNraWxsID0gUmVjb3JkTWFuYWdlci5za2lsbHNbcHJvcGVydHkuaWRdOwogICAgICAgICAgICBpZiAodGhpcy5za2lsbHNbc2tpbGwuc2tpbGxUeXBlXSAhPSBudWxsKSB7CiAgICAgICAgICAgICAgdGhpcy5za2lsbHNbc2tpbGwuc2tpbGxUeXBlXVtza2lsbC5pbmRleF0gPSBza2lsbDsKICAgICAgICAgICAgfQogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgMTQ6CiAgICAgICAgICAgIHNraWxsID0gUmVjb3JkTWFuYWdlci5za2lsbHNbcHJvcGVydHkuaWRdOwogICAgICAgICAgICBpZiAodGhpcy5za2lsbHNbc2tpbGwuc2tpbGxUeXBlXSAhPSBudWxsKSB7CiAgICAgICAgICAgICAgdGhpcy5za2lsbHNbc2tpbGwuc2tpbGxUeXBlXVtza2lsbC5pbmRleF0gPSBudWxsOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAxNToKICAgICAgICAgICAgdGhpcy53ZWFwb25UeXBlc1twcm9wZXJ0eS5pZF0gPSBSZWNvcmRNYW5hZ2VyLndlYXBvblR5cGVzW3Byb3BlcnR5LmlkXTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlIDE2OgogICAgICAgICAgICB0aGlzLmFybW9yVHlwZXNbcHJvcGVydHkuaWRdID0gUmVjb3JkTWFuYWdlci5hcm1vclR5cGVzW3Byb3BlcnR5LmlkXTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlIDE3OgogICAgICAgICAgICB0aGlzLmVxdWlwbWVudFNsb3RzW3Byb3BlcnR5LmlkXS5maXhlZCA9IHRydWU7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAxODoKICAgICAgICAgICAgdGhpcy5lcXVpcG1lbnRTbG90c1twcm9wZXJ0eS5pZF0uc2VhbGVkID0gdHJ1ZTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlIDE5OgogICAgICAgICAgICB0aGlzLnNsb3RUeXBlID0gcHJvcGVydHkuaWQ7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAyMDoKICAgICAgICAgICAgdGhpcy5hY3Rpb25UaW1lICs9IHByb3BlcnR5LnZhbHVlOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgMjE6CiAgICAgICAgICAgIHN3aXRjaCAocHJvcGVydHkuaWQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICB0aGlzLmF1dG9CYXR0bGUgPSB0cnVlOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgICAgdGhpcy5ndWFyZCA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlIDIyOgogICAgICAgICAgICB0aGlzLmF0dGFja1NraWxsID0gUmVjb3JkTWFuYWdlci5za2lsbHNbcHJvcGVydHkuaWRdIHx8IFJlY29yZE1hbmFnZXIuc2tpbGxzWzBdOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgMjM6CiAgICAgICAgICAgIHRoaXMuYXR0YWNrU2tpbGwuZGFtYWdlLmVsZW1lbnRJZCA9IFJlY29yZE1hbmFnZXIuZWxlbWVudHNbcHJvcGVydHkuaWRdIHx8IFJlY29yZE1hbmFnZXIuZWxlbWVudHNbMF07CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAyNDoKICAgICAgICAgICAgdGhpcy5hdHRhY2tTa2lsbC5lZmZlY3RzLnB1c2goewogICAgICAgICAgICAgIGNvZGU6IDQsCiAgICAgICAgICAgICAgaWQ6IHByb3BlcnR5LmlkLAogICAgICAgICAgICAgIHZhbHVlMTogcHJvcGVydHkudmFsdWUKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAyNToKICAgICAgICAgICAgdGhpcy5hdHRhY2tTa2lsbC5zcGVlZCA9IHByb3BlcnR5LnZhbHVlOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgMjY6CiAgICAgICAgICAgIHRoaXMuYXR0YWNrU2tpbGwucmVwZWF0cyA9IHByb3BlcnR5LnZhbHVlOwogICAgICAgIH0KICAgICAgfQogICAgICBmb3IgKGkgPSBfayA9IDA7IF9rIDwgODsgaSA9ICsrX2spIHsKICAgICAgICB2YWx1ZSA9IHBhcmFtQnVmZnNbaV0gKyB0aGlzLmJhc2VQYXJhbWV0ZXIoaSk7CiAgICAgICAgaWYgKHRoaXMud2VhcG9uICE9IG51bGwpIHsKICAgICAgICAgIHZhbHVlID0gdmFsdWUgKyB0aGlzLndlYXBvbi5wYXJhbXNbaV07CiAgICAgICAgfQogICAgICAgIGlmICh0aGlzLnNoaWVsZCAhPSBudWxsKSB7CiAgICAgICAgICB2YWx1ZSA9IHZhbHVlICsgdGhpcy5zaGllbGQucGFyYW1zW2ldOwogICAgICAgIH0KICAgICAgICBpZiAodGhpcy5oZWFkICE9IG51bGwpIHsKICAgICAgICAgIHZhbHVlID0gdmFsdWUgKyB0aGlzLmhlYWQucGFyYW1zW2ldOwogICAgICAgIH0KICAgICAgICBpZiAodGhpcy5ib2R5ICE9IG51bGwpIHsKICAgICAgICAgIHZhbHVlID0gdmFsdWUgKyB0aGlzLmJvZHkucGFyYW1zW2ldOwogICAgICAgIH0KICAgICAgICBpZiAodGhpcy5hY2Nlc3NvcnkgIT0gbnVsbCkgewogICAgICAgICAgdmFsdWUgPSB2YWx1ZSArIHRoaXMuYWNjZXNzb3J5LnBhcmFtc1tpXTsKICAgICAgICB9CiAgICAgICAgX3JlZjIgPSB0aGlzLmJ1ZmZzW2ldOwogICAgICAgIGZvciAoX2wgPSAwLCBfbGVuMiA9IF9yZWYyLmxlbmd0aDsgX2wgPCBfbGVuMjsgX2wrKykgewogICAgICAgICAgYnVmZiA9IF9yZWYyW19sXTsKICAgICAgICAgIHZhbHVlID0gdmFsdWUgKyB2YWx1ZSAqIChidWZmLnZhbHVlIC8gMTAwKTsKICAgICAgICB9CiAgICAgICAgX3JlZjMgPSB0aGlzLmRlYnVmZnNbaV07CiAgICAgICAgZm9yIChfbSA9IDAsIF9sZW4zID0gX3JlZjMubGVuZ3RoOyBfbSA8IF9sZW4zOyBfbSsrKSB7CiAgICAgICAgICBkZWJ1ZmYgPSBfcmVmM1tfbV07CiAgICAgICAgICB2YWx1ZSA9IHZhbHVlIC0gdmFsdWUgKiAoZGVidWZmLnZhbHVlIC8gMTAwKTsKICAgICAgICB9CiAgICAgICAgc3dpdGNoIChpKSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIHRoaXMubWxwID0gTWF0aC5tYXgodmFsdWUsIDEpOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgdGhpcy5tbXAgPSBNYXRoLm1heCh2YWx1ZSwgMSk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICB0aGlzLmF0ayA9IE1hdGgubWF4KHZhbHVlLCAxKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgIHRoaXMuZGVmID0gTWF0aC5tYXgodmFsdWUsIDEpOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgdGhpcy5tYXQgPSBNYXRoLm1heCh2YWx1ZSwgMSk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICB0aGlzLm1kZiA9IE1hdGgubWF4KHZhbHVlLCAxKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgIHRoaXMuYWdpID0gTWF0aC5tYXgodmFsdWUsIDEpOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgdGhpcy5sdWsgPSBNYXRoLm1heCh2YWx1ZSwgMSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHRoaXMubHAgPSBNYXRoLm1pbih0aGlzLmxwLCB0aGlzLm1scCk7CiAgICAgIHRoaXMubXAgPSBNYXRoLm1pbih0aGlzLm1wLCB0aGlzLm1tcCk7CiAgICAgIGlmICh0aGlzWyJjbGFzcyJdICE9IG51bGwpIHsKICAgICAgICBfcmVmNCA9IHRoaXNbImNsYXNzIl0ubGVhcm5hYmxlU2tpbGxzOwogICAgICAgIGZvciAoX24gPSAwLCBfbGVuNCA9IF9yZWY0Lmxlbmd0aDsgX24gPCBfbGVuNDsgX24rKykgewogICAgICAgICAgbGVhcm5hYmxlU2tpbGwgPSBfcmVmNFtfbl07CiAgICAgICAgICBpZiAodGhpcy5sZXZlbCA+PSBsZWFybmFibGVTa2lsbC5sZXZlbCkgewogICAgICAgICAgICBza2lsbCA9IFJlY29yZE1hbmFnZXIuc2tpbGxzW2xlYXJuYWJsZVNraWxsLnNraWxsSWRdOwogICAgICAgICAgICBpZiAodGhpcy5za2lsbHNbc2tpbGwuc2tpbGxUeXBlXSAhPSBudWxsKSB7CiAgICAgICAgICAgICAgdGhpcy5za2lsbHNbc2tpbGwuc2tpbGxUeXBlXVtza2lsbC5pbmRleF0gPSBza2lsbDsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICB0aGlzLmhpdFJhdGUgPSB0aGlzLnhQYXJhbWV0ZXJzWzBdOwogICAgICB0aGlzLmRlZmVuc2VSYXRlID0gdGhpcy54UGFyYW1ldGVyc1sxXTsKICAgICAgdGhpcy5ldmFzaW9uUmF0ZSA9IHRoaXMuc1BhcmFtZXRlcnNbMV07CiAgICAgIHRoaXMuY3JpdGljYWxIaXRSYXRlID0gdGhpcy5zUGFyYW1ldGVyc1syXTsKICAgICAgdGhpcy5jcml0aWNhbEV2YXNpb25SYXRlID0gdGhpcy5zUGFyYW1ldGVyc1szXTsKICAgICAgdGhpcy5tYWdpY0V2YXNpb25SYXRlID0gdGhpcy5zUGFyYW1ldGVyc1s0XTsKICAgICAgdGhpcy5tYWdpY1JlZmxlY3Rpb25SYXRlID0gdGhpcy5zUGFyYW1ldGVyc1s1XTsKICAgICAgdGhpcy5jb3VudGVyUmF0ZSA9IHRoaXMuc1BhcmFtZXRlcnNbNl07CiAgICAgIHRoaXMubHBSZWdlbmVyYXRpb25SYXRlID0gdGhpcy5zUGFyYW1ldGVyc1s3XTsKICAgICAgdGhpcy5tcFJlZ2VuZXJhdGlvblJhdGUgPSB0aGlzLnNQYXJhbWV0ZXJzWzhdOwogICAgICByZXR1cm4gdGhpcy5jaGVja0ZvckRlYXRoKCk7CiAgICB9OwoKICAgIExvZ2ljX0FjdG9yLnByb3RvdHlwZS5sZXZlbFVwID0gZnVuY3Rpb24obGV2ZWwpIHsKICAgICAgdGhpcy5sZXZlbCA9IGxldmVsOwogICAgICByZXR1cm4gdGhpcy5leHAgPSB0aGlzWyJjbGFzcyJdLmV4cEN1cnZlLnZhbHVlc1t0aGlzLmxldmVsIC0gMV07CiAgICB9OwoKICAgIExvZ2ljX0FjdG9yLnByb3RvdHlwZS5jaGVja1N0YXRlcyA9IGZ1bmN0aW9uKGFjdGlvbkVuZCwgdHVybkVuZCwgYmF0dGxlRW5kLCB0dXJucywgc3RlcHMsIGRhbWFnZSkgewogICAgICB2YXIgZHVyYXRpb24sIGksIHJlbW92ZSwgcmVtb3ZlZFN0YXRlcywgc3RhdGU7CiAgICAgIGkgPSAwOwogICAgICByZW1vdmVkU3RhdGVzID0gW107CiAgICAgIHdoaWxlIChpIDwgdGhpcy5zdGF0ZXMubGVuZ3RoKSB7CiAgICAgICAgc3RhdGUgPSB0aGlzLnN0YXRlc1tpXTsKICAgICAgICByZW1vdmUgPSBmYWxzZTsKICAgICAgICBzd2l0Y2ggKHN0YXRlLmF1dG9SZW1vdmUpIHsKICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgcmVtb3ZlID0gYWN0aW9uRW5kOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgcmVtb3ZlID0gdHVybkVuZDsKICAgICAgICB9CiAgICAgICAgaWYgKCFyZW1vdmUgJiYgIShzdGF0ZS5taW5EdXJhdGlvbiA9PT0gMCkpIHsKICAgICAgICAgIGR1cmF0aW9uID0gc3RhdGUubWluRHVyYXRpb24gKyBNYXRoLnJvdW5kKE1hdGgucmFuZG9tKCkgKiBNYXRoLm1heCgwLCBzdGF0ZS5tYXhEdXJhdGlvbiAtIHN0YXRlLm1pbkR1cmF0aW9uKSk7CiAgICAgICAgICByZW1vdmUgPSAodHVybnMgLSBzdGF0ZS50dXJuQWRkZWQpID49IGR1cmF0aW9uOwogICAgICAgIH0KICAgICAgICBpZiAoIXJlbW92ZSAmJiBzdGF0ZS5yZW1vdmVCeVdhbGtpbmcpIHsKICAgICAgICAgIHJlbW92ZSA9IChzdGVwcyAtIChzdGF0ZS5zdGVwcyB8fCAwKSkgPj0gc3RhdGUucmVtb3ZlQnlXYWxraW5nVmFsdWU7CiAgICAgICAgfQogICAgICAgIGlmICghcmVtb3ZlICYmIHN0YXRlLnJlbW92ZUJ5RGFtYWdlKSB7CiAgICAgICAgICByZW1vdmUgPSBkYW1hZ2UgPj0gc3RhdGUucmVtb3ZlQnlEYW1hZ2VWYWx1ZTsKICAgICAgICB9CiAgICAgICAgaWYgKCFyZW1vdmUgJiYgc3RhdGUucmVtb3ZlQXRCYXR0bGVFbmQpIHsKICAgICAgICAgIHJlbW92ZSA9IGJhdHRsZUVuZDsKICAgICAgICB9CiAgICAgICAgaWYgKHJlbW92ZSkgewogICAgICAgICAgdGhpcy5zdGF0ZXMuc3BsaWNlKGksIDEpOwogICAgICAgICAgcmVtb3ZlZFN0YXRlcy5wdXNoKHN0YXRlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaSsrOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gcmVtb3ZlZFN0YXRlczsKICAgIH07CgogICAgTG9naWNfQWN0b3IucHJvdG90eXBlLmNoZWNrU3RhdGVSZXNpc3RhbmNlID0gZnVuY3Rpb24oc3RhdGUpIHsKICAgICAgdmFyIHByb3BlcnR5LCByZXN1bHQsIF9pLCBfbGVuLCBfcmVmOwogICAgICByZXN1bHQgPSBmYWxzZTsKICAgICAgX3JlZiA9IHRoaXMucHJvcGVydGllczsKICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBfcmVmLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7CiAgICAgICAgcHJvcGVydHkgPSBfcmVmW19pXTsKICAgICAgICBpZiAocHJvcGVydHkuY29kZSA9PT0gMyAmJiBwcm9wZXJ0eS5pZCA9PT0gc3RhdGUuaW5kZXgpIHsKICAgICAgICAgIHJlc3VsdCA9IHRydWU7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH07CgogICAgTG9naWNfQWN0b3IucHJvdG90eXBlLmFkZFNraWxsID0gZnVuY3Rpb24oc2tpbGwpIHsKICAgICAgaWYgKHRoaXMuc2tpbGxUeXBlc1tza2lsbC5za2lsbFR5cGVdICE9IG51bGwpIHsKICAgICAgICByZXR1cm4gdGhpcy5za2lsbHNbc2tpbGwuc2tpbGxUeXBlXVtza2lsbC5pbmRleF0gPSBza2lsbDsKICAgICAgfQogICAgfTsKCiAgICBMb2dpY19BY3Rvci5wcm90b3R5cGUucmVtb3ZlU2tpbGwgPSBmdW5jdGlvbihza2lsbCkgewogICAgICBpZiAodGhpcy5za2lsbFR5cGVzW3NraWxsLnNraWxsVHlwZV0gIT0gbnVsbCkgewogICAgICAgIHJldHVybiB0aGlzLnNraWxsc1tza2lsbC5za2lsbFR5cGVdW3NraWxsLmluZGV4XSA9IG51bGw7CiAgICAgIH0KICAgIH07CgogICAgTG9naWNfQWN0b3IucHJvdG90eXBlLmFkZFN0YXRlID0gZnVuY3Rpb24oc3RhdGUpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgaWYgKChzdGF0ZSAhPSBudWxsKSAmJiB0aGlzLnN0YXRlcy5pbmRleE9mKHN0YXRlKSA9PT0gLTEpIHsKICAgICAgICBzdGF0ZS5zdGVwcyA9IEdhbWVNYW5hZ2VyLnBsYXllci5zdGVwczsKICAgICAgICBpZiAoU2NlbmVNYW5hZ2VyLnNjZW5lLnR1cm4gIT0gbnVsbCkgewogICAgICAgICAgc3RhdGUudHVybkFkZGVkID0gU2NlbmVNYW5hZ2VyLnNjZW5lLnR1cm47CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHN0YXRlLnR1cm5BZGRlZCA9IDA7CiAgICAgICAgfQogICAgICAgIHRoaXMuc3RhdGVzLnB1c2goc3RhdGUpOwogICAgICAgIHJldHVybiB0aGlzLnN0YXRlcy5zb3J0KGZ1bmN0aW9uKGEsIGIpIHsKICAgICAgICAgIGlmIChhLnByaW9yaXR5ID4gYi5wcmlvcml0eSkgewogICAgICAgICAgICByZXR1cm4gMTsKICAgICAgICAgIH0gZWxzZSBpZiAoYS5wcmlvcml0eSA8IGIucHJpb3JpdHkpIHsKICAgICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH07CgogICAgTG9naWNfQWN0b3IucHJvdG90eXBlLmhhc1N0YXRlID0gZnVuY3Rpb24oc3RhdGUpIHsKICAgICAgcmV0dXJuIHRoaXMuc3RhdGVzLmluZGV4T2Yoc3RhdGUpICE9PSAtMTsKICAgIH07CgogICAgTG9naWNfQWN0b3IucHJvdG90eXBlLnJlbW92ZVN0YXRlID0gZnVuY3Rpb24oc3RhdGUpIHsKICAgICAgcmV0dXJuIHRoaXMuc3RhdGVzLnJlbW92ZShzdGF0ZSk7CiAgICB9OwoKICAgIExvZ2ljX0FjdG9yLnByb3RvdHlwZS5oYXNTdGF0ZSA9IGZ1bmN0aW9uKHN0YXRlKSB7CiAgICAgIHJldHVybiB0aGlzLnN0YXRlcy5pbmRleE9mKHN0YXRlKSAhPT0gLTE7CiAgICB9OwoKICAgIExvZ2ljX0FjdG9yLnByb3RvdHlwZS5hZGRCdWZmID0gZnVuY3Rpb24ocGFyYW0sIHR1cm5zLCB2YWx1ZSkgewogICAgICByZXR1cm4gdGhpcy5idWZmc1twYXJhbV0ucHVzaCh7CiAgICAgICAgdHVybnM6IHR1cm5zLAogICAgICAgIHZhbHVlOiB2YWx1ZQogICAgICB9KTsKICAgIH07CgogICAgTG9naWNfQWN0b3IucHJvdG90eXBlLmFkZERlYnVmZiA9IGZ1bmN0aW9uKHBhcmFtLCB0dXJucywgdmFsdWUpIHsKICAgICAgcmV0dXJuIHRoaXMuZGVidWZmc1twYXJhbV0ucHVzaCh7CiAgICAgICAgdHVybnM6IHR1cm5zLAogICAgICAgIHZhbHVlOiB2YWx1ZQogICAgICB9KTsKICAgIH07CgogICAgTG9naWNfQWN0b3IucHJvdG90eXBlLnJlbW92ZUJ1ZmYgPSBmdW5jdGlvbihwYXJhbSkgewogICAgICByZXR1cm4gdGhpcy5idWZmc1twYXJhbV0gPSBbXTsKICAgIH07CgogICAgTG9naWNfQWN0b3IucHJvdG90eXBlLnJlbW92ZURlYnVmZiA9IGZ1bmN0aW9uKHBhcmFtKSB7CiAgICAgIHJldHVybiB0aGlzLmRlYnVmZnNbcGFyYW1dID0gW107CiAgICB9OwoKICAgIExvZ2ljX0FjdG9yLnByb3RvdHlwZS5hcHBseUVmZmVjdCA9IGZ1bmN0aW9uKGVmZmVjdCkgewogICAgICB2YXIgY29tbW9uRXZlbnQsIGV2ZW50SWQsIGksIGlkLCBpbmZvLCBscCwgbXAsIHNraWxsLCBzdGF0ZSwgc3VjY2VzcywgdmFsdWUsIF9pLCBfcmVmOwogICAgICBpbmZvID0gbnVsbDsKICAgICAgdmFsdWUgPSBlZmZlY3QudmFsdWUxOwogICAgICBzdWNjZXNzID0gdHJ1ZTsKICAgICAgaWQgPSBlZmZlY3QuaWQ7CiAgICAgIHN3aXRjaCAoZWZmZWN0LmNvZGUpIHsKICAgICAgICBjYXNlIDA6CiAgICAgICAgICBscCA9IHRoaXMubHA7CiAgICAgICAgICB0aGlzLmNoYW5nZUxwKHRoaXMubWxwICogKGVmZmVjdC52YWx1ZTEgLyAxMDApKTsKICAgICAgICAgIHRoaXMuY2hhbmdlTHAoZWZmZWN0LnZhbHVlMik7CiAgICAgICAgICB2YWx1ZSA9IHRoaXMubHAgLSBscDsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgMToKICAgICAgICAgIG1wID0gdGhpcy5tcDsKICAgICAgICAgIHRoaXMuY2hhbmdlTXAodGhpcy5tbXAgKiAoZWZmZWN0LnZhbHVlMSAvIDEwMCkpOwogICAgICAgICAgdGhpcy5jaGFuZ2VNcChlZmZlY3QudmFsdWUyKTsKICAgICAgICAgIHZhbHVlID0gdGhpcy5tcCAtIGxwOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAzOgogICAgICAgICAgc3RhdGUgPSBSZWNvcmRNYW5hZ2VyLnN0YXRlc1tlZmZlY3QuaWRdOwogICAgICAgICAgaWYgKCF0aGlzLmNoZWNrU3RhdGVSZXNpc3RhbmNlKHN0YXRlKSAmJiAhdGhpcy5oYXNTdGF0ZShzdGF0ZSkgJiYgTWF0aC5yYW5kb20oKSAqIDEwMCA8IGVmZmVjdC52YWx1ZTEpIHsKICAgICAgICAgICAgdGhpcy5hZGRTdGF0ZShzdGF0ZSk7CiAgICAgICAgICAgIHZhbHVlID0gc3RhdGU7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBzdWNjZXNzID0gZmFsc2U7CiAgICAgICAgICB9CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDQ6CiAgICAgICAgICBpZiAoTWF0aC5yYW5kb20oKSAqIDEwMCA8IGVmZmVjdC52YWx1ZTEpIHsKICAgICAgICAgICAgdGhpcy5yZW1vdmVTdGF0ZShSZWNvcmRNYW5hZ2VyLnN0YXRlc1tlZmZlY3QuaWRdKTsKICAgICAgICAgICAgdmFsdWUgPSBSZWNvcmRNYW5hZ2VyLnN0YXRlc1tlZmZlY3QuaWRdOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc3VjY2VzcyA9IGZhbHNlOwogICAgICAgICAgfQogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSA1OgogICAgICAgICAgdGhpcy5hZGRCdWZmKGVmZmVjdC5pZCwgZWZmZWN0LnZhbHVlMiwgZWZmZWN0LnZhbHVlMSk7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDY6CiAgICAgICAgICB0aGlzLmFkZERlYnVmZihlZmZlY3QuaWQsIGVmZmVjdC52YWx1ZTIsIGVmZmVjdC52YWx1ZTEpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSA3OgogICAgICAgICAgdGhpcy5yZW1vdmVCdWZmKGVmZmVjdC5pZCk7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDg6CiAgICAgICAgICB0aGlzLnJlbW92ZURlYnVmZihlZmZlY3QuaWQpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSA5OgogICAgICAgICAgaWYgKEdhbWVNYW5hZ2VyLnNjZW5lIGluc3RhbmNlb2YgU2NlbmVfQmF0dGxlKSB7CiAgICAgICAgICAgIEdhbWVNYW5hZ2VyLnNjZW5lLmVzY2FwZSgpOwogICAgICAgICAgfQogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAxMDoKICAgICAgICAgIHNraWxsID0gUmVjb3JkTWFuYWdlci5za2lsbHNbZWZmZWN0LmlkXTsKICAgICAgICAgIGlmICh0aGlzLnNraWxsc1tza2lsbC5za2lsbFR5cGVdICE9IG51bGwpIHsKICAgICAgICAgICAgdGhpcy5za2lsbHNbc2tpbGwuc2tpbGxUeXBlXVtlZmZlY3QuaWRdID0gc2tpbGw7CiAgICAgICAgICB9CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDExOgogICAgICAgICAgZXZlbnRJZCA9IGVmZmVjdC5pZDsKICAgICAgICAgIGNvbW1vbkV2ZW50ID0gR2FtZU1hbmFnZXIuY29tbW9uRXZlbnRzW2V2ZW50SWRdOwogICAgICAgICAgaWYgKGNvbW1vbkV2ZW50ICE9IG51bGwpIHsKICAgICAgICAgICAgY29tbW9uRXZlbnQuc3RhcnQoZWZmZWN0LnBhcmFtZXRlcnMgfHwgW10pOwogICAgICAgICAgfQogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAxMjoKICAgICAgICAgIGZvciAoaSA9IF9pID0gMCwgX3JlZiA9IHRoaXMubWF4TGV2ZWw7IDAgPD0gX3JlZiA/IF9pIDwgX3JlZiA6IF9pID4gX3JlZjsgaSA9IDAgPD0gX3JlZiA/ICsrX2kgOiAtLV9pKSB7CiAgICAgICAgICAgIHRoaXMucGFyYW1zW2VmZmVjdC5pZF1baV0gKz0gZWZmZWN0LnZhbHVlMTsKICAgICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gewogICAgICAgIGNvZGU6IGVmZmVjdC5jb2RlLAogICAgICAgIHZhbHVlOiB2YWx1ZSwKICAgICAgICBpZDogaWQsCiAgICAgICAgc3VjY2Vzczogc3VjY2VzcwogICAgICB9OwogICAgfTsKCiAgICBMb2dpY19BY3Rvci5wcm90b3R5cGUuYXBwbHlFeFBhcmFtZXRlcnMgPSBmdW5jdGlvbigpIHsKICAgICAgdGhpcy5scCA9IE1hdGgubWF4KHRoaXMubHAgKyBNYXRoLmZsb29yKHRoaXMubWxwICogKHRoaXMubHBSZWdlbmVyYXRpb25SYXRlIC8gMTAwKSksIDApOwogICAgICByZXR1cm4gdGhpcy5tcCA9IE1hdGgubWF4KHRoaXMubXAgKyBNYXRoLmZsb29yKHRoaXMubW1wICogKHRoaXMubXBSZWdlbmVyYXRpb25SYXRlIC8gMTAwKSksIDApOwogICAgfTsKCiAgICBMb2dpY19BY3Rvci5wcm90b3R5cGUuYXR0YWNrID0gZnVuY3Rpb24odGFyZ2V0KSB7CiAgICAgIHJldHVybiB0YXJnZXQubHAgPSBNYXRoLmZsb29yKE1hdGgubWF4KHRhcmdldC5scCAtIE1hdGgubWF4KHRoaXMuYXRrIC0gdGFyZ2V0LmRlZiAqIDAuNSwgMCksIDApKTsKICAgIH07CgogICAgTG9naWNfQWN0b3IucHJvdG90eXBlLnVzZVNraWxsID0gZnVuY3Rpb24oc2tpbGwsIHRhcmdldCkgewogICAgICByZXR1cm4gdGhpcy51c2VJdGVtKHNraWxsLCB0YXJnZXQpOwogICAgfTsKCiAgICBMb2dpY19BY3Rvci5wcm90b3R5cGUudGFrZURhbWFnZSA9IGZ1bmN0aW9uKGRhbWFnZSwgYSwgYiwgY3JpdGljYWwpIHsKICAgICAgdmFyIGVsZW1lbnRSYXRlLCBtaW4sIHZhbHVlOwogICAgICBpZiAoZGFtYWdlLnR5cGUgPT09IDApIHsKICAgICAgICByZXR1cm4gMDsKICAgICAgfQogICAgICB2YWx1ZSA9IDA7CiAgICAgIGIgPSBiIHx8IHRoaXM7CiAgICAgIGlmIChkYW1hZ2UucGVyY2VudGFnZSAhPSBudWxsKSB7CiAgICAgICAgc3dpdGNoIChkYW1hZ2UudHlwZSkgewogICAgICAgICAgY2FzZSAxIHx8IDM6CiAgICAgICAgICAgIHZhbHVlID0gTWF0aC5tYXgodGhpcy5tbHAgLyAxMDAgKiBkYW1hZ2UucGVyY2VudGFnZSwgMCkgKyBkYW1hZ2UudmFsdWU7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAyIHx8IDQ6CiAgICAgICAgICAgIHZhbHVlID0gTWF0aC5tYXgodGhpcy5tbXAgLyAxMDAgKiBkYW1hZ2UucGVyY2VudGFnZSwgMCkgKyBkYW1hZ2UudmFsdWU7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKGRhbWFnZS5mb3JtdWxhLnRyaW0oKSAhPT0gIiIpIHsKICAgICAgICB2YWx1ZSA9IGV2YWwoZGFtYWdlLmZvcm11bGEpOwogICAgICB9CiAgICAgIG1pbiA9IGRhbWFnZS52YXJpYW5jZSAvIDEwMCAqIHZhbHVlOwogICAgICBtaW4gPSAoMSArIE1hdGgucmFuZG9tKCkgKiBtaW4pICsgKDEgKyBNYXRoLnJhbmRvbSgpICogbWluKSAtIG1pbjsKICAgICAgdmFsdWUgPSBNYXRoLmZsb29yKHZhbHVlID49IDAgPyB2YWx1ZSArIG1pbiA6IHZhbHVlIC0gbWluKTsKICAgICAgZWxlbWVudFJhdGUgPSAoYi5lbGVtZW50UmF0ZXNbZGFtYWdlLmVsZW1lbnRJZF0gfHwgMTAwKSAvIDEwMDsKICAgICAgdmFsdWUgKj0gZWxlbWVudFJhdGU7CiAgICAgIGlmIChkYW1hZ2UuY3JpdGljYWwgJiYgY3JpdGljYWwpIHsKICAgICAgICB2YWx1ZSAqPSAzOwogICAgICB9CiAgICAgIGlmICh0aGlzLmd1YXJkKSB7CiAgICAgICAgdmFsdWUgPSB2YWx1ZSAqICgxMDAgLyB0aGlzLmRlZmVuc2VSYXRlKTsKICAgICAgfQogICAgICBzd2l0Y2ggKGRhbWFnZS50eXBlKSB7CiAgICAgICAgY2FzZSAxOgogICAgICAgICAgdGhpcy5scCA9IE1hdGgubWluKE1hdGgubWF4KHRoaXMubHAgLSBNYXRoLm1heCh2YWx1ZSwgMCksIDApLCB0aGlzLm1scCk7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDI6CiAgICAgICAgICB0aGlzLm1wID0gTWF0aC5taW4oTWF0aC5tYXgodGhpcy5tcCAtIE1hdGgubWF4KHZhbHVlLCAwKSwgMCksIHRoaXMubW1wKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgMzoKICAgICAgICAgIHRoaXMubHAgPSBNYXRoLm1heChNYXRoLm1pbih0aGlzLmxwICsgTWF0aC5tYXgodmFsdWUsIDApLCB0aGlzLm1scCksIDApOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSA0OgogICAgICAgICAgdGhpcy5tcCA9IE1hdGgubWF4KE1hdGgubWluKHRoaXMubXAgKyBNYXRoLm1heCh2YWx1ZSwgMCksIHRoaXMubW1wKSwgMCk7CiAgICAgIH0KICAgICAgdGhpcy5jaGVja1N0YXRlcyhmYWxzZSwgZmFsc2UsIGZhbHNlLCAwLCAwLCBNYXRoLmZsb29yKHZhbHVlKSk7CiAgICAgIHRoaXMuY2hlY2tGb3JEZWF0aCgpOwogICAgICByZXR1cm4gTWF0aC5mbG9vcih2YWx1ZSk7CiAgICB9OwoKICAgIExvZ2ljX0FjdG9yLnByb3RvdHlwZS5jaGVja0ZvckRlYXRoID0gZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMuaXNBbGl2ZSA9IHRoaXMubHAgPiAwOwogICAgICBpZiAoIXRoaXMuaXNBbGl2ZSAmJiAhdGhpcy5jaGVja1N0YXRlUmVzaXN0YW5jZShSZWNvcmRNYW5hZ2VyLnN0YXRlc1swXSkpIHsKICAgICAgICB0aGlzLnN0YXRlcyA9IFtdOwogICAgICAgIHJldHVybiB0aGlzLmFkZFN0YXRlKFJlY29yZE1hbmFnZXIuc3RhdGVzWzBdKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnJlbW92ZVN0YXRlKFJlY29yZE1hbmFnZXIuc3RhdGVzWzBdKTsKICAgICAgICByZXR1cm4gdGhpcy5pc0FsaXZlID0gdHJ1ZTsKICAgICAgfQogICAgfTsKCiAgICBMb2dpY19BY3Rvci5wcm90b3R5cGUudXNlSXRlbSA9IGZ1bmN0aW9uKGl0ZW0sIHRhcmdldCkgewogICAgICB2YXIgY291bnRlciwgY3JpdGljYWwsIGNyaXRpY2FsSGl0UmF0ZSwgZWZmZWN0LCBlZmZlY3RJbmZvcywgaGl0LCBoaXRSYXRlLCBpbmZvLCBzdWNjZXNzLCB2YWx1ZSwgX2ksIF9sZW4sIF9yZWY7CiAgICAgIHRoaXMubXAgPSBNYXRoLm1heCh0aGlzLm1wIC0gaXRlbS5tcENvc3QsIDApOwogICAgICB2YWx1ZSA9IDA7CiAgICAgIGhpdCA9IHRydWU7CiAgICAgIGNvdW50ZXIgPSBmYWxzZTsKICAgICAgZWZmZWN0SW5mb3MgPSBbXTsKICAgICAgc3VjY2VzcyA9IE1hdGgucm91bmQoTWF0aC5yYW5kb20oKSAqIDEwMCkgPD0gaXRlbS5zdWNjZXNzOwogICAgICBzd2l0Y2ggKGl0ZW0uaGl0VHlwZSkgewogICAgICAgIGNhc2UgMToKICAgICAgICAgIGhpdFJhdGUgPSBNYXRoLm1heChNYXRoLm1pbih0aGlzLmhpdFJhdGUgLSB0YXJnZXQuZXZhc2lvblJhdGUsIDEwMCksIDApOwogICAgICAgICAgaGl0ID0gTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpICogMTAwKSA8PSBoaXRSYXRlOwogICAgICAgICAgaWYgKGhpdCkgewogICAgICAgICAgICBjb3VudGVyID0gTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpICogMTAwKSA8ICh0YXJnZXQuY291bnRlclJhdGUgLSAxMDApOwogICAgICAgICAgICBoaXQgPSAhY291bnRlcjsKICAgICAgICAgIH0KICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgMjoKICAgICAgICAgIGhpdFJhdGUgPSBNYXRoLm1heChNYXRoLm1pbih0aGlzLmhpdFJhdGUgLSB0YXJnZXQubWFnaWNFdmFzaW9uUmF0ZSwgMTAwKSwgMCk7CiAgICAgICAgICBoaXQgPSBNYXRoLnJvdW5kKE1hdGgucmFuZG9tKCkgKiAxMDApIDw9IGhpdFJhdGU7CiAgICAgICAgICBpZiAoaGl0KSB7CiAgICAgICAgICAgIGNvdW50ZXIgPSBNYXRoLnJvdW5kKE1hdGgucmFuZG9tKCkgKiAxMDApIDwgdGFyZ2V0Lm1hZ2ljUmVmbGVjdGlvblJhdGU7CiAgICAgICAgICAgIGhpdCA9ICFjb3VudGVyOwogICAgICAgICAgfQogICAgICB9CiAgICAgIGNyaXRpY2FsSGl0UmF0ZSA9IE1hdGgubWF4KE1hdGgubWluKHRoaXMuY3JpdGljYWxIaXRSYXRlIC0gdGFyZ2V0LmNyaXRpY2FsRXZhc2lvblJhdGUsIDEwMCksIDApOwogICAgICBjcml0aWNhbCA9IE1hdGgucm91bmQoTWF0aC5yYW5kb20oKSAqIDEwMCkgPD0gY3JpdGljYWxIaXRSYXRlOwogICAgICBpZiAoaGl0ICYmIHN1Y2Nlc3MpIHsKICAgICAgICB2YWx1ZSA9IHRhcmdldC50YWtlRGFtYWdlKGl0ZW0uZGFtYWdlLCB0aGlzLCB0YXJnZXQsIGNyaXRpY2FsKTsKICAgICAgfQogICAgICBfcmVmID0gaXRlbS5lZmZlY3RzOwogICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICBlZmZlY3QgPSBfcmVmW19pXTsKICAgICAgICBpbmZvID0gdGFyZ2V0LmFwcGx5RWZmZWN0KGVmZmVjdCk7CiAgICAgICAgZWZmZWN0SW5mb3MucHVzaChpbmZvKTsKICAgICAgfQogICAgICByZXR1cm4gewogICAgICAgIHZhbHVlOiB2YWx1ZSwKICAgICAgICBlZmZlY3RJbmZvczogZWZmZWN0SW5mb3MsCiAgICAgICAgaGl0OiBoaXQgJiYgc3VjY2VzcywKICAgICAgICBjb3VudGVyOiBjb3VudGVyLAogICAgICAgIGNyaXRpY2FsOiBpdGVtLmRhbWFnZS5jcml0aWNhbCAmJiBjcml0aWNhbAogICAgICB9OwogICAgfTsKCiAgICByZXR1cm4gTG9naWNfQWN0b3I7CgogIH0pKCk7CgogIHdpbmRvdy5Mb2dpY19BY3RvciA9IExvZ2ljX0FjdG9yOwoKfSkuY2FsbCh0aGlzKTsK"},{"name":"Logic_Enemy","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogTG9naWNfRW5lbXkKIyAgIENyZWF0ZWQgb246IDIwMTMtMDktMjkKIwojICAgQ29weXJpZ2h0IChDKSAyMDEzIEFuZHLpIFJhZG9tc2tpLiBBbGwgcmlnaHRzIHJlc2VydmVkLgojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQojCiMgICBDbGFzczogTG9naWNfRW5lbXkKIwojICAgQSBiYXNlIGNsYXNzIGZvciBhbGwgb3RoZXIgd2luZG93IGNsYXNzZXMuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpjbGFzcyBMb2dpY19FbmVteSBleHRlbmRzIExvZ2ljX0FjdG9yCiAgICBjb25zdHJ1Y3RvcjogKGVuZW15KSAtPgogICAgICAgIHN1cGVyKG51bGwpCiAgICAgICAgQG5hbWUgPSBlbmVteS5uYW1lCiAgICAgICAgQGxldmVsID0gMAogICAgICAgIEBncmFwaGljID0gZW5lbXkuZ3JhcGhpYwogICAgICAgIEBlbmVteSA9IGVuZW15CiAgICAgICAgQGRyb3BJdGVtcyA9IGVuZW15LmRyb3BJdGVtcwogICAgICAgIEBtb25leSA9IGVuZW15Lm1vbmV5CiAgICAgICAgQG1scCA9IGVuZW15LnBhcmFtc1swXQogICAgICAgIEBtbXAgPSBlbmVteS5wYXJhbXNbMV0KICAgICAgICBAYXRrID0gZW5lbXkucGFyYW1zWzJdCiAgICAgICAgQGRlZiA9IGVuZW15LnBhcmFtc1szXQogICAgICAgIEBtYXQgPSBlbmVteS5wYXJhbXNbNF0KICAgICAgICBAbWRmID0gZW5lbXkucGFyYW1zWzVdCiAgICAgICAgQGFnaSA9IGVuZW15LnBhcmFtc1s2XQogICAgICAgIEBsdWsgPSBlbmVteS5wYXJhbXNbN10KICAgICAgICBAbHAgPSBAbWxwCiAgICAgICAgQG1wID0gQG1tcAogICAgICAgIEBleFBhcmFtZXRlcnMgPSBbMCwgMCwgMCwgMCwgMCwgMCwgMF0KICAgICAgICBAc3BQYXJhbWV0ZXJzID0gWzEwMCwgMTAwLCAxMDAsIDEwMCwgMTAwLCAxMDBdCiAgICAgICAgQGFuaW1hdGlvbnMgPSB7fQogICAgICAgIEBpc0FsaXZlID0geWVzCiAgICAgICAgQHByb3BlcnRpZXMgPSBbXQogICAgICAgIEBleHAgPSBlbmVteS5leHAKICAgICAgICBAZXhwVG9OZXh0TGV2ZWwgPSAwCiAgICAgICAgQHNraWxsVHlwZXMgPSBbXQogICAgICAgIEB3ZWFwb25UeXBlcyA9IFtdCiAgICAgICAgQGFybW9yVHlwZXMgPSBbXQogICAgICAgIEBza2lsbHMgPSBbXQogICAgICAgIEBwYXJhbXMgPSBbXQogICAgICAgIEBiYXNlUHJvcGVydGllcyA9IFtdCiAgICAgICAgQHByb3BlcnRpZXMgPSBbXQogICAgICAgIEBidWZmcyA9IFtbXSxbXSxbXSxbXSxbXSxbXSxbXSxbXV0KICAgICAgICBAZGVidWZmcyA9IFtbXSxbXSxbXSxbXSxbXSxbXSxbXSxbXV0KICAgICAgICBAc3RhdGVzID0gW10KICAgICAgICBAYWN0aW9uUGF0dGVybnMgPSBlbmVteS5hY3Rpb25QYXR0ZXJucwogICAgICAgIEBlcXVpcG1lbnRTbG90cyA9IFt7IGZpeGVkOiBubywgc2VhbGVkOiBub30sIHsgZml4ZWQ6IG5vLCBzZWFsZWQ6IG5vfSwgeyBmaXhlZDogbm8sIHNlYWxlZDogbm99LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgeyBmaXhlZDogbm8sIHNlYWxlZDogbm99LCB7IGZpeGVkOiBubywgc2VhbGVkOiBub31dCiAgICAgICAgQHNsb3RUeXBlID0gMAogICAgICAgIEBhY3Rpb25UaW1lID0gMTAwCiAgICAgICAgQGd1YXJkID0gbm8KICAgICAgICAKICAgICAgICBAZXZhc2lvblJhdGUgPSAwCiAgICAgICAgQGNyaXRpY2FsSGl0UmF0ZSA9IDAKICAgICAgICBAY3JpdGljYWxFdmFzaW9uUmF0ZSA9IDAKICAgICAgICBAbWFnaWNFdmFzaW9uUmF0ZSA9IDAKICAgICAgICBAbWFnaWNSZWZsZWN0aW9uUmF0ZSA9IDAKICAgICAgICBAY291bnRlclJhdGUgPSAwCiAgICAgICAgQGxwUmVnZW5lcmF0aW9uUmF0ZSA9IDAKICAgICAgICBAbXBSZWdlbmVyYXRpb25SYXRlID0gMAogICAgICAgIEBlbGVtZW50UmF0ZXMgPSBbXQogICAgICAgIEBhdHRhY2tTa2lsbCA9IE9iamVjdC5jb3B5KFJlY29yZE1hbmFnZXIuc2tpbGxzWzBdKQogICAgICAgIAogICAgICAgIEBoaXRSYXRlID0gMTAwCiAgICAgICAgQGRlZmVuc2VSYXRlID0gMTAwCiAgICAgICAgCiAgICAgICAgaWYgQGVuZW15LnN0YW5kQW5pbWF0aW9uSWQ/IGFuZCBSZWNvcmRNYW5hZ2VyLnNpbXBsZUFuaW1hdGlvbnNbQGVuZW15LnN0YW5kQW5pbWF0aW9uSWRdPwogICAgICAgICAgICBAc3RhbmRBbmltYXRpb24gPSBuZXcgTG9naWNfU2ltcGxlQW5pbWF0aW9uKFJlY29yZE1hbmFnZXIuc2ltcGxlQW5pbWF0aW9uc1tAZW5lbXkuc3RhbmRBbmltYXRpb25JZF0pCiAgICAgICAgaWYgQGVuZW15Lm1hZ2ljQW5pbWF0aW9uSWQ/IGFuZCBSZWNvcmRNYW5hZ2VyLnNpbXBsZUFuaW1hdGlvbnNbQGVuZW15Lm1hZ2ljQW5pbWF0aW9uSWRdPwogICAgICAgICAgICBAbWFnaWNBbmltYXRpb24gPSBuZXcgTG9naWNfU2ltcGxlQW5pbWF0aW9uKFJlY29yZE1hbmFnZXIuc2ltcGxlQW5pbWF0aW9uc1tAZW5lbXkubWFnaWNBbmltYXRpb25JZF0pCiAgICAgICAgaWYgQGVuZW15LmF0dGFja0FuaW1hdGlvbklkPyBhbmQgUmVjb3JkTWFuYWdlci5zaW1wbGVBbmltYXRpb25zW0BlbmVteS5hdHRhY2tBbmltYXRpb25JZF0/CiAgICAgICAgICAgIEBhdHRhY2tBbmltYXRpb24gPSBuZXcgTG9naWNfU2ltcGxlQW5pbWF0aW9uKFJlY29yZE1hbmFnZXIuc2ltcGxlQW5pbWF0aW9uc1tAZW5lbXkuYXR0YWNrQW5pbWF0aW9uSWRdKQogICAgICAgIGlmIEBlbmVteS5pdGVtQW5pbWF0aW9uSWQ/IGFuZCBSZWNvcmRNYW5hZ2VyLnNpbXBsZUFuaW1hdGlvbnNbQGVuZW15Lml0ZW1BbmltYXRpb25JZF0/CiAgICAgICAgICAgIEBpdGVtQW5pbWF0aW9uID0gbmV3IExvZ2ljX1NpbXBsZUFuaW1hdGlvbihSZWNvcmRNYW5hZ2VyLnNpbXBsZUFuaW1hdGlvbnNbQGVuZW15Lml0ZW1BbmltYXRpb25JZF0pCiAgICAgICAgaWYgQGVuZW15Lmd1YXJkQW5pbWF0aW9uSWQ/IGFuZCBSZWNvcmRNYW5hZ2VyLnNpbXBsZUFuaW1hdGlvbnNbQGVuZW15Lmd1YXJkQW5pbWF0aW9uSWRdPwogICAgICAgICAgICBAZ3VhcmRBbmltYXRpb24gPSBuZXcgTG9naWNfU2ltcGxlQW5pbWF0aW9uKFJlY29yZE1hbmFnZXIuc2ltcGxlQW5pbWF0aW9uc1tAZW5lbXkuZ3VhcmRBbmltYXRpb25JZF0pCiAgICAgICAgaWYgQGVuZW15LnByZU1hZ2ljQW5pbWF0aW9uSWQ/IGFuZCBSZWNvcmRNYW5hZ2VyLnNpbXBsZUFuaW1hdGlvbnNbQGVuZW15LnByZU1hZ2ljQW5pbWF0aW9uSWRdPwogICAgICAgICAgICBAcHJlTWFnaWNBbmltYXRpb24gPSBuZXcgTG9naWNfU2ltcGxlQW5pbWF0aW9uKFJlY29yZE1hbmFnZXIuc2ltcGxlQW5pbWF0aW9uc1tAZW5lbXkucHJlTWFnaWNBbmltYXRpb25JZF0pCiAgICAgICAgaWYgQGVuZW15LnByZUF0dGFja0FuaW1hdGlvbklkPyBhbmQgUmVjb3JkTWFuYWdlci5zaW1wbGVBbmltYXRpb25zW0BlbmVteS5wcmVBdHRhY2tBbmltYXRpb25JZF0/CiAgICAgICAgICAgIEBwcmVBdHRhY2tBbmltYXRpb24gPSBuZXcgTG9naWNfU2ltcGxlQW5pbWF0aW9uKFJlY29yZE1hbmFnZXIuc2ltcGxlQW5pbWF0aW9uc1tAZW5lbXkucHJlQXR0YWNrQW5pbWF0aW9uSWRdKQogICAgICAgIGlmIEBlbmVteS5kYW1hZ2VBbmltYXRpb25JZD8gYW5kIFJlY29yZE1hbmFnZXIuc2ltcGxlQW5pbWF0aW9uc1tAZW5lbXkuZGFtYWdlQW5pbWF0aW9uSWRdPwogICAgICAgICAgICBAZGFtYWdlQW5pbWF0aW9uID0gbmV3IExvZ2ljX1NpbXBsZUFuaW1hdGlvbihSZWNvcmRNYW5hZ2VyLnNpbXBsZUFuaW1hdGlvbnNbQGVuZW15LmRhbWFnZUFuaW1hdGlvbklkXSkKICAgICAgICBpZiBAZW5lbXkuZGVhdGhBbmltYXRpb25JZD8gYW5kIFJlY29yZE1hbmFnZXIuc2ltcGxlQW5pbWF0aW9uc1tAZW5lbXkuZGVhdGhBbmltYXRpb25JZF0/CiAgICAgICAgICAgIEBkZWF0aEFuaW1hdGlvbiA9IG5ldyBMb2dpY19TaW1wbGVBbmltYXRpb24oUmVjb3JkTWFuYWdlci5zaW1wbGVBbmltYXRpb25zW0BlbmVteS5kZWF0aEFuaW1hdGlvbklkXSkKICAgICAgICBpZiBAZW5lbXkuYmFkU3RhdHVzQW5pbWF0aW9uSWQ/IGFuZCBSZWNvcmRNYW5hZ2VyLnNpbXBsZUFuaW1hdGlvbnNbQGVuZW15LmJhZFN0YXR1c0FuaW1hdGlvbklkXT8KICAgICAgICAgICAgQGJhZFN0YXR1c0FuaW1hdGlvbiA9IG5ldyBMb2dpY19TaW1wbGVBbmltYXRpb24oUmVjb3JkTWFuYWdlci5zaW1wbGVBbmltYXRpb25zW0BlbmVteS5iYWRTdGF0dXNBbmltYXRpb25JZF0pCiAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgZm9yIGkgaW4gWzAuLi44XQogICAgICAgICAgICBAcGFyYW1zLnB1c2goW2VuZW15LnBhcmFtc1tpXV0pCiAgICAgICAgICAgIAogICAgdXBkYXRlOiAtPgogCiAgICAgICAgCndpbmRvdy5Mb2dpY19FbmVteSA9IExvZ2ljX0VuZW15","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBMb2dpY19FbmVteSwKICAgIF9faGFzUHJvcCA9IHt9Lmhhc093blByb3BlcnR5LAogICAgX19leHRlbmRzID0gZnVuY3Rpb24oY2hpbGQsIHBhcmVudCkgeyBmb3IgKHZhciBrZXkgaW4gcGFyZW50KSB7IGlmIChfX2hhc1Byb3AuY2FsbChwYXJlbnQsIGtleSkpIGNoaWxkW2tleV0gPSBwYXJlbnRba2V5XTsgfSBmdW5jdGlvbiBjdG9yKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gY2hpbGQ7IH0gY3Rvci5wcm90b3R5cGUgPSBwYXJlbnQucHJvdG90eXBlOyBjaGlsZC5wcm90b3R5cGUgPSBuZXcgY3RvcigpOyBjaGlsZC5fX3N1cGVyX18gPSBwYXJlbnQucHJvdG90eXBlOyByZXR1cm4gY2hpbGQ7IH07CgogIExvZ2ljX0VuZW15ID0gKGZ1bmN0aW9uKF9zdXBlcikgewogICAgX19leHRlbmRzKExvZ2ljX0VuZW15LCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIExvZ2ljX0VuZW15KGVuZW15KSB7CiAgICAgIHZhciBpLCBfaTsKICAgICAgTG9naWNfRW5lbXkuX19zdXBlcl9fLmNvbnN0cnVjdG9yLmNhbGwodGhpcywgbnVsbCk7CiAgICAgIHRoaXMubmFtZSA9IGVuZW15Lm5hbWU7CiAgICAgIHRoaXMubGV2ZWwgPSAwOwogICAgICB0aGlzLmdyYXBoaWMgPSBlbmVteS5ncmFwaGljOwogICAgICB0aGlzLmVuZW15ID0gZW5lbXk7CiAgICAgIHRoaXMuZHJvcEl0ZW1zID0gZW5lbXkuZHJvcEl0ZW1zOwogICAgICB0aGlzLm1vbmV5ID0gZW5lbXkubW9uZXk7CiAgICAgIHRoaXMubWxwID0gZW5lbXkucGFyYW1zWzBdOwogICAgICB0aGlzLm1tcCA9IGVuZW15LnBhcmFtc1sxXTsKICAgICAgdGhpcy5hdGsgPSBlbmVteS5wYXJhbXNbMl07CiAgICAgIHRoaXMuZGVmID0gZW5lbXkucGFyYW1zWzNdOwogICAgICB0aGlzLm1hdCA9IGVuZW15LnBhcmFtc1s0XTsKICAgICAgdGhpcy5tZGYgPSBlbmVteS5wYXJhbXNbNV07CiAgICAgIHRoaXMuYWdpID0gZW5lbXkucGFyYW1zWzZdOwogICAgICB0aGlzLmx1ayA9IGVuZW15LnBhcmFtc1s3XTsKICAgICAgdGhpcy5scCA9IHRoaXMubWxwOwogICAgICB0aGlzLm1wID0gdGhpcy5tbXA7CiAgICAgIHRoaXMuZXhQYXJhbWV0ZXJzID0gWzAsIDAsIDAsIDAsIDAsIDAsIDBdOwogICAgICB0aGlzLnNwUGFyYW1ldGVycyA9IFsxMDAsIDEwMCwgMTAwLCAxMDAsIDEwMCwgMTAwXTsKICAgICAgdGhpcy5hbmltYXRpb25zID0ge307CiAgICAgIHRoaXMuaXNBbGl2ZSA9IHRydWU7CiAgICAgIHRoaXMucHJvcGVydGllcyA9IFtdOwogICAgICB0aGlzLmV4cCA9IGVuZW15LmV4cDsKICAgICAgdGhpcy5leHBUb05leHRMZXZlbCA9IDA7CiAgICAgIHRoaXMuc2tpbGxUeXBlcyA9IFtdOwogICAgICB0aGlzLndlYXBvblR5cGVzID0gW107CiAgICAgIHRoaXMuYXJtb3JUeXBlcyA9IFtdOwogICAgICB0aGlzLnNraWxscyA9IFtdOwogICAgICB0aGlzLnBhcmFtcyA9IFtdOwogICAgICB0aGlzLmJhc2VQcm9wZXJ0aWVzID0gW107CiAgICAgIHRoaXMucHJvcGVydGllcyA9IFtdOwogICAgICB0aGlzLmJ1ZmZzID0gW1tdLCBbXSwgW10sIFtdLCBbXSwgW10sIFtdLCBbXV07CiAgICAgIHRoaXMuZGVidWZmcyA9IFtbXSwgW10sIFtdLCBbXSwgW10sIFtdLCBbXSwgW11dOwogICAgICB0aGlzLnN0YXRlcyA9IFtdOwogICAgICB0aGlzLmFjdGlvblBhdHRlcm5zID0gZW5lbXkuYWN0aW9uUGF0dGVybnM7CiAgICAgIHRoaXMuZXF1aXBtZW50U2xvdHMgPSBbCiAgICAgICAgewogICAgICAgICAgZml4ZWQ6IGZhbHNlLAogICAgICAgICAgc2VhbGVkOiBmYWxzZQogICAgICAgIH0sIHsKICAgICAgICAgIGZpeGVkOiBmYWxzZSwKICAgICAgICAgIHNlYWxlZDogZmFsc2UKICAgICAgICB9LCB7CiAgICAgICAgICBmaXhlZDogZmFsc2UsCiAgICAgICAgICBzZWFsZWQ6IGZhbHNlCiAgICAgICAgfSwgewogICAgICAgICAgZml4ZWQ6IGZhbHNlLAogICAgICAgICAgc2VhbGVkOiBmYWxzZQogICAgICAgIH0sIHsKICAgICAgICAgIGZpeGVkOiBmYWxzZSwKICAgICAgICAgIHNlYWxlZDogZmFsc2UKICAgICAgICB9CiAgICAgIF07CiAgICAgIHRoaXMuc2xvdFR5cGUgPSAwOwogICAgICB0aGlzLmFjdGlvblRpbWUgPSAxMDA7CiAgICAgIHRoaXMuZ3VhcmQgPSBmYWxzZTsKICAgICAgdGhpcy5ldmFzaW9uUmF0ZSA9IDA7CiAgICAgIHRoaXMuY3JpdGljYWxIaXRSYXRlID0gMDsKICAgICAgdGhpcy5jcml0aWNhbEV2YXNpb25SYXRlID0gMDsKICAgICAgdGhpcy5tYWdpY0V2YXNpb25SYXRlID0gMDsKICAgICAgdGhpcy5tYWdpY1JlZmxlY3Rpb25SYXRlID0gMDsKICAgICAgdGhpcy5jb3VudGVyUmF0ZSA9IDA7CiAgICAgIHRoaXMubHBSZWdlbmVyYXRpb25SYXRlID0gMDsKICAgICAgdGhpcy5tcFJlZ2VuZXJhdGlvblJhdGUgPSAwOwogICAgICB0aGlzLmVsZW1lbnRSYXRlcyA9IFtdOwogICAgICB0aGlzLmF0dGFja1NraWxsID0gT2JqZWN0LmNvcHkoUmVjb3JkTWFuYWdlci5za2lsbHNbMF0pOwogICAgICB0aGlzLmhpdFJhdGUgPSAxMDA7CiAgICAgIHRoaXMuZGVmZW5zZVJhdGUgPSAxMDA7CiAgICAgIGlmICgodGhpcy5lbmVteS5zdGFuZEFuaW1hdGlvbklkICE9IG51bGwpICYmIChSZWNvcmRNYW5hZ2VyLnNpbXBsZUFuaW1hdGlvbnNbdGhpcy5lbmVteS5zdGFuZEFuaW1hdGlvbklkXSAhPSBudWxsKSkgewogICAgICAgIHRoaXMuc3RhbmRBbmltYXRpb24gPSBuZXcgTG9naWNfU2ltcGxlQW5pbWF0aW9uKFJlY29yZE1hbmFnZXIuc2ltcGxlQW5pbWF0aW9uc1t0aGlzLmVuZW15LnN0YW5kQW5pbWF0aW9uSWRdKTsKICAgICAgfQogICAgICBpZiAoKHRoaXMuZW5lbXkubWFnaWNBbmltYXRpb25JZCAhPSBudWxsKSAmJiAoUmVjb3JkTWFuYWdlci5zaW1wbGVBbmltYXRpb25zW3RoaXMuZW5lbXkubWFnaWNBbmltYXRpb25JZF0gIT0gbnVsbCkpIHsKICAgICAgICB0aGlzLm1hZ2ljQW5pbWF0aW9uID0gbmV3IExvZ2ljX1NpbXBsZUFuaW1hdGlvbihSZWNvcmRNYW5hZ2VyLnNpbXBsZUFuaW1hdGlvbnNbdGhpcy5lbmVteS5tYWdpY0FuaW1hdGlvbklkXSk7CiAgICAgIH0KICAgICAgaWYgKCh0aGlzLmVuZW15LmF0dGFja0FuaW1hdGlvbklkICE9IG51bGwpICYmIChSZWNvcmRNYW5hZ2VyLnNpbXBsZUFuaW1hdGlvbnNbdGhpcy5lbmVteS5hdHRhY2tBbmltYXRpb25JZF0gIT0gbnVsbCkpIHsKICAgICAgICB0aGlzLmF0dGFja0FuaW1hdGlvbiA9IG5ldyBMb2dpY19TaW1wbGVBbmltYXRpb24oUmVjb3JkTWFuYWdlci5zaW1wbGVBbmltYXRpb25zW3RoaXMuZW5lbXkuYXR0YWNrQW5pbWF0aW9uSWRdKTsKICAgICAgfQogICAgICBpZiAoKHRoaXMuZW5lbXkuaXRlbUFuaW1hdGlvbklkICE9IG51bGwpICYmIChSZWNvcmRNYW5hZ2VyLnNpbXBsZUFuaW1hdGlvbnNbdGhpcy5lbmVteS5pdGVtQW5pbWF0aW9uSWRdICE9IG51bGwpKSB7CiAgICAgICAgdGhpcy5pdGVtQW5pbWF0aW9uID0gbmV3IExvZ2ljX1NpbXBsZUFuaW1hdGlvbihSZWNvcmRNYW5hZ2VyLnNpbXBsZUFuaW1hdGlvbnNbdGhpcy5lbmVteS5pdGVtQW5pbWF0aW9uSWRdKTsKICAgICAgfQogICAgICBpZiAoKHRoaXMuZW5lbXkuZ3VhcmRBbmltYXRpb25JZCAhPSBudWxsKSAmJiAoUmVjb3JkTWFuYWdlci5zaW1wbGVBbmltYXRpb25zW3RoaXMuZW5lbXkuZ3VhcmRBbmltYXRpb25JZF0gIT0gbnVsbCkpIHsKICAgICAgICB0aGlzLmd1YXJkQW5pbWF0aW9uID0gbmV3IExvZ2ljX1NpbXBsZUFuaW1hdGlvbihSZWNvcmRNYW5hZ2VyLnNpbXBsZUFuaW1hdGlvbnNbdGhpcy5lbmVteS5ndWFyZEFuaW1hdGlvbklkXSk7CiAgICAgIH0KICAgICAgaWYgKCh0aGlzLmVuZW15LnByZU1hZ2ljQW5pbWF0aW9uSWQgIT0gbnVsbCkgJiYgKFJlY29yZE1hbmFnZXIuc2ltcGxlQW5pbWF0aW9uc1t0aGlzLmVuZW15LnByZU1hZ2ljQW5pbWF0aW9uSWRdICE9IG51bGwpKSB7CiAgICAgICAgdGhpcy5wcmVNYWdpY0FuaW1hdGlvbiA9IG5ldyBMb2dpY19TaW1wbGVBbmltYXRpb24oUmVjb3JkTWFuYWdlci5zaW1wbGVBbmltYXRpb25zW3RoaXMuZW5lbXkucHJlTWFnaWNBbmltYXRpb25JZF0pOwogICAgICB9CiAgICAgIGlmICgodGhpcy5lbmVteS5wcmVBdHRhY2tBbmltYXRpb25JZCAhPSBudWxsKSAmJiAoUmVjb3JkTWFuYWdlci5zaW1wbGVBbmltYXRpb25zW3RoaXMuZW5lbXkucHJlQXR0YWNrQW5pbWF0aW9uSWRdICE9IG51bGwpKSB7CiAgICAgICAgdGhpcy5wcmVBdHRhY2tBbmltYXRpb24gPSBuZXcgTG9naWNfU2ltcGxlQW5pbWF0aW9uKFJlY29yZE1hbmFnZXIuc2ltcGxlQW5pbWF0aW9uc1t0aGlzLmVuZW15LnByZUF0dGFja0FuaW1hdGlvbklkXSk7CiAgICAgIH0KICAgICAgaWYgKCh0aGlzLmVuZW15LmRhbWFnZUFuaW1hdGlvbklkICE9IG51bGwpICYmIChSZWNvcmRNYW5hZ2VyLnNpbXBsZUFuaW1hdGlvbnNbdGhpcy5lbmVteS5kYW1hZ2VBbmltYXRpb25JZF0gIT0gbnVsbCkpIHsKICAgICAgICB0aGlzLmRhbWFnZUFuaW1hdGlvbiA9IG5ldyBMb2dpY19TaW1wbGVBbmltYXRpb24oUmVjb3JkTWFuYWdlci5zaW1wbGVBbmltYXRpb25zW3RoaXMuZW5lbXkuZGFtYWdlQW5pbWF0aW9uSWRdKTsKICAgICAgfQogICAgICBpZiAoKHRoaXMuZW5lbXkuZGVhdGhBbmltYXRpb25JZCAhPSBudWxsKSAmJiAoUmVjb3JkTWFuYWdlci5zaW1wbGVBbmltYXRpb25zW3RoaXMuZW5lbXkuZGVhdGhBbmltYXRpb25JZF0gIT0gbnVsbCkpIHsKICAgICAgICB0aGlzLmRlYXRoQW5pbWF0aW9uID0gbmV3IExvZ2ljX1NpbXBsZUFuaW1hdGlvbihSZWNvcmRNYW5hZ2VyLnNpbXBsZUFuaW1hdGlvbnNbdGhpcy5lbmVteS5kZWF0aEFuaW1hdGlvbklkXSk7CiAgICAgIH0KICAgICAgaWYgKCh0aGlzLmVuZW15LmJhZFN0YXR1c0FuaW1hdGlvbklkICE9IG51bGwpICYmIChSZWNvcmRNYW5hZ2VyLnNpbXBsZUFuaW1hdGlvbnNbdGhpcy5lbmVteS5iYWRTdGF0dXNBbmltYXRpb25JZF0gIT0gbnVsbCkpIHsKICAgICAgICB0aGlzLmJhZFN0YXR1c0FuaW1hdGlvbiA9IG5ldyBMb2dpY19TaW1wbGVBbmltYXRpb24oUmVjb3JkTWFuYWdlci5zaW1wbGVBbmltYXRpb25zW3RoaXMuZW5lbXkuYmFkU3RhdHVzQW5pbWF0aW9uSWRdKTsKICAgICAgfQogICAgICBmb3IgKGkgPSBfaSA9IDA7IF9pIDwgODsgaSA9ICsrX2kpIHsKICAgICAgICB0aGlzLnBhcmFtcy5wdXNoKFtlbmVteS5wYXJhbXNbaV1dKTsKICAgICAgfQogICAgfQoKICAgIExvZ2ljX0VuZW15LnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpIHt9OwoKICAgIHJldHVybiBMb2dpY19FbmVteTsKCiAgfSkoTG9naWNfQWN0b3IpOwoKICB3aW5kb3cuTG9naWNfRW5lbXkgPSBMb2dpY19FbmVteTsKCn0pLmNhbGwodGhpcyk7Cg=="},{"name":"Logic_Party","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogTG9naWNfUGFydHkKIyAgIENyZWF0ZWQgb246IDIwMTMtMDktMTUKIwojICAgQ29weXJpZ2h0IChDKSAyMDEzIEFuZHLpIFJhZG9tc2tpLiBBbGwgcmlnaHRzIHJlc2VydmVkLgojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQojCiMgICBDbGFzczogTG9naWNfUGFydHkKIwojICAgQSBsb2dpYyB3aGljaCBob2xkcyB0aGUgaW5mb3JtYXRpb24gYWJvdXQgdGhlIGN1cnJlbnQgcGFydHkuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpjbGFzcyBMb2dpY19QYXJ0eQogICAgY29uc3RydWN0b3I6ICgpIC0+CiAgICAgICAgQG1lbWJlcnMgPSBbXQogICAgICAgIGlmIFJlY29yZE1hbmFnZXIuc3lzdGVtLmFjdG9yMSAhPSAtMQogICAgICAgICAgICBAYWRkKFJlY29yZE1hbmFnZXIuYWN0b3JzW1JlY29yZE1hbmFnZXIuc3lzdGVtLmFjdG9yMV0pCiAgICAgICAgaWYgUmVjb3JkTWFuYWdlci5zeXN0ZW0uYWN0b3IyPwogICAgICAgICAgICBAYWRkKFJlY29yZE1hbmFnZXIuYWN0b3JzW1JlY29yZE1hbmFnZXIuc3lzdGVtLmFjdG9yMl0pCiAgICAgICAgaWYgUmVjb3JkTWFuYWdlci5zeXN0ZW0uYWN0b3IzPwogICAgICAgICAgICBAYWRkKFJlY29yZE1hbmFnZXIuYWN0b3JzW1JlY29yZE1hbmFnZXIuc3lzdGVtLmFjdG9yM10pCiAgICAgICAgaWYgUmVjb3JkTWFuYWdlci5zeXN0ZW0uYWN0b3I0PwogICAgICAgICAgICBAYWRkKFJlY29yZE1hbmFnZXIuYWN0b3JzW1JlY29yZE1hbmFnZXIuc3lzdGVtLmFjdG9yNF0pCiAgICAgICAgCiAgICByZWZyZXNoOiAtPgogICAgICAgIGZvciBtZW1iZXIgaW4gQG1lbWJlcnMKICAgICAgICAgICAgbWVtYmVyLnJlZnJlc2goKQogICAgICAgICAgICAKICAgIGlzQWxpdmU6IC0+CiAgICAgICAgcmVzdWx0ID0gbm8KICAgICAgICAKICAgICAgICBmb3IgbWVtYmVyIGluIEBtZW1iZXJzCiAgICAgICAgICAgIGlmIG1lbWJlci5scCA+IDAKICAgICAgICAgICAgICAgIHJlc3VsdCA9IHllcwogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAKICAgICAgICByZXR1cm4gcmVzdWx0CiAgICAgICAgCiAgICBsZXZlbDogLT4KICAgICAgICByZXN1bHQgPSAwCiAgICAgICAgCiAgICAgICAgZm9yIG1lbWJlciBpbiBAbWVtYmVycwogICAgICAgICAgICByZXN1bHQgKz0gbWVtYmVyLmxldmVsCiAgICAgICAgICAgIAogICAgICAgIHJldHVybiBNYXRoLmNlaWwocmVzdWx0IC8gQG1lbWJlcnMubGVuZ3RoKQogICAgdG9EYXRhQnVuZGxlOiAtPgogICAgICAgIGJ1bmRsZSA9IHsgbWVtYmVyczogW10gfQogICAgICAgIAogICAgICAgIGZvciBtZW1iZXIgaW4gQG1lbWJlcnMKICAgICAgICAgICAgYnVuZGxlLm1lbWJlcnMucHVzaChtZW1iZXIudG9EYXRhQnVuZGxlKCkpCiAgICAgICAgICAgIAogICAgICAgIHJldHVybiBidW5kbGUKICAgICAgICAKICAgIG1lbWJlckJ5SWQ6IChpZCkgLT4KICAgICAgICBpbmRleCA9IEBtZW1iZXJzLnRvUHJvcGVydHlBcnJheSgnYWN0b3JJZCcpLmluZGV4T2YoaWQpCiAgICAgICAgCiAgICAgICAgcmV0dXJuIGlmIGluZGV4ICE9IC0xIHRoZW4gQG1lbWJlcnNbaW5kZXhdIGVsc2UgbnVsbAogICAgICAgIAogICAgYWRkOiAoYWN0b3IpIC0+CiAgICAgICAgbWVtYmVySWRzID0gQG1lbWJlcnMudG9Qcm9wZXJ0eUFycmF5KCdhY3RvcklkJykKICAgICAgICBpbmRleCA9IG1lbWJlcklkcy5pbmRleE9mKGFjdG9yLmluZGV4KQogICAgICAgIAogICAgICAgIGlmIGluZGV4ID09IC0xCiAgICAgICAgICAgIEBtZW1iZXJzLnB1c2gobmV3IExvZ2ljX0FjdG9yKGFjdG9yKSkKICAgICAgICAgICAgCiAgICByZW1vdmU6IChhY3RvcikgLT4KICAgICAgICBtZW1iZXJJZHMgPSBAbWVtYmVycy50b1Byb3BlcnR5QXJyYXkoJ2FjdG9ySWQnKQogICAgICAgIGluZGV4ID0gbWVtYmVySWRzLmluZGV4T2YoYWN0b3IuaW5kZXgpCiAgICAgICAgCiAgICAgICAgaWYgaW5kZXggIT0gLTEgdGhlbiBAbWVtYmVycy5zcGxpY2UoaW5kZXgsIDEpCndpbmRvdy5Mb2dpY19QYXJ0eSA9IExvZ2ljX1BhcnR5","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBMb2dpY19QYXJ0eTsKCiAgTG9naWNfUGFydHkgPSAoZnVuY3Rpb24oKSB7CiAgICBmdW5jdGlvbiBMb2dpY19QYXJ0eSgpIHsKICAgICAgdGhpcy5tZW1iZXJzID0gW107CiAgICAgIGlmIChSZWNvcmRNYW5hZ2VyLnN5c3RlbS5hY3RvcjEgIT09IC0xKSB7CiAgICAgICAgdGhpcy5hZGQoUmVjb3JkTWFuYWdlci5hY3RvcnNbUmVjb3JkTWFuYWdlci5zeXN0ZW0uYWN0b3IxXSk7CiAgICAgIH0KICAgICAgaWYgKFJlY29yZE1hbmFnZXIuc3lzdGVtLmFjdG9yMiAhPSBudWxsKSB7CiAgICAgICAgdGhpcy5hZGQoUmVjb3JkTWFuYWdlci5hY3RvcnNbUmVjb3JkTWFuYWdlci5zeXN0ZW0uYWN0b3IyXSk7CiAgICAgIH0KICAgICAgaWYgKFJlY29yZE1hbmFnZXIuc3lzdGVtLmFjdG9yMyAhPSBudWxsKSB7CiAgICAgICAgdGhpcy5hZGQoUmVjb3JkTWFuYWdlci5hY3RvcnNbUmVjb3JkTWFuYWdlci5zeXN0ZW0uYWN0b3IzXSk7CiAgICAgIH0KICAgICAgaWYgKFJlY29yZE1hbmFnZXIuc3lzdGVtLmFjdG9yNCAhPSBudWxsKSB7CiAgICAgICAgdGhpcy5hZGQoUmVjb3JkTWFuYWdlci5hY3RvcnNbUmVjb3JkTWFuYWdlci5zeXN0ZW0uYWN0b3I0XSk7CiAgICAgIH0KICAgIH0KCiAgICBMb2dpY19QYXJ0eS5wcm90b3R5cGUucmVmcmVzaCA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgbWVtYmVyLCBfaSwgX2xlbiwgX3JlZiwgX3Jlc3VsdHM7CiAgICAgIF9yZWYgPSB0aGlzLm1lbWJlcnM7CiAgICAgIF9yZXN1bHRzID0gW107CiAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gX3JlZi5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykgewogICAgICAgIG1lbWJlciA9IF9yZWZbX2ldOwogICAgICAgIF9yZXN1bHRzLnB1c2gobWVtYmVyLnJlZnJlc2goKSk7CiAgICAgIH0KICAgICAgcmV0dXJuIF9yZXN1bHRzOwogICAgfTsKCiAgICBMb2dpY19QYXJ0eS5wcm90b3R5cGUuaXNBbGl2ZSA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgbWVtYmVyLCByZXN1bHQsIF9pLCBfbGVuLCBfcmVmOwogICAgICByZXN1bHQgPSBmYWxzZTsKICAgICAgX3JlZiA9IHRoaXMubWVtYmVyczsKICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBfcmVmLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7CiAgICAgICAgbWVtYmVyID0gX3JlZltfaV07CiAgICAgICAgaWYgKG1lbWJlci5scCA+IDApIHsKICAgICAgICAgIHJlc3VsdCA9IHRydWU7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH07CgogICAgTG9naWNfUGFydHkucHJvdG90eXBlLmxldmVsID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBtZW1iZXIsIHJlc3VsdCwgX2ksIF9sZW4sIF9yZWY7CiAgICAgIHJlc3VsdCA9IDA7CiAgICAgIF9yZWYgPSB0aGlzLm1lbWJlcnM7CiAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gX3JlZi5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykgewogICAgICAgIG1lbWJlciA9IF9yZWZbX2ldOwogICAgICAgIHJlc3VsdCArPSBtZW1iZXIubGV2ZWw7CiAgICAgIH0KICAgICAgcmV0dXJuIE1hdGguY2VpbChyZXN1bHQgLyB0aGlzLm1lbWJlcnMubGVuZ3RoKTsKICAgIH07CgogICAgTG9naWNfUGFydHkucHJvdG90eXBlLnRvRGF0YUJ1bmRsZSA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgYnVuZGxlLCBtZW1iZXIsIF9pLCBfbGVuLCBfcmVmOwogICAgICBidW5kbGUgPSB7CiAgICAgICAgbWVtYmVyczogW10KICAgICAgfTsKICAgICAgX3JlZiA9IHRoaXMubWVtYmVyczsKICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBfcmVmLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7CiAgICAgICAgbWVtYmVyID0gX3JlZltfaV07CiAgICAgICAgYnVuZGxlLm1lbWJlcnMucHVzaChtZW1iZXIudG9EYXRhQnVuZGxlKCkpOwogICAgICB9CiAgICAgIHJldHVybiBidW5kbGU7CiAgICB9OwoKICAgIExvZ2ljX1BhcnR5LnByb3RvdHlwZS5tZW1iZXJCeUlkID0gZnVuY3Rpb24oaWQpIHsKICAgICAgdmFyIGluZGV4OwogICAgICBpbmRleCA9IHRoaXMubWVtYmVycy50b1Byb3BlcnR5QXJyYXkoJ2FjdG9ySWQnKS5pbmRleE9mKGlkKTsKICAgICAgaWYgKGluZGV4ICE9PSAtMSkgewogICAgICAgIHJldHVybiB0aGlzLm1lbWJlcnNbaW5kZXhdOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CiAgICB9OwoKICAgIExvZ2ljX1BhcnR5LnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbihhY3RvcikgewogICAgICB2YXIgaW5kZXgsIG1lbWJlcklkczsKICAgICAgbWVtYmVySWRzID0gdGhpcy5tZW1iZXJzLnRvUHJvcGVydHlBcnJheSgnYWN0b3JJZCcpOwogICAgICBpbmRleCA9IG1lbWJlcklkcy5pbmRleE9mKGFjdG9yLmluZGV4KTsKICAgICAgaWYgKGluZGV4ID09PSAtMSkgewogICAgICAgIHJldHVybiB0aGlzLm1lbWJlcnMucHVzaChuZXcgTG9naWNfQWN0b3IoYWN0b3IpKTsKICAgICAgfQogICAgfTsKCiAgICBMb2dpY19QYXJ0eS5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24oYWN0b3IpIHsKICAgICAgdmFyIGluZGV4LCBtZW1iZXJJZHM7CiAgICAgIG1lbWJlcklkcyA9IHRoaXMubWVtYmVycy50b1Byb3BlcnR5QXJyYXkoJ2FjdG9ySWQnKTsKICAgICAgaW5kZXggPSBtZW1iZXJJZHMuaW5kZXhPZihhY3Rvci5pbmRleCk7CiAgICAgIGlmIChpbmRleCAhPT0gLTEpIHsKICAgICAgICByZXR1cm4gdGhpcy5tZW1iZXJzLnNwbGljZShpbmRleCwgMSk7CiAgICAgIH0KICAgIH07CgogICAgcmV0dXJuIExvZ2ljX1BhcnR5OwoKICB9KSgpOwoKICB3aW5kb3cuTG9naWNfUGFydHkgPSBMb2dpY19QYXJ0eTsKCn0pLmNhbGwodGhpcyk7Cg=="},{"name":"Logic_Inventory","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogTG9naWNfSW52ZW50b3J5CiMgICBDcmVhdGVkIG9uOiAyMDEzLTA5LTIyCiMKIyAgIENvcHlyaWdodCAoQykgMjAxMyBBbmRy6SBSYWRvbXNraS4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KIwojICAgQ2xhc3M6IExvZ2ljX0ludmVudG9yeQojCiMgICBBIGxvZ2ljIHdoaWNoIGhvbGRzIHRoZSBpbmZvcm1hdGlvbiBhYm91dCB0aGUgaW52ZW50b3J5IChpdGVtcywgd2VhcG9ucywgLi4uKQojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKY2xhc3MgTG9naWNfSW52ZW50b3J5CiAgICBjb25zdHJ1Y3RvcjogKGRhdGEpIC0+CiAgICAgICAgQGl0ZW1zID0gW10KICAgICAgICBAd2VhcG9ucyA9IFtdCiAgICAgICAgQGFybW9ycyA9IFtdCiAgICAgICAgQGtleUl0ZW1zID0gW10KICAgICAgICAKICAgICAgICBpZiBkYXRhPwogICAgICAgICAgICBmb3IgaXRlbSBpbiBkYXRhLml0ZW1zCiAgICAgICAgICAgICAgICBAaXRlbXNbaXRlbS5pZF0gPSB7IGl0ZW06IFJlY29yZE1hbmFnZXIuaXRlbXNbaXRlbS5pZF0sIGNvdW50OiBpdGVtLmNvdW50IH0KICAgICAgICAgICAgZm9yIGl0ZW0gaW4gZGF0YS53ZWFwb25zCiAgICAgICAgICAgICAgICBAd2VhcG9uc1tpdGVtLmlkXSA9IHsgaXRlbTogUmVjb3JkTWFuYWdlci53ZWFwb25zW2l0ZW0uaWRdLCBjb3VudDogaXRlbS5jb3VudCB9CiAgICAgICAgICAgIGZvciBpdGVtIGluIGRhdGEuYXJtb3JzCiAgICAgICAgICAgICAgICBAYXJtb3JzW2l0ZW0uaWRdID0geyBpdGVtOiBSZWNvcmRNYW5hZ2VyLmFybW9yc1tpdGVtLmlkXSwgY291bnQ6IGl0ZW0uY291bnQgfQogICAgICAgICAgICBmb3IgaXRlbSBpbiBkYXRhLmtleUl0ZW1zCiAgICAgICAgICAgICAgICBAa2V5SXRlbXNbaXRlbS5pZF0gPSB7IGl0ZW06IFJlY29yZE1hbmFnZXIuaXRlbXNbaXRlbS5pZF0sIGNvdW50OiBpdGVtLmNvdW50IH0KICAgICAgICAgICAgICAgIAogICAgIAogICAgCiAgICB0b0RhdGFCdW5kbGU6IC0+CiAgICAgICAgYnVuZGxlID0geyBpdGVtczogW10sIHdlYXBvbnM6IFtdLCBhcm1vcnM6IFtdLCBrZXlJdGVtczogW10gfQogICAgICAgIAogICAgICAgIGZvciBpdGVtIGluIEBpdGVtcwogICAgICAgICAgICBidW5kbGUuaXRlbXMucHVzaCh7IGlkOiBpdGVtLml0ZW0uaW5kZXgsIGNvdW50OiBpdGVtLmNvdW50IH0pCiAgICAgICAgCiAgICAgICAgZm9yIGl0ZW0gaW4gQHdlYXBvbnMKICAgICAgICAgICAgYnVuZGxlLndlYXBvbnMucHVzaCh7IGlkOiBpdGVtLml0ZW0uaW5kZXgsIGNvdW50OiBpdGVtLmNvdW50IH0pCiAgICAgICAgICAgIAogICAgICAgIGZvciBpdGVtIGluIEBhcm1vcnMKICAgICAgICAgICAgYnVuZGxlLmFybW9ycy5wdXNoKHsgaWQ6IGl0ZW0uaXRlbS5pbmRleCwgY291bnQ6IGl0ZW0uY291bnQgfSkKICAgICAgICAgICAgCiAgICAgICAgZm9yIGl0ZW0gaW4gQGtleUl0ZW1zCiAgICAgICAgICAgIGJ1bmRsZS5rZXlJdGVtcy5wdXNoKHsgaWQ6IGl0ZW0uaXRlbS5pbmRleCwgY291bnQ6IGl0ZW0uY291bnQgfSkKICAgICAgICAgICAgCiAgICAgICAgcmV0dXJuIGJ1bmRsZQogICAgICAgIAogICAgYWRkSXRlbTogKGl0ZW0sIGFtb3VudCkgLT4KICAgICAgICBpdGVtcyA9IG51bGwKICAgICAgICBpZiBpdGVtLml0ZW1UeXBlPyB0aGVuIGl0ZW1zID0gQGl0ZW1zCiAgICAgICAgaWYgaXRlbS53ZWFwb25UeXBlPyB0aGVuIGl0ZW1zID0gQHdlYXBvbnMKICAgICAgICBpZiBpdGVtLmFybW9yVHlwZT8gdGhlbiBpdGVtcyA9IEBhcm1vcnMKICAgICAgICAKICAgICAgICBpZiBpdGVtcz8KICAgICAgICAgICAgaWYgaXRlbXNbaXRlbS5pbmRleF0/IAogICAgICAgICAgICAgICAgaXRlbXNbaXRlbS5pbmRleF0uY291bnQgPSBNYXRoLm1pbihpdGVtc1tpdGVtLmluZGV4XS5jb3VudCArIGFtb3VudCwgOTkpCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIGl0ZW1zW2l0ZW0uaW5kZXhdID0geyBpdGVtOiBpdGVtLCBjb3VudDogYW1vdW50IH0KICAgICAgICAgICAgICAgIAogICAgcmVtb3ZlSXRlbTogKGl0ZW0sIGFtb3VudCkgLT4KICAgICAgICBpdGVtcyA9IG51bGwKICAgICAgICBpZiBpdGVtLml0ZW1UeXBlPyB0aGVuIGl0ZW1zID0gQGl0ZW1zCiAgICAgICAgaWYgaXRlbS53ZWFwb25UeXBlPyB0aGVuIGl0ZW1zID0gQHdlYXBvbnMKICAgICAgICBpZiBpdGVtLmFybW9yVHlwZT8gdGhlbiBpdGVtcyA9IEBhcm1vcnMKICAgICAgICAKICAgICAgICBpZiBpdGVtcz8KICAgICAgICAgICAgaWYgaXRlbXNbaXRlbS5pbmRleF0/IAogICAgICAgICAgICAgICAgaXRlbXNbaXRlbS5pbmRleF0uY291bnQgPSBNYXRoLm1heChpdGVtc1tpdGVtLmluZGV4XS5jb3VudCAtIGFtb3VudCwgMCkKICAgICAgICAgICAgICAgIAogICAgaXRlbTogKHR5cGUsIGlkKSAtPgogICAgICAgIHJlc3VsdCA9IG51bGwKICAgICAgICAKICAgICAgICBzd2l0Y2ggdHlwZQogICAgICAgICAgICB3aGVuIDAgIyBJdGVtcwogICAgICAgICAgICAgICAgaWYgbm90IEBpdGVtc1tpZF0/CiAgICAgICAgICAgICAgICAgICAgQGl0ZW1zW2lkXSA9IHsgaXRlbTogUmVjb3JkTWFuYWdlci5pdGVtc1tpZF0sIGNvdW50OiAwIH0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IEBpdGVtc1tpZF0KICAgICAgICAgICAgd2hlbiAxICMgV2VhcG9ucwogICAgICAgICAgICAgICAgaWYgbm90IEB3ZWFwb25zW2lkXT8KICAgICAgICAgICAgICAgICAgICBAd2VhcG9uc1tpZF0gPSB7IGl0ZW06IFJlY29yZE1hbmFnZXIud2VhcG9uc1tpZF0sIGNvdW50OiAwIH0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IEB3ZWFwb25zW2lkXQogICAgICAgICAgICB3aGVuIDIgIyBBcm1vcnMKICAgICAgICAgICAgICAgIGlmIG5vdCBAYXJtb3JzW2lkXT8KICAgICAgICAgICAgICAgICAgICBAYXJtb3JzW2lkXSA9IHsgaXRlbTogUmVjb3JkTWFuYWdlci5hcm1vcnNbaWRdLCBjb3VudDogMCB9CiAgICAgICAgICAgICAgICByZXN1bHQgPSBAYXJtb3JzW2lkXQogICAgICAgICAgICAKICAgICAgICByZXR1cm4gcmVzdWx0CiAKCndpbmRvdy5Mb2dpY19JbnZlbnRvcnkgPSBMb2dpY19JbnZlbnRvcnk=","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBMb2dpY19JbnZlbnRvcnk7CgogIExvZ2ljX0ludmVudG9yeSA9IChmdW5jdGlvbigpIHsKICAgIGZ1bmN0aW9uIExvZ2ljX0ludmVudG9yeShkYXRhKSB7CiAgICAgIHZhciBpdGVtLCBfaSwgX2osIF9rLCBfbCwgX2xlbiwgX2xlbjEsIF9sZW4yLCBfbGVuMywgX3JlZiwgX3JlZjEsIF9yZWYyLCBfcmVmMzsKICAgICAgdGhpcy5pdGVtcyA9IFtdOwogICAgICB0aGlzLndlYXBvbnMgPSBbXTsKICAgICAgdGhpcy5hcm1vcnMgPSBbXTsKICAgICAgdGhpcy5rZXlJdGVtcyA9IFtdOwogICAgICBpZiAoZGF0YSAhPSBudWxsKSB7CiAgICAgICAgX3JlZiA9IGRhdGEuaXRlbXM7CiAgICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBfcmVmLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7CiAgICAgICAgICBpdGVtID0gX3JlZltfaV07CiAgICAgICAgICB0aGlzLml0ZW1zW2l0ZW0uaWRdID0gewogICAgICAgICAgICBpdGVtOiBSZWNvcmRNYW5hZ2VyLml0ZW1zW2l0ZW0uaWRdLAogICAgICAgICAgICBjb3VudDogaXRlbS5jb3VudAogICAgICAgICAgfTsKICAgICAgICB9CiAgICAgICAgX3JlZjEgPSBkYXRhLndlYXBvbnM7CiAgICAgICAgZm9yIChfaiA9IDAsIF9sZW4xID0gX3JlZjEubGVuZ3RoOyBfaiA8IF9sZW4xOyBfaisrKSB7CiAgICAgICAgICBpdGVtID0gX3JlZjFbX2pdOwogICAgICAgICAgdGhpcy53ZWFwb25zW2l0ZW0uaWRdID0gewogICAgICAgICAgICBpdGVtOiBSZWNvcmRNYW5hZ2VyLndlYXBvbnNbaXRlbS5pZF0sCiAgICAgICAgICAgIGNvdW50OiBpdGVtLmNvdW50CiAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgICBfcmVmMiA9IGRhdGEuYXJtb3JzOwogICAgICAgIGZvciAoX2sgPSAwLCBfbGVuMiA9IF9yZWYyLmxlbmd0aDsgX2sgPCBfbGVuMjsgX2srKykgewogICAgICAgICAgaXRlbSA9IF9yZWYyW19rXTsKICAgICAgICAgIHRoaXMuYXJtb3JzW2l0ZW0uaWRdID0gewogICAgICAgICAgICBpdGVtOiBSZWNvcmRNYW5hZ2VyLmFybW9yc1tpdGVtLmlkXSwKICAgICAgICAgICAgY291bnQ6IGl0ZW0uY291bnQKICAgICAgICAgIH07CiAgICAgICAgfQogICAgICAgIF9yZWYzID0gZGF0YS5rZXlJdGVtczsKICAgICAgICBmb3IgKF9sID0gMCwgX2xlbjMgPSBfcmVmMy5sZW5ndGg7IF9sIDwgX2xlbjM7IF9sKyspIHsKICAgICAgICAgIGl0ZW0gPSBfcmVmM1tfbF07CiAgICAgICAgICB0aGlzLmtleUl0ZW1zW2l0ZW0uaWRdID0gewogICAgICAgICAgICBpdGVtOiBSZWNvcmRNYW5hZ2VyLml0ZW1zW2l0ZW0uaWRdLAogICAgICAgICAgICBjb3VudDogaXRlbS5jb3VudAogICAgICAgICAgfTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBMb2dpY19JbnZlbnRvcnkucHJvdG90eXBlLnRvRGF0YUJ1bmRsZSA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgYnVuZGxlLCBpdGVtLCBfaSwgX2osIF9rLCBfbCwgX2xlbiwgX2xlbjEsIF9sZW4yLCBfbGVuMywgX3JlZiwgX3JlZjEsIF9yZWYyLCBfcmVmMzsKICAgICAgYnVuZGxlID0gewogICAgICAgIGl0ZW1zOiBbXSwKICAgICAgICB3ZWFwb25zOiBbXSwKICAgICAgICBhcm1vcnM6IFtdLAogICAgICAgIGtleUl0ZW1zOiBbXQogICAgICB9OwogICAgICBfcmVmID0gdGhpcy5pdGVtczsKICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBfcmVmLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7CiAgICAgICAgaXRlbSA9IF9yZWZbX2ldOwogICAgICAgIGJ1bmRsZS5pdGVtcy5wdXNoKHsKICAgICAgICAgIGlkOiBpdGVtLml0ZW0uaW5kZXgsCiAgICAgICAgICBjb3VudDogaXRlbS5jb3VudAogICAgICAgIH0pOwogICAgICB9CiAgICAgIF9yZWYxID0gdGhpcy53ZWFwb25zOwogICAgICBmb3IgKF9qID0gMCwgX2xlbjEgPSBfcmVmMS5sZW5ndGg7IF9qIDwgX2xlbjE7IF9qKyspIHsKICAgICAgICBpdGVtID0gX3JlZjFbX2pdOwogICAgICAgIGJ1bmRsZS53ZWFwb25zLnB1c2goewogICAgICAgICAgaWQ6IGl0ZW0uaXRlbS5pbmRleCwKICAgICAgICAgIGNvdW50OiBpdGVtLmNvdW50CiAgICAgICAgfSk7CiAgICAgIH0KICAgICAgX3JlZjIgPSB0aGlzLmFybW9yczsKICAgICAgZm9yIChfayA9IDAsIF9sZW4yID0gX3JlZjIubGVuZ3RoOyBfayA8IF9sZW4yOyBfaysrKSB7CiAgICAgICAgaXRlbSA9IF9yZWYyW19rXTsKICAgICAgICBidW5kbGUuYXJtb3JzLnB1c2goewogICAgICAgICAgaWQ6IGl0ZW0uaXRlbS5pbmRleCwKICAgICAgICAgIGNvdW50OiBpdGVtLmNvdW50CiAgICAgICAgfSk7CiAgICAgIH0KICAgICAgX3JlZjMgPSB0aGlzLmtleUl0ZW1zOwogICAgICBmb3IgKF9sID0gMCwgX2xlbjMgPSBfcmVmMy5sZW5ndGg7IF9sIDwgX2xlbjM7IF9sKyspIHsKICAgICAgICBpdGVtID0gX3JlZjNbX2xdOwogICAgICAgIGJ1bmRsZS5rZXlJdGVtcy5wdXNoKHsKICAgICAgICAgIGlkOiBpdGVtLml0ZW0uaW5kZXgsCiAgICAgICAgICBjb3VudDogaXRlbS5jb3VudAogICAgICAgIH0pOwogICAgICB9CiAgICAgIHJldHVybiBidW5kbGU7CiAgICB9OwoKICAgIExvZ2ljX0ludmVudG9yeS5wcm90b3R5cGUuYWRkSXRlbSA9IGZ1bmN0aW9uKGl0ZW0sIGFtb3VudCkgewogICAgICB2YXIgaXRlbXM7CiAgICAgIGl0ZW1zID0gbnVsbDsKICAgICAgaWYgKGl0ZW0uaXRlbVR5cGUgIT0gbnVsbCkgewogICAgICAgIGl0ZW1zID0gdGhpcy5pdGVtczsKICAgICAgfQogICAgICBpZiAoaXRlbS53ZWFwb25UeXBlICE9IG51bGwpIHsKICAgICAgICBpdGVtcyA9IHRoaXMud2VhcG9uczsKICAgICAgfQogICAgICBpZiAoaXRlbS5hcm1vclR5cGUgIT0gbnVsbCkgewogICAgICAgIGl0ZW1zID0gdGhpcy5hcm1vcnM7CiAgICAgIH0KICAgICAgaWYgKGl0ZW1zICE9IG51bGwpIHsKICAgICAgICBpZiAoaXRlbXNbaXRlbS5pbmRleF0gIT0gbnVsbCkgewogICAgICAgICAgcmV0dXJuIGl0ZW1zW2l0ZW0uaW5kZXhdLmNvdW50ID0gTWF0aC5taW4oaXRlbXNbaXRlbS5pbmRleF0uY291bnQgKyBhbW91bnQsIDk5KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmV0dXJuIGl0ZW1zW2l0ZW0uaW5kZXhdID0gewogICAgICAgICAgICBpdGVtOiBpdGVtLAogICAgICAgICAgICBjb3VudDogYW1vdW50CiAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICBMb2dpY19JbnZlbnRvcnkucHJvdG90eXBlLnJlbW92ZUl0ZW0gPSBmdW5jdGlvbihpdGVtLCBhbW91bnQpIHsKICAgICAgdmFyIGl0ZW1zOwogICAgICBpdGVtcyA9IG51bGw7CiAgICAgIGlmIChpdGVtLml0ZW1UeXBlICE9IG51bGwpIHsKICAgICAgICBpdGVtcyA9IHRoaXMuaXRlbXM7CiAgICAgIH0KICAgICAgaWYgKGl0ZW0ud2VhcG9uVHlwZSAhPSBudWxsKSB7CiAgICAgICAgaXRlbXMgPSB0aGlzLndlYXBvbnM7CiAgICAgIH0KICAgICAgaWYgKGl0ZW0uYXJtb3JUeXBlICE9IG51bGwpIHsKICAgICAgICBpdGVtcyA9IHRoaXMuYXJtb3JzOwogICAgICB9CiAgICAgIGlmIChpdGVtcyAhPSBudWxsKSB7CiAgICAgICAgaWYgKGl0ZW1zW2l0ZW0uaW5kZXhdICE9IG51bGwpIHsKICAgICAgICAgIHJldHVybiBpdGVtc1tpdGVtLmluZGV4XS5jb3VudCA9IE1hdGgubWF4KGl0ZW1zW2l0ZW0uaW5kZXhdLmNvdW50IC0gYW1vdW50LCAwKTsKICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgTG9naWNfSW52ZW50b3J5LnByb3RvdHlwZS5pdGVtID0gZnVuY3Rpb24odHlwZSwgaWQpIHsKICAgICAgdmFyIHJlc3VsdDsKICAgICAgcmVzdWx0ID0gbnVsbDsKICAgICAgc3dpdGNoICh0eXBlKSB7CiAgICAgICAgY2FzZSAwOgogICAgICAgICAgaWYgKHRoaXMuaXRlbXNbaWRdID09IG51bGwpIHsKICAgICAgICAgICAgdGhpcy5pdGVtc1tpZF0gPSB7CiAgICAgICAgICAgICAgaXRlbTogUmVjb3JkTWFuYWdlci5pdGVtc1tpZF0sCiAgICAgICAgICAgICAgY291bnQ6IDAKICAgICAgICAgICAgfTsKICAgICAgICAgIH0KICAgICAgICAgIHJlc3VsdCA9IHRoaXMuaXRlbXNbaWRdOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAxOgogICAgICAgICAgaWYgKHRoaXMud2VhcG9uc1tpZF0gPT0gbnVsbCkgewogICAgICAgICAgICB0aGlzLndlYXBvbnNbaWRdID0gewogICAgICAgICAgICAgIGl0ZW06IFJlY29yZE1hbmFnZXIud2VhcG9uc1tpZF0sCiAgICAgICAgICAgICAgY291bnQ6IDAKICAgICAgICAgICAgfTsKICAgICAgICAgIH0KICAgICAgICAgIHJlc3VsdCA9IHRoaXMud2VhcG9uc1tpZF07CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDI6CiAgICAgICAgICBpZiAodGhpcy5hcm1vcnNbaWRdID09IG51bGwpIHsKICAgICAgICAgICAgdGhpcy5hcm1vcnNbaWRdID0gewogICAgICAgICAgICAgIGl0ZW06IFJlY29yZE1hbmFnZXIuYXJtb3JzW2lkXSwKICAgICAgICAgICAgICBjb3VudDogMAogICAgICAgICAgICB9OwogICAgICAgICAgfQogICAgICAgICAgcmVzdWx0ID0gdGhpcy5hcm1vcnNbaWRdOwogICAgICB9CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9OwoKICAgIHJldHVybiBMb2dpY19JbnZlbnRvcnk7CgogIH0pKCk7CgogIHdpbmRvdy5Mb2dpY19JbnZlbnRvcnkgPSBMb2dpY19JbnZlbnRvcnk7Cgp9KS5jYWxsKHRoaXMpOwo="},{"name":"Logic_Animation","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogTG9naWNfQW5pbWF0aW9uCiMgICBDcmVhdGVkIG9uOiAyMDEzLTA5LTI5CiMKIyAgIENvcHlyaWdodCAoQykgMjAxMyBBbmRy6SBSYWRvbXNraS4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KIwojICAgQ2xhc3M6IExvZ2ljX0FuaW1hdGlvbgojCiMgICBBIGJhc2UgY2xhc3MgZm9yIGFsbCBvdGhlciB3aW5kb3cgY2xhc3Nlcy4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCmNsYXNzIExvZ2ljX0FuaW1hdGlvbgogICAgY29uc3RydWN0b3I6IChyZWNvcmQpIC0+CiAgICAgICAgQHJlY29yZCA9IHJlY29yZAogICAgICAgIEBmcmFtZXMgPSByZWNvcmQuZnJhbWVzCiAgICAgICAgQGZyYW1lQ291bnQgPSByZWNvcmQubWF4RnJhbWVzCiAgICAgICAgQGdyYXBoaWMxID0gcmVjb3JkLmdyYXBoaWMxCiAgICAgICAgQGdyYXBoaWMyID0gcmVjb3JkLmdyYXBoaWMyCiAgICAgICAgQGVmZmVjdHMgPSByZWNvcmQuZWZmZWN0cwogICAgICAgIEBjdXJyZW50RnJhbWUgPSBAZnJhbWVzWzBdCiAgICAgICAgQGN1cnJlbnRFZmZlY3QgPSBudWxsCiAgICAgICAgQHJlcGVhdCA9IG5vCiAgICAgICAgQGZyYW1lRHVyYXRpb24gPSA0CiAgICAgICAgQGZyYW1lQ291bnRlciA9IDAKICAgICAgICBAZHVyYXRpb24gPSBAZnJhbWVEdXJhdGlvbiAqIEBmcmFtZXMubGVuZ3RoCiAgICAgICAgQGlzUnVubmluZyA9IG5vCiAgICAgICAgQGxhc3RFZmZlY3QgPSBudWxsCiAgICBzdGFydDogLT4KICAgICAgICBAaXNSdW5uaW5nID0geWVzCiAgICAgICAgCiAgICB1cGRhdGU6IC0+CiAgICAgICAgaWYgbm90IEBpc1J1bm5pbmcgdGhlbiByZXR1cm4KICAgICAgICAKICAgICAgICBpZiBAZnJhbWVDb3VudGVyID49IEBkdXJhdGlvbgogICAgICAgICAgICBpZiBAcmVwZWF0CiAgICAgICAgICAgICAgICBAZnJhbWVDb3VudGVyID0gMAogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBAaXNSdW5uaW5nID0gbm8KICAgICAgICAgICAgICAgIHJldHVybgogICAKICAgICAgICBmcmFtZUluZGV4ID0gTWF0aC5mbG9vcihAZnJhbWVDb3VudGVyIC8gQGZyYW1lRHVyYXRpb24pCiAgICAgICAgQGN1cnJlbnRGcmFtZSA9IEBmcmFtZXNbZnJhbWVJbmRleF0KICAgICAgICBAY3VycmVudEVmZmVjdCA9IG51bGwKICAgICAgICAKICAgICAgICBpZiBAZWZmZWN0cz8KICAgICAgICAgICAgZm9yIGkgaW4gWzAuLi5AZWZmZWN0cy5sZW5ndGhdCiAgICAgICAgICAgICAgICBpZiAoQGVmZmVjdHNbaV0uZnJhbWUgKiA0KSA8PSAoQGZyYW1lQ291bnRlcikgYW5kICgoQGZyYW1lQ291bnRlciAtIChAZWZmZWN0c1tpXS5mcmFtZSAqIDQpKSA8IEBlZmZlY3RzW2ldLmR1cmF0aW9uICogNCkgCiAgICAgICAgICAgICAgICAgICAgaWYgQGxhc3RFZmZlY3QgIT0gQGVmZmVjdHNbaV0KICAgICAgICAgICAgICAgICAgICAgICAgQGN1cnJlbnRFZmZlY3QgPSBAZWZmZWN0c1tpXQogICAgICAgICAgICAgICAgICAgICAgICBAbGFzdEVmZmVjdCA9IEBjdXJyZW50RWZmZWN0CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIEBjdXJyZW50RWZmZWN0LnNvdW5kLm5hbWUubGVuZ3RoID4gMAogICAgICAgICAgICAgICAgICAgICAgICAgICAgQXVkaW9NYW5hZ2VyLnBsYXlTb3VuZChAY3VycmVudEVmZmVjdC5zb3VuZCkKICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAKICAgICAgICAKICAgICAgICBAZnJhbWVDb3VudGVyKysKICAgICAgICAKICAgICAgICAKCiAKICAgICAgICAKd2luZG93LkxvZ2ljX0FuaW1hdGlvbiA9IExvZ2ljX0FuaW1hdGlvbg==","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBMb2dpY19BbmltYXRpb247CgogIExvZ2ljX0FuaW1hdGlvbiA9IChmdW5jdGlvbigpIHsKICAgIGZ1bmN0aW9uIExvZ2ljX0FuaW1hdGlvbihyZWNvcmQpIHsKICAgICAgdGhpcy5yZWNvcmQgPSByZWNvcmQ7CiAgICAgIHRoaXMuZnJhbWVzID0gcmVjb3JkLmZyYW1lczsKICAgICAgdGhpcy5mcmFtZUNvdW50ID0gcmVjb3JkLm1heEZyYW1lczsKICAgICAgdGhpcy5ncmFwaGljMSA9IHJlY29yZC5ncmFwaGljMTsKICAgICAgdGhpcy5ncmFwaGljMiA9IHJlY29yZC5ncmFwaGljMjsKICAgICAgdGhpcy5lZmZlY3RzID0gcmVjb3JkLmVmZmVjdHM7CiAgICAgIHRoaXMuY3VycmVudEZyYW1lID0gdGhpcy5mcmFtZXNbMF07CiAgICAgIHRoaXMuY3VycmVudEVmZmVjdCA9IG51bGw7CiAgICAgIHRoaXMucmVwZWF0ID0gZmFsc2U7CiAgICAgIHRoaXMuZnJhbWVEdXJhdGlvbiA9IDQ7CiAgICAgIHRoaXMuZnJhbWVDb3VudGVyID0gMDsKICAgICAgdGhpcy5kdXJhdGlvbiA9IHRoaXMuZnJhbWVEdXJhdGlvbiAqIHRoaXMuZnJhbWVzLmxlbmd0aDsKICAgICAgdGhpcy5pc1J1bm5pbmcgPSBmYWxzZTsKICAgICAgdGhpcy5sYXN0RWZmZWN0ID0gbnVsbDsKICAgIH0KCiAgICBMb2dpY19BbmltYXRpb24ucHJvdG90eXBlLnN0YXJ0ID0gZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiB0aGlzLmlzUnVubmluZyA9IHRydWU7CiAgICB9OwoKICAgIExvZ2ljX0FuaW1hdGlvbi5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBmcmFtZUluZGV4LCBpLCBfaSwgX3JlZjsKICAgICAgaWYgKCF0aGlzLmlzUnVubmluZykgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBpZiAodGhpcy5mcmFtZUNvdW50ZXIgPj0gdGhpcy5kdXJhdGlvbikgewogICAgICAgIGlmICh0aGlzLnJlcGVhdCkgewogICAgICAgICAgdGhpcy5mcmFtZUNvdW50ZXIgPSAwOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLmlzUnVubmluZyA9IGZhbHNlOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgfQogICAgICBmcmFtZUluZGV4ID0gTWF0aC5mbG9vcih0aGlzLmZyYW1lQ291bnRlciAvIHRoaXMuZnJhbWVEdXJhdGlvbik7CiAgICAgIHRoaXMuY3VycmVudEZyYW1lID0gdGhpcy5mcmFtZXNbZnJhbWVJbmRleF07CiAgICAgIHRoaXMuY3VycmVudEVmZmVjdCA9IG51bGw7CiAgICAgIGlmICh0aGlzLmVmZmVjdHMgIT0gbnVsbCkgewogICAgICAgIGZvciAoaSA9IF9pID0gMCwgX3JlZiA9IHRoaXMuZWZmZWN0cy5sZW5ndGg7IDAgPD0gX3JlZiA/IF9pIDwgX3JlZiA6IF9pID4gX3JlZjsgaSA9IDAgPD0gX3JlZiA/ICsrX2kgOiAtLV9pKSB7CiAgICAgICAgICBpZiAoKHRoaXMuZWZmZWN0c1tpXS5mcmFtZSAqIDQpIDw9IHRoaXMuZnJhbWVDb3VudGVyICYmICgodGhpcy5mcmFtZUNvdW50ZXIgLSAodGhpcy5lZmZlY3RzW2ldLmZyYW1lICogNCkpIDwgdGhpcy5lZmZlY3RzW2ldLmR1cmF0aW9uICogNCkpIHsKICAgICAgICAgICAgaWYgKHRoaXMubGFzdEVmZmVjdCAhPT0gdGhpcy5lZmZlY3RzW2ldKSB7CiAgICAgICAgICAgICAgdGhpcy5jdXJyZW50RWZmZWN0ID0gdGhpcy5lZmZlY3RzW2ldOwogICAgICAgICAgICAgIHRoaXMubGFzdEVmZmVjdCA9IHRoaXMuY3VycmVudEVmZmVjdDsKICAgICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50RWZmZWN0LnNvdW5kLm5hbWUubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgQXVkaW9NYW5hZ2VyLnBsYXlTb3VuZCh0aGlzLmN1cnJlbnRFZmZlY3Quc291bmQpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHRoaXMuZnJhbWVDb3VudGVyKys7CiAgICB9OwoKICAgIHJldHVybiBMb2dpY19BbmltYXRpb247CgogIH0pKCk7CgogIHdpbmRvdy5Mb2dpY19BbmltYXRpb24gPSBMb2dpY19BbmltYXRpb247Cgp9KS5jYWxsKHRoaXMpOwo="},{"name":"Logic_SimpleAnimation","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogTG9naWNfU2ltcGxlQW5pbWF0aW9uCiMgICBDcmVhdGVkIG9uOiAyMDEzLTEwLTEzCiMKIyAgIENvcHlyaWdodCAoQykgMjAxMyBBbmRy6SBSYWRvbXNraS4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KIwojICAgQ2xhc3M6IExvZ2ljX1NpbXBsZUFuaW1hdGlvbgojCiMgICBBIGJhc2UgY2xhc3MgZm9yIGFsbCBvdGhlciB3aW5kb3cgY2xhc3Nlcy4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCmNsYXNzIExvZ2ljX1NpbXBsZUFuaW1hdGlvbgogICAgY29uc3RydWN0b3I6IChyZWNvcmQpIC0+CiAgICAgICAgQHJlY29yZCA9IHJlY29yZAogICAgICAgIEByZWZyZXNoKHJlY29yZCkKICAgICAgICAKICAgIHJlZnJlc2g6IChyZWNvcmQpIC0+CiAgICAgICAgQG5hbWUgPSByZWNvcmQubmFtZQogICAgICAgIEBmcmFtZXNYID0gcmVjb3JkLmZyYW1lc1ggfHwgMQogICAgICAgIEBmcmFtZXNZID0gcmVjb3JkLmZyYW1lc1kgfHwgMQogICAgICAgIEBmcmFtZVJhbmdlID0gaWYgcmVjb3JkLnVzZUZyYW1lUmFuZ2UgdGhlbiByZWNvcmQuZnJhbWVSYW5nZSBlbHNlIHsgc3RhcnQ6IDAsIGVuZDogKEBmcmFtZXNYICogQGZyYW1lc1kpLTEgfQogICAgICAgIEByZXBldGl0aW9uRnJhbWVSYW5nZSA9IGlmIHJlY29yZC51c2VSZXBldGl0aW9uRnJhbWVSYW5nZSBhbmQgcmVjb3JkLnJlcGV0aXRpb25GcmFtZVJhbmdlPyB0aGVuIHJlY29yZC5yZXBldGl0aW9uRnJhbWVSYW5nZSBlbHNlIEBmcmFtZVJhbmdlCiAgICAgICAgQGZyYW1lQ291bnQgPSAoQGZyYW1lUmFuZ2UuZW5kIC0gQGZyYW1lUmFuZ2Uuc3RhcnQpICsgMQogICAgICAgIEBncmFwaGljID0gcmVjb3JkLmdyYXBoaWMKICAgICAgICBAcmVwZWF0ID0gcmVjb3JkLnJlcGVhdCB8fCBubwogICAgICAgIEBwb3NpdGlvbiA9IHJlY29yZC5wb3NpdGlvbgoKICAgICAgICBAZnJhbWVEdXJhdGlvbiA9IGlmIHJlY29yZC5kdXJhdGlvbj8gdGhlbiBNYXRoLnJvdW5kKHJlY29yZC5kdXJhdGlvbiAvIEBmcmFtZUNvdW50KSBlbHNlIDEwCiAgICAgICAgQGZyYW1lQ291bnRlciA9IDAKICAgICAgICBAZHVyYXRpb24gPSByZWNvcmQuZHVyYXRpb24gfHwgMTAKICAgICAgICBAaXNSdW5uaW5nID0gbm8KICAgICAgICBAcGF0dGVybk9mZnNldCA9IEBmcmFtZVJhbmdlLnN0YXJ0CiAgICAgICAgQHBhdHRlcm4gPSBAcGF0dGVybk9mZnNldAogICAgICAgIEBmaXJzdFJ1biA9IHllcwogICAgc3RhcnQ6IC0+CiAgICAgICAgQGlzUnVubmluZyA9IHllcwogICAgICAgIEBmaXJzdFJ1biA9IHllcwogICAgICAgIEBmcmFtZUNvdW50ZXIgPSAwCiAgICAgICAgQGZyYW1lQ291bnQgPSAoQGZyYW1lUmFuZ2UuZW5kIC0gQGZyYW1lUmFuZ2Uuc3RhcnQpICsgMQogICAgICAgIEBmcmFtZUR1cmF0aW9uID0gTWF0aC5yb3VuZChAZHVyYXRpb24gLyBAZnJhbWVDb3VudCkKICAgICAgICBAcGF0dGVybk9mZnNldCA9IEBmcmFtZVJhbmdlLnN0YXJ0CiAgICB1cGRhdGU6IC0+CiAgICAgICAgaWYgbm90IEBpc1J1bm5pbmcgdGhlbiByZXR1cm4KICAgICAgICAKICAgICAgICBpZiBAZnJhbWVDb3VudGVyID49IEBkdXJhdGlvbgogICAgICAgICAgICBpZiBAcmVwZWF0CiAgICAgICAgICAgICAgICBAZmlyc3RSdW4gPSBubwogICAgICAgICAgICAgICAgQGZyYW1lQ291bnRlciA9IDAKICAgICAgICAgICAgICAgIEBmcmFtZUNvdW50ID0gKEByZXBldGl0aW9uRnJhbWVSYW5nZS5lbmQgLSBAcmVwZXRpdGlvbkZyYW1lUmFuZ2Uuc3RhcnQpICsgMQogICAgICAgICAgICAgICAgQGZyYW1lRHVyYXRpb24gPSBNYXRoLnJvdW5kKEBkdXJhdGlvbiAvIEBmcmFtZUNvdW50KQogICAgICAgICAgICAgICAgQHBhdHRlcm5PZmZzZXQgPSBAcmVwZXRpdGlvbkZyYW1lUmFuZ2Uuc3RhcnQKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgQGlzUnVubmluZyA9IG5vCiAgICAgICAgICAgICAgICBpZiBAb25GaW5pc2g/IHRoZW4gQG9uRmluaXNoKHRoaXMpCiAgICAgICAgICAgICAgICByZXR1cm4KCiAgICAgICAgCiAgICAgICAgQHBhdHRlcm4gPSBAcGF0dGVybk9mZnNldCArIE1hdGguZmxvb3IoQGZyYW1lQ291bnRlciAvIEBmcmFtZUR1cmF0aW9uKSAgCiAgICAgICAgQGZyYW1lQ291bnRlcisrCiAgICAgICAgCiAgICAgICAgCgogCiAgICAgICAgCndpbmRvdy5Mb2dpY19TaW1wbGVBbmltYXRpb24gPSBMb2dpY19TaW1wbGVBbmltYXRpb24=","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBMb2dpY19TaW1wbGVBbmltYXRpb247CgogIExvZ2ljX1NpbXBsZUFuaW1hdGlvbiA9IChmdW5jdGlvbigpIHsKICAgIGZ1bmN0aW9uIExvZ2ljX1NpbXBsZUFuaW1hdGlvbihyZWNvcmQpIHsKICAgICAgdGhpcy5yZWNvcmQgPSByZWNvcmQ7CiAgICAgIHRoaXMucmVmcmVzaChyZWNvcmQpOwogICAgfQoKICAgIExvZ2ljX1NpbXBsZUFuaW1hdGlvbi5wcm90b3R5cGUucmVmcmVzaCA9IGZ1bmN0aW9uKHJlY29yZCkgewogICAgICB0aGlzLm5hbWUgPSByZWNvcmQubmFtZTsKICAgICAgdGhpcy5mcmFtZXNYID0gcmVjb3JkLmZyYW1lc1ggfHwgMTsKICAgICAgdGhpcy5mcmFtZXNZID0gcmVjb3JkLmZyYW1lc1kgfHwgMTsKICAgICAgdGhpcy5mcmFtZVJhbmdlID0gcmVjb3JkLnVzZUZyYW1lUmFuZ2UgPyByZWNvcmQuZnJhbWVSYW5nZSA6IHsKICAgICAgICBzdGFydDogMCwKICAgICAgICBlbmQ6ICh0aGlzLmZyYW1lc1ggKiB0aGlzLmZyYW1lc1kpIC0gMQogICAgICB9OwogICAgICB0aGlzLnJlcGV0aXRpb25GcmFtZVJhbmdlID0gcmVjb3JkLnVzZVJlcGV0aXRpb25GcmFtZVJhbmdlICYmIChyZWNvcmQucmVwZXRpdGlvbkZyYW1lUmFuZ2UgIT0gbnVsbCkgPyByZWNvcmQucmVwZXRpdGlvbkZyYW1lUmFuZ2UgOiB0aGlzLmZyYW1lUmFuZ2U7CiAgICAgIHRoaXMuZnJhbWVDb3VudCA9ICh0aGlzLmZyYW1lUmFuZ2UuZW5kIC0gdGhpcy5mcmFtZVJhbmdlLnN0YXJ0KSArIDE7CiAgICAgIHRoaXMuZ3JhcGhpYyA9IHJlY29yZC5ncmFwaGljOwogICAgICB0aGlzLnJlcGVhdCA9IHJlY29yZC5yZXBlYXQgfHwgZmFsc2U7CiAgICAgIHRoaXMucG9zaXRpb24gPSByZWNvcmQucG9zaXRpb247CiAgICAgIHRoaXMuZnJhbWVEdXJhdGlvbiA9IHJlY29yZC5kdXJhdGlvbiAhPSBudWxsID8gTWF0aC5yb3VuZChyZWNvcmQuZHVyYXRpb24gLyB0aGlzLmZyYW1lQ291bnQpIDogMTA7CiAgICAgIHRoaXMuZnJhbWVDb3VudGVyID0gMDsKICAgICAgdGhpcy5kdXJhdGlvbiA9IHJlY29yZC5kdXJhdGlvbiB8fCAxMDsKICAgICAgdGhpcy5pc1J1bm5pbmcgPSBmYWxzZTsKICAgICAgdGhpcy5wYXR0ZXJuT2Zmc2V0ID0gdGhpcy5mcmFtZVJhbmdlLnN0YXJ0OwogICAgICB0aGlzLnBhdHRlcm4gPSB0aGlzLnBhdHRlcm5PZmZzZXQ7CiAgICAgIHJldHVybiB0aGlzLmZpcnN0UnVuID0gdHJ1ZTsKICAgIH07CgogICAgTG9naWNfU2ltcGxlQW5pbWF0aW9uLnByb3RvdHlwZS5zdGFydCA9IGZ1bmN0aW9uKCkgewogICAgICB0aGlzLmlzUnVubmluZyA9IHRydWU7CiAgICAgIHRoaXMuZmlyc3RSdW4gPSB0cnVlOwogICAgICB0aGlzLmZyYW1lQ291bnRlciA9IDA7CiAgICAgIHRoaXMuZnJhbWVDb3VudCA9ICh0aGlzLmZyYW1lUmFuZ2UuZW5kIC0gdGhpcy5mcmFtZVJhbmdlLnN0YXJ0KSArIDE7CiAgICAgIHRoaXMuZnJhbWVEdXJhdGlvbiA9IE1hdGgucm91bmQodGhpcy5kdXJhdGlvbiAvIHRoaXMuZnJhbWVDb3VudCk7CiAgICAgIHJldHVybiB0aGlzLnBhdHRlcm5PZmZzZXQgPSB0aGlzLmZyYW1lUmFuZ2Uuc3RhcnQ7CiAgICB9OwoKICAgIExvZ2ljX1NpbXBsZUFuaW1hdGlvbi5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKSB7CiAgICAgIGlmICghdGhpcy5pc1J1bm5pbmcpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgaWYgKHRoaXMuZnJhbWVDb3VudGVyID49IHRoaXMuZHVyYXRpb24pIHsKICAgICAgICBpZiAodGhpcy5yZXBlYXQpIHsKICAgICAgICAgIHRoaXMuZmlyc3RSdW4gPSBmYWxzZTsKICAgICAgICAgIHRoaXMuZnJhbWVDb3VudGVyID0gMDsKICAgICAgICAgIHRoaXMuZnJhbWVDb3VudCA9ICh0aGlzLnJlcGV0aXRpb25GcmFtZVJhbmdlLmVuZCAtIHRoaXMucmVwZXRpdGlvbkZyYW1lUmFuZ2Uuc3RhcnQpICsgMTsKICAgICAgICAgIHRoaXMuZnJhbWVEdXJhdGlvbiA9IE1hdGgucm91bmQodGhpcy5kdXJhdGlvbiAvIHRoaXMuZnJhbWVDb3VudCk7CiAgICAgICAgICB0aGlzLnBhdHRlcm5PZmZzZXQgPSB0aGlzLnJlcGV0aXRpb25GcmFtZVJhbmdlLnN0YXJ0OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLmlzUnVubmluZyA9IGZhbHNlOwogICAgICAgICAgaWYgKHRoaXMub25GaW5pc2ggIT0gbnVsbCkgewogICAgICAgICAgICB0aGlzLm9uRmluaXNoKHRoaXMpOwogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgfQogICAgICB0aGlzLnBhdHRlcm4gPSB0aGlzLnBhdHRlcm5PZmZzZXQgKyBNYXRoLmZsb29yKHRoaXMuZnJhbWVDb3VudGVyIC8gdGhpcy5mcmFtZUR1cmF0aW9uKTsKICAgICAgcmV0dXJuIHRoaXMuZnJhbWVDb3VudGVyKys7CiAgICB9OwoKICAgIHJldHVybiBMb2dpY19TaW1wbGVBbmltYXRpb247CgogIH0pKCk7CgogIHdpbmRvdy5Mb2dpY19TaW1wbGVBbmltYXRpb24gPSBMb2dpY19TaW1wbGVBbmltYXRpb247Cgp9KS5jYWxsKHRoaXMpOwo="},{"name":"Logic_MovableAnimation","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogTG9naWNfTW92YWJsZUFuaW1hdGlvbgojICAgQ3JlYXRlZCBvbjogMjAxMy0xMC0xMwojCiMgICBDb3B5cmlnaHQgKEMpIDIwMTMgQW5kcukgUmFkb21za2kuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIENsYXNzOiBMb2dpY19TaW1wbGVBbmltYXRpb24KIwojICAgQSBiYXNlIGNsYXNzIGZvciBhbGwgb3RoZXIgd2luZG93IGNsYXNzZXMuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpjbGFzcyBMb2dpY19Nb3ZhYmxlQW5pbWF0aW9uIGV4dGVuZHMgTG9naWNfU2ltcGxlQW5pbWF0aW9uCiAgICBjb25zdHJ1Y3RvcjogKHJlY29yZCkgLT4KICAgICAgICBzdXBlcihyZWNvcmQpCiAgICAgICAgQHNvdXJjZSA9IG51bGwKICAgICAgICBAdGFyZ2V0ID0gbnVsbAogICAgICAgIEBtb3ZlRHVyYXRpb24gPSByZWNvcmQubW92ZUR1cmF0aW9uIHx8IDYwCiAgICBzdGFydDogLT4KICAgICAgICBzdXBlcgogICAgICAKICAgICAgICBAeCA9IEBzb3VyY2UueAogICAgICAgIEB5ID0gQHNvdXJjZS55CiAgICAgICAgQHRpbWUgPSBAbW92ZUR1cmF0aW9uCiAgICAgICAgQHZ4ID0gKChAdGFyZ2V0LnggLSBAc291cmNlLngpIC8gQHRpbWUpCiAgICAgICAgQHZ5ID0gKChAdGFyZ2V0LnkgLSBAc291cmNlLnkpIC8gQHRpbWUpCiAgICAgICAgQGlzUnVubmluZyA9IHllcwogICAgICAgIAogICAgdXBkYXRlOiAtPgogICAgICAgIHN1cGVyCiAgICAgICAgaWYgbm90IEBpc1J1bm5pbmcgdGhlbiByZXR1cm4KCiAgICAgICAgQGZpcnN0UnVuID0geWVzCiAgICAgICAgQHggKz0gQHZ4CiAgICAgICAgQHkgKz0gQHZ5CiAgICAgICAgCiAgICAgICAgQHRpbWUtLQogICAgICAgIAogICAgICAgIGlmIEB0aW1lIDw9IDAKICAgICAgICAgICAgQGlzUnVubmluZyA9IG5vCiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJOT08iKQoKICAgICAgICAKICAgICAgICAKCiAKICAgICAgICAKd2luZG93LkxvZ2ljX01vdmFibGVBbmltYXRpb24gPSBMb2dpY19Nb3ZhYmxlQW5pbWF0aW9u","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBMb2dpY19Nb3ZhYmxlQW5pbWF0aW9uLAogICAgX19oYXNQcm9wID0ge30uaGFzT3duUHJvcGVydHksCiAgICBfX2V4dGVuZHMgPSBmdW5jdGlvbihjaGlsZCwgcGFyZW50KSB7IGZvciAodmFyIGtleSBpbiBwYXJlbnQpIHsgaWYgKF9faGFzUHJvcC5jYWxsKHBhcmVudCwga2V5KSkgY2hpbGRba2V5XSA9IHBhcmVudFtrZXldOyB9IGZ1bmN0aW9uIGN0b3IoKSB7IHRoaXMuY29uc3RydWN0b3IgPSBjaGlsZDsgfSBjdG9yLnByb3RvdHlwZSA9IHBhcmVudC5wcm90b3R5cGU7IGNoaWxkLnByb3RvdHlwZSA9IG5ldyBjdG9yKCk7IGNoaWxkLl9fc3VwZXJfXyA9IHBhcmVudC5wcm90b3R5cGU7IHJldHVybiBjaGlsZDsgfTsKCiAgTG9naWNfTW92YWJsZUFuaW1hdGlvbiA9IChmdW5jdGlvbihfc3VwZXIpIHsKICAgIF9fZXh0ZW5kcyhMb2dpY19Nb3ZhYmxlQW5pbWF0aW9uLCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIExvZ2ljX01vdmFibGVBbmltYXRpb24ocmVjb3JkKSB7CiAgICAgIExvZ2ljX01vdmFibGVBbmltYXRpb24uX19zdXBlcl9fLmNvbnN0cnVjdG9yLmNhbGwodGhpcywgcmVjb3JkKTsKICAgICAgdGhpcy5zb3VyY2UgPSBudWxsOwogICAgICB0aGlzLnRhcmdldCA9IG51bGw7CiAgICAgIHRoaXMubW92ZUR1cmF0aW9uID0gcmVjb3JkLm1vdmVEdXJhdGlvbiB8fCA2MDsKICAgIH0KCiAgICBMb2dpY19Nb3ZhYmxlQW5pbWF0aW9uLnByb3RvdHlwZS5zdGFydCA9IGZ1bmN0aW9uKCkgewogICAgICBMb2dpY19Nb3ZhYmxlQW5pbWF0aW9uLl9fc3VwZXJfXy5zdGFydC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB0aGlzLnggPSB0aGlzLnNvdXJjZS54OwogICAgICB0aGlzLnkgPSB0aGlzLnNvdXJjZS55OwogICAgICB0aGlzLnRpbWUgPSB0aGlzLm1vdmVEdXJhdGlvbjsKICAgICAgdGhpcy52eCA9ICh0aGlzLnRhcmdldC54IC0gdGhpcy5zb3VyY2UueCkgLyB0aGlzLnRpbWU7CiAgICAgIHRoaXMudnkgPSAodGhpcy50YXJnZXQueSAtIHRoaXMuc291cmNlLnkpIC8gdGhpcy50aW1lOwogICAgICByZXR1cm4gdGhpcy5pc1J1bm5pbmcgPSB0cnVlOwogICAgfTsKCiAgICBMb2dpY19Nb3ZhYmxlQW5pbWF0aW9uLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpIHsKICAgICAgTG9naWNfTW92YWJsZUFuaW1hdGlvbi5fX3N1cGVyX18udXBkYXRlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIGlmICghdGhpcy5pc1J1bm5pbmcpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdGhpcy5maXJzdFJ1biA9IHRydWU7CiAgICAgIHRoaXMueCArPSB0aGlzLnZ4OwogICAgICB0aGlzLnkgKz0gdGhpcy52eTsKICAgICAgdGhpcy50aW1lLS07CiAgICAgIGlmICh0aGlzLnRpbWUgPD0gMCkgewogICAgICAgIHRoaXMuaXNSdW5uaW5nID0gZmFsc2U7CiAgICAgICAgcmV0dXJuIGNvbnNvbGUubG9nKCJOT08iKTsKICAgICAgfQogICAgfTsKCiAgICByZXR1cm4gTG9naWNfTW92YWJsZUFuaW1hdGlvbjsKCiAgfSkoTG9naWNfU2ltcGxlQW5pbWF0aW9uKTsKCiAgd2luZG93LkxvZ2ljX01vdmFibGVBbmltYXRpb24gPSBMb2dpY19Nb3ZhYmxlQW5pbWF0aW9uOwoKfSkuY2FsbCh0aGlzKTsK"},{"name":"Logic_TextAnimation","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogTG9naWNfVGV4dEFuaW1hdGlvbgojICAgQ3JlYXRlZCBvbjogMjAxMy0xMC0xOQojCiMgICBDb3B5cmlnaHQgKEMpIDIwMTMgQW5kcukgUmFkb21za2kuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIENsYXNzOiBMb2dpY19UZXh0QW5pbWF0aW9uCiMKIyAgIEEgYmFzZSBjbGFzcyBmb3IgYWxsIG90aGVyIHdpbmRvdyBjbGFzc2VzLgojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKY2xhc3MgTG9naWNfVGV4dEFuaW1hdGlvbgogICAgY29uc3RydWN0b3I6ICh0ZXh0LCBjb2xvcikgLT4KICAgICAgICBAdGV4dCA9IHRleHQgfHwgIiIKICAgICAgICBAY29sb3IgPSBjb2xvciB8fCBDb2xvcnMuV0hJVEUKICAgICAgICBAcmVwZWF0ID0gbm8KICAgICAgICBAaXNSdW5uaW5nID0gbm8KICAgICAgICBAZHVyYXRpb24gPSAwCiAgICAgICAgQHggPSAwCiAgICAgICAgQHkgPSAwCiAgICAgICAgQG9wYWNpdHkgPSAyNTUKICAgIHN0YXJ0OiAtPgogICAgICAgIEBvcGFjaXR5ID0gMjU1CiAgICAgICAgQGlzUnVubmluZyA9IHllcwogICAgICAgIAogICAgdXBkYXRlOiAtPgogICAgICAgIGlmIG5vdCBAaXNSdW5uaW5nIHRoZW4gcmV0dXJuCiAgICAgICAgCiAgICAgICAgaWYgQG9wYWNpdHkgPT0gMAogICAgICAgICAgICBpZiBAcmVwZWF0CiAgICAgICAgICAgICAgICBAc3RhcnQoKQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBAaXNSdW5uaW5nID0gbm8KICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgIAogICAgICAgIEBvcGFjaXR5ID0gTWF0aC5tYXgoQG9wYWNpdHkgLSA0LCAwKQogICAgICAgIEB5IC09IDIKICAgICAgICAKICAgICAgICAKCiAKICAgICAgICAKd2luZG93LkxvZ2ljX1RleHRBbmltYXRpb24gPSBMb2dpY19UZXh0QW5pbWF0aW9u","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBMb2dpY19UZXh0QW5pbWF0aW9uOwoKICBMb2dpY19UZXh0QW5pbWF0aW9uID0gKGZ1bmN0aW9uKCkgewogICAgZnVuY3Rpb24gTG9naWNfVGV4dEFuaW1hdGlvbih0ZXh0LCBjb2xvcikgewogICAgICB0aGlzLnRleHQgPSB0ZXh0IHx8ICIiOwogICAgICB0aGlzLmNvbG9yID0gY29sb3IgfHwgQ29sb3JzLldISVRFOwogICAgICB0aGlzLnJlcGVhdCA9IGZhbHNlOwogICAgICB0aGlzLmlzUnVubmluZyA9IGZhbHNlOwogICAgICB0aGlzLmR1cmF0aW9uID0gMDsKICAgICAgdGhpcy54ID0gMDsKICAgICAgdGhpcy55ID0gMDsKICAgICAgdGhpcy5vcGFjaXR5ID0gMjU1OwogICAgfQoKICAgIExvZ2ljX1RleHRBbmltYXRpb24ucHJvdG90eXBlLnN0YXJ0ID0gZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMub3BhY2l0eSA9IDI1NTsKICAgICAgcmV0dXJuIHRoaXMuaXNSdW5uaW5nID0gdHJ1ZTsKICAgIH07CgogICAgTG9naWNfVGV4dEFuaW1hdGlvbi5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKSB7CiAgICAgIGlmICghdGhpcy5pc1J1bm5pbmcpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgaWYgKHRoaXMub3BhY2l0eSA9PT0gMCkgewogICAgICAgIGlmICh0aGlzLnJlcGVhdCkgewogICAgICAgICAgdGhpcy5zdGFydCgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLmlzUnVubmluZyA9IGZhbHNlOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgfQogICAgICB0aGlzLm9wYWNpdHkgPSBNYXRoLm1heCh0aGlzLm9wYWNpdHkgLSA0LCAwKTsKICAgICAgcmV0dXJuIHRoaXMueSAtPSAyOwogICAgfTsKCiAgICByZXR1cm4gTG9naWNfVGV4dEFuaW1hdGlvbjsKCiAgfSkoKTsKCiAgd2luZG93LkxvZ2ljX1RleHRBbmltYXRpb24gPSBMb2dpY19UZXh0QW5pbWF0aW9uOwoKfSkuY2FsbCh0aGlzKTsK"},{"name":"Logic_Battler","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogTG9naWNfQmF0dGxlcgojICAgQ3JlYXRlZCBvbjogMjAxMy0wOS0yOQojCiMgICBDb3B5cmlnaHQgKEMpIDIwMTMgQW5kcukgUmFkb21za2kuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIENsYXNzOiBMb2dpY19CYXR0bGVyCiMKIyAgIEEgYmFzZSBjbGFzcyBmb3IgYWxsIG90aGVyIHdpbmRvdyBjbGFzc2VzLgojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKY2xhc3MgTG9naWNfQmF0dGxlcgogICAgY29uc3RydWN0b3I6IChhY3RvcikgLT4KICAgICAgICBAYWN0b3IgPSBhY3RvcgogICAgICAgIEBhbmltYXRpb25zID0gW1tdLCBbXSwgW10sIFtdLCBbXSwgW10sIFtdLCBbXV0KICAgICAgICBAeCA9IDAKICAgICAgICBAeSA9IDAKICAgICAgICBAZGVhZCA9IG5vCiAgICAgICAgQGdyYXBoaWMgPSBudWxsCiAgICAgICAgQHRhcmdldHMgPSBbXQogICAgICAgIEBpc0FuaW1hdGlvblJ1bm5pbmcgPSBubwogICAgICAgIEBpc0hpZGRlbiA9IG5vCiAgICAgICAgQGFuaW1hdGlvblBoYXNlID0gMAogICAgICAgIEBsYXN0QW5pbWF0aW9uUGhhc2UgPSAtMQogICAgICAgIEBjdXJyZW50QW5pbWF0aW9ucyA9IEBhbmltYXRpb25zWzBdCiAgICAgICAgQGN1cnJlbnRTa2lsbCA9IG51bGwKICAgICAgICBAYWN0aW9uUGF0dGVybnMgPSBAYWN0b3IuYWN0aW9uUGF0dGVybnMgfHwgW10KICAgICAgICBAbWVzc2FnZUNvbnRhaW5lciA9IG51bGwKICAgICAgICBAdm9jYWIgPSBSZWNvcmRNYW5hZ2VyLnZvY2FidWxhcnkKICAgICAgICBAYW5pbWF0aW9uUGhhc2VPZmZzZXQgPSAwCiAgICAgICAgZ3JhcGhpYyA9IEBhY3Rvci5ncmFwaGljIHx8IEBhY3Rvci5jaGFyYWN0ZXJHcmFwaGljCiAgICAgICAgaWYgZ3JhcGhpYz8gYW5kIGdyYXBoaWMubmFtZS5sZW5ndGggPiAwCiAgICAgICAgICAgIHJlY29yZCA9IAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBpbmRleDogLTEsCiAgICAgICAgICAgICAgICBuYW1lOiAiREVGQVVMVF9HRU5FUkFURUQiLAogICAgICAgICAgICAgICAgZ3JhcGhpYzogaWYgQGFjdG9yLmNoYXJhY3RlckdyYXBoaWM/IHRoZW4gbnVsbCBlbHNlIGdyYXBoaWMsCiAgICAgICAgICAgICAgICByZXBlYXQ6IHllcywKICAgICAgICAgICAgICAgIGZyYW1lc1g6IDEsCiAgICAgICAgICAgICAgICBmcmFtZXNZOiAxCiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIEBzdGFuZEFuaW1hdGlvbiA9IG5ldyBMb2dpY19TaW1wbGVBbmltYXRpb24ocmVjb3JkKQogICAgICAgICAgICBAc3RhbmRBbmltYXRpb24ucmVjb3JkLnJlcGVhdCA9IHllcwogICAgICAgICAgICBAc3RhbmRBbmltYXRpb24ucmVwZWF0ID0geWVzCiAgICAgICAgICAgIEBzdGFuZEFuaW1hdGlvbi5zdGFydCgpCiAgICAgICAgICAgIAogICAgICAgICAgICAKICAgICAgICBpZiBAYWN0b3Iuc3RhbmRBbmltYXRpb24/CiAgICAgICAgICAgIEBzdGFuZEFuaW1hdGlvbiA9IEBhY3Rvci5zdGFuZEFuaW1hdGlvbiAKICAgICAgICAgICAgQHN0YW5kQW5pbWF0aW9uLnJlY29yZC5yZXBlYXQgPSB5ZXMKICAgICAgICAgICAgQHN0YW5kQW5pbWF0aW9uLnJlcGVhdCA9IHllcwogICAgICAgICAgICBAc3RhbmRBbmltYXRpb24uc3RhcnQoKQogICAgICAgICAgICAKICAgICAgICAgICAgCiAgICBzZXRDdXJyZW50QW5pbWF0aW9uOiAoYW5pbWF0aW9uKSAtPgogICAgICAgIEBzdGFuZEFuaW1hdGlvbi5yZWZyZXNoKGFuaW1hdGlvbi5yZWNvcmQpICAgICAgICAKICAgICAgICBAc3RhbmRBbmltYXRpb24uc3RhcnQoKQogICAgICAgIAogICAgcHJlcGFyZVNraWxsOiAoc2tpbGwpIC0+CiAgICAgICAgYW5pbWF0aW9uID0gbnVsbAogICAgICAgIGFpZCA9IHNraWxsLnByZXBhcmVBbmltYXRpb25JZAogICAgICAgIGlmIHNraWxsLmluZGV4ID09IDEKICAgICAgICAgICAgYW5pbWF0aW9uID0gQGFjdG9yLmd1YXJkQW5pbWF0aW9uCiAgICAgICAgZWxzZSBpZiBhaWQ/CiAgICAgICAgICAgIGFuaW1hdGlvbiA9IG5ldyBMb2dpY19TaW1wbGVBbmltYXRpb24oUmVjb3JkTWFuYWdlci5zaW1wbGVBbmltYXRpb25zW2FpZF0pCiAgICAgICAgZWxzZQogICAgICAgICAgICBzd2l0Y2ggc2tpbGwuaGl0VHlwZQogICAgICAgICAgICAgICAgd2hlbiAwCiAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uID0gQGFjdG9yLnByZUF0dGFja0FuaW1hdGlvbgogICAgICAgICAgICAgICAgd2hlbiAxCiAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uID0gQGFjdG9yLnByZUF0dGFja0FuaW1hdGlvbgogICAgICAgICAgICAgICAgd2hlbiAyCiAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uID0gQGFjdG9yLnByZU1hZ2ljQW5pbWF0aW9uCiAgICAgICAgICAgICAgICAKICAgICAgICBpZiBhbmltYXRpb24/CiAgICAgICAgICAgIEBzZXRDdXJyZW50QW5pbWF0aW9uKGFuaW1hdGlvbikKICAgICAgICAgICAgCiAgICBjYW5jZWxQcmVwYXJhdGlvbjogLT4KICAgICAgICBAc2V0Q3VycmVudEFuaW1hdGlvbihAc3RhbmRBbmltYXRpb24pCiAgICAgICAgICAgIAogICAgdXBkYXRlOiAtPgogICAgICAgIGlmIEBpc0hpZGRlbiB0aGVuIHJldHVybgogICAgICAgIAogICAgICAgIGlmIEBzdGFuZEFuaW1hdGlvbj8KICAgICAgICAgICAgQHN0YW5kQW5pbWF0aW9uLnVwZGF0ZSgpCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgaWYgQGFuaW1hdGlvblBoYXNlICE9IEBsYXN0QW5pbWF0aW9uUGhhc2UgYW5kCiAgICAgICAgICAgQGFuaW1hdGlvblBoYXNlIDwgQGFuaW1hdGlvbnMubGVuZ3RoCiAgICAgICAgICAgIGNoYW5nZWQgPSBubwogICAgICAgICAgICBAbGFzdEFuaW1hdGlvblBoYXNlID0gQGFuaW1hdGlvblBoYXNlCiAgICAgICAgICAgIGFuaW1hdGlvbnMgPSBAYW5pbWF0aW9uc1tAYW5pbWF0aW9uUGhhc2VdCiAgICAgICAgICAgIGlmIGFuaW1hdGlvbnM/CiAgICAgICAgICAgICAgICBmb3IgYW5pbWF0aW9uIGluIGFuaW1hdGlvbnMKICAgICAgICAgICAgICAgICAgICBpZiBhbmltYXRpb24/IGFuZCBhbmltYXRpb24udHlwZSA9PSAic2ltcGxlIgogICAgICAgICAgICAgICAgICAgICAgICBAc3RhbmRBbmltYXRpb24ucmVmcmVzaChhbmltYXRpb24uYW5pbWF0aW9uLnJlY29yZCkKICAgICAgICAgICAgICAgICAgICAgICAgQHN0YW5kQW5pbWF0aW9uLnN0YXJ0KCkKICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlZCA9IHllcwogICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgaWYgQGFuaW1hdGlvblBoYXNlID09IDAgYW5kIEBhY3Rvci5scCA+IDAKICAgICAgICAgICAgICAgIGJhZFN0YXR1cyA9IEBhY3Rvci5iYWRTdGF0dXMgYW5kIEBhY3Rvci5iYWRTdGF0dXNBbmltYXRpb24/CiAgICAgICAgICAgICAgICBpZiBiYWRTdGF0dXMgYW5kIEBzdGFuZEFuaW1hdGlvbi5uYW1lICE9IEBhY3Rvci5iYWRTdGF0dXNBbmltYXRpb24ubmFtZSAKICAgICAgICAgICAgICAgICAgICBAc3RhbmRBbmltYXRpb24ucmVmcmVzaChAYWN0b3IuYmFkU3RhdHVzQW5pbWF0aW9uLnJlY29yZCkKICAgICAgICAgICAgICAgICAgICBAc3RhbmRBbmltYXRpb24uc3RhcnQoKQogICAgICAgICAgICAgICAgaWYgbm90IGJhZFN0YXR1cyBhbmQgQGFjdG9yLmd1YXJkIGFuZCBAYWN0b3IuZ3VhcmRBbmltYXRpb24/IGFuZCBAc3RhbmRBbmltYXRpb24ubmFtZSAhPSBAYWN0b3IuZ3VhcmRBbmltYXRpb24ubmFtZSAKICAgICAgICAgICAgICAgICAgICBAc3RhbmRBbmltYXRpb24ucmVmcmVzaChAYWN0b3IuZ3VhcmRBbmltYXRpb24ucmVjb3JkKQogICAgICAgICAgICAgICAgICAgIEBzdGFuZEFuaW1hdGlvbi5zdGFydCgpCiAgICAgICAgICAgICAgICBpZiBub3QgYmFkU3RhdHVzIGFuZCBub3QgQGFjdG9yLmd1YXJkIGFuZCBAc3RhbmRBbmltYXRpb24ubmFtZSAhPSBAc3RhbmRBbmltYXRpb24ucmVjb3JkLm5hbWUKICAgICAgICAgICAgICAgICAgICBAc3RhbmRBbmltYXRpb24ucmVmcmVzaChAc3RhbmRBbmltYXRpb24ucmVjb3JkKQogICAgICAgICAgICAgICAgICAgIEBzdGFuZEFuaW1hdGlvbi5zdGFydCgpCiAgICAgICAgICAgIGlmIEBhbmltYXRpb25QaGFzZSA9PSA1CiAgICAgICAgICAgICAgICBAZGVhZCA9IEBhY3Rvci5scCA8PSAwCiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgIGlmIEBhbmltYXRpb25QaGFzZSA8IEBhbmltYXRpb25zLmxlbmd0aAogICAgICAgICAgICBAY3VycmVudEFuaW1hdGlvbnMgPSBAYW5pbWF0aW9uc1tAYW5pbWF0aW9uUGhhc2VdCiAgICAgICAgICAgIEBpc0FuaW1hdGlvblJ1bm5pbmcgPSBubwogICAgICAgICAgICBpZiBAY3VycmVudEFuaW1hdGlvbnM/CiAgICAgICAgICAgICAgICBmb3IgaSBpbiBbMC4uLkBjdXJyZW50QW5pbWF0aW9ucy5sZW5ndGhdCiAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uID0gQGN1cnJlbnRBbmltYXRpb25zW2ldCiAgICAgICAgICAgICAgICAgICAgaWYgYW5pbWF0aW9uPyBhbmQgKGFuaW1hdGlvbi50eXBlICE9ICJzaW1wbGUiKQogICAgICAgICAgICAgICAgICAgICAgICBhbmltYXRpb24uYW5pbWF0aW9uLnVwZGF0ZSgpCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGFuaW1hdGlvbi5hbmltYXRpb24uaXNSdW5uaW5nIG9yIAogICAgICAgICAgICAgICAgICAgICAgICAgICAoYW5pbWF0aW9uLnR5cGUuc3RhcnRzV2l0aCgic2ltcGxlXyIpIGFuZCBub3QgYW5pbWF0aW9uLmFuaW1hdGlvbi5zb3VyY2U/KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgQGlzQW5pbWF0aW9uUnVubmluZyA9IHllcwogICAgICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBAYW5pbWF0aW9uc1tAYW5pbWF0aW9uUGhhc2VdW2ldID0gbnVsbAogICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgYW5pbWF0aW9uPwogICAgICAgICAgICAgICAgICAgICAgICBpZiBAc3RhbmRBbmltYXRpb24uaXNSdW5uaW5nIGFuZCBAc3RhbmRBbmltYXRpb24uZmlyc3RSdW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBpc0FuaW1hdGlvblJ1bm5pbmcgPSB5ZXMKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgQGFuaW1hdGlvbnNbQGFuaW1hdGlvblBoYXNlXVtpXSA9IG51bGwKCiAgICAgICAgcmV0dXJuIG51bGwKICAgICAgICAgCiAgICBjaGVja1N0YXRlczogKGFjdGlvbkVuZCwgdHVybkVuZCwgYmF0dGxlRW5kLCB0dXJucywgc3RlcHMsIGRhbWFnZSkgLT4KICAgICAgICAKICAgICAgICBzdGF0ZXMgPSBAYWN0b3IuY2hlY2tTdGF0ZXMoYWN0aW9uRW5kLCB0dXJuRW5kLCBiYXR0bGVFbmQsIHR1cm5zLCBzdGVwcywgZGFtYWdlKQogICAgICAgIGluZm8gPSAiIgogICAgICAgIGkgPSAwCiAgICAgICAgZm9yIHN0YXRlIGluIHN0YXRlcwogICAgICAgICAgICBpbmZvID0gQHNob3J0RWZmZWN0SW5mbyh7IHN1Y2Nlc3M6IHllcywgdmFsdWU6IHN0YXRlLCBjb2RlOiA0IH0pCiAgICAgICAgICAgIGlmIGluZm8udGV4dCBhbmQgaW5mby50ZXh0Lmxlbmd0aCA+IDAgCiAgICAgICAgICAgICAgICBAc2V0QW5pbWF0aW9uKEBhbmltYXRpb25QaGFzZU9mZnNldCtpLCAwLCBuZXcgTG9naWNfVGV4dEFuaW1hdGlvbihpbmZvLnRleHQsIGluZm8uY29sb3IpLCAidGV4dCIpCiAgICAgICAgICAgICAgICBpKysKICAgICAgICBAYW5pbWF0aW9uUGhhc2VPZmZzZXQgPSAwICAgCiAgICBhcHBseUV4UGFyYW1ldGVyczogLT4KICAgICAgICBscCA9IEBhY3Rvci5scAogICAgICAgIG1wID0gQGFjdG9yLm1wCiAgICAgICAgQGFjdG9yLmFwcGx5RXhQYXJhbWV0ZXJzKCkKICAgICAgICBkYW1hZ2UgPSBAYWN0b3IubHAgLSBscAogICAgICAgIGlmIGxwICE9IEBhY3Rvci5scAogICAgICAgICAgICBAc2V0QW5pbWF0aW9uKDEsIDAsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IExvZ2ljX1RleHRBbmltYXRpb24oTWF0aC5hYnMoZGFtYWdlKS50b1N0cmluZygpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgZGFtYWdlIDwgMCB0aGVuIENvbG9ycy5MUF9EQU1BR0UgZWxzZSBDb2xvcnMuR1JFRU4pLCAidGV4dCIpCiAgICAgICAgICAgCiAgICAgICAgZGFtYWdlID0gQGFjdG9yLm1wIC0gbXAKICAgICAgICBpZiBtcCAhPSBAYWN0b3IubXAKICAgICAgICAgICAgQHNldEFuaW1hdGlvbigyLCAwLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBMb2dpY19UZXh0QW5pbWF0aW9uKE1hdGguYWJzKGRhbWFnZSkudG9TdHJpbmcoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGRhbWFnZSA8IDAgdGhlbiBDb2xvcnMuTVBfREFNQUdFIGVsc2UgQ29sb3JzLkJMVUUpLCAidGV4dCIpICAKICAgICAgICAKICAgIHVzZUl0ZW06IChpdGVtKSAtPiBAdXNlU2tpbGwoaXRlbSkKICAgIHVzZVNraWxsOiAoc2tpbGwpIC0+CiAgICAgICAgQGN1cnJlbnRTa2lsbCA9IHNraWxsCiAgICAgICAgYW5pbWF0aW9uID0gbnVsbAogICAgICAgIGFpZCA9IEBjdXJyZW50U2tpbGwudXNlQW5pbWF0aW9uSWQKICAgICAgICAKICAgICAgICBpZiBAY3VycmVudFNraWxsLml0ZW1UeXBlPyAjIElzIEl0ZW0/CiAgICAgICAgICAgIGFuaW1hdGlvbiA9IEBhY3Rvci5pdGVtQW5pbWF0aW9uCiAgICAgICAgZWxzZSBpZiBAY3VycmVudFNraWxsLmluZGV4ICE9IDEgIyBJcyBub3QgR3VhcmQgU2tpbGw/CiAgICAgICAgICAgIGlmIGFpZD8KICAgICAgICAgICAgICAgIGFuaW1hdGlvbiA9IG5ldyBMb2dpY19TaW1wbGVBbmltYXRpb24oUmVjb3JkTWFuYWdlci5zaW1wbGVBbmltYXRpb25zW2FpZF0pCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHN3aXRjaCBAY3VycmVudFNraWxsLmhpdFR5cGUKICAgICAgICAgICAgICAgICAgICB3aGVuIDAgIyBDZXJ0YWluIEhpdAogICAgICAgICAgICAgICAgICAgICAgICBhbmltYXRpb24gPSBAYWN0b3IuYXR0YWNrQW5pbWF0aW9uCiAgICAgICAgICAgICAgICAgICAgd2hlbiAxICMgUGh5c2ljYWwgSGl0CiAgICAgICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbiA9IEBhY3Rvci5hdHRhY2tBbmltYXRpb24KICAgICAgICAgICAgICAgICAgICB3aGVuIDIgIyBNYWdpY2FsIEhpdAogICAgICAgICAgICAgICAgICAgICAgICBhbmltYXRpb24gPSBAYWN0b3IubWFnaWNBbmltYXRpb24KICAgICAgICAgICAgICAgIAogICAgICAgIGlmIGFuaW1hdGlvbj8KICAgICAgICAgICAgQHNldEFuaW1hdGlvbigzLCAwLCBhbmltYXRpb24sICJzaW1wbGUiKQogICAgICAgICAKICAgICAgICB1c2VyQW5pbWF0aW9uID0gUmVjb3JkTWFuYWdlci5hbmltYXRpb25zW3NraWxsLnVzZXJBbmltYXRpb25JZF0KICAgICAgICBpZiB1c2VyQW5pbWF0aW9uPwogICAgICAgICAgICBAdXNlckFuaW1hdGlvbiA9IG5ldyBMb2dpY19BbmltYXRpb24odXNlckFuaW1hdGlvbikKICAgICAgICAgICAgQHNldEFuaW1hdGlvbig0LCAwLCBAdXNlckFuaW1hdGlvbiwgImNvbXBsZXgiKQogICAgICAgIGVsc2UKICAgICAgICAgICAgQHVzZXJBbmltYXRpb24gPSBudWxsCiAgICAgICAgICAgICAgICAKICAgICAgICBmb3IgdGFyZ2V0IGluIEB0YXJnZXRzCiAgICAgICAgICAgIHRhcmdldC5hdHRhY2tlciA9IHRoaXMKICAgICAgICAgICAgZGFtYWdlID0gQGFjdG9yLnVzZVNraWxsKHNraWxsLCB0YXJnZXQuYWN0b3IpIAogICAgICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgICAgIGFuaW1hdGlvbiA9IFJlY29yZE1hbmFnZXIuYW5pbWF0aW9uc1tza2lsbC5hbmltYXRpb25JZF0KICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIGFuaW1hdGlvbj8gYW5kIGRhbWFnZS5oaXQKICAgICAgICAgICAgICAgIHRhcmdldC50YXJnZXRBbmltYXRpb24gPSBuZXcgTG9naWNfQW5pbWF0aW9uKGFuaW1hdGlvbikKICAgICAgICAgICAgICAgIHRhcmdldC5zZXRBbmltYXRpb24oNiwgMCwgdGFyZ2V0LnRhcmdldEFuaW1hdGlvbiwgImNvbXBsZXgiKQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICB0YXJnZXQudGFyZ2V0QW5pbWF0aW9uID0gbnVsbAogICAgICAgICAgICAgIAogICAgICAgICAgICBhbmltYXRpb24gPSBSZWNvcmRNYW5hZ2VyLnNpbXBsZUFuaW1hdGlvbnNbc2tpbGwuZm9yd2FyZEFuaW1hdGlvbklkXQogICAgICAgICAgICBpZiBhbmltYXRpb24/IGFuZCBAdXNlckFuaW1hdGlvbj8gYW5kIHRhcmdldC50YXJnZXRBbmltYXRpb24/CiAgICAgICAgICAgICAgICB0YXJnZXQuc2V0QW5pbWF0aW9uKDUsIDAsIG5ldyBMb2dpY19Nb3ZhYmxlQW5pbWF0aW9uKGFuaW1hdGlvbiksICJzaW1wbGVfZm9yd2FyZCIsIHRoaXMpCiAgICAgICAgICAgIAogICAgICAgICAgICBhbmltYXRpb24gPSBSZWNvcmRNYW5hZ2VyLnNpbXBsZUFuaW1hdGlvbnNbc2tpbGwuYmFja3dhcmRBbmltYXRpb25JZF0KICAgICAgICAgICAgaWYgYW5pbWF0aW9uPyBhbmQgQHVzZXJBbmltYXRpb24/IGFuZCB0YXJnZXQudGFyZ2V0QW5pbWF0aW9uPwogICAgICAgICAgICAgICAgdGFyZ2V0LnNldEFuaW1hdGlvbig3LCAwLCBuZXcgTG9naWNfTW92YWJsZUFuaW1hdGlvbihhbmltYXRpb24pLCAic2ltcGxlX2JhY2t3YXJkIiwgdGhpcykKICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICB0ZXh0QW5pbWF0aW9ucyA9IFtdCiAgICAgICAgICAgIGlmIGRhbWFnZS5oaXQKICAgICAgICAgICAgICAgIGlmIHRhcmdldC5hY3Rvci5kYW1hZ2VBbmltYXRpb24/CiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0LnNldEFuaW1hdGlvbig2LCAxLCB0YXJnZXQuYWN0b3IuZGFtYWdlQW5pbWF0aW9uLCAic2ltcGxlIikKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaWYgc2tpbGwuZGFtYWdlLnR5cGUgPiAwCiAgICAgICAgICAgICAgICAgICAgdGV4dEFuaW1hdGlvbnMucHVzaChuZXcgTG9naWNfVGV4dEFuaW1hdGlvbihpZiBkYW1hZ2UudmFsdWUgPiAwIHRoZW4gZGFtYWdlLnZhbHVlLnRvU3RyaW5nKCkgZWxzZSBsY3MoQHZvY2FiLmJhdHRsZS5zd2FwKSkpCiAgICAgICAgICAgICAgICBpZiB0YXJnZXQuYWN0b3IubHAgPD0gMCBhbmQgdGFyZ2V0LmFjdG9yLmRlYXRoQW5pbWF0aW9uPwogICAgICAgICAgICAgICAgICAgIHRhcmdldC5zZXRBbmltYXRpb24oNywgMSwgdGFyZ2V0LmFjdG9yLmRlYXRoQW5pbWF0aW9uLCAic2ltcGxlIikKICAgICAgICAgICAgZWxzZSBpZiBkYW1hZ2UuY291bnRlcgogICAgICAgICAgICAgICAgZGFtYWdlID0gdGFyZ2V0LmFjdG9yLnVzZVNraWxsKHNraWxsLCBAYWN0b3IpCiAgICAgICAgICAgIGVsc2UgaWYgc2tpbGwuZGFtYWdlLnR5cGUgPiAwCiAgICAgICAgICAgICAgICB0ZXh0QW5pbWF0aW9uID0gbmV3IExvZ2ljX1RleHRBbmltYXRpb24obGNzKEB2b2NhYi5iYXR0bGUubWlzcykpCiAgICAgICAgICAgICAgICB0YXJnZXQuc2V0QW5pbWF0aW9uKDcsIDIsIHRleHRBbmltYXRpb24sICJ0ZXh0IikKICAgICAgICAgICAgCiAgICAgICAgICAgIGZvciBpbmZvIGluIGRhbWFnZS5lZmZlY3RJbmZvcwogICAgICAgICAgICAgICAgc2hvcnRJbmZvID0gQHNob3J0RWZmZWN0SW5mbyhpbmZvKQogICAgICAgICAgICAgICAgaWYgc2hvcnRJbmZvLnRleHQubGVuZ3RoID4gMAogICAgICAgICAgICAgICAgICAgIHRleHRBbmltYXRpb25zLnB1c2gobmV3IExvZ2ljX1RleHRBbmltYXRpb24oc2hvcnRJbmZvLnRleHQsIHNob3J0SW5mby5jb2xvcikpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgZm9yIGkgaW4gWzAuLi50ZXh0QW5pbWF0aW9ucy5sZW5ndGhdCiAgICAgICAgICAgICAgICB0ZXh0QW5pbWF0aW9uID0gdGV4dEFuaW1hdGlvbnNbaV0KICAgICAgICAgICAgICAgIHRhcmdldC5zZXRBbmltYXRpb24oaSs4LCAwLCB0ZXh0QW5pbWF0aW9uLCAidGV4dCIpCiAgICAgICAgICAgICAgICBAYW5pbWF0aW9uUGhhc2VPZmZzZXQgPSBpKzgrMQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAKICAgICAgICAKICAgIHNldEFuaW1hdGlvbjogKHBoYXNlLCBpbmRleCwgYW5pbWF0aW9uLCB0eXBlKSAtPgogICAgICAgIGlmIG5vdCB0eXBlLnN0YXJ0c1dpdGgoInNpbXBsZV8iKSB0aGVuIGFuaW1hdGlvbi5zdGFydCgpCiAgICAgICAgaWYgbm90IEBhbmltYXRpb25zW3BoYXNlXT8gdGhlbiBAYW5pbWF0aW9uc1twaGFzZV0gPSBbXQogICAgICAgIEBhbmltYXRpb25zW3BoYXNlXVtpbmRleF0gPSB7IGFuaW1hdGlvbjogYW5pbWF0aW9uLCB0eXBlOiB0eXBlIH0KICAgIAogICAgc2VsZWN0VGFyZ2V0czogKHNjb3BlLCBtZW1iZXJzLCBlbmVtaWVzLCBiYXR0bGVycykgLT4KICAgICAgICByZXN1bHQgPSBbXQogICAgICAgIGFsaXZlRW5lbWllcyA9IFtdCiAgICAgICAgYWxpdmVNZW1iZXJzID0gW10KICAgICAgICBhbGl2ZUJhdHRsZXJzID0gW10KICAgICAgICAKICAgICAgICBmb3IgZW5lbXkgaW4gZW5lbWllcwogICAgICAgICAgICBpZiBlbmVteS5hY3Rvci5pc0FsaXZlIGFuZCBub3QgZW5lbXkuaXNIaWRkZW4KICAgICAgICAgICAgICAgIGFsaXZlRW5lbWllcy5wdXNoKGVuZW15KQogICAgICAgICAgICAgICAgCiAgICAgICAgZm9yIGJhdHRsZXIgaW4gYmF0dGxlcnMKICAgICAgICAgICAgaWYgYmF0dGxlci5hY3Rvci5pc0FsaXZlIGFuZCBub3QgYmF0dGxlci5pc0hpZGRlbgogICAgICAgICAgICAgICAgYWxpdmVCYXR0bGVycy5wdXNoKGJhdHRsZXIpCiAgICAgICAgICAgICAgICAKICAgICAgICBmb3IgbWVtYmVyIGluIG1lbWJlcnMKICAgICAgICAgICAgaWYgbWVtYmVyLmFjdG9yLmlzQWxpdmUgYW5kIG5vdCBtZW1iZXIuaXNIaWRkZW4KICAgICAgICAgICAgICAgIGFsaXZlTWVtYmVycy5wdXNoKG1lbWJlcikKICAgICAgICAgICAgICAgIAogICAgICAgIHN3aXRjaCBzY29wZQogICAgICAgICAgICB3aGVuIDAgIyBOb25lCiAgICAgICAgICAgICAgICByZXN1bHQgPSBhbGl2ZUJhdHRsZXJzCiAgICAgICAgICAgIHdoZW4gMSAjIE9uZSBFbmVteQogICAgICAgICAgICAgICAgaWYgYWxpdmVFbmVtaWVzLmxlbmd0aCA+IDAKICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBbYWxpdmVFbmVtaWVzW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChhbGl2ZUVuZW1pZXMubGVuZ3RoLTEpKV1dCiAgICAgICAgICAgIHdoZW4gMiAjIEFsbCBFbmVtaWVzCiAgICAgICAgICAgICAgICByZXN1bHQgPSBhbGl2ZUVuZW1pZXMKICAgICAgICAgICAgd2hlbiA3ICMgT25lIE1lbWJlcgogICAgICAgICAgICAgICAgcmVzdWx0ID0gW2FsaXZlTWVtYmVyc1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAoYWxpdmVNZW1iZXJzLmxlbmd0aC0xKSldXQogICAgICAgICAgICB3aGVuIDggIyBBbGwgTWVtYmVycwogICAgICAgICAgICAgICAgcmVzdWx0ID0gYWxpdmVNZW1iZXJzCiAgICAgICAgICAgIHdoZW4gOSAjIE9uZSBNZW1iZXIgKERlYWQpCiAgICAgICAgICAgICAgICBkZWFkTWVtYmVycyA9IFtdCiAgICAgICAgICAgICAgICBmb3IgbWVtYmVyIGluIG1lbWJlcnMKICAgICAgICAgICAgICAgICAgICBpZiBub3QgbWVtYmVyLmFjdG9yLmlzQWxpdmUgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgZGVhZE1lbWJlcnMucHVzaChtZW1iZXIpCiAgICAgICAgICAgICAgICByZXN1bHQgPSBbZGVhZE1lbWJlcnNbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKGRlYWRNZW1iZXJzLmxlbmd0aC0xKSldXQogICAgICAgICAgICB3aGVuIDEwICMgQWxsIE1lbWJlcnMoRGVhZCkKICAgICAgICAgICAgICAgIGRlYWRNZW1iZXJzID0gW10KICAgICAgICAgICAgICAgIGZvciBtZW1iZXIgaW4gQG1lbWJlcnMKICAgICAgICAgICAgICAgICAgICBpZiBub3QgbWVtYmVyLmFjdG9yLmlzQWxpdmUKICAgICAgICAgICAgICAgICAgICAgICAgZGVhZE1lbWJlcnMucHVzaChtZW1iZXIpCiAgICAgICAgICAgICAgICByZXN1bHQgPSBkZWFkTWVtYmVycwogICAgICAgICAgICB3aGVuIDExICMgVXNlcgogICAgICAgICAgICAgICAgcmVzdWx0ID0gW3RoaXNdCiAgICAgICAgICAgICAgICAKICAgICAgICByZXR1cm4gcmVzdWx0CiAgICB0YWtlQWN0aW9uOiAodHVybikgLT4KICAgICAgICByZXN1bHQgPSBudWxsCiAgICAgICAgYWN0aW9ucyA9IFtdCiAgICAgICAgc2tpbGwgPSBudWxsCiAgICAgICAgbWF4ID0gTWF0aC5mbG9vcigxICsgTWF0aC5yYW5kb20oKSAqIDkpCiAgICAgICAgbWF4UmF0ZSA9IDAKICAgICAgICB6ZXJvID0gMAogICAgICAgIHJhdGVTdW0gPSAwCiAgICAgICAgdmFsdWUgPSAwCiAgICAgICAgCiAgICAgICAgZm9yIGFjdGlvblBhdHRlcm4gaW4gQGFjdGlvblBhdHRlcm5zCiAgICAgICAgICAgIHNraWxsID0gUmVjb3JkTWFuYWdlci5za2lsbHNbYWN0aW9uUGF0dGVybi5za2lsbElkXQogICAgICAgICAgICByYXRlID0gYWN0aW9uUGF0dGVybi5yYXRlCiAgICAgICAgICAgIAogICAgICAgICAgICBzd2l0Y2ggYWN0aW9uUGF0dGVybi5jb2RlCiAgICAgICAgICAgICAgICB3aGVuIDAgIyBBbHdheXMKICAgICAgICAgICAgICAgICAgICBhY3Rpb25zLnB1c2goeyBza2lsbDogc2tpbGwsIHJhdGU6IHJhdGUgfSkKICAgICAgICAgICAgICAgICAgICBtYXhSYXRlID0gcmF0ZSBpZiByYXRlID4gbWF4UmF0ZQogICAgICAgICAgICAgICAgd2hlbiAxICMgRnJvbSB0dXJuIFggZWFjaCBZIHR1cm4KICAgICAgICAgICAgICAgICAgICBpZiB0dXJuID49IGFjdGlvblBhdHRlcm4udmFsdWUxIGFuZCAodHVybiAtIGFjdGlvblBhdHRlcm4udmFsdWUxKSAlIGFjdGlvblBhdHRlcm4udmFsdWUyID09IDAKICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9ucy5wdXNoKHsgc2tpbGw6IHNraWxsLCByYXRlOiByYXRlIH0pCiAgICAgICAgICAgICAgICB3aGVuIDIgIyBMUCBiZXR3ZWVuIFglIGFuZCBZJQogICAgICAgICAgICAgICAgICAgIGxwID0gQGFjdG9yLmxwIC8gQGFjdG9yLm1scCAqIDEwMAogICAgICAgICAgICAgICAgICAgIGlmIGxwID49IGFjdGlvblBhdHRlcm4udmFsdWUxIGFuZCBscCA8PSBhY3Rpb25QYXR0ZXJuLnZhbHVlMgogICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25zLnB1c2goeyBza2lsbDogc2tpbGwsIHJhdGU6IHJhdGUgfSkKICAgICAgICAgICAgICAgIHdoZW4gMiAjIE1QIGJldHdlZW4gWCUgYW5kIFklCiAgICAgICAgICAgICAgICAgICAgbXAgPSBAYWN0b3IubXAgLyBAYWN0b3IubW1wICogMTAwCiAgICAgICAgICAgICAgICAgICAgaWYgbXAgPj0gYWN0aW9uUGF0dGVybi52YWx1ZTEgYW5kIG1wIDw9IGFjdGlvblBhdHRlcm4udmFsdWUyCiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbnMucHVzaCh7IHNraWxsOiBza2lsbCwgcmF0ZTogcmF0ZSB9KQogICAgICAgICAgICAgICAgd2hlbiAzICMgU3RhdGUKICAgICAgICAgICAgICAgICAgICBpZiBAYWN0b3Iuc3RhdGVzLmluZGV4T2YoUmVjb3JkTWFuYWdlci5zdGF0ZXNbYWN0aW9uUGF0dGVybi5pZF0pICE9IC0xCiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbnMucHVzaCh7IHNraWxsOiBza2lsbCwgcmF0ZTogcmF0ZSB9KQogICAgICAgICAgICAgICAgd2hlbiA0ICMgUGFydHkgTGV2ZWwKICAgICAgICAgICAgICAgICAgICBpZiBHYW1lTWFuYWdlci5wYXJ0eS5sZXZlbCgpID49IGFjdGlvblBhdHRlcm4udmFsdWUxCiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbnMucHVzaCh7IHNraWxsOiBza2lsbCwgcmF0ZTogcmF0ZSB9KQogICAgICAgICAgICAgICAgd2hlbiA1ICMgU3dpdGNoCiAgICAgICAgICAgICAgICAgICAgaWYgR2FtZU1hbmFnZXIuYm9vbGVhbnNbYWN0aW9uUGF0dGVybi52YWx1ZTFdCiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbnMucHVzaCh7IHNraWxsOiBza2lsbCwgcmF0ZTogcmF0ZSB9KQogICAgICAgICAgICAgICAgICAgIAogICAgICAgIHJhdGVTdW0gKz0gYWN0aW9uLnJhdGUgZm9yIGFjdGlvbiBpbiBhY3Rpb25zCiAgICAgICAgdmFsdWUgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiByYXRlU3VtKQogICAgICAgIAogICAgICAgIGZvciBhY3Rpb24gaW4gYWN0aW9ucwogICAgICAgICAgICBpZiB2YWx1ZSA8PSBhY3Rpb24ucmF0ZQogICAgICAgICAgICAgICAgcmVzdWx0ID0gYWN0aW9uCiAgICAgICAgICAgICAgICByZXN1bHQudHlwZSA9IDIKICAgICAgICAgICAgICAgIHJlc3VsdC5iYXR0bGVyID0gdGhpcwogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgdmFsdWUgLT0gYWN0aW9uLnJhdGUKICAgICAgICAgICAgCiAgICAgICAgcmV0dXJuIHJlc3VsdAogICAgICAgIAogICAgc2hvcnRFZmZlY3RJbmZvOiAoaW5mbykgLT4KICAgICAgICByZXN1bHQgPSB7IHRleHQ6ICIiLCBjb2xvcjogQ29sb3IuV0hJVEUgfQogICAgICAgIAogICAgICAgIHBhcmFtZXRlcnMgPSBbbGNzKEB2b2NhYi5wYXJhbWV0ZXJzLm1scCksIAogICAgICAgICAgICAgICAgICAgICAgbGNzKEB2b2NhYi5wYXJhbWV0ZXJzLm1tcCksIAogICAgICAgICAgICAgICAgICAgICAgbGNzKEB2b2NhYi5wYXJhbWV0ZXJzLmF0ayksIAogICAgICAgICAgICAgICAgICAgICAgbGNzKEB2b2NhYi5wYXJhbWV0ZXJzLmRlZiksIAogICAgICAgICAgICAgICAgICAgICAgbGNzKEB2b2NhYi5wYXJhbWV0ZXJzLm1hdCksIAogICAgICAgICAgICAgICAgICAgICAgbGNzKEB2b2NhYi5wYXJhbWV0ZXJzLm1kZiksIAogICAgICAgICAgICAgICAgICAgICAgbGNzKEB2b2NhYi5wYXJhbWV0ZXJzLmFnaSksIAogICAgICAgICAgICAgICAgICAgICAgbGNzKEB2b2NhYi5wYXJhbWV0ZXJzLmx1ayldCiAgICAgICAgCiAgICAgICAgc3dpdGNoIGluZm8uY29kZQogICAgICAgICAgICB3aGVuIDAgIyBDaGFuZ2UgTFAKICAgICAgICAgICAgICAgIHJlc3VsdC50ZXh0ID0gTWF0aC5hYnMoaW5mby52YWx1ZSkudG9TdHJpbmcoKQogICAgICAgICAgICAgICAgcmVzdWx0LmNvbG9yID0gaWYgaW5mby52YWx1ZSA8IDAgdGhlbiBDb2xvcnMuUkVEIGVsc2UgQ29sb3JzLkdSRUVOCiAgICAgICAgICAgIHdoZW4gMSAjIENoYW5nZSBNUAogICAgICAgICAgICAgICAgcmVzdWx0LnRleHQgPSBNYXRoLmFicyhpbmZvLnZhbHVlKS50b1N0cmluZygpCiAgICAgICAgICAgICAgICByZXN1bHQuY29sb3IgPSBpZiBpbmZvLnZhbHVlIDwgMCB0aGVuIENvbG9ycy5SRUQgZWxzZSBDb2xvcnMuR1JFRU4KICAgICAgICAgICAgI3doZW4gMiAjIENoYW5nZSBDUAogICAgICAgICAgICB3aGVuIDMgIyBBZGQgU3RhdGUKICAgICAgICAgICAgICAgIGlmIGluZm8uc3VjY2VzcyBhbmQgaW5mby52YWx1ZT8gYW5kIGluZm8udmFsdWUuc2hvd0ZhbGxNZXNzYWdlCiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnRleHQgPSAiPCN7aW5mby52YWx1ZS5uYW1lfT4iICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgd2hlbiA0ICMgUmVtb3ZlIFN0YXRlCiAgICAgICAgICAgICAgICBpZiBpbmZvLnN1Y2Nlc3MgYW5kIGluZm8udmFsdWU/IGFuZCBpbmZvLnZhbHVlLnJlbW92ZU1lc3NhZ2UubGVuZ3RoID4gMCAKICAgICAgICAgICAgICAgICAgICByZXN1bHQudGV4dCA9ICI8I3tpbmZvLnZhbHVlLm5hbWV9PiAje2luZm8udmFsdWUucmVtb3ZlTWVzc2FnZX0iCiAgICAgICAgICAgIHdoZW4gNSAjIEFkZCBCdWZmCiAgICAgICAgICAgICAgICByZXN1bHQudGV4dCA9IGxjcyhAdm9jYWIuYmF0dGxlLnBhcmFtZXRlclVwKS5yZXBsYWNlKCJ7cGFyYW19IiwgcGFyYW1ldGVyc1tpbmZvLmlkXSkKICAgICAgICAgICAgICAgIHJlc3VsdC5jb2xvciA9IENvbG9ycy5ZRUxMT1cKICAgICAgICAgICAgd2hlbiA2ICMgQWRkIERlYnVmZgogICAgICAgICAgICAgICAgcmVzdWx0LnRleHQgPSBsY3MoQHZvY2FiLmJhdHRsZS5wYXJhbWV0ZXJEb3duKS5yZXBsYWNlKCJ7cGFyYW19IiwgcGFyYW1ldGVyc1tpbmZvLmlkXSkKICAgICAgICAgICAgICAgIHJlc3VsdC5jb2xvciA9IENvbG9ycy5PUkFOR0UKIyAgICAgICAgICAgIHdoZW4gNyAjIFJlbW92ZSBCdWZmCiMgICAgICAgICAgICB3aGVuIDggIyBSZW1vdmUgRGVidWZmCiMgICAgICAgICAgICB3aGVuIDkgIyBTcGVjaWFsIEVmZmVjdAogICAgICAgICAgICAjd2hlbiAxMCAjIEdyb3cKIyAgICAgICAgICAgIHdoZW4gMTEgIyBMZWFybiBTa2lsbAogICAgICAgICAgICAjd2hlbiAxMiAjIENvbW1vbiBFdmVudAogICAgICAgICAgICAKICAgICAgICByZXR1cm4gcmVzdWx0CiAgICAgICAgCiAgICAgICAgICAgIAp3aW5kb3cuTG9naWNfQmF0dGxlciA9IExvZ2ljX0JhdHRsZXI=","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBMb2dpY19CYXR0bGVyOwoKICBMb2dpY19CYXR0bGVyID0gKGZ1bmN0aW9uKCkgewogICAgZnVuY3Rpb24gTG9naWNfQmF0dGxlcihhY3RvcikgewogICAgICB2YXIgZ3JhcGhpYywgcmVjb3JkOwogICAgICB0aGlzLmFjdG9yID0gYWN0b3I7CiAgICAgIHRoaXMuYW5pbWF0aW9ucyA9IFtbXSwgW10sIFtdLCBbXSwgW10sIFtdLCBbXSwgW11dOwogICAgICB0aGlzLnggPSAwOwogICAgICB0aGlzLnkgPSAwOwogICAgICB0aGlzLmRlYWQgPSBmYWxzZTsKICAgICAgdGhpcy5ncmFwaGljID0gbnVsbDsKICAgICAgdGhpcy50YXJnZXRzID0gW107CiAgICAgIHRoaXMuaXNBbmltYXRpb25SdW5uaW5nID0gZmFsc2U7CiAgICAgIHRoaXMuaXNIaWRkZW4gPSBmYWxzZTsKICAgICAgdGhpcy5hbmltYXRpb25QaGFzZSA9IDA7CiAgICAgIHRoaXMubGFzdEFuaW1hdGlvblBoYXNlID0gLTE7CiAgICAgIHRoaXMuY3VycmVudEFuaW1hdGlvbnMgPSB0aGlzLmFuaW1hdGlvbnNbMF07CiAgICAgIHRoaXMuY3VycmVudFNraWxsID0gbnVsbDsKICAgICAgdGhpcy5hY3Rpb25QYXR0ZXJucyA9IHRoaXMuYWN0b3IuYWN0aW9uUGF0dGVybnMgfHwgW107CiAgICAgIHRoaXMubWVzc2FnZUNvbnRhaW5lciA9IG51bGw7CiAgICAgIHRoaXMudm9jYWIgPSBSZWNvcmRNYW5hZ2VyLnZvY2FidWxhcnk7CiAgICAgIHRoaXMuYW5pbWF0aW9uUGhhc2VPZmZzZXQgPSAwOwogICAgICBncmFwaGljID0gdGhpcy5hY3Rvci5ncmFwaGljIHx8IHRoaXMuYWN0b3IuY2hhcmFjdGVyR3JhcGhpYzsKICAgICAgaWYgKChncmFwaGljICE9IG51bGwpICYmIGdyYXBoaWMubmFtZS5sZW5ndGggPiAwKSB7CiAgICAgICAgcmVjb3JkID0gewogICAgICAgICAgaW5kZXg6IC0xLAogICAgICAgICAgbmFtZTogIkRFRkFVTFRfR0VORVJBVEVEIiwKICAgICAgICAgIGdyYXBoaWM6IHRoaXMuYWN0b3IuY2hhcmFjdGVyR3JhcGhpYyAhPSBudWxsID8gbnVsbCA6IGdyYXBoaWMsCiAgICAgICAgICByZXBlYXQ6IHRydWUsCiAgICAgICAgICBmcmFtZXNYOiAxLAogICAgICAgICAgZnJhbWVzWTogMQogICAgICAgIH07CiAgICAgICAgdGhpcy5zdGFuZEFuaW1hdGlvbiA9IG5ldyBMb2dpY19TaW1wbGVBbmltYXRpb24ocmVjb3JkKTsKICAgICAgICB0aGlzLnN0YW5kQW5pbWF0aW9uLnJlY29yZC5yZXBlYXQgPSB0cnVlOwogICAgICAgIHRoaXMuc3RhbmRBbmltYXRpb24ucmVwZWF0ID0gdHJ1ZTsKICAgICAgICB0aGlzLnN0YW5kQW5pbWF0aW9uLnN0YXJ0KCk7CiAgICAgIH0KICAgICAgaWYgKHRoaXMuYWN0b3Iuc3RhbmRBbmltYXRpb24gIT0gbnVsbCkgewogICAgICAgIHRoaXMuc3RhbmRBbmltYXRpb24gPSB0aGlzLmFjdG9yLnN0YW5kQW5pbWF0aW9uOwogICAgICAgIHRoaXMuc3RhbmRBbmltYXRpb24ucmVjb3JkLnJlcGVhdCA9IHRydWU7CiAgICAgICAgdGhpcy5zdGFuZEFuaW1hdGlvbi5yZXBlYXQgPSB0cnVlOwogICAgICAgIHRoaXMuc3RhbmRBbmltYXRpb24uc3RhcnQoKTsKICAgICAgfQogICAgfQoKICAgIExvZ2ljX0JhdHRsZXIucHJvdG90eXBlLnNldEN1cnJlbnRBbmltYXRpb24gPSBmdW5jdGlvbihhbmltYXRpb24pIHsKICAgICAgdGhpcy5zdGFuZEFuaW1hdGlvbi5yZWZyZXNoKGFuaW1hdGlvbi5yZWNvcmQpOwogICAgICByZXR1cm4gdGhpcy5zdGFuZEFuaW1hdGlvbi5zdGFydCgpOwogICAgfTsKCiAgICBMb2dpY19CYXR0bGVyLnByb3RvdHlwZS5wcmVwYXJlU2tpbGwgPSBmdW5jdGlvbihza2lsbCkgewogICAgICB2YXIgYWlkLCBhbmltYXRpb247CiAgICAgIGFuaW1hdGlvbiA9IG51bGw7CiAgICAgIGFpZCA9IHNraWxsLnByZXBhcmVBbmltYXRpb25JZDsKICAgICAgaWYgKHNraWxsLmluZGV4ID09PSAxKSB7CiAgICAgICAgYW5pbWF0aW9uID0gdGhpcy5hY3Rvci5ndWFyZEFuaW1hdGlvbjsKICAgICAgfSBlbHNlIGlmIChhaWQgIT0gbnVsbCkgewogICAgICAgIGFuaW1hdGlvbiA9IG5ldyBMb2dpY19TaW1wbGVBbmltYXRpb24oUmVjb3JkTWFuYWdlci5zaW1wbGVBbmltYXRpb25zW2FpZF0pOwogICAgICB9IGVsc2UgewogICAgICAgIHN3aXRjaCAoc2tpbGwuaGl0VHlwZSkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBhbmltYXRpb24gPSB0aGlzLmFjdG9yLnByZUF0dGFja0FuaW1hdGlvbjsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgIGFuaW1hdGlvbiA9IHRoaXMuYWN0b3IucHJlQXR0YWNrQW5pbWF0aW9uOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgYW5pbWF0aW9uID0gdGhpcy5hY3Rvci5wcmVNYWdpY0FuaW1hdGlvbjsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKGFuaW1hdGlvbiAhPSBudWxsKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuc2V0Q3VycmVudEFuaW1hdGlvbihhbmltYXRpb24pOwogICAgICB9CiAgICB9OwoKICAgIExvZ2ljX0JhdHRsZXIucHJvdG90eXBlLmNhbmNlbFByZXBhcmF0aW9uID0gZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiB0aGlzLnNldEN1cnJlbnRBbmltYXRpb24odGhpcy5zdGFuZEFuaW1hdGlvbik7CiAgICB9OwoKICAgIExvZ2ljX0JhdHRsZXIucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgYW5pbWF0aW9uLCBhbmltYXRpb25zLCBiYWRTdGF0dXMsIGNoYW5nZWQsIGksIF9pLCBfaiwgX2xlbiwgX3JlZjsKICAgICAgaWYgKHRoaXMuaXNIaWRkZW4pIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgaWYgKHRoaXMuc3RhbmRBbmltYXRpb24gIT0gbnVsbCkgewogICAgICAgIHRoaXMuc3RhbmRBbmltYXRpb24udXBkYXRlKCk7CiAgICAgIH0KICAgICAgaWYgKHRoaXMuYW5pbWF0aW9uUGhhc2UgIT09IHRoaXMubGFzdEFuaW1hdGlvblBoYXNlICYmIHRoaXMuYW5pbWF0aW9uUGhhc2UgPCB0aGlzLmFuaW1hdGlvbnMubGVuZ3RoKSB7CiAgICAgICAgY2hhbmdlZCA9IGZhbHNlOwogICAgICAgIHRoaXMubGFzdEFuaW1hdGlvblBoYXNlID0gdGhpcy5hbmltYXRpb25QaGFzZTsKICAgICAgICBhbmltYXRpb25zID0gdGhpcy5hbmltYXRpb25zW3RoaXMuYW5pbWF0aW9uUGhhc2VdOwogICAgICAgIGlmIChhbmltYXRpb25zICE9IG51bGwpIHsKICAgICAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gYW5pbWF0aW9ucy5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykgewogICAgICAgICAgICBhbmltYXRpb24gPSBhbmltYXRpb25zW19pXTsKICAgICAgICAgICAgaWYgKChhbmltYXRpb24gIT0gbnVsbCkgJiYgYW5pbWF0aW9uLnR5cGUgPT09ICJzaW1wbGUiKSB7CiAgICAgICAgICAgICAgdGhpcy5zdGFuZEFuaW1hdGlvbi5yZWZyZXNoKGFuaW1hdGlvbi5hbmltYXRpb24ucmVjb3JkKTsKICAgICAgICAgICAgICB0aGlzLnN0YW5kQW5pbWF0aW9uLnN0YXJ0KCk7CiAgICAgICAgICAgICAgY2hhbmdlZCA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKHRoaXMuYW5pbWF0aW9uUGhhc2UgPT09IDAgJiYgdGhpcy5hY3Rvci5scCA+IDApIHsKICAgICAgICAgIGJhZFN0YXR1cyA9IHRoaXMuYWN0b3IuYmFkU3RhdHVzICYmICh0aGlzLmFjdG9yLmJhZFN0YXR1c0FuaW1hdGlvbiAhPSBudWxsKTsKICAgICAgICAgIGlmIChiYWRTdGF0dXMgJiYgdGhpcy5zdGFuZEFuaW1hdGlvbi5uYW1lICE9PSB0aGlzLmFjdG9yLmJhZFN0YXR1c0FuaW1hdGlvbi5uYW1lKSB7CiAgICAgICAgICAgIHRoaXMuc3RhbmRBbmltYXRpb24ucmVmcmVzaCh0aGlzLmFjdG9yLmJhZFN0YXR1c0FuaW1hdGlvbi5yZWNvcmQpOwogICAgICAgICAgICB0aGlzLnN0YW5kQW5pbWF0aW9uLnN0YXJ0KCk7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoIWJhZFN0YXR1cyAmJiB0aGlzLmFjdG9yLmd1YXJkICYmICh0aGlzLmFjdG9yLmd1YXJkQW5pbWF0aW9uICE9IG51bGwpICYmIHRoaXMuc3RhbmRBbmltYXRpb24ubmFtZSAhPT0gdGhpcy5hY3Rvci5ndWFyZEFuaW1hdGlvbi5uYW1lKSB7CiAgICAgICAgICAgIHRoaXMuc3RhbmRBbmltYXRpb24ucmVmcmVzaCh0aGlzLmFjdG9yLmd1YXJkQW5pbWF0aW9uLnJlY29yZCk7CiAgICAgICAgICAgIHRoaXMuc3RhbmRBbmltYXRpb24uc3RhcnQoKTsKICAgICAgICAgIH0KICAgICAgICAgIGlmICghYmFkU3RhdHVzICYmICF0aGlzLmFjdG9yLmd1YXJkICYmIHRoaXMuc3RhbmRBbmltYXRpb24ubmFtZSAhPT0gdGhpcy5zdGFuZEFuaW1hdGlvbi5yZWNvcmQubmFtZSkgewogICAgICAgICAgICB0aGlzLnN0YW5kQW5pbWF0aW9uLnJlZnJlc2godGhpcy5zdGFuZEFuaW1hdGlvbi5yZWNvcmQpOwogICAgICAgICAgICB0aGlzLnN0YW5kQW5pbWF0aW9uLnN0YXJ0KCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmICh0aGlzLmFuaW1hdGlvblBoYXNlID09PSA1KSB7CiAgICAgICAgICB0aGlzLmRlYWQgPSB0aGlzLmFjdG9yLmxwIDw9IDA7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmICh0aGlzLmFuaW1hdGlvblBoYXNlIDwgdGhpcy5hbmltYXRpb25zLmxlbmd0aCkgewogICAgICAgIHRoaXMuY3VycmVudEFuaW1hdGlvbnMgPSB0aGlzLmFuaW1hdGlvbnNbdGhpcy5hbmltYXRpb25QaGFzZV07CiAgICAgICAgdGhpcy5pc0FuaW1hdGlvblJ1bm5pbmcgPSBmYWxzZTsKICAgICAgICBpZiAodGhpcy5jdXJyZW50QW5pbWF0aW9ucyAhPSBudWxsKSB7CiAgICAgICAgICBmb3IgKGkgPSBfaiA9IDAsIF9yZWYgPSB0aGlzLmN1cnJlbnRBbmltYXRpb25zLmxlbmd0aDsgMCA8PSBfcmVmID8gX2ogPCBfcmVmIDogX2ogPiBfcmVmOyBpID0gMCA8PSBfcmVmID8gKytfaiA6IC0tX2opIHsKICAgICAgICAgICAgYW5pbWF0aW9uID0gdGhpcy5jdXJyZW50QW5pbWF0aW9uc1tpXTsKICAgICAgICAgICAgaWYgKChhbmltYXRpb24gIT0gbnVsbCkgJiYgKGFuaW1hdGlvbi50eXBlICE9PSAic2ltcGxlIikpIHsKICAgICAgICAgICAgICBhbmltYXRpb24uYW5pbWF0aW9uLnVwZGF0ZSgpOwogICAgICAgICAgICAgIGlmIChhbmltYXRpb24uYW5pbWF0aW9uLmlzUnVubmluZyB8fCAoYW5pbWF0aW9uLnR5cGUuc3RhcnRzV2l0aCgic2ltcGxlXyIpICYmIChhbmltYXRpb24uYW5pbWF0aW9uLnNvdXJjZSA9PSBudWxsKSkpIHsKICAgICAgICAgICAgICAgIHRoaXMuaXNBbmltYXRpb25SdW5uaW5nID0gdHJ1ZTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgdGhpcy5hbmltYXRpb25zW3RoaXMuYW5pbWF0aW9uUGhhc2VdW2ldID0gbnVsbDsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSBpZiAoYW5pbWF0aW9uICE9IG51bGwpIHsKICAgICAgICAgICAgICBpZiAodGhpcy5zdGFuZEFuaW1hdGlvbi5pc1J1bm5pbmcgJiYgdGhpcy5zdGFuZEFuaW1hdGlvbi5maXJzdFJ1bikgewogICAgICAgICAgICAgICAgdGhpcy5pc0FuaW1hdGlvblJ1bm5pbmcgPSB0cnVlOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB0aGlzLmFuaW1hdGlvbnNbdGhpcy5hbmltYXRpb25QaGFzZV1baV0gPSBudWxsOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gbnVsbDsKICAgIH07CgogICAgTG9naWNfQmF0dGxlci5wcm90b3R5cGUuY2hlY2tTdGF0ZXMgPSBmdW5jdGlvbihhY3Rpb25FbmQsIHR1cm5FbmQsIGJhdHRsZUVuZCwgdHVybnMsIHN0ZXBzLCBkYW1hZ2UpIHsKICAgICAgdmFyIGksIGluZm8sIHN0YXRlLCBzdGF0ZXMsIF9pLCBfbGVuOwogICAgICBzdGF0ZXMgPSB0aGlzLmFjdG9yLmNoZWNrU3RhdGVzKGFjdGlvbkVuZCwgdHVybkVuZCwgYmF0dGxlRW5kLCB0dXJucywgc3RlcHMsIGRhbWFnZSk7CiAgICAgIGluZm8gPSAiIjsKICAgICAgaSA9IDA7CiAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gc3RhdGVzLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7CiAgICAgICAgc3RhdGUgPSBzdGF0ZXNbX2ldOwogICAgICAgIGluZm8gPSB0aGlzLnNob3J0RWZmZWN0SW5mbyh7CiAgICAgICAgICBzdWNjZXNzOiB0cnVlLAogICAgICAgICAgdmFsdWU6IHN0YXRlLAogICAgICAgICAgY29kZTogNAogICAgICAgIH0pOwogICAgICAgIGlmIChpbmZvLnRleHQgJiYgaW5mby50ZXh0Lmxlbmd0aCA+IDApIHsKICAgICAgICAgIHRoaXMuc2V0QW5pbWF0aW9uKHRoaXMuYW5pbWF0aW9uUGhhc2VPZmZzZXQgKyBpLCAwLCBuZXcgTG9naWNfVGV4dEFuaW1hdGlvbihpbmZvLnRleHQsIGluZm8uY29sb3IpLCAidGV4dCIpOwogICAgICAgICAgaSsrOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gdGhpcy5hbmltYXRpb25QaGFzZU9mZnNldCA9IDA7CiAgICB9OwoKICAgIExvZ2ljX0JhdHRsZXIucHJvdG90eXBlLmFwcGx5RXhQYXJhbWV0ZXJzID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBkYW1hZ2UsIGxwLCBtcDsKICAgICAgbHAgPSB0aGlzLmFjdG9yLmxwOwogICAgICBtcCA9IHRoaXMuYWN0b3IubXA7CiAgICAgIHRoaXMuYWN0b3IuYXBwbHlFeFBhcmFtZXRlcnMoKTsKICAgICAgZGFtYWdlID0gdGhpcy5hY3Rvci5scCAtIGxwOwogICAgICBpZiAobHAgIT09IHRoaXMuYWN0b3IubHApIHsKICAgICAgICB0aGlzLnNldEFuaW1hdGlvbigxLCAwLCBuZXcgTG9naWNfVGV4dEFuaW1hdGlvbihNYXRoLmFicyhkYW1hZ2UpLnRvU3RyaW5nKCksIGRhbWFnZSA8IDAgPyBDb2xvcnMuTFBfREFNQUdFIDogQ29sb3JzLkdSRUVOKSwgInRleHQiKTsKICAgICAgfQogICAgICBkYW1hZ2UgPSB0aGlzLmFjdG9yLm1wIC0gbXA7CiAgICAgIGlmIChtcCAhPT0gdGhpcy5hY3Rvci5tcCkgewogICAgICAgIHJldHVybiB0aGlzLnNldEFuaW1hdGlvbigyLCAwLCBuZXcgTG9naWNfVGV4dEFuaW1hdGlvbihNYXRoLmFicyhkYW1hZ2UpLnRvU3RyaW5nKCksIGRhbWFnZSA8IDAgPyBDb2xvcnMuTVBfREFNQUdFIDogQ29sb3JzLkJMVUUpLCAidGV4dCIpOwogICAgICB9CiAgICB9OwoKICAgIExvZ2ljX0JhdHRsZXIucHJvdG90eXBlLnVzZUl0ZW0gPSBmdW5jdGlvbihpdGVtKSB7CiAgICAgIHJldHVybiB0aGlzLnVzZVNraWxsKGl0ZW0pOwogICAgfTsKCiAgICBMb2dpY19CYXR0bGVyLnByb3RvdHlwZS51c2VTa2lsbCA9IGZ1bmN0aW9uKHNraWxsKSB7CiAgICAgIHZhciBhaWQsIGFuaW1hdGlvbiwgZGFtYWdlLCBpLCBpbmZvLCBzaG9ydEluZm8sIHRhcmdldCwgdGV4dEFuaW1hdGlvbiwgdGV4dEFuaW1hdGlvbnMsIHVzZXJBbmltYXRpb24sIF9pLCBfaiwgX2xlbiwgX2xlbjEsIF9yZWYsIF9yZWYxLCBfcmVzdWx0czsKICAgICAgdGhpcy5jdXJyZW50U2tpbGwgPSBza2lsbDsKICAgICAgYW5pbWF0aW9uID0gbnVsbDsKICAgICAgYWlkID0gdGhpcy5jdXJyZW50U2tpbGwudXNlQW5pbWF0aW9uSWQ7CiAgICAgIGlmICh0aGlzLmN1cnJlbnRTa2lsbC5pdGVtVHlwZSAhPSBudWxsKSB7CiAgICAgICAgYW5pbWF0aW9uID0gdGhpcy5hY3Rvci5pdGVtQW5pbWF0aW9uOwogICAgICB9IGVsc2UgaWYgKHRoaXMuY3VycmVudFNraWxsLmluZGV4ICE9PSAxKSB7CiAgICAgICAgaWYgKGFpZCAhPSBudWxsKSB7CiAgICAgICAgICBhbmltYXRpb24gPSBuZXcgTG9naWNfU2ltcGxlQW5pbWF0aW9uKFJlY29yZE1hbmFnZXIuc2ltcGxlQW5pbWF0aW9uc1thaWRdKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgc3dpdGNoICh0aGlzLmN1cnJlbnRTa2lsbC5oaXRUeXBlKSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBhbmltYXRpb24gPSB0aGlzLmFjdG9yLmF0dGFja0FuaW1hdGlvbjsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgIGFuaW1hdGlvbiA9IHRoaXMuYWN0b3IuYXR0YWNrQW5pbWF0aW9uOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgYW5pbWF0aW9uID0gdGhpcy5hY3Rvci5tYWdpY0FuaW1hdGlvbjsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKGFuaW1hdGlvbiAhPSBudWxsKSB7CiAgICAgICAgdGhpcy5zZXRBbmltYXRpb24oMywgMCwgYW5pbWF0aW9uLCAic2ltcGxlIik7CiAgICAgIH0KICAgICAgdXNlckFuaW1hdGlvbiA9IFJlY29yZE1hbmFnZXIuYW5pbWF0aW9uc1tza2lsbC51c2VyQW5pbWF0aW9uSWRdOwogICAgICBpZiAodXNlckFuaW1hdGlvbiAhPSBudWxsKSB7CiAgICAgICAgdGhpcy51c2VyQW5pbWF0aW9uID0gbmV3IExvZ2ljX0FuaW1hdGlvbih1c2VyQW5pbWF0aW9uKTsKICAgICAgICB0aGlzLnNldEFuaW1hdGlvbig0LCAwLCB0aGlzLnVzZXJBbmltYXRpb24sICJjb21wbGV4Iik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy51c2VyQW5pbWF0aW9uID0gbnVsbDsKICAgICAgfQogICAgICBfcmVmID0gdGhpcy50YXJnZXRzOwogICAgICBfcmVzdWx0cyA9IFtdOwogICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICB0YXJnZXQgPSBfcmVmW19pXTsKICAgICAgICB0YXJnZXQuYXR0YWNrZXIgPSB0aGlzOwogICAgICAgIGRhbWFnZSA9IHRoaXMuYWN0b3IudXNlU2tpbGwoc2tpbGwsIHRhcmdldC5hY3Rvcik7CiAgICAgICAgYW5pbWF0aW9uID0gUmVjb3JkTWFuYWdlci5hbmltYXRpb25zW3NraWxsLmFuaW1hdGlvbklkXTsKICAgICAgICBpZiAoKGFuaW1hdGlvbiAhPSBudWxsKSAmJiBkYW1hZ2UuaGl0KSB7CiAgICAgICAgICB0YXJnZXQudGFyZ2V0QW5pbWF0aW9uID0gbmV3IExvZ2ljX0FuaW1hdGlvbihhbmltYXRpb24pOwogICAgICAgICAgdGFyZ2V0LnNldEFuaW1hdGlvbig2LCAwLCB0YXJnZXQudGFyZ2V0QW5pbWF0aW9uLCAiY29tcGxleCIpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0YXJnZXQudGFyZ2V0QW5pbWF0aW9uID0gbnVsbDsKICAgICAgICB9CiAgICAgICAgYW5pbWF0aW9uID0gUmVjb3JkTWFuYWdlci5zaW1wbGVBbmltYXRpb25zW3NraWxsLmZvcndhcmRBbmltYXRpb25JZF07CiAgICAgICAgaWYgKChhbmltYXRpb24gIT0gbnVsbCkgJiYgKHRoaXMudXNlckFuaW1hdGlvbiAhPSBudWxsKSAmJiAodGFyZ2V0LnRhcmdldEFuaW1hdGlvbiAhPSBudWxsKSkgewogICAgICAgICAgdGFyZ2V0LnNldEFuaW1hdGlvbig1LCAwLCBuZXcgTG9naWNfTW92YWJsZUFuaW1hdGlvbihhbmltYXRpb24pLCAic2ltcGxlX2ZvcndhcmQiLCB0aGlzKTsKICAgICAgICB9CiAgICAgICAgYW5pbWF0aW9uID0gUmVjb3JkTWFuYWdlci5zaW1wbGVBbmltYXRpb25zW3NraWxsLmJhY2t3YXJkQW5pbWF0aW9uSWRdOwogICAgICAgIGlmICgoYW5pbWF0aW9uICE9IG51bGwpICYmICh0aGlzLnVzZXJBbmltYXRpb24gIT0gbnVsbCkgJiYgKHRhcmdldC50YXJnZXRBbmltYXRpb24gIT0gbnVsbCkpIHsKICAgICAgICAgIHRhcmdldC5zZXRBbmltYXRpb24oNywgMCwgbmV3IExvZ2ljX01vdmFibGVBbmltYXRpb24oYW5pbWF0aW9uKSwgInNpbXBsZV9iYWNrd2FyZCIsIHRoaXMpOwogICAgICAgIH0KICAgICAgICB0ZXh0QW5pbWF0aW9ucyA9IFtdOwogICAgICAgIGlmIChkYW1hZ2UuaGl0KSB7CiAgICAgICAgICBpZiAodGFyZ2V0LmFjdG9yLmRhbWFnZUFuaW1hdGlvbiAhPSBudWxsKSB7CiAgICAgICAgICAgIHRhcmdldC5zZXRBbmltYXRpb24oNiwgMSwgdGFyZ2V0LmFjdG9yLmRhbWFnZUFuaW1hdGlvbiwgInNpbXBsZSIpOwogICAgICAgICAgfQogICAgICAgICAgaWYgKHNraWxsLmRhbWFnZS50eXBlID4gMCkgewogICAgICAgICAgICB0ZXh0QW5pbWF0aW9ucy5wdXNoKG5ldyBMb2dpY19UZXh0QW5pbWF0aW9uKGRhbWFnZS52YWx1ZSA+IDAgPyBkYW1hZ2UudmFsdWUudG9TdHJpbmcoKSA6IGxjcyh0aGlzLnZvY2FiLmJhdHRsZS5zd2FwKSkpOwogICAgICAgICAgfQogICAgICAgICAgaWYgKHRhcmdldC5hY3Rvci5scCA8PSAwICYmICh0YXJnZXQuYWN0b3IuZGVhdGhBbmltYXRpb24gIT0gbnVsbCkpIHsKICAgICAgICAgICAgdGFyZ2V0LnNldEFuaW1hdGlvbig3LCAxLCB0YXJnZXQuYWN0b3IuZGVhdGhBbmltYXRpb24sICJzaW1wbGUiKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKGRhbWFnZS5jb3VudGVyKSB7CiAgICAgICAgICBkYW1hZ2UgPSB0YXJnZXQuYWN0b3IudXNlU2tpbGwoc2tpbGwsIHRoaXMuYWN0b3IpOwogICAgICAgIH0gZWxzZSBpZiAoc2tpbGwuZGFtYWdlLnR5cGUgPiAwKSB7CiAgICAgICAgICB0ZXh0QW5pbWF0aW9uID0gbmV3IExvZ2ljX1RleHRBbmltYXRpb24obGNzKHRoaXMudm9jYWIuYmF0dGxlLm1pc3MpKTsKICAgICAgICAgIHRhcmdldC5zZXRBbmltYXRpb24oNywgMiwgdGV4dEFuaW1hdGlvbiwgInRleHQiKTsKICAgICAgICB9CiAgICAgICAgX3JlZjEgPSBkYW1hZ2UuZWZmZWN0SW5mb3M7CiAgICAgICAgZm9yIChfaiA9IDAsIF9sZW4xID0gX3JlZjEubGVuZ3RoOyBfaiA8IF9sZW4xOyBfaisrKSB7CiAgICAgICAgICBpbmZvID0gX3JlZjFbX2pdOwogICAgICAgICAgc2hvcnRJbmZvID0gdGhpcy5zaG9ydEVmZmVjdEluZm8oaW5mbyk7CiAgICAgICAgICBpZiAoc2hvcnRJbmZvLnRleHQubGVuZ3RoID4gMCkgewogICAgICAgICAgICB0ZXh0QW5pbWF0aW9ucy5wdXNoKG5ldyBMb2dpY19UZXh0QW5pbWF0aW9uKHNob3J0SW5mby50ZXh0LCBzaG9ydEluZm8uY29sb3IpKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgX3Jlc3VsdHMucHVzaCgoZnVuY3Rpb24oKSB7CiAgICAgICAgICB2YXIgX2ssIF9yZWYyLCBfcmVzdWx0czE7CiAgICAgICAgICBfcmVzdWx0czEgPSBbXTsKICAgICAgICAgIGZvciAoaSA9IF9rID0gMCwgX3JlZjIgPSB0ZXh0QW5pbWF0aW9ucy5sZW5ndGg7IDAgPD0gX3JlZjIgPyBfayA8IF9yZWYyIDogX2sgPiBfcmVmMjsgaSA9IDAgPD0gX3JlZjIgPyArK19rIDogLS1faykgewogICAgICAgICAgICB0ZXh0QW5pbWF0aW9uID0gdGV4dEFuaW1hdGlvbnNbaV07CiAgICAgICAgICAgIHRhcmdldC5zZXRBbmltYXRpb24oaSArIDgsIDAsIHRleHRBbmltYXRpb24sICJ0ZXh0Iik7CiAgICAgICAgICAgIF9yZXN1bHRzMS5wdXNoKHRoaXMuYW5pbWF0aW9uUGhhc2VPZmZzZXQgPSBpICsgOCArIDEpOwogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuIF9yZXN1bHRzMTsKICAgICAgICB9KS5jYWxsKHRoaXMpKTsKICAgICAgfQogICAgICByZXR1cm4gX3Jlc3VsdHM7CiAgICB9OwoKICAgIExvZ2ljX0JhdHRsZXIucHJvdG90eXBlLnNldEFuaW1hdGlvbiA9IGZ1bmN0aW9uKHBoYXNlLCBpbmRleCwgYW5pbWF0aW9uLCB0eXBlKSB7CiAgICAgIGlmICghdHlwZS5zdGFydHNXaXRoKCJzaW1wbGVfIikpIHsKICAgICAgICBhbmltYXRpb24uc3RhcnQoKTsKICAgICAgfQogICAgICBpZiAodGhpcy5hbmltYXRpb25zW3BoYXNlXSA9PSBudWxsKSB7CiAgICAgICAgdGhpcy5hbmltYXRpb25zW3BoYXNlXSA9IFtdOwogICAgICB9CiAgICAgIHJldHVybiB0aGlzLmFuaW1hdGlvbnNbcGhhc2VdW2luZGV4XSA9IHsKICAgICAgICBhbmltYXRpb246IGFuaW1hdGlvbiwKICAgICAgICB0eXBlOiB0eXBlCiAgICAgIH07CiAgICB9OwoKICAgIExvZ2ljX0JhdHRsZXIucHJvdG90eXBlLnNlbGVjdFRhcmdldHMgPSBmdW5jdGlvbihzY29wZSwgbWVtYmVycywgZW5lbWllcywgYmF0dGxlcnMpIHsKICAgICAgdmFyIGFsaXZlQmF0dGxlcnMsIGFsaXZlRW5lbWllcywgYWxpdmVNZW1iZXJzLCBiYXR0bGVyLCBkZWFkTWVtYmVycywgZW5lbXksIG1lbWJlciwgcmVzdWx0LCBfaSwgX2osIF9rLCBfbCwgX2xlbiwgX2xlbjEsIF9sZW4yLCBfbGVuMywgX2xlbjQsIF9tLCBfcmVmOwogICAgICByZXN1bHQgPSBbXTsKICAgICAgYWxpdmVFbmVtaWVzID0gW107CiAgICAgIGFsaXZlTWVtYmVycyA9IFtdOwogICAgICBhbGl2ZUJhdHRsZXJzID0gW107CiAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gZW5lbWllcy5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykgewogICAgICAgIGVuZW15ID0gZW5lbWllc1tfaV07CiAgICAgICAgaWYgKGVuZW15LmFjdG9yLmlzQWxpdmUgJiYgIWVuZW15LmlzSGlkZGVuKSB7CiAgICAgICAgICBhbGl2ZUVuZW1pZXMucHVzaChlbmVteSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGZvciAoX2ogPSAwLCBfbGVuMSA9IGJhdHRsZXJzLmxlbmd0aDsgX2ogPCBfbGVuMTsgX2orKykgewogICAgICAgIGJhdHRsZXIgPSBiYXR0bGVyc1tfal07CiAgICAgICAgaWYgKGJhdHRsZXIuYWN0b3IuaXNBbGl2ZSAmJiAhYmF0dGxlci5pc0hpZGRlbikgewogICAgICAgICAgYWxpdmVCYXR0bGVycy5wdXNoKGJhdHRsZXIpOwogICAgICAgIH0KICAgICAgfQogICAgICBmb3IgKF9rID0gMCwgX2xlbjIgPSBtZW1iZXJzLmxlbmd0aDsgX2sgPCBfbGVuMjsgX2srKykgewogICAgICAgIG1lbWJlciA9IG1lbWJlcnNbX2tdOwogICAgICAgIGlmIChtZW1iZXIuYWN0b3IuaXNBbGl2ZSAmJiAhbWVtYmVyLmlzSGlkZGVuKSB7CiAgICAgICAgICBhbGl2ZU1lbWJlcnMucHVzaChtZW1iZXIpOwogICAgICAgIH0KICAgICAgfQogICAgICBzd2l0Y2ggKHNjb3BlKSB7CiAgICAgICAgY2FzZSAwOgogICAgICAgICAgcmVzdWx0ID0gYWxpdmVCYXR0bGVyczsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgMToKICAgICAgICAgIGlmIChhbGl2ZUVuZW1pZXMubGVuZ3RoID4gMCkgewogICAgICAgICAgICByZXN1bHQgPSBbYWxpdmVFbmVtaWVzW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChhbGl2ZUVuZW1pZXMubGVuZ3RoIC0gMSkpXV07CiAgICAgICAgICB9CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDI6CiAgICAgICAgICByZXN1bHQgPSBhbGl2ZUVuZW1pZXM7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDc6CiAgICAgICAgICByZXN1bHQgPSBbYWxpdmVNZW1iZXJzW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChhbGl2ZU1lbWJlcnMubGVuZ3RoIC0gMSkpXV07CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDg6CiAgICAgICAgICByZXN1bHQgPSBhbGl2ZU1lbWJlcnM7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDk6CiAgICAgICAgICBkZWFkTWVtYmVycyA9IFtdOwogICAgICAgICAgZm9yIChfbCA9IDAsIF9sZW4zID0gbWVtYmVycy5sZW5ndGg7IF9sIDwgX2xlbjM7IF9sKyspIHsKICAgICAgICAgICAgbWVtYmVyID0gbWVtYmVyc1tfbF07CiAgICAgICAgICAgIGlmICghbWVtYmVyLmFjdG9yLmlzQWxpdmUpIHsKICAgICAgICAgICAgICBkZWFkTWVtYmVycy5wdXNoKG1lbWJlcik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIHJlc3VsdCA9IFtkZWFkTWVtYmVyc1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAoZGVhZE1lbWJlcnMubGVuZ3RoIC0gMSkpXV07CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDEwOgogICAgICAgICAgZGVhZE1lbWJlcnMgPSBbXTsKICAgICAgICAgIF9yZWYgPSB0aGlzLm1lbWJlcnM7CiAgICAgICAgICBmb3IgKF9tID0gMCwgX2xlbjQgPSBfcmVmLmxlbmd0aDsgX20gPCBfbGVuNDsgX20rKykgewogICAgICAgICAgICBtZW1iZXIgPSBfcmVmW19tXTsKICAgICAgICAgICAgaWYgKCFtZW1iZXIuYWN0b3IuaXNBbGl2ZSkgewogICAgICAgICAgICAgIGRlYWRNZW1iZXJzLnB1c2gobWVtYmVyKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgcmVzdWx0ID0gZGVhZE1lbWJlcnM7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDExOgogICAgICAgICAgcmVzdWx0ID0gW3RoaXNdOwogICAgICB9CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9OwoKICAgIExvZ2ljX0JhdHRsZXIucHJvdG90eXBlLnRha2VBY3Rpb24gPSBmdW5jdGlvbih0dXJuKSB7CiAgICAgIHZhciBhY3Rpb24sIGFjdGlvblBhdHRlcm4sIGFjdGlvbnMsIGxwLCBtYXgsIG1heFJhdGUsIG1wLCByYXRlLCByYXRlU3VtLCByZXN1bHQsIHNraWxsLCB2YWx1ZSwgemVybywgX2ksIF9qLCBfaywgX2xlbiwgX2xlbjEsIF9sZW4yLCBfcmVmOwogICAgICByZXN1bHQgPSBudWxsOwogICAgICBhY3Rpb25zID0gW107CiAgICAgIHNraWxsID0gbnVsbDsKICAgICAgbWF4ID0gTWF0aC5mbG9vcigxICsgTWF0aC5yYW5kb20oKSAqIDkpOwogICAgICBtYXhSYXRlID0gMDsKICAgICAgemVybyA9IDA7CiAgICAgIHJhdGVTdW0gPSAwOwogICAgICB2YWx1ZSA9IDA7CiAgICAgIF9yZWYgPSB0aGlzLmFjdGlvblBhdHRlcm5zOwogICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICBhY3Rpb25QYXR0ZXJuID0gX3JlZltfaV07CiAgICAgICAgc2tpbGwgPSBSZWNvcmRNYW5hZ2VyLnNraWxsc1thY3Rpb25QYXR0ZXJuLnNraWxsSWRdOwogICAgICAgIHJhdGUgPSBhY3Rpb25QYXR0ZXJuLnJhdGU7CiAgICAgICAgc3dpdGNoIChhY3Rpb25QYXR0ZXJuLmNvZGUpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgYWN0aW9ucy5wdXNoKHsKICAgICAgICAgICAgICBza2lsbDogc2tpbGwsCiAgICAgICAgICAgICAgcmF0ZTogcmF0ZQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgaWYgKHJhdGUgPiBtYXhSYXRlKSB7CiAgICAgICAgICAgICAgbWF4UmF0ZSA9IHJhdGU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgIGlmICh0dXJuID49IGFjdGlvblBhdHRlcm4udmFsdWUxICYmICh0dXJuIC0gYWN0aW9uUGF0dGVybi52YWx1ZTEpICUgYWN0aW9uUGF0dGVybi52YWx1ZTIgPT09IDApIHsKICAgICAgICAgICAgICBhY3Rpb25zLnB1c2goewogICAgICAgICAgICAgICAgc2tpbGw6IHNraWxsLAogICAgICAgICAgICAgICAgcmF0ZTogcmF0ZQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICBscCA9IHRoaXMuYWN0b3IubHAgLyB0aGlzLmFjdG9yLm1scCAqIDEwMDsKICAgICAgICAgICAgaWYgKGxwID49IGFjdGlvblBhdHRlcm4udmFsdWUxICYmIGxwIDw9IGFjdGlvblBhdHRlcm4udmFsdWUyKSB7CiAgICAgICAgICAgICAgYWN0aW9ucy5wdXNoKHsKICAgICAgICAgICAgICAgIHNraWxsOiBza2lsbCwKICAgICAgICAgICAgICAgIHJhdGU6IHJhdGUKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgbXAgPSB0aGlzLmFjdG9yLm1wIC8gdGhpcy5hY3Rvci5tbXAgKiAxMDA7CiAgICAgICAgICAgIGlmIChtcCA+PSBhY3Rpb25QYXR0ZXJuLnZhbHVlMSAmJiBtcCA8PSBhY3Rpb25QYXR0ZXJuLnZhbHVlMikgewogICAgICAgICAgICAgIGFjdGlvbnMucHVzaCh7CiAgICAgICAgICAgICAgICBza2lsbDogc2tpbGwsCiAgICAgICAgICAgICAgICByYXRlOiByYXRlCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgIGlmICh0aGlzLmFjdG9yLnN0YXRlcy5pbmRleE9mKFJlY29yZE1hbmFnZXIuc3RhdGVzW2FjdGlvblBhdHRlcm4uaWRdKSAhPT0gLTEpIHsKICAgICAgICAgICAgICBhY3Rpb25zLnB1c2goewogICAgICAgICAgICAgICAgc2tpbGw6IHNraWxsLAogICAgICAgICAgICAgICAgcmF0ZTogcmF0ZQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICBpZiAoR2FtZU1hbmFnZXIucGFydHkubGV2ZWwoKSA+PSBhY3Rpb25QYXR0ZXJuLnZhbHVlMSkgewogICAgICAgICAgICAgIGFjdGlvbnMucHVzaCh7CiAgICAgICAgICAgICAgICBza2lsbDogc2tpbGwsCiAgICAgICAgICAgICAgICByYXRlOiByYXRlCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgIGlmIChHYW1lTWFuYWdlci5ib29sZWFuc1thY3Rpb25QYXR0ZXJuLnZhbHVlMV0pIHsKICAgICAgICAgICAgICBhY3Rpb25zLnB1c2goewogICAgICAgICAgICAgICAgc2tpbGw6IHNraWxsLAogICAgICAgICAgICAgICAgcmF0ZTogcmF0ZQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICAgIGZvciAoX2ogPSAwLCBfbGVuMSA9IGFjdGlvbnMubGVuZ3RoOyBfaiA8IF9sZW4xOyBfaisrKSB7CiAgICAgICAgYWN0aW9uID0gYWN0aW9uc1tfal07CiAgICAgICAgcmF0ZVN1bSArPSBhY3Rpb24ucmF0ZTsKICAgICAgfQogICAgICB2YWx1ZSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHJhdGVTdW0pOwogICAgICBmb3IgKF9rID0gMCwgX2xlbjIgPSBhY3Rpb25zLmxlbmd0aDsgX2sgPCBfbGVuMjsgX2srKykgewogICAgICAgIGFjdGlvbiA9IGFjdGlvbnNbX2tdOwogICAgICAgIGlmICh2YWx1ZSA8PSBhY3Rpb24ucmF0ZSkgewogICAgICAgICAgcmVzdWx0ID0gYWN0aW9uOwogICAgICAgICAgcmVzdWx0LnR5cGUgPSAyOwogICAgICAgICAgcmVzdWx0LmJhdHRsZXIgPSB0aGlzOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICAgIHZhbHVlIC09IGFjdGlvbi5yYXRlOwogICAgICB9CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9OwoKICAgIExvZ2ljX0JhdHRsZXIucHJvdG90eXBlLnNob3J0RWZmZWN0SW5mbyA9IGZ1bmN0aW9uKGluZm8pIHsKICAgICAgdmFyIHBhcmFtZXRlcnMsIHJlc3VsdDsKICAgICAgcmVzdWx0ID0gewogICAgICAgIHRleHQ6ICIiLAogICAgICAgIGNvbG9yOiBDb2xvci5XSElURQogICAgICB9OwogICAgICBwYXJhbWV0ZXJzID0gW2xjcyh0aGlzLnZvY2FiLnBhcmFtZXRlcnMubWxwKSwgbGNzKHRoaXMudm9jYWIucGFyYW1ldGVycy5tbXApLCBsY3ModGhpcy52b2NhYi5wYXJhbWV0ZXJzLmF0ayksIGxjcyh0aGlzLnZvY2FiLnBhcmFtZXRlcnMuZGVmKSwgbGNzKHRoaXMudm9jYWIucGFyYW1ldGVycy5tYXQpLCBsY3ModGhpcy52b2NhYi5wYXJhbWV0ZXJzLm1kZiksIGxjcyh0aGlzLnZvY2FiLnBhcmFtZXRlcnMuYWdpKSwgbGNzKHRoaXMudm9jYWIucGFyYW1ldGVycy5sdWspXTsKICAgICAgc3dpdGNoIChpbmZvLmNvZGUpIHsKICAgICAgICBjYXNlIDA6CiAgICAgICAgICByZXN1bHQudGV4dCA9IE1hdGguYWJzKGluZm8udmFsdWUpLnRvU3RyaW5nKCk7CiAgICAgICAgICByZXN1bHQuY29sb3IgPSBpbmZvLnZhbHVlIDwgMCA/IENvbG9ycy5SRUQgOiBDb2xvcnMuR1JFRU47CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDE6CiAgICAgICAgICByZXN1bHQudGV4dCA9IE1hdGguYWJzKGluZm8udmFsdWUpLnRvU3RyaW5nKCk7CiAgICAgICAgICByZXN1bHQuY29sb3IgPSBpbmZvLnZhbHVlIDwgMCA/IENvbG9ycy5SRUQgOiBDb2xvcnMuR1JFRU47CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDM6CiAgICAgICAgICBpZiAoaW5mby5zdWNjZXNzICYmIChpbmZvLnZhbHVlICE9IG51bGwpICYmIGluZm8udmFsdWUuc2hvd0ZhbGxNZXNzYWdlKSB7CiAgICAgICAgICAgIHJlc3VsdC50ZXh0ID0gIjwiICsgaW5mby52YWx1ZS5uYW1lICsgIj4iOwogICAgICAgICAgfQogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSA0OgogICAgICAgICAgaWYgKGluZm8uc3VjY2VzcyAmJiAoaW5mby52YWx1ZSAhPSBudWxsKSAmJiBpbmZvLnZhbHVlLnJlbW92ZU1lc3NhZ2UubGVuZ3RoID4gMCkgewogICAgICAgICAgICByZXN1bHQudGV4dCA9ICI8IiArIGluZm8udmFsdWUubmFtZSArICI+ICIgKyBpbmZvLnZhbHVlLnJlbW92ZU1lc3NhZ2U7CiAgICAgICAgICB9CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDU6CiAgICAgICAgICByZXN1bHQudGV4dCA9IGxjcyh0aGlzLnZvY2FiLmJhdHRsZS5wYXJhbWV0ZXJVcCkucmVwbGFjZSgie3BhcmFtfSIsIHBhcmFtZXRlcnNbaW5mby5pZF0pOwogICAgICAgICAgcmVzdWx0LmNvbG9yID0gQ29sb3JzLllFTExPVzsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgNjoKICAgICAgICAgIHJlc3VsdC50ZXh0ID0gbGNzKHRoaXMudm9jYWIuYmF0dGxlLnBhcmFtZXRlckRvd24pLnJlcGxhY2UoIntwYXJhbX0iLCBwYXJhbWV0ZXJzW2luZm8uaWRdKTsKICAgICAgICAgIHJlc3VsdC5jb2xvciA9IENvbG9ycy5PUkFOR0U7CiAgICAgIH0KICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH07CgogICAgcmV0dXJuIExvZ2ljX0JhdHRsZXI7CgogIH0pKCk7CgogIHdpbmRvdy5Mb2dpY19CYXR0bGVyID0gTG9naWNfQmF0dGxlcjsKCn0pLmNhbGwodGhpcyk7Cg=="},{"name":"Logic_Picture","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogTG9naWNfUGljdHVyZQojICAgQ3JlYXRlZCBvbjogMjAxMy0xMi0wMQojCiMgICBDb3B5cmlnaHQgKEMpIDIwMTMgQW5kcukgUmFkb21za2kuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIENsYXNzOiBMb2dpY19QaWN0dXJlCiMKIyAgIEEgY2xhc3MgZm9yIHRoZSBzY3JlZW4gdG8gaGFuZGxlIHNoYWtpbmcsIHRpbnRpbmcsIGV0Yy4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCmNsYXNzIExvZ2ljX1BpY3R1cmUKICAgIGNvbnN0cnVjdG9yOiAtPgogICAgICAgIEB4ID0gMAogICAgICAgIEB5ID0gMAogICAgICAgIEB6b29tWCA9IDEuMAogICAgICAgIEB6b29tWSA9IDEuMAogICAgICAgIEBvcGFjaXR5ID0gMjU1CiAgICAgICAgQGFuZ2xlID0gMAogICAgICAgIEBpc01vdmluZyA9IG5vCiAgICAgICAgQGlzWm9vbWluZyA9IG5vCiAgICAgICAgQGlzQmxlbmRpbmcgPSBubwogICAgICAgIEBpc1RpbnRpbmcgPSBubwogICAgICAgIEBpc0NvbG9yaW5nID0gbm8KICAgICAgICBAaXNSb3RhdGluZyA9IG5vCiAgICAgICAgQHRvbmUgPSBuZXcgVG9uZSgwLCAwLCAwLCAwKQogICAgICAgIEBjb2xvciA9IG5ldyBDb2xvcigwLCAwLCAwLCAwKQogICAgICAgIAogICAgbW92ZVRvOiAoeCwgeSwgZHVyYXRpb24pIC0+CiAgICAgICAgaWYgQHggPT0geCBhbmQgQHkgPT0geSB0aGVuIHJldHVybgogICAgICAgIGlmIGR1cmF0aW9uID09IDAKICAgICAgICAgICAgQHggPSB4CiAgICAgICAgICAgIEB5ID0geQogICAgICAgIGVsc2UKICAgICAgICAgICAgQGlzTW92aW5nID0geWVzCiAgICAgICAgICAgIEBtb3ZlRHVyYXRpb24gPSBkdXJhdGlvbgogICAgICAgICAgICBAdGFyZ2V0WCA9IHgKICAgICAgICAgICAgQHRhcmdldFkgPSB5CiAgICAgICAgICAgIEBtb3ZlSW5jcmVtZW50WCA9IChAdGFyZ2V0WCAtIEB4KSAvIGR1cmF0aW9uCiAgICAgICAgICAgIEBtb3ZlSW5jcmVtZW50WSA9IChAdGFyZ2V0WSAtIEB5KSAvIGR1cmF0aW9uCiAgICAgICAgCiAgICAgICAgCiAgICB6b29tVG86ICh4LCB5LCBkdXJhdGlvbikgLT4KICAgICAgICBpZiBAem9vbVggPT0geCBhbmQgQHpvb21ZID09IHkgdGhlbiByZXR1cm4KICAgICAgICBpZiBkdXJhdGlvbiA9PSAwCiAgICAgICAgICAgIEB6b29tWCA9IHgKICAgICAgICAgICAgQHpvb21ZID0geQogICAgICAgIGVsc2UKICAgICAgICAgICAgQGlzWm9vbWluZyA9IHllcwogICAgICAgICAgICBAem9vbUR1cmF0aW9uID0gZHVyYXRpb24KICAgICAgICAgICAgQHRhcmdldFpvb21YID0geAogICAgICAgICAgICBAdGFyZ2V0Wm9vbVkgPSB5CiAgICAgICAgICAgIEB6b29tSW5jcmVtZW50WCA9IChAdGFyZ2V0Wm9vbVggLSBAem9vbVgpIC8gZHVyYXRpb24KICAgICAgICAgICAgQHpvb21JbmNyZW1lbnRZID0gKEB0YXJnZXRab29tWSAtIEB6b29tWSkgLyBkdXJhdGlvbgogICAgICAgIAogICAgYmxlbmRUbzogKG9wYWNpdHksIGR1cmF0aW9uKSAtPgogICAgICAgIGlmIEBvcGFjaXR5ID09IG9wYWNpdHkgdGhlbiByZXR1cm4KICAgICAgICBpZiBkdXJhdGlvbiA9PSAwCiAgICAgICAgICAgIEBvcGFjaXR5ID0gb3BhY2l0eQogICAgICAgIGVsc2UKICAgICAgICAgICAgQGlzQmxlbmRpbmcgPSB5ZXMKICAgICAgICAgICAgQGJsZW5kRHVyYXRpb24gPSBkdXJhdGlvbgogICAgICAgICAgICBAdGFyZ2V0T3BhY2l0eSA9IG9wYWNpdHkKICAgICAgICAgICAgQGJsZW5kSW5jcmVtZW50ID0gKEB0YXJnZXRPcGFjaXR5IC0gQG9wYWNpdHkpIC8gZHVyYXRpb24KICAgICAgICAKICAgIHRpbnRUbzogKHRvbmUsIGR1cmF0aW9uKSAtPgogICAgICAgIGlmIEB0b25lLnJlZCA9PSB0b25lLnJlZCBhbmQgQHRvbmUuZ3JlZW4gPT0gdG9uZS5ncmVlbiBhbmQKICAgICAgICAgICBAdG9uZS5ibHVlID09IHRvbmUuYmx1ZSBhbmQgQHRvbmUuZ3JleSA9PSB0b25lLmdyZXkgdGhlbiByZXR1cm4KICAgICAgICBpZiBkdXJhdGlvbiA9PSAwCiAgICAgICAgICAgIEB0b25lID0gdG9uZQogICAgICAgIGVsc2UKICAgICAgICAgICAgQGlzVGludGluZyA9IHllcwogICAgICAgICAgICBAdGludER1cmF0aW9uID0gZHVyYXRpb24KICAgICAgICAgICAgQHRhcmdldFRvbmUgPSB0b25lCiAgICAgICAgICAgIEB0aW50Q291bnRlciA9IGR1cmF0aW9uCiAgICAgICAgICAgIAogICAgY29sb3JUbzogKGNvbG9yLCBkdXJhdGlvbikgLT4KICAgICAgICBpZiBAY29sb3IucmVkID09IGNvbG9yLnJlZCBhbmQgQGNvbG9yLmdyZWVuID09IGNvbG9yLmdyZWVuIGFuZAogICAgICAgICAgIEBjb2xvci5ibHVlID09IGNvbG9yLmJsdWUgYW5kIEBjb2xvci5hbHBoYSA9PSBjb2xvci5hbHBoYSB0aGVuIHJldHVybgogICAgCiAgICAgICAgaWYgZHVyYXRpb24gPT0gMAogICAgICAgICAgICBAY29sb3IgPSBjb2xvcgogICAgICAgIGVsc2UKICAgICAgICAgICAgQGlzQ29sb3JpbmcgPSB5ZXMKICAgICAgICAgICAgQGNvbG9yRHVyYXRpb24gPSBkdXJhdGlvbgogICAgICAgICAgICBAdGFyZ2V0Q29sb3IgPSBjb2xvcgogICAgICAgICAgICBAY29sb3JDb3VudGVyID0gZHVyYXRpb24KICAgICAgICAgICAgCiAgICByb3RhdGU6IChkaXJlY3Rpb24sIHNwZWVkLCBkdXJhdGlvbikgLT4KICAgICAgICBAaXNSb3RhdGluZyA9IHllcwogICAgICAgIEByb3RhdGlvbkRpcmVjdGlvbiA9IGRpcmVjdGlvbgogICAgICAgIEByb3RhdGlvblNwZWVkID0gc3BlZWQKICAgICAgICBAcm90YXRpb25EdXJhdGlvbiA9IGR1cmF0aW9uCiAgICAgICAgICAgIAogICAgdXBkYXRlOiAtPgogICAgICAgIEB1cGRhdGVNb3ZpbmcoKQogICAgICAgIEB1cGRhdGVab29taW5nKCkKICAgICAgICBAdXBkYXRlQmxlbmRpbmcoKQogICAgICAgIEB1cGRhdGVUaW50aW5nKCkKICAgICAgICBAdXBkYXRlQ29sb3JpbmcoKQogICAgICAgIEB1cGRhdGVSb3RhdGlvbigpCiAgICAgICAgCiAgICB1cGRhdGVNb3Zpbmc6IC0+CiAgICAgICAgaWYgbm90IEBpc01vdmluZyB0aGVuIHJldHVybgogICAgICAgIAogICAgICAgIEB4ICs9IEBtb3ZlSW5jcmVtZW50WAogICAgICAgIEB5ICs9IEBtb3ZlSW5jcmVtZW50WQogICAgICAgIEBtb3ZlRHVyYXRpb24tLQogICAgICAgIAogICAgICAgIGlmIEBtb3ZlRHVyYXRpb24gPT0gMAogICAgICAgICAgICBAeCA9IEB0YXJnZXRYCiAgICAgICAgICAgIEB5ID0gQHRhcmdldFkKICAgICAgICAgICAgQGlzTW92aW5nID0gbm8KICAgICAgICAKICAgIHVwZGF0ZVpvb21pbmc6IC0+CiAgICAgICAgaWYgbm90IEBpc1pvb21pbmcgdGhlbiByZXR1cm4KICAgICAgICAKICAgICAgICBAem9vbVggKz0gQHpvb21JbmNyZW1lbnRYCiAgICAgICAgQHpvb21ZICs9IEB6b29tSW5jcmVtZW50WQogICAgICAgIEB6b29tRHVyYXRpb24tLQogICAgICAgIAogICAgICAgIGlmIEB6b29tRHVyYXRpb24gPT0gMAogICAgICAgICAgICBAem9vbVggPSBAdGFyZ2V0Wm9vbVgKICAgICAgICAgICAgQHpvb21ZID0gQHRhcmdldFpvb21ZCiAgICAgICAgICAgIEBpc1pvb21pbmcgPSBubyAgICAKICAgICAgICAgICAgCiAgICB1cGRhdGVCbGVuZGluZzogLT4KICAgICAgICBpZiBub3QgQGlzQmxlbmRpbmcgdGhlbiByZXR1cm4KICAgICAgICAKICAgICAgICBAb3BhY2l0eSA9IE1hdGgubWF4KE1hdGgubWluKEBvcGFjaXR5ICsgQGJsZW5kSW5jcmVtZW50LCAyNTUpLCAwKQoKICAgICAgICBAYmxlbmREdXJhdGlvbi0tCiAgICAgICAgCiAgICAgICAgaWYgQGJsZW5kRHVyYXRpb24gPT0gMAogICAgICAgICAgICBAb3BhY2l0eSA9IEB0YXJnZXRPcGFjaXR5CiAgICAgICAgICAgIEBpc0JsZW5kaW5nID0gbm8KICAgICAgICAgICAgCiAgICB1cGRhdGVUaW50aW5nOiAtPgogICAgICAgIGlmIG5vdCBAaXNUaW50aW5nIHRoZW4gcmV0dXJuCiAgICAgICAgCiAgICAgICAgYSA9IChAdGludENvdW50ZXIgLyBAdGludER1cmF0aW9uKSAqIDI1NQogICAgICAgIAogICAgICAgIEB0b25lLnJlZCA9IE1hdGguZmxvb3IoKEB0b25lLnJlZCAqIGEgKyBAdGFyZ2V0VG9uZS5yZWQgKiAoMjU1IC0gYSkpIC8gMjU1KQogICAgICAgIEB0b25lLmdyZWVuID0gTWF0aC5mbG9vcigoQHRvbmUuZ3JlZW4gKiBhICsgQHRhcmdldFRvbmUuZ3JlZW4gKiAoMjU1IC0gYSkpIC8gMjU1KQogICAgICAgIEB0b25lLmJsdWUgPSBNYXRoLmZsb29yKChAdG9uZS5ibHVlICogYSArIEB0YXJnZXRUb25lLmJsdWUgKiAoMjU1IC0gYSkpIC8gMjU1KQogICAgICAgIEB0b25lLmdyZXkgPSBNYXRoLmZsb29yKChAdG9uZS5ncmV5ICogYSArIEB0YXJnZXRUb25lLmdyZXkgKiAoMjU1IC0gYSkpIC8gMjU1KQogICAgICAgIAogICAgICAgIEB0aW50Q291bnRlci0tCiAgICAgICAgCiAgICAgICAgaWYgQHRpbnRDb3VudGVyIDw9IDAKICAgICAgICAgICAgQGlzVGludGluZyA9IG5vCiAgICAgICAgICAgIEB0aW50Q291bnRlciA9IDAKICAgICAgICAgICAgQHRpbnREdXJhdGlvbiA9IDAKICAgICAgICAgICAgQHRvbmUgPSBAdGFyZ2V0VG9uZQogICAgICAgICAgICAKICAgIHVwZGF0ZUNvbG9yaW5nOiAtPgogICAgICAgIGlmIG5vdCBAaXNDb2xvcmluZyB0aGVuIHJldHVybgogICAgICAgIAogICAgICAgIGEgPSAoQGNvbG9yQ291bnRlciAvIEBjb2xvckR1cmF0aW9uKSAqIDI1NQogICAgCiAgICAgICAgCiAgICAgICAgQGNvbG9yLnJlZCA9IE1hdGguZmxvb3IoKEBjb2xvci5yZWQgKiBhICsgQHRhcmdldENvbG9yLnJlZCAqICgyNTUgLSBhKSkgLyAyNTUpCiAgICAgICAgQGNvbG9yLmdyZWVuID0gTWF0aC5mbG9vcigoQGNvbG9yLmdyZWVuICogYSArIEB0YXJnZXRDb2xvci5ncmVlbiAqICgyNTUgLSBhKSkgLyAyNTUpCiAgICAgICAgQGNvbG9yLmJsdWUgPSBNYXRoLmZsb29yKChAY29sb3IuYmx1ZSAqIGEgKyBAdGFyZ2V0Q29sb3IuYmx1ZSAqICgyNTUgLSBhKSkgLyAyNTUpCiAgICAgICAgQGNvbG9yLmFscGhhID0gTWF0aC5mbG9vcigoQGNvbG9yLmFscGhhICogYSArIEB0YXJnZXRDb2xvci5hbHBoYSAqICgyNTUgLSBhKSkgLyAyNTUpCiAgICAgICAgCiAgICAgICAgQGNvbG9yQ291bnRlci0tCiAgICAgICAgCiAgICAgICAgaWYgQGNvbG9yQ291bnRlciA8PSAwCiAgICAgICAgICAgIEBpc0NvbG9yaW5nID0gbm8KICAgICAgICAgICAgQGNvbG9yQ291bnRlciA9IDAKICAgICAgICAgICAgQGNvbG9yRHVyYXRpb24gPSAwCiAgICAgICAgICAgIEBjb2xvciA9IEB0YXJnZXRDb2xvcgogICAgICAgICAgICAKICAgIHVwZGF0ZVJvdGF0aW9uOiAtPgogICAgICAgIGlmIG5vdCBAaXNSb3RhdGluZyB0aGVuIHJldHVybgogICAgICAgIAogICAgICAgIGlmIEByb3RhdGlvbkRpcmVjdGlvbiA9PSAwCiAgICAgICAgICAgIEBhbmdsZSArPSBAcm90YXRpb25TcGVlZAogICAgICAgIGVsc2UKICAgICAgICAgICAgQGFuZ2xlIC09IEByb3RhdGlvblNwZWVkCiAgICAgICAgIAogICAgICAgIGlmIEByb3RhdGlvbkR1cmF0aW9uID4gMCB0aGVuIEByb3RhdGlvbkR1cmF0aW9uLS0KICAgICAgICBpZiBAcm90YXRpb25EdXJhdGlvbiA9PSAwIHRoZW4gQGlzUm90YXRpbmcgPSBubwogICAgCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgCndpbmRvdy5Mb2dpY19QaWN0dXJlID0gTG9naWNfUGljdHVyZQ==","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBMb2dpY19QaWN0dXJlOwoKICBMb2dpY19QaWN0dXJlID0gKGZ1bmN0aW9uKCkgewogICAgZnVuY3Rpb24gTG9naWNfUGljdHVyZSgpIHsKICAgICAgdGhpcy54ID0gMDsKICAgICAgdGhpcy55ID0gMDsKICAgICAgdGhpcy56b29tWCA9IDEuMDsKICAgICAgdGhpcy56b29tWSA9IDEuMDsKICAgICAgdGhpcy5vcGFjaXR5ID0gMjU1OwogICAgICB0aGlzLmFuZ2xlID0gMDsKICAgICAgdGhpcy5pc01vdmluZyA9IGZhbHNlOwogICAgICB0aGlzLmlzWm9vbWluZyA9IGZhbHNlOwogICAgICB0aGlzLmlzQmxlbmRpbmcgPSBmYWxzZTsKICAgICAgdGhpcy5pc1RpbnRpbmcgPSBmYWxzZTsKICAgICAgdGhpcy5pc0NvbG9yaW5nID0gZmFsc2U7CiAgICAgIHRoaXMuaXNSb3RhdGluZyA9IGZhbHNlOwogICAgICB0aGlzLnRvbmUgPSBuZXcgVG9uZSgwLCAwLCAwLCAwKTsKICAgICAgdGhpcy5jb2xvciA9IG5ldyBDb2xvcigwLCAwLCAwLCAwKTsKICAgIH0KCiAgICBMb2dpY19QaWN0dXJlLnByb3RvdHlwZS5tb3ZlVG8gPSBmdW5jdGlvbih4LCB5LCBkdXJhdGlvbikgewogICAgICBpZiAodGhpcy54ID09PSB4ICYmIHRoaXMueSA9PT0geSkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBpZiAoZHVyYXRpb24gPT09IDApIHsKICAgICAgICB0aGlzLnggPSB4OwogICAgICAgIHJldHVybiB0aGlzLnkgPSB5OwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuaXNNb3ZpbmcgPSB0cnVlOwogICAgICAgIHRoaXMubW92ZUR1cmF0aW9uID0gZHVyYXRpb247CiAgICAgICAgdGhpcy50YXJnZXRYID0geDsKICAgICAgICB0aGlzLnRhcmdldFkgPSB5OwogICAgICAgIHRoaXMubW92ZUluY3JlbWVudFggPSAodGhpcy50YXJnZXRYIC0gdGhpcy54KSAvIGR1cmF0aW9uOwogICAgICAgIHJldHVybiB0aGlzLm1vdmVJbmNyZW1lbnRZID0gKHRoaXMudGFyZ2V0WSAtIHRoaXMueSkgLyBkdXJhdGlvbjsKICAgICAgfQogICAgfTsKCiAgICBMb2dpY19QaWN0dXJlLnByb3RvdHlwZS56b29tVG8gPSBmdW5jdGlvbih4LCB5LCBkdXJhdGlvbikgewogICAgICBpZiAodGhpcy56b29tWCA9PT0geCAmJiB0aGlzLnpvb21ZID09PSB5KSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGlmIChkdXJhdGlvbiA9PT0gMCkgewogICAgICAgIHRoaXMuem9vbVggPSB4OwogICAgICAgIHJldHVybiB0aGlzLnpvb21ZID0geTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmlzWm9vbWluZyA9IHRydWU7CiAgICAgICAgdGhpcy56b29tRHVyYXRpb24gPSBkdXJhdGlvbjsKICAgICAgICB0aGlzLnRhcmdldFpvb21YID0geDsKICAgICAgICB0aGlzLnRhcmdldFpvb21ZID0geTsKICAgICAgICB0aGlzLnpvb21JbmNyZW1lbnRYID0gKHRoaXMudGFyZ2V0Wm9vbVggLSB0aGlzLnpvb21YKSAvIGR1cmF0aW9uOwogICAgICAgIHJldHVybiB0aGlzLnpvb21JbmNyZW1lbnRZID0gKHRoaXMudGFyZ2V0Wm9vbVkgLSB0aGlzLnpvb21ZKSAvIGR1cmF0aW9uOwogICAgICB9CiAgICB9OwoKICAgIExvZ2ljX1BpY3R1cmUucHJvdG90eXBlLmJsZW5kVG8gPSBmdW5jdGlvbihvcGFjaXR5LCBkdXJhdGlvbikgewogICAgICBpZiAodGhpcy5vcGFjaXR5ID09PSBvcGFjaXR5KSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGlmIChkdXJhdGlvbiA9PT0gMCkgewogICAgICAgIHJldHVybiB0aGlzLm9wYWNpdHkgPSBvcGFjaXR5OwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuaXNCbGVuZGluZyA9IHRydWU7CiAgICAgICAgdGhpcy5ibGVuZER1cmF0aW9uID0gZHVyYXRpb247CiAgICAgICAgdGhpcy50YXJnZXRPcGFjaXR5ID0gb3BhY2l0eTsKICAgICAgICByZXR1cm4gdGhpcy5ibGVuZEluY3JlbWVudCA9ICh0aGlzLnRhcmdldE9wYWNpdHkgLSB0aGlzLm9wYWNpdHkpIC8gZHVyYXRpb247CiAgICAgIH0KICAgIH07CgogICAgTG9naWNfUGljdHVyZS5wcm90b3R5cGUudGludFRvID0gZnVuY3Rpb24odG9uZSwgZHVyYXRpb24pIHsKICAgICAgaWYgKHRoaXMudG9uZS5yZWQgPT09IHRvbmUucmVkICYmIHRoaXMudG9uZS5ncmVlbiA9PT0gdG9uZS5ncmVlbiAmJiB0aGlzLnRvbmUuYmx1ZSA9PT0gdG9uZS5ibHVlICYmIHRoaXMudG9uZS5ncmV5ID09PSB0b25lLmdyZXkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgaWYgKGR1cmF0aW9uID09PSAwKSB7CiAgICAgICAgcmV0dXJuIHRoaXMudG9uZSA9IHRvbmU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5pc1RpbnRpbmcgPSB0cnVlOwogICAgICAgIHRoaXMudGludER1cmF0aW9uID0gZHVyYXRpb247CiAgICAgICAgdGhpcy50YXJnZXRUb25lID0gdG9uZTsKICAgICAgICByZXR1cm4gdGhpcy50aW50Q291bnRlciA9IGR1cmF0aW9uOwogICAgICB9CiAgICB9OwoKICAgIExvZ2ljX1BpY3R1cmUucHJvdG90eXBlLmNvbG9yVG8gPSBmdW5jdGlvbihjb2xvciwgZHVyYXRpb24pIHsKICAgICAgaWYgKHRoaXMuY29sb3IucmVkID09PSBjb2xvci5yZWQgJiYgdGhpcy5jb2xvci5ncmVlbiA9PT0gY29sb3IuZ3JlZW4gJiYgdGhpcy5jb2xvci5ibHVlID09PSBjb2xvci5ibHVlICYmIHRoaXMuY29sb3IuYWxwaGEgPT09IGNvbG9yLmFscGhhKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGlmIChkdXJhdGlvbiA9PT0gMCkgewogICAgICAgIHJldHVybiB0aGlzLmNvbG9yID0gY29sb3I7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5pc0NvbG9yaW5nID0gdHJ1ZTsKICAgICAgICB0aGlzLmNvbG9yRHVyYXRpb24gPSBkdXJhdGlvbjsKICAgICAgICB0aGlzLnRhcmdldENvbG9yID0gY29sb3I7CiAgICAgICAgcmV0dXJuIHRoaXMuY29sb3JDb3VudGVyID0gZHVyYXRpb247CiAgICAgIH0KICAgIH07CgogICAgTG9naWNfUGljdHVyZS5wcm90b3R5cGUucm90YXRlID0gZnVuY3Rpb24oZGlyZWN0aW9uLCBzcGVlZCwgZHVyYXRpb24pIHsKICAgICAgdGhpcy5pc1JvdGF0aW5nID0gdHJ1ZTsKICAgICAgdGhpcy5yb3RhdGlvbkRpcmVjdGlvbiA9IGRpcmVjdGlvbjsKICAgICAgdGhpcy5yb3RhdGlvblNwZWVkID0gc3BlZWQ7CiAgICAgIHJldHVybiB0aGlzLnJvdGF0aW9uRHVyYXRpb24gPSBkdXJhdGlvbjsKICAgIH07CgogICAgTG9naWNfUGljdHVyZS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMudXBkYXRlTW92aW5nKCk7CiAgICAgIHRoaXMudXBkYXRlWm9vbWluZygpOwogICAgICB0aGlzLnVwZGF0ZUJsZW5kaW5nKCk7CiAgICAgIHRoaXMudXBkYXRlVGludGluZygpOwogICAgICB0aGlzLnVwZGF0ZUNvbG9yaW5nKCk7CiAgICAgIHJldHVybiB0aGlzLnVwZGF0ZVJvdGF0aW9uKCk7CiAgICB9OwoKICAgIExvZ2ljX1BpY3R1cmUucHJvdG90eXBlLnVwZGF0ZU1vdmluZyA9IGZ1bmN0aW9uKCkgewogICAgICBpZiAoIXRoaXMuaXNNb3ZpbmcpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdGhpcy54ICs9IHRoaXMubW92ZUluY3JlbWVudFg7CiAgICAgIHRoaXMueSArPSB0aGlzLm1vdmVJbmNyZW1lbnRZOwogICAgICB0aGlzLm1vdmVEdXJhdGlvbi0tOwogICAgICBpZiAodGhpcy5tb3ZlRHVyYXRpb24gPT09IDApIHsKICAgICAgICB0aGlzLnggPSB0aGlzLnRhcmdldFg7CiAgICAgICAgdGhpcy55ID0gdGhpcy50YXJnZXRZOwogICAgICAgIHJldHVybiB0aGlzLmlzTW92aW5nID0gZmFsc2U7CiAgICAgIH0KICAgIH07CgogICAgTG9naWNfUGljdHVyZS5wcm90b3R5cGUudXBkYXRlWm9vbWluZyA9IGZ1bmN0aW9uKCkgewogICAgICBpZiAoIXRoaXMuaXNab29taW5nKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHRoaXMuem9vbVggKz0gdGhpcy56b29tSW5jcmVtZW50WDsKICAgICAgdGhpcy56b29tWSArPSB0aGlzLnpvb21JbmNyZW1lbnRZOwogICAgICB0aGlzLnpvb21EdXJhdGlvbi0tOwogICAgICBpZiAodGhpcy56b29tRHVyYXRpb24gPT09IDApIHsKICAgICAgICB0aGlzLnpvb21YID0gdGhpcy50YXJnZXRab29tWDsKICAgICAgICB0aGlzLnpvb21ZID0gdGhpcy50YXJnZXRab29tWTsKICAgICAgICByZXR1cm4gdGhpcy5pc1pvb21pbmcgPSBmYWxzZTsKICAgICAgfQogICAgfTsKCiAgICBMb2dpY19QaWN0dXJlLnByb3RvdHlwZS51cGRhdGVCbGVuZGluZyA9IGZ1bmN0aW9uKCkgewogICAgICBpZiAoIXRoaXMuaXNCbGVuZGluZykgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICB0aGlzLm9wYWNpdHkgPSBNYXRoLm1heChNYXRoLm1pbih0aGlzLm9wYWNpdHkgKyB0aGlzLmJsZW5kSW5jcmVtZW50LCAyNTUpLCAwKTsKICAgICAgdGhpcy5ibGVuZER1cmF0aW9uLS07CiAgICAgIGlmICh0aGlzLmJsZW5kRHVyYXRpb24gPT09IDApIHsKICAgICAgICB0aGlzLm9wYWNpdHkgPSB0aGlzLnRhcmdldE9wYWNpdHk7CiAgICAgICAgcmV0dXJuIHRoaXMuaXNCbGVuZGluZyA9IGZhbHNlOwogICAgICB9CiAgICB9OwoKICAgIExvZ2ljX1BpY3R1cmUucHJvdG90eXBlLnVwZGF0ZVRpbnRpbmcgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGE7CiAgICAgIGlmICghdGhpcy5pc1RpbnRpbmcpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgYSA9ICh0aGlzLnRpbnRDb3VudGVyIC8gdGhpcy50aW50RHVyYXRpb24pICogMjU1OwogICAgICB0aGlzLnRvbmUucmVkID0gTWF0aC5mbG9vcigodGhpcy50b25lLnJlZCAqIGEgKyB0aGlzLnRhcmdldFRvbmUucmVkICogKDI1NSAtIGEpKSAvIDI1NSk7CiAgICAgIHRoaXMudG9uZS5ncmVlbiA9IE1hdGguZmxvb3IoKHRoaXMudG9uZS5ncmVlbiAqIGEgKyB0aGlzLnRhcmdldFRvbmUuZ3JlZW4gKiAoMjU1IC0gYSkpIC8gMjU1KTsKICAgICAgdGhpcy50b25lLmJsdWUgPSBNYXRoLmZsb29yKCh0aGlzLnRvbmUuYmx1ZSAqIGEgKyB0aGlzLnRhcmdldFRvbmUuYmx1ZSAqICgyNTUgLSBhKSkgLyAyNTUpOwogICAgICB0aGlzLnRvbmUuZ3JleSA9IE1hdGguZmxvb3IoKHRoaXMudG9uZS5ncmV5ICogYSArIHRoaXMudGFyZ2V0VG9uZS5ncmV5ICogKDI1NSAtIGEpKSAvIDI1NSk7CiAgICAgIHRoaXMudGludENvdW50ZXItLTsKICAgICAgaWYgKHRoaXMudGludENvdW50ZXIgPD0gMCkgewogICAgICAgIHRoaXMuaXNUaW50aW5nID0gZmFsc2U7CiAgICAgICAgdGhpcy50aW50Q291bnRlciA9IDA7CiAgICAgICAgdGhpcy50aW50RHVyYXRpb24gPSAwOwogICAgICAgIHJldHVybiB0aGlzLnRvbmUgPSB0aGlzLnRhcmdldFRvbmU7CiAgICAgIH0KICAgIH07CgogICAgTG9naWNfUGljdHVyZS5wcm90b3R5cGUudXBkYXRlQ29sb3JpbmcgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGE7CiAgICAgIGlmICghdGhpcy5pc0NvbG9yaW5nKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGEgPSAodGhpcy5jb2xvckNvdW50ZXIgLyB0aGlzLmNvbG9yRHVyYXRpb24pICogMjU1OwogICAgICB0aGlzLmNvbG9yLnJlZCA9IE1hdGguZmxvb3IoKHRoaXMuY29sb3IucmVkICogYSArIHRoaXMudGFyZ2V0Q29sb3IucmVkICogKDI1NSAtIGEpKSAvIDI1NSk7CiAgICAgIHRoaXMuY29sb3IuZ3JlZW4gPSBNYXRoLmZsb29yKCh0aGlzLmNvbG9yLmdyZWVuICogYSArIHRoaXMudGFyZ2V0Q29sb3IuZ3JlZW4gKiAoMjU1IC0gYSkpIC8gMjU1KTsKICAgICAgdGhpcy5jb2xvci5ibHVlID0gTWF0aC5mbG9vcigodGhpcy5jb2xvci5ibHVlICogYSArIHRoaXMudGFyZ2V0Q29sb3IuYmx1ZSAqICgyNTUgLSBhKSkgLyAyNTUpOwogICAgICB0aGlzLmNvbG9yLmFscGhhID0gTWF0aC5mbG9vcigodGhpcy5jb2xvci5hbHBoYSAqIGEgKyB0aGlzLnRhcmdldENvbG9yLmFscGhhICogKDI1NSAtIGEpKSAvIDI1NSk7CiAgICAgIHRoaXMuY29sb3JDb3VudGVyLS07CiAgICAgIGlmICh0aGlzLmNvbG9yQ291bnRlciA8PSAwKSB7CiAgICAgICAgdGhpcy5pc0NvbG9yaW5nID0gZmFsc2U7CiAgICAgICAgdGhpcy5jb2xvckNvdW50ZXIgPSAwOwogICAgICAgIHRoaXMuY29sb3JEdXJhdGlvbiA9IDA7CiAgICAgICAgcmV0dXJuIHRoaXMuY29sb3IgPSB0aGlzLnRhcmdldENvbG9yOwogICAgICB9CiAgICB9OwoKICAgIExvZ2ljX1BpY3R1cmUucHJvdG90eXBlLnVwZGF0ZVJvdGF0aW9uID0gZnVuY3Rpb24oKSB7CiAgICAgIGlmICghdGhpcy5pc1JvdGF0aW5nKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGlmICh0aGlzLnJvdGF0aW9uRGlyZWN0aW9uID09PSAwKSB7CiAgICAgICAgdGhpcy5hbmdsZSArPSB0aGlzLnJvdGF0aW9uU3BlZWQ7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5hbmdsZSAtPSB0aGlzLnJvdGF0aW9uU3BlZWQ7CiAgICAgIH0KICAgICAgaWYgKHRoaXMucm90YXRpb25EdXJhdGlvbiA+IDApIHsKICAgICAgICB0aGlzLnJvdGF0aW9uRHVyYXRpb24tLTsKICAgICAgfQogICAgICBpZiAodGhpcy5yb3RhdGlvbkR1cmF0aW9uID09PSAwKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuaXNSb3RhdGluZyA9IGZhbHNlOwogICAgICB9CiAgICB9OwoKICAgIHJldHVybiBMb2dpY19QaWN0dXJlOwoKICB9KSgpOwoKICB3aW5kb3cuTG9naWNfUGljdHVyZSA9IExvZ2ljX1BpY3R1cmU7Cgp9KS5jYWxsKHRoaXMpOwo="},{"name":"Logic_Timer","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogTG9naWNfVGltZXIKIyAgIENyZWF0ZWQgb246IDIwMTMtMTItMDkKIwojICAgQ29weXJpZ2h0IChDKSAyMDEzIEFuZHLpIFJhZG9tc2tpLiBBbGwgcmlnaHRzIHJlc2VydmVkLgojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQojCiMgICBDbGFzczogTG9naWNfVGltZXIKIwojICAgQSBjbGFzcyBmb3IgdGhlIHNjcmVlbiB0byBoYW5kbGUgc2hha2luZywgdGludGluZywgZXRjLgojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKY2xhc3MgTG9naWNfVGltZXIKICAgIGNvbnN0cnVjdG9yOiAtPgogICAgICAgIEBtaW51dGVzID0gMAogICAgICAgIEBzZWNvbmRzID0gMAogICAgICAgIEBpc1J1bm5pbmcgPSBubwogICAgICAgIEBmcmFtZUNvdW50ID0gMAogICAgICAgIEBzdG9wV2F0Y2ggPSBubwogICAgc3RhcnQ6IC0+IAogICAgICAgIEBpc1J1bm5pbmcgPSB5ZXMKICAgICAgICBpZiBAc3RvcFdhdGNoCiAgICAgICAgICAgIEBmcmFtZUNvdW50ID0gMAogICAgICAgIGVsc2UKICAgICAgICAgICAgQGZyYW1lQ291bnQgPSBAbWludXRlcyAqIDYwICogNjAgKyBAc2Vjb25kcyAqIDYwCiAgICAgICAgCiAgICBzdG9wOiAtPiBAaXNSdW5uaW5nID0gbm8KICAgIAogICAgcmVzdW1lOiAtPiBAaXNSdW5uaW5nID0geWVzCiAgICAKICAgIHBhdXNlOiAtPiBAaXNSdW5uaW5nID0gbm8KICAgICAgICAKICAgIAogICAgdXBkYXRlOiAtPgogICAgICAgIGlmIEBzdG9wV2F0Y2gKICAgICAgICAgICAgQHVwZGF0ZVN0b3BXYXRjaCgpCiAgICAgICAgZWxzZQogICAgICAgICAgICBAdXBkYXRlVGltZXIoKQogICAgICAgICAgICAKICAgIHVwZGF0ZVRpbWVyOiAtPgogICAgICAgIGlmIEBmcmFtZUNvdW50ID09IDAgdGhlbiBAaXNSdW5uaW5nID0gbm8KICAgICAgICBpZiBub3QgQGlzUnVubmluZyB0aGVuIHJldHVybgogICAgICAgIAogICAgICAgIHNlY29uZHMgPSBNYXRoLnJvdW5kKEBmcmFtZUNvdW50IC8gNjApCiAgICAgICAgCiAgICAgICAgQHNlY29uZHMgPSBzZWNvbmRzICUgNjAKICAgICAgICBAbWludXRlcyA9IE1hdGguZmxvb3Ioc2Vjb25kcyAvIDYwKQogICAgICAgIAogICAgICAgIEBmcmFtZUNvdW50LS0KICAgIHVwZGF0ZVN0b3BXYXRjaDogLT4KICAgICAgICBpZiBub3QgQGlzUnVubmluZyB0aGVuIHJldHVybgogICAgICAgIAogICAgICAgIHNlY29uZHMgPSBNYXRoLnJvdW5kKEBmcmFtZUNvdW50IC8gNjApCiAgICAgICAgCiAgICAgICAgQHNlY29uZHMgPSBzZWNvbmRzICUgNjAKICAgICAgICBAbWludXRlcyA9IE1hdGguZmxvb3Ioc2Vjb25kcyAvIDYwKQogICAgICAgIAogICAgICAgIEBmcmFtZUNvdW50KysKICAgICAgICAKICAgICAgICAgICAgCgogICAgICAgIAogCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgCndpbmRvdy5Mb2dpY19UaW1lciA9IExvZ2ljX1RpbWVy","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBMb2dpY19UaW1lcjsKCiAgTG9naWNfVGltZXIgPSAoZnVuY3Rpb24oKSB7CiAgICBmdW5jdGlvbiBMb2dpY19UaW1lcigpIHsKICAgICAgdGhpcy5taW51dGVzID0gMDsKICAgICAgdGhpcy5zZWNvbmRzID0gMDsKICAgICAgdGhpcy5pc1J1bm5pbmcgPSBmYWxzZTsKICAgICAgdGhpcy5mcmFtZUNvdW50ID0gMDsKICAgICAgdGhpcy5zdG9wV2F0Y2ggPSBmYWxzZTsKICAgIH0KCiAgICBMb2dpY19UaW1lci5wcm90b3R5cGUuc3RhcnQgPSBmdW5jdGlvbigpIHsKICAgICAgdGhpcy5pc1J1bm5pbmcgPSB0cnVlOwogICAgICBpZiAodGhpcy5zdG9wV2F0Y2gpIHsKICAgICAgICByZXR1cm4gdGhpcy5mcmFtZUNvdW50ID0gMDsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gdGhpcy5mcmFtZUNvdW50ID0gdGhpcy5taW51dGVzICogNjAgKiA2MCArIHRoaXMuc2Vjb25kcyAqIDYwOwogICAgICB9CiAgICB9OwoKICAgIExvZ2ljX1RpbWVyLnByb3RvdHlwZS5zdG9wID0gZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiB0aGlzLmlzUnVubmluZyA9IGZhbHNlOwogICAgfTsKCiAgICBMb2dpY19UaW1lci5wcm90b3R5cGUucmVzdW1lID0gZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiB0aGlzLmlzUnVubmluZyA9IHRydWU7CiAgICB9OwoKICAgIExvZ2ljX1RpbWVyLnByb3RvdHlwZS5wYXVzZSA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gdGhpcy5pc1J1bm5pbmcgPSBmYWxzZTsKICAgIH07CgogICAgTG9naWNfVGltZXIucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkgewogICAgICBpZiAodGhpcy5zdG9wV2F0Y2gpIHsKICAgICAgICByZXR1cm4gdGhpcy51cGRhdGVTdG9wV2F0Y2goKTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gdGhpcy51cGRhdGVUaW1lcigpOwogICAgICB9CiAgICB9OwoKICAgIExvZ2ljX1RpbWVyLnByb3RvdHlwZS51cGRhdGVUaW1lciA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgc2Vjb25kczsKICAgICAgaWYgKHRoaXMuZnJhbWVDb3VudCA9PT0gMCkgewogICAgICAgIHRoaXMuaXNSdW5uaW5nID0gZmFsc2U7CiAgICAgIH0KICAgICAgaWYgKCF0aGlzLmlzUnVubmluZykgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBzZWNvbmRzID0gTWF0aC5yb3VuZCh0aGlzLmZyYW1lQ291bnQgLyA2MCk7CiAgICAgIHRoaXMuc2Vjb25kcyA9IHNlY29uZHMgJSA2MDsKICAgICAgdGhpcy5taW51dGVzID0gTWF0aC5mbG9vcihzZWNvbmRzIC8gNjApOwogICAgICByZXR1cm4gdGhpcy5mcmFtZUNvdW50LS07CiAgICB9OwoKICAgIExvZ2ljX1RpbWVyLnByb3RvdHlwZS51cGRhdGVTdG9wV2F0Y2ggPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIHNlY29uZHM7CiAgICAgIGlmICghdGhpcy5pc1J1bm5pbmcpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgc2Vjb25kcyA9IE1hdGgucm91bmQodGhpcy5mcmFtZUNvdW50IC8gNjApOwogICAgICB0aGlzLnNlY29uZHMgPSBzZWNvbmRzICUgNjA7CiAgICAgIHRoaXMubWludXRlcyA9IE1hdGguZmxvb3Ioc2Vjb25kcyAvIDYwKTsKICAgICAgcmV0dXJuIHRoaXMuZnJhbWVDb3VudCsrOwogICAgfTsKCiAgICByZXR1cm4gTG9naWNfVGltZXI7CgogIH0pKCk7CgogIHdpbmRvdy5Mb2dpY19UaW1lciA9IExvZ2ljX1RpbWVyOwoKfSkuY2FsbCh0aGlzKTsK"},{"name":"Logic_BattleMessage","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogTG9naWNfQmF0dGxlTWVzc2FnZQojICAgQ3JlYXRlZCBvbjogMjAxMy0xMi0yMgojCiMgICBDb3B5cmlnaHQgKEMpIDIwMTMgQW5kcukgUmFkb21za2kuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIENsYXNzOiBMb2dpY19CYXR0bGVNZXNzYWdlCiMKIyAgIEEgY2xhc3MgZm9yIHRoZSBzY3JlZW4gdG8gaGFuZGxlIHNoYWtpbmcsIHRpbnRpbmcsIGV0Yy4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCmNsYXNzIExvZ2ljX0JhdHRsZU1lc3NhZ2UKICAgIGNvbnN0cnVjdG9yOiAtPgogICAgICAgIEBtZXNzYWdlcyA9IFtdCiAgICAgICAgQHRpbWVyID0gMAogICAgICAgIEB3YWl0Rm9yS2V5ID0gbm8KICAgICAgICBAY3VycmVudFBhZ2UgPSAwCiAgICAgICAgQHJlZnJlc2hOZWVkZWQgPSB5ZXMKICAgICAgICAKICAgIHVwZGF0ZTogLT4KICAgICAgICBpZiBAbWVzc2FnZXMubGVuZ3RoID4gMCBhbmQgQG1lc3NhZ2VzW0BjdXJyZW50UGFnZV0/IGFuZCBAbWVzc2FnZXNbQGN1cnJlbnRQYWdlXS5sZW5ndGggPiAwCiAgICAgICAgICAgIGlmIEB0aW1lciA9PSAwIHRoZW4gQHRpbWVyID0gMTIwICAgICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIEB0aW1lciA+IDAgdGhlbiBAdGltZXItLQogICAgICAgICAgICAKICAgICAgICAgICAgaWYgQHdhaXRGb3JLZXkKICAgICAgICAgICAgICAgIGlmIElucHV0LnRyaWdnZXIoSW5wdXQuQykKICAgICAgICAgICAgICAgICAgICBAY3VycmVudFBhZ2UrKwogICAgICAgICAgICAgICAgICAgIGlmIEBjdXJyZW50UGFnZSA+PSBAbWVzc2FnZXMubGVuZ3RoCiAgICAgICAgICAgICAgICAgICAgICAgIEBjdXJyZW50UGFnZSA9IDAKICAgICAgICAgICAgICAgICAgICAgICAgQG1lc3NhZ2VzID0gW10KICAgICAgICAgICAgICAgICAgICAgICAgaWYgQG9uVGltZXJUaWNrPyB0aGVuIEBvblRpbWVyVGljaygpCiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICBAcmVmcmVzaE5lZWRlZCA9IHllcwogICAgICAgICAgICBlbHNlIGlmIEB0aW1lciA9PSAwCiAgICAgICAgICAgICAgICBAY3VycmVudFBhZ2UrKwogICAgICAgICAgICAgICAgaWYgQGN1cnJlbnRQYWdlID49IEBtZXNzYWdlcy5sZW5ndGgKICAgICAgICAgICAgICAgICAgICBAY3VycmVudFBhZ2UgPSAwCiAgICAgICAgICAgICAgICAgICAgQG1lc3NhZ2VzID0gW10KICAgICAgICAgICAgICAgICAgICBpZiBAb25UaW1lclRpY2s/IHRoZW4gQG9uVGltZXJUaWNrKCkKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICBAcmVmcmVzaE5lZWRlZCA9IHllcwogICAgICAgICAgICAgICAgICAgIAogICAgYWRkTWVzc2FnZTogKHBhZ2UsIG1lc3NhZ2UsIGZpbmlzaEhhbmRsZXIpIC0+CiAgICAgICAgaWYgbm90IEBtZXNzYWdlc1twYWdlXT8gdGhlbiBAbWVzc2FnZXNbcGFnZV0gPSBbXQogICAgICAgIEBtZXNzYWdlc1twYWdlXS5wdXNoKHsgdGV4dDogbWVzc2FnZSwgb25GaW5pc2g6IGZpbmlzaEhhbmRsZXJ9KQogICAgICAgIEByZWZyZXNoTmVlZGVkID0geWVzCiAgICAgICAgICAgIAoKICAgICAgICAKIAogICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgIAp3aW5kb3cuTG9naWNfQmF0dGxlTWVzc2FnZSA9IExvZ2ljX0JhdHRsZU1lc3NhZ2U=","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBMb2dpY19CYXR0bGVNZXNzYWdlOwoKICBMb2dpY19CYXR0bGVNZXNzYWdlID0gKGZ1bmN0aW9uKCkgewogICAgZnVuY3Rpb24gTG9naWNfQmF0dGxlTWVzc2FnZSgpIHsKICAgICAgdGhpcy5tZXNzYWdlcyA9IFtdOwogICAgICB0aGlzLnRpbWVyID0gMDsKICAgICAgdGhpcy53YWl0Rm9yS2V5ID0gZmFsc2U7CiAgICAgIHRoaXMuY3VycmVudFBhZ2UgPSAwOwogICAgICB0aGlzLnJlZnJlc2hOZWVkZWQgPSB0cnVlOwogICAgfQoKICAgIExvZ2ljX0JhdHRsZU1lc3NhZ2UucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkgewogICAgICBpZiAodGhpcy5tZXNzYWdlcy5sZW5ndGggPiAwICYmICh0aGlzLm1lc3NhZ2VzW3RoaXMuY3VycmVudFBhZ2VdICE9IG51bGwpICYmIHRoaXMubWVzc2FnZXNbdGhpcy5jdXJyZW50UGFnZV0ubGVuZ3RoID4gMCkgewogICAgICAgIGlmICh0aGlzLnRpbWVyID09PSAwKSB7CiAgICAgICAgICB0aGlzLnRpbWVyID0gMTIwOwogICAgICAgIH0KICAgICAgICBpZiAodGhpcy50aW1lciA+IDApIHsKICAgICAgICAgIHRoaXMudGltZXItLTsKICAgICAgICB9CiAgICAgICAgaWYgKHRoaXMud2FpdEZvcktleSkgewogICAgICAgICAgaWYgKElucHV0LnRyaWdnZXIoSW5wdXQuQykpIHsKICAgICAgICAgICAgdGhpcy5jdXJyZW50UGFnZSsrOwogICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50UGFnZSA+PSB0aGlzLm1lc3NhZ2VzLmxlbmd0aCkgewogICAgICAgICAgICAgIHRoaXMuY3VycmVudFBhZ2UgPSAwOwogICAgICAgICAgICAgIHRoaXMubWVzc2FnZXMgPSBbXTsKICAgICAgICAgICAgICBpZiAodGhpcy5vblRpbWVyVGljayAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5vblRpbWVyVGljaygpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZWZyZXNoTmVlZGVkID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAodGhpcy50aW1lciA9PT0gMCkgewogICAgICAgICAgdGhpcy5jdXJyZW50UGFnZSsrOwogICAgICAgICAgaWYgKHRoaXMuY3VycmVudFBhZ2UgPj0gdGhpcy5tZXNzYWdlcy5sZW5ndGgpIHsKICAgICAgICAgICAgdGhpcy5jdXJyZW50UGFnZSA9IDA7CiAgICAgICAgICAgIHRoaXMubWVzc2FnZXMgPSBbXTsKICAgICAgICAgICAgaWYgKHRoaXMub25UaW1lclRpY2sgIT0gbnVsbCkgewogICAgICAgICAgICAgIHJldHVybiB0aGlzLm9uVGltZXJUaWNrKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLnJlZnJlc2hOZWVkZWQgPSB0cnVlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICBMb2dpY19CYXR0bGVNZXNzYWdlLnByb3RvdHlwZS5hZGRNZXNzYWdlID0gZnVuY3Rpb24ocGFnZSwgbWVzc2FnZSwgZmluaXNoSGFuZGxlcikgewogICAgICBpZiAodGhpcy5tZXNzYWdlc1twYWdlXSA9PSBudWxsKSB7CiAgICAgICAgdGhpcy5tZXNzYWdlc1twYWdlXSA9IFtdOwogICAgICB9CiAgICAgIHRoaXMubWVzc2FnZXNbcGFnZV0ucHVzaCh7CiAgICAgICAgdGV4dDogbWVzc2FnZSwKICAgICAgICBvbkZpbmlzaDogZmluaXNoSGFuZGxlcgogICAgICB9KTsKICAgICAgcmV0dXJuIHRoaXMucmVmcmVzaE5lZWRlZCA9IHRydWU7CiAgICB9OwoKICAgIHJldHVybiBMb2dpY19CYXR0bGVNZXNzYWdlOwoKICB9KSgpOwoKICB3aW5kb3cuTG9naWNfQmF0dGxlTWVzc2FnZSA9IExvZ2ljX0JhdHRsZU1lc3NhZ2U7Cgp9KS5jYWxsKHRoaXMpOwo="},{"name":"Sprite_Character","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogU3ByaXRlX0NoYXJhY3RlcgojICAgQ3JlYXRlZCBvbjogMjAxMy0wOS0wMQojCiMgICBDb3B5cmlnaHQgKEMpIDIwMTMgQW5kcukgUmFkb21za2kuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIENsYXNzOiBTcHJpdGVfQ2hhcmFjdGVyCiMKIyAgIEEgYmFzZSBjbGFzcyBmb3IgYWxsIG90aGVyIHdpbmRvdyBjbGFzc2VzLgojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKY2xhc3MgU3ByaXRlX0NoYXJhY3RlciBleHRlbmRzIFNwcml0ZQogICAgY29uc3RydWN0b3I6IChsb2dpYywgdmlld3BvcnQpIC0+CiAgICAgICAgc3VwZXIodmlld3BvcnQpCiAgICAgICAgQGxvZ2ljID0gbG9naWMKICAgICAgICBAZ3JhcGhpYyA9IEBsb2dpYy5ncmFwaGljCiAgICAgICAgaWYgQGxvZ2ljLmdyYXBoaWM/IGFuZCBAbG9naWMuZ3JhcGhpYy5uYW1lPwogICAgICAgICAgICBAYml0bWFwID0gUmVzb3VyY2VNYW5hZ2VyLmdldEJpdG1hcCgiR3JhcGhpY3MvQ2hhcmFjdGVycy8je0Bsb2dpYy5ncmFwaGljLm5hbWV9IiwgQGxvZ2ljLmdyYXBoaWMuaHVlKQogICAgICAgIGVsc2UKICAgICAgICAgICAgQGJpdG1hcCA9IG51bGwKICAgICAgICBAb3ggPSAwCiAgICAgICAgQG95ID0gMAogICAgICAgIEB4ID0gQGxvZ2ljLngKICAgICAgICBAeSA9IEBsb2dpYy55CiAgICAgICAgQHpCeUxheWVyID0gWzE2NSwgNDgsIDQwXQogICAgICAgIEB6ID0gQHpCeUxheWVyW0Bsb2dpYy5sYXllcl0KICAgICAgICBAcGF0dGVybiA9IEBsb2dpYy5wYXR0ZXJuCiAgICAgICAgQHN1YlBhdHRlcm4gPSBAbG9naWMuc3ViUGF0dGVybgogICAgICAgIEBzcmNSZWN0ID0gbmV3IFJlY3QoMCwgMCwgMSwgMSkKICAgIHByZXBhcmU6IC0+CiAgICAgICAgQHVwZGF0ZVBhdHRlcm4oKQogICAgCiAgICB1cGRhdGVQYXR0ZXJuOiAtPgogICAgICAgIGlmIG5vdCBAYml0bWFwPyB0aGVuIHJldHVybgogICAgICAgIAogICAgICAgIHdpZHRoID0gTWF0aC5mbG9vcihAYml0bWFwLndpZHRoIC8gNCkKICAgICAgICBoZWlnaHQgPSBNYXRoLmZsb29yKEBiaXRtYXAuaGVpZ2h0IC8gNCkKICAgICAgICBjb2x1bW4gPSAoQHBhdHRlcm4gJSA0KSAqIDQgKyAoQHN1YlBhdHRlcm4gJSA0KQogICAgICAgIHJvdyA9IE1hdGguZmxvb3IoQHBhdHRlcm4gLyA0KSAqIDQgKyBNYXRoLmZsb29yKEBzdWJQYXR0ZXJuIC8gNCkgICAgICAgCgogICAgICAgIEBzcmNSZWN0ID0gbmV3IFJlY3QoY29sdW1uICogd2lkdGgsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgcm93ICogaGVpZ2h0LCB3aWR0aCwgaGVpZ2h0KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgCgogICAgdXBkYXRlOiAtPgogICAgICAgIHN1cGVyCiAgICAgICAgQHVwZGF0ZVBhdHRlcm4oKQogICAgICAgIAogICAgICAgIAogICAgICAKICAgICAgICBAeCA9IE1hdGguZmxvb3IoQGxvZ2ljLnggLSAoQHNyY1JlY3Qud2lkdGggLSBAbG9naWMubWFwLnRpbGVTaXplKSAvIDIpCiAgICAgICAgQHkgPSBNYXRoLmZsb29yKEBsb2dpYy55IC0gQHNyY1JlY3QuaGVpZ2h0ICsgQGxvZ2ljLm1hcC50aWxlU2l6ZSkKICAgICAgICAKICAgICAgICB3aWR0aCA9IEBsb2dpYy5tYXAud2lkdGggKiBAbG9naWMubWFwLnRpbGVTaXplCiAgICAgICAgaGVpZ2h0ID0gQGxvZ2ljLm1hcC5oZWlnaHQgKiBAbG9naWMubWFwLnRpbGVTaXplCgogICAgICAgIGlmIEBsb2dpYy5tYXAubG9vcFR5cGUgPT0gMiBvciBAbG9naWMubWFwLmxvb3BUeXBlID09IDMKICAgICAgICAgICAgQG94ID0gTWF0aC5mbG9vcigoKEB4K0BzcmNSZWN0LndpZHRoKSAtIChAdmlld3BvcnQub3gpKSAvIHdpZHRoKSAqIHdpZHRoCiAgICAgICAgaWYgQGxvZ2ljLm1hcC5sb29wVHlwZSA9PSAxIG9yIEBsb2dpYy5tYXAubG9vcFR5cGUgPT0gMwogICAgICAgICAgICBAb3kgPSBNYXRoLmZsb29yKCgoQHkrQHNyY1JlY3QuaGVpZ2h0KSAtIChAdmlld3BvcnQub3kpKSAvIGhlaWdodCkgKiBoZWlnaHQKIAogICAgICAgIEB6ID0gQHpCeUxheWVyW0Bsb2dpYy5sYXllcl0KICAgICAgICBAcGF0dGVybiA9IEBsb2dpYy5wYXR0ZXJuCiAgICAgICAgQHN1YlBhdHRlcm4gPSBAbG9naWMuc3ViUGF0dGVybgogICAgICAgIAogICAgICAgICMgU2hvdyBJZGxlLVBhdHRlcm4gb25seSBpZiB0aGUgY2hhcmFjdGVyIGlzIG5vdCBtb3ZpbmcKICAgICAgICBpZiBAc3ViUGF0dGVybiA9PSAwICYmIEBsb2dpYy5pc01vdmluZyB0aGVuIEBzdWJQYXR0ZXJuID0gMgogICAgICAgIGVsc2UgaWYgQHN1YlBhdHRlcm4gPT0gNCAmJiBAbG9naWMuaXNNb3ZpbmcgdGhlbiBAc3ViUGF0dGVybiA9IDYKICAgICAgICBlbHNlIGlmIEBzdWJQYXR0ZXJuID09IDEyICYmIEBsb2dpYy5pc01vdmluZyB0aGVuIEBzdWJQYXR0ZXJuID0gMTQKICAgICAgICBlbHNlIGlmIEBzdWJQYXR0ZXJuID09IDggJiYgQGxvZ2ljLmlzTW92aW5nIHRoZW4gQHN1YlBhdHRlcm4gPSAxMAogICAgCiAgICAgICAgQG9wYWNpdHkgPSBAbG9naWMub3BhY2l0eQogICAgICAgIEBibGVuZGluZ01vZGUgPSBAbG9naWMuYmxlbmRpbmcKICAgICAgICBAdG9uZSA9IEBsb2dpYy50b25lCiAgICAgICAgQHZpc2libGUgPSBAbG9naWMudmlzaWJsZQogICAgICAgIEBtb3Rpb25CbHVyID0gQGxvZ2ljLm1vdGlvbkJsdXIKICAgICAgICBAbW90aW9uQmx1ckxlbmd0aCA9IEBsb2dpYy5tb3Rpb25CbHVyTGVuZ3RoCiAgICAgICAgQG1vdGlvbkJsdXJPcGFjaXR5ID0gQGxvZ2ljLm1vdGlvbkJsdXJPcGFjaXR5CiAgICAgICAgQG1vdGlvbkJsdXJDb2xvciA9IEBsb2dpYy5tb3Rpb25CbHVyQ29sb3IgfHwgQ29sb3IuVFJBTlNQQVJFTlQKICAgICAgICBpZiBAbG9naWMuZ3JhcGhpYyAhPSBAZ3JhcGhpYwogICAgICAgICAgICBAZ3JhcGhpYyA9IEBsb2dpYy5ncmFwaGljCiAgICAgICAgICAgIGlmIEBncmFwaGljPwogICAgICAgICAgICAgICAgQGJpdG1hcCA9IFJlc291cmNlTWFuYWdlci5nZXRCaXRtYXAoIkdyYXBoaWNzL0NoYXJhY3RlcnMvI3tAZ3JhcGhpYy5uYW1lfSIpCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIEBiaXRtYXAgPSBudWxsCiAgICAgICAgICAgICAgICAKICAgICAgIAogICAgICAgIEBzdWJPcGFjaXR5ID0gaWYgQGxvZ2ljLmJ1c2hGbGFnIHRoZW4gMTI4IGVsc2UgMAogICAgICAgIEBzdWJPcGFjaXR5SGVpZ2h0ID0gaWYgQGxvZ2ljLmJ1c2hGbGFnIHRoZW4gMTIgKiBXaW5kb3dfQmFzZS5zY2FsZSBlbHNlIDAKICAgICAgICAKCiAgICAgICAgCndpbmRvdy5TcHJpdGVfQ2hhcmFjdGVyID0gU3ByaXRlX0NoYXJhY3Rlcg==","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBTcHJpdGVfQ2hhcmFjdGVyLAogICAgX19oYXNQcm9wID0ge30uaGFzT3duUHJvcGVydHksCiAgICBfX2V4dGVuZHMgPSBmdW5jdGlvbihjaGlsZCwgcGFyZW50KSB7IGZvciAodmFyIGtleSBpbiBwYXJlbnQpIHsgaWYgKF9faGFzUHJvcC5jYWxsKHBhcmVudCwga2V5KSkgY2hpbGRba2V5XSA9IHBhcmVudFtrZXldOyB9IGZ1bmN0aW9uIGN0b3IoKSB7IHRoaXMuY29uc3RydWN0b3IgPSBjaGlsZDsgfSBjdG9yLnByb3RvdHlwZSA9IHBhcmVudC5wcm90b3R5cGU7IGNoaWxkLnByb3RvdHlwZSA9IG5ldyBjdG9yKCk7IGNoaWxkLl9fc3VwZXJfXyA9IHBhcmVudC5wcm90b3R5cGU7IHJldHVybiBjaGlsZDsgfTsKCiAgU3ByaXRlX0NoYXJhY3RlciA9IChmdW5jdGlvbihfc3VwZXIpIHsKICAgIF9fZXh0ZW5kcyhTcHJpdGVfQ2hhcmFjdGVyLCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFNwcml0ZV9DaGFyYWN0ZXIobG9naWMsIHZpZXdwb3J0KSB7CiAgICAgIFNwcml0ZV9DaGFyYWN0ZXIuX19zdXBlcl9fLmNvbnN0cnVjdG9yLmNhbGwodGhpcywgdmlld3BvcnQpOwogICAgICB0aGlzLmxvZ2ljID0gbG9naWM7CiAgICAgIHRoaXMuZ3JhcGhpYyA9IHRoaXMubG9naWMuZ3JhcGhpYzsKICAgICAgaWYgKCh0aGlzLmxvZ2ljLmdyYXBoaWMgIT0gbnVsbCkgJiYgKHRoaXMubG9naWMuZ3JhcGhpYy5uYW1lICE9IG51bGwpKSB7CiAgICAgICAgdGhpcy5iaXRtYXAgPSBSZXNvdXJjZU1hbmFnZXIuZ2V0Qml0bWFwKCJHcmFwaGljcy9DaGFyYWN0ZXJzLyIgKyB0aGlzLmxvZ2ljLmdyYXBoaWMubmFtZSwgdGhpcy5sb2dpYy5ncmFwaGljLmh1ZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5iaXRtYXAgPSBudWxsOwogICAgICB9CiAgICAgIHRoaXMub3ggPSAwOwogICAgICB0aGlzLm95ID0gMDsKICAgICAgdGhpcy54ID0gdGhpcy5sb2dpYy54OwogICAgICB0aGlzLnkgPSB0aGlzLmxvZ2ljLnk7CiAgICAgIHRoaXMuekJ5TGF5ZXIgPSBbMTY1LCA0OCwgNDBdOwogICAgICB0aGlzLnogPSB0aGlzLnpCeUxheWVyW3RoaXMubG9naWMubGF5ZXJdOwogICAgICB0aGlzLnBhdHRlcm4gPSB0aGlzLmxvZ2ljLnBhdHRlcm47CiAgICAgIHRoaXMuc3ViUGF0dGVybiA9IHRoaXMubG9naWMuc3ViUGF0dGVybjsKICAgICAgdGhpcy5zcmNSZWN0ID0gbmV3IFJlY3QoMCwgMCwgMSwgMSk7CiAgICB9CgogICAgU3ByaXRlX0NoYXJhY3Rlci5wcm90b3R5cGUucHJlcGFyZSA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gdGhpcy51cGRhdGVQYXR0ZXJuKCk7CiAgICB9OwoKICAgIFNwcml0ZV9DaGFyYWN0ZXIucHJvdG90eXBlLnVwZGF0ZVBhdHRlcm4gPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGNvbHVtbiwgaGVpZ2h0LCByb3csIHdpZHRoOwogICAgICBpZiAodGhpcy5iaXRtYXAgPT0gbnVsbCkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICB3aWR0aCA9IE1hdGguZmxvb3IodGhpcy5iaXRtYXAud2lkdGggLyA0KTsKICAgICAgaGVpZ2h0ID0gTWF0aC5mbG9vcih0aGlzLmJpdG1hcC5oZWlnaHQgLyA0KTsKICAgICAgY29sdW1uID0gKHRoaXMucGF0dGVybiAlIDQpICogNCArICh0aGlzLnN1YlBhdHRlcm4gJSA0KTsKICAgICAgcm93ID0gTWF0aC5mbG9vcih0aGlzLnBhdHRlcm4gLyA0KSAqIDQgKyBNYXRoLmZsb29yKHRoaXMuc3ViUGF0dGVybiAvIDQpOwogICAgICByZXR1cm4gdGhpcy5zcmNSZWN0ID0gbmV3IFJlY3QoY29sdW1uICogd2lkdGgsIHJvdyAqIGhlaWdodCwgd2lkdGgsIGhlaWdodCk7CiAgICB9OwoKICAgIFNwcml0ZV9DaGFyYWN0ZXIucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgaGVpZ2h0LCB3aWR0aDsKICAgICAgU3ByaXRlX0NoYXJhY3Rlci5fX3N1cGVyX18udXBkYXRlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIHRoaXMudXBkYXRlUGF0dGVybigpOwogICAgICB0aGlzLnggPSBNYXRoLmZsb29yKHRoaXMubG9naWMueCAtICh0aGlzLnNyY1JlY3Qud2lkdGggLSB0aGlzLmxvZ2ljLm1hcC50aWxlU2l6ZSkgLyAyKTsKICAgICAgdGhpcy55ID0gTWF0aC5mbG9vcih0aGlzLmxvZ2ljLnkgLSB0aGlzLnNyY1JlY3QuaGVpZ2h0ICsgdGhpcy5sb2dpYy5tYXAudGlsZVNpemUpOwogICAgICB3aWR0aCA9IHRoaXMubG9naWMubWFwLndpZHRoICogdGhpcy5sb2dpYy5tYXAudGlsZVNpemU7CiAgICAgIGhlaWdodCA9IHRoaXMubG9naWMubWFwLmhlaWdodCAqIHRoaXMubG9naWMubWFwLnRpbGVTaXplOwogICAgICBpZiAodGhpcy5sb2dpYy5tYXAubG9vcFR5cGUgPT09IDIgfHwgdGhpcy5sb2dpYy5tYXAubG9vcFR5cGUgPT09IDMpIHsKICAgICAgICB0aGlzLm94ID0gTWF0aC5mbG9vcigoKHRoaXMueCArIHRoaXMuc3JjUmVjdC53aWR0aCkgLSB0aGlzLnZpZXdwb3J0Lm94KSAvIHdpZHRoKSAqIHdpZHRoOwogICAgICB9CiAgICAgIGlmICh0aGlzLmxvZ2ljLm1hcC5sb29wVHlwZSA9PT0gMSB8fCB0aGlzLmxvZ2ljLm1hcC5sb29wVHlwZSA9PT0gMykgewogICAgICAgIHRoaXMub3kgPSBNYXRoLmZsb29yKCgodGhpcy55ICsgdGhpcy5zcmNSZWN0LmhlaWdodCkgLSB0aGlzLnZpZXdwb3J0Lm95KSAvIGhlaWdodCkgKiBoZWlnaHQ7CiAgICAgIH0KICAgICAgdGhpcy56ID0gdGhpcy56QnlMYXllclt0aGlzLmxvZ2ljLmxheWVyXTsKICAgICAgdGhpcy5wYXR0ZXJuID0gdGhpcy5sb2dpYy5wYXR0ZXJuOwogICAgICB0aGlzLnN1YlBhdHRlcm4gPSB0aGlzLmxvZ2ljLnN1YlBhdHRlcm47CiAgICAgIGlmICh0aGlzLnN1YlBhdHRlcm4gPT09IDAgJiYgdGhpcy5sb2dpYy5pc01vdmluZykgewogICAgICAgIHRoaXMuc3ViUGF0dGVybiA9IDI7CiAgICAgIH0gZWxzZSBpZiAodGhpcy5zdWJQYXR0ZXJuID09PSA0ICYmIHRoaXMubG9naWMuaXNNb3ZpbmcpIHsKICAgICAgICB0aGlzLnN1YlBhdHRlcm4gPSA2OwogICAgICB9IGVsc2UgaWYgKHRoaXMuc3ViUGF0dGVybiA9PT0gMTIgJiYgdGhpcy5sb2dpYy5pc01vdmluZykgewogICAgICAgIHRoaXMuc3ViUGF0dGVybiA9IDE0OwogICAgICB9IGVsc2UgaWYgKHRoaXMuc3ViUGF0dGVybiA9PT0gOCAmJiB0aGlzLmxvZ2ljLmlzTW92aW5nKSB7CiAgICAgICAgdGhpcy5zdWJQYXR0ZXJuID0gMTA7CiAgICAgIH0KICAgICAgdGhpcy5vcGFjaXR5ID0gdGhpcy5sb2dpYy5vcGFjaXR5OwogICAgICB0aGlzLmJsZW5kaW5nTW9kZSA9IHRoaXMubG9naWMuYmxlbmRpbmc7CiAgICAgIHRoaXMudG9uZSA9IHRoaXMubG9naWMudG9uZTsKICAgICAgdGhpcy52aXNpYmxlID0gdGhpcy5sb2dpYy52aXNpYmxlOwogICAgICB0aGlzLm1vdGlvbkJsdXIgPSB0aGlzLmxvZ2ljLm1vdGlvbkJsdXI7CiAgICAgIHRoaXMubW90aW9uQmx1ckxlbmd0aCA9IHRoaXMubG9naWMubW90aW9uQmx1ckxlbmd0aDsKICAgICAgdGhpcy5tb3Rpb25CbHVyT3BhY2l0eSA9IHRoaXMubG9naWMubW90aW9uQmx1ck9wYWNpdHk7CiAgICAgIHRoaXMubW90aW9uQmx1ckNvbG9yID0gdGhpcy5sb2dpYy5tb3Rpb25CbHVyQ29sb3IgfHwgQ29sb3IuVFJBTlNQQVJFTlQ7CiAgICAgIGlmICh0aGlzLmxvZ2ljLmdyYXBoaWMgIT09IHRoaXMuZ3JhcGhpYykgewogICAgICAgIHRoaXMuZ3JhcGhpYyA9IHRoaXMubG9naWMuZ3JhcGhpYzsKICAgICAgICBpZiAodGhpcy5ncmFwaGljICE9IG51bGwpIHsKICAgICAgICAgIHRoaXMuYml0bWFwID0gUmVzb3VyY2VNYW5hZ2VyLmdldEJpdG1hcCgiR3JhcGhpY3MvQ2hhcmFjdGVycy8iICsgdGhpcy5ncmFwaGljLm5hbWUpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLmJpdG1hcCA9IG51bGw7CiAgICAgICAgfQogICAgICB9CiAgICAgIHRoaXMuc3ViT3BhY2l0eSA9IHRoaXMubG9naWMuYnVzaEZsYWcgPyAxMjggOiAwOwogICAgICByZXR1cm4gdGhpcy5zdWJPcGFjaXR5SGVpZ2h0ID0gdGhpcy5sb2dpYy5idXNoRmxhZyA/IDEyICogV2luZG93X0Jhc2Uuc2NhbGUgOiAwOwogICAgfTsKCiAgICByZXR1cm4gU3ByaXRlX0NoYXJhY3RlcjsKCiAgfSkoU3ByaXRlKTsKCiAgd2luZG93LlNwcml0ZV9DaGFyYWN0ZXIgPSBTcHJpdGVfQ2hhcmFjdGVyOwoKfSkuY2FsbCh0aGlzKTsK"},{"name":"Sprite_Shadow","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogU3ByaXRlX1NoYWRvdwojICAgQ3JlYXRlZCBvbjogMjAxMy0xMS0wMwojCiMgICBDb3B5cmlnaHQgKEMpIDIwMTMgQW5kcukgUmFkb21za2kuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIENsYXNzOiBTcHJpdGVfU2hhZG93CiMKIyAgIEEgc3ByaXRlIHRvIGRpc3BsYXkgdGV4dAojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKY2xhc3MgU3ByaXRlX1NoYWRvdyBleHRlbmRzIFNwcml0ZQogICAgY29uc3RydWN0b3I6IChsb2dpYywgdmlld3BvcnQpIC0+CiAgICAgICAgc3VwZXIodmlld3BvcnQpCiAgICAgICAgCiAgICAgICAgQGxvZ2ljID0gbG9naWMKICAgICAgICBAYml0bWFwID0gUmVzb3VyY2VNYW5hZ2VyLmdldEJpdG1hcCgiR3JhcGhpY3MvU2hhZG93IikKICAgICAgICBAc3JjUmVjdCA9IG5ldyBSZWN0KDAsIDAsIEBiaXRtYXAud2lkdGgsIEBiaXRtYXAuaGVpZ2h0KQogICAgdXBkYXRlOiAtPgogICAgICAgIEB4ID0gQGxvZ2ljLngKICAgICAgICBAeSA9IEBsb2dpYy55ICsgQGxvZ2ljLmFsdGl0dWRlICogMzIKICAgICAgICBAeiA9IDQ4CiAgCiAgICAgICAgc3VwZXIKICAgICAgICAgICAgCiAgIAogICAgICAgIAogICAgICAgIAp3aW5kb3cuU3ByaXRlX1NoYWRvdyA9IFNwcml0ZV9TaGFkb3c=","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBTcHJpdGVfU2hhZG93LAogICAgX19oYXNQcm9wID0ge30uaGFzT3duUHJvcGVydHksCiAgICBfX2V4dGVuZHMgPSBmdW5jdGlvbihjaGlsZCwgcGFyZW50KSB7IGZvciAodmFyIGtleSBpbiBwYXJlbnQpIHsgaWYgKF9faGFzUHJvcC5jYWxsKHBhcmVudCwga2V5KSkgY2hpbGRba2V5XSA9IHBhcmVudFtrZXldOyB9IGZ1bmN0aW9uIGN0b3IoKSB7IHRoaXMuY29uc3RydWN0b3IgPSBjaGlsZDsgfSBjdG9yLnByb3RvdHlwZSA9IHBhcmVudC5wcm90b3R5cGU7IGNoaWxkLnByb3RvdHlwZSA9IG5ldyBjdG9yKCk7IGNoaWxkLl9fc3VwZXJfXyA9IHBhcmVudC5wcm90b3R5cGU7IHJldHVybiBjaGlsZDsgfTsKCiAgU3ByaXRlX1NoYWRvdyA9IChmdW5jdGlvbihfc3VwZXIpIHsKICAgIF9fZXh0ZW5kcyhTcHJpdGVfU2hhZG93LCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFNwcml0ZV9TaGFkb3cobG9naWMsIHZpZXdwb3J0KSB7CiAgICAgIFNwcml0ZV9TaGFkb3cuX19zdXBlcl9fLmNvbnN0cnVjdG9yLmNhbGwodGhpcywgdmlld3BvcnQpOwogICAgICB0aGlzLmxvZ2ljID0gbG9naWM7CiAgICAgIHRoaXMuYml0bWFwID0gUmVzb3VyY2VNYW5hZ2VyLmdldEJpdG1hcCgiR3JhcGhpY3MvU2hhZG93Iik7CiAgICAgIHRoaXMuc3JjUmVjdCA9IG5ldyBSZWN0KDAsIDAsIHRoaXMuYml0bWFwLndpZHRoLCB0aGlzLmJpdG1hcC5oZWlnaHQpOwogICAgfQoKICAgIFNwcml0ZV9TaGFkb3cucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkgewogICAgICB0aGlzLnggPSB0aGlzLmxvZ2ljLng7CiAgICAgIHRoaXMueSA9IHRoaXMubG9naWMueSArIHRoaXMubG9naWMuYWx0aXR1ZGUgKiAzMjsKICAgICAgdGhpcy56ID0gNDg7CiAgICAgIHJldHVybiBTcHJpdGVfU2hhZG93Ll9fc3VwZXJfXy51cGRhdGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH07CgogICAgcmV0dXJuIFNwcml0ZV9TaGFkb3c7CgogIH0pKFNwcml0ZSk7CgogIHdpbmRvdy5TcHJpdGVfU2hhZG93ID0gU3ByaXRlX1NoYWRvdzsKCn0pLmNhbGwodGhpcyk7Cg=="},{"name":"Sprite_Text","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogU3ByaXRlX1RleHQKIyAgIENyZWF0ZWQgb246IDIwMTMtMTAtMjYKIwojICAgQ29weXJpZ2h0IChDKSAyMDEzIEFuZHLpIFJhZG9tc2tpLiBBbGwgcmlnaHRzIHJlc2VydmVkLgojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQojCiMgICBDbGFzczogU3ByaXRlX1RleHQKIwojICAgQSBzcHJpdGUgdG8gZGlzcGxheSB0ZXh0CiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpjbGFzcyBTcHJpdGVfVGV4dCBleHRlbmRzIFNwcml0ZQogICAgY29uc3RydWN0b3I6ICh3aWR0aCwgaGVpZ2h0LCB2aWV3cG9ydCkgLT4KICAgICAgICBzdXBlcih2aWV3cG9ydCkKICAgICAgICAKICAgICAgICBAYml0bWFwID0gbmV3IEJpdG1hcCh3aWR0aCwgaGVpZ2h0KQogICAgICAgIEBiaXRtYXAuZm9udCA9IEZvbnRzLlRFWFQKICAgICAgICBAc3JjUmVjdCA9IG5ldyBSZWN0KDAsIDAsIEBiaXRtYXAud2lkdGgsIEBiaXRtYXAuaGVpZ2h0KQogICAgICAgIEB0ZXh0ID0gIiIKICAgICAgICBAZm9yZWdyb3VuZENvbG9yID0gQ29sb3JzLldISVRFCiAgICAgICAgQGJhY2tncm91bmRDb2xvciA9IG5ldyBDb2xvcigwLCAwLCAwLCAwLjIpCiAgICAgICAgQGFsaWdubWVudCA9IDAKICAgICAgICBAdmlzaWJsZSA9IG5vCiAgICByZWRyYXc6IC0+CiAgICAgICAgaWYgQHRleHQ/CiAgICAgICAgICAgIEBiaXRtYXAuY2xlYXIoKQogICAgICAgICAgICBAYml0bWFwLmZvbnQuY29sb3IgPSBAZm9yZWdyb3VuZENvbG9yCiAgICAgICAgICAgIAogICAgICAgICAgICBAYml0bWFwLmZpbGxSZWN0KDAsIDAsIEBiaXRtYXAud2lkdGgsIEBiaXRtYXAuaGVpZ2h0LCBAYmFja2dyb3VuZENvbG9yKQogICAgICAgICAgICBAYml0bWFwLmRyYXdUZXh0KDAsIDAsIEBiaXRtYXAud2lkdGgsIEBiaXRtYXAuaGVpZ2h0LCBAdGV4dCwgQGFsaWdubWVudCkKICAgICAKICAgIHJlZnJlc2g6IC0+IEByZWRyYXcoKQogICAgCiAgICB1cGRhdGU6IC0+CiAgICAgICAgc3VwZXIKICAgICAgICAgICAgCiAgIAogICAgICAgIAogICAgICAgIAp3aW5kb3cuU3ByaXRlX1RleHQgPSBTcHJpdGVfVGV4dA==","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBTcHJpdGVfVGV4dCwKICAgIF9faGFzUHJvcCA9IHt9Lmhhc093blByb3BlcnR5LAogICAgX19leHRlbmRzID0gZnVuY3Rpb24oY2hpbGQsIHBhcmVudCkgeyBmb3IgKHZhciBrZXkgaW4gcGFyZW50KSB7IGlmIChfX2hhc1Byb3AuY2FsbChwYXJlbnQsIGtleSkpIGNoaWxkW2tleV0gPSBwYXJlbnRba2V5XTsgfSBmdW5jdGlvbiBjdG9yKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gY2hpbGQ7IH0gY3Rvci5wcm90b3R5cGUgPSBwYXJlbnQucHJvdG90eXBlOyBjaGlsZC5wcm90b3R5cGUgPSBuZXcgY3RvcigpOyBjaGlsZC5fX3N1cGVyX18gPSBwYXJlbnQucHJvdG90eXBlOyByZXR1cm4gY2hpbGQ7IH07CgogIFNwcml0ZV9UZXh0ID0gKGZ1bmN0aW9uKF9zdXBlcikgewogICAgX19leHRlbmRzKFNwcml0ZV9UZXh0LCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFNwcml0ZV9UZXh0KHdpZHRoLCBoZWlnaHQsIHZpZXdwb3J0KSB7CiAgICAgIFNwcml0ZV9UZXh0Ll9fc3VwZXJfXy5jb25zdHJ1Y3Rvci5jYWxsKHRoaXMsIHZpZXdwb3J0KTsKICAgICAgdGhpcy5iaXRtYXAgPSBuZXcgQml0bWFwKHdpZHRoLCBoZWlnaHQpOwogICAgICB0aGlzLmJpdG1hcC5mb250ID0gRm9udHMuVEVYVDsKICAgICAgdGhpcy5zcmNSZWN0ID0gbmV3IFJlY3QoMCwgMCwgdGhpcy5iaXRtYXAud2lkdGgsIHRoaXMuYml0bWFwLmhlaWdodCk7CiAgICAgIHRoaXMudGV4dCA9ICIiOwogICAgICB0aGlzLmZvcmVncm91bmRDb2xvciA9IENvbG9ycy5XSElURTsKICAgICAgdGhpcy5iYWNrZ3JvdW5kQ29sb3IgPSBuZXcgQ29sb3IoMCwgMCwgMCwgMC4yKTsKICAgICAgdGhpcy5hbGlnbm1lbnQgPSAwOwogICAgICB0aGlzLnZpc2libGUgPSBmYWxzZTsKICAgIH0KCiAgICBTcHJpdGVfVGV4dC5wcm90b3R5cGUucmVkcmF3ID0gZnVuY3Rpb24oKSB7CiAgICAgIGlmICh0aGlzLnRleHQgIT0gbnVsbCkgewogICAgICAgIHRoaXMuYml0bWFwLmNsZWFyKCk7CiAgICAgICAgdGhpcy5iaXRtYXAuZm9udC5jb2xvciA9IHRoaXMuZm9yZWdyb3VuZENvbG9yOwogICAgICAgIHRoaXMuYml0bWFwLmZpbGxSZWN0KDAsIDAsIHRoaXMuYml0bWFwLndpZHRoLCB0aGlzLmJpdG1hcC5oZWlnaHQsIHRoaXMuYmFja2dyb3VuZENvbG9yKTsKICAgICAgICByZXR1cm4gdGhpcy5iaXRtYXAuZHJhd1RleHQoMCwgMCwgdGhpcy5iaXRtYXAud2lkdGgsIHRoaXMuYml0bWFwLmhlaWdodCwgdGhpcy50ZXh0LCB0aGlzLmFsaWdubWVudCk7CiAgICAgIH0KICAgIH07CgogICAgU3ByaXRlX1RleHQucHJvdG90eXBlLnJlZnJlc2ggPSBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIHRoaXMucmVkcmF3KCk7CiAgICB9OwoKICAgIFNwcml0ZV9UZXh0LnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIFNwcml0ZV9UZXh0Ll9fc3VwZXJfXy51cGRhdGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH07CgogICAgcmV0dXJuIFNwcml0ZV9UZXh0OwoKICB9KShTcHJpdGUpOwoKICB3aW5kb3cuU3ByaXRlX1RleHQgPSBTcHJpdGVfVGV4dDsKCn0pLmNhbGwodGhpcyk7Cg=="},{"name":"Sprite_Damage","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogU3ByaXRlX0RhbWFnZQojICAgQ3JlYXRlZCBvbjogMjAxMy0xMC0wNgojCiMgICBDb3B5cmlnaHQgKEMpIDIwMTMgQW5kcukgUmFkb21za2kuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIENsYXNzOiBTcHJpdGVfRGFtYWdlCiMKIyAgIEEgYmFzZSBjbGFzcyBmb3IgYWxsIG90aGVyIHdpbmRvdyBjbGFzc2VzLgojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKY2xhc3MgU3ByaXRlX0RhbWFnZSBleHRlbmRzIFNwcml0ZQogICAgY29uc3RydWN0b3I6IChsb2dpYywgdmlld3BvcnQpIC0+CiAgICAgICAgc3VwZXIodmlld3BvcnQpCiAgICAgICAgCiAgICAgICAgQGxvZ2ljID0gbG9naWMKICAgICAgICAKICAgICAgICBAYml0bWFwID0gbmV3IEJpdG1hcCgzMDAsIDIwKQogICAgICAgIEBiaXRtYXAuZm9udCA9IEZvbnRzLkRBTUFHRQogICAgICAgIEBzcmNSZWN0ID0gbmV3IFJlY3QoMCwgMCwgQGJpdG1hcC53aWR0aCwgQGJpdG1hcC5oZWlnaHQpCiAgICAgICAgQGlzUnVubmluZyA9IG5vCiAgICAgICAgQHRhcmdldCA9IG51bGwKICAgICAgICBAb3BhY2l0eSA9IDAKICAgICAgICBAdmlzaWJsZSA9IG5vCiAgICAgICAgCiAgICByZWRyYXc6IC0+CiAgICAgICAgaWYgQGxvZ2ljPwogICAgICAgICAgICBAYml0bWFwLmNsZWFyKCkKICAgICAgICAgICAgQGJpdG1hcC5mb250LmNvbG9yID0gQGxvZ2ljLmNvbG9yCiAgICAgICAgICAgIEBiaXRtYXAuZHJhd1RleHQoMCwgMCwgQGJpdG1hcC53aWR0aCwgQGJpdG1hcC5oZWlnaHQsIEBsb2dpYy50ZXh0KQogICAgICAgICAgICAKICAgICAgICAgICAgQG9wYWNpdHkgPSAyNTUKICAgICAgICAgICAgaWYgQHRhcmdldD8KICAgICAgICAgICAgICAgIEB4ID0gQHRhcmdldC54ICsgQHRhcmdldC5zcmNSZWN0LndpZHRoIC8gMiAtIEB0YXJnZXQub3gKICAgICAgICAgICAgICAgIEB5ID0gQHRhcmdldC55ICsgQHRhcmdldC5zcmNSZWN0LmhlaWdodCAvIDIgLSBAdGFyZ2V0Lm95CiAgICAgICAgICAgIAogICAgcmVmcmVzaDogLT4gQHJlZHJhdygpCiAgICAKICAgIHVwZGF0ZTogLT4KICAgICAgICBzdXBlcgogICAgICAgIEB6ID0gMTUwMAogICAgICAgIGlmIEBsb2dpYz8KICAgICAgICAgICAgQHZpc2libGUgPSBAbG9naWMuaXNSdW5uaW5nCiAgICAgICAgICAgIAogICAgICAgICAgICBpZiBAbG9naWMuaXNSdW5uaW5nCiAgICAgICAgICAgICAgICBAb3BhY2l0eSA9IEBsb2dpYy5vcGFjaXR5CiAgICAgICAgICAgICAgICBAeSAtPSAyCiAgICAgICAgICAgIAogICAKICAgICAgICAKICAgICAgICAKd2luZG93LlNwcml0ZV9EYW1hZ2UgPSBTcHJpdGVfRGFtYWdl","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBTcHJpdGVfRGFtYWdlLAogICAgX19oYXNQcm9wID0ge30uaGFzT3duUHJvcGVydHksCiAgICBfX2V4dGVuZHMgPSBmdW5jdGlvbihjaGlsZCwgcGFyZW50KSB7IGZvciAodmFyIGtleSBpbiBwYXJlbnQpIHsgaWYgKF9faGFzUHJvcC5jYWxsKHBhcmVudCwga2V5KSkgY2hpbGRba2V5XSA9IHBhcmVudFtrZXldOyB9IGZ1bmN0aW9uIGN0b3IoKSB7IHRoaXMuY29uc3RydWN0b3IgPSBjaGlsZDsgfSBjdG9yLnByb3RvdHlwZSA9IHBhcmVudC5wcm90b3R5cGU7IGNoaWxkLnByb3RvdHlwZSA9IG5ldyBjdG9yKCk7IGNoaWxkLl9fc3VwZXJfXyA9IHBhcmVudC5wcm90b3R5cGU7IHJldHVybiBjaGlsZDsgfTsKCiAgU3ByaXRlX0RhbWFnZSA9IChmdW5jdGlvbihfc3VwZXIpIHsKICAgIF9fZXh0ZW5kcyhTcHJpdGVfRGFtYWdlLCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFNwcml0ZV9EYW1hZ2UobG9naWMsIHZpZXdwb3J0KSB7CiAgICAgIFNwcml0ZV9EYW1hZ2UuX19zdXBlcl9fLmNvbnN0cnVjdG9yLmNhbGwodGhpcywgdmlld3BvcnQpOwogICAgICB0aGlzLmxvZ2ljID0gbG9naWM7CiAgICAgIHRoaXMuYml0bWFwID0gbmV3IEJpdG1hcCgzMDAsIDIwKTsKICAgICAgdGhpcy5iaXRtYXAuZm9udCA9IEZvbnRzLkRBTUFHRTsKICAgICAgdGhpcy5zcmNSZWN0ID0gbmV3IFJlY3QoMCwgMCwgdGhpcy5iaXRtYXAud2lkdGgsIHRoaXMuYml0bWFwLmhlaWdodCk7CiAgICAgIHRoaXMuaXNSdW5uaW5nID0gZmFsc2U7CiAgICAgIHRoaXMudGFyZ2V0ID0gbnVsbDsKICAgICAgdGhpcy5vcGFjaXR5ID0gMDsKICAgICAgdGhpcy52aXNpYmxlID0gZmFsc2U7CiAgICB9CgogICAgU3ByaXRlX0RhbWFnZS5wcm90b3R5cGUucmVkcmF3ID0gZnVuY3Rpb24oKSB7CiAgICAgIGlmICh0aGlzLmxvZ2ljICE9IG51bGwpIHsKICAgICAgICB0aGlzLmJpdG1hcC5jbGVhcigpOwogICAgICAgIHRoaXMuYml0bWFwLmZvbnQuY29sb3IgPSB0aGlzLmxvZ2ljLmNvbG9yOwogICAgICAgIHRoaXMuYml0bWFwLmRyYXdUZXh0KDAsIDAsIHRoaXMuYml0bWFwLndpZHRoLCB0aGlzLmJpdG1hcC5oZWlnaHQsIHRoaXMubG9naWMudGV4dCk7CiAgICAgICAgdGhpcy5vcGFjaXR5ID0gMjU1OwogICAgICAgIGlmICh0aGlzLnRhcmdldCAhPSBudWxsKSB7CiAgICAgICAgICB0aGlzLnggPSB0aGlzLnRhcmdldC54ICsgdGhpcy50YXJnZXQuc3JjUmVjdC53aWR0aCAvIDIgLSB0aGlzLnRhcmdldC5veDsKICAgICAgICAgIHJldHVybiB0aGlzLnkgPSB0aGlzLnRhcmdldC55ICsgdGhpcy50YXJnZXQuc3JjUmVjdC5oZWlnaHQgLyAyIC0gdGhpcy50YXJnZXQub3k7CiAgICAgICAgfQogICAgICB9CiAgICB9OwoKICAgIFNwcml0ZV9EYW1hZ2UucHJvdG90eXBlLnJlZnJlc2ggPSBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIHRoaXMucmVkcmF3KCk7CiAgICB9OwoKICAgIFNwcml0ZV9EYW1hZ2UucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkgewogICAgICBTcHJpdGVfRGFtYWdlLl9fc3VwZXJfXy51cGRhdGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgdGhpcy56ID0gMTUwMDsKICAgICAgaWYgKHRoaXMubG9naWMgIT0gbnVsbCkgewogICAgICAgIHRoaXMudmlzaWJsZSA9IHRoaXMubG9naWMuaXNSdW5uaW5nOwogICAgICAgIGlmICh0aGlzLmxvZ2ljLmlzUnVubmluZykgewogICAgICAgICAgdGhpcy5vcGFjaXR5ID0gdGhpcy5sb2dpYy5vcGFjaXR5OwogICAgICAgICAgcmV0dXJuIHRoaXMueSAtPSAyOwogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICByZXR1cm4gU3ByaXRlX0RhbWFnZTsKCiAgfSkoU3ByaXRlKTsKCiAgd2luZG93LlNwcml0ZV9EYW1hZ2UgPSBTcHJpdGVfRGFtYWdlOwoKfSkuY2FsbCh0aGlzKTsK"},{"name":"Sprite_SimpleAnimation","content":"# ===================================================================\n#\n#   Script: Sprite_SimpleAnimation\n#   Created on: 2013-10-13\n#\n#   Copyright (C) 2013 AndrÃ© Radomski. All rights reserved.\n#\n# ===================================================================\n#\n#   Class: Sprite_SimpleAnimation\n#\n#   A base class for all other window classes.\n#\n# ===================================================================\n\nclass Sprite_SimpleAnimation extends Sprite\n    constructor: (logic, viewport) ->\n        super(viewport)\n        @x = 0\n        @y = 0\n        @logic = logic\n        @graphic = if @logic? then @logic.graphic else null\n        @z = 1500\n        \n        @refresh()\n    refresh: ->\n        if @logic?\n            @graphic = @logic.graphic\n            @value = 0\n            if @logic.graphic and @logic.graphic.name.length > 0\n                if @logic.name == \"DEFAULT_GENERATED\"\n                    @bitmap = ResourceManager.getBitmap(\"Graphics/Battlers/#{@logic.graphic.name}\")\n                else\n                    @bitmap = ResourceManager.getBitmap(\"Graphics/SimpleAnimations/#{@logic.graphic.name}\")\n            else\n                @bitmap = new Bitmap(1, 1)\n                \n            @srcRect = new Rect(0, 0, @bitmap.width, @bitmap.height)\n            @isRunning = no\n            @target = {}\n            \n    update: ->\n        if @logic.graphic != @graphic\n            @refresh()\n            \n        \n            \n        @frameWidth = @bitmap.width / @logic.framesX\n        @frameHeight = @bitmap.height / @logic.framesY\n        column = @logic.pattern % @logic.framesX\n        row = Math.floor(@logic.pattern / @logic.framesX)\n        @srcRect.set(column * @frameWidth, row * @frameHeight, @frameWidth, @frameHeight)\n        @x = @logic.x || @x\n        @y = @logic.y || @y\n        @ox = Math.floor(@srcRect.width / 2)\n        \n        if @target? and @target.sprite?\n            @ox = 0\n            @x = @target.sprite.x + (@target.sprite.srcRect.width - @frameWidth) / 2\n            switch @logic.position\n                when 0 # Above\n                    @y = @target.sprite.y - @frameHeight\n                when 1 # Top\n                    @y = @target.sprite.y \n                when 2 # Center\n                    @y = @target.sprite.y + (@target.sprite.srcRect.height - @frameHeight) / 2\n                when 3 # Bottom\n                    @y = @target.sprite.y + @target.sprite.srcRect.height - @frameHeight\n                when 4 # Below\n                    @y = @target.sprite.y + @target.sprite.srcRect.height\n        super\n        \n        \n        \nwindow.Sprite_SimpleAnimation = Sprite_SimpleAnimation","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBTcHJpdGVfU2ltcGxlQW5pbWF0aW9uLAogICAgX19oYXNQcm9wID0ge30uaGFzT3duUHJvcGVydHksCiAgICBfX2V4dGVuZHMgPSBmdW5jdGlvbihjaGlsZCwgcGFyZW50KSB7IGZvciAodmFyIGtleSBpbiBwYXJlbnQpIHsgaWYgKF9faGFzUHJvcC5jYWxsKHBhcmVudCwga2V5KSkgY2hpbGRba2V5XSA9IHBhcmVudFtrZXldOyB9IGZ1bmN0aW9uIGN0b3IoKSB7IHRoaXMuY29uc3RydWN0b3IgPSBjaGlsZDsgfSBjdG9yLnByb3RvdHlwZSA9IHBhcmVudC5wcm90b3R5cGU7IGNoaWxkLnByb3RvdHlwZSA9IG5ldyBjdG9yKCk7IGNoaWxkLl9fc3VwZXJfXyA9IHBhcmVudC5wcm90b3R5cGU7IHJldHVybiBjaGlsZDsgfTsKCiAgU3ByaXRlX1NpbXBsZUFuaW1hdGlvbiA9IChmdW5jdGlvbihfc3VwZXIpIHsKICAgIF9fZXh0ZW5kcyhTcHJpdGVfU2ltcGxlQW5pbWF0aW9uLCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFNwcml0ZV9TaW1wbGVBbmltYXRpb24obG9naWMsIHZpZXdwb3J0KSB7CiAgICAgIFNwcml0ZV9TaW1wbGVBbmltYXRpb24uX19zdXBlcl9fLmNvbnN0cnVjdG9yLmNhbGwodGhpcywgdmlld3BvcnQpOwogICAgICB0aGlzLnggPSAwOwogICAgICB0aGlzLnkgPSAwOwogICAgICB0aGlzLmxvZ2ljID0gbG9naWM7CiAgICAgIHRoaXMuZ3JhcGhpYyA9IHRoaXMubG9naWMgIT0gbnVsbCA/IHRoaXMubG9naWMuZ3JhcGhpYyA6IG51bGw7CiAgICAgIHRoaXMueiA9IDE1MDA7CiAgICAgIHRoaXMucmVmcmVzaCgpOwogICAgfQoKICAgIFNwcml0ZV9TaW1wbGVBbmltYXRpb24ucHJvdG90eXBlLnJlZnJlc2ggPSBmdW5jdGlvbigpIHsKICAgICAgaWYgKHRoaXMubG9naWMgIT0gbnVsbCkgewogICAgICAgIHRoaXMuZ3JhcGhpYyA9IHRoaXMubG9naWMuZ3JhcGhpYzsKICAgICAgICB0aGlzLnZhbHVlID0gMDsKICAgICAgICBpZiAodGhpcy5sb2dpYy5ncmFwaGljICYmIHRoaXMubG9naWMuZ3JhcGhpYy5uYW1lLmxlbmd0aCA+IDApIHsKICAgICAgICAgIGlmICh0aGlzLmxvZ2ljLm5hbWUgPT09ICJERUZBVUxUX0dFTkVSQVRFRCIpIHsKICAgICAgICAgICAgdGhpcy5iaXRtYXAgPSBSZXNvdXJjZU1hbmFnZXIuZ2V0Qml0bWFwKCJHcmFwaGljcy9CYXR0bGVycy8iICsgdGhpcy5sb2dpYy5ncmFwaGljLm5hbWUpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy5iaXRtYXAgPSBSZXNvdXJjZU1hbmFnZXIuZ2V0Qml0bWFwKCJHcmFwaGljcy9TaW1wbGVBbmltYXRpb25zLyIgKyB0aGlzLmxvZ2ljLmdyYXBoaWMubmFtZSk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuYml0bWFwID0gbmV3IEJpdG1hcCgxLCAxKTsKICAgICAgICB9CiAgICAgICAgdGhpcy5zcmNSZWN0ID0gbmV3IFJlY3QoMCwgMCwgdGhpcy5iaXRtYXAud2lkdGgsIHRoaXMuYml0bWFwLmhlaWdodCk7CiAgICAgICAgdGhpcy5pc1J1bm5pbmcgPSBmYWxzZTsKICAgICAgICByZXR1cm4gdGhpcy50YXJnZXQgPSB7fTsKICAgICAgfQogICAgfTsKCiAgICBTcHJpdGVfU2ltcGxlQW5pbWF0aW9uLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGNvbHVtbiwgcm93OwogICAgICBpZiAodGhpcy5sb2dpYy5ncmFwaGljICE9PSB0aGlzLmdyYXBoaWMpIHsKICAgICAgICB0aGlzLnJlZnJlc2goKTsKICAgICAgfQogICAgICB0aGlzLmZyYW1lV2lkdGggPSB0aGlzLmJpdG1hcC53aWR0aCAvIHRoaXMubG9naWMuZnJhbWVzWDsKICAgICAgdGhpcy5mcmFtZUhlaWdodCA9IHRoaXMuYml0bWFwLmhlaWdodCAvIHRoaXMubG9naWMuZnJhbWVzWTsKICAgICAgY29sdW1uID0gdGhpcy5sb2dpYy5wYXR0ZXJuICUgdGhpcy5sb2dpYy5mcmFtZXNYOwogICAgICByb3cgPSBNYXRoLmZsb29yKHRoaXMubG9naWMucGF0dGVybiAvIHRoaXMubG9naWMuZnJhbWVzWCk7CiAgICAgIHRoaXMuc3JjUmVjdC5zZXQoY29sdW1uICogdGhpcy5mcmFtZVdpZHRoLCByb3cgKiB0aGlzLmZyYW1lSGVpZ2h0LCB0aGlzLmZyYW1lV2lkdGgsIHRoaXMuZnJhbWVIZWlnaHQpOwogICAgICB0aGlzLnggPSB0aGlzLmxvZ2ljLnggfHwgdGhpcy54OwogICAgICB0aGlzLnkgPSB0aGlzLmxvZ2ljLnkgfHwgdGhpcy55OwogICAgICB0aGlzLm94ID0gTWF0aC5mbG9vcih0aGlzLnNyY1JlY3Qud2lkdGggLyAyKTsKICAgICAgaWYgKCh0aGlzLnRhcmdldCAhPSBudWxsKSAmJiAodGhpcy50YXJnZXQuc3ByaXRlICE9IG51bGwpKSB7CiAgICAgICAgdGhpcy5veCA9IDA7CiAgICAgICAgdGhpcy54ID0gdGhpcy50YXJnZXQuc3ByaXRlLnggKyAodGhpcy50YXJnZXQuc3ByaXRlLnNyY1JlY3Qud2lkdGggLSB0aGlzLmZyYW1lV2lkdGgpIC8gMjsKICAgICAgICBzd2l0Y2ggKHRoaXMubG9naWMucG9zaXRpb24pIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgdGhpcy55ID0gdGhpcy50YXJnZXQuc3ByaXRlLnkgLSB0aGlzLmZyYW1lSGVpZ2h0OwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgdGhpcy55ID0gdGhpcy50YXJnZXQuc3ByaXRlLnk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICB0aGlzLnkgPSB0aGlzLnRhcmdldC5zcHJpdGUueSArICh0aGlzLnRhcmdldC5zcHJpdGUuc3JjUmVjdC5oZWlnaHQgLSB0aGlzLmZyYW1lSGVpZ2h0KSAvIDI7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICB0aGlzLnkgPSB0aGlzLnRhcmdldC5zcHJpdGUueSArIHRoaXMudGFyZ2V0LnNwcml0ZS5zcmNSZWN0LmhlaWdodCAtIHRoaXMuZnJhbWVIZWlnaHQ7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICB0aGlzLnkgPSB0aGlzLnRhcmdldC5zcHJpdGUueSArIHRoaXMudGFyZ2V0LnNwcml0ZS5zcmNSZWN0LmhlaWdodDsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIFNwcml0ZV9TaW1wbGVBbmltYXRpb24uX19zdXBlcl9fLnVwZGF0ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgfTsKCiAgICByZXR1cm4gU3ByaXRlX1NpbXBsZUFuaW1hdGlvbjsKCiAgfSkoU3ByaXRlKTsKCiAgd2luZG93LlNwcml0ZV9TaW1wbGVBbmltYXRpb24gPSBTcHJpdGVfU2ltcGxlQW5pbWF0aW9uOwoKfSkuY2FsbCh0aGlzKTsK","decoded":true},{"name":"Sprite_MovableAnimation","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogU3ByaXRlX01vdmFibGVBbmltYXRpb24KIyAgIENyZWF0ZWQgb246IDIwMTMtMTAtMTMKIwojICAgQ29weXJpZ2h0IChDKSAyMDEzIEFuZHLpIFJhZG9tc2tpLiBBbGwgcmlnaHRzIHJlc2VydmVkLgojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQojCiMgICBDbGFzczogU3ByaXRlX1NpbXBsZUFuaW1hdGlvbgojCiMgICBBIGJhc2UgY2xhc3MgZm9yIGFsbCBvdGhlciB3aW5kb3cgY2xhc3Nlcy4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCmNsYXNzIFNwcml0ZV9Nb3ZhYmxlQW5pbWF0aW9uIGV4dGVuZHMgU3ByaXRlX1NpbXBsZUFuaW1hdGlvbgogICAgY29uc3RydWN0b3I6IChsb2dpYywgdmlld3BvcnQpIC0+CiAgICAgICAgc3VwZXIobG9naWMsIHZpZXdwb3J0KQogICAgICAgIEBzb3VyY2UgPSBudWxsCiAgICAgICAgQHRhcmdldCA9IG51bGwKICAgICAgICBAaXNSdW5uaW5nID0gbm8KICAgIHN0YXJ0OiAtPgogICAgICAgIEB4ID0gQHNvdXJjZS54CiAgICAgICAgQHkgPSBAc291cmNlLnkKICAgICAgICBAZHVyYXRpb24gPSBAbG9naWMubW92ZUR1cmF0aW9uIHx8IDYwCiAgICAgICAgQHZ4ID0gTWF0aC5yb3VuZChAdGFyZ2V0LnggLyBAZHVyYXRpb24pCiAgICAgICAgQHZ5ID0gTWF0aC5yb3VuZChAdGFyZ2V0LnkgLyBAZHVyYXRpb24pCiAgICAgICAgQGlzUnVubmluZyA9IHllcwogICAgdXBkYXRlOiAtPgogICAgICAgIHN1cGVyCiAgICAgICAgaWYgbm90IEBpc1J1bm5pbmcgdGhlbiByZXR1cm4KICAgICAgICAKICAgICAgICBAeCArPSBAdngKICAgICAgICBAeSArPSBAdnkKICAgICAgICAKICAgICAgICBAZHVyYXRpb24tLQogICAgICAgIAogICAgICAgIGlmIEBkdXJhdGlvbiA8PSAwCiAgICAgICAgICAgIEBpc1J1bm5pbmcgPSBubwogICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgIAp3aW5kb3cuU3ByaXRlX01vdmFibGVBbmltYXRpb24gPSBTcHJpdGVfTW92YWJsZUFuaW1hdGlvbg==","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBTcHJpdGVfTW92YWJsZUFuaW1hdGlvbiwKICAgIF9faGFzUHJvcCA9IHt9Lmhhc093blByb3BlcnR5LAogICAgX19leHRlbmRzID0gZnVuY3Rpb24oY2hpbGQsIHBhcmVudCkgeyBmb3IgKHZhciBrZXkgaW4gcGFyZW50KSB7IGlmIChfX2hhc1Byb3AuY2FsbChwYXJlbnQsIGtleSkpIGNoaWxkW2tleV0gPSBwYXJlbnRba2V5XTsgfSBmdW5jdGlvbiBjdG9yKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gY2hpbGQ7IH0gY3Rvci5wcm90b3R5cGUgPSBwYXJlbnQucHJvdG90eXBlOyBjaGlsZC5wcm90b3R5cGUgPSBuZXcgY3RvcigpOyBjaGlsZC5fX3N1cGVyX18gPSBwYXJlbnQucHJvdG90eXBlOyByZXR1cm4gY2hpbGQ7IH07CgogIFNwcml0ZV9Nb3ZhYmxlQW5pbWF0aW9uID0gKGZ1bmN0aW9uKF9zdXBlcikgewogICAgX19leHRlbmRzKFNwcml0ZV9Nb3ZhYmxlQW5pbWF0aW9uLCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFNwcml0ZV9Nb3ZhYmxlQW5pbWF0aW9uKGxvZ2ljLCB2aWV3cG9ydCkgewogICAgICBTcHJpdGVfTW92YWJsZUFuaW1hdGlvbi5fX3N1cGVyX18uY29uc3RydWN0b3IuY2FsbCh0aGlzLCBsb2dpYywgdmlld3BvcnQpOwogICAgICB0aGlzLnNvdXJjZSA9IG51bGw7CiAgICAgIHRoaXMudGFyZ2V0ID0gbnVsbDsKICAgICAgdGhpcy5pc1J1bm5pbmcgPSBmYWxzZTsKICAgIH0KCiAgICBTcHJpdGVfTW92YWJsZUFuaW1hdGlvbi5wcm90b3R5cGUuc3RhcnQgPSBmdW5jdGlvbigpIHsKICAgICAgdGhpcy54ID0gdGhpcy5zb3VyY2UueDsKICAgICAgdGhpcy55ID0gdGhpcy5zb3VyY2UueTsKICAgICAgdGhpcy5kdXJhdGlvbiA9IHRoaXMubG9naWMubW92ZUR1cmF0aW9uIHx8IDYwOwogICAgICB0aGlzLnZ4ID0gTWF0aC5yb3VuZCh0aGlzLnRhcmdldC54IC8gdGhpcy5kdXJhdGlvbik7CiAgICAgIHRoaXMudnkgPSBNYXRoLnJvdW5kKHRoaXMudGFyZ2V0LnkgLyB0aGlzLmR1cmF0aW9uKTsKICAgICAgcmV0dXJuIHRoaXMuaXNSdW5uaW5nID0gdHJ1ZTsKICAgIH07CgogICAgU3ByaXRlX01vdmFibGVBbmltYXRpb24ucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkgewogICAgICBTcHJpdGVfTW92YWJsZUFuaW1hdGlvbi5fX3N1cGVyX18udXBkYXRlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIGlmICghdGhpcy5pc1J1bm5pbmcpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdGhpcy54ICs9IHRoaXMudng7CiAgICAgIHRoaXMueSArPSB0aGlzLnZ5OwogICAgICB0aGlzLmR1cmF0aW9uLS07CiAgICAgIGlmICh0aGlzLmR1cmF0aW9uIDw9IDApIHsKICAgICAgICByZXR1cm4gdGhpcy5pc1J1bm5pbmcgPSBmYWxzZTsKICAgICAgfQogICAgfTsKCiAgICByZXR1cm4gU3ByaXRlX01vdmFibGVBbmltYXRpb247CgogIH0pKFNwcml0ZV9TaW1wbGVBbmltYXRpb24pOwoKICB3aW5kb3cuU3ByaXRlX01vdmFibGVBbmltYXRpb24gPSBTcHJpdGVfTW92YWJsZUFuaW1hdGlvbjsKCn0pLmNhbGwodGhpcyk7Cg=="},{"name":"Sprite_Battler","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogU3ByaXRlc2V0X0JhdHRsZXIKIyAgIENyZWF0ZWQgb246IDIwMTMtMTAtMTkKIwojICAgQ29weXJpZ2h0IChDKSAyMDEzIEFuZHLpIFJhZG9tc2tpLiBBbGwgcmlnaHRzIHJlc2VydmVkLgojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQojCiMgICBDbGFzczogU3ByaXRlX0JhdHRsZXIKIwojICAgQSBiYXNlIGNsYXNzIGZvciBhbGwgb3RoZXIgd2luZG93IGNsYXNzZXMuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpjbGFzcyBTcHJpdGVfQmF0dGxlciBleHRlbmRzIFNwcml0ZV9TaW1wbGVBbmltYXRpb24KICAgIGNvbnN0cnVjdG9yOiAobG9naWMsIHZpZXdwb3J0KSAtPiAgICAgICAgCiAgICAgICAgQGxvZ2ljMiA9IGxvZ2ljCiAgICAgICAgc3VwZXIoQGxvZ2ljMi5zdGFuZEFuaW1hdGlvbiwgdmlld3BvcnQpCgogICAgICAgIEB4ID0gQGxvZ2ljMi54IHx8IDAKICAgICAgICBAeSA9IEBsb2dpYzIueSB8fCAwCiAgICAgICAgCiAgICAgICAgQGlzQW5pbWF0aW9uUnVubmluZyA9IG5vCiAgICAgICAgQGFuaW1hdGlvbkxpc3QgPSBbXQogICAgICAgIEBhbmltYXRpb25Qb2ludGVyID0gMAogICAgICAgIEBjb2xvciA9IENvbG9yLlRSQU5TUEFSRU5UCiAgICAgICAgQHRhcmdldCA9IG51bGwKICAgICAgICBAaXNEaXNhcHBlYXJpbmcgPSBubwogICAgICAgIEBpc0FwcGVhcmluZyA9IG5vICAgICAgIAogICAgZGlzcG9zZTogLT4KICAgICAgICBzdXBlcgogICAgICAgICAgICAKICAgIHByZXBhcmU6IC0+CiAgICB1cGRhdGU6IC0+CiAgICAgICAgc3VwZXIKICAgICAgICAKICAgICAgICBAdmlzaWJsZSA9ICFAbG9naWMyLmlzSGlkZGVuCgogICAgICAgIGlmIEBsb2dpYzIuaXNIaWRkZW4gYW5kIG5vdCBAbG9naWMyLmFjdG9yLmlzQWxpdmUKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgZWxzZSBpZiBAb3BhY2l0eSA8IDI1NSBhbmQgbm90IEBpc0FwcGVhcmluZyBhbmQgbm90IEBpc0Rpc2FwcGVhcmluZwogICAgICAgICAgICBAYXBwZWFyKCkKICAgICAgICAgICAgICAgIAogICAgICAgIEB6ID0gNQogICAgICAgIEBjb2xvciA9IEBjb2xvcgogICAgICAgIAogICAgICAgIGlmIEBvcGFjaXR5ID4gMCBhbmQgQGxvZ2ljMi5kZWFkIGFuZCBub3QgQGxvZ2ljMi5hY3Rvci5kZWF0aEFuaW1hdGlvbj8KICAgICAgICAgICAgQGtpbGwoKQogICAgICAgICAgICAKICAgICAgICBpZiBAb3BhY2l0eSA8PSAwIGFuZCBub3QgQGxvZ2ljMi5kZWFkCiAgICAgICAgICAgIEBhcHBlYXIoKQogICAgICAgICAgICAgICAgICAgIAogICAgICAgIGlmIEBpc0Rpc2FwcGVhcmluZwogICAgICAgICAgICBAb3BhY2l0eSA9IE1hdGgubWF4KEBvcGFjaXR5IC0gOCwgMCkKICAgICAgICAgICAgaWYgQG9wYWNpdHkgPT0gMAogICAgICAgICAgICAgICAgQGlzRGlzYXBwZWFyaW5nID0gbm8KICAgICAgICBlbHNlCiAgICAgICAgICAgIEBpc0Rpc2FwcGVhcmluZyA9IG5vCiAgICAgICAgICAgIAogICAgICAgIGlmIEBpc0FwcGVhcmluZwogICAgICAgICAgICBAb3BhY2l0eSA9IE1hdGgubWluKEBvcGFjaXR5ICsgOCwgMjU1KQogICAgICAgICAgICBpZiBAb3BhY2l0eSA9PSAyNTUKICAgICAgICAgICAgICAgIEBpc0FwcGVhcmluZyA9IG5vCiAgICAgICAgZWxzZQogICAgICAgICAgICBAaXNBcHBlYXJpbmcgPSBubyAgICAKICAgICAgICAgICAgCiAgICBraWxsOiAtPgogICAgICAgIEBjb2xvciA9IG5ldyBDb2xvcigyNTUsIDAsIDAsIDI0NykKICAgICAgICBAaXNEaXNhcHBlYXJpbmcgPSB5ZXMKICAgICAgICAKICAgIGFwcGVhcjogLT4KICAgICAgICBAY29sb3IgPSBDb2xvci5UUkFOU1BBUkVOVAogICAgICAgIEBpc0FwcGVhcmluZyA9IHllcwogICAgICAgIAogICAgICAgIAp3aW5kb3cuU3ByaXRlX0JhdHRsZXIgPSBTcHJpdGVfQmF0dGxlcg==","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBTcHJpdGVfQmF0dGxlciwKICAgIF9faGFzUHJvcCA9IHt9Lmhhc093blByb3BlcnR5LAogICAgX19leHRlbmRzID0gZnVuY3Rpb24oY2hpbGQsIHBhcmVudCkgeyBmb3IgKHZhciBrZXkgaW4gcGFyZW50KSB7IGlmIChfX2hhc1Byb3AuY2FsbChwYXJlbnQsIGtleSkpIGNoaWxkW2tleV0gPSBwYXJlbnRba2V5XTsgfSBmdW5jdGlvbiBjdG9yKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gY2hpbGQ7IH0gY3Rvci5wcm90b3R5cGUgPSBwYXJlbnQucHJvdG90eXBlOyBjaGlsZC5wcm90b3R5cGUgPSBuZXcgY3RvcigpOyBjaGlsZC5fX3N1cGVyX18gPSBwYXJlbnQucHJvdG90eXBlOyByZXR1cm4gY2hpbGQ7IH07CgogIFNwcml0ZV9CYXR0bGVyID0gKGZ1bmN0aW9uKF9zdXBlcikgewogICAgX19leHRlbmRzKFNwcml0ZV9CYXR0bGVyLCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFNwcml0ZV9CYXR0bGVyKGxvZ2ljLCB2aWV3cG9ydCkgewogICAgICB0aGlzLmxvZ2ljMiA9IGxvZ2ljOwogICAgICBTcHJpdGVfQmF0dGxlci5fX3N1cGVyX18uY29uc3RydWN0b3IuY2FsbCh0aGlzLCB0aGlzLmxvZ2ljMi5zdGFuZEFuaW1hdGlvbiwgdmlld3BvcnQpOwogICAgICB0aGlzLnggPSB0aGlzLmxvZ2ljMi54IHx8IDA7CiAgICAgIHRoaXMueSA9IHRoaXMubG9naWMyLnkgfHwgMDsKICAgICAgdGhpcy5pc0FuaW1hdGlvblJ1bm5pbmcgPSBmYWxzZTsKICAgICAgdGhpcy5hbmltYXRpb25MaXN0ID0gW107CiAgICAgIHRoaXMuYW5pbWF0aW9uUG9pbnRlciA9IDA7CiAgICAgIHRoaXMuY29sb3IgPSBDb2xvci5UUkFOU1BBUkVOVDsKICAgICAgdGhpcy50YXJnZXQgPSBudWxsOwogICAgICB0aGlzLmlzRGlzYXBwZWFyaW5nID0gZmFsc2U7CiAgICAgIHRoaXMuaXNBcHBlYXJpbmcgPSBmYWxzZTsKICAgIH0KCiAgICBTcHJpdGVfQmF0dGxlci5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gU3ByaXRlX0JhdHRsZXIuX19zdXBlcl9fLmRpc3Bvc2UuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH07CgogICAgU3ByaXRlX0JhdHRsZXIucHJvdG90eXBlLnByZXBhcmUgPSBmdW5jdGlvbigpIHt9OwoKICAgIFNwcml0ZV9CYXR0bGVyLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpIHsKICAgICAgU3ByaXRlX0JhdHRsZXIuX19zdXBlcl9fLnVwZGF0ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB0aGlzLnZpc2libGUgPSAhdGhpcy5sb2dpYzIuaXNIaWRkZW47CiAgICAgIGlmICh0aGlzLmxvZ2ljMi5pc0hpZGRlbiAmJiAhdGhpcy5sb2dpYzIuYWN0b3IuaXNBbGl2ZSkgewogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIGlmICh0aGlzLm9wYWNpdHkgPCAyNTUgJiYgIXRoaXMuaXNBcHBlYXJpbmcgJiYgIXRoaXMuaXNEaXNhcHBlYXJpbmcpIHsKICAgICAgICB0aGlzLmFwcGVhcigpOwogICAgICB9CiAgICAgIHRoaXMueiA9IDU7CiAgICAgIHRoaXMuY29sb3IgPSB0aGlzLmNvbG9yOwogICAgICBpZiAodGhpcy5vcGFjaXR5ID4gMCAmJiB0aGlzLmxvZ2ljMi5kZWFkICYmICh0aGlzLmxvZ2ljMi5hY3Rvci5kZWF0aEFuaW1hdGlvbiA9PSBudWxsKSkgewogICAgICAgIHRoaXMua2lsbCgpOwogICAgICB9CiAgICAgIGlmICh0aGlzLm9wYWNpdHkgPD0gMCAmJiAhdGhpcy5sb2dpYzIuZGVhZCkgewogICAgICAgIHRoaXMuYXBwZWFyKCk7CiAgICAgIH0KICAgICAgaWYgKHRoaXMuaXNEaXNhcHBlYXJpbmcpIHsKICAgICAgICB0aGlzLm9wYWNpdHkgPSBNYXRoLm1heCh0aGlzLm9wYWNpdHkgLSA4LCAwKTsKICAgICAgICBpZiAodGhpcy5vcGFjaXR5ID09PSAwKSB7CiAgICAgICAgICB0aGlzLmlzRGlzYXBwZWFyaW5nID0gZmFsc2U7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuaXNEaXNhcHBlYXJpbmcgPSBmYWxzZTsKICAgICAgfQogICAgICBpZiAodGhpcy5pc0FwcGVhcmluZykgewogICAgICAgIHRoaXMub3BhY2l0eSA9IE1hdGgubWluKHRoaXMub3BhY2l0eSArIDgsIDI1NSk7CiAgICAgICAgaWYgKHRoaXMub3BhY2l0eSA9PT0gMjU1KSB7CiAgICAgICAgICByZXR1cm4gdGhpcy5pc0FwcGVhcmluZyA9IGZhbHNlOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gdGhpcy5pc0FwcGVhcmluZyA9IGZhbHNlOwogICAgICB9CiAgICB9OwoKICAgIFNwcml0ZV9CYXR0bGVyLnByb3RvdHlwZS5raWxsID0gZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMuY29sb3IgPSBuZXcgQ29sb3IoMjU1LCAwLCAwLCAyNDcpOwogICAgICByZXR1cm4gdGhpcy5pc0Rpc2FwcGVhcmluZyA9IHRydWU7CiAgICB9OwoKICAgIFNwcml0ZV9CYXR0bGVyLnByb3RvdHlwZS5hcHBlYXIgPSBmdW5jdGlvbigpIHsKICAgICAgdGhpcy5jb2xvciA9IENvbG9yLlRSQU5TUEFSRU5UOwogICAgICByZXR1cm4gdGhpcy5pc0FwcGVhcmluZyA9IHRydWU7CiAgICB9OwoKICAgIHJldHVybiBTcHJpdGVfQmF0dGxlcjsKCiAgfSkoU3ByaXRlX1NpbXBsZUFuaW1hdGlvbik7CgogIHdpbmRvdy5TcHJpdGVfQmF0dGxlciA9IFNwcml0ZV9CYXR0bGVyOwoKfSkuY2FsbCh0aGlzKTsK"},{"name":"Sprite_Picture","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogU3ByaXRlX1BpY3R1cmUKIyAgIENyZWF0ZWQgb246IDIwMTMtMTItMDEKIwojICAgQ29weXJpZ2h0IChDKSAyMDEzIEFuZHLpIFJhZG9tc2tpLiBBbGwgcmlnaHRzIHJlc2VydmVkLgojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQojCiMgICBDbGFzczogU3ByaXRlX1BpY3R1cmUKIwojICAgQSBiYXNlIGNsYXNzIGZvciBhbGwgb3RoZXIgd2luZG93IGNsYXNzZXMuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpjbGFzcyBTcHJpdGVfUGljdHVyZSBleHRlbmRzIFNwcml0ZQogICAgY29uc3RydWN0b3I6IChsb2dpYywgdmlld3BvcnQpIC0+CiAgICAgICAgc3VwZXIodmlld3BvcnQpCiAgICAgICAgQGxvZ2ljID0gbG9naWMKCiAgICB1cGRhdGU6IC0+CiAgICAgICAgc3VwZXIKICAgICAgICBAeCA9IEBsb2dpYy54CiAgICAgICAgQHkgPSBAbG9naWMueQogICAgICAgIEB6b29tWCA9IEBsb2dpYy56b29tWAogICAgICAgIEB6b29tWSA9IEBsb2dpYy56b29tWQogICAgICAgIEBhbmdsZSA9IEBsb2dpYy5hbmdsZQogICAgICAgIEBvcGFjaXR5ID0gQGxvZ2ljLm9wYWNpdHkKICAgICAgICBAdG9uZSA9IEBsb2dpYy50b25lCiAgICAgICAgQGNvbG9yID0gQGxvZ2ljLmNvbG9yCiAKICAgICAgICAgICAgCiAgIAogICAgICAgIAogICAgICAgIAp3aW5kb3cuU3ByaXRlX1BpY3R1cmUgPSBTcHJpdGVfUGljdHVyZQ==","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBTcHJpdGVfUGljdHVyZSwKICAgIF9faGFzUHJvcCA9IHt9Lmhhc093blByb3BlcnR5LAogICAgX19leHRlbmRzID0gZnVuY3Rpb24oY2hpbGQsIHBhcmVudCkgeyBmb3IgKHZhciBrZXkgaW4gcGFyZW50KSB7IGlmIChfX2hhc1Byb3AuY2FsbChwYXJlbnQsIGtleSkpIGNoaWxkW2tleV0gPSBwYXJlbnRba2V5XTsgfSBmdW5jdGlvbiBjdG9yKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gY2hpbGQ7IH0gY3Rvci5wcm90b3R5cGUgPSBwYXJlbnQucHJvdG90eXBlOyBjaGlsZC5wcm90b3R5cGUgPSBuZXcgY3RvcigpOyBjaGlsZC5fX3N1cGVyX18gPSBwYXJlbnQucHJvdG90eXBlOyByZXR1cm4gY2hpbGQ7IH07CgogIFNwcml0ZV9QaWN0dXJlID0gKGZ1bmN0aW9uKF9zdXBlcikgewogICAgX19leHRlbmRzKFNwcml0ZV9QaWN0dXJlLCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFNwcml0ZV9QaWN0dXJlKGxvZ2ljLCB2aWV3cG9ydCkgewogICAgICBTcHJpdGVfUGljdHVyZS5fX3N1cGVyX18uY29uc3RydWN0b3IuY2FsbCh0aGlzLCB2aWV3cG9ydCk7CiAgICAgIHRoaXMubG9naWMgPSBsb2dpYzsKICAgIH0KCiAgICBTcHJpdGVfUGljdHVyZS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKSB7CiAgICAgIFNwcml0ZV9QaWN0dXJlLl9fc3VwZXJfXy51cGRhdGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgdGhpcy54ID0gdGhpcy5sb2dpYy54OwogICAgICB0aGlzLnkgPSB0aGlzLmxvZ2ljLnk7CiAgICAgIHRoaXMuem9vbVggPSB0aGlzLmxvZ2ljLnpvb21YOwogICAgICB0aGlzLnpvb21ZID0gdGhpcy5sb2dpYy56b29tWTsKICAgICAgdGhpcy5hbmdsZSA9IHRoaXMubG9naWMuYW5nbGU7CiAgICAgIHRoaXMub3BhY2l0eSA9IHRoaXMubG9naWMub3BhY2l0eTsKICAgICAgdGhpcy50b25lID0gdGhpcy5sb2dpYy50b25lOwogICAgICByZXR1cm4gdGhpcy5jb2xvciA9IHRoaXMubG9naWMuY29sb3I7CiAgICB9OwoKICAgIHJldHVybiBTcHJpdGVfUGljdHVyZTsKCiAgfSkoU3ByaXRlKTsKCiAgd2luZG93LlNwcml0ZV9QaWN0dXJlID0gU3ByaXRlX1BpY3R1cmU7Cgp9KS5jYWxsKHRoaXMpOwo="},{"name":"Sprite_TextPicture","content":"# ===================================================================\n#\n#   Script: Sprite_TextPicture\n#   Created on: 2013-12-01\n#\n#   Copyright (C) 2013 AndrÃ© Radomski. All rights reserved.\n#\n# ===================================================================\n#\n#   Class: Sprite_TextPicture\n#\n#   A base class for all other window classes.\n#\n# ===================================================================\n\nclass Sprite_TextPicture extends Sprite_Picture\n    constructor: (logic, viewport) ->\n        super(viewport)\n        @logic = logic\n        @text = \"\"\n        @font = new Font(\"Verdana\", 22)\n        \n    refresh: ->\n        size = @font.measureText(@text)\n        lines = @text.split('\\n')\n        width = 0\n        for line in lines\n            size = @font.measureText(line)\n            width = Math.max(width, size.width)\n            \n        @bitmap = new Bitmap(width, (size.height+8) * lines.length)\n        @bitmap.font = @font\n        \n        \n        for i in [0...lines.length]\n            @bitmap.drawTextF(0, i * (size.height+4), width, size.height, lines[i], 0)\n            \n        @srcRect = new Rect(0, 0, @bitmap.width, @bitmap.height)\n        \n    update: ->\n        super\n  \n \n            \n   \n        \n        \nwindow.Sprite_TextPicture = Sprite_TextPicture","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBTcHJpdGVfVGV4dFBpY3R1cmUsCiAgICBfX2hhc1Byb3AgPSB7fS5oYXNPd25Qcm9wZXJ0eSwKICAgIF9fZXh0ZW5kcyA9IGZ1bmN0aW9uKGNoaWxkLCBwYXJlbnQpIHsgZm9yICh2YXIga2V5IGluIHBhcmVudCkgeyBpZiAoX19oYXNQcm9wLmNhbGwocGFyZW50LCBrZXkpKSBjaGlsZFtrZXldID0gcGFyZW50W2tleV07IH0gZnVuY3Rpb24gY3RvcigpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGNoaWxkOyB9IGN0b3IucHJvdG90eXBlID0gcGFyZW50LnByb3RvdHlwZTsgY2hpbGQucHJvdG90eXBlID0gbmV3IGN0b3IoKTsgY2hpbGQuX19zdXBlcl9fID0gcGFyZW50LnByb3RvdHlwZTsgcmV0dXJuIGNoaWxkOyB9OwoKICBTcHJpdGVfVGV4dFBpY3R1cmUgPSAoZnVuY3Rpb24oX3N1cGVyKSB7CiAgICBfX2V4dGVuZHMoU3ByaXRlX1RleHRQaWN0dXJlLCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFNwcml0ZV9UZXh0UGljdHVyZShsb2dpYywgdmlld3BvcnQpIHsKICAgICAgU3ByaXRlX1RleHRQaWN0dXJlLl9fc3VwZXJfXy5jb25zdHJ1Y3Rvci5jYWxsKHRoaXMsIHZpZXdwb3J0KTsKICAgICAgdGhpcy5sb2dpYyA9IGxvZ2ljOwogICAgICB0aGlzLnRleHQgPSAiIjsKICAgICAgdGhpcy5mb250ID0gbmV3IEZvbnQoIlZlcmRhbmEiLCAyMik7CiAgICB9CgogICAgU3ByaXRlX1RleHRQaWN0dXJlLnByb3RvdHlwZS5yZWZyZXNoID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBpLCBsaW5lLCBsaW5lcywgc2l6ZSwgd2lkdGgsIF9pLCBfaiwgX2xlbiwgX3JlZjsKICAgICAgc2l6ZSA9IHRoaXMuZm9udC5tZWFzdXJlVGV4dCh0aGlzLnRleHQpOwogICAgICBsaW5lcyA9IHRoaXMudGV4dC5zcGxpdCgnXG4nKTsKICAgICAgd2lkdGggPSAwOwogICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IGxpbmVzLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7CiAgICAgICAgbGluZSA9IGxpbmVzW19pXTsKICAgICAgICBzaXplID0gdGhpcy5mb250Lm1lYXN1cmVUZXh0KGxpbmUpOwogICAgICAgIHdpZHRoID0gTWF0aC5tYXgod2lkdGgsIHNpemUud2lkdGgpOwogICAgICB9CiAgICAgIHRoaXMuYml0bWFwID0gbmV3IEJpdG1hcCh3aWR0aCwgKHNpemUuaGVpZ2h0ICsgOCkgKiBsaW5lcy5sZW5ndGgpOwogICAgICB0aGlzLmJpdG1hcC5mb250ID0gdGhpcy5mb250OwogICAgICBmb3IgKGkgPSBfaiA9IDAsIF9yZWYgPSBsaW5lcy5sZW5ndGg7IDAgPD0gX3JlZiA/IF9qIDwgX3JlZiA6IF9qID4gX3JlZjsgaSA9IDAgPD0gX3JlZiA/ICsrX2ogOiAtLV9qKSB7CiAgICAgICAgdGhpcy5iaXRtYXAuZHJhd1RleHRGKDAsIGkgKiAoc2l6ZS5oZWlnaHQgKyA0KSwgd2lkdGgsIHNpemUuaGVpZ2h0LCBsaW5lc1tpXSwgMCk7CiAgICAgIH0KICAgICAgcmV0dXJuIHRoaXMuc3JjUmVjdCA9IG5ldyBSZWN0KDAsIDAsIHRoaXMuYml0bWFwLndpZHRoLCB0aGlzLmJpdG1hcC5oZWlnaHQpOwogICAgfTsKCiAgICBTcHJpdGVfVGV4dFBpY3R1cmUucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gU3ByaXRlX1RleHRQaWN0dXJlLl9fc3VwZXJfXy51cGRhdGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH07CgogICAgcmV0dXJuIFNwcml0ZV9UZXh0UGljdHVyZTsKCiAgfSkoU3ByaXRlX1BpY3R1cmUpOwoKICB3aW5kb3cuU3ByaXRlX1RleHRQaWN0dXJlID0gU3ByaXRlX1RleHRQaWN0dXJlOwoKfSkuY2FsbCh0aGlzKTsK","decoded":true},{"name":"Sprite_Timer","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogU3ByaXRlX1RpbWVyCiMgICBDcmVhdGVkIG9uOiAyMDEzLTEyLTA5CiMKIyAgIENvcHlyaWdodCAoQykgMjAxMyBBbmRy6SBSYWRvbXNraS4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KIwojICAgQ2xhc3M6IFNwcml0ZV9UaW1lcgojCiMgICBBIHNwcml0ZSB0byBkaXNwbGF5IGEgdGltZXIKIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCmNsYXNzIFNwcml0ZV9UaW1lciBleHRlbmRzIFNwcml0ZV9UZXh0CiAgICBjb25zdHJ1Y3RvcjogKGxvZ2ljLCB2aWV3cG9ydCkgLT4KICAgICAgICBzdXBlcigxMDAsIDI0ICogV2luZG93X0Jhc2Uuc2NhbGUsIHZpZXdwb3J0KQogICAgICAgIAogICAgICAgIEBsb2dpYyA9IGxvZ2ljCiAgICAgICAgQG1pbnV0ZXMgPSBAbG9naWMubWludXRlcwogICAgICAgIEBzZWNvbmRzID0gQGxvZ2ljLnNlY29uZHMKICAgICAgICBAeiA9IDIwMAogICAgICAgIEB4ID0gMwogICAgICAgIEBiYWNrZ3JvdW5kQ29sb3IgPSBDb2xvci5UUkFOU1BBUkVOVAogICAgICAgIEB0ZXh0ID0gc3ByaW50ZigiJTAyZDolMDJkIiwgQG1pbnV0ZXMsIEBzZWNvbmRzKQogICAgdXBkYXRlOiAtPgogICAgICAgIHN1cGVyCiAgICAgICAgaWYgbm90IEBsb2dpYz8gdGhlbiByZXR1cm4KICAgICAgICBAdmlzaWJsZSA9IEBsb2dpYy5pc1J1bm5pbmcKICAgICAgICAKICAgICAgICBpZiBAbWludXRlcyAhPSBAbG9naWMubWludXRlcyBvciBAc2Vjb25kcyAhPSBAbG9naWMuc2Vjb25kcwogICAgICAgICAgICBAbWludXRlcyA9IEBsb2dpYy5taW51dGVzCiAgICAgICAgICAgIEBzZWNvbmRzID0gQGxvZ2ljLnNlY29uZHMKICAgICAgICAgICAgQHRleHQgPSBzcHJpbnRmKCIlMDJkOiUwMmQiLCBAbWludXRlcywgQHNlY29uZHMpCiAgICAgICAgICAgIEByZWZyZXNoKCkKICAgICAgICAgICAgCiAgIAogICAgICAgIAogICAgICAgIAp3aW5kb3cuU3ByaXRlX1RpbWVyID0gU3ByaXRlX1RpbWVy","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBTcHJpdGVfVGltZXIsCiAgICBfX2hhc1Byb3AgPSB7fS5oYXNPd25Qcm9wZXJ0eSwKICAgIF9fZXh0ZW5kcyA9IGZ1bmN0aW9uKGNoaWxkLCBwYXJlbnQpIHsgZm9yICh2YXIga2V5IGluIHBhcmVudCkgeyBpZiAoX19oYXNQcm9wLmNhbGwocGFyZW50LCBrZXkpKSBjaGlsZFtrZXldID0gcGFyZW50W2tleV07IH0gZnVuY3Rpb24gY3RvcigpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGNoaWxkOyB9IGN0b3IucHJvdG90eXBlID0gcGFyZW50LnByb3RvdHlwZTsgY2hpbGQucHJvdG90eXBlID0gbmV3IGN0b3IoKTsgY2hpbGQuX19zdXBlcl9fID0gcGFyZW50LnByb3RvdHlwZTsgcmV0dXJuIGNoaWxkOyB9OwoKICBTcHJpdGVfVGltZXIgPSAoZnVuY3Rpb24oX3N1cGVyKSB7CiAgICBfX2V4dGVuZHMoU3ByaXRlX1RpbWVyLCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFNwcml0ZV9UaW1lcihsb2dpYywgdmlld3BvcnQpIHsKICAgICAgU3ByaXRlX1RpbWVyLl9fc3VwZXJfXy5jb25zdHJ1Y3Rvci5jYWxsKHRoaXMsIDEwMCwgMjQgKiBXaW5kb3dfQmFzZS5zY2FsZSwgdmlld3BvcnQpOwogICAgICB0aGlzLmxvZ2ljID0gbG9naWM7CiAgICAgIHRoaXMubWludXRlcyA9IHRoaXMubG9naWMubWludXRlczsKICAgICAgdGhpcy5zZWNvbmRzID0gdGhpcy5sb2dpYy5zZWNvbmRzOwogICAgICB0aGlzLnogPSAyMDA7CiAgICAgIHRoaXMueCA9IDM7CiAgICAgIHRoaXMuYmFja2dyb3VuZENvbG9yID0gQ29sb3IuVFJBTlNQQVJFTlQ7CiAgICAgIHRoaXMudGV4dCA9IHNwcmludGYoIiUwMmQ6JTAyZCIsIHRoaXMubWludXRlcywgdGhpcy5zZWNvbmRzKTsKICAgIH0KCiAgICBTcHJpdGVfVGltZXIucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkgewogICAgICBTcHJpdGVfVGltZXIuX19zdXBlcl9fLnVwZGF0ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICBpZiAodGhpcy5sb2dpYyA9PSBudWxsKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHRoaXMudmlzaWJsZSA9IHRoaXMubG9naWMuaXNSdW5uaW5nOwogICAgICBpZiAodGhpcy5taW51dGVzICE9PSB0aGlzLmxvZ2ljLm1pbnV0ZXMgfHwgdGhpcy5zZWNvbmRzICE9PSB0aGlzLmxvZ2ljLnNlY29uZHMpIHsKICAgICAgICB0aGlzLm1pbnV0ZXMgPSB0aGlzLmxvZ2ljLm1pbnV0ZXM7CiAgICAgICAgdGhpcy5zZWNvbmRzID0gdGhpcy5sb2dpYy5zZWNvbmRzOwogICAgICAgIHRoaXMudGV4dCA9IHNwcmludGYoIiUwMmQ6JTAyZCIsIHRoaXMubWludXRlcywgdGhpcy5zZWNvbmRzKTsKICAgICAgICByZXR1cm4gdGhpcy5yZWZyZXNoKCk7CiAgICAgIH0KICAgIH07CgogICAgcmV0dXJuIFNwcml0ZV9UaW1lcjsKCiAgfSkoU3ByaXRlX1RleHQpOwoKICB3aW5kb3cuU3ByaXRlX1RpbWVyID0gU3ByaXRlX1RpbWVyOwoKfSkuY2FsbCh0aGlzKTsK"},{"name":"Spriteset_Base","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogU3ByaXRlc2V0X0Jhc2UKIyAgIENyZWF0ZWQgb246IDIwMTMtMDktMjkKIwojICAgQ29weXJpZ2h0IChDKSAyMDEzIEFuZHLpIFJhZG9tc2tpLiBBbGwgcmlnaHRzIHJlc2VydmVkLgojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQojCiMgICBDbGFzczogU3ByaXRlc2V0X0FuaW1hdGlvbgojCiMgICBBIGJhc2UgY2xhc3MgZm9yIGFsbCBvdGhlciB3aW5kb3cgY2xhc3Nlcy4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCmNsYXNzIFNwcml0ZXNldF9CYXNlCiAgICBjb25zdHJ1Y3RvcjogKHZpZXdwb3J0KSAtPgogICAgICAgIEB2aWV3cG9ydCA9IHZpZXdwb3J0CgogICAgcHJlcGFyZTogLT4KCiAgICAKICAgIHVwZGF0ZTogLT4KCiAgCiAgICAgICAgCiAgICAgICAgCndpbmRvdy5TcHJpdGVzZXRfQmFzZSA9IFNwcml0ZXNldF9CYXNl","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBTcHJpdGVzZXRfQmFzZTsKCiAgU3ByaXRlc2V0X0Jhc2UgPSAoZnVuY3Rpb24oKSB7CiAgICBmdW5jdGlvbiBTcHJpdGVzZXRfQmFzZSh2aWV3cG9ydCkgewogICAgICB0aGlzLnZpZXdwb3J0ID0gdmlld3BvcnQ7CiAgICB9CgogICAgU3ByaXRlc2V0X0Jhc2UucHJvdG90eXBlLnByZXBhcmUgPSBmdW5jdGlvbigpIHt9OwoKICAgIFNwcml0ZXNldF9CYXNlLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpIHt9OwoKICAgIHJldHVybiBTcHJpdGVzZXRfQmFzZTsKCiAgfSkoKTsKCiAgd2luZG93LlNwcml0ZXNldF9CYXNlID0gU3ByaXRlc2V0X0Jhc2U7Cgp9KS5jYWxsKHRoaXMpOwo="},{"name":"Spriteset_Animation","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogU3ByaXRlc2V0X0FuaW1hdGlvbgojICAgQ3JlYXRlZCBvbjogMjAxMy0wOS0yOQojCiMgICBDb3B5cmlnaHQgKEMpIDIwMTMgQW5kcukgUmFkb21za2kuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIENsYXNzOiBTcHJpdGVzZXRfQW5pbWF0aW9uCiMKIyAgIEEgYmFzZSBjbGFzcyBmb3IgYWxsIG90aGVyIHdpbmRvdyBjbGFzc2VzLgojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKY2xhc3MgU3ByaXRlc2V0X0FuaW1hdGlvbiBleHRlbmRzIFNwcml0ZXNldF9CYXNlCiAgICBjb25zdHJ1Y3RvcjogKGxvZ2ljLCB2aWV3cG9ydCkgLT4KICAgICAgICBzdXBlcih2aWV3cG9ydCkKICAgICAgICAKICAgICAgICBAbG9naWMgPSBsb2dpYwogICAgICAgIEBzcHJpdGVzID0gbmV3IEFycmF5KDE2KQogICAgICAgCiAgICAgICAgQHRhcmdldCA9IHsgeDogMCwgeTogMCwgc3ByaXRlOiBudWxsIH0gIAogICAgICAgIEByZWZyZXNoKCkKICAgIGRpc3Bvc2U6IC0+CiAgICAgICAgZm9yIHNwcml0ZSBpbiBAc3ByaXRlcwogICAgICAgICAgICBpZiBzcHJpdGU/IHRoZW4gc3ByaXRlLmRpc3Bvc2UoKQogICAgICAgICAgICAKICAgIGNyZWF0ZVNwcml0ZTogLT4KICAgICAgICBzcHJpdGUgPSBuZXcgU3ByaXRlKEB2aWV3cG9ydCkKICAgICAgICBzcHJpdGUudmlzaWJsZSA9IG5vCiAgICAgICAgc3ByaXRlLnNyY1JlY3QgPSBuZXcgUmVjdCgwLCAwLCAxLCAxKQogICAgICAgIHNwcml0ZS56ID0gMTUwMAogICAgICAgIAogICAgICAgIHJldHVybiBzcHJpdGUKICAgICAgICAgICAgCiAgICByZWZyZXNoOiAtPgogICAgICAgIGlmIEBsb2dpYz8KICAgICAgICAgICAgQGJpdG1hcDEgPSBSZXNvdXJjZU1hbmFnZXIuZ2V0Qml0bWFwKCJHcmFwaGljcy9BbmltYXRpb25zLyN7QGxvZ2ljLmdyYXBoaWMxLm5hbWV9IikKICAgICAgICAgICAgY3VzdG9tTmFtZSA9IEBsb2dpYy5ncmFwaGljMS5uYW1lCiAgICAgICAgICAgIGlmIEBsb2dpYy5ncmFwaGljMj8gYW5kIEBsb2dpYy5ncmFwaGljMi5uYW1lICE9ICIiCiAgICAgICAgICAgICAgICBjdXN0b21OYW1lICs9IEBsb2dpYy5ncmFwaGljMi5uYW1lCiAgICAgICAgICAgICAgICBAYml0bWFwMiA9IFJlc291cmNlTWFuYWdlci5nZXRCaXRtYXAoIkdyYXBoaWNzL0FuaW1hdGlvbnMvI3tAbG9naWMuZ3JhcGhpYzIubmFtZX0iKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgIEBiaXRtYXAgPSBSZXNvdXJjZU1hbmFnZXIuZ2V0Q3VzdG9tQml0bWFwKCJHcmFwaGljcy9BbmltYXRpb25zL0N1c3RvbS8je2N1c3RvbU5hbWV9IikKICAgICAgICAgICAgQHRhcmdldCA9IHsgeDogMCwgeTogMCwgc3ByaXRlOiBudWxsIH0gICAgCiAgICAgICAgICAgIEBzb3VyY2UgPSB7IHg6IDAsIHk6IDAsIHNwcml0ZTogbnVsbCB9IAogICAgICAgICAgICAKICAgICAgICAgICAgaWYgbm90IEBiaXRtYXA/IHRoZW4gQHByZXBhcmUoKQogICAgcHJlcGFyZTogLT4KICAgICAgICBzID0gV2luZG93X0Jhc2Uuc2NhbGUKICAgICAgICBmaXJzdEJsb2NrQ291bnQgPSAwCiAgICAgICAgc2Vjb25kQmxvY2tDb3VudCA9IDAKICAgICAgICAKICAgICAgICBpZiBub3QgQGJpdG1hcD8KICAgICAgICAgICAgY3VzdG9tTmFtZSA9IEBsb2dpYy5ncmFwaGljMS5uYW1lCiAgICAgICAgICAgIGlmIEBsb2dpYy5ncmFwaGljMj8gYW5kIEBsb2dpYy5ncmFwaGljMi5uYW1lICE9ICIiCiAgICAgICAgICAgICAgICBjdXN0b21OYW1lICs9IEBsb2dpYy5ncmFwaGljMi5uYW1lCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgaWYgQGJpdG1hcDE/CiAgICAgICAgCSAgICBmaXJzdEJsb2NrQ291bnQgPSBNYXRoLmNlaWwoQGJpdG1hcDEuaGVpZ2h0IC8gKDE5MipzKSkKICAgICAgICAJCiAgICAgICAgICAgIGlmIEBiaXRtYXAyPwogICAgICAgICAgICAgICAgc2Vjb25kQmxvY2tDb3VudCA9IE1hdGguY2VpbChAYml0bWFwMi5oZWlnaHQgLyAoMTkyKnMpKQogICAgICAgIAkKICAgICAgICAgICAgYmxvY2tDb3VudCA9IGZpcnN0QmxvY2tDb3VudCArIHNlY29uZEJsb2NrQ291bnQKICAgICAgICAgICAgaSA9IDAKICAgICAgICAgICAgaWYgYmxvY2tDb3VudCA+IDAKICAgICAgICAgICAgICAgIEBiaXRtYXAgPSBuZXcgQml0bWFwKGJsb2NrQ291bnQgKiA1ICogKDE5MipzKSwgMTkyKnMpCiAgICAgICAgCiAgICAgICAgICAgICAgICBmb3IgaSBpbiBbMC4uLihmaXJzdEJsb2NrQ291bnQgKiA1KV0KICAgICAgICAgICAgICAgICAgICBAYml0bWFwLmJsdChpICogKDE5MipzKSwgMCwgQGJpdG1hcDEsIG5ldyBSZWN0KChpICUgNSkgKiAoMTkyKnMpLCBNYXRoLmZsb29yKGkgLyA1KSAqICgxOTIqcyksIDE5MipzLCAxOTIqcykpCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZm9yIGogaW4gW2kuLi4oaSArIChzZWNvbmRCbG9ja0NvdW50ICogNSkpXQogICAgICAgICAgICAgICAgICAgIEBiaXRtYXAuYmx0KGogKiAoMTkyKnMpLCAwLCBAYml0bWFwMiwgbmV3IFJlY3QoKGogJSA1KSAqICgxOTIqcyksIE1hdGguZmxvb3IoKGotaSkgLyA1KSAqICgxOTIqcyksIDE5MipzLCAxOTIqcykpCiAgICAgICAgICAgIAogICAgICAgICAgICBSZXNvdXJjZU1hbmFnZXIuc2V0Q3VzdG9tQml0bWFwKCJHcmFwaGljcy9BbmltYXRpb25zL0N1c3RvbS8je2N1c3RvbU5hbWV9IiwgQGJpdG1hcCkKICAgICAgICByZXR1cm4gbnVsbAogICAgICAgIAogICAgY2xlYXJTcHJpdGVzOiAtPgogICAgICAgIGZvciBzcHJpdGUgaW4gQHNwcml0ZXMKICAgICAgICAgICAgaWYgc3ByaXRlPyB0aGVuIHNwcml0ZS52aXNpYmxlID0gbm8KICAgICAgICAgICAgCiAgICBjYWxjdWxhdGVGaXJzdExpbmtQb2ludDogKHRhcmdldCkgLT4KICAgICAgICBAY2FsY3VsYXRlTGlua1BvaW50KHRhcmdldCwgMCkKICAgIGNhbGN1bGF0ZUxhc3RMaW5rUG9pbnQ6ICh0YXJnZXQpIC0+CiAgICAgICAgQGNhbGN1bGF0ZUxpbmtQb2ludCh0YXJnZXQsIEBsb2dpYy5mcmFtZXMubGVuZ3RoLTEpCiAgICAgICAgCiAgICBjYWxjdWxhdGVMaW5rUG9pbnQ6ICh0YXJnZXQsIGZyYW1lSW5kZXgpIC0+CiAgICAgICAgeCA9IHRhcmdldC54ICsgdGFyZ2V0LnNyY1JlY3Qud2lkdGggLyAyCiAgICAgICAgeSA9IHRhcmdldC55ICsgdGFyZ2V0LnNyY1JlY3QuaGVpZ2h0IC8gMgogICAgICAgIHJlc3VsdCA9IHg6IG51bGwsIHk6IG51bGwKICAgICAgICBmcmFtZSA9IEBsb2dpYy5mcmFtZXNbZnJhbWVJbmRleF0KICAgICAgICBjZWxsID0gbnVsbAogICAgICAgIHpvb20gPSAxLjAKICAgICAgICAKICAgICAgICBmb3IgaSBpbiBbMC4uLmZyYW1lLmNlbGxzLmxlbmd0aF0KICAgICAgICAgICAgY2VsbCA9IGZyYW1lLmNlbGxzW2ldCiAgICAgICAgICAgIGlmIGNlbGw/IGFuZCBjZWxsLmlzTGlua1BvaW50CiAgICAgICAgICAgICAgICBpZiBub3QgY2VsbC5hbmdsZVJhZGlhbnM/CiAgICAgICAgICAgICAgICAgICAgY2VsbC5hbmdsZVJhZGlhbnMgPSBNYXRoLmRlZ3JlZXNUb1JhZGlhbnMoY2VsbC5hbmdsZSkKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIHpvb20gPSBjZWxsLnpvb20gLyAxMDAuMAogICAgICAgICAgICAgCiAgICAgICAgICAgICAgICByZXN1bHQueCA9IGNlbGwueCAqICgyKldpbmRvd19CYXNlLnNjYWxlKSArIHggLSA5NipXaW5kb3dfQmFzZS5zY2FsZQogICAgICAgICAgICAgICAgcmVzdWx0LnkgPSBjZWxsLnkgKiAoMipXaW5kb3dfQmFzZS5zY2FsZSkgKyB5IC0gOTYqV2luZG93X0Jhc2Uuc2NhbGUKICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIAogICAgICAgIHJldHVybiByZXN1bHQKICAgIAkJCSAgICAKICAgIHVwZGF0ZTogLT4KICAgICAgICBzdXBlcgoKICAgICAgICBpZiBub3QgQGxvZ2ljPyB0aGVuIHJldHVybgogICAgICAgIGlmIG5vdCBAbG9naWMuaXNSdW5uaW5nIAogICAgICAgICAgICBAY2xlYXJTcHJpdGVzKCkKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIAogICAgICAgIGlmIEB0YXJnZXQuc3ByaXRlPwogICAgICAgICAgICBAdGFyZ2V0LnggPSBAdGFyZ2V0LnNwcml0ZS54ICsgQHRhcmdldC5zcHJpdGUuc3JjUmVjdC53aWR0aCAvIDIgLSBAdGFyZ2V0LnNwcml0ZS5veAogICAgICAgICAgICBAdGFyZ2V0LnkgPSBAdGFyZ2V0LnNwcml0ZS55ICsgQHRhcmdldC5zcHJpdGUuc3JjUmVjdC5oZWlnaHQgLyAyIC0gQHRhcmdldC5zcHJpdGUub3kKICAgICAgICAKICAgICAgICAKICAgICAgICB4ID0gMAogICAgICAgIHkgPSAwCgogICAgICAgIHggPSBAdGFyZ2V0LngKICAgICAgICB5ID0gQHRhcmdldC55CiAgICAgICAgICAgIAogICAgICAgIEBjbGVhclNwcml0ZXMoKQogICAgICAgIGZyYW1lID0gQGxvZ2ljLmN1cnJlbnRGcmFtZQogICAgICAgIGVmZmVjdCA9IEBsb2dpYy5jdXJyZW50RWZmZWN0CiAgICAgICAgY2VsbCA9IG51bGwKICAgICAgICBzcHJpdGUgPSBudWxsCiAgICAgICAgem9vbSA9IDEuMAogICAgICAgIHdpZHRoID0gMAogICAgICAgIGhlaWdodCA9IDAKICAgICAgICBzID0gV2luZG93X0Jhc2Uuc2NhbGUKICAgICAgICBmb3IgaSBpbiBbMC4uLmZyYW1lLmNlbGxzLmxlbmd0aF0KICAgICAgICAgICAgY2VsbCA9IGZyYW1lLmNlbGxzW2ldCiAgICAgICAgICAgIGlmIGNlbGw/CiAgICAgICAgICAgICAgICBpZiBub3QgQHNwcml0ZXNbaV0/CiAgICAgICAgICAgICAgICAgICAgQHNwcml0ZXNbaV0gPSBAY3JlYXRlU3ByaXRlKCkKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGlmIG5vdCBjZWxsLmFuZ2xlUmFkaWFucz8KICAgICAgICAgICAgICAgICAgICBjZWxsLmFuZ2xlUmFkaWFucyA9IE1hdGguZGVncmVlc1RvUmFkaWFucyhjZWxsLmFuZ2xlKQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgc3ByaXRlID0gQHNwcml0ZXNbaV0KICAgICAgICAgICAgICAgIHNwcml0ZS5iaXRtYXAgPSBAYml0bWFwCiAgICAgICAgICAgICAgICBzcHJpdGUuYW5nbGUgPSBjZWxsLmFuZ2xlUmFkaWFucwogICAgICAgICAgICAgICAgc3ByaXRlLm9wYWNpdHkgPSBjZWxsLm9wYWNpdHkKICAgICAgICAgICAgICAgIHNwcml0ZS5ibGVuZGluZ01vZGUgPSBjZWxsLmJsZW5kaW5nCiAgICAgICAgICAgICAgICB6b29tID0gY2VsbC56b29tIC8gMTAwLjAKICAgICAgICAgICAgICAgIHNwcml0ZS5tb3Rpb25CbHVyID0gbm8KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgc3ByaXRlLnpvb21YID0gem9vbQogICAgICAgICAgICAgICAgc3ByaXRlLnpvb21ZID0gem9vbQogICAgICAgICAgICAgICAgc3ByaXRlLm1pcnJvciA9IGNlbGwuZmxpcAogICAgICAgICAgICAgICAgc3ByaXRlLnNyY1JlY3Quc2V0KGNlbGwucGF0dGVybiAqICgxOTIqcyksIDAsIDE5MipzLCAxOTIqcykKICAgICAgICAgICAgICAgIHNwcml0ZS5veCA9IDk2KnMKICAgICAgICAgICAgICAgIHNwcml0ZS5veSA9IDk2KnMKICAgICAgICAgICAgICAgIHNwcml0ZS54ID0gY2VsbC54ICogKDIqcykgKyB4CiAgICAgICAgICAgICAgICBzcHJpdGUueSA9IGNlbGwueSAqICgyKnMpICsgeQogICAgICAgICAgICAgICAgc3ByaXRlLnZpc2libGUgPSB5ZXMKICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBzcHJpdGUudXBkYXRlKCkKICAgICAgICAgCiAgICAgICAgaWYgR2FtZU1hbmFnZXIuYmFja2dyb3VuZD8KICAgICAgICAgICAgR2FtZU1hbmFnZXIuYmFja2dyb3VuZC52aXNpYmxlID0geWVzICAKICAgICAgICBpZiBAdGFyZ2V0PyBhbmQgQHRhcmdldC5zcHJpdGU/CiAgICAgICAgICAgIEB0YXJnZXQuc3ByaXRlLnZpc2libGUgPSB5ZXMKICAgICAgICBpZiBAc291cmNlPyBhbmQgQHNvdXJjZS5zcHJpdGU/CiAgICAgICAgICAgIEBzb3VyY2Uuc3ByaXRlLnZpc2libGUgPSB5ZXMKICAgICAgICAgICAgICAgIAogICAgICAgIGlmIGVmZmVjdD8KICAgICAgICAgICAgc3dpdGNoIGVmZmVjdC5mbGFzaFNjb3BlCiAgICAgICAgICAgICAgICB3aGVuIDEgIyBUYXJnZXQKICAgICAgICAgICAgICAgICAgICBpZiBAdGFyZ2V0LnNwcml0ZT8KICAgICAgICAgICAgICAgICAgICAgICAgQHRhcmdldC5zcHJpdGUuZmxhc2goZWZmZWN0LmZsYXNoQ29sb3IsIGVmZmVjdC5mbGFzaER1cmF0aW9uKQogICAgICAgICAgICAgICAgd2hlbiAyICMgU2NyZWVuCiAgICAgICAgICAgICAgICAgICAgR3JhcGhpY3Mudmlld3BvcnQuZmxhc2goZWZmZWN0LmZsYXNoQ29sb3IsIGVmZmVjdC5mbGFzaER1cmF0aW9uKQoKICAgICAgICAgICAgaWYgQHRhcmdldD8gYW5kIEB0YXJnZXQuc3ByaXRlPwogICAgICAgICAgICAgICAgQHRhcmdldC5zcHJpdGUudmlzaWJsZSA9ICFlZmZlY3QuaGlkZVRhcmdldAogICAgICAgICAgICBpZiBAc291cmNlPyBhbmQgQHNvdXJjZS5zcHJpdGU/CiAgICAgICAgICAgICAgICBAc291cmNlLnNwcml0ZS52aXNpYmxlID0gIWVmZmVjdC5oaWRlU291cmNlCiAgICAgICAgICAgIGlmIEdhbWVNYW5hZ2VyLmJhY2tncm91bmQ/CiAgICAgICAgICAgICAgICBHYW1lTWFuYWdlci5iYWNrZ3JvdW5kLnZpc2libGUgPSAhZWZmZWN0LmhpZGVCYWNrZ3JvdW5kCiAgICAgICAgICAgIGlmIEdhbWVNYW5hZ2VyLmludGVyZmFjZT8KICAgICAgICAgICAgICAgIEdhbWVNYW5hZ2VyLmludGVyZmFjZS52aXNpYmxlID0gIWVmZmVjdC5oaWRlSW50ZXJmYWNlCiAgICAgICAgICAgIGlmIEdhbWVNYW5hZ2VyLmNoYXJhY3RlcnM/CiAgICAgICAgICAgICAgICBHYW1lTWFuYWdlci5jaGFyYWN0ZXJzLnZpc2libGUgPSAhZWZmZWN0LmhpZGVPdGhlckNoYXJhY3RlcnMKICAgICAgICAKICAgICAgICAKd2luZG93LlNwcml0ZXNldF9BbmltYXRpb24gPSBTcHJpdGVzZXRfQW5pbWF0aW9u","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBTcHJpdGVzZXRfQW5pbWF0aW9uLAogICAgX19oYXNQcm9wID0ge30uaGFzT3duUHJvcGVydHksCiAgICBfX2V4dGVuZHMgPSBmdW5jdGlvbihjaGlsZCwgcGFyZW50KSB7IGZvciAodmFyIGtleSBpbiBwYXJlbnQpIHsgaWYgKF9faGFzUHJvcC5jYWxsKHBhcmVudCwga2V5KSkgY2hpbGRba2V5XSA9IHBhcmVudFtrZXldOyB9IGZ1bmN0aW9uIGN0b3IoKSB7IHRoaXMuY29uc3RydWN0b3IgPSBjaGlsZDsgfSBjdG9yLnByb3RvdHlwZSA9IHBhcmVudC5wcm90b3R5cGU7IGNoaWxkLnByb3RvdHlwZSA9IG5ldyBjdG9yKCk7IGNoaWxkLl9fc3VwZXJfXyA9IHBhcmVudC5wcm90b3R5cGU7IHJldHVybiBjaGlsZDsgfTsKCiAgU3ByaXRlc2V0X0FuaW1hdGlvbiA9IChmdW5jdGlvbihfc3VwZXIpIHsKICAgIF9fZXh0ZW5kcyhTcHJpdGVzZXRfQW5pbWF0aW9uLCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFNwcml0ZXNldF9BbmltYXRpb24obG9naWMsIHZpZXdwb3J0KSB7CiAgICAgIFNwcml0ZXNldF9BbmltYXRpb24uX19zdXBlcl9fLmNvbnN0cnVjdG9yLmNhbGwodGhpcywgdmlld3BvcnQpOwogICAgICB0aGlzLmxvZ2ljID0gbG9naWM7CiAgICAgIHRoaXMuc3ByaXRlcyA9IG5ldyBBcnJheSgxNik7CiAgICAgIHRoaXMudGFyZ2V0ID0gewogICAgICAgIHg6IDAsCiAgICAgICAgeTogMCwKICAgICAgICBzcHJpdGU6IG51bGwKICAgICAgfTsKICAgICAgdGhpcy5yZWZyZXNoKCk7CiAgICB9CgogICAgU3ByaXRlc2V0X0FuaW1hdGlvbi5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgc3ByaXRlLCBfaSwgX2xlbiwgX3JlZiwgX3Jlc3VsdHM7CiAgICAgIF9yZWYgPSB0aGlzLnNwcml0ZXM7CiAgICAgIF9yZXN1bHRzID0gW107CiAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gX3JlZi5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykgewogICAgICAgIHNwcml0ZSA9IF9yZWZbX2ldOwogICAgICAgIGlmIChzcHJpdGUgIT0gbnVsbCkgewogICAgICAgICAgX3Jlc3VsdHMucHVzaChzcHJpdGUuZGlzcG9zZSgpKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgX3Jlc3VsdHMucHVzaCh2b2lkIDApOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gX3Jlc3VsdHM7CiAgICB9OwoKICAgIFNwcml0ZXNldF9BbmltYXRpb24ucHJvdG90eXBlLmNyZWF0ZVNwcml0ZSA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgc3ByaXRlOwogICAgICBzcHJpdGUgPSBuZXcgU3ByaXRlKHRoaXMudmlld3BvcnQpOwogICAgICBzcHJpdGUudmlzaWJsZSA9IGZhbHNlOwogICAgICBzcHJpdGUuc3JjUmVjdCA9IG5ldyBSZWN0KDAsIDAsIDEsIDEpOwogICAgICBzcHJpdGUueiA9IDE1MDA7CiAgICAgIHJldHVybiBzcHJpdGU7CiAgICB9OwoKICAgIFNwcml0ZXNldF9BbmltYXRpb24ucHJvdG90eXBlLnJlZnJlc2ggPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGN1c3RvbU5hbWU7CiAgICAgIGlmICh0aGlzLmxvZ2ljICE9IG51bGwpIHsKICAgICAgICB0aGlzLmJpdG1hcDEgPSBSZXNvdXJjZU1hbmFnZXIuZ2V0Qml0bWFwKCJHcmFwaGljcy9BbmltYXRpb25zLyIgKyB0aGlzLmxvZ2ljLmdyYXBoaWMxLm5hbWUpOwogICAgICAgIGN1c3RvbU5hbWUgPSB0aGlzLmxvZ2ljLmdyYXBoaWMxLm5hbWU7CiAgICAgICAgaWYgKCh0aGlzLmxvZ2ljLmdyYXBoaWMyICE9IG51bGwpICYmIHRoaXMubG9naWMuZ3JhcGhpYzIubmFtZSAhPT0gIiIpIHsKICAgICAgICAgIGN1c3RvbU5hbWUgKz0gdGhpcy5sb2dpYy5ncmFwaGljMi5uYW1lOwogICAgICAgICAgdGhpcy5iaXRtYXAyID0gUmVzb3VyY2VNYW5hZ2VyLmdldEJpdG1hcCgiR3JhcGhpY3MvQW5pbWF0aW9ucy8iICsgdGhpcy5sb2dpYy5ncmFwaGljMi5uYW1lKTsKICAgICAgICB9CiAgICAgICAgdGhpcy5iaXRtYXAgPSBSZXNvdXJjZU1hbmFnZXIuZ2V0Q3VzdG9tQml0bWFwKCJHcmFwaGljcy9BbmltYXRpb25zL0N1c3RvbS8iICsgY3VzdG9tTmFtZSk7CiAgICAgICAgdGhpcy50YXJnZXQgPSB7CiAgICAgICAgICB4OiAwLAogICAgICAgICAgeTogMCwKICAgICAgICAgIHNwcml0ZTogbnVsbAogICAgICAgIH07CiAgICAgICAgdGhpcy5zb3VyY2UgPSB7CiAgICAgICAgICB4OiAwLAogICAgICAgICAgeTogMCwKICAgICAgICAgIHNwcml0ZTogbnVsbAogICAgICAgIH07CiAgICAgICAgaWYgKHRoaXMuYml0bWFwID09IG51bGwpIHsKICAgICAgICAgIHJldHVybiB0aGlzLnByZXBhcmUoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgU3ByaXRlc2V0X0FuaW1hdGlvbi5wcm90b3R5cGUucHJlcGFyZSA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgYmxvY2tDb3VudCwgY3VzdG9tTmFtZSwgZmlyc3RCbG9ja0NvdW50LCBpLCBqLCBzLCBzZWNvbmRCbG9ja0NvdW50LCBfaSwgX2osIF9yZWYsIF9yZWYxOwogICAgICBzID0gV2luZG93X0Jhc2Uuc2NhbGU7CiAgICAgIGZpcnN0QmxvY2tDb3VudCA9IDA7CiAgICAgIHNlY29uZEJsb2NrQ291bnQgPSAwOwogICAgICBpZiAodGhpcy5iaXRtYXAgPT0gbnVsbCkgewogICAgICAgIGN1c3RvbU5hbWUgPSB0aGlzLmxvZ2ljLmdyYXBoaWMxLm5hbWU7CiAgICAgICAgaWYgKCh0aGlzLmxvZ2ljLmdyYXBoaWMyICE9IG51bGwpICYmIHRoaXMubG9naWMuZ3JhcGhpYzIubmFtZSAhPT0gIiIpIHsKICAgICAgICAgIGN1c3RvbU5hbWUgKz0gdGhpcy5sb2dpYy5ncmFwaGljMi5uYW1lOwogICAgICAgIH0KICAgICAgICBpZiAodGhpcy5iaXRtYXAxICE9IG51bGwpIHsKICAgICAgICAgIGZpcnN0QmxvY2tDb3VudCA9IE1hdGguY2VpbCh0aGlzLmJpdG1hcDEuaGVpZ2h0IC8gKDE5MiAqIHMpKTsKICAgICAgICB9CiAgICAgICAgaWYgKHRoaXMuYml0bWFwMiAhPSBudWxsKSB7CiAgICAgICAgICBzZWNvbmRCbG9ja0NvdW50ID0gTWF0aC5jZWlsKHRoaXMuYml0bWFwMi5oZWlnaHQgLyAoMTkyICogcykpOwogICAgICAgIH0KICAgICAgICBibG9ja0NvdW50ID0gZmlyc3RCbG9ja0NvdW50ICsgc2Vjb25kQmxvY2tDb3VudDsKICAgICAgICBpID0gMDsKICAgICAgICBpZiAoYmxvY2tDb3VudCA+IDApIHsKICAgICAgICAgIHRoaXMuYml0bWFwID0gbmV3IEJpdG1hcChibG9ja0NvdW50ICogNSAqICgxOTIgKiBzKSwgMTkyICogcyk7CiAgICAgICAgICBmb3IgKGkgPSBfaSA9IDAsIF9yZWYgPSBmaXJzdEJsb2NrQ291bnQgKiA1OyAwIDw9IF9yZWYgPyBfaSA8IF9yZWYgOiBfaSA+IF9yZWY7IGkgPSAwIDw9IF9yZWYgPyArK19pIDogLS1faSkgewogICAgICAgICAgICB0aGlzLmJpdG1hcC5ibHQoaSAqICgxOTIgKiBzKSwgMCwgdGhpcy5iaXRtYXAxLCBuZXcgUmVjdCgoaSAlIDUpICogKDE5MiAqIHMpLCBNYXRoLmZsb29yKGkgLyA1KSAqICgxOTIgKiBzKSwgMTkyICogcywgMTkyICogcykpOwogICAgICAgICAgfQogICAgICAgICAgZm9yIChqID0gX2ogPSBpLCBfcmVmMSA9IGkgKyAoc2Vjb25kQmxvY2tDb3VudCAqIDUpOyBpIDw9IF9yZWYxID8gX2ogPCBfcmVmMSA6IF9qID4gX3JlZjE7IGogPSBpIDw9IF9yZWYxID8gKytfaiA6IC0tX2opIHsKICAgICAgICAgICAgdGhpcy5iaXRtYXAuYmx0KGogKiAoMTkyICogcyksIDAsIHRoaXMuYml0bWFwMiwgbmV3IFJlY3QoKGogJSA1KSAqICgxOTIgKiBzKSwgTWF0aC5mbG9vcigoaiAtIGkpIC8gNSkgKiAoMTkyICogcyksIDE5MiAqIHMsIDE5MiAqIHMpKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgUmVzb3VyY2VNYW5hZ2VyLnNldEN1c3RvbUJpdG1hcCgiR3JhcGhpY3MvQW5pbWF0aW9ucy9DdXN0b20vIiArIGN1c3RvbU5hbWUsIHRoaXMuYml0bWFwKTsKICAgICAgfQogICAgICByZXR1cm4gbnVsbDsKICAgIH07CgogICAgU3ByaXRlc2V0X0FuaW1hdGlvbi5wcm90b3R5cGUuY2xlYXJTcHJpdGVzID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBzcHJpdGUsIF9pLCBfbGVuLCBfcmVmLCBfcmVzdWx0czsKICAgICAgX3JlZiA9IHRoaXMuc3ByaXRlczsKICAgICAgX3Jlc3VsdHMgPSBbXTsKICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBfcmVmLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7CiAgICAgICAgc3ByaXRlID0gX3JlZltfaV07CiAgICAgICAgaWYgKHNwcml0ZSAhPSBudWxsKSB7CiAgICAgICAgICBfcmVzdWx0cy5wdXNoKHNwcml0ZS52aXNpYmxlID0gZmFsc2UpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBfcmVzdWx0cy5wdXNoKHZvaWQgMCk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiBfcmVzdWx0czsKICAgIH07CgogICAgU3ByaXRlc2V0X0FuaW1hdGlvbi5wcm90b3R5cGUuY2FsY3VsYXRlRmlyc3RMaW5rUG9pbnQgPSBmdW5jdGlvbih0YXJnZXQpIHsKICAgICAgcmV0dXJuIHRoaXMuY2FsY3VsYXRlTGlua1BvaW50KHRhcmdldCwgMCk7CiAgICB9OwoKICAgIFNwcml0ZXNldF9BbmltYXRpb24ucHJvdG90eXBlLmNhbGN1bGF0ZUxhc3RMaW5rUG9pbnQgPSBmdW5jdGlvbih0YXJnZXQpIHsKICAgICAgcmV0dXJuIHRoaXMuY2FsY3VsYXRlTGlua1BvaW50KHRhcmdldCwgdGhpcy5sb2dpYy5mcmFtZXMubGVuZ3RoIC0gMSk7CiAgICB9OwoKICAgIFNwcml0ZXNldF9BbmltYXRpb24ucHJvdG90eXBlLmNhbGN1bGF0ZUxpbmtQb2ludCA9IGZ1bmN0aW9uKHRhcmdldCwgZnJhbWVJbmRleCkgewogICAgICB2YXIgY2VsbCwgZnJhbWUsIGksIHJlc3VsdCwgeCwgeSwgem9vbSwgX2ksIF9yZWY7CiAgICAgIHggPSB0YXJnZXQueCArIHRhcmdldC5zcmNSZWN0LndpZHRoIC8gMjsKICAgICAgeSA9IHRhcmdldC55ICsgdGFyZ2V0LnNyY1JlY3QuaGVpZ2h0IC8gMjsKICAgICAgcmVzdWx0ID0gewogICAgICAgIHg6IG51bGwsCiAgICAgICAgeTogbnVsbAogICAgICB9OwogICAgICBmcmFtZSA9IHRoaXMubG9naWMuZnJhbWVzW2ZyYW1lSW5kZXhdOwogICAgICBjZWxsID0gbnVsbDsKICAgICAgem9vbSA9IDEuMDsKICAgICAgZm9yIChpID0gX2kgPSAwLCBfcmVmID0gZnJhbWUuY2VsbHMubGVuZ3RoOyAwIDw9IF9yZWYgPyBfaSA8IF9yZWYgOiBfaSA+IF9yZWY7IGkgPSAwIDw9IF9yZWYgPyArK19pIDogLS1faSkgewogICAgICAgIGNlbGwgPSBmcmFtZS5jZWxsc1tpXTsKICAgICAgICBpZiAoKGNlbGwgIT0gbnVsbCkgJiYgY2VsbC5pc0xpbmtQb2ludCkgewogICAgICAgICAgaWYgKGNlbGwuYW5nbGVSYWRpYW5zID09IG51bGwpIHsKICAgICAgICAgICAgY2VsbC5hbmdsZVJhZGlhbnMgPSBNYXRoLmRlZ3JlZXNUb1JhZGlhbnMoY2VsbC5hbmdsZSk7CiAgICAgICAgICB9CiAgICAgICAgICB6b29tID0gY2VsbC56b29tIC8gMTAwLjA7CiAgICAgICAgICByZXN1bHQueCA9IGNlbGwueCAqICgyICogV2luZG93X0Jhc2Uuc2NhbGUpICsgeCAtIDk2ICogV2luZG93X0Jhc2Uuc2NhbGU7CiAgICAgICAgICByZXN1bHQueSA9IGNlbGwueSAqICgyICogV2luZG93X0Jhc2Uuc2NhbGUpICsgeSAtIDk2ICogV2luZG93X0Jhc2Uuc2NhbGU7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH07CgogICAgU3ByaXRlc2V0X0FuaW1hdGlvbi5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBjZWxsLCBlZmZlY3QsIGZyYW1lLCBoZWlnaHQsIGksIHMsIHNwcml0ZSwgd2lkdGgsIHgsIHksIHpvb20sIF9pLCBfcmVmOwogICAgICBTcHJpdGVzZXRfQW5pbWF0aW9uLl9fc3VwZXJfXy51cGRhdGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgaWYgKHRoaXMubG9naWMgPT0gbnVsbCkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBpZiAoIXRoaXMubG9naWMuaXNSdW5uaW5nKSB7CiAgICAgICAgdGhpcy5jbGVhclNwcml0ZXMoKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgaWYgKHRoaXMudGFyZ2V0LnNwcml0ZSAhPSBudWxsKSB7CiAgICAgICAgdGhpcy50YXJnZXQueCA9IHRoaXMudGFyZ2V0LnNwcml0ZS54ICsgdGhpcy50YXJnZXQuc3ByaXRlLnNyY1JlY3Qud2lkdGggLyAyIC0gdGhpcy50YXJnZXQuc3ByaXRlLm94OwogICAgICAgIHRoaXMudGFyZ2V0LnkgPSB0aGlzLnRhcmdldC5zcHJpdGUueSArIHRoaXMudGFyZ2V0LnNwcml0ZS5zcmNSZWN0LmhlaWdodCAvIDIgLSB0aGlzLnRhcmdldC5zcHJpdGUub3k7CiAgICAgIH0KICAgICAgeCA9IDA7CiAgICAgIHkgPSAwOwogICAgICB4ID0gdGhpcy50YXJnZXQueDsKICAgICAgeSA9IHRoaXMudGFyZ2V0Lnk7CiAgICAgIHRoaXMuY2xlYXJTcHJpdGVzKCk7CiAgICAgIGZyYW1lID0gdGhpcy5sb2dpYy5jdXJyZW50RnJhbWU7CiAgICAgIGVmZmVjdCA9IHRoaXMubG9naWMuY3VycmVudEVmZmVjdDsKICAgICAgY2VsbCA9IG51bGw7CiAgICAgIHNwcml0ZSA9IG51bGw7CiAgICAgIHpvb20gPSAxLjA7CiAgICAgIHdpZHRoID0gMDsKICAgICAgaGVpZ2h0ID0gMDsKICAgICAgcyA9IFdpbmRvd19CYXNlLnNjYWxlOwogICAgICBmb3IgKGkgPSBfaSA9IDAsIF9yZWYgPSBmcmFtZS5jZWxscy5sZW5ndGg7IDAgPD0gX3JlZiA/IF9pIDwgX3JlZiA6IF9pID4gX3JlZjsgaSA9IDAgPD0gX3JlZiA/ICsrX2kgOiAtLV9pKSB7CiAgICAgICAgY2VsbCA9IGZyYW1lLmNlbGxzW2ldOwogICAgICAgIGlmIChjZWxsICE9IG51bGwpIHsKICAgICAgICAgIGlmICh0aGlzLnNwcml0ZXNbaV0gPT0gbnVsbCkgewogICAgICAgICAgICB0aGlzLnNwcml0ZXNbaV0gPSB0aGlzLmNyZWF0ZVNwcml0ZSgpOwogICAgICAgICAgfQogICAgICAgICAgaWYgKGNlbGwuYW5nbGVSYWRpYW5zID09IG51bGwpIHsKICAgICAgICAgICAgY2VsbC5hbmdsZVJhZGlhbnMgPSBNYXRoLmRlZ3JlZXNUb1JhZGlhbnMoY2VsbC5hbmdsZSk7CiAgICAgICAgICB9CiAgICAgICAgICBzcHJpdGUgPSB0aGlzLnNwcml0ZXNbaV07CiAgICAgICAgICBzcHJpdGUuYml0bWFwID0gdGhpcy5iaXRtYXA7CiAgICAgICAgICBzcHJpdGUuYW5nbGUgPSBjZWxsLmFuZ2xlUmFkaWFuczsKICAgICAgICAgIHNwcml0ZS5vcGFjaXR5ID0gY2VsbC5vcGFjaXR5OwogICAgICAgICAgc3ByaXRlLmJsZW5kaW5nTW9kZSA9IGNlbGwuYmxlbmRpbmc7CiAgICAgICAgICB6b29tID0gY2VsbC56b29tIC8gMTAwLjA7CiAgICAgICAgICBzcHJpdGUubW90aW9uQmx1ciA9IGZhbHNlOwogICAgICAgICAgc3ByaXRlLnpvb21YID0gem9vbTsKICAgICAgICAgIHNwcml0ZS56b29tWSA9IHpvb207CiAgICAgICAgICBzcHJpdGUubWlycm9yID0gY2VsbC5mbGlwOwogICAgICAgICAgc3ByaXRlLnNyY1JlY3Quc2V0KGNlbGwucGF0dGVybiAqICgxOTIgKiBzKSwgMCwgMTkyICogcywgMTkyICogcyk7CiAgICAgICAgICBzcHJpdGUub3ggPSA5NiAqIHM7CiAgICAgICAgICBzcHJpdGUub3kgPSA5NiAqIHM7CiAgICAgICAgICBzcHJpdGUueCA9IGNlbGwueCAqICgyICogcykgKyB4OwogICAgICAgICAgc3ByaXRlLnkgPSBjZWxsLnkgKiAoMiAqIHMpICsgeTsKICAgICAgICAgIHNwcml0ZS52aXNpYmxlID0gdHJ1ZTsKICAgICAgICAgIHNwcml0ZS51cGRhdGUoKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKEdhbWVNYW5hZ2VyLmJhY2tncm91bmQgIT0gbnVsbCkgewogICAgICAgIEdhbWVNYW5hZ2VyLmJhY2tncm91bmQudmlzaWJsZSA9IHRydWU7CiAgICAgIH0KICAgICAgaWYgKCh0aGlzLnRhcmdldCAhPSBudWxsKSAmJiAodGhpcy50YXJnZXQuc3ByaXRlICE9IG51bGwpKSB7CiAgICAgICAgdGhpcy50YXJnZXQuc3ByaXRlLnZpc2libGUgPSB0cnVlOwogICAgICB9CiAgICAgIGlmICgodGhpcy5zb3VyY2UgIT0gbnVsbCkgJiYgKHRoaXMuc291cmNlLnNwcml0ZSAhPSBudWxsKSkgewogICAgICAgIHRoaXMuc291cmNlLnNwcml0ZS52aXNpYmxlID0gdHJ1ZTsKICAgICAgfQogICAgICBpZiAoZWZmZWN0ICE9IG51bGwpIHsKICAgICAgICBzd2l0Y2ggKGVmZmVjdC5mbGFzaFNjb3BlKSB7CiAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgIGlmICh0aGlzLnRhcmdldC5zcHJpdGUgIT0gbnVsbCkgewogICAgICAgICAgICAgIHRoaXMudGFyZ2V0LnNwcml0ZS5mbGFzaChlZmZlY3QuZmxhc2hDb2xvciwgZWZmZWN0LmZsYXNoRHVyYXRpb24pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICBHcmFwaGljcy52aWV3cG9ydC5mbGFzaChlZmZlY3QuZmxhc2hDb2xvciwgZWZmZWN0LmZsYXNoRHVyYXRpb24pOwogICAgICAgIH0KICAgICAgICBpZiAoKHRoaXMudGFyZ2V0ICE9IG51bGwpICYmICh0aGlzLnRhcmdldC5zcHJpdGUgIT0gbnVsbCkpIHsKICAgICAgICAgIHRoaXMudGFyZ2V0LnNwcml0ZS52aXNpYmxlID0gIWVmZmVjdC5oaWRlVGFyZ2V0OwogICAgICAgIH0KICAgICAgICBpZiAoKHRoaXMuc291cmNlICE9IG51bGwpICYmICh0aGlzLnNvdXJjZS5zcHJpdGUgIT0gbnVsbCkpIHsKICAgICAgICAgIHRoaXMuc291cmNlLnNwcml0ZS52aXNpYmxlID0gIWVmZmVjdC5oaWRlU291cmNlOwogICAgICAgIH0KICAgICAgICBpZiAoR2FtZU1hbmFnZXIuYmFja2dyb3VuZCAhPSBudWxsKSB7CiAgICAgICAgICBHYW1lTWFuYWdlci5iYWNrZ3JvdW5kLnZpc2libGUgPSAhZWZmZWN0LmhpZGVCYWNrZ3JvdW5kOwogICAgICAgIH0KICAgICAgICBpZiAoR2FtZU1hbmFnZXJbImludGVyZmFjZSJdICE9IG51bGwpIHsKICAgICAgICAgIEdhbWVNYW5hZ2VyWyJpbnRlcmZhY2UiXS52aXNpYmxlID0gIWVmZmVjdC5oaWRlSW50ZXJmYWNlOwogICAgICAgIH0KICAgICAgICBpZiAoR2FtZU1hbmFnZXIuY2hhcmFjdGVycyAhPSBudWxsKSB7CiAgICAgICAgICByZXR1cm4gR2FtZU1hbmFnZXIuY2hhcmFjdGVycy52aXNpYmxlID0gIWVmZmVjdC5oaWRlT3RoZXJDaGFyYWN0ZXJzOwogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICByZXR1cm4gU3ByaXRlc2V0X0FuaW1hdGlvbjsKCiAgfSkoU3ByaXRlc2V0X0Jhc2UpOwoKICB3aW5kb3cuU3ByaXRlc2V0X0FuaW1hdGlvbiA9IFNwcml0ZXNldF9BbmltYXRpb247Cgp9KS5jYWxsKHRoaXMpOwo="},{"name":"Spriteset_Weather","content":"# ===================================================================\n#\n#   Script: Spriteset_Weather\n#   Created on: 2013-11-02\n#\n#   Copyright (C) 2013 AndrÃ© Radomski. All rights reserved.\n#\n# ===================================================================\n#\n#   Class: Spriteset_Weather\n#\n#   A spriteset to make weather effects like rain, storm or snow.\n#\n# ===================================================================\n\nclass Spriteset_Weather extends Spriteset_Base\n    @TYPE_RAIN = 0\n    @TYPE_STORM = 1\n    @TYPE_SNOW = 2\n    \n    constructor: (viewport) ->\n        super(viewport)\n        @shadow = new Sprite(viewport)\n        @shadow.bitmap = new Bitmap(Graphics.width, Graphics.height)\n        @shadow.bitmap.fillRect(0, 0, Graphics.width, Graphics.height, new Color(0, 0, 0, 0.4))\n        @shadow.srcRect = new Rect(0, 0, Graphics.width, Graphics.height)\n        @shadow.z = 2500\n        @shadow.visible = no\n        \n        @sprites = new Array(90)\n        @refresh()\n        @type = 0\n        @power = 4\n        @currentPower = 0\n        @oldPower = 0\n        @powerIncrement = 0\n        @duration = 0\n        @bitmap = null\n    dispose: ->\n        for sprite in @sprites\n            if sprite? then sprite.dispose()\n        @shadow.dispose()\n        \n    visible: (visible) ->\n        for sprite in @sprites\n            if sprite? then sprite.visible = visible\n        #@shadow.visible = visible    \n    refresh: ->\n        for sprite in @sprites\n            if sprite? then sprite.visible = no\n        \n        #@shadow.visible = yes\n        if not bitmap? then bitmap = @createBitmap()\n        sprite = null\n        count = Math.floor(@currentPower) * 10\n        for i in [0...count]\n            if not @sprites[i]?\n                @sprites[i] = new Sprite(@viewport)\n                @sprites[i].srcRect = new Rect(0, 0, 1, 1)\n                @sprites[i].z = 3000\n                @sprites[i].opacity = Math.random() * 255\n            @sprites[i].bitmap = bitmap\n            @sprites[i].srcRect.set(0, 0, bitmap.width, bitmap.height)\n            @sprites[i].visible = yes\n            \n     \n    createBitmap: ->\n        bitmap = null\n        \n        switch @type\n            when 0 then bitmap = @createRainBitmap()\n            when 1 then bitmap = @createStormBitmap()\n            when 2 then bitmap = @createSnowBitmap()\n            \n        return bitmap\n        \n    createRainBitmap: ->\n        s = Window_Base.scale\n        bitmap = new Bitmap(7*s, 42*s)\n        for i in [0...7]\n            bitmap.fillRect(6*s-i, i*(6*s), 1, 6*s, Colors.RAIN_PARTICLE)\n            \n        return bitmap\n        \n    createStormBitmap: ->\n        s = Window_Base.scale\n        bitmap = new Bitmap(32*s, 64*s)\n        for i in [0...32*s]\n            bitmap.fillRect(15*s-i, i*2, 1, 2, Colors.STORM_PARTICLE)\n            \n        return bitmap\n        \n    createSnowBitmap: ->\n        s = Window_Base.scale\n        bitmap = new Bitmap(6, 6)\n        \n        # Face\n        bitmap.fillRect(1, 1, 4, 4, Colors.SNOW_PARTICLE_FACE)\n        # Left Edge\n        bitmap.fillRect(0, 1, 1, 5, Colors.SNOW_PARTICLE_EDGE)\n        # Top Edge\n        bitmap.fillRect(1, 0, 5, 1, Colors.SNOW_PARTICLE_EDGE)\n        # Right Edge\n        bitmap.fillRect(5, 1, 1, 5, Colors.SNOW_PARTICLE_EDGE)\n        # Bottom Edge\n        bitmap.fillRect(1, 5, 5, 1, Colors.SNOW_PARTICLE_EDGE)\n        \n        return bitmap\n    clearSprites: ->\n        @bitmap = null\n        @shadow.visible = no\n        if @sprites[0]? and @sprites[0].visible\n            for sprite in @sprites\n                if sprite? then sprite.visible = no\n    \t\t\t    \n    update: ->\n        super\n        if @currentPower == 0 then return @clearSprites()\n        \n        if @currentPower < @power\n            @currentPower += @powerIncrement\n            @refresh()\n            if @currentPower > @power\n                @currentPower = @power\n                \n        if @currentPower > @power\n            @currentPower -= @powerIncrement\n            if @currentPower < @power\n                @currentPower = @power\n            @refresh()\n            \n        for sprite in @sprites\n            if sprite?\n                sprite.update()\n                \n                if sprite.opacity > 0\n                    sprite.opacity = Math.max(sprite.opacity - 6, 0)\n                    sprite.x -= 1\n                    sprite.y += 6\n                else\n                    sprite.opacity = 255\n                    sprite.x = Math.random() * (Graphics.width - sprite.bitmap.width)\n                    sprite.y = -35 + Math.random() * (Graphics.height - sprite.bitmap.height - 50)\n            \n        \n        \n        \nwindow.Spriteset_Weather = Spriteset_Weather","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBTcHJpdGVzZXRfV2VhdGhlciwKICAgIF9faGFzUHJvcCA9IHt9Lmhhc093blByb3BlcnR5LAogICAgX19leHRlbmRzID0gZnVuY3Rpb24oY2hpbGQsIHBhcmVudCkgeyBmb3IgKHZhciBrZXkgaW4gcGFyZW50KSB7IGlmIChfX2hhc1Byb3AuY2FsbChwYXJlbnQsIGtleSkpIGNoaWxkW2tleV0gPSBwYXJlbnRba2V5XTsgfSBmdW5jdGlvbiBjdG9yKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gY2hpbGQ7IH0gY3Rvci5wcm90b3R5cGUgPSBwYXJlbnQucHJvdG90eXBlOyBjaGlsZC5wcm90b3R5cGUgPSBuZXcgY3RvcigpOyBjaGlsZC5fX3N1cGVyX18gPSBwYXJlbnQucHJvdG90eXBlOyByZXR1cm4gY2hpbGQ7IH07CgogIFNwcml0ZXNldF9XZWF0aGVyID0gKGZ1bmN0aW9uKF9zdXBlcikgewogICAgX19leHRlbmRzKFNwcml0ZXNldF9XZWF0aGVyLCBfc3VwZXIpOwoKICAgIFNwcml0ZXNldF9XZWF0aGVyLlRZUEVfUkFJTiA9IDA7CgogICAgU3ByaXRlc2V0X1dlYXRoZXIuVFlQRV9TVE9STSA9IDE7CgogICAgU3ByaXRlc2V0X1dlYXRoZXIuVFlQRV9TTk9XID0gMjsKCiAgICBmdW5jdGlvbiBTcHJpdGVzZXRfV2VhdGhlcih2aWV3cG9ydCkgewogICAgICBTcHJpdGVzZXRfV2VhdGhlci5fX3N1cGVyX18uY29uc3RydWN0b3IuY2FsbCh0aGlzLCB2aWV3cG9ydCk7CiAgICAgIHRoaXMuc2hhZG93ID0gbmV3IFNwcml0ZSh2aWV3cG9ydCk7CiAgICAgIHRoaXMuc2hhZG93LmJpdG1hcCA9IG5ldyBCaXRtYXAoR3JhcGhpY3Mud2lkdGgsIEdyYXBoaWNzLmhlaWdodCk7CiAgICAgIHRoaXMuc2hhZG93LmJpdG1hcC5maWxsUmVjdCgwLCAwLCBHcmFwaGljcy53aWR0aCwgR3JhcGhpY3MuaGVpZ2h0LCBuZXcgQ29sb3IoMCwgMCwgMCwgMC40KSk7CiAgICAgIHRoaXMuc2hhZG93LnNyY1JlY3QgPSBuZXcgUmVjdCgwLCAwLCBHcmFwaGljcy53aWR0aCwgR3JhcGhpY3MuaGVpZ2h0KTsKICAgICAgdGhpcy5zaGFkb3cueiA9IDI1MDA7CiAgICAgIHRoaXMuc2hhZG93LnZpc2libGUgPSBmYWxzZTsKICAgICAgdGhpcy5zcHJpdGVzID0gbmV3IEFycmF5KDkwKTsKICAgICAgdGhpcy5yZWZyZXNoKCk7CiAgICAgIHRoaXMudHlwZSA9IDA7CiAgICAgIHRoaXMucG93ZXIgPSA0OwogICAgICB0aGlzLmN1cnJlbnRQb3dlciA9IDA7CiAgICAgIHRoaXMub2xkUG93ZXIgPSAwOwogICAgICB0aGlzLnBvd2VySW5jcmVtZW50ID0gMDsKICAgICAgdGhpcy5kdXJhdGlvbiA9IDA7CiAgICAgIHRoaXMuYml0bWFwID0gbnVsbDsKICAgIH0KCiAgICBTcHJpdGVzZXRfV2VhdGhlci5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgc3ByaXRlLCBfaSwgX2xlbiwgX3JlZjsKICAgICAgX3JlZiA9IHRoaXMuc3ByaXRlczsKICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBfcmVmLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7CiAgICAgICAgc3ByaXRlID0gX3JlZltfaV07CiAgICAgICAgaWYgKHNwcml0ZSAhPSBudWxsKSB7CiAgICAgICAgICBzcHJpdGUuZGlzcG9zZSgpOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gdGhpcy5zaGFkb3cuZGlzcG9zZSgpOwogICAgfTsKCiAgICBTcHJpdGVzZXRfV2VhdGhlci5wcm90b3R5cGUudmlzaWJsZSA9IGZ1bmN0aW9uKHZpc2libGUpIHsKICAgICAgdmFyIHNwcml0ZSwgX2ksIF9sZW4sIF9yZWYsIF9yZXN1bHRzOwogICAgICBfcmVmID0gdGhpcy5zcHJpdGVzOwogICAgICBfcmVzdWx0cyA9IFtdOwogICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICBzcHJpdGUgPSBfcmVmW19pXTsKICAgICAgICBpZiAoc3ByaXRlICE9IG51bGwpIHsKICAgICAgICAgIF9yZXN1bHRzLnB1c2goc3ByaXRlLnZpc2libGUgPSB2aXNpYmxlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgX3Jlc3VsdHMucHVzaCh2b2lkIDApOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gX3Jlc3VsdHM7CiAgICB9OwoKICAgIFNwcml0ZXNldF9XZWF0aGVyLnByb3RvdHlwZS5yZWZyZXNoID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBiaXRtYXAsIGNvdW50LCBpLCBzcHJpdGUsIF9pLCBfaiwgX2xlbiwgX3JlZiwgX3Jlc3VsdHM7CiAgICAgIF9yZWYgPSB0aGlzLnNwcml0ZXM7CiAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gX3JlZi5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykgewogICAgICAgIHNwcml0ZSA9IF9yZWZbX2ldOwogICAgICAgIGlmIChzcHJpdGUgIT0gbnVsbCkgewogICAgICAgICAgc3ByaXRlLnZpc2libGUgPSBmYWxzZTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKHR5cGVvZiBiaXRtYXAgPT09ICJ1bmRlZmluZWQiIHx8IGJpdG1hcCA9PT0gbnVsbCkgewogICAgICAgIGJpdG1hcCA9IHRoaXMuY3JlYXRlQml0bWFwKCk7CiAgICAgIH0KICAgICAgc3ByaXRlID0gbnVsbDsKICAgICAgY291bnQgPSBNYXRoLmZsb29yKHRoaXMuY3VycmVudFBvd2VyKSAqIDEwOwogICAgICBfcmVzdWx0cyA9IFtdOwogICAgICBmb3IgKGkgPSBfaiA9IDA7IDAgPD0gY291bnQgPyBfaiA8IGNvdW50IDogX2ogPiBjb3VudDsgaSA9IDAgPD0gY291bnQgPyArK19qIDogLS1faikgewogICAgICAgIGlmICh0aGlzLnNwcml0ZXNbaV0gPT0gbnVsbCkgewogICAgICAgICAgdGhpcy5zcHJpdGVzW2ldID0gbmV3IFNwcml0ZSh0aGlzLnZpZXdwb3J0KTsKICAgICAgICAgIHRoaXMuc3ByaXRlc1tpXS5zcmNSZWN0ID0gbmV3IFJlY3QoMCwgMCwgMSwgMSk7CiAgICAgICAgICB0aGlzLnNwcml0ZXNbaV0ueiA9IDMwMDA7CiAgICAgICAgICB0aGlzLnNwcml0ZXNbaV0ub3BhY2l0eSA9IE1hdGgucmFuZG9tKCkgKiAyNTU7CiAgICAgICAgfQogICAgICAgIHRoaXMuc3ByaXRlc1tpXS5iaXRtYXAgPSBiaXRtYXA7CiAgICAgICAgdGhpcy5zcHJpdGVzW2ldLnNyY1JlY3Quc2V0KDAsIDAsIGJpdG1hcC53aWR0aCwgYml0bWFwLmhlaWdodCk7CiAgICAgICAgX3Jlc3VsdHMucHVzaCh0aGlzLnNwcml0ZXNbaV0udmlzaWJsZSA9IHRydWUpOwogICAgICB9CiAgICAgIHJldHVybiBfcmVzdWx0czsKICAgIH07CgogICAgU3ByaXRlc2V0X1dlYXRoZXIucHJvdG90eXBlLmNyZWF0ZUJpdG1hcCA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgYml0bWFwOwogICAgICBiaXRtYXAgPSBudWxsOwogICAgICBzd2l0Y2ggKHRoaXMudHlwZSkgewogICAgICAgIGNhc2UgMDoKICAgICAgICAgIGJpdG1hcCA9IHRoaXMuY3JlYXRlUmFpbkJpdG1hcCgpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAxOgogICAgICAgICAgYml0bWFwID0gdGhpcy5jcmVhdGVTdG9ybUJpdG1hcCgpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAyOgogICAgICAgICAgYml0bWFwID0gdGhpcy5jcmVhdGVTbm93Qml0bWFwKCk7CiAgICAgIH0KICAgICAgcmV0dXJuIGJpdG1hcDsKICAgIH07CgogICAgU3ByaXRlc2V0X1dlYXRoZXIucHJvdG90eXBlLmNyZWF0ZVJhaW5CaXRtYXAgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGJpdG1hcCwgaSwgcywgX2k7CiAgICAgIHMgPSBXaW5kb3dfQmFzZS5zY2FsZTsKICAgICAgYml0bWFwID0gbmV3IEJpdG1hcCg3ICogcywgNDIgKiBzKTsKICAgICAgZm9yIChpID0gX2kgPSAwOyBfaSA8IDc7IGkgPSArK19pKSB7CiAgICAgICAgYml0bWFwLmZpbGxSZWN0KDYgKiBzIC0gaSwgaSAqICg2ICogcyksIDEsIDYgKiBzLCBDb2xvcnMuUkFJTl9QQVJUSUNMRSk7CiAgICAgIH0KICAgICAgcmV0dXJuIGJpdG1hcDsKICAgIH07CgogICAgU3ByaXRlc2V0X1dlYXRoZXIucHJvdG90eXBlLmNyZWF0ZVN0b3JtQml0bWFwID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBiaXRtYXAsIGksIHMsIF9pLCBfcmVmOwogICAgICBzID0gV2luZG93X0Jhc2Uuc2NhbGU7CiAgICAgIGJpdG1hcCA9IG5ldyBCaXRtYXAoMzIgKiBzLCA2NCAqIHMpOwogICAgICBmb3IgKGkgPSBfaSA9IDAsIF9yZWYgPSAzMiAqIHM7IDAgPD0gX3JlZiA/IF9pIDwgX3JlZiA6IF9pID4gX3JlZjsgaSA9IDAgPD0gX3JlZiA/ICsrX2kgOiAtLV9pKSB7CiAgICAgICAgYml0bWFwLmZpbGxSZWN0KDE1ICogcyAtIGksIGkgKiAyLCAxLCAyLCBDb2xvcnMuU1RPUk1fUEFSVElDTEUpOwogICAgICB9CiAgICAgIHJldHVybiBiaXRtYXA7CiAgICB9OwoKICAgIFNwcml0ZXNldF9XZWF0aGVyLnByb3RvdHlwZS5jcmVhdGVTbm93Qml0bWFwID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBiaXRtYXAsIHM7CiAgICAgIHMgPSBXaW5kb3dfQmFzZS5zY2FsZTsKICAgICAgYml0bWFwID0gbmV3IEJpdG1hcCg2LCA2KTsKICAgICAgYml0bWFwLmZpbGxSZWN0KDEsIDEsIDQsIDQsIENvbG9ycy5TTk9XX1BBUlRJQ0xFX0ZBQ0UpOwogICAgICBiaXRtYXAuZmlsbFJlY3QoMCwgMSwgMSwgNSwgQ29sb3JzLlNOT1dfUEFSVElDTEVfRURHRSk7CiAgICAgIGJpdG1hcC5maWxsUmVjdCgxLCAwLCA1LCAxLCBDb2xvcnMuU05PV19QQVJUSUNMRV9FREdFKTsKICAgICAgYml0bWFwLmZpbGxSZWN0KDUsIDEsIDEsIDUsIENvbG9ycy5TTk9XX1BBUlRJQ0xFX0VER0UpOwogICAgICBiaXRtYXAuZmlsbFJlY3QoMSwgNSwgNSwgMSwgQ29sb3JzLlNOT1dfUEFSVElDTEVfRURHRSk7CiAgICAgIHJldHVybiBiaXRtYXA7CiAgICB9OwoKICAgIFNwcml0ZXNldF9XZWF0aGVyLnByb3RvdHlwZS5jbGVhclNwcml0ZXMgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIHNwcml0ZSwgX2ksIF9sZW4sIF9yZWYsIF9yZXN1bHRzOwogICAgICB0aGlzLmJpdG1hcCA9IG51bGw7CiAgICAgIHRoaXMuc2hhZG93LnZpc2libGUgPSBmYWxzZTsKICAgICAgaWYgKCh0aGlzLnNwcml0ZXNbMF0gIT0gbnVsbCkgJiYgdGhpcy5zcHJpdGVzWzBdLnZpc2libGUpIHsKICAgICAgICBfcmVmID0gdGhpcy5zcHJpdGVzOwogICAgICAgIF9yZXN1bHRzID0gW107CiAgICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBfcmVmLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7CiAgICAgICAgICBzcHJpdGUgPSBfcmVmW19pXTsKICAgICAgICAgIGlmIChzcHJpdGUgIT0gbnVsbCkgewogICAgICAgICAgICBfcmVzdWx0cy5wdXNoKHNwcml0ZS52aXNpYmxlID0gZmFsc2UpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgX3Jlc3VsdHMucHVzaCh2b2lkIDApOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gX3Jlc3VsdHM7CiAgICAgIH0KICAgIH07CgogICAgU3ByaXRlc2V0X1dlYXRoZXIucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgc3ByaXRlLCBfaSwgX2xlbiwgX3JlZiwgX3Jlc3VsdHM7CiAgICAgIFNwcml0ZXNldF9XZWF0aGVyLl9fc3VwZXJfXy51cGRhdGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgaWYgKHRoaXMuY3VycmVudFBvd2VyID09PSAwKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuY2xlYXJTcHJpdGVzKCk7CiAgICAgIH0KICAgICAgaWYgKHRoaXMuY3VycmVudFBvd2VyIDwgdGhpcy5wb3dlcikgewogICAgICAgIHRoaXMuY3VycmVudFBvd2VyICs9IHRoaXMucG93ZXJJbmNyZW1lbnQ7CiAgICAgICAgdGhpcy5yZWZyZXNoKCk7CiAgICAgICAgaWYgKHRoaXMuY3VycmVudFBvd2VyID4gdGhpcy5wb3dlcikgewogICAgICAgICAgdGhpcy5jdXJyZW50UG93ZXIgPSB0aGlzLnBvd2VyOwogICAgICAgIH0KICAgICAgfQogICAgICBpZiAodGhpcy5jdXJyZW50UG93ZXIgPiB0aGlzLnBvd2VyKSB7CiAgICAgICAgdGhpcy5jdXJyZW50UG93ZXIgLT0gdGhpcy5wb3dlckluY3JlbWVudDsKICAgICAgICBpZiAodGhpcy5jdXJyZW50UG93ZXIgPCB0aGlzLnBvd2VyKSB7CiAgICAgICAgICB0aGlzLmN1cnJlbnRQb3dlciA9IHRoaXMucG93ZXI7CiAgICAgICAgfQogICAgICAgIHRoaXMucmVmcmVzaCgpOwogICAgICB9CiAgICAgIF9yZWYgPSB0aGlzLnNwcml0ZXM7CiAgICAgIF9yZXN1bHRzID0gW107CiAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gX3JlZi5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykgewogICAgICAgIHNwcml0ZSA9IF9yZWZbX2ldOwogICAgICAgIGlmIChzcHJpdGUgIT0gbnVsbCkgewogICAgICAgICAgc3ByaXRlLnVwZGF0ZSgpOwogICAgICAgICAgaWYgKHNwcml0ZS5vcGFjaXR5ID4gMCkgewogICAgICAgICAgICBzcHJpdGUub3BhY2l0eSA9IE1hdGgubWF4KHNwcml0ZS5vcGFjaXR5IC0gNiwgMCk7CiAgICAgICAgICAgIHNwcml0ZS54IC09IDE7CiAgICAgICAgICAgIF9yZXN1bHRzLnB1c2goc3ByaXRlLnkgKz0gNik7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBzcHJpdGUub3BhY2l0eSA9IDI1NTsKICAgICAgICAgICAgc3ByaXRlLnggPSBNYXRoLnJhbmRvbSgpICogKEdyYXBoaWNzLndpZHRoIC0gc3ByaXRlLmJpdG1hcC53aWR0aCk7CiAgICAgICAgICAgIF9yZXN1bHRzLnB1c2goc3ByaXRlLnkgPSAtMzUgKyBNYXRoLnJhbmRvbSgpICogKEdyYXBoaWNzLmhlaWdodCAtIHNwcml0ZS5iaXRtYXAuaGVpZ2h0IC0gNTApKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgX3Jlc3VsdHMucHVzaCh2b2lkIDApOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gX3Jlc3VsdHM7CiAgICB9OwoKICAgIHJldHVybiBTcHJpdGVzZXRfV2VhdGhlcjsKCiAgfSkoU3ByaXRlc2V0X0Jhc2UpOwoKICB3aW5kb3cuU3ByaXRlc2V0X1dlYXRoZXIgPSBTcHJpdGVzZXRfV2VhdGhlcjsKCn0pLmNhbGwodGhpcyk7Cg==","decoded":true},{"name":"Spriteset_Map","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogU3ByaXRlc2V0X01hcAojICAgQ3JlYXRlZCBvbjogMjAxMy0wOS0wMQojCiMgICBDb3B5cmlnaHQgKEMpIDIwMTMgQW5kcukgUmFkb21za2kuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIENsYXNzOiBTcHJpdGVzZXRfTWFwCiMKIyAgIEEgYmFzZSBjbGFzcyBmb3IgYWxsIG90aGVyIHdpbmRvdyBjbGFzc2VzLgojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKY2xhc3MgU3ByaXRlc2V0X01hcAogICAgY29uc3RydWN0b3I6IChsb2dpYykgLT4KICAgICAgICBAbG9naWMgPSBsb2dpYwogICAgICAgIEBtYXBWaWV3cG9ydCA9IG5ldyBWaWV3cG9ydCgwLCAwLCBHcmFwaGljcy53aWR0aCwgR3JhcGhpY3MuaGVpZ2h0KQogICAgICAgIEB1aVZpZXdwb3J0ID0gbmV3IFZpZXdwb3J0KDAsIDAsIEdyYXBoaWNzLndpZHRoLCBHcmFwaGljcy5oZWlnaHQpCiAgICAgICAgCiAgICAgICAgQHRpbGVzZXROYW1lID0gQGxvZ2ljLnRpbGVzZXQuZ3JhcGhpYy5uYW1lCiAgICAgICAgQHRpbGVzZXQgPSBSZXNvdXJjZU1hbmFnZXIuZ2V0Qml0bWFwKCJHcmFwaGljcy9UaWxlc2V0cy8je0Bsb2dpYy50aWxlc2V0LmdyYXBoaWMubmFtZX0iKQogICAgICAgIEBhdXRvdGlsZXMgPSBuZXcgQXJyYXkoNykKICAgICAgICBAZXZlbnRzID0gW10KICAgICAgICBAc2hhZG93cyA9IFtdCiAgICAgICAgZm9yIGkgaW4gWzAuLi5AbG9naWMuYXV0b3RpbGVzLmxlbmd0aF0KICAgICAgICAgICAgaWYgQGxvZ2ljLmF1dG90aWxlc1tpXT8gYW5kIEBsb2dpYy5hdXRvdGlsZXNbaV0ubmFtZS5sZW5ndGggPiAwCiAgICAgICAgICAgICAgICBAYXV0b3RpbGVzW2ldID0gUmVzb3VyY2VNYW5hZ2VyLmdldEJpdG1hcCgiR3JhcGhpY3MvQXV0b3RpbGVzLyN7QGxvZ2ljLmF1dG90aWxlc1tpXS5uYW1lfSIpCiAgICAgICAgICAgICAgICAKICAgICAgICBjaGFyYWN0ZXIgPSBudWxsCiAgICAgICAgZXZlbnRzID0gQGxvZ2ljLmV2ZW50cy5jb25jYXQoR2FtZU1hbmFnZXIuZ2xvYmFsRXZlbnRzKQogICAgICAgIEBldmVudHNCeUlkID0ge30KICAgICAgICAKICAgICAgICBmb3IgZXZlbnQgaW4gZXZlbnRzCiAgICAgICAgICAgIGlmIChldmVudC5tYXBJZD8gYW5kIGV2ZW50Lm1hcElkICE9IEBsb2dpYy5pZCkgdGhlbiBjb250aW51ZQogICAgICAgICAgICAKICAgICAgICAgICAgaWYgZXZlbnQgPT0gR2FtZU1hbmFnZXIucGxheWVyCiAgICAgICAgICAgICAgICBAcGxheWVyID0gQGNyZWF0ZUV2ZW50KGV2ZW50KQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBAY3JlYXRlRXZlbnQoZXZlbnQpCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgaWYgQGxvZ2ljLnBhcmFsbGF4QmFja2dyb3VuZD8KICAgICAgICAgICAgQHBhcmFsbGF4Qml0bWFwID0gUmVzb3VyY2VNYW5hZ2VyLmdldEJpdG1hcCgiR3JhcGhpY3MvI3tAbG9naWMucGFyYWxsYXhCYWNrZ3JvdW5kLm5hbWV9IikKICAgICAgICAgICAgCiAgICAgIyAgIEBwbGF5ZXIgPSBuZXcgU3ByaXRlX0NoYXJhY3RlcihAbG9naWMucGxheWVyLCBAbWFwVmlld3BvcnQpCiAgICAgICAgCiAgICBjcmVhdGVFdmVudDogKGV2ZW50KSAtPgogICAgICAgIGNoYXJhY3RlciA9IG5ldyBTcHJpdGVfQ2hhcmFjdGVyKGV2ZW50LCBAbWFwVmlld3BvcnQpCiAgICAgICAgQGV2ZW50cy5wdXNoKGNoYXJhY3RlcikKICAgICAgICBAZXZlbnRzQnlJZFtldmVudC5pZF0gPSBjaGFyYWN0ZXIKICAgICAgICAKICAgICAgICBmb3IgcGFnZSBpbiBldmVudC5wYWdlcwogICAgICAgICAgICBpZiBwYWdlLmdyYXBoaWM/IGFuZCBwYWdlLmdyYXBoaWMubmFtZT8KICAgICAgICAgICAgICAgIFJlc291cmNlTWFuYWdlci5nZXRCaXRtYXAoIkdyYXBoaWNzL0NoYXJhY3RlcnMvI3twYWdlLmdyYXBoaWMubmFtZX0iKQogICAgICAgICAgICBpZiBwYWdlLmNvbW1hbmRzPwogICAgICAgICAgICAgICAgZm9yIGNvbW1hbmQgaW4gcGFnZS5jb21tYW5kcwogICAgICAgICAgICAgICAgICAgIHN3aXRjaCBjb21tYW5kLmlkCiAgICAgICAgICAgICAgICAgICAgICAgIHdoZW4gImdzLlNob3dNZXNzYWdlIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgY29tbWFuZC5wYXJhbXMuZmFjZUdyYXBoaWM/CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVzb3VyY2VNYW5hZ2VyLmdldEJpdG1hcCgiR3JhcGhpY3MvRmFjZXMvI3tjb21tYW5kLnBhcmFtcy5mYWNlR3JhcGhpYy5uYW1lfSIpCiAgICAgICAgICAgICAgICAgICAgICAgIHdoZW4gImdzLlNob3dQaWN0dXJlIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgY29tbWFuZC5wYXJhbXMuZ3JhcGhpYz8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZXNvdXJjZU1hbmFnZXIuZ2V0Qml0bWFwKCJHcmFwaGljcy9QaWN0dXJlcy8je2NvbW1hbmQucGFyYW1zLmdyYXBoaWMubmFtZX0iKQogICAgICAgICAgICAgICAgICAgICAgICB3aGVuICJncy5DaGFuZ2VUaWxlc2V0IgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgY29tbWFuZC5wYXJhbXMuZ3JhcGhpYz8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZXNvdXJjZU1hbmFnZXIuZ2V0Qml0bWFwKCJHcmFwaGljcy9UaWxlc2V0cy8je2NvbW1hbmQucGFyYW1zLmdyYXBoaWMubmFtZX0iKQogICAgICAgICAgICAgICAgICAgICAgICB3aGVuICJncy5Nb3ZlRXZlbnQiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgbW92ZUNvbW1hbmQgaW4gY29tbWFuZC5wYXJhbXMuY29tbWFuZHMKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggbW92ZUNvbW1hbmQuaWQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hlbiA0NCAjIENoYW5nZSBHcmFwaGljCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBSZXNvdXJjZU1hbmFnZXIuZ2V0Qml0bWFwKCJHcmFwaGljcy9DaGFyYWN0ZXJzLyN7bW92ZUNvbW1hbmQucmVzb3VyY2UubmFtZX0iKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGVuIDQ3ICMgUGxheSBTb3VuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQXVkaW9NYW5hZ2VyLmxvYWRTb3VuZChtb3ZlQ29tbWFuZC5yZXNvdXJjZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIHdoZW4gImdzLlBsYXlNdXNpYyIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGNvbW1hbmQucGFyYW1zLm11c2ljPwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEF1ZGlvTWFuYWdlci5sb2FkTXVzaWMoY29tbWFuZC5wYXJhbXMubXVzaWMpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVzb3VyY2VNYW5hZ2VyLmdldEF1ZGlvQnVmZmVyKCJBdWRpby9NdXNpYy8je2NvbW1hbmQucGFyYW1zLm11c2ljLm5hbWV9IikKICAgICAgICByZXR1cm4gY2hhcmFjdGVyCiAgICBwcmVwYXJlOiAtPiAgIAogICAgICAgIGlmIEBwYXJhbGxheEJpdG1hcD8KICAgICAgICAgICAgQHBhcmFsbGF4UGxhbmUgPSBuZXcgUGxhbmUoKQogICAgICAgICAgICBAcGFyYWxsYXhQbGFuZS5iaXRtYXAgPSBAcGFyYWxsYXhCaXRtYXAKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgQHJlZnJlc2hUaWxlbWFwKCkKICAgICAgICAgICAgCiAgICAgICAgZm9yIGV2ZW50IGluIEBldmVudHMKICAgICAgICAgICAgZXZlbnQucHJlcGFyZSgpCiAgICAgICAgICAgIAogICAgICAgIEBwbGF5ZXIucHJlcGFyZSgpCiAgICByZWZyZXNoVGlsZW1hcDogLT4KICAgICAgICBpZiBAdGlsZW1hcD8KICAgICAgICAgICAgQHRpbGVtYXAuZGlzcG9zZSgpCiAgICAgICAgICAgIAogICAgICAgIEB0aWxlbWFwID0gbmV3IFRpbGVtYXAoQG1hcFZpZXdwb3J0KQogICAgICAgIEB0aWxlbWFwLnRpbGVTaXplID0gQGxvZ2ljLnRpbGVTaXplCiAgICAgICAgQHRpbGVtYXAudGlsZXNldCA9IEB0aWxlc2V0CiAgICAKICAgICAgICBmb3IgaSBpbiBbMC4uLkBhdXRvdGlsZXMubGVuZ3RoXQogICAgICAgICAgICBAdGlsZW1hcC5hdXRvdGlsZXNbaSsxXSA9IEBhdXRvdGlsZXNbaV0KICAgICAgCiAgICAgICAgQHRpbGVtYXAubWFwRGF0YSA9IEBsb2dpYy5tYXBEYXRhCiAgICAgICAgQHRpbGVtYXAud2lkdGggPSBAbG9naWMud2lkdGgKICAgICAgICBAdGlsZW1hcC5oZWlnaHQgPSBAbG9naWMuaGVpZ2h0CiAgICAgICAgQHRpbGVtYXAuZGVwdGggPSBAbG9naWMuZGVwdGgKICAgICAgICBAdGlsZW1hcC5wcmlvcml0aWVzID0gQGxvZ2ljLnRpbGVzZXQucHJpb3JpdGllcwogICAgICAgIAogICAgICAgIEB0aWxlbWFwLmV4cGFuZEF1dG90aWxlcygpCiAgICAgICAgCiAgICB1cGRhdGU6IC0+CiAgICAgICAgaWYgQGxvZ2ljLnRpbGVzZXQuZ3JhcGhpYy5uYW1lICE9IEB0aWxlc2V0TmFtZQogICAgICAgICAgICBAdGlsZXNldE5hbWUgPSBAbG9naWMudGlsZXNldC5ncmFwaGljLm5hbWUKICAgICAgICAgICAgQHRpbGVzZXQgPSBSZXNvdXJjZU1hbmFnZXIuZ2V0Qml0bWFwKCJHcmFwaGljcy9UaWxlc2V0cy8je0Bsb2dpYy50aWxlc2V0LmdyYXBoaWMubmFtZX0iKQogICAgICAgICAgICBAYXV0b3RpbGVzID0gbmV3IEFycmF5KDcpCgogICAgICAgICAgICBmb3IgaSBpbiBbMC4uLkBsb2dpYy5hdXRvdGlsZXMubGVuZ3RoXQogICAgICAgICAgICAgICAgaWYgQGxvZ2ljLmF1dG90aWxlc1tpXT8gYW5kIEBsb2dpYy5hdXRvdGlsZXNbaV0ubmFtZS5sZW5ndGggPiAwCiAgICAgICAgICAgICAgICAgICAgQGF1dG90aWxlc1tpXSA9IFJlc291cmNlTWFuYWdlci5nZXRCaXRtYXAoIkdyYXBoaWNzL0F1dG90aWxlcy8je0Bsb2dpYy5hdXRvdGlsZXNbaV0ubmFtZX0iKQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICBAcmVmcmVzaFRpbGVtYXAoKQogICAgICAgICAgICAKICAgICAgICBpZiBAbG9naWMuY2FjaGVJbmRpY2VzLmxlbmd0aCA+IDAKICAgICAgICAgICAgQHRpbGVtYXAuY2xlYXJDYWNoZShAbG9naWMuY2FjaGVJbmRpY2VzKQogICAgICAgICAgICBAbG9naWMuY2FjaGVJbmRpY2VzID0gW10KICAgICAgICAgICAgCiAgICAgICAgQG1hcFZpZXdwb3J0Lm94ID0gTWF0aC5mbG9vcihHYW1lTWFuYWdlci5zY3JlZW4ub3ggKyBHYW1lTWFuYWdlci5zY3JlZW4uc2hha2VSYW5nZSkgIysgTWF0aC5taW4oTWF0aC5tYXgoQHBsYXllci54IC0gTWF0aC5mbG9vcigoR3JhcGhpY3Mud2lkdGggLSBAcGxheWVyLnNyY1JlY3Qud2lkdGgpIC8gMiksIDApLCBAbG9naWMud2lkdGgqMzItMzItR3JhcGhpY3Mud2lkdGgpIAogICAgICAgIEBtYXBWaWV3cG9ydC5veSA9IE1hdGguZmxvb3IoR2FtZU1hbmFnZXIuc2NyZWVuLm95KSAjKyBNYXRoLm1pbihNYXRoLm1heChAcGxheWVyLnkgLSBNYXRoLmZsb29yKChHcmFwaGljcy5oZWlnaHQgLSBAcGxheWVyLnNyY1JlY3QuaGVpZ2h0KSAvIDIpLCAwKSwgQGxvZ2ljLmhlaWdodCozMi0zMi1HcmFwaGljcy5oZWlnaHQpCiAgICAgICAgQG1hcFZpZXdwb3J0LnRvbmUgPSBHYW1lTWFuYWdlci5zY3JlZW4udG9uZQogICAgICAgIAogICAgICAgICNAcGxheWVyLnVwZGF0ZSgpCiAgICAgICAgCiAgICAgICAgZm9yIGkgaW4gWzAuLi5AZXZlbnRzLmxlbmd0aF0KICAgICAgICAgICAgZXZlbnQgPSBAZXZlbnRzW2ldCiAgICAgICAgICAgIGlmIGV2ZW50PwogICAgICAgICAgICAgICAgaWYgZXZlbnQubG9naWMgPT0gQGxvZ2ljLnBsYXllcgogICAgICAgICAgICAgICAgICAgIEBwbGF5ZXIgPSBldmVudAogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZXZlbnQudXBkYXRlKCkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaWYgZXZlbnQubG9naWMuaXNGbHlpbmcgYW5kIG5vdCBAc2hhZG93c1tpXT8KICAgICAgICAgICAgICAgICAgICBAc2hhZG93c1tpXSA9IG5ldyBTcHJpdGVfU2hhZG93KGV2ZW50LmxvZ2ljLCBAbWFwVmlld3BvcnQpCiAgICAgICAgICAgICAgICBlbHNlIGlmICFldmVudC5sb2dpYy5pc0ZseWluZyBhbmQgQHNoYWRvd3NbaV0/CiAgICAgICAgICAgICAgICAgICAgQHNoYWRvd3NbaV0uZGlzcG9zZSgpCiAgICAgICAgICAgICAgICAgICAgQHNoYWRvd3NbaV0gPSBudWxsCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGlmIChub3QgZXZlbnQubG9naWMubWFwSWQ/IGFuZCBub3QgQGxvZ2ljLmV2ZW50c0J5SWRbZXZlbnQubG9naWMuaWRdPykgb3IKICAgICAgICAgICAgICAgICAgIChldmVudC5sb2dpYy5tYXBJZD8gYW5kIG5vdCBHYW1lTWFuYWdlci5nbG9iYWxFdmVudHNCeUlkW2V2ZW50LmxvZ2ljLmlkXSkKICAgICAgICAgICAgICAgICAgICBldmVudC5kaXNwb3NlKCkKICAgICAgICAgICAgICAgICAgICBAZXZlbnRzW2ldID0gbnVsbAogICAgICAgICAgICAgICAgICAgIAogICAgICAgIGZvciBldmVudCBpbiBAbG9naWMuZXZlbnRzCiAgICAgICAgICAgIGlmIG5vdCBAZXZlbnRzQnlJZFtldmVudC5pZF0/CiAgICAgICAgICAgICAgICBAY3JlYXRlRXZlbnQoZXZlbnQpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIAogICAgICAgIGZvciBzaGFkb3cgaW4gQHNoYWRvd3MKICAgICAgICAgICAgaWYgc2hhZG93PyB0aGVuIHNoYWRvdy51cGRhdGUoKQogICAgICAgICAgCgogICAgICAgIAogICAgICAgIGlmIEBwYXJhbGxheFBsYW5lPwogICAgICAgICAgICBAcGFyYWxsYXhQbGFuZS5sb29wSG9yaXpvbnRhbCA9IEBsb2dpYy5sb29wUGFyYWxsYXhIb3Jpem9udGFsCiAgICAgICAgICAgIEBwYXJhbGxheFBsYW5lLmxvb3BWZXJ0aWNhbCA9IEBsb2dpYy5sb29wUGFyYWxsYXhWZXJ0aWNhbCAgIAogICAgICAgICAgICBpZiBAbG9naWMubG9vcFBhcmFsbGF4SG9yaXpvbnRhbAogICAgICAgICAgICAgICAgQHBhcmFsbGF4UGxhbmUub3ggKz0gQGxvZ2ljLmhvcml6b250YWxQYXJhbGxheFNjcm9sbAogICAgICAgICAgICBpZiBAbG9naWMubG9vcFBhcmFsbGF4VmVydGljYWwgICAgCiAgICAgICAgICAgICAgICBAcGFyYWxsYXhQbGFuZS5veSArPSBAbG9naWMudmVydGljYWxQYXJhbGxheFNjcm9sbAogICAgICAgICAgICAgICAgCiAgICAgICAgaWYgR2FtZU1hbmFnZXIubWVzc2FnZVdpbmRvdz8gYW5kIAogICAgICAgICAgIEdhbWVNYW5hZ2VyLm1lc3NhZ2VXaW5kb3cudmlld3BvcnQgIT0gQG1hcFZpZXdwb3J0IGFuZAogICAgICAgICAgIEdhbWVNYW5hZ2VyLm1lc3NhZ2VXaW5kb3cuc2Nyb2xsV2l0aE1hcAogICAgICAgICAgICBHYW1lTWFuYWdlci5tZXNzYWdlV2luZG93LnNldFZpZXdwb3J0KEBtYXBWaWV3cG9ydCkKICAgICAgICAgICAgCiAgICAgICAgQHRpbGVtYXAudXBkYXRlKCkKICAgIGRpc3Bvc2U6IC0+CiAgICAgICAgZm9yIGV2ZW50IGluIEBldmVudHMKICAgICAgICAgICAgaWYgZXZlbnQ/CiAgICAgICAgICAgICAgICBldmVudC5kaXNwb3NlKCkKICAgICAgICAgICAgCiAgICAgICAgQHBsYXllci5kaXNwb3NlKCkKICAgICAgICBAdGlsZW1hcC5kaXNwb3NlKCkKICAgICAgICBAbWFwVmlld3BvcnQuZGlzcG9zZSgpCiAgICAgICAgQHVpVmlld3BvcnQuZGlzcG9zZSgpCiAgICAgICAgaWYgQHBhcmFsbGF4Qml0bWFwPwogICAgICAgICAgICAjQHBhcmFsbGF4Qml0bWFwLmRpc3Bvc2UoKQogICAgICAgICAgICBAcGFyYWxsYXhQbGFuZS5kaXNwb3NlKCkKICAgICAgICAKd2luZG93LlNwcml0ZXNldF9NYXAgPSBTcHJpdGVzZXRfTWFw","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBTcHJpdGVzZXRfTWFwOwoKICBTcHJpdGVzZXRfTWFwID0gKGZ1bmN0aW9uKCkgewogICAgZnVuY3Rpb24gU3ByaXRlc2V0X01hcChsb2dpYykgewogICAgICB2YXIgY2hhcmFjdGVyLCBldmVudCwgZXZlbnRzLCBpLCBfaSwgX2osIF9sZW4sIF9yZWY7CiAgICAgIHRoaXMubG9naWMgPSBsb2dpYzsKICAgICAgdGhpcy5tYXBWaWV3cG9ydCA9IG5ldyBWaWV3cG9ydCgwLCAwLCBHcmFwaGljcy53aWR0aCwgR3JhcGhpY3MuaGVpZ2h0KTsKICAgICAgdGhpcy51aVZpZXdwb3J0ID0gbmV3IFZpZXdwb3J0KDAsIDAsIEdyYXBoaWNzLndpZHRoLCBHcmFwaGljcy5oZWlnaHQpOwogICAgICB0aGlzLnRpbGVzZXROYW1lID0gdGhpcy5sb2dpYy50aWxlc2V0LmdyYXBoaWMubmFtZTsKICAgICAgdGhpcy50aWxlc2V0ID0gUmVzb3VyY2VNYW5hZ2VyLmdldEJpdG1hcCgiR3JhcGhpY3MvVGlsZXNldHMvIiArIHRoaXMubG9naWMudGlsZXNldC5ncmFwaGljLm5hbWUpOwogICAgICB0aGlzLmF1dG90aWxlcyA9IG5ldyBBcnJheSg3KTsKICAgICAgdGhpcy5ldmVudHMgPSBbXTsKICAgICAgdGhpcy5zaGFkb3dzID0gW107CiAgICAgIGZvciAoaSA9IF9pID0gMCwgX3JlZiA9IHRoaXMubG9naWMuYXV0b3RpbGVzLmxlbmd0aDsgMCA8PSBfcmVmID8gX2kgPCBfcmVmIDogX2kgPiBfcmVmOyBpID0gMCA8PSBfcmVmID8gKytfaSA6IC0tX2kpIHsKICAgICAgICBpZiAoKHRoaXMubG9naWMuYXV0b3RpbGVzW2ldICE9IG51bGwpICYmIHRoaXMubG9naWMuYXV0b3RpbGVzW2ldLm5hbWUubGVuZ3RoID4gMCkgewogICAgICAgICAgdGhpcy5hdXRvdGlsZXNbaV0gPSBSZXNvdXJjZU1hbmFnZXIuZ2V0Qml0bWFwKCJHcmFwaGljcy9BdXRvdGlsZXMvIiArIHRoaXMubG9naWMuYXV0b3RpbGVzW2ldLm5hbWUpOwogICAgICAgIH0KICAgICAgfQogICAgICBjaGFyYWN0ZXIgPSBudWxsOwogICAgICBldmVudHMgPSB0aGlzLmxvZ2ljLmV2ZW50cy5jb25jYXQoR2FtZU1hbmFnZXIuZ2xvYmFsRXZlbnRzKTsKICAgICAgdGhpcy5ldmVudHNCeUlkID0ge307CiAgICAgIGZvciAoX2ogPSAwLCBfbGVuID0gZXZlbnRzLmxlbmd0aDsgX2ogPCBfbGVuOyBfaisrKSB7CiAgICAgICAgZXZlbnQgPSBldmVudHNbX2pdOwogICAgICAgIGlmICgoZXZlbnQubWFwSWQgIT0gbnVsbCkgJiYgZXZlbnQubWFwSWQgIT09IHRoaXMubG9naWMuaWQpIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KICAgICAgICBpZiAoZXZlbnQgPT09IEdhbWVNYW5hZ2VyLnBsYXllcikgewogICAgICAgICAgdGhpcy5wbGF5ZXIgPSB0aGlzLmNyZWF0ZUV2ZW50KGV2ZW50KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5jcmVhdGVFdmVudChldmVudCk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmICh0aGlzLmxvZ2ljLnBhcmFsbGF4QmFja2dyb3VuZCAhPSBudWxsKSB7CiAgICAgICAgdGhpcy5wYXJhbGxheEJpdG1hcCA9IFJlc291cmNlTWFuYWdlci5nZXRCaXRtYXAoIkdyYXBoaWNzLyIgKyB0aGlzLmxvZ2ljLnBhcmFsbGF4QmFja2dyb3VuZC5uYW1lKTsKICAgICAgfQogICAgfQoKICAgIFNwcml0ZXNldF9NYXAucHJvdG90eXBlLmNyZWF0ZUV2ZW50ID0gZnVuY3Rpb24oZXZlbnQpIHsKICAgICAgdmFyIGNoYXJhY3RlciwgY29tbWFuZCwgbW92ZUNvbW1hbmQsIHBhZ2UsIF9pLCBfaiwgX2ssIF9sZW4sIF9sZW4xLCBfbGVuMiwgX3JlZiwgX3JlZjEsIF9yZWYyOwogICAgICBjaGFyYWN0ZXIgPSBuZXcgU3ByaXRlX0NoYXJhY3RlcihldmVudCwgdGhpcy5tYXBWaWV3cG9ydCk7CiAgICAgIHRoaXMuZXZlbnRzLnB1c2goY2hhcmFjdGVyKTsKICAgICAgdGhpcy5ldmVudHNCeUlkW2V2ZW50LmlkXSA9IGNoYXJhY3RlcjsKICAgICAgX3JlZiA9IGV2ZW50LnBhZ2VzOwogICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICBwYWdlID0gX3JlZltfaV07CiAgICAgICAgaWYgKChwYWdlLmdyYXBoaWMgIT0gbnVsbCkgJiYgKHBhZ2UuZ3JhcGhpYy5uYW1lICE9IG51bGwpKSB7CiAgICAgICAgICBSZXNvdXJjZU1hbmFnZXIuZ2V0Qml0bWFwKCJHcmFwaGljcy9DaGFyYWN0ZXJzLyIgKyBwYWdlLmdyYXBoaWMubmFtZSk7CiAgICAgICAgfQogICAgICAgIGlmIChwYWdlLmNvbW1hbmRzICE9IG51bGwpIHsKICAgICAgICAgIF9yZWYxID0gcGFnZS5jb21tYW5kczsKICAgICAgICAgIGZvciAoX2ogPSAwLCBfbGVuMSA9IF9yZWYxLmxlbmd0aDsgX2ogPCBfbGVuMTsgX2orKykgewogICAgICAgICAgICBjb21tYW5kID0gX3JlZjFbX2pdOwogICAgICAgICAgICBzd2l0Y2ggKGNvbW1hbmQuaWQpIHsKICAgICAgICAgICAgICBjYXNlICJncy5TaG93TWVzc2FnZSI6CiAgICAgICAgICAgICAgICBpZiAoY29tbWFuZC5wYXJhbXMuZmFjZUdyYXBoaWMgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgICBSZXNvdXJjZU1hbmFnZXIuZ2V0Qml0bWFwKCJHcmFwaGljcy9GYWNlcy8iICsgY29tbWFuZC5wYXJhbXMuZmFjZUdyYXBoaWMubmFtZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICBjYXNlICJncy5TaG93UGljdHVyZSI6CiAgICAgICAgICAgICAgICBpZiAoY29tbWFuZC5wYXJhbXMuZ3JhcGhpYyAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICAgIFJlc291cmNlTWFuYWdlci5nZXRCaXRtYXAoIkdyYXBoaWNzL1BpY3R1cmVzLyIgKyBjb21tYW5kLnBhcmFtcy5ncmFwaGljLm5hbWUpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgY2FzZSAiZ3MuQ2hhbmdlVGlsZXNldCI6CiAgICAgICAgICAgICAgICBpZiAoY29tbWFuZC5wYXJhbXMuZ3JhcGhpYyAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICAgIFJlc291cmNlTWFuYWdlci5nZXRCaXRtYXAoIkdyYXBoaWNzL1RpbGVzZXRzLyIgKyBjb21tYW5kLnBhcmFtcy5ncmFwaGljLm5hbWUpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgY2FzZSAiZ3MuTW92ZUV2ZW50IjoKICAgICAgICAgICAgICAgIF9yZWYyID0gY29tbWFuZC5wYXJhbXMuY29tbWFuZHM7CiAgICAgICAgICAgICAgICBmb3IgKF9rID0gMCwgX2xlbjIgPSBfcmVmMi5sZW5ndGg7IF9rIDwgX2xlbjI7IF9rKyspIHsKICAgICAgICAgICAgICAgICAgbW92ZUNvbW1hbmQgPSBfcmVmMltfa107CiAgICAgICAgICAgICAgICAgIHN3aXRjaCAobW92ZUNvbW1hbmQuaWQpIHsKICAgICAgICAgICAgICAgICAgICBjYXNlIDQ0OgogICAgICAgICAgICAgICAgICAgICAgUmVzb3VyY2VNYW5hZ2VyLmdldEJpdG1hcCgiR3JhcGhpY3MvQ2hhcmFjdGVycy8iICsgbW92ZUNvbW1hbmQucmVzb3VyY2UubmFtZSk7CiAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlIDQ3OgogICAgICAgICAgICAgICAgICAgICAgQXVkaW9NYW5hZ2VyLmxvYWRTb3VuZChtb3ZlQ29tbWFuZC5yZXNvdXJjZSk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIGNhc2UgImdzLlBsYXlNdXNpYyI6CiAgICAgICAgICAgICAgICBpZiAoY29tbWFuZC5wYXJhbXMubXVzaWMgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgICBBdWRpb01hbmFnZXIubG9hZE11c2ljKGNvbW1hbmQucGFyYW1zLm11c2ljKTsKICAgICAgICAgICAgICAgICAgUmVzb3VyY2VNYW5hZ2VyLmdldEF1ZGlvQnVmZmVyKCJBdWRpby9NdXNpYy8iICsgY29tbWFuZC5wYXJhbXMubXVzaWMubmFtZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIGNoYXJhY3RlcjsKICAgIH07CgogICAgU3ByaXRlc2V0X01hcC5wcm90b3R5cGUucHJlcGFyZSA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgZXZlbnQsIF9pLCBfbGVuLCBfcmVmOwogICAgICBpZiAodGhpcy5wYXJhbGxheEJpdG1hcCAhPSBudWxsKSB7CiAgICAgICAgdGhpcy5wYXJhbGxheFBsYW5lID0gbmV3IFBsYW5lKCk7CiAgICAgICAgdGhpcy5wYXJhbGxheFBsYW5lLmJpdG1hcCA9IHRoaXMucGFyYWxsYXhCaXRtYXA7CiAgICAgIH0KICAgICAgdGhpcy5yZWZyZXNoVGlsZW1hcCgpOwogICAgICBfcmVmID0gdGhpcy5ldmVudHM7CiAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gX3JlZi5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykgewogICAgICAgIGV2ZW50ID0gX3JlZltfaV07CiAgICAgICAgZXZlbnQucHJlcGFyZSgpOwogICAgICB9CiAgICAgIHJldHVybiB0aGlzLnBsYXllci5wcmVwYXJlKCk7CiAgICB9OwoKICAgIFNwcml0ZXNldF9NYXAucHJvdG90eXBlLnJlZnJlc2hUaWxlbWFwID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBpLCBfaSwgX3JlZjsKICAgICAgaWYgKHRoaXMudGlsZW1hcCAhPSBudWxsKSB7CiAgICAgICAgdGhpcy50aWxlbWFwLmRpc3Bvc2UoKTsKICAgICAgfQogICAgICB0aGlzLnRpbGVtYXAgPSBuZXcgVGlsZW1hcCh0aGlzLm1hcFZpZXdwb3J0KTsKICAgICAgdGhpcy50aWxlbWFwLnRpbGVTaXplID0gdGhpcy5sb2dpYy50aWxlU2l6ZTsKICAgICAgdGhpcy50aWxlbWFwLnRpbGVzZXQgPSB0aGlzLnRpbGVzZXQ7CiAgICAgIGZvciAoaSA9IF9pID0gMCwgX3JlZiA9IHRoaXMuYXV0b3RpbGVzLmxlbmd0aDsgMCA8PSBfcmVmID8gX2kgPCBfcmVmIDogX2kgPiBfcmVmOyBpID0gMCA8PSBfcmVmID8gKytfaSA6IC0tX2kpIHsKICAgICAgICB0aGlzLnRpbGVtYXAuYXV0b3RpbGVzW2kgKyAxXSA9IHRoaXMuYXV0b3RpbGVzW2ldOwogICAgICB9CiAgICAgIHRoaXMudGlsZW1hcC5tYXBEYXRhID0gdGhpcy5sb2dpYy5tYXBEYXRhOwogICAgICB0aGlzLnRpbGVtYXAud2lkdGggPSB0aGlzLmxvZ2ljLndpZHRoOwogICAgICB0aGlzLnRpbGVtYXAuaGVpZ2h0ID0gdGhpcy5sb2dpYy5oZWlnaHQ7CiAgICAgIHRoaXMudGlsZW1hcC5kZXB0aCA9IHRoaXMubG9naWMuZGVwdGg7CiAgICAgIHRoaXMudGlsZW1hcC5wcmlvcml0aWVzID0gdGhpcy5sb2dpYy50aWxlc2V0LnByaW9yaXRpZXM7CiAgICAgIHJldHVybiB0aGlzLnRpbGVtYXAuZXhwYW5kQXV0b3RpbGVzKCk7CiAgICB9OwoKICAgIFNwcml0ZXNldF9NYXAucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgZXZlbnQsIGksIHNoYWRvdywgX2ksIF9qLCBfaywgX2wsIF9sZW4sIF9sZW4xLCBfcmVmLCBfcmVmMSwgX3JlZjIsIF9yZWYzOwogICAgICBpZiAodGhpcy5sb2dpYy50aWxlc2V0LmdyYXBoaWMubmFtZSAhPT0gdGhpcy50aWxlc2V0TmFtZSkgewogICAgICAgIHRoaXMudGlsZXNldE5hbWUgPSB0aGlzLmxvZ2ljLnRpbGVzZXQuZ3JhcGhpYy5uYW1lOwogICAgICAgIHRoaXMudGlsZXNldCA9IFJlc291cmNlTWFuYWdlci5nZXRCaXRtYXAoIkdyYXBoaWNzL1RpbGVzZXRzLyIgKyB0aGlzLmxvZ2ljLnRpbGVzZXQuZ3JhcGhpYy5uYW1lKTsKICAgICAgICB0aGlzLmF1dG90aWxlcyA9IG5ldyBBcnJheSg3KTsKICAgICAgICBmb3IgKGkgPSBfaSA9IDAsIF9yZWYgPSB0aGlzLmxvZ2ljLmF1dG90aWxlcy5sZW5ndGg7IDAgPD0gX3JlZiA/IF9pIDwgX3JlZiA6IF9pID4gX3JlZjsgaSA9IDAgPD0gX3JlZiA/ICsrX2kgOiAtLV9pKSB7CiAgICAgICAgICBpZiAoKHRoaXMubG9naWMuYXV0b3RpbGVzW2ldICE9IG51bGwpICYmIHRoaXMubG9naWMuYXV0b3RpbGVzW2ldLm5hbWUubGVuZ3RoID4gMCkgewogICAgICAgICAgICB0aGlzLmF1dG90aWxlc1tpXSA9IFJlc291cmNlTWFuYWdlci5nZXRCaXRtYXAoIkdyYXBoaWNzL0F1dG90aWxlcy8iICsgdGhpcy5sb2dpYy5hdXRvdGlsZXNbaV0ubmFtZSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHRoaXMucmVmcmVzaFRpbGVtYXAoKTsKICAgICAgfQogICAgICBpZiAodGhpcy5sb2dpYy5jYWNoZUluZGljZXMubGVuZ3RoID4gMCkgewogICAgICAgIHRoaXMudGlsZW1hcC5jbGVhckNhY2hlKHRoaXMubG9naWMuY2FjaGVJbmRpY2VzKTsKICAgICAgICB0aGlzLmxvZ2ljLmNhY2hlSW5kaWNlcyA9IFtdOwogICAgICB9CiAgICAgIHRoaXMubWFwVmlld3BvcnQub3ggPSBNYXRoLmZsb29yKEdhbWVNYW5hZ2VyLnNjcmVlbi5veCArIEdhbWVNYW5hZ2VyLnNjcmVlbi5zaGFrZVJhbmdlKTsKICAgICAgdGhpcy5tYXBWaWV3cG9ydC5veSA9IE1hdGguZmxvb3IoR2FtZU1hbmFnZXIuc2NyZWVuLm95KTsKICAgICAgdGhpcy5tYXBWaWV3cG9ydC50b25lID0gR2FtZU1hbmFnZXIuc2NyZWVuLnRvbmU7CiAgICAgIGZvciAoaSA9IF9qID0gMCwgX3JlZjEgPSB0aGlzLmV2ZW50cy5sZW5ndGg7IDAgPD0gX3JlZjEgPyBfaiA8IF9yZWYxIDogX2ogPiBfcmVmMTsgaSA9IDAgPD0gX3JlZjEgPyArK19qIDogLS1faikgewogICAgICAgIGV2ZW50ID0gdGhpcy5ldmVudHNbaV07CiAgICAgICAgaWYgKGV2ZW50ICE9IG51bGwpIHsKICAgICAgICAgIGlmIChldmVudC5sb2dpYyA9PT0gdGhpcy5sb2dpYy5wbGF5ZXIpIHsKICAgICAgICAgICAgdGhpcy5wbGF5ZXIgPSBldmVudDsKICAgICAgICAgIH0KICAgICAgICAgIGV2ZW50LnVwZGF0ZSgpOwogICAgICAgICAgaWYgKGV2ZW50LmxvZ2ljLmlzRmx5aW5nICYmICh0aGlzLnNoYWRvd3NbaV0gPT0gbnVsbCkpIHsKICAgICAgICAgICAgdGhpcy5zaGFkb3dzW2ldID0gbmV3IFNwcml0ZV9TaGFkb3coZXZlbnQubG9naWMsIHRoaXMubWFwVmlld3BvcnQpOwogICAgICAgICAgfSBlbHNlIGlmICghZXZlbnQubG9naWMuaXNGbHlpbmcgJiYgKHRoaXMuc2hhZG93c1tpXSAhPSBudWxsKSkgewogICAgICAgICAgICB0aGlzLnNoYWRvd3NbaV0uZGlzcG9zZSgpOwogICAgICAgICAgICB0aGlzLnNoYWRvd3NbaV0gPSBudWxsOwogICAgICAgICAgfQogICAgICAgICAgaWYgKCgoZXZlbnQubG9naWMubWFwSWQgPT0gbnVsbCkgJiYgKHRoaXMubG9naWMuZXZlbnRzQnlJZFtldmVudC5sb2dpYy5pZF0gPT0gbnVsbCkpIHx8ICgoZXZlbnQubG9naWMubWFwSWQgIT0gbnVsbCkgJiYgIUdhbWVNYW5hZ2VyLmdsb2JhbEV2ZW50c0J5SWRbZXZlbnQubG9naWMuaWRdKSkgewogICAgICAgICAgICBldmVudC5kaXNwb3NlKCk7CiAgICAgICAgICAgIHRoaXMuZXZlbnRzW2ldID0gbnVsbDsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgX3JlZjIgPSB0aGlzLmxvZ2ljLmV2ZW50czsKICAgICAgZm9yIChfayA9IDAsIF9sZW4gPSBfcmVmMi5sZW5ndGg7IF9rIDwgX2xlbjsgX2srKykgewogICAgICAgIGV2ZW50ID0gX3JlZjJbX2tdOwogICAgICAgIGlmICh0aGlzLmV2ZW50c0J5SWRbZXZlbnQuaWRdID09IG51bGwpIHsKICAgICAgICAgIHRoaXMuY3JlYXRlRXZlbnQoZXZlbnQpOwogICAgICAgIH0KICAgICAgfQogICAgICBfcmVmMyA9IHRoaXMuc2hhZG93czsKICAgICAgZm9yIChfbCA9IDAsIF9sZW4xID0gX3JlZjMubGVuZ3RoOyBfbCA8IF9sZW4xOyBfbCsrKSB7CiAgICAgICAgc2hhZG93ID0gX3JlZjNbX2xdOwogICAgICAgIGlmIChzaGFkb3cgIT0gbnVsbCkgewogICAgICAgICAgc2hhZG93LnVwZGF0ZSgpOwogICAgICAgIH0KICAgICAgfQogICAgICBpZiAodGhpcy5wYXJhbGxheFBsYW5lICE9IG51bGwpIHsKICAgICAgICB0aGlzLnBhcmFsbGF4UGxhbmUubG9vcEhvcml6b250YWwgPSB0aGlzLmxvZ2ljLmxvb3BQYXJhbGxheEhvcml6b250YWw7CiAgICAgICAgdGhpcy5wYXJhbGxheFBsYW5lLmxvb3BWZXJ0aWNhbCA9IHRoaXMubG9naWMubG9vcFBhcmFsbGF4VmVydGljYWw7CiAgICAgICAgaWYgKHRoaXMubG9naWMubG9vcFBhcmFsbGF4SG9yaXpvbnRhbCkgewogICAgICAgICAgdGhpcy5wYXJhbGxheFBsYW5lLm94ICs9IHRoaXMubG9naWMuaG9yaXpvbnRhbFBhcmFsbGF4U2Nyb2xsOwogICAgICAgIH0KICAgICAgICBpZiAodGhpcy5sb2dpYy5sb29wUGFyYWxsYXhWZXJ0aWNhbCkgewogICAgICAgICAgdGhpcy5wYXJhbGxheFBsYW5lLm95ICs9IHRoaXMubG9naWMudmVydGljYWxQYXJhbGxheFNjcm9sbDsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKChHYW1lTWFuYWdlci5tZXNzYWdlV2luZG93ICE9IG51bGwpICYmIEdhbWVNYW5hZ2VyLm1lc3NhZ2VXaW5kb3cudmlld3BvcnQgIT09IHRoaXMubWFwVmlld3BvcnQgJiYgR2FtZU1hbmFnZXIubWVzc2FnZVdpbmRvdy5zY3JvbGxXaXRoTWFwKSB7CiAgICAgICAgR2FtZU1hbmFnZXIubWVzc2FnZVdpbmRvdy5zZXRWaWV3cG9ydCh0aGlzLm1hcFZpZXdwb3J0KTsKICAgICAgfQogICAgICByZXR1cm4gdGhpcy50aWxlbWFwLnVwZGF0ZSgpOwogICAgfTsKCiAgICBTcHJpdGVzZXRfTWFwLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBldmVudCwgX2ksIF9sZW4sIF9yZWY7CiAgICAgIF9yZWYgPSB0aGlzLmV2ZW50czsKICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBfcmVmLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7CiAgICAgICAgZXZlbnQgPSBfcmVmW19pXTsKICAgICAgICBpZiAoZXZlbnQgIT0gbnVsbCkgewogICAgICAgICAgZXZlbnQuZGlzcG9zZSgpOwogICAgICAgIH0KICAgICAgfQogICAgICB0aGlzLnBsYXllci5kaXNwb3NlKCk7CiAgICAgIHRoaXMudGlsZW1hcC5kaXNwb3NlKCk7CiAgICAgIHRoaXMubWFwVmlld3BvcnQuZGlzcG9zZSgpOwogICAgICB0aGlzLnVpVmlld3BvcnQuZGlzcG9zZSgpOwogICAgICBpZiAodGhpcy5wYXJhbGxheEJpdG1hcCAhPSBudWxsKSB7CiAgICAgICAgcmV0dXJuIHRoaXMucGFyYWxsYXhQbGFuZS5kaXNwb3NlKCk7CiAgICAgIH0KICAgIH07CgogICAgcmV0dXJuIFNwcml0ZXNldF9NYXA7CgogIH0pKCk7CgogIHdpbmRvdy5TcHJpdGVzZXRfTWFwID0gU3ByaXRlc2V0X01hcDsKCn0pLmNhbGwodGhpcyk7Cg=="},{"name":"Spriteset_BattleMessage","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogU3ByaXRlc2V0X0JhdHRsZU1lc3NhZ2UKIyAgIENyZWF0ZWQgb246IDIwMTMtMTAtMTkKIwojICAgQ29weXJpZ2h0IChDKSAyMDEzIEFuZHLpIFJhZG9tc2tpLiBBbGwgcmlnaHRzIHJlc2VydmVkLgojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQojCiMgICBDbGFzczogU3ByaXRlc2V0X0JhdHRsZU1lc3NhZ2UKIwojICAgQSBiYXNlIGNsYXNzIGZvciBhbGwgb3RoZXIgd2luZG93IGNsYXNzZXMuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpjbGFzcyBTcHJpdGVzZXRfQmF0dGxlTWVzc2FnZSBleHRlbmRzIFNwcml0ZXNldF9CYXNlCiAgICBjb25zdHJ1Y3RvcjogKGxvZ2ljLCB2aWV3cG9ydCkgLT4KICAgICAgICBzdXBlcih2aWV3cG9ydCkKICAgICAgICBzID0gV2luZG93X0Jhc2Uuc2NhbGUKICAgICAgICBAbG9naWMgPSBsb2dpYwogICAgICAgIEBzcHJpdGVzID0gW25ldyBTcHJpdGVfVGV4dChHcmFwaGljcy53aWR0aCwgMzIqcywgdmlld3BvcnQpLAogICAgICAgICAgICAgICAgICAgIG5ldyBTcHJpdGVfVGV4dChHcmFwaGljcy53aWR0aCwgMzIqcywgdmlld3BvcnQpLAogICAgICAgICAgICAgICAgICAgIG5ldyBTcHJpdGVfVGV4dChHcmFwaGljcy53aWR0aCwgMzIqcywgdmlld3BvcnQpLAogICAgICAgICAgICAgICAgICAgIG5ldyBTcHJpdGVfVGV4dChHcmFwaGljcy53aWR0aCwgMzIqcywgdmlld3BvcnQpLAogICAgICAgICAgICAgICAgICAgIG5ldyBTcHJpdGVfVGV4dChHcmFwaGljcy53aWR0aCwgMzIqcywgdmlld3BvcnQpLAogICAgICAgICAgICAgICAgICAgIG5ldyBTcHJpdGVfVGV4dChHcmFwaGljcy53aWR0aCwgMzIqcywgdmlld3BvcnQpLAogICAgICAgICAgICAgICAgICAgIG5ldyBTcHJpdGVfVGV4dChHcmFwaGljcy53aWR0aCwgMzIqcywgdmlld3BvcnQpLAogICAgICAgICAgICAgICAgICAgIG5ldyBTcHJpdGVfVGV4dChHcmFwaGljcy53aWR0aCwgMzIqcywgdmlld3BvcnQpXQogICAgICAgIGZvciBpIGluIFswLi4uQHNwcml0ZXMubGVuZ3RoXQogICAgICAgICAgICBAc3ByaXRlc1tpXS54ID0gMAogICAgICAgICAgICBAc3ByaXRlc1tpXS55ID0gaSAqICgzMipzKQogICAgICAgICAgICBAc3ByaXRlc1tpXS56ID0gMTAwMAogICAgZGlzcG9zZTogLT4KICAgICAgICBzcHJpdGUuZGlzcG9zZSgpIGZvciBzcHJpdGUgaW4gQHNwcml0ZXMKICAgICAgICAKICAgIHJlZnJlc2g6IC0+CiAgICAgICAgaWYgQGxvZ2ljLm1lc3NhZ2VzW0Bsb2dpYy5jdXJyZW50UGFnZV0/CiAgICAgICAgICAgIGZvciBpIGluIFswLi4uQGxvZ2ljLm1lc3NhZ2VzW0Bsb2dpYy5jdXJyZW50UGFnZV0ubGVuZ3RoXQogICAgICAgICAgICAgICAgQHNwcml0ZXNbaV0udmlzaWJsZSA9IHllcwogICAgICAgICAgICAgICAgQHNwcml0ZXNbaV0udGV4dCA9IEBsb2dpYy5tZXNzYWdlc1tAbG9naWMuY3VycmVudFBhZ2VdW2ldLnRleHQKICAgICAgICAgICAgICAgIEBzcHJpdGVzW2ldLnJlZnJlc2goKQogICAgICAgICAgICAKICAgIHVwZGF0ZTogLT4KICAgICAgICBtZXNzYWdlcyA9IEBsb2dpYy5tZXNzYWdlcwogICAgICAgIGN1cnJlbnRQYWdlID0gQGxvZ2ljLmN1cnJlbnRQYWdlCiAgICAgICAgCiAgICAgICAgZm9yIHNwcml0ZSBpbiBAc3ByaXRlcwogICAgICAgICAgICBzcHJpdGUudmlzaWJsZSA9IG5vIAogICAgICAgICAgICAKICAgICAgICBpZiBtZXNzYWdlcy5sZW5ndGggPiAwIGFuZCBtZXNzYWdlc1tjdXJyZW50UGFnZV0/IGFuZCBtZXNzYWdlc1tjdXJyZW50UGFnZV0ubGVuZ3RoID4gMAogICAgICAgICAgICBmb3IgaSBpbiBbMC4uLm1lc3NhZ2VzW2N1cnJlbnRQYWdlXS5sZW5ndGhdCiAgICAgICAgICAgICAgICBAc3ByaXRlc1tpXS52aXNpYmxlID0geWVzCiAgICAgICAgICAgICAgICAKICAgICAgICBpZiBAbG9naWMucmVmcmVzaE5lZWRlZAogICAgICAgICAgICBAcmVmcmVzaCgpCiAgICAgICAgICAgIEBsb2dpYy5yZWZyZXNoTmVlZGVkID0gbm8KICAgICAgICAgICAgICAgIAogICAgICAgIHN1cGVyCiAgICAgICAgICAgIAp3aW5kb3cuU3ByaXRlc2V0X0JhdHRsZU1lc3NhZ2UgPSBTcHJpdGVzZXRfQmF0dGxlTWVzc2FnZQ==","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBTcHJpdGVzZXRfQmF0dGxlTWVzc2FnZSwKICAgIF9faGFzUHJvcCA9IHt9Lmhhc093blByb3BlcnR5LAogICAgX19leHRlbmRzID0gZnVuY3Rpb24oY2hpbGQsIHBhcmVudCkgeyBmb3IgKHZhciBrZXkgaW4gcGFyZW50KSB7IGlmIChfX2hhc1Byb3AuY2FsbChwYXJlbnQsIGtleSkpIGNoaWxkW2tleV0gPSBwYXJlbnRba2V5XTsgfSBmdW5jdGlvbiBjdG9yKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gY2hpbGQ7IH0gY3Rvci5wcm90b3R5cGUgPSBwYXJlbnQucHJvdG90eXBlOyBjaGlsZC5wcm90b3R5cGUgPSBuZXcgY3RvcigpOyBjaGlsZC5fX3N1cGVyX18gPSBwYXJlbnQucHJvdG90eXBlOyByZXR1cm4gY2hpbGQ7IH07CgogIFNwcml0ZXNldF9CYXR0bGVNZXNzYWdlID0gKGZ1bmN0aW9uKF9zdXBlcikgewogICAgX19leHRlbmRzKFNwcml0ZXNldF9CYXR0bGVNZXNzYWdlLCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFNwcml0ZXNldF9CYXR0bGVNZXNzYWdlKGxvZ2ljLCB2aWV3cG9ydCkgewogICAgICB2YXIgaSwgcywgX2ksIF9yZWY7CiAgICAgIFNwcml0ZXNldF9CYXR0bGVNZXNzYWdlLl9fc3VwZXJfXy5jb25zdHJ1Y3Rvci5jYWxsKHRoaXMsIHZpZXdwb3J0KTsKICAgICAgcyA9IFdpbmRvd19CYXNlLnNjYWxlOwogICAgICB0aGlzLmxvZ2ljID0gbG9naWM7CiAgICAgIHRoaXMuc3ByaXRlcyA9IFtuZXcgU3ByaXRlX1RleHQoR3JhcGhpY3Mud2lkdGgsIDMyICogcywgdmlld3BvcnQpLCBuZXcgU3ByaXRlX1RleHQoR3JhcGhpY3Mud2lkdGgsIDMyICogcywgdmlld3BvcnQpLCBuZXcgU3ByaXRlX1RleHQoR3JhcGhpY3Mud2lkdGgsIDMyICogcywgdmlld3BvcnQpLCBuZXcgU3ByaXRlX1RleHQoR3JhcGhpY3Mud2lkdGgsIDMyICogcywgdmlld3BvcnQpLCBuZXcgU3ByaXRlX1RleHQoR3JhcGhpY3Mud2lkdGgsIDMyICogcywgdmlld3BvcnQpLCBuZXcgU3ByaXRlX1RleHQoR3JhcGhpY3Mud2lkdGgsIDMyICogcywgdmlld3BvcnQpLCBuZXcgU3ByaXRlX1RleHQoR3JhcGhpY3Mud2lkdGgsIDMyICogcywgdmlld3BvcnQpLCBuZXcgU3ByaXRlX1RleHQoR3JhcGhpY3Mud2lkdGgsIDMyICogcywgdmlld3BvcnQpXTsKICAgICAgZm9yIChpID0gX2kgPSAwLCBfcmVmID0gdGhpcy5zcHJpdGVzLmxlbmd0aDsgMCA8PSBfcmVmID8gX2kgPCBfcmVmIDogX2kgPiBfcmVmOyBpID0gMCA8PSBfcmVmID8gKytfaSA6IC0tX2kpIHsKICAgICAgICB0aGlzLnNwcml0ZXNbaV0ueCA9IDA7CiAgICAgICAgdGhpcy5zcHJpdGVzW2ldLnkgPSBpICogKDMyICogcyk7CiAgICAgICAgdGhpcy5zcHJpdGVzW2ldLnogPSAxMDAwOwogICAgICB9CiAgICB9CgogICAgU3ByaXRlc2V0X0JhdHRsZU1lc3NhZ2UucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIHNwcml0ZSwgX2ksIF9sZW4sIF9yZWYsIF9yZXN1bHRzOwogICAgICBfcmVmID0gdGhpcy5zcHJpdGVzOwogICAgICBfcmVzdWx0cyA9IFtdOwogICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICBzcHJpdGUgPSBfcmVmW19pXTsKICAgICAgICBfcmVzdWx0cy5wdXNoKHNwcml0ZS5kaXNwb3NlKCkpOwogICAgICB9CiAgICAgIHJldHVybiBfcmVzdWx0czsKICAgIH07CgogICAgU3ByaXRlc2V0X0JhdHRsZU1lc3NhZ2UucHJvdG90eXBlLnJlZnJlc2ggPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGksIF9pLCBfcmVmLCBfcmVzdWx0czsKICAgICAgaWYgKHRoaXMubG9naWMubWVzc2FnZXNbdGhpcy5sb2dpYy5jdXJyZW50UGFnZV0gIT0gbnVsbCkgewogICAgICAgIF9yZXN1bHRzID0gW107CiAgICAgICAgZm9yIChpID0gX2kgPSAwLCBfcmVmID0gdGhpcy5sb2dpYy5tZXNzYWdlc1t0aGlzLmxvZ2ljLmN1cnJlbnRQYWdlXS5sZW5ndGg7IDAgPD0gX3JlZiA/IF9pIDwgX3JlZiA6IF9pID4gX3JlZjsgaSA9IDAgPD0gX3JlZiA/ICsrX2kgOiAtLV9pKSB7CiAgICAgICAgICB0aGlzLnNwcml0ZXNbaV0udmlzaWJsZSA9IHRydWU7CiAgICAgICAgICB0aGlzLnNwcml0ZXNbaV0udGV4dCA9IHRoaXMubG9naWMubWVzc2FnZXNbdGhpcy5sb2dpYy5jdXJyZW50UGFnZV1baV0udGV4dDsKICAgICAgICAgIF9yZXN1bHRzLnB1c2godGhpcy5zcHJpdGVzW2ldLnJlZnJlc2goKSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBfcmVzdWx0czsKICAgICAgfQogICAgfTsKCiAgICBTcHJpdGVzZXRfQmF0dGxlTWVzc2FnZS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBjdXJyZW50UGFnZSwgaSwgbWVzc2FnZXMsIHNwcml0ZSwgX2ksIF9qLCBfbGVuLCBfcmVmLCBfcmVmMTsKICAgICAgbWVzc2FnZXMgPSB0aGlzLmxvZ2ljLm1lc3NhZ2VzOwogICAgICBjdXJyZW50UGFnZSA9IHRoaXMubG9naWMuY3VycmVudFBhZ2U7CiAgICAgIF9yZWYgPSB0aGlzLnNwcml0ZXM7CiAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gX3JlZi5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykgewogICAgICAgIHNwcml0ZSA9IF9yZWZbX2ldOwogICAgICAgIHNwcml0ZS52aXNpYmxlID0gZmFsc2U7CiAgICAgIH0KICAgICAgaWYgKG1lc3NhZ2VzLmxlbmd0aCA+IDAgJiYgKG1lc3NhZ2VzW2N1cnJlbnRQYWdlXSAhPSBudWxsKSAmJiBtZXNzYWdlc1tjdXJyZW50UGFnZV0ubGVuZ3RoID4gMCkgewogICAgICAgIGZvciAoaSA9IF9qID0gMCwgX3JlZjEgPSBtZXNzYWdlc1tjdXJyZW50UGFnZV0ubGVuZ3RoOyAwIDw9IF9yZWYxID8gX2ogPCBfcmVmMSA6IF9qID4gX3JlZjE7IGkgPSAwIDw9IF9yZWYxID8gKytfaiA6IC0tX2opIHsKICAgICAgICAgIHRoaXMuc3ByaXRlc1tpXS52aXNpYmxlID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKHRoaXMubG9naWMucmVmcmVzaE5lZWRlZCkgewogICAgICAgIHRoaXMucmVmcmVzaCgpOwogICAgICAgIHRoaXMubG9naWMucmVmcmVzaE5lZWRlZCA9IGZhbHNlOwogICAgICB9CiAgICAgIHJldHVybiBTcHJpdGVzZXRfQmF0dGxlTWVzc2FnZS5fX3N1cGVyX18udXBkYXRlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICB9OwoKICAgIHJldHVybiBTcHJpdGVzZXRfQmF0dGxlTWVzc2FnZTsKCiAgfSkoU3ByaXRlc2V0X0Jhc2UpOwoKICB3aW5kb3cuU3ByaXRlc2V0X0JhdHRsZU1lc3NhZ2UgPSBTcHJpdGVzZXRfQmF0dGxlTWVzc2FnZTsKCn0pLmNhbGwodGhpcyk7Cg=="},{"name":"Spriteset_Battle","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogU3ByaXRlc2V0X0JhdHRsZQojICAgQ3JlYXRlZCBvbjogMjAxMy0xMC0xOQojCiMgICBDb3B5cmlnaHQgKEMpIDIwMTMgQW5kcukgUmFkb21za2kuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIENsYXNzOiBTcHJpdGVzZXRfQmF0dGxlCiMKIyAgIEEgYmFzZSBjbGFzcyBmb3IgYWxsIG90aGVyIHdpbmRvdyBjbGFzc2VzLgojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKY2xhc3MgU3ByaXRlc2V0X0JhdHRsZSBleHRlbmRzIFNwcml0ZXNldF9CYXNlCiAgICBjb25zdHJ1Y3RvcjogKHZpZXdwb3J0KSAtPgoKICAgIHVwZGF0ZTogLT4KICAgICAgICBzdXBlcgogICAgIAogICAgICAgIAp3aW5kb3cuU3ByaXRlc2V0X0JhdHRsZSA9IFNwcml0ZXNldF9CYXR0bGU=","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBTcHJpdGVzZXRfQmF0dGxlLAogICAgX19oYXNQcm9wID0ge30uaGFzT3duUHJvcGVydHksCiAgICBfX2V4dGVuZHMgPSBmdW5jdGlvbihjaGlsZCwgcGFyZW50KSB7IGZvciAodmFyIGtleSBpbiBwYXJlbnQpIHsgaWYgKF9faGFzUHJvcC5jYWxsKHBhcmVudCwga2V5KSkgY2hpbGRba2V5XSA9IHBhcmVudFtrZXldOyB9IGZ1bmN0aW9uIGN0b3IoKSB7IHRoaXMuY29uc3RydWN0b3IgPSBjaGlsZDsgfSBjdG9yLnByb3RvdHlwZSA9IHBhcmVudC5wcm90b3R5cGU7IGNoaWxkLnByb3RvdHlwZSA9IG5ldyBjdG9yKCk7IGNoaWxkLl9fc3VwZXJfXyA9IHBhcmVudC5wcm90b3R5cGU7IHJldHVybiBjaGlsZDsgfTsKCiAgU3ByaXRlc2V0X0JhdHRsZSA9IChmdW5jdGlvbihfc3VwZXIpIHsKICAgIF9fZXh0ZW5kcyhTcHJpdGVzZXRfQmF0dGxlLCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFNwcml0ZXNldF9CYXR0bGUodmlld3BvcnQpIHt9CgogICAgU3ByaXRlc2V0X0JhdHRsZS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiBTcHJpdGVzZXRfQmF0dGxlLl9fc3VwZXJfXy51cGRhdGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH07CgogICAgcmV0dXJuIFNwcml0ZXNldF9CYXR0bGU7CgogIH0pKFNwcml0ZXNldF9CYXNlKTsKCiAgd2luZG93LlNwcml0ZXNldF9CYXR0bGUgPSBTcHJpdGVzZXRfQmF0dGxlOwoKfSkuY2FsbCh0aGlzKTsK"},{"name":"Window_Base","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogV2luZG93X0Jhc2UKIyAgIENyZWF0ZWQgb246IDIwMTMtMDktMDEKIwojICAgQ29weXJpZ2h0IChDKSAyMDEzIEFuZHLpIFJhZG9tc2tpLiBBbGwgcmlnaHRzIHJlc2VydmVkLgojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQojCiMgCUNsYXNzOiBXaW5kb3dfQmFzZQojCiMgICBBIGJhc2UgY2xhc3MgZm9yIGFsbCBvdGhlciB3aW5kb3cgY2xhc3Nlcy4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCmNsYXNzIFdpbmRvd19CYXNlIGV4dGVuZHMgV2luZG93CiAgICAjIE92ZXJyaWRlIHRoZSBzb3VyY2UgcmVjdHMgZm9yIDMyMHgyNDAgd2hpY2ggYXJlIHVzZWQgdG8gYnVpbGQgYSB3aW5kb3cgZnJvbSB3aW5kb3dza2luCiAgICBpZiAkUEFSQU1TLnJlc29sdXRpb24ud2lkdGggPT0gMzIwCiAgICAgICAgQGJhY2tSZWN0ID0gbmV3IFJlY3QoMCwgMCwgMzIsIDMyKQogICAgICAgIEBiYWNrUmVjdDIgPSBuZXcgUmVjdCgwLCAzMiwgMzIsIDMyKQogICAgICAgIEBmcmFtZVJlY3QgPSBuZXcgUmVjdCgzMiwgMCwgMzIsIDMyKQogICAgICAgIEBmcmFtZVRoaWNrbmVzcyA9IDgKICAgICAgICBAZnJhbWVQYWRkaW5nID0gMgogICAgICAgIEBsZWZ0QXJyb3dSZWN0ID0gbmV3IFJlY3QoQGZyYW1lUmVjdC54ICsgQGZyYW1lVGhpY2tuZXNzLCBAZnJhbWVSZWN0LnkgKyAxMiwgOCwgOCkKICAgICAgICBAdG9wQXJyb3dSZWN0ID0gbmV3IFJlY3QoQGZyYW1lUmVjdC54ICsgMTIsIEBmcmFtZVJlY3QueSArIEBmcmFtZVRoaWNrbmVzcywgOCwgOCkKICAgICAgICBAcmlnaHRBcnJvd1JlY3QgPSBuZXcgUmVjdCg0MCArIEBmcmFtZVJlY3QueCwgQGZyYW1lUmVjdC55ICsgMTIsIDgsIDgpCiAgICAgICAgQGJvdHRvbUFycm93UmVjdCA9IG5ldyBSZWN0KEBmcmFtZVJlY3QueCArIDEyLCAyMCArIEBmcmFtZVJlY3QueSwgOCwgOCkKICAgICAgICBAY29ybmVyU2l6ZSA9IDgKICAgICAgICBAY3Vyc29yUmVjdCA9IG5ldyBSZWN0KDMyLCAzMiwgMTYsIDE2KQogICAgICAgIEBjdXJzb3JCb3JkZXIgPSAyCiAgICAgICAgQHBhdXNlUmVjdCA9IG5ldyBSZWN0KDQ4LCAzMiwgMTYsIDE2KQogICAgICAgIEBwYXVzZUljb25TaXplID0gbmV3IFJlY3QoMCwwLCA4LCA4KQogICAgICAgIEBzY2FsZSA9IDAuNQoKICAKICAgIGNvbnN0cnVjdG9yOiAoeCwgeSwgd2lkdGgsIGhlaWdodCwgdmlld3BvcnQpIC0+CiAgICAgICAgc3VwZXIodmlld3BvcnQpCiAgICAgICAgQHdpbmRvd1NraW4gPSBHYW1lTWFuYWdlci53aW5kb3dTa2luIAogICAgICAgIEB4ID0geAogICAgICAgIEB5ID0geQogICAgICAgIEB3aWR0aCA9IHdpZHRoCiAgICAgICAgQGhlaWdodCA9IGhlaWdodAogICAgICAgIEBwYXVzZSA9IGZhbHNlCiAgICAgICAgQG94ID0gMAogICAgICAgIEBveSA9IDAKICAgICAgICBAYmFja09wYWNpdHkgPSAxNjAKICAgICAgICBAb3BhY2l0eSA9IDI1NQogICAgICAgIEBjb250ZW50c09wYWNpdHkgPSAyNTUKICAgICAgICBAb3Blbm5lc3MgPSAyNTUKICAgICAgICBAdG9uZSA9IEdhbWVNYW5hZ2VyLndpbmRvd1NraW5Ub25lCiAgICAgICAgQGN1cnNvclJlY3QgPSBuZXcgUmVjdCgwLCAwLCAwLCAwKQogICAgICAgIEBpc09wZW5pbmcgPSBubwogICAgICAgIEBpc0Nsb3NpbmcgPSBubwogICAgICAgICAgICAgCiAgICAgICAgQG5hbWVGb250ID0gRm9udHMuTkFNRQogICAgICAgIEBhY3Rpb25Gb250ID0gRm9udHMuQUNUSU9OICAgICAgIAogICAgICAgIEBnYXVnZUZvbnQgPSBAYWN0aW9uRm9udAogICAgICAgIEBtZW1iZXJOYW1lRm9udCA9IEBuYW1lRm9udAoKICAgIG9wZW46IC0+CiAgICAgICAgQGlzT3BlbmluZyA9IHllcwogICAgICAgIEB2aXNpYmxlID0geWVzCiAgICAgICAgCiAgICBvcGVuTW9kYWw6IC0+CiAgICAgICAgQHogPSAzMDAwCiAgICAgICAgR2FtZU1hbmFnZXIubW9kYWxTcHJpdGUudmlzaWJsZSA9IHllcwogICAgICAgIEBvcGVuKCkKICAgICAgICAKICAgIGNsb3NlOiAtPgogICAgICAgIEBpc0Nsb3NpbmcgPSB5ZXMKICAgICAgICBHYW1lTWFuYWdlci5tb2RhbFNwcml0ZS52aXNpYmxlID0gbm8KICAgICAgICAKICAgIHVwZGF0ZU9wZW5pbmc6IC0+CiAgICAgICAgaWYgQG9wZW5uZXNzIDwgMjU1CiAgICAgICAgICAgIEBvcGVubmVzcyA9IE1hdGgubWluKEBvcGVubmVzcyArIDMyLCAyNTUpCiAgICAgICAgCiAgICAgICAgICAgIAogICAgICAgIEBpc09wZW5pbmcgPSBAb3Blbm5lc3MgPCAyNTUKICAgICAgICBAYWN0aXZlID0gQG9wZW5uZXNzID4gMAogICAgICAgICAgICAKICAgIHVwZGF0ZUNsb3Npbmc6IC0+CiAgICAgICAgaWYgQG9wZW5uZXNzID4gMAogICAgICAgICAgICBAb3Blbm5lc3MgPSBNYXRoLm1heChAb3Blbm5lc3MgLSAzMiwgMCkKICAgICAKICAgICAgICAgICAgCiAgICAgICAgICAgIAogICAgICAgIEBpc0Nsb3NpbmcgPSBAb3Blbm5lc3MgPiAwCiAgICAgICAgQGFjdGl2ZSA9IEBvcGVubmVzcyA+IDAgCiAgICAgICAgQHZpc2libGUgPSBAb3BlbmVzcyA+IDAKICAgICAgICAgICAgCiAgICB1cGRhdGU6IC0+CiAgICAgICAgc3VwZXIKICAgICAgICAKICAgICAgICBpZiBAaXNPcGVuaW5nCiAgICAgICAgICAgIEB1cGRhdGVPcGVuaW5nKCkKICAgICAgICBlbHNlIGlmIEBpc0Nsb3NpbmcKICAgICAgICAgICAgQHVwZGF0ZUNsb3NpbmcoKQogICAgICAgICAgICAKICAgIGNyZWF0ZUFjdG9yRmFjZUJpdG1hcDogKGFjdG9yKSAtPgogICAgICAgIHJlc3VsdCA9IG51bGwKICAgICAgICBiaXRtYXAgPSBSZXNvdXJjZU1hbmFnZXIuZ2V0Qml0bWFwKCJHcmFwaGljcy9GYWNlcy8je2FjdG9yLmZhY2VHcmFwaGljLm5hbWV9IikKICAgICAgICBpZiBiaXRtYXA/CiAgICAgICAgICAgIHJlc3VsdCA9IG5ldyBCaXRtYXAoOTYgKiBXaW5kb3dfQmFzZS5zY2FsZSwgOTYgKiBXaW5kb3dfQmFzZS5zY2FsZSkKICAgICAgICAgICAgQGRyYXdGYWNlKDAsIDAsIGJpdG1hcCwgYWN0b3IuZmFjZVBhdHRlcm4sIHJlc3VsdCkKICAgICAgICAgICAgCiAgICAgICAgcmV0dXJuIHJlc3VsdAogICAgICAgICAgICAKICAgIGRyYXdNZW1iZXI6ICh4LCB5LCBtZW1iZXIpIC0+CiAgICAgICAgc2NhbGUgPSBXaW5kb3dfQmFzZS5zY2FsZQogICAgICAgIGZhY2UgPSBSZXNvdXJjZU1hbmFnZXIuZ2V0Qml0bWFwKCJHcmFwaGljcy9GYWNlcy8je21lbWJlci5mYWNlR3JhcGhpYy5uYW1lfSIpCiAgICAgICAjIGZhY2UgPSBSZXNvdXJjZU1hbmFnZXIuZ2V0Qml0bWFwKCJHcmFwaGljcy9GYWNlcy8je21lbWJlci5mYWNlR3JhcGhpYy5uYW1lfSIpCiAgICAgICAgb3ggPSB4ICsgNQogICAgICAgIG95ID0geSArIDIKICAgICAgICMgQGRyYXdGYWNlKHgsIHksIGZhY2UsIG1lbWJlci5mYWNlUGF0dGVybikKICAgICAgICBAZHJhd01lbWJlckNoYXJhY3Rlcih4LCB5LCBtZW1iZXIsIDEuMCkKICAgICAgICBAY29udGVudHMuZm9udCA9IEBtZW1iZXJOYW1lRm9udAogICAgICAgIAogICAgICAgIEBjb250ZW50cy5kcmF3VGV4dCh4LCB5ICsgNjIgKiBzY2FsZSwgMTUwICogc2NhbGUsIDEwICogc2NhbGUsIG1lbWJlci5uYW1lLCAxKQogICAgICAgIAogICAgICAgIEBjb250ZW50cy5mb250ID0gQGdhdWdlRm9udAogICAgICAgIG94ICs9IDUwICogc2NhbGUKICAgICAgICAjIERyYXcgTFYtR2F1Z2UgICAgICAgIAogICAgICAjICBAY29udGVudHMuZmlsbFJlY3Qob3ggLSAyLCBveSAtIDIsIDY0ICsgNCwgMTAgKyA0LCBuZXcgQ29sb3IoMCwgMCwgMCkpCiAgICAgICAjIEBkcmF3R2F1Z2Uob3gsIG95LCA2NCAqIHNjYWxlLCA4ICogc2NhbGUsIENvbG9ycy5FWFBfR0FVR0UxLCBDb2xvcnMuRVhQX0dBVUdFMiwgbWVtYmVyLmxldmVsKQogICAgICAgIyBveSArPSAxOCAqIHNjYWxlCiAgICAgICAgCiAgICAgICAgIyBEcmF3IExQLUdhdWdlCiAgICAgICAgCiAgICAgIyAgIEBjb250ZW50cy5maWxsUmVjdChveCAtIDIsIG95IC0gMiwgNjQgKyA0LCAxMCArIDQsIG5ldyBDb2xvcigwLCAwLCAwKSkKICAgICAgICBAZHJhd0dhdWdlKG94LCBveSwgNzQgKiBzY2FsZSwgNiAqIHNjYWxlLCBDb2xvcnMuTFBfR0FVR0UxLCBDb2xvcnMuTFBfR0FVR0UyLCBtZW1iZXIubHAsIG1lbWJlci5tbHApCiAgICAgICAgb3kgKz0gMjYgKiBzY2FsZQogICAgICAgIAogICAgICAgICMgRHJhdyBNUC1HYXVnZQogICAgICAgIAogICAgICAjICBAY29udGVudHMuZmlsbFJlY3Qob3ggLSAyLCBveSArIDggKyA1IC0gMiwgNjQgKyA0LCAxMCArIDQsIG5ldyBDb2xvcigwLCAwLCAwKSkKICAgICAgICBAZHJhd0dhdWdlKG94LCBveSwgNzQgKiBzY2FsZSwgNiAqIHNjYWxlLCBDb2xvcnMuTVBfR0FVR0UxLCBDb2xvcnMuTVBfR0FVR0UyLCBtZW1iZXIubXAsIG1lbWJlci5tbXApCiAgICAgICAgb3kgKz0gMzEgKiBzY2FsZQogICAgICAgIAogICAgICAgICMgRHJhdyBTdGF0dXMKICAgICAgIyAgQGNvbnRlbnRzLmZvbnQuY29sb3IgPSBuZXcgQ29sb3IoMCwwLDApCiAgICAgICAjIEBjb250ZW50cy5maWxsUmVjdChveCAtIDIsIG95ICsgNSAtIDIsIDY0ICsgNCwgMTYgKyA0LCBuZXcgQ29sb3IoMCwgMCwgMCkpCiAgICAgICMgIEBjb250ZW50cy5ncmFkaWVudEZpbGxSZWN0KG94LCBveSArIDUsIDY0LCAxNiwgbmV3IENvbG9yKDE4MCwgMTgwLCAxODApLCBuZXcgQ29sb3IoMjU1LCAyNTUsIDI1NSksIHllcykKICAgICAjICAgQGNvbnRlbnRzLmRyYXdUZXh0KG94LCBveSArIDUsIDY0LCAxNiwgIk5vcm1hbCIsIDEpCiAgICAgICAjIEBjb250ZW50cy5mb250LmNvbG9yID0gbmV3IENvbG9yKDI1NSwgMjU1LCAyNTUpCiAgICAgICAgCiAgICBkcmF3RmFjZTogKHgsIHksIGZhY2VzZXQsIHBhdHRlcm4sIHRhcmdldCkgLT4KICAgICAgICBzaXplID0gOTYgKiBXaW5kb3dfQmFzZS5zY2FsZQogICAgICAgICh0YXJnZXQgfHwgQGNvbnRlbnRzKS5zdHJldGNoQmx0KG5ldyBSZWN0KHgsIHksIDk2ICogV2luZG93X0Jhc2Uuc2NhbGUsIDk2ICogV2luZG93X0Jhc2Uuc2NhbGUpLCBmYWNlc2V0LCBuZXcgUmVjdChwYXR0ZXJuICUgNCAqIHNpemUsIE1hdGguZmxvb3IocGF0dGVybiAvIDQpICogc2l6ZSwgc2l6ZSwgc2l6ZSkpCiAgICBkcmF3Q2hhcmFjdGVyOiAoeCwgeSwgY2hhcnNldCwgcGF0dGVybiwgc3ViUGF0dGVybiwgc2NhbGUpIC0+CiAgICAgICAgc2NhbGUgPSBzY2FsZSB8fCAxCiAgICAgICAgd2lkdGggPSBjaGFyc2V0LndpZHRoIC8gNAogICAgICAgIGhlaWdodCA9IGNoYXJzZXQuaGVpZ2h0IC8gNAogICAgICAgIGNvbHVtbiA9IHN1YlBhdHRlcm4gJSA0I3BhdHRlcm4gJSA0ICogMyArIHN1YlBhdHRlcm4gJSAzCiAgICAgICAgcm93ID0gTWF0aC5mbG9vcihzdWJQYXR0ZXJuIC8gNCkjTWF0aC5mbG9vcihwYXR0ZXJuIC8gNCkgKiA0ICsgTWF0aC5mbG9vcihzdWJQYXR0ZXJuIC8gMykgICAgICAgCiAgICAgICAgc3JjUmVjdCA9IG5ldyBSZWN0KGNvbHVtbiAqIHdpZHRoLCByb3cgKiBoZWlnaHQsIHdpZHRoLCBoZWlnaHQpCiAgICAgICAgZHN0UmVjdCA9IG5ldyBSZWN0KHgsIHksIHdpZHRoICogc2NhbGUsIGhlaWdodCAqIHNjYWxlKQogICAgICAgIEBjb250ZW50cy5zdHJldGNoQmx0KGRzdFJlY3QsIGNoYXJzZXQsIHNyY1JlY3QpCiAgICBkcmF3TWVtYmVyRmFjZTogKHgsIHksIG1lbWJlcikgLT4KICAgICAgICByZXR1cm4gaWYgbWVtYmVyLmZhY2VHcmFwaGljLm5hbWUgPT0gIiIKICAgICAgICBmYWNlID0gUmVzb3VyY2VNYW5hZ2VyLmdldEJpdG1hcCgiR3JhcGhpY3MvRmFjZXMvI3ttZW1iZXIuZmFjZUdyYXBoaWMubmFtZX0iKQogICAgICAgIEBkcmF3RmFjZSh4LCB5LCBmYWNlLCBtZW1iZXIuZmFjZVBhdHRlcm4pCiAgICAKICAgIGRyYXdNZW1iZXJDaGFyYWN0ZXI6ICh4LCB5LCBtZW1iZXIsIHNjYWxlKSAtPgogICAgICAgIHJldHVybiBpZiBtZW1iZXIuY2hhcmFjdGVyR3JhcGhpYy5uYW1lID09ICIiCiAgICAgICAgY2hhcmFjdGVyID0gUmVzb3VyY2VNYW5hZ2VyLmdldEJpdG1hcCgiR3JhcGhpY3MvQ2hhcmFjdGVycy8je21lbWJlci5jaGFyYWN0ZXJHcmFwaGljLm5hbWV9IikKICAgICAgICBAZHJhd0NoYXJhY3Rlcih4LCB5LCBjaGFyYWN0ZXIsIG1lbWJlci5jaGFyYWN0ZXJQYXR0ZXJuLCAwLCBzY2FsZSkKICAgICAgICAgICAgCiAgICBtZW1iZXJDaGFyYWN0ZXJTaXplOiAobWVtYmVyKSAtPiAKICAgICAgICByZXR1cm4geyB3OiAzMiwgaDogMzIgfSBpZiBtZW1iZXIuY2hhcmFjdGVyR3JhcGhpYy5uYW1lID09ICIiCiAgICAgICAgY2hhcnNldCA9IFJlc291cmNlTWFuYWdlci5nZXRCaXRtYXAoIkdyYXBoaWNzL0NoYXJhY3RlcnMvI3ttZW1iZXIuY2hhcmFjdGVyR3JhcGhpYy5uYW1lfSIpCiAgICAgICAgcmV0dXJuIHc6IGNoYXJzZXQud2lkdGggLyAxMiwgaDogY2hhcnNldC5oZWlnaHQgLyA4CiAgICAgICAgCiAgICBkcmF3R2F1Z2U6ICh4LCB5LCB3LCBoLCBjb2xvcjEsIGNvbG9yMiwgdmFsdWUsIG1heFZhbHVlKSAtPgogICAgICAgIGd3ID0gdyAqICh2YWx1ZSAvIG1heFZhbHVlKQogICAgICAgIEBjb250ZW50cy5ncmFkaWVudEZpbGxSZWN0KHgsIHkrNCwgdywgaCwgY29sb3IxLCBjb2xvcjIpCiAgICAgICAgQGNvbnRlbnRzLmZpbGxSZWN0KHggKyBndywgeSs0LCAody1ndyksIGgsIENvbG9ycy5EQVJLX0dSRVkpCiAgICAgICAgaWYgdmFsdWU/IHRoZW4gQGNvbnRlbnRzLmRyYXdUZXh0KHgsIHksIHcsIGgsICIje3ZhbHVlfS8je21heFZhbHVlfSIsIDEpCiAgICBkcmF3SWNvbjogKGljb25zZXQsIHBhdHRlcm4sIHgsIHkpIC0+CiAgICAgICAgcyA9IFdpbmRvd19CYXNlLnNjYWxlCiAgICAgICAgc2l6ZSA9IDI0ICogcwogICAgICAgIGljb25zWCA9IGljb25zZXQud2lkdGggL3NpemUKICAgICAgICBjb2x1bW4gPSBwYXR0ZXJuICUgaWNvbnNYIAogICAgICAgIHJvdyA9IE1hdGguZmxvb3IocGF0dGVybiAvIGljb25zWCkgICAgCiAgICAgICAgCiAgICAgICAgc3JjUmVjdCA9IG5ldyBSZWN0KGNvbHVtbiAqIHNpemUsIHJvdyAqIHNpemUsIHNpemUsIHNpemUpCiAgICAgICAgCiAgICAgICAgQGNvbnRlbnRzLmJsdCh4LCB5LCBpY29uc2V0LCBzcmNSZWN0KQogICAgZHJhd1N0YXR1czogKHgsIHksIHcsIHN0YXR1cykgLT4KICAgICAgIyAgQGNvbnRlbnRzLmZpbGxSZWN0KHgsIHksIHcsIDE4LCBuZXcgQ29sb3IoMCwgMCwgMCkpCiAgICAgICAjIEBjb250ZW50cy5ncmFkaWVudEZpbGxSZWN0KHgrMSwgeSsxLCB3LTIsIDE2LCBuZXcgQ29sb3IoMTgwLCAxODAsIDE4MCksIG5ldyBDb2xvcigyNTUsIDI1NSwgMjU1KSwgeWVzKQogICAgICAgCiAgICAgICMgIEBjb250ZW50cy5kcmF3VGV4dCh4LCB5LCB3LCAyMCwgc3RhdHVzLCAxKQogICAgICAKICAgIGRyYXdTdGF0ZXM6ICh4LCB5LCBzdGF0ZXMpIC0+CiAgICAgICAgc3RhdGUgPSBudWxsCiAgICAgICAgb3ggPSB4CiAgICAgICAgcyA9IFdpbmRvd19CYXNlLnNjYWxlCiAgICAgICAgZm9yIGkgaW4gWzAuLi5zdGF0ZXMubGVuZ3RoXQogICAgICAgICAgICBzdGF0ZSA9IHN0YXRlc1tpXQogICAgICAgICAgICBpZiBzdGF0ZS5pY29uR3JhcGhpYz8gYW5kIHN0YXRlLmljb25HcmFwaGljLm5hbWUubGVuZ3RoID4gMAogICAgICAgICAgICAgICAgYml0bWFwID0gUmVzb3VyY2VNYW5hZ2VyLmdldEJpdG1hcCgiR3JhcGhpY3MvSWNvbnMvI3tzdGF0ZS5pY29uR3JhcGhpYy5uYW1lfSIpCiAgICAgICAgICAgICAgICBjb2x1bW5zID0gTWF0aC5jZWlsKGJpdG1hcC53aWR0aCAvICgyNCpzKSkKICAgICAgICAgICAgICAgIEBjb250ZW50cy5ibHQob3gsIHksIGJpdG1hcCwgbmV3IFJlY3Qoc3RhdGUuaWNvblBhdHRlcm4gJSBjb2x1bW5zICogKDI0KnMpLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXRoLmZsb29yKHN0YXRlLmljb25QYXR0ZXJuIC8gY29sdW1ucykgKiAoMjQqcyksIDI0KnMsIDI0KnMpKQogICAgICAgICAgICAgICAgb3ggKz0gMjQqcyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICByZXR1cm4gbnVsbAogICAgICAgIAp3aW5kb3cuV2luZG93X0Jhc2UgPSBXaW5kb3dfQmFzZQ==","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBXaW5kb3dfQmFzZSwKICAgIF9faGFzUHJvcCA9IHt9Lmhhc093blByb3BlcnR5LAogICAgX19leHRlbmRzID0gZnVuY3Rpb24oY2hpbGQsIHBhcmVudCkgeyBmb3IgKHZhciBrZXkgaW4gcGFyZW50KSB7IGlmIChfX2hhc1Byb3AuY2FsbChwYXJlbnQsIGtleSkpIGNoaWxkW2tleV0gPSBwYXJlbnRba2V5XTsgfSBmdW5jdGlvbiBjdG9yKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gY2hpbGQ7IH0gY3Rvci5wcm90b3R5cGUgPSBwYXJlbnQucHJvdG90eXBlOyBjaGlsZC5wcm90b3R5cGUgPSBuZXcgY3RvcigpOyBjaGlsZC5fX3N1cGVyX18gPSBwYXJlbnQucHJvdG90eXBlOyByZXR1cm4gY2hpbGQ7IH07CgogIFdpbmRvd19CYXNlID0gKGZ1bmN0aW9uKF9zdXBlcikgewogICAgX19leHRlbmRzKFdpbmRvd19CYXNlLCBfc3VwZXIpOwoKICAgIGlmICgkUEFSQU1TLnJlc29sdXRpb24ud2lkdGggPT09IDMyMCkgewogICAgICBXaW5kb3dfQmFzZS5iYWNrUmVjdCA9IG5ldyBSZWN0KDAsIDAsIDMyLCAzMik7CiAgICAgIFdpbmRvd19CYXNlLmJhY2tSZWN0MiA9IG5ldyBSZWN0KDAsIDMyLCAzMiwgMzIpOwogICAgICBXaW5kb3dfQmFzZS5mcmFtZVJlY3QgPSBuZXcgUmVjdCgzMiwgMCwgMzIsIDMyKTsKICAgICAgV2luZG93X0Jhc2UuZnJhbWVUaGlja25lc3MgPSA4OwogICAgICBXaW5kb3dfQmFzZS5mcmFtZVBhZGRpbmcgPSAyOwogICAgICBXaW5kb3dfQmFzZS5sZWZ0QXJyb3dSZWN0ID0gbmV3IFJlY3QoV2luZG93X0Jhc2UuZnJhbWVSZWN0LnggKyBXaW5kb3dfQmFzZS5mcmFtZVRoaWNrbmVzcywgV2luZG93X0Jhc2UuZnJhbWVSZWN0LnkgKyAxMiwgOCwgOCk7CiAgICAgIFdpbmRvd19CYXNlLnRvcEFycm93UmVjdCA9IG5ldyBSZWN0KFdpbmRvd19CYXNlLmZyYW1lUmVjdC54ICsgMTIsIFdpbmRvd19CYXNlLmZyYW1lUmVjdC55ICsgV2luZG93X0Jhc2UuZnJhbWVUaGlja25lc3MsIDgsIDgpOwogICAgICBXaW5kb3dfQmFzZS5yaWdodEFycm93UmVjdCA9IG5ldyBSZWN0KDQwICsgV2luZG93X0Jhc2UuZnJhbWVSZWN0LngsIFdpbmRvd19CYXNlLmZyYW1lUmVjdC55ICsgMTIsIDgsIDgpOwogICAgICBXaW5kb3dfQmFzZS5ib3R0b21BcnJvd1JlY3QgPSBuZXcgUmVjdChXaW5kb3dfQmFzZS5mcmFtZVJlY3QueCArIDEyLCAyMCArIFdpbmRvd19CYXNlLmZyYW1lUmVjdC55LCA4LCA4KTsKICAgICAgV2luZG93X0Jhc2UuY29ybmVyU2l6ZSA9IDg7CiAgICAgIFdpbmRvd19CYXNlLmN1cnNvclJlY3QgPSBuZXcgUmVjdCgzMiwgMzIsIDE2LCAxNik7CiAgICAgIFdpbmRvd19CYXNlLmN1cnNvckJvcmRlciA9IDI7CiAgICAgIFdpbmRvd19CYXNlLnBhdXNlUmVjdCA9IG5ldyBSZWN0KDQ4LCAzMiwgMTYsIDE2KTsKICAgICAgV2luZG93X0Jhc2UucGF1c2VJY29uU2l6ZSA9IG5ldyBSZWN0KDAsIDAsIDgsIDgpOwogICAgICBXaW5kb3dfQmFzZS5zY2FsZSA9IDAuNTsKICAgIH0KCiAgICBmdW5jdGlvbiBXaW5kb3dfQmFzZSh4LCB5LCB3aWR0aCwgaGVpZ2h0LCB2aWV3cG9ydCkgewogICAgICBXaW5kb3dfQmFzZS5fX3N1cGVyX18uY29uc3RydWN0b3IuY2FsbCh0aGlzLCB2aWV3cG9ydCk7CiAgICAgIHRoaXMud2luZG93U2tpbiA9IEdhbWVNYW5hZ2VyLndpbmRvd1NraW47CiAgICAgIHRoaXMueCA9IHg7CiAgICAgIHRoaXMueSA9IHk7CiAgICAgIHRoaXMud2lkdGggPSB3aWR0aDsKICAgICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7CiAgICAgIHRoaXMucGF1c2UgPSBmYWxzZTsKICAgICAgdGhpcy5veCA9IDA7CiAgICAgIHRoaXMub3kgPSAwOwogICAgICB0aGlzLmJhY2tPcGFjaXR5ID0gMTYwOwogICAgICB0aGlzLm9wYWNpdHkgPSAyNTU7CiAgICAgIHRoaXMuY29udGVudHNPcGFjaXR5ID0gMjU1OwogICAgICB0aGlzLm9wZW5uZXNzID0gMjU1OwogICAgICB0aGlzLnRvbmUgPSBHYW1lTWFuYWdlci53aW5kb3dTa2luVG9uZTsKICAgICAgdGhpcy5jdXJzb3JSZWN0ID0gbmV3IFJlY3QoMCwgMCwgMCwgMCk7CiAgICAgIHRoaXMuaXNPcGVuaW5nID0gZmFsc2U7CiAgICAgIHRoaXMuaXNDbG9zaW5nID0gZmFsc2U7CiAgICAgIHRoaXMubmFtZUZvbnQgPSBGb250cy5OQU1FOwogICAgICB0aGlzLmFjdGlvbkZvbnQgPSBGb250cy5BQ1RJT047CiAgICAgIHRoaXMuZ2F1Z2VGb250ID0gdGhpcy5hY3Rpb25Gb250OwogICAgICB0aGlzLm1lbWJlck5hbWVGb250ID0gdGhpcy5uYW1lRm9udDsKICAgIH0KCiAgICBXaW5kb3dfQmFzZS5wcm90b3R5cGUub3BlbiA9IGZ1bmN0aW9uKCkgewogICAgICB0aGlzLmlzT3BlbmluZyA9IHRydWU7CiAgICAgIHJldHVybiB0aGlzLnZpc2libGUgPSB0cnVlOwogICAgfTsKCiAgICBXaW5kb3dfQmFzZS5wcm90b3R5cGUub3Blbk1vZGFsID0gZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMueiA9IDMwMDA7CiAgICAgIEdhbWVNYW5hZ2VyLm1vZGFsU3ByaXRlLnZpc2libGUgPSB0cnVlOwogICAgICByZXR1cm4gdGhpcy5vcGVuKCk7CiAgICB9OwoKICAgIFdpbmRvd19CYXNlLnByb3RvdHlwZS5jbG9zZSA9IGZ1bmN0aW9uKCkgewogICAgICB0aGlzLmlzQ2xvc2luZyA9IHRydWU7CiAgICAgIHJldHVybiBHYW1lTWFuYWdlci5tb2RhbFNwcml0ZS52aXNpYmxlID0gZmFsc2U7CiAgICB9OwoKICAgIFdpbmRvd19CYXNlLnByb3RvdHlwZS51cGRhdGVPcGVuaW5nID0gZnVuY3Rpb24oKSB7CiAgICAgIGlmICh0aGlzLm9wZW5uZXNzIDwgMjU1KSB7CiAgICAgICAgdGhpcy5vcGVubmVzcyA9IE1hdGgubWluKHRoaXMub3Blbm5lc3MgKyAzMiwgMjU1KTsKICAgICAgfQogICAgICB0aGlzLmlzT3BlbmluZyA9IHRoaXMub3Blbm5lc3MgPCAyNTU7CiAgICAgIHJldHVybiB0aGlzLmFjdGl2ZSA9IHRoaXMub3Blbm5lc3MgPiAwOwogICAgfTsKCiAgICBXaW5kb3dfQmFzZS5wcm90b3R5cGUudXBkYXRlQ2xvc2luZyA9IGZ1bmN0aW9uKCkgewogICAgICBpZiAodGhpcy5vcGVubmVzcyA+IDApIHsKICAgICAgICB0aGlzLm9wZW5uZXNzID0gTWF0aC5tYXgodGhpcy5vcGVubmVzcyAtIDMyLCAwKTsKICAgICAgfQogICAgICB0aGlzLmlzQ2xvc2luZyA9IHRoaXMub3Blbm5lc3MgPiAwOwogICAgICB0aGlzLmFjdGl2ZSA9IHRoaXMub3Blbm5lc3MgPiAwOwogICAgICByZXR1cm4gdGhpcy52aXNpYmxlID0gdGhpcy5vcGVuZXNzID4gMDsKICAgIH07CgogICAgV2luZG93X0Jhc2UucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkgewogICAgICBXaW5kb3dfQmFzZS5fX3N1cGVyX18udXBkYXRlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIGlmICh0aGlzLmlzT3BlbmluZykgewogICAgICAgIHJldHVybiB0aGlzLnVwZGF0ZU9wZW5pbmcoKTsKICAgICAgfSBlbHNlIGlmICh0aGlzLmlzQ2xvc2luZykgewogICAgICAgIHJldHVybiB0aGlzLnVwZGF0ZUNsb3NpbmcoKTsKICAgICAgfQogICAgfTsKCiAgICBXaW5kb3dfQmFzZS5wcm90b3R5cGUuY3JlYXRlQWN0b3JGYWNlQml0bWFwID0gZnVuY3Rpb24oYWN0b3IpIHsKICAgICAgdmFyIGJpdG1hcCwgcmVzdWx0OwogICAgICByZXN1bHQgPSBudWxsOwogICAgICBiaXRtYXAgPSBSZXNvdXJjZU1hbmFnZXIuZ2V0Qml0bWFwKCJHcmFwaGljcy9GYWNlcy8iICsgYWN0b3IuZmFjZUdyYXBoaWMubmFtZSk7CiAgICAgIGlmIChiaXRtYXAgIT0gbnVsbCkgewogICAgICAgIHJlc3VsdCA9IG5ldyBCaXRtYXAoOTYgKiBXaW5kb3dfQmFzZS5zY2FsZSwgOTYgKiBXaW5kb3dfQmFzZS5zY2FsZSk7CiAgICAgICAgdGhpcy5kcmF3RmFjZSgwLCAwLCBiaXRtYXAsIGFjdG9yLmZhY2VQYXR0ZXJuLCByZXN1bHQpOwogICAgICB9CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9OwoKICAgIFdpbmRvd19CYXNlLnByb3RvdHlwZS5kcmF3TWVtYmVyID0gZnVuY3Rpb24oeCwgeSwgbWVtYmVyKSB7CiAgICAgIHZhciBmYWNlLCBveCwgb3ksIHNjYWxlOwogICAgICBzY2FsZSA9IFdpbmRvd19CYXNlLnNjYWxlOwogICAgICBmYWNlID0gUmVzb3VyY2VNYW5hZ2VyLmdldEJpdG1hcCgiR3JhcGhpY3MvRmFjZXMvIiArIG1lbWJlci5mYWNlR3JhcGhpYy5uYW1lKTsKICAgICAgb3ggPSB4ICsgNTsKICAgICAgb3kgPSB5ICsgMjsKICAgICAgdGhpcy5kcmF3TWVtYmVyQ2hhcmFjdGVyKHgsIHksIG1lbWJlciwgMS4wKTsKICAgICAgdGhpcy5jb250ZW50cy5mb250ID0gdGhpcy5tZW1iZXJOYW1lRm9udDsKICAgICAgdGhpcy5jb250ZW50cy5kcmF3VGV4dCh4LCB5ICsgNjIgKiBzY2FsZSwgMTUwICogc2NhbGUsIDEwICogc2NhbGUsIG1lbWJlci5uYW1lLCAxKTsKICAgICAgdGhpcy5jb250ZW50cy5mb250ID0gdGhpcy5nYXVnZUZvbnQ7CiAgICAgIG94ICs9IDUwICogc2NhbGU7CiAgICAgIHRoaXMuZHJhd0dhdWdlKG94LCBveSwgNzQgKiBzY2FsZSwgNiAqIHNjYWxlLCBDb2xvcnMuTFBfR0FVR0UxLCBDb2xvcnMuTFBfR0FVR0UyLCBtZW1iZXIubHAsIG1lbWJlci5tbHApOwogICAgICBveSArPSAyNiAqIHNjYWxlOwogICAgICB0aGlzLmRyYXdHYXVnZShveCwgb3ksIDc0ICogc2NhbGUsIDYgKiBzY2FsZSwgQ29sb3JzLk1QX0dBVUdFMSwgQ29sb3JzLk1QX0dBVUdFMiwgbWVtYmVyLm1wLCBtZW1iZXIubW1wKTsKICAgICAgcmV0dXJuIG95ICs9IDMxICogc2NhbGU7CiAgICB9OwoKICAgIFdpbmRvd19CYXNlLnByb3RvdHlwZS5kcmF3RmFjZSA9IGZ1bmN0aW9uKHgsIHksIGZhY2VzZXQsIHBhdHRlcm4sIHRhcmdldCkgewogICAgICB2YXIgc2l6ZTsKICAgICAgc2l6ZSA9IDk2ICogV2luZG93X0Jhc2Uuc2NhbGU7CiAgICAgIHJldHVybiAodGFyZ2V0IHx8IHRoaXMuY29udGVudHMpLnN0cmV0Y2hCbHQobmV3IFJlY3QoeCwgeSwgOTYgKiBXaW5kb3dfQmFzZS5zY2FsZSwgOTYgKiBXaW5kb3dfQmFzZS5zY2FsZSksIGZhY2VzZXQsIG5ldyBSZWN0KHBhdHRlcm4gJSA0ICogc2l6ZSwgTWF0aC5mbG9vcihwYXR0ZXJuIC8gNCkgKiBzaXplLCBzaXplLCBzaXplKSk7CiAgICB9OwoKICAgIFdpbmRvd19CYXNlLnByb3RvdHlwZS5kcmF3Q2hhcmFjdGVyID0gZnVuY3Rpb24oeCwgeSwgY2hhcnNldCwgcGF0dGVybiwgc3ViUGF0dGVybiwgc2NhbGUpIHsKICAgICAgdmFyIGNvbHVtbiwgZHN0UmVjdCwgaGVpZ2h0LCByb3csIHNyY1JlY3QsIHdpZHRoOwogICAgICBzY2FsZSA9IHNjYWxlIHx8IDE7CiAgICAgIHdpZHRoID0gY2hhcnNldC53aWR0aCAvIDQ7CiAgICAgIGhlaWdodCA9IGNoYXJzZXQuaGVpZ2h0IC8gNDsKICAgICAgY29sdW1uID0gc3ViUGF0dGVybiAlIDQ7CiAgICAgIHJvdyA9IE1hdGguZmxvb3Ioc3ViUGF0dGVybiAvIDQpOwogICAgICBzcmNSZWN0ID0gbmV3IFJlY3QoY29sdW1uICogd2lkdGgsIHJvdyAqIGhlaWdodCwgd2lkdGgsIGhlaWdodCk7CiAgICAgIGRzdFJlY3QgPSBuZXcgUmVjdCh4LCB5LCB3aWR0aCAqIHNjYWxlLCBoZWlnaHQgKiBzY2FsZSk7CiAgICAgIHJldHVybiB0aGlzLmNvbnRlbnRzLnN0cmV0Y2hCbHQoZHN0UmVjdCwgY2hhcnNldCwgc3JjUmVjdCk7CiAgICB9OwoKICAgIFdpbmRvd19CYXNlLnByb3RvdHlwZS5kcmF3TWVtYmVyRmFjZSA9IGZ1bmN0aW9uKHgsIHksIG1lbWJlcikgewogICAgICB2YXIgZmFjZTsKICAgICAgaWYgKG1lbWJlci5mYWNlR3JhcGhpYy5uYW1lID09PSAiIikgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBmYWNlID0gUmVzb3VyY2VNYW5hZ2VyLmdldEJpdG1hcCgiR3JhcGhpY3MvRmFjZXMvIiArIG1lbWJlci5mYWNlR3JhcGhpYy5uYW1lKTsKICAgICAgcmV0dXJuIHRoaXMuZHJhd0ZhY2UoeCwgeSwgZmFjZSwgbWVtYmVyLmZhY2VQYXR0ZXJuKTsKICAgIH07CgogICAgV2luZG93X0Jhc2UucHJvdG90eXBlLmRyYXdNZW1iZXJDaGFyYWN0ZXIgPSBmdW5jdGlvbih4LCB5LCBtZW1iZXIsIHNjYWxlKSB7CiAgICAgIHZhciBjaGFyYWN0ZXI7CiAgICAgIGlmIChtZW1iZXIuY2hhcmFjdGVyR3JhcGhpYy5uYW1lID09PSAiIikgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBjaGFyYWN0ZXIgPSBSZXNvdXJjZU1hbmFnZXIuZ2V0Qml0bWFwKCJHcmFwaGljcy9DaGFyYWN0ZXJzLyIgKyBtZW1iZXIuY2hhcmFjdGVyR3JhcGhpYy5uYW1lKTsKICAgICAgcmV0dXJuIHRoaXMuZHJhd0NoYXJhY3Rlcih4LCB5LCBjaGFyYWN0ZXIsIG1lbWJlci5jaGFyYWN0ZXJQYXR0ZXJuLCAwLCBzY2FsZSk7CiAgICB9OwoKICAgIFdpbmRvd19CYXNlLnByb3RvdHlwZS5tZW1iZXJDaGFyYWN0ZXJTaXplID0gZnVuY3Rpb24obWVtYmVyKSB7CiAgICAgIHZhciBjaGFyc2V0OwogICAgICBpZiAobWVtYmVyLmNoYXJhY3RlckdyYXBoaWMubmFtZSA9PT0gIiIpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgdzogMzIsCiAgICAgICAgICBoOiAzMgogICAgICAgIH07CiAgICAgIH0KICAgICAgY2hhcnNldCA9IFJlc291cmNlTWFuYWdlci5nZXRCaXRtYXAoIkdyYXBoaWNzL0NoYXJhY3RlcnMvIiArIG1lbWJlci5jaGFyYWN0ZXJHcmFwaGljLm5hbWUpOwogICAgICByZXR1cm4gewogICAgICAgIHc6IGNoYXJzZXQud2lkdGggLyAxMiwKICAgICAgICBoOiBjaGFyc2V0LmhlaWdodCAvIDgKICAgICAgfTsKICAgIH07CgogICAgV2luZG93X0Jhc2UucHJvdG90eXBlLmRyYXdHYXVnZSA9IGZ1bmN0aW9uKHgsIHksIHcsIGgsIGNvbG9yMSwgY29sb3IyLCB2YWx1ZSwgbWF4VmFsdWUpIHsKICAgICAgdmFyIGd3OwogICAgICBndyA9IHcgKiAodmFsdWUgLyBtYXhWYWx1ZSk7CiAgICAgIHRoaXMuY29udGVudHMuZ3JhZGllbnRGaWxsUmVjdCh4LCB5ICsgNCwgdywgaCwgY29sb3IxLCBjb2xvcjIpOwogICAgICB0aGlzLmNvbnRlbnRzLmZpbGxSZWN0KHggKyBndywgeSArIDQsIHcgLSBndywgaCwgQ29sb3JzLkRBUktfR1JFWSk7CiAgICAgIGlmICh2YWx1ZSAhPSBudWxsKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuY29udGVudHMuZHJhd1RleHQoeCwgeSwgdywgaCwgIiIgKyB2YWx1ZSArICIvIiArIG1heFZhbHVlLCAxKTsKICAgICAgfQogICAgfTsKCiAgICBXaW5kb3dfQmFzZS5wcm90b3R5cGUuZHJhd0ljb24gPSBmdW5jdGlvbihpY29uc2V0LCBwYXR0ZXJuLCB4LCB5KSB7CiAgICAgIHZhciBjb2x1bW4sIGljb25zWCwgcm93LCBzLCBzaXplLCBzcmNSZWN0OwogICAgICBzID0gV2luZG93X0Jhc2Uuc2NhbGU7CiAgICAgIHNpemUgPSAyNCAqIHM7CiAgICAgIGljb25zWCA9IGljb25zZXQud2lkdGggLyBzaXplOwogICAgICBjb2x1bW4gPSBwYXR0ZXJuICUgaWNvbnNYOwogICAgICByb3cgPSBNYXRoLmZsb29yKHBhdHRlcm4gLyBpY29uc1gpOwogICAgICBzcmNSZWN0ID0gbmV3IFJlY3QoY29sdW1uICogc2l6ZSwgcm93ICogc2l6ZSwgc2l6ZSwgc2l6ZSk7CiAgICAgIHJldHVybiB0aGlzLmNvbnRlbnRzLmJsdCh4LCB5LCBpY29uc2V0LCBzcmNSZWN0KTsKICAgIH07CgogICAgV2luZG93X0Jhc2UucHJvdG90eXBlLmRyYXdTdGF0dXMgPSBmdW5jdGlvbih4LCB5LCB3LCBzdGF0dXMpIHt9OwoKICAgIFdpbmRvd19CYXNlLnByb3RvdHlwZS5kcmF3U3RhdGVzID0gZnVuY3Rpb24oeCwgeSwgc3RhdGVzKSB7CiAgICAgIHZhciBiaXRtYXAsIGNvbHVtbnMsIGksIG94LCBzLCBzdGF0ZSwgX2ksIF9yZWY7CiAgICAgIHN0YXRlID0gbnVsbDsKICAgICAgb3ggPSB4OwogICAgICBzID0gV2luZG93X0Jhc2Uuc2NhbGU7CiAgICAgIGZvciAoaSA9IF9pID0gMCwgX3JlZiA9IHN0YXRlcy5sZW5ndGg7IDAgPD0gX3JlZiA/IF9pIDwgX3JlZiA6IF9pID4gX3JlZjsgaSA9IDAgPD0gX3JlZiA/ICsrX2kgOiAtLV9pKSB7CiAgICAgICAgc3RhdGUgPSBzdGF0ZXNbaV07CiAgICAgICAgaWYgKChzdGF0ZS5pY29uR3JhcGhpYyAhPSBudWxsKSAmJiBzdGF0ZS5pY29uR3JhcGhpYy5uYW1lLmxlbmd0aCA+IDApIHsKICAgICAgICAgIGJpdG1hcCA9IFJlc291cmNlTWFuYWdlci5nZXRCaXRtYXAoIkdyYXBoaWNzL0ljb25zLyIgKyBzdGF0ZS5pY29uR3JhcGhpYy5uYW1lKTsKICAgICAgICAgIGNvbHVtbnMgPSBNYXRoLmNlaWwoYml0bWFwLndpZHRoIC8gKDI0ICogcykpOwogICAgICAgICAgdGhpcy5jb250ZW50cy5ibHQob3gsIHksIGJpdG1hcCwgbmV3IFJlY3Qoc3RhdGUuaWNvblBhdHRlcm4gJSBjb2x1bW5zICogKDI0ICogcyksIE1hdGguZmxvb3Ioc3RhdGUuaWNvblBhdHRlcm4gLyBjb2x1bW5zKSAqICgyNCAqIHMpLCAyNCAqIHMsIDI0ICogcykpOwogICAgICAgICAgb3ggKz0gMjQgKiBzOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gbnVsbDsKICAgIH07CgogICAgcmV0dXJuIFdpbmRvd19CYXNlOwoKICB9KShXaW5kb3cpOwoKICB3aW5kb3cuV2luZG93X0Jhc2UgPSBXaW5kb3dfQmFzZTsKCn0pLmNhbGwodGhpcyk7Cg=="},{"name":"Window_ModalBase","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogV2luZG93X01vZGFsQmFzZQojICAgQ3JlYXRlZCBvbjogMjAxMy0xMC0yOQojCiMgICBDb3B5cmlnaHQgKEMpIDIwMTMgQW5kcukgUmFkb21za2kuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIENsYXNzOiBXaW5kb3dfTW9kYWxCYXNlCiMKIyAgIEEgd2luZG93IHdoaWNoIGRpc3BsYXlzIGEgdGV4dC4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCmNsYXNzIFdpbmRvd19Nb2RhbEJhc2UgZXh0ZW5kcyBXaW5kb3dfQmFzZQogICAgY29uc3RydWN0b3I6ICh4LCB5LCB3aWR0aCwgaGVpZ2h0LCB2aWV3cG9ydCkgLT4KICAgICAgICBzdXBlcih4LCB5LCB3aWR0aCwgaGVpZ2h0LCB2aWV3cG9ydCkKICAgICAgICBAeiA9IDMwMDAKICAgIG9wZW46IC0+CiAgICAgICAgc3VwZXIKICAgICAgICBHYW1lTWFuYWdlci5tb2RhbFNwcml0ZS52aXNpYmxlID0geWVzCiAgICAgICAgCiAgICBjbG9zZTogLT4KICAgICAgICBzdXBlcgogICAgICAgIEdhbWVNYW5hZ2VyLm1vZGFsU3ByaXRlLnZpc2libGUgPSBubwogICAgICAgIAogICAgYWNjZXB0OiAtPiAKICAgICAgICBAY2xvc2UoKQogICAgICAgIGlmIEBvbkFjY2VwdD8gdGhlbiBAb25BY2NlcHQodGhpcykKICAgICAgICAKICAgIGNhbmNlbDogLT4gCiAgICAgICAgQGNsb3NlKCkKICAgICAgICBpZiBAb25DYW5jZWw/IHRoZW4gQG9uQ2FuY2VsKHRoaXMpCiAgICAgICAgICAgICAgICAKd2luZG93LldpbmRvd19Nb2RhbEJhc2UgPSBXaW5kb3dfTW9kYWxCYXNl","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBXaW5kb3dfTW9kYWxCYXNlLAogICAgX19oYXNQcm9wID0ge30uaGFzT3duUHJvcGVydHksCiAgICBfX2V4dGVuZHMgPSBmdW5jdGlvbihjaGlsZCwgcGFyZW50KSB7IGZvciAodmFyIGtleSBpbiBwYXJlbnQpIHsgaWYgKF9faGFzUHJvcC5jYWxsKHBhcmVudCwga2V5KSkgY2hpbGRba2V5XSA9IHBhcmVudFtrZXldOyB9IGZ1bmN0aW9uIGN0b3IoKSB7IHRoaXMuY29uc3RydWN0b3IgPSBjaGlsZDsgfSBjdG9yLnByb3RvdHlwZSA9IHBhcmVudC5wcm90b3R5cGU7IGNoaWxkLnByb3RvdHlwZSA9IG5ldyBjdG9yKCk7IGNoaWxkLl9fc3VwZXJfXyA9IHBhcmVudC5wcm90b3R5cGU7IHJldHVybiBjaGlsZDsgfTsKCiAgV2luZG93X01vZGFsQmFzZSA9IChmdW5jdGlvbihfc3VwZXIpIHsKICAgIF9fZXh0ZW5kcyhXaW5kb3dfTW9kYWxCYXNlLCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFdpbmRvd19Nb2RhbEJhc2UoeCwgeSwgd2lkdGgsIGhlaWdodCwgdmlld3BvcnQpIHsKICAgICAgV2luZG93X01vZGFsQmFzZS5fX3N1cGVyX18uY29uc3RydWN0b3IuY2FsbCh0aGlzLCB4LCB5LCB3aWR0aCwgaGVpZ2h0LCB2aWV3cG9ydCk7CiAgICAgIHRoaXMueiA9IDMwMDA7CiAgICB9CgogICAgV2luZG93X01vZGFsQmFzZS5wcm90b3R5cGUub3BlbiA9IGZ1bmN0aW9uKCkgewogICAgICBXaW5kb3dfTW9kYWxCYXNlLl9fc3VwZXJfXy5vcGVuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIHJldHVybiBHYW1lTWFuYWdlci5tb2RhbFNwcml0ZS52aXNpYmxlID0gdHJ1ZTsKICAgIH07CgogICAgV2luZG93X01vZGFsQmFzZS5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbigpIHsKICAgICAgV2luZG93X01vZGFsQmFzZS5fX3N1cGVyX18uY2xvc2UuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgcmV0dXJuIEdhbWVNYW5hZ2VyLm1vZGFsU3ByaXRlLnZpc2libGUgPSBmYWxzZTsKICAgIH07CgogICAgV2luZG93X01vZGFsQmFzZS5wcm90b3R5cGUuYWNjZXB0ID0gZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMuY2xvc2UoKTsKICAgICAgaWYgKHRoaXMub25BY2NlcHQgIT0gbnVsbCkgewogICAgICAgIHJldHVybiB0aGlzLm9uQWNjZXB0KHRoaXMpOwogICAgICB9CiAgICB9OwoKICAgIFdpbmRvd19Nb2RhbEJhc2UucHJvdG90eXBlLmNhbmNlbCA9IGZ1bmN0aW9uKCkgewogICAgICB0aGlzLmNsb3NlKCk7CiAgICAgIGlmICh0aGlzLm9uQ2FuY2VsICE9IG51bGwpIHsKICAgICAgICByZXR1cm4gdGhpcy5vbkNhbmNlbCh0aGlzKTsKICAgICAgfQogICAgfTsKCiAgICByZXR1cm4gV2luZG93X01vZGFsQmFzZTsKCiAgfSkoV2luZG93X0Jhc2UpOwoKICB3aW5kb3cuV2luZG93X01vZGFsQmFzZSA9IFdpbmRvd19Nb2RhbEJhc2U7Cgp9KS5jYWxsKHRoaXMpOwo="},{"name":"Window_Text","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogV2luZG93X1RleHQKIyAgIENyZWF0ZWQgb246IDIwMTMtMDktMjIKIwojICAgQ29weXJpZ2h0IChDKSAyMDEzIEFuZHLpIFJhZG9tc2tpLiBBbGwgcmlnaHRzIHJlc2VydmVkLgojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQojCiMgICBDbGFzczogV2luZG93X1BhcnR5CiMKIyAgIEEgd2luZG93IHdoaWNoIGRpc3BsYXlzIGEgdGV4dC4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCmNsYXNzIFdpbmRvd19UZXh0IGV4dGVuZHMgV2luZG93X0Jhc2UKICAgIGNvbnN0cnVjdG9yOiAoeCwgeSwgd2lkdGgsIGhlaWdodCwgdmlld3BvcnQpIC0+CiAgICAgICAgc3VwZXIoeCwgeSwgd2lkdGgsIGhlaWdodCwgdmlld3BvcnQpCiAgICAgICAgQHRleHQgPSAiIgogICAgICAgIEBjb250ZW50cyA9IG5ldyBCaXRtYXAoQHdpZHRoIC0gQHBhZGRpbmcqMiwgQGhlaWdodCAtIEBwYWRkaW5nKjIpCiAgICAgICAgQGNvbnRlbnRzLmZvbnQgPSBAbmFtZUZvbnQKICAgIHJlZHJhdzogLT4KICAgICAgICBAY29udGVudHMuY2xlYXIoKQogICAgICAgIEBjb250ZW50cy5mb250LmNvbG9yID0gQ29sb3JzLlRFWFRfTk9STUFMCiAgICAgICAgaWYgQHRleHQ/CiAgICAgICAgICAgIGxpbmVzID0gQHRleHQuc3BsaXQoIlxuIikKICAgICAgICAgICAgbGluZVNpemUgPSBAY29udGVudHMudGV4dFNpemUobGluZXNbMF0pCiAgICAgICAgICAgIAogICAgICAgICAgICBmb3IgaSBpbiBbMC4uLmxpbmVzLmxlbmd0aF0KICAgICAgICAgICAgICAgIEBjb250ZW50cy5kcmF3VGV4dCgwLCAwLCBAd2lkdGgsIGxpbmVTaXplLmhlaWdodCsoMCpXaW5kb3dfQmFzZS5zY2FsZSksIGxpbmVzW2ldKQogICAgICAgICAgICAgICAgCndpbmRvdy5XaW5kb3dfVGV4dCA9IFdpbmRvd19UZXh0","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBXaW5kb3dfVGV4dCwKICAgIF9faGFzUHJvcCA9IHt9Lmhhc093blByb3BlcnR5LAogICAgX19leHRlbmRzID0gZnVuY3Rpb24oY2hpbGQsIHBhcmVudCkgeyBmb3IgKHZhciBrZXkgaW4gcGFyZW50KSB7IGlmIChfX2hhc1Byb3AuY2FsbChwYXJlbnQsIGtleSkpIGNoaWxkW2tleV0gPSBwYXJlbnRba2V5XTsgfSBmdW5jdGlvbiBjdG9yKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gY2hpbGQ7IH0gY3Rvci5wcm90b3R5cGUgPSBwYXJlbnQucHJvdG90eXBlOyBjaGlsZC5wcm90b3R5cGUgPSBuZXcgY3RvcigpOyBjaGlsZC5fX3N1cGVyX18gPSBwYXJlbnQucHJvdG90eXBlOyByZXR1cm4gY2hpbGQ7IH07CgogIFdpbmRvd19UZXh0ID0gKGZ1bmN0aW9uKF9zdXBlcikgewogICAgX19leHRlbmRzKFdpbmRvd19UZXh0LCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFdpbmRvd19UZXh0KHgsIHksIHdpZHRoLCBoZWlnaHQsIHZpZXdwb3J0KSB7CiAgICAgIFdpbmRvd19UZXh0Ll9fc3VwZXJfXy5jb25zdHJ1Y3Rvci5jYWxsKHRoaXMsIHgsIHksIHdpZHRoLCBoZWlnaHQsIHZpZXdwb3J0KTsKICAgICAgdGhpcy50ZXh0ID0gIiI7CiAgICAgIHRoaXMuY29udGVudHMgPSBuZXcgQml0bWFwKHRoaXMud2lkdGggLSB0aGlzLnBhZGRpbmcgKiAyLCB0aGlzLmhlaWdodCAtIHRoaXMucGFkZGluZyAqIDIpOwogICAgICB0aGlzLmNvbnRlbnRzLmZvbnQgPSB0aGlzLm5hbWVGb250OwogICAgfQoKICAgIFdpbmRvd19UZXh0LnByb3RvdHlwZS5yZWRyYXcgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGksIGxpbmVTaXplLCBsaW5lcywgX2ksIF9yZWYsIF9yZXN1bHRzOwogICAgICB0aGlzLmNvbnRlbnRzLmNsZWFyKCk7CiAgICAgIHRoaXMuY29udGVudHMuZm9udC5jb2xvciA9IENvbG9ycy5URVhUX05PUk1BTDsKICAgICAgaWYgKHRoaXMudGV4dCAhPSBudWxsKSB7CiAgICAgICAgbGluZXMgPSB0aGlzLnRleHQuc3BsaXQoIlxuIik7CiAgICAgICAgbGluZVNpemUgPSB0aGlzLmNvbnRlbnRzLnRleHRTaXplKGxpbmVzWzBdKTsKICAgICAgICBfcmVzdWx0cyA9IFtdOwogICAgICAgIGZvciAoaSA9IF9pID0gMCwgX3JlZiA9IGxpbmVzLmxlbmd0aDsgMCA8PSBfcmVmID8gX2kgPCBfcmVmIDogX2kgPiBfcmVmOyBpID0gMCA8PSBfcmVmID8gKytfaSA6IC0tX2kpIHsKICAgICAgICAgIF9yZXN1bHRzLnB1c2godGhpcy5jb250ZW50cy5kcmF3VGV4dCgwLCAwLCB0aGlzLndpZHRoLCBsaW5lU2l6ZS5oZWlnaHQgKyAoMCAqIFdpbmRvd19CYXNlLnNjYWxlKSwgbGluZXNbaV0pKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIF9yZXN1bHRzOwogICAgICB9CiAgICB9OwoKICAgIHJldHVybiBXaW5kb3dfVGV4dDsKCiAgfSkoV2luZG93X0Jhc2UpOwoKICB3aW5kb3cuV2luZG93X1RleHQgPSBXaW5kb3dfVGV4dDsKCn0pLmNhbGwodGhpcyk7Cg=="},{"name":"Window_Selection","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogV2luZG93X1NlbGVjdGlvbgojICAgQ3JlYXRlZCBvbjogMjAxMy0wOS0wMQojCiMgCUNvcHlyaWdodCAoQykgMjAxMyBBbmRy6SBSYWRvbXNraS4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KIwojIAlDbGFzczogV2luZG93X1NlbGVjdGlvbgojCiMgICBBIHdpbmRvdyB3aGVyZSB0aGUgdXNlciBjYW4gc2VsZWN0IHRoaW5ncyBsaWtlIGl0ZW1zLCBhY3Rpb25zLCBldGMuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpjbGFzcyBXaW5kb3dfU2VsZWN0aW9uIGV4dGVuZHMgV2luZG93X0Jhc2UKICAgIGNvbnN0cnVjdG9yOiAoeCwgeSwgY29sdW1uQ291bnQsIHJvd3MsIGNvbHVtbldpZHRoLCBjb2x1bW5IZWlnaHQsIHZpZXdwb3J0KSAtPgogICAgICAgIEBjb2x1bW5XaWR0aCA9IGNvbHVtbldpZHRoIHx8IDIwMCAqIFdpbmRvd19CYXNlLnNjYWxlCiAgICAgICAgQGNvbHVtbkhlaWdodCA9IGNvbHVtbkhlaWdodCB8fCAzMiAqIFdpbmRvd19CYXNlLnNjYWxlCgogICAgICAgIHN1cGVyKHgsIHksIGNvbHVtbkNvdW50ICogQGNvbHVtbldpZHRoICsgV2luZG93LnBhZGRpbmcqMiwgTWF0aC5tYXgocm93cy5sZW5ndGgsIDEpICogQGNvbHVtbkhlaWdodCArIFdpbmRvdy5wYWRkaW5nKjIsIHZpZXdwb3J0KQogICAgICAgIAogICAgICAgIEBjb2x1bW5Db3VudCA9IGNvbHVtbkNvdW50CiAgICAgICAgQGNvbHVtblNwYWNpbmcgPSAxMCAqIFdpbmRvd19CYXNlLnNjYWxlCiAgICAgICAgQHJvd3MgPSByb3dzCiAgICAgICAgQGN1cnNvclJlY3QgPSBuZXcgUmVjdCgwLCAwLCBAY29sdW1uV2lkdGgsIEBjb2x1bW5IZWlnaHQpCiAgICAgICAgQGNvbnRlbnRzID0gbmV3IEJpdG1hcChAY29sdW1uQ291bnQgKiBAY29sdW1uV2lkdGgsIE1hdGgubWF4KEByb3dzLmxlbmd0aCwgMSkgKiBAY29sdW1uSGVpZ2h0KQogICAgICAgIEB0ZXh0QWxpZ21lbnQgPSAxCiAgICAgICAgQGNvbnRlbnRzLmZvbnQgPSBAYWN0aW9uRm9udAogICAgICAgIEBvblNlbGVjdGlvbkNoYW5nZSA9IG51bGwKICAgICAgICBAc2VsZWN0ZWRDb2x1bW4gPSAwCiAgICAgICAgQHNlbGVjdGVkUm93ID0gMAogICAgICAgIEBzZWxlY3RlZENlbGwgPSBudWxsCiAgICAgICAgQGN1cnNvclZpc2libGUgPSB5ZXMKICAgICAgICAKICAgIGNvbnRlbnRzSGVpZ2h0OiAtPiBNYXRoLm1heChAcm93cy5sZW5ndGggKiBAY29sdW1uSGVpZ2h0LCBAaGVpZ2h0IC0gQHBhZGRpbmcqMikKICAgIGNvbnRlbnRzV2lkdGg6IC0+IE1hdGgubWF4KEBjb2x1bW5Db3VudCAqIEBjb2x1bW5XaWR0aCwgQHdpZHRoIC0gQHBhZGRpbmcqMikKICAgIAogICAgcmVkcmF3OiAtPgogICAgICAgIHZhbGlkYXRpb25SZXN1bHQgPSBubwogICAgICAgIAogICAgICAgIGlmIEBjb250ZW50cy53aWR0aCAhPSBAY29udGVudHNXaWR0aCgpIG9yIEBjb250ZW50cy5oZWlnaHQgIT0gQGNvbnRlbnRzSGVpZ2h0KCkKICAgICAgICAgICBmb250ID0gQGNvbnRlbnRzLmZvbnQKICAgICAgICAgICBAY29udGVudHMgPSBuZXcgQml0bWFwKEBjb250ZW50c1dpZHRoKCksIEBjb250ZW50c0hlaWdodCgpKQogICAgICAgICAgIEBjb250ZW50cy5mb250ID0gZm9udAogICAgICAgICAgIAogICAgICAgIEBjb250ZW50cy5jbGVhcigpCiAgICAgICAgZm9yIHkgaW4gWzAuLi5Acm93cy5sZW5ndGhdCiAgICAgICAgICAgIGZvciB4IGluIFswLi4uQGNvbHVtbkNvdW50XQogICAgICAgICAgICAgICAgaWYgQHJvd3NbeV0/IGFuZCBAcm93c1t5XVt4XT8KICAgICAgICAgICAgICAgICAgICB2YWxpZGF0aW9uUmVzdWx0ID0gQHZhbGlkYXRlQ2VsbCh4LCB5LCBAcm93c1t5XVt4XSkKICAgICAgICAgICAgICAgICAgICBAY29udGVudHMuZm9udC5jb2xvciA9IGlmIHZhbGlkYXRpb25SZXN1bHQgdGhlbiBDb2xvcnMuRU5BQkxFRF9JVEVNIGVsc2UgQ29sb3JzLkRJU0FCTEVEX0lURU0KICAgICAgICAgICAgICAgICAgICBAZHJhd0NlbGwoQGNvbHVtblNwYWNpbmcgKyB4ICogQGNvbHVtbldpZHRoLCB5ICogQGNvbHVtbkhlaWdodCwgQHJvd3NbeV1beF0sIHZhbGlkYXRpb25SZXN1bHQpCiAgICAKICAgIGRyYXdDZWxsOiAoeCwgeSwgY2VsbCwgZW5hYmxlZCkgLT4KICAgICAgICBAY29udGVudHMuZHJhd1RleHQoeCwgeSwgQGNvbHVtbldpZHRoLCBAY29sdW1uSGVpZ2h0LCBjZWxsLCBAdGV4dEFsaWdubWVudCkgICAgCiAgICAgICAgCiAgICB2YWxpZGF0ZUNlbGw6ICh4LCB5LCBjZWxsKSAtPiB5ZXMKICAgIHZhbGlkYXRlU2VsZWN0ZWRDZWxsOiAtPiBAdmFsaWRhdGVDZWxsKEBzZWxlY3RlZENvbHVtbiwgQHNlbGVjdGVkUm93LCBAc2VsZWN0ZWRDZWxsKQogICAgdXBkYXRlOiAtPgogICAgICAgIHN1cGVyKCkKICAgICAgICAKICAgICAgICBpZiBAY3Vyc29yVmlzaWJsZSBhbmQgQGN1cnNvclJlY3QuaGVpZ2h0ID09IDAKICAgICAgICAgICAgQGN1cnNvclJlY3QgPSBuZXcgUmVjdCgwLCAwLCBAY29sdW1uV2lkdGgsIEBjb2x1bW5IZWlnaHQpCiAgICAgICAgICAgIEBzZWxlY3RlZENlbGwgPSBudWxsCiAgICAgICAgICAgIEBzZWxlY3RlZFJvdyA9IDAKICAgICAgICAgICAgQHNlbGVjdGVkQ29sdW1uID0gMAogICAgICAgIGVsc2UgaWYgbm90IEBjdXJzb3JWaXNpYmxlIGFuZCBAY3Vyc29yUmVjdC5oZWlnaHQgPiAwCiAgICAgICAgICAgIEBjdXJzb3JSZWN0ID0gbmV3IFJlY3QoMCwgMCwgMCwgMCkKICAgICAgICAgICAgCiAgICAgICAgaWYgbm90IEBhY3RpdmUgdGhlbiByZXR1cm4KICAgICAgICAKICAgICAgICBAY3Vyc29yUmVjdC54ID0gQHNlbGVjdGVkQ29sdW1uICogQGNvbHVtbldpZHRoCiAgICAgICAgQGN1cnNvclJlY3QueSA9IEBzZWxlY3RlZFJvdyAqIEBjb2x1bW5IZWlnaHQKICAgICAgICAKICAgICAgICBvbGRYID0gQGN1cnNvclJlY3QueAogICAgICAgIG9sZFkgPSBAY3Vyc29yUmVjdC55CiAgICAgICAgCiAgICAgICAgaWYgSW5wdXQudHJpZ2dlcihJbnB1dC5MRUZUKQogICAgICAgICAgICBjZWxsID0gaWYgQHJvd3NbQHNlbGVjdGVkUm93XT8gdGhlbiBAcm93c1tAc2VsZWN0ZWRSb3ddW0BzZWxlY3RlZENvbHVtbi0xXSBlbHNlIG51bGwKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIGNlbGw/CiAgICAgICAgICAgICAgICBAY3Vyc29yUmVjdC54ID0gTWF0aC5tYXgoQGN1cnNvclJlY3QueCAtIEBjb2x1bW5XaWR0aCwgMCkgCiAgICAgICAgICAgICAgICBAc2VsZWN0ZWRSb3cgPSBNYXRoLmZsb29yKEBjdXJzb3JSZWN0LnkgLyBAY29sdW1uSGVpZ2h0KQogICAgICAgICAgICAgICAgQHNlbGVjdGVkQ29sdW1uID0gTWF0aC5mbG9vcihAY3Vyc29yUmVjdC54IC8gQGNvbHVtbldpZHRoKSAgIAogICAgICAgICAgICAgICAgQXVkaW9NYW5hZ2VyLnBsYXlTb3VuZChSZWNvcmRNYW5hZ2VyLnN5c3RlbS5tZW51Q3Vyc29yU291bmQubmFtZSkKICAgICAgICBpZiBJbnB1dC50cmlnZ2VyKElucHV0LlVQKQogICAgICAgICAgICBjZWxsID0gaWYgQHJvd3NbQHNlbGVjdGVkUm93LTFdPyB0aGVuIEByb3dzW0BzZWxlY3RlZFJvdy0xXVtAc2VsZWN0ZWRDb2x1bW5dIGVsc2UgbnVsbCAKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIGNlbGw/CiAgICAgICAgICAgICAgICBAY3Vyc29yUmVjdC55ID0gTWF0aC5tYXgoQGN1cnNvclJlY3QueSAtIEBjb2x1bW5IZWlnaHQsIDApIAogICAgICAgICAgICAgICAgQHNlbGVjdGVkUm93ID0gTWF0aC5mbG9vcihAY3Vyc29yUmVjdC55IC8gQGNvbHVtbkhlaWdodCkKICAgICAgICAgICAgICAgIEBzZWxlY3RlZENvbHVtbiA9IE1hdGguZmxvb3IoQGN1cnNvclJlY3QueCAvIEBjb2x1bW5XaWR0aCkgICAgCiAgICAgICAgICAgICAgICBBdWRpb01hbmFnZXIucGxheVNvdW5kKFJlY29yZE1hbmFnZXIuc3lzdGVtLm1lbnVDdXJzb3JTb3VuZC5uYW1lKQogICAgICAgIGlmIElucHV0LnRyaWdnZXIoSW5wdXQuUklHSFQpCiAgICAgICAgICAgIGNlbGwgPSBpZiBAcm93c1tAc2VsZWN0ZWRSb3ddPyB0aGVuIEByb3dzW0BzZWxlY3RlZFJvd11bQHNlbGVjdGVkQ29sdW1uKzFdIGVsc2UgbnVsbAogICAgICAgICAgICAKICAgICAgICAgICAgaWYgY2VsbD8KICAgICAgICAgICAgICAgIEBjdXJzb3JSZWN0LnggPSBNYXRoLm1heChAY3Vyc29yUmVjdC54ICsgQGNvbHVtbldpZHRoLCAwKSAKICAgICAgICAgICAgICAgIEBzZWxlY3RlZFJvdyA9IE1hdGguZmxvb3IoQGN1cnNvclJlY3QueSAvIEBjb2x1bW5IZWlnaHQpCiAgICAgICAgICAgICAgICBAc2VsZWN0ZWRDb2x1bW4gPSBNYXRoLmZsb29yKEBjdXJzb3JSZWN0LnggLyBAY29sdW1uV2lkdGgpICAgICAgICAgCiAgICAgICAgICAgICAgICBBdWRpb01hbmFnZXIucGxheVNvdW5kKFJlY29yZE1hbmFnZXIuc3lzdGVtLm1lbnVDdXJzb3JTb3VuZC5uYW1lKQogICAgICAgIGlmIElucHV0LnRyaWdnZXIoSW5wdXQuRE9XTikKICAgICAgICAgICAgY2VsbCA9IGlmIEByb3dzW0BzZWxlY3RlZFJvdysxXT8gdGhlbiBAcm93c1tAc2VsZWN0ZWRSb3crMV1bQHNlbGVjdGVkQ29sdW1uXSBlbHNlIG51bGwgCiAgICAgICAgICAgIAogICAgICAgICAgICBpZiBjZWxsPwogICAgICAgICAgICAgICAgQGN1cnNvclJlY3QueSA9IE1hdGgubWluKEBjdXJzb3JSZWN0LnkgKyBAY29sdW1uSGVpZ2h0LCBAY29udGVudHMuaGVpZ2h0IC0gQGNvbHVtbkhlaWdodCkgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgQHNlbGVjdGVkUm93ID0gTWF0aC5mbG9vcihAY3Vyc29yUmVjdC55IC8gQGNvbHVtbkhlaWdodCkKICAgICAgICAgICAgICAgIEBzZWxlY3RlZENvbHVtbiA9IE1hdGguZmxvb3IoQGN1cnNvclJlY3QueCAvIEBjb2x1bW5XaWR0aCkKICAgICAgICAgICAgICAgIEF1ZGlvTWFuYWdlci5wbGF5U291bmQoUmVjb3JkTWFuYWdlci5zeXN0ZW0ubWVudUN1cnNvclNvdW5kLm5hbWUpCiAgICAgICAgaWYgSW5wdXQudHJpZ2dlcihJbnB1dC5DKSBhbmQgQG9uU2VsZWN0aW9uQWNjZXB0PwogICAgICAgICAgICBJbnB1dC5jbGVhcigpCiAgICAgICAgICAgIGlmIEBzZWxlY3RlZENlbGw/IGFuZCBAdmFsaWRhdGVDZWxsKEBzZWxlY3RlZENvbHVtbiwgQHNlbGVjdGVkUm93LCBAc2VsZWN0ZWRDZWxsKQogICAgICAgICAgICAgICAgQXVkaW9NYW5hZ2VyLnBsYXlTb3VuZChSZWNvcmRNYW5hZ2VyLnN5c3RlbS5tZW51U2VsZWN0U291bmQubmFtZSkKICAgICAgICAgICAgICAgIEBvblNlbGVjdGlvbkFjY2VwdCh0aGlzLCBAc2VsZWN0ZWRDZWxsKQogICAgICAgICAgICAKICAgICAgICBpZiBJbnB1dC50cmlnZ2VyKElucHV0LkIpIGFuZCBAb25DYW5jZWw/CiAgICAgICAgICAgIElucHV0LmNsZWFyKCkKICAgICAgICAgICAgQG9uQ2FuY2VsKHRoaXMpICAgICAgIAogICAgICAgIAogICAgICAgIGlmIEBjdXJzb3JSZWN0LnkgLSBAb3kgKyBAY29sdW1uSGVpZ2h0ID4gKEBoZWlnaHQgLSBAcGFkZGluZyoyKQogICAgICAgICAgICBAb3kgPSBNYXRoLm1heCgoQGN1cnNvclJlY3QueSArIEBjb2x1bW5IZWlnaHQpIC0gKEBoZWlnaHQtQHBhZGRpbmcqMi0yKSwgMCkKICAgICAgICAgICAgCiAgICAgICAgaWYgQGN1cnNvclJlY3QueSAtIEBveSA8IDAKICAgICAgICAgICAgQG95ID0gTWF0aC5tYXgoQG95IC0gQGNvbHVtbkhlaWdodCwgMCkKICAgICAgICAgICAgCiAgICAgICAgaWYgQGN1cnNvclJlY3QueCAtIEBveCArIEBjb2x1bW5XaWR0aCA+IChAd2lkdGggLSBAcGFkZGluZyoyKQogICAgICAgICAgICBAb3ggPSBNYXRoLm1heCgoQGN1cnNvclJlY3QueCArIEBjb2x1bW5XaWR0aCkgLSAoQHdpZHRoIC0gQHBhZGRpbmcqMi0yKSwgMCkKICAgICAgICAgICAgCiAgICAgICAgaWYgQGN1cnNvclJlY3QueCAtIEBveCA8IDAKICAgICAgICAgICAgQG94ID0gTWF0aC5tYXgoQG94IC0gQGNvbHVtbldpZHRoLCAwKQogICAgICAgICAgICAKICAgICAgICBjZWxsID0gaWYgQHJvd3NbQHNlbGVjdGVkUm93XT8gdGhlbiBAcm93c1tAc2VsZWN0ZWRSb3ddW0BzZWxlY3RlZENvbHVtbl0gZWxzZSBudWxsIAogICAgICAgIGlmIEBzZWxlY3RlZENlbGwgIT0gY2VsbAogICAgICAgICAgICBAc2VsZWN0ZWRDZWxsID0gY2VsbAogICAgICAgICAgICBpZiBAb25TZWxlY3Rpb25DaGFuZ2U/IGFuZCBAYWN0aXZlIHRoZW4gQG9uU2VsZWN0aW9uQ2hhbmdlKHRoaXMsIEBzZWxlY3RlZENlbGwpCiAgICAgICAgCndpbmRvdy5XaW5kb3dfU2VsZWN0aW9uID0gV2luZG93X1NlbGVjdGlvbg==","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBXaW5kb3dfU2VsZWN0aW9uLAogICAgX19oYXNQcm9wID0ge30uaGFzT3duUHJvcGVydHksCiAgICBfX2V4dGVuZHMgPSBmdW5jdGlvbihjaGlsZCwgcGFyZW50KSB7IGZvciAodmFyIGtleSBpbiBwYXJlbnQpIHsgaWYgKF9faGFzUHJvcC5jYWxsKHBhcmVudCwga2V5KSkgY2hpbGRba2V5XSA9IHBhcmVudFtrZXldOyB9IGZ1bmN0aW9uIGN0b3IoKSB7IHRoaXMuY29uc3RydWN0b3IgPSBjaGlsZDsgfSBjdG9yLnByb3RvdHlwZSA9IHBhcmVudC5wcm90b3R5cGU7IGNoaWxkLnByb3RvdHlwZSA9IG5ldyBjdG9yKCk7IGNoaWxkLl9fc3VwZXJfXyA9IHBhcmVudC5wcm90b3R5cGU7IHJldHVybiBjaGlsZDsgfTsKCiAgV2luZG93X1NlbGVjdGlvbiA9IChmdW5jdGlvbihfc3VwZXIpIHsKICAgIF9fZXh0ZW5kcyhXaW5kb3dfU2VsZWN0aW9uLCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFdpbmRvd19TZWxlY3Rpb24oeCwgeSwgY29sdW1uQ291bnQsIHJvd3MsIGNvbHVtbldpZHRoLCBjb2x1bW5IZWlnaHQsIHZpZXdwb3J0KSB7CiAgICAgIHRoaXMuY29sdW1uV2lkdGggPSBjb2x1bW5XaWR0aCB8fCAyMDAgKiBXaW5kb3dfQmFzZS5zY2FsZTsKICAgICAgdGhpcy5jb2x1bW5IZWlnaHQgPSBjb2x1bW5IZWlnaHQgfHwgMzIgKiBXaW5kb3dfQmFzZS5zY2FsZTsKICAgICAgV2luZG93X1NlbGVjdGlvbi5fX3N1cGVyX18uY29uc3RydWN0b3IuY2FsbCh0aGlzLCB4LCB5LCBjb2x1bW5Db3VudCAqIHRoaXMuY29sdW1uV2lkdGggKyBXaW5kb3cucGFkZGluZyAqIDIsIE1hdGgubWF4KHJvd3MubGVuZ3RoLCAxKSAqIHRoaXMuY29sdW1uSGVpZ2h0ICsgV2luZG93LnBhZGRpbmcgKiAyLCB2aWV3cG9ydCk7CiAgICAgIHRoaXMuY29sdW1uQ291bnQgPSBjb2x1bW5Db3VudDsKICAgICAgdGhpcy5jb2x1bW5TcGFjaW5nID0gMTAgKiBXaW5kb3dfQmFzZS5zY2FsZTsKICAgICAgdGhpcy5yb3dzID0gcm93czsKICAgICAgdGhpcy5jdXJzb3JSZWN0ID0gbmV3IFJlY3QoMCwgMCwgdGhpcy5jb2x1bW5XaWR0aCwgdGhpcy5jb2x1bW5IZWlnaHQpOwogICAgICB0aGlzLmNvbnRlbnRzID0gbmV3IEJpdG1hcCh0aGlzLmNvbHVtbkNvdW50ICogdGhpcy5jb2x1bW5XaWR0aCwgTWF0aC5tYXgodGhpcy5yb3dzLmxlbmd0aCwgMSkgKiB0aGlzLmNvbHVtbkhlaWdodCk7CiAgICAgIHRoaXMudGV4dEFsaWdtZW50ID0gMTsKICAgICAgdGhpcy5jb250ZW50cy5mb250ID0gdGhpcy5hY3Rpb25Gb250OwogICAgICB0aGlzLm9uU2VsZWN0aW9uQ2hhbmdlID0gbnVsbDsKICAgICAgdGhpcy5zZWxlY3RlZENvbHVtbiA9IDA7CiAgICAgIHRoaXMuc2VsZWN0ZWRSb3cgPSAwOwogICAgICB0aGlzLnNlbGVjdGVkQ2VsbCA9IG51bGw7CiAgICAgIHRoaXMuY3Vyc29yVmlzaWJsZSA9IHRydWU7CiAgICB9CgogICAgV2luZG93X1NlbGVjdGlvbi5wcm90b3R5cGUuY29udGVudHNIZWlnaHQgPSBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIE1hdGgubWF4KHRoaXMucm93cy5sZW5ndGggKiB0aGlzLmNvbHVtbkhlaWdodCwgdGhpcy5oZWlnaHQgLSB0aGlzLnBhZGRpbmcgKiAyKTsKICAgIH07CgogICAgV2luZG93X1NlbGVjdGlvbi5wcm90b3R5cGUuY29udGVudHNXaWR0aCA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gTWF0aC5tYXgodGhpcy5jb2x1bW5Db3VudCAqIHRoaXMuY29sdW1uV2lkdGgsIHRoaXMud2lkdGggLSB0aGlzLnBhZGRpbmcgKiAyKTsKICAgIH07CgogICAgV2luZG93X1NlbGVjdGlvbi5wcm90b3R5cGUucmVkcmF3ID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBmb250LCB2YWxpZGF0aW9uUmVzdWx0LCB4LCB5LCBfaSwgX3JlZiwgX3Jlc3VsdHM7CiAgICAgIHZhbGlkYXRpb25SZXN1bHQgPSBmYWxzZTsKICAgICAgaWYgKHRoaXMuY29udGVudHMud2lkdGggIT09IHRoaXMuY29udGVudHNXaWR0aCgpIHx8IHRoaXMuY29udGVudHMuaGVpZ2h0ICE9PSB0aGlzLmNvbnRlbnRzSGVpZ2h0KCkpIHsKICAgICAgICBmb250ID0gdGhpcy5jb250ZW50cy5mb250OwogICAgICAgIHRoaXMuY29udGVudHMgPSBuZXcgQml0bWFwKHRoaXMuY29udGVudHNXaWR0aCgpLCB0aGlzLmNvbnRlbnRzSGVpZ2h0KCkpOwogICAgICAgIHRoaXMuY29udGVudHMuZm9udCA9IGZvbnQ7CiAgICAgIH0KICAgICAgdGhpcy5jb250ZW50cy5jbGVhcigpOwogICAgICBfcmVzdWx0cyA9IFtdOwogICAgICBmb3IgKHkgPSBfaSA9IDAsIF9yZWYgPSB0aGlzLnJvd3MubGVuZ3RoOyAwIDw9IF9yZWYgPyBfaSA8IF9yZWYgOiBfaSA+IF9yZWY7IHkgPSAwIDw9IF9yZWYgPyArK19pIDogLS1faSkgewogICAgICAgIF9yZXN1bHRzLnB1c2goKGZ1bmN0aW9uKCkgewogICAgICAgICAgdmFyIF9qLCBfcmVmMSwgX3Jlc3VsdHMxOwogICAgICAgICAgX3Jlc3VsdHMxID0gW107CiAgICAgICAgICBmb3IgKHggPSBfaiA9IDAsIF9yZWYxID0gdGhpcy5jb2x1bW5Db3VudDsgMCA8PSBfcmVmMSA/IF9qIDwgX3JlZjEgOiBfaiA+IF9yZWYxOyB4ID0gMCA8PSBfcmVmMSA/ICsrX2ogOiAtLV9qKSB7CiAgICAgICAgICAgIGlmICgodGhpcy5yb3dzW3ldICE9IG51bGwpICYmICh0aGlzLnJvd3NbeV1beF0gIT0gbnVsbCkpIHsKICAgICAgICAgICAgICB2YWxpZGF0aW9uUmVzdWx0ID0gdGhpcy52YWxpZGF0ZUNlbGwoeCwgeSwgdGhpcy5yb3dzW3ldW3hdKTsKICAgICAgICAgICAgICB0aGlzLmNvbnRlbnRzLmZvbnQuY29sb3IgPSB2YWxpZGF0aW9uUmVzdWx0ID8gQ29sb3JzLkVOQUJMRURfSVRFTSA6IENvbG9ycy5ESVNBQkxFRF9JVEVNOwogICAgICAgICAgICAgIF9yZXN1bHRzMS5wdXNoKHRoaXMuZHJhd0NlbGwodGhpcy5jb2x1bW5TcGFjaW5nICsgeCAqIHRoaXMuY29sdW1uV2lkdGgsIHkgKiB0aGlzLmNvbHVtbkhlaWdodCwgdGhpcy5yb3dzW3ldW3hdLCB2YWxpZGF0aW9uUmVzdWx0KSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgX3Jlc3VsdHMxLnB1c2godm9pZCAwKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuIF9yZXN1bHRzMTsKICAgICAgICB9KS5jYWxsKHRoaXMpKTsKICAgICAgfQogICAgICByZXR1cm4gX3Jlc3VsdHM7CiAgICB9OwoKICAgIFdpbmRvd19TZWxlY3Rpb24ucHJvdG90eXBlLmRyYXdDZWxsID0gZnVuY3Rpb24oeCwgeSwgY2VsbCwgZW5hYmxlZCkgewogICAgICByZXR1cm4gdGhpcy5jb250ZW50cy5kcmF3VGV4dCh4LCB5LCB0aGlzLmNvbHVtbldpZHRoLCB0aGlzLmNvbHVtbkhlaWdodCwgY2VsbCwgdGhpcy50ZXh0QWxpZ25tZW50KTsKICAgIH07CgogICAgV2luZG93X1NlbGVjdGlvbi5wcm90b3R5cGUudmFsaWRhdGVDZWxsID0gZnVuY3Rpb24oeCwgeSwgY2VsbCkgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH07CgogICAgV2luZG93X1NlbGVjdGlvbi5wcm90b3R5cGUudmFsaWRhdGVTZWxlY3RlZENlbGwgPSBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIHRoaXMudmFsaWRhdGVDZWxsKHRoaXMuc2VsZWN0ZWRDb2x1bW4sIHRoaXMuc2VsZWN0ZWRSb3csIHRoaXMuc2VsZWN0ZWRDZWxsKTsKICAgIH07CgogICAgV2luZG93X1NlbGVjdGlvbi5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBjZWxsLCBvbGRYLCBvbGRZOwogICAgICBXaW5kb3dfU2VsZWN0aW9uLl9fc3VwZXJfXy51cGRhdGUuY2FsbCh0aGlzKTsKICAgICAgaWYgKHRoaXMuY3Vyc29yVmlzaWJsZSAmJiB0aGlzLmN1cnNvclJlY3QuaGVpZ2h0ID09PSAwKSB7CiAgICAgICAgdGhpcy5jdXJzb3JSZWN0ID0gbmV3IFJlY3QoMCwgMCwgdGhpcy5jb2x1bW5XaWR0aCwgdGhpcy5jb2x1bW5IZWlnaHQpOwogICAgICAgIHRoaXMuc2VsZWN0ZWRDZWxsID0gbnVsbDsKICAgICAgICB0aGlzLnNlbGVjdGVkUm93ID0gMDsKICAgICAgICB0aGlzLnNlbGVjdGVkQ29sdW1uID0gMDsKICAgICAgfSBlbHNlIGlmICghdGhpcy5jdXJzb3JWaXNpYmxlICYmIHRoaXMuY3Vyc29yUmVjdC5oZWlnaHQgPiAwKSB7CiAgICAgICAgdGhpcy5jdXJzb3JSZWN0ID0gbmV3IFJlY3QoMCwgMCwgMCwgMCk7CiAgICAgIH0KICAgICAgaWYgKCF0aGlzLmFjdGl2ZSkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICB0aGlzLmN1cnNvclJlY3QueCA9IHRoaXMuc2VsZWN0ZWRDb2x1bW4gKiB0aGlzLmNvbHVtbldpZHRoOwogICAgICB0aGlzLmN1cnNvclJlY3QueSA9IHRoaXMuc2VsZWN0ZWRSb3cgKiB0aGlzLmNvbHVtbkhlaWdodDsKICAgICAgb2xkWCA9IHRoaXMuY3Vyc29yUmVjdC54OwogICAgICBvbGRZID0gdGhpcy5jdXJzb3JSZWN0Lnk7CiAgICAgIGlmIChJbnB1dC50cmlnZ2VyKElucHV0LkxFRlQpKSB7CiAgICAgICAgY2VsbCA9IHRoaXMucm93c1t0aGlzLnNlbGVjdGVkUm93XSAhPSBudWxsID8gdGhpcy5yb3dzW3RoaXMuc2VsZWN0ZWRSb3ddW3RoaXMuc2VsZWN0ZWRDb2x1bW4gLSAxXSA6IG51bGw7CiAgICAgICAgaWYgKGNlbGwgIT0gbnVsbCkgewogICAgICAgICAgdGhpcy5jdXJzb3JSZWN0LnggPSBNYXRoLm1heCh0aGlzLmN1cnNvclJlY3QueCAtIHRoaXMuY29sdW1uV2lkdGgsIDApOwogICAgICAgICAgdGhpcy5zZWxlY3RlZFJvdyA9IE1hdGguZmxvb3IodGhpcy5jdXJzb3JSZWN0LnkgLyB0aGlzLmNvbHVtbkhlaWdodCk7CiAgICAgICAgICB0aGlzLnNlbGVjdGVkQ29sdW1uID0gTWF0aC5mbG9vcih0aGlzLmN1cnNvclJlY3QueCAvIHRoaXMuY29sdW1uV2lkdGgpOwogICAgICAgICAgQXVkaW9NYW5hZ2VyLnBsYXlTb3VuZChSZWNvcmRNYW5hZ2VyLnN5c3RlbS5tZW51Q3Vyc29yU291bmQubmFtZSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmIChJbnB1dC50cmlnZ2VyKElucHV0LlVQKSkgewogICAgICAgIGNlbGwgPSB0aGlzLnJvd3NbdGhpcy5zZWxlY3RlZFJvdyAtIDFdICE9IG51bGwgPyB0aGlzLnJvd3NbdGhpcy5zZWxlY3RlZFJvdyAtIDFdW3RoaXMuc2VsZWN0ZWRDb2x1bW5dIDogbnVsbDsKICAgICAgICBpZiAoY2VsbCAhPSBudWxsKSB7CiAgICAgICAgICB0aGlzLmN1cnNvclJlY3QueSA9IE1hdGgubWF4KHRoaXMuY3Vyc29yUmVjdC55IC0gdGhpcy5jb2x1bW5IZWlnaHQsIDApOwogICAgICAgICAgdGhpcy5zZWxlY3RlZFJvdyA9IE1hdGguZmxvb3IodGhpcy5jdXJzb3JSZWN0LnkgLyB0aGlzLmNvbHVtbkhlaWdodCk7CiAgICAgICAgICB0aGlzLnNlbGVjdGVkQ29sdW1uID0gTWF0aC5mbG9vcih0aGlzLmN1cnNvclJlY3QueCAvIHRoaXMuY29sdW1uV2lkdGgpOwogICAgICAgICAgQXVkaW9NYW5hZ2VyLnBsYXlTb3VuZChSZWNvcmRNYW5hZ2VyLnN5c3RlbS5tZW51Q3Vyc29yU291bmQubmFtZSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmIChJbnB1dC50cmlnZ2VyKElucHV0LlJJR0hUKSkgewogICAgICAgIGNlbGwgPSB0aGlzLnJvd3NbdGhpcy5zZWxlY3RlZFJvd10gIT0gbnVsbCA/IHRoaXMucm93c1t0aGlzLnNlbGVjdGVkUm93XVt0aGlzLnNlbGVjdGVkQ29sdW1uICsgMV0gOiBudWxsOwogICAgICAgIGlmIChjZWxsICE9IG51bGwpIHsKICAgICAgICAgIHRoaXMuY3Vyc29yUmVjdC54ID0gTWF0aC5tYXgodGhpcy5jdXJzb3JSZWN0LnggKyB0aGlzLmNvbHVtbldpZHRoLCAwKTsKICAgICAgICAgIHRoaXMuc2VsZWN0ZWRSb3cgPSBNYXRoLmZsb29yKHRoaXMuY3Vyc29yUmVjdC55IC8gdGhpcy5jb2x1bW5IZWlnaHQpOwogICAgICAgICAgdGhpcy5zZWxlY3RlZENvbHVtbiA9IE1hdGguZmxvb3IodGhpcy5jdXJzb3JSZWN0LnggLyB0aGlzLmNvbHVtbldpZHRoKTsKICAgICAgICAgIEF1ZGlvTWFuYWdlci5wbGF5U291bmQoUmVjb3JkTWFuYWdlci5zeXN0ZW0ubWVudUN1cnNvclNvdW5kLm5hbWUpOwogICAgICAgIH0KICAgICAgfQogICAgICBpZiAoSW5wdXQudHJpZ2dlcihJbnB1dC5ET1dOKSkgewogICAgICAgIGNlbGwgPSB0aGlzLnJvd3NbdGhpcy5zZWxlY3RlZFJvdyArIDFdICE9IG51bGwgPyB0aGlzLnJvd3NbdGhpcy5zZWxlY3RlZFJvdyArIDFdW3RoaXMuc2VsZWN0ZWRDb2x1bW5dIDogbnVsbDsKICAgICAgICBpZiAoY2VsbCAhPSBudWxsKSB7CiAgICAgICAgICB0aGlzLmN1cnNvclJlY3QueSA9IE1hdGgubWluKHRoaXMuY3Vyc29yUmVjdC55ICsgdGhpcy5jb2x1bW5IZWlnaHQsIHRoaXMuY29udGVudHMuaGVpZ2h0IC0gdGhpcy5jb2x1bW5IZWlnaHQpOwogICAgICAgICAgdGhpcy5zZWxlY3RlZFJvdyA9IE1hdGguZmxvb3IodGhpcy5jdXJzb3JSZWN0LnkgLyB0aGlzLmNvbHVtbkhlaWdodCk7CiAgICAgICAgICB0aGlzLnNlbGVjdGVkQ29sdW1uID0gTWF0aC5mbG9vcih0aGlzLmN1cnNvclJlY3QueCAvIHRoaXMuY29sdW1uV2lkdGgpOwogICAgICAgICAgQXVkaW9NYW5hZ2VyLnBsYXlTb3VuZChSZWNvcmRNYW5hZ2VyLnN5c3RlbS5tZW51Q3Vyc29yU291bmQubmFtZSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmIChJbnB1dC50cmlnZ2VyKElucHV0LkMpICYmICh0aGlzLm9uU2VsZWN0aW9uQWNjZXB0ICE9IG51bGwpKSB7CiAgICAgICAgSW5wdXQuY2xlYXIoKTsKICAgICAgICBpZiAoKHRoaXMuc2VsZWN0ZWRDZWxsICE9IG51bGwpICYmIHRoaXMudmFsaWRhdGVDZWxsKHRoaXMuc2VsZWN0ZWRDb2x1bW4sIHRoaXMuc2VsZWN0ZWRSb3csIHRoaXMuc2VsZWN0ZWRDZWxsKSkgewogICAgICAgICAgQXVkaW9NYW5hZ2VyLnBsYXlTb3VuZChSZWNvcmRNYW5hZ2VyLnN5c3RlbS5tZW51U2VsZWN0U291bmQubmFtZSk7CiAgICAgICAgICB0aGlzLm9uU2VsZWN0aW9uQWNjZXB0KHRoaXMsIHRoaXMuc2VsZWN0ZWRDZWxsKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKElucHV0LnRyaWdnZXIoSW5wdXQuQikgJiYgKHRoaXMub25DYW5jZWwgIT0gbnVsbCkpIHsKICAgICAgICBJbnB1dC5jbGVhcigpOwogICAgICAgIHRoaXMub25DYW5jZWwodGhpcyk7CiAgICAgIH0KICAgICAgaWYgKHRoaXMuY3Vyc29yUmVjdC55IC0gdGhpcy5veSArIHRoaXMuY29sdW1uSGVpZ2h0ID4gKHRoaXMuaGVpZ2h0IC0gdGhpcy5wYWRkaW5nICogMikpIHsKICAgICAgICB0aGlzLm95ID0gTWF0aC5tYXgoKHRoaXMuY3Vyc29yUmVjdC55ICsgdGhpcy5jb2x1bW5IZWlnaHQpIC0gKHRoaXMuaGVpZ2h0IC0gdGhpcy5wYWRkaW5nICogMiAtIDIpLCAwKTsKICAgICAgfQogICAgICBpZiAodGhpcy5jdXJzb3JSZWN0LnkgLSB0aGlzLm95IDwgMCkgewogICAgICAgIHRoaXMub3kgPSBNYXRoLm1heCh0aGlzLm95IC0gdGhpcy5jb2x1bW5IZWlnaHQsIDApOwogICAgICB9CiAgICAgIGlmICh0aGlzLmN1cnNvclJlY3QueCAtIHRoaXMub3ggKyB0aGlzLmNvbHVtbldpZHRoID4gKHRoaXMud2lkdGggLSB0aGlzLnBhZGRpbmcgKiAyKSkgewogICAgICAgIHRoaXMub3ggPSBNYXRoLm1heCgodGhpcy5jdXJzb3JSZWN0LnggKyB0aGlzLmNvbHVtbldpZHRoKSAtICh0aGlzLndpZHRoIC0gdGhpcy5wYWRkaW5nICogMiAtIDIpLCAwKTsKICAgICAgfQogICAgICBpZiAodGhpcy5jdXJzb3JSZWN0LnggLSB0aGlzLm94IDwgMCkgewogICAgICAgIHRoaXMub3ggPSBNYXRoLm1heCh0aGlzLm94IC0gdGhpcy5jb2x1bW5XaWR0aCwgMCk7CiAgICAgIH0KICAgICAgY2VsbCA9IHRoaXMucm93c1t0aGlzLnNlbGVjdGVkUm93XSAhPSBudWxsID8gdGhpcy5yb3dzW3RoaXMuc2VsZWN0ZWRSb3ddW3RoaXMuc2VsZWN0ZWRDb2x1bW5dIDogbnVsbDsKICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRDZWxsICE9PSBjZWxsKSB7CiAgICAgICAgdGhpcy5zZWxlY3RlZENlbGwgPSBjZWxsOwogICAgICAgIGlmICgodGhpcy5vblNlbGVjdGlvbkNoYW5nZSAhPSBudWxsKSAmJiB0aGlzLmFjdGl2ZSkgewogICAgICAgICAgcmV0dXJuIHRoaXMub25TZWxlY3Rpb25DaGFuZ2UodGhpcywgdGhpcy5zZWxlY3RlZENlbGwpOwogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICByZXR1cm4gV2luZG93X1NlbGVjdGlvbjsKCiAgfSkoV2luZG93X0Jhc2UpOwoKICB3aW5kb3cuV2luZG93X1NlbGVjdGlvbiA9IFdpbmRvd19TZWxlY3Rpb247Cgp9KS5jYWxsKHRoaXMpOwo="},{"name":"Window_Choice","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogV2luZG93X0Nob2ljZQojICAgQ3JlYXRlZCBvbjogMjAxMy0xMi0wMgojCiMgICBDb3B5cmlnaHQgKEMpIDIwMTMgQW5kcukgUmFkb21za2kuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIENsYXNzOiBXaW5kb3dfQ2hvaWNlCiMKIyAgIEEgd2luZG93IHdoZXJlIHRoZSB1c2VyIGNhbiBpbnB1dCBhIG51bWJlci4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCmNsYXNzIFdpbmRvd19DaG9pY2UgZXh0ZW5kcyBXaW5kb3dfU2VsZWN0aW9uICAgIAogICAgY29uc3RydWN0b3I6IChjaG9pY2VzLCB4LCB5KSAtPgogICAgICAgIHJvd3MgPSBbXQogICAgICAgIGZvciBjaG9pY2UgaW4gY2hvaWNlcwogICAgICAgICAgICBpZiBjaG9pY2UudGV4dC5sZW5ndGggPiAwIHRoZW4gcm93cy5wdXNoKFtjaG9pY2VdKQogICAgICAgICAgICAKICAgICAgICB4ID0gaWYgeD8gdGhlbiB4IGVsc2UgKEdyYXBoaWNzLndpZHRoIC0gMjI0KSAvIDIKICAgICAgICB5ID0gaWYgeT8gdGhlbiB5IGVsc2UgKEdyYXBoaWNzLmhlaWdodCAtIHJvd3MubGVuZ3RoICogMzIpIC8gMgogICAgICAgIAogICAgICAgIHN1cGVyKHgsIHksIDEsIHJvd3MpCiAKICAgICAgICBAeiA9IDUwMAogICAgICAgIAogICAgZHJhd0NlbGw6ICh4LCB5LCBjZWxsKSAtPgogICAgICAgIEBjb250ZW50cy5kcmF3VGV4dCh4LCB5LCBAY29sdW1uV2lkdGgsIEBjb2x1bW5IZWlnaHQsIGNlbGwudGV4dCwgQHRleHRBbGlnbm1lbnQpICAgIAogICAgICAgIAogICAgb3BlbjogLT4KICAgICAgICBzdXBlcigpCiAgICAgICAgQHJlZHJhdygpCgogICAgICAgIAp3aW5kb3cuV2luZG93X0Nob2ljZSA9IFdpbmRvd19DaG9pY2U=","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBXaW5kb3dfQ2hvaWNlLAogICAgX19oYXNQcm9wID0ge30uaGFzT3duUHJvcGVydHksCiAgICBfX2V4dGVuZHMgPSBmdW5jdGlvbihjaGlsZCwgcGFyZW50KSB7IGZvciAodmFyIGtleSBpbiBwYXJlbnQpIHsgaWYgKF9faGFzUHJvcC5jYWxsKHBhcmVudCwga2V5KSkgY2hpbGRba2V5XSA9IHBhcmVudFtrZXldOyB9IGZ1bmN0aW9uIGN0b3IoKSB7IHRoaXMuY29uc3RydWN0b3IgPSBjaGlsZDsgfSBjdG9yLnByb3RvdHlwZSA9IHBhcmVudC5wcm90b3R5cGU7IGNoaWxkLnByb3RvdHlwZSA9IG5ldyBjdG9yKCk7IGNoaWxkLl9fc3VwZXJfXyA9IHBhcmVudC5wcm90b3R5cGU7IHJldHVybiBjaGlsZDsgfTsKCiAgV2luZG93X0Nob2ljZSA9IChmdW5jdGlvbihfc3VwZXIpIHsKICAgIF9fZXh0ZW5kcyhXaW5kb3dfQ2hvaWNlLCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFdpbmRvd19DaG9pY2UoY2hvaWNlcywgeCwgeSkgewogICAgICB2YXIgY2hvaWNlLCByb3dzLCBfaSwgX2xlbjsKICAgICAgcm93cyA9IFtdOwogICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IGNob2ljZXMubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICBjaG9pY2UgPSBjaG9pY2VzW19pXTsKICAgICAgICBpZiAoY2hvaWNlLnRleHQubGVuZ3RoID4gMCkgewogICAgICAgICAgcm93cy5wdXNoKFtjaG9pY2VdKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgeCA9IHggIT0gbnVsbCA/IHggOiAoR3JhcGhpY3Mud2lkdGggLSAyMjQpIC8gMjsKICAgICAgeSA9IHkgIT0gbnVsbCA/IHkgOiAoR3JhcGhpY3MuaGVpZ2h0IC0gcm93cy5sZW5ndGggKiAzMikgLyAyOwogICAgICBXaW5kb3dfQ2hvaWNlLl9fc3VwZXJfXy5jb25zdHJ1Y3Rvci5jYWxsKHRoaXMsIHgsIHksIDEsIHJvd3MpOwogICAgICB0aGlzLnogPSA1MDA7CiAgICB9CgogICAgV2luZG93X0Nob2ljZS5wcm90b3R5cGUuZHJhd0NlbGwgPSBmdW5jdGlvbih4LCB5LCBjZWxsKSB7CiAgICAgIHJldHVybiB0aGlzLmNvbnRlbnRzLmRyYXdUZXh0KHgsIHksIHRoaXMuY29sdW1uV2lkdGgsIHRoaXMuY29sdW1uSGVpZ2h0LCBjZWxsLnRleHQsIHRoaXMudGV4dEFsaWdubWVudCk7CiAgICB9OwoKICAgIFdpbmRvd19DaG9pY2UucHJvdG90eXBlLm9wZW4gPSBmdW5jdGlvbigpIHsKICAgICAgV2luZG93X0Nob2ljZS5fX3N1cGVyX18ub3Blbi5jYWxsKHRoaXMpOwogICAgICByZXR1cm4gdGhpcy5yZWRyYXcoKTsKICAgIH07CgogICAgcmV0dXJuIFdpbmRvd19DaG9pY2U7CgogIH0pKFdpbmRvd19TZWxlY3Rpb24pOwoKICB3aW5kb3cuV2luZG93X0Nob2ljZSA9IFdpbmRvd19DaG9pY2U7Cgp9KS5jYWxsKHRoaXMpOwo="},{"name":"Window_Message","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogV2luZG93X01lc3NhZ2UKIyAgIENyZWF0ZWQgb246IDIwMTMtMDktMTQKIwojICAgQ29weXJpZ2h0IChDKSAyMDEzIEFuZHLpIFJhZG9tc2tpLiBBbGwgcmlnaHRzIHJlc2VydmVkLgojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQojCiMgICAgIENsYXNzOiBXaW5kb3dfTWVzc2FnZQojCiMgICBBIHdpbmRvdyB3aGljaCBkaXNwbGF5cyBtZXNzYWdlcwojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKY2xhc3MgV2luZG93X01lc3NhZ2UgZXh0ZW5kcyBXaW5kb3dfQmFzZQogICAgQE1PREVfQlVCQkxFID0gMQogICAgQE1PREVfRlVMTFNJWkVfV0lORE9XID0gMAogICAgQFBPU0lUSU9OX0JPVFRPTSA9IDAKICAgIEBQT1NJVElPTl9NSURETEUgPSAxCiAgICBAUE9TSVRJT05fVE9QID0gMgogICAgCiAgICBjb25zdHJ1Y3RvcjogLT4KICAgICAgICBzdXBlcigwLCAwLCBHcmFwaGljcy53aWR0aCwgTWF0aC5mbG9vcihHcmFwaGljcy5oZWlnaHQgLyAzLjUpKQogICAgICAgIEB5ID0gR3JhcGhpY3MuaGVpZ2h0IC0gQGhlaWdodAogICAgICAgIEB2aXNpYmxlID0gbm8KICAgICAgICBAbWVzc2FnZSA9ICIiCiAgICAgICAgQGxpbmVzID0gbnVsbAogICAgICAgIEBsaW5lID0gMAogICAgICAgIEBsaW5lVGV4dCA9ICIiCiAgICAgICAgQGNoYXJJbmRleCA9IDAKICAgICAgICBAeiA9IDUwMDAKICAgICAgICBAY29udGVudHMgPSBuZXcgQml0bWFwKEB3aWR0aCAtIEBwYWRkaW5nKjIsIEBoZWlnaHQgLSBAcGFkZGluZyoyKQogICAgICAgIEBjb250ZW50cy5mb250LnNoYWRvdyA9IHllcyAKICAgICAgICBAaXNSdW5uaW5nID0gbm8KICAgICAgICBAbGluZUlzRHJhd2luZyA9IG5vCiAgICAgICAgQGFuaW1hdGlvbkNvdW50ID0gNjAKICAgICAgICBAZmFjZUdyYXBoaWMgPSBudWxsCiAgICAgICAgQGZhY2VQYXR0ZXJuID0gbnVsbAogICAgICAgIEBuYW1lID0gIiIKICAgICAgICBAZmFjZXNldCA9IG51bGwKICAgICAgICBAb3Blbm5lc3MgPSAwCiAgICAgICAgQHBvc2l0aW9uID0gV2luZG93X01lc3NhZ2UuUE9TSVRJT05fQk9UVE9NCiAgICAgICAgZm9udCA9IFJlY29yZE1hbmFnZXIuc3lzdGVtLm1lc3NhZ2VGb250CiAgICAgICAgc2l6ZSA9IGlmIEdyYXBoaWNzLndpZHRoID09IDMyMCB0aGVuIDggZWxzZSAxNgogICAgICAgIEBtZXNzYWdlRm9udCA9IG5ldyBGb250KGZvbnQubmFtZSwgc2l6ZSkKICAgICAgICBAbWVzc2FnZUZvbnQuYm9yZGVyID0gZm9udC5kZWNvcmF0aW9uLnR5cGUgPT0gMgogICAgICAgIEBtZXNzYWdlRm9udC5zaGFkb3cgPSBmb250LmRlY29yYXRpb24udHlwZSA9PSAxCiAgICAgICAjIEBtZXNzYWdlRm9udC5ib3JkZXIgPSBubwogICAgICAgIyBAbmFtZUZvbnQgPSBuZXcgRm9udCgiQ291cmllciIsIDEyKQogICAgICAgIEBjdXJyZW50WCA9IDAKICAgICAgICBAaXNXYWl0aW5nID0gbm8KICAgICAgICBAd2FpdEZvcktleSA9IG5vCiAgICAgICAgQHdhaXRDb3VudGVyID0gMAogICAgICAgIEBzcGVlZCA9IDEKICAgICAgICBAZHJhd0ltbWVkaWF0bHkgPSBubwogICAgICAgIEB3YWl0QXRFbmQgPSB5ZXMKICAgICAgICAKICAgIHJlc2l6ZTogLT4KICAgICAgICB3aWR0aCA9IEdyYXBoaWNzLndpZHRoCiAgICAgICAgaGVpZ2h0ID0gTWF0aC5mbG9vcihHcmFwaGljcy5oZWlnaHQgLyAzLjUpCiAgICAgICAgCiAgICAgICAgaWYgQHdpZHRoICE9IHdpZHRoIG9yIEBoZWlnaHQgIT0gaGVpZ2h0CiAgICAgICAgICAgIEB3aWR0aCA9IHdpZHRoCiAgICAgICAgICAgIEBoZWlnaHQgPSBoZWlnaHQKICAgICAgICAgICAgQGNvbnRlbnRzID0gbmV3IEJpdG1hcChAd2lkdGggLSAyNCpXaW5kb3dfQmFzZS5zY2FsZSwgQGhlaWdodCAtIDI0KldpbmRvd19CYXNlLnNjYWxlKQogICAgICAgICAgICBAY29udGVudHMuZm9udCA9IEBtZXNzYWdlRm9udCAKICAgICAgICAKICAgIHJlc29sdmVQbGFjZWhvbGRlcnM6ICh0ZXh0KSAtPgogICAgICAgIHRleHQgPSB0ZXh0LnJlcGxhY2UgL1x7KFtBLVpdKyk6KFswLTldKylcfS9nbSwgKG1hdGNoLCBjb2RlLCBpZCkgPT4KICAgICAgICAgICAgc3dpdGNoIGNvZGUKICAgICAgICAgICAgICAgIHdoZW4gIkdOIiB0aGVuIHJldHVybiAoR2FtZU1hbmFnZXIudmFyaWFibGVTdG9yZS5udW1iZXJzW2lkLTFdIHx8IDApLnRvU3RyaW5nKCkKICAgICAgICAgICAgICAgIHdoZW4gIkdUIiB0aGVuIHJldHVybiAoR2FtZU1hbmFnZXIudmFyaWFibGVTdG9yZS5zdHJpbmdzW2lkLTFdIHx8ICIiKQogICAgICAgICAgICAgICAgd2hlbiAiR1MiIHRoZW4gcmV0dXJuIChHYW1lTWFuYWdlci52YXJpYWJsZVN0b3JlLmJvb2xlYW5zW2lkLTFdIHx8IGZhbHNlKS50b1N0cmluZygpCiAgICAgICAgICAgICAgICB3aGVuICJMTiIgdGhlbiByZXR1cm4gKEdhbWVNYW5hZ2VyLnZhcmlhYmxlU3RvcmUubnVtYmVyVmFsdWVPZih7IHNjb3BlOiAwLCBpbmRleDogaWQtMX0pIHx8IDApLnRvU3RyaW5nKCkKICAgICAgICAgICAgICAgIHdoZW4gIkxUIiB0aGVuIHJldHVybiAoR2FtZU1hbmFnZXIudmFyaWFibGVTdG9yZS5zdHJpbmdWYWx1ZU9mKHsgc2NvcGU6IDAsIGluZGV4OiBpZC0xfSkgfHwgIiIpLnRvU3RyaW5nKCkKICAgICAgICAgICAgICAgIHdoZW4gIkxTIiB0aGVuIHJldHVybiAoR2FtZU1hbmFnZXIudmFyaWFibGVTdG9yZS5ib29sZWFuVmFsdWVPZih7IHNjb3BlOiAwLCBpbmRleDogaWQtMX0pIHx8IGZhbHNlKS50b1N0cmluZygpCiAgICAgICAgICAgICAgICB3aGVuICJDIiB0aGVuIHJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlKDEpICsgU3RyaW5nLmZyb21DaGFyQ29kZShNYXRoLm1heChNYXRoLm1pbihpZCwgNyksIDEpKQogICAgICAgICAgICAgICAgd2hlbiAiTiIgdGhlbiByZXR1cm4gKGlmIFJlY29yZE1hbmFnZXIuYWN0b3JzW2lkXT8gdGhlbiBSZWNvcmRNYW5hZ2VyLmFjdG9yc1tpZF0ubmFtZSBlbHNlICIiKQogICAgICAgICAgICAgICAgd2hlbiAiUCIgdGhlbiByZXR1cm4gKGlmIEdhbWVNYW5hZ2VyLnBhcnR5Lm1lbWJlcnNbaWRdPyB0aGVuIEdhbWVNYW5hZ2VyLnBhcnR5Lm1lbWJlcnNbaWRdLm5hbWUgZWxzZSAiIikKICAgICAgICAgICAgICAgIHdoZW4gIlMiIHRoZW4gcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUoMykgKyBTdHJpbmcuZnJvbUNoYXJDb2RlKE1hdGgubWF4KE1hdGgubWluKGlkLCA3KSwgMSkpCiAgICAgICAgICAgICAgICB3aGVuICJDVVIiIHRoZW4gcmV0dXJuICJHIgogICAgICAgICAgICAgICAgCiAgICAgICAgdGV4dCA9IHRleHQucmVwbGFjZSAvXHsoW0EtWj48XSspXH0vZ20sIChtYXRjaCwgY29kZSkgPT4KICAgICAgICAgICAgc3dpdGNoIGNvZGUKICAgICAgICAgICAgICAgIHdoZW4gIldBIiB0aGVuIHJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlKDQpICsgU3RyaW5nLmZyb21DaGFyQ29kZSgxKQogICAgICAgICAgICAgICAgd2hlbiAiV1FTIiB0aGVuIHJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlKDQpICsgU3RyaW5nLmZyb21DaGFyQ29kZSgyKQogICAgICAgICAgICAgICAgd2hlbiAiV0hTIiB0aGVuIHJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlKDQpICsgU3RyaW5nLmZyb21DaGFyQ29kZSgzKQogICAgICAgICAgICAgICAgd2hlbiAiV09TIiB0aGVuIHJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlKDQpICsgU3RyaW5nLmZyb21DaGFyQ29kZSg1KQogICAgICAgICAgICAgICAgd2hlbiAiPj4iIHRoZW4gcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUoNSkgKyBTdHJpbmcuZnJvbUNoYXJDb2RlKDEpCiAgICAgICAgICAgICAgICB3aGVuICI8PCIgdGhlbiByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZSg1KSArIFN0cmluZy5mcm9tQ2hhckNvZGUoMikKICAgICAgICAgICAgICAgIHdoZW4gIj4iIHRoZW4gcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUoNikKICAgICAgICAgICAgICAgIAogICAgICAgIHJldHVybiB0ZXh0CiAgICBzdGFydDogLT4KICAgICAgICBAY29udGVudHMuY2xlYXIoKQogICAgICAgIEBpc1J1bm5pbmcgPSB5ZXMKICAgICAgICBAbGluZUFuaW1hdGlvbkNvdW50ID0gMQogICAgICAgIEBsaW5lID0gMAogICAgICAgIEBjaGFySW5kZXggPSAwCiAgICAgICAgCiAgICAgICAgQG1lc3NhZ2UgPSBAcmVzb2x2ZVBsYWNlaG9sZGVycyhAbWVzc2FnZSkKICAgICAgICAgICAgICAgIAogICAgICAgIEBsaW5lcyA9IEBtZXNzYWdlLnNwbGl0KCJcbiIpCiAgICAgICAgQGxpbmVJc0RyYXdpbmcgPSB5ZXMKICAgICAgICAKICAgICAgICBpZiBAZmFjZUdyYXBoaWM/CiAgICAgICAgICAgIEBmYWNlc2V0ID0gUmVzb3VyY2VNYW5hZ2VyLmdldEJpdG1hcCgiR3JhcGhpY3MvRmFjZXMvI3tAZmFjZUdyYXBoaWMubmFtZX0iKQogICAgICAgIGVsc2UKICAgICAgICAgICAgQGZhY2VzZXQgPSBudWxsCiAgICAgICAgCiAgICAgICAgaWYgQGZhY2VzZXQ/CiAgICAgICAgICAgIEByZWRyYXdGYWNlKCkKICAgICAgICAgICAgCiAgICAgICAgQHJlZHJhdygpCiAgICAgICAgCiAgICAgICAgQHggPSAwCiAgICAgICAgc3dpdGNoIEBwb3NpdGlvbgogICAgICAgICAgICB3aGVuIFdpbmRvd19NZXNzYWdlLlBPU0lUSU9OX1RPUAogICAgICAgICAgICAgICAgQHkgPSAwCiAgICAgICAgICAgIHdoZW4gV2luZG93X01lc3NhZ2UuUE9TSVRJT05fTUlERExFCiAgICAgICAgICAgICAgICBAeSA9IE1hdGguZmxvb3IoKEdyYXBoaWNzLmhlaWdodCAtIEBoZWlnaHQpIC8gMikKICAgICAgICAgICAgd2hlbiBXaW5kb3dfTWVzc2FnZS5QT1NJVElPTl9CT1RUT00KICAgICAgICAgICAgICAgIEB5ID0gR3JhcGhpY3MuaGVpZ2h0IC0gQGhlaWdodAogICAgICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgCiAgICByZWRyYXc6IC0+CiAgICAgICAgQGNvbnRlbnRzLmZvbnQgPSBAbWVzc2FnZUZvbnQKICAgICAgICBAY2hhciA9IEBsaW5lc1tAbGluZV0uY2hhckF0KEBjaGFySW5kZXgpCiAgICAgICAgY29kZSA9IEBjaGFyLmNoYXJDb2RlQXQoMCkKICAgICAgICBzaXplID0gQGNvbnRlbnRzLmZvbnQubWVhc3VyZVRleHQoQGNoYXIpICAKICAgICAgICBmYWNlU3BhY2UgPSAoOTYgKyAxMCkgKiBXaW5kb3dfQmFzZS5zY2FsZQogICAgICAgIAogICAgICAgIAogICAgICAgIGlmIGNvZGUgPCAzMgogICAgICAgICAgICBzd2l0Y2ggY29kZQogICAgICAgICAgICAgICAgd2hlbiAzICMgQ2hhbmdlIFNwZWVkCiAgICAgICAgICAgICAgICAgICAgQHNwZWVkID0gQGxpbmVzW0BsaW5lXS5jaGFyQ29kZUF0KEBjaGFySW5kZXgrMSkKICAgICAgICAgICAgICAgICAgICBAY2hhckluZGV4KysKICAgICAgICAgICAgICAgIHdoZW4gNCAjIFdhaXQKICAgICAgICAgICAgICAgICAgICB3YWl0Q29kZSA9IEBsaW5lc1tAbGluZV0uY2hhckNvZGVBdChAY2hhckluZGV4KzEpCiAgICAgICAgICAgICAgICAgICAgaWYgd2FpdENvZGUgPT0gMSAjIFdhaXQgZm9yIGtleQogICAgICAgICAgICAgICAgICAgICAgICBAd2FpdEZvcktleSA9IHllcwogICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgQHdhaXRDb3VudGVyID0gKHdhaXRDb2RlLTEpICogMTUKICAgICAgICAgICAgICAgICAgICBAY2hhckluZGV4KysKICAgICAgICAgICAgICAgIHdoZW4gNQogICAgICAgICAgICAgICAgICAgIHN1YkNvZGUgPSBAbGluZXNbQGxpbmVdLmNoYXJDb2RlQXQoQGNoYXJJbmRleCsxKQogICAgICAgICAgICAgICAgICAgIEBkcmF3SW1tZWRpYXRseSA9IHN1YkNvZGUgPT0gMSAjIERyYXcgaW1tZWRpYWx0eQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIEBjaGFySW5kZXgrKwogICAgICAgICAgICAgICAgd2hlbiA2CiAgICAgICAgICAgICAgICAgICAgQHdhaXRBdEVuZCA9IG5vCiAgICAgICAgICAgICAgICBlbHNlIAogICAgICAgICAgICAgICAgICAgIEBjaGFyICs9IEBsaW5lc1tAbGluZV0uY2hhckF0KEBjaGFySW5kZXgrMSkKICAgICAgICAgICAgICAgICAgICBAY2hhckluZGV4KysKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgaWYgQGZhY2VzZXQ/ICAgICAgICAgICAgCiAgICAgICAgICAgIEBjb250ZW50cy5kcmF3VGV4dEYoZmFjZVNwYWNlICsgQGN1cnJlbnRYLCBAbGluZSAqIChzaXplLmhlaWdodCs0KSwgc2l6ZS53aWR0aCwgc2l6ZS5oZWlnaHQrNCwgQGNoYXIsIDApCiAgICAgICAgZWxzZQogICAgICAgICAgICBAY29udGVudHMuZHJhd1RleHRGKEBjdXJyZW50WCwgQGxpbmUgKiAoc2l6ZS5oZWlnaHQrNCksIHNpemUud2lkdGgsIHNpemUuaGVpZ2h0KzQsIEBjaGFyLCAwKQogICAgCiAgICAgICAgQGN1cnJlbnRYICs9IHNpemUud2lkdGgKICAgICAgICAKICAgIHJlZHJhd0ZhY2U6IC0+CiAgICAgICAgcyA9IFdpbmRvd19CYXNlLnNjYWxlCgogICAgICAgIEBjb250ZW50cy5jbGVhclJlY3QoMCwgMCwgOTYqcywgOTYqcykKICAgICAgICBAY29udGVudHMuYmx0KDAsIDAsIEBmYWNlc2V0LCBuZXcgUmVjdChAZmFjZVBhdHRlcm4gJSA0ICogKDk2KnMpLCBNYXRoLmZsb29yKEBmYWNlUGF0dGVybiAvIDQpICogKDk2KnMpLCA5NipzLCA5NipzKSkKICAgICAgICBAY29udGVudHMuZm9udCA9IEBuYW1lRm9udAogICAgICAgIEBjb250ZW50cy5kcmF3VGV4dCgwLCA4NSpzLCA5NipzLCAxMiwgQG5hbWUsIDEpCiAgICAgICAgQGNvbnRlbnRzLmZvbnQgPSBAbWVzc2FnZUZvbnQKICAgICAgICAgICAgICAgIAogICAgdXBkYXRlTGluZVdyaXRpbmc6IC0+CiAgICAgICAgaWYgQGlzUnVubmluZyBhbmQgbm90IEBpc1dhaXRpbmcgYW5kIG5vdCBAd2FpdEZvcktleSBhbmQgbm90IEB3YWl0Q291bnRlciA+IDAKICAgICAgICAgICAgaWYgQGRyYXdJbW1lZGlhdGx5CiAgICAgICAgICAgICAgICB3aGlsZSBAZHJhd0ltbWVkaWF0bHkKICAgICAgICAgICAgICAgICAgICBAY2hhckluZGV4KysKICAgICAgICAgICAgICAgICAgICBpZiBAY2hhckluZGV4ID49IEBsaW5lc1tAbGluZV0ubGVuZ3RoCiAgICAgICAgICAgICAgICAgICAgICAgIEBjaGFySW5kZXggPSAwCiAgICAgICAgICAgICAgICAgICAgICAgIEBjdXJyZW50WCA9IDAKICAgICAgICAgICAgICAgICAgICAgICAgQGRyYXdJbW1lZGlhdGx5ID0gbm8KICAgICAgICAgICAgICAgICAgICAgICAgQGxpbmUrKwogICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgQHJlZHJhdygpCiAgICAgICAgICAgICAgICAgICAgaWYgQGxpbmUgPj0gQGxpbmVzLmxlbmd0aAogICAgICAgICAgICAgICAgICAgICAgICBAaXNXYWl0aW5nID0geWVzCiAgICAgICAgICAgICAgICAgICAgICAgIEBwYXVzZSA9IHllcwogICAgICAgICAgICAgICAgICAgICAgICBAZHJhd0ltbWVkaWF0bHkgPSBubwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBAbGluZUFuaW1hdGlvbkNvdW50LS0KICAgICAgICAgICAgICAgIGlmIEBsaW5lQW5pbWF0aW9uQ291bnQgPD0gMAogICAgICAgICAgICAgICAgICAgIEBjaGFySW5kZXgrKwogICAgICAgICAgICAgICAgICAgIEBsaW5lQW5pbWF0aW9uQ291bnQgPSBAc3BlZWQKICAgICAgICAgICAgICAgICAgICBpZiBAY2hhckluZGV4ID49IEBsaW5lc1tAbGluZV0ubGVuZ3RoCiAgICAgICAgICAgICAgICAgICAgICAgIEBjaGFySW5kZXggPSAwCiAgICAgICAgICAgICAgICAgICAgICAgIEBjdXJyZW50WCA9IDAKICAgICAgICAgICAgICAgICAgICAgICAgQGxpbmUrKwogICAgICAgICAgICAgICAgICAgIGlmIEBsaW5lID49IEBsaW5lcy5sZW5ndGgKICAgICAgICAgICAgICAgICAgICAgICAgaWYgQHdhaXRBdEVuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgQGlzV2FpdGluZyA9IHllcwogICAgICAgICAgICAgICAgICAgICAgICAgICAgQHBhdXNlID0geWVzCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBpc1J1bm5pbmcgPSBubwogICAgICAgICAgICAgICAgICAgICAgICAgICAgQGlzV2FpdGluZyA9IG5vCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBAcGF1c2UgPSBubwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgQG9uRmluaXNoPyB0aGVuIEBvbkZpbmlzaCgpCiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICBAcmVkcmF3KCkKICAgICAgICBAcGF1c2UgPSBAaXNXYWl0aW5nIG9yIEB3YWl0Rm9yS2V5ICAgICAgICAgICAgCiAgICAgICAgaWYgQHdhaXRGb3JLZXkgYW5kIElucHV0LnRyaWdnZXIoSW5wdXQuQykKICAgICAgICAgICAgSW5wdXQuY2xlYXIoKQogICAgICAgICAgICBAd2FpdEZvcktleSA9IG5vCiAgICAgICAgaWYgQHdhaXRDb3VudGVyID4gMAogICAgICAgICAgICBAd2FpdENvdW50ZXItLQogICAgICAgICAgICAgICAgICAgIAogICAgdXBkYXRlOiAtPgogICAgICAgIHN1cGVyKCkKICAgICAgICAgICAgICAgIAogICAgICAgIGlmIEBvcGVubmVzcyA9PSAyNTUKICAgICAgICAgICAgQHVwZGF0ZUxpbmVXcml0aW5nKCkKICAgICAgICBpZiBAaXNXYWl0aW5nIGFuZCBJbnB1dC50cmlnZ2VyKElucHV0LkMpCiAgICAgICAgICAgIElucHV0LmNsZWFyKCkKICAgICAgICAgICAgQGlzUnVubmluZyA9IG5vCiAgICAgICAgICAgIEBpc1dhaXRpbmcgPSBubwogICAgICAgICAgICBAcGF1c2UgPSBubwogICAgICAgICAgICBpZiBAb25GaW5pc2g/IHRoZW4gQG9uRmluaXNoKCkKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgCndpbmRvdy5XaW5kb3dfTWVzc2FnZSA9IFdpbmRvd19NZXNzYWdl","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBXaW5kb3dfTWVzc2FnZSwKICAgIF9faGFzUHJvcCA9IHt9Lmhhc093blByb3BlcnR5LAogICAgX19leHRlbmRzID0gZnVuY3Rpb24oY2hpbGQsIHBhcmVudCkgeyBmb3IgKHZhciBrZXkgaW4gcGFyZW50KSB7IGlmIChfX2hhc1Byb3AuY2FsbChwYXJlbnQsIGtleSkpIGNoaWxkW2tleV0gPSBwYXJlbnRba2V5XTsgfSBmdW5jdGlvbiBjdG9yKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gY2hpbGQ7IH0gY3Rvci5wcm90b3R5cGUgPSBwYXJlbnQucHJvdG90eXBlOyBjaGlsZC5wcm90b3R5cGUgPSBuZXcgY3RvcigpOyBjaGlsZC5fX3N1cGVyX18gPSBwYXJlbnQucHJvdG90eXBlOyByZXR1cm4gY2hpbGQ7IH07CgogIFdpbmRvd19NZXNzYWdlID0gKGZ1bmN0aW9uKF9zdXBlcikgewogICAgX19leHRlbmRzKFdpbmRvd19NZXNzYWdlLCBfc3VwZXIpOwoKICAgIFdpbmRvd19NZXNzYWdlLk1PREVfQlVCQkxFID0gMTsKCiAgICBXaW5kb3dfTWVzc2FnZS5NT0RFX0ZVTExTSVpFX1dJTkRPVyA9IDA7CgogICAgV2luZG93X01lc3NhZ2UuUE9TSVRJT05fQk9UVE9NID0gMDsKCiAgICBXaW5kb3dfTWVzc2FnZS5QT1NJVElPTl9NSURETEUgPSAxOwoKICAgIFdpbmRvd19NZXNzYWdlLlBPU0lUSU9OX1RPUCA9IDI7CgogICAgZnVuY3Rpb24gV2luZG93X01lc3NhZ2UoKSB7CiAgICAgIHZhciBmb250LCBzaXplOwogICAgICBXaW5kb3dfTWVzc2FnZS5fX3N1cGVyX18uY29uc3RydWN0b3IuY2FsbCh0aGlzLCAwLCAwLCBHcmFwaGljcy53aWR0aCwgTWF0aC5mbG9vcihHcmFwaGljcy5oZWlnaHQgLyAzLjUpKTsKICAgICAgdGhpcy55ID0gR3JhcGhpY3MuaGVpZ2h0IC0gdGhpcy5oZWlnaHQ7CiAgICAgIHRoaXMudmlzaWJsZSA9IGZhbHNlOwogICAgICB0aGlzLm1lc3NhZ2UgPSAiIjsKICAgICAgdGhpcy5saW5lcyA9IG51bGw7CiAgICAgIHRoaXMubGluZSA9IDA7CiAgICAgIHRoaXMubGluZVRleHQgPSAiIjsKICAgICAgdGhpcy5jaGFySW5kZXggPSAwOwogICAgICB0aGlzLnogPSA1MDAwOwogICAgICB0aGlzLmNvbnRlbnRzID0gbmV3IEJpdG1hcCh0aGlzLndpZHRoIC0gdGhpcy5wYWRkaW5nICogMiwgdGhpcy5oZWlnaHQgLSB0aGlzLnBhZGRpbmcgKiAyKTsKICAgICAgdGhpcy5jb250ZW50cy5mb250LnNoYWRvdyA9IHRydWU7CiAgICAgIHRoaXMuaXNSdW5uaW5nID0gZmFsc2U7CiAgICAgIHRoaXMubGluZUlzRHJhd2luZyA9IGZhbHNlOwogICAgICB0aGlzLmFuaW1hdGlvbkNvdW50ID0gNjA7CiAgICAgIHRoaXMuZmFjZUdyYXBoaWMgPSBudWxsOwogICAgICB0aGlzLmZhY2VQYXR0ZXJuID0gbnVsbDsKICAgICAgdGhpcy5uYW1lID0gIiI7CiAgICAgIHRoaXMuZmFjZXNldCA9IG51bGw7CiAgICAgIHRoaXMub3Blbm5lc3MgPSAwOwogICAgICB0aGlzLnBvc2l0aW9uID0gV2luZG93X01lc3NhZ2UuUE9TSVRJT05fQk9UVE9NOwogICAgICBmb250ID0gUmVjb3JkTWFuYWdlci5zeXN0ZW0ubWVzc2FnZUZvbnQ7CiAgICAgIHNpemUgPSBHcmFwaGljcy53aWR0aCA9PT0gMzIwID8gOCA6IDE2OwogICAgICB0aGlzLm1lc3NhZ2VGb250ID0gbmV3IEZvbnQoZm9udC5uYW1lLCBzaXplKTsKICAgICAgdGhpcy5tZXNzYWdlRm9udC5ib3JkZXIgPSBmb250LmRlY29yYXRpb24udHlwZSA9PT0gMjsKICAgICAgdGhpcy5tZXNzYWdlRm9udC5zaGFkb3cgPSBmb250LmRlY29yYXRpb24udHlwZSA9PT0gMTsKICAgICAgdGhpcy5jdXJyZW50WCA9IDA7CiAgICAgIHRoaXMuaXNXYWl0aW5nID0gZmFsc2U7CiAgICAgIHRoaXMud2FpdEZvcktleSA9IGZhbHNlOwogICAgICB0aGlzLndhaXRDb3VudGVyID0gMDsKICAgICAgdGhpcy5zcGVlZCA9IDE7CiAgICAgIHRoaXMuZHJhd0ltbWVkaWF0bHkgPSBmYWxzZTsKICAgICAgdGhpcy53YWl0QXRFbmQgPSB0cnVlOwogICAgfQoKICAgIFdpbmRvd19NZXNzYWdlLnByb3RvdHlwZS5yZXNpemUgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGhlaWdodCwgd2lkdGg7CiAgICAgIHdpZHRoID0gR3JhcGhpY3Mud2lkdGg7CiAgICAgIGhlaWdodCA9IE1hdGguZmxvb3IoR3JhcGhpY3MuaGVpZ2h0IC8gMy41KTsKICAgICAgaWYgKHRoaXMud2lkdGggIT09IHdpZHRoIHx8IHRoaXMuaGVpZ2h0ICE9PSBoZWlnaHQpIHsKICAgICAgICB0aGlzLndpZHRoID0gd2lkdGg7CiAgICAgICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7CiAgICAgICAgdGhpcy5jb250ZW50cyA9IG5ldyBCaXRtYXAodGhpcy53aWR0aCAtIDI0ICogV2luZG93X0Jhc2Uuc2NhbGUsIHRoaXMuaGVpZ2h0IC0gMjQgKiBXaW5kb3dfQmFzZS5zY2FsZSk7CiAgICAgICAgcmV0dXJuIHRoaXMuY29udGVudHMuZm9udCA9IHRoaXMubWVzc2FnZUZvbnQ7CiAgICAgIH0KICAgIH07CgogICAgV2luZG93X01lc3NhZ2UucHJvdG90eXBlLnJlc29sdmVQbGFjZWhvbGRlcnMgPSBmdW5jdGlvbih0ZXh0KSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIHRleHQgPSB0ZXh0LnJlcGxhY2UoL1x7KFtBLVpdKyk6KFswLTldKylcfS9nbSwgZnVuY3Rpb24obWF0Y2gsIGNvZGUsIGlkKSB7CiAgICAgICAgc3dpdGNoIChjb2RlKSB7CiAgICAgICAgICBjYXNlICJHTiI6CiAgICAgICAgICAgIHJldHVybiAoR2FtZU1hbmFnZXIudmFyaWFibGVTdG9yZS5udW1iZXJzW2lkIC0gMV0gfHwgMCkudG9TdHJpbmcoKTsKICAgICAgICAgIGNhc2UgIkdUIjoKICAgICAgICAgICAgcmV0dXJuIEdhbWVNYW5hZ2VyLnZhcmlhYmxlU3RvcmUuc3RyaW5nc1tpZCAtIDFdIHx8ICIiOwogICAgICAgICAgY2FzZSAiR1MiOgogICAgICAgICAgICByZXR1cm4gKEdhbWVNYW5hZ2VyLnZhcmlhYmxlU3RvcmUuYm9vbGVhbnNbaWQgLSAxXSB8fCBmYWxzZSkudG9TdHJpbmcoKTsKICAgICAgICAgIGNhc2UgIkxOIjoKICAgICAgICAgICAgcmV0dXJuIChHYW1lTWFuYWdlci52YXJpYWJsZVN0b3JlLm51bWJlclZhbHVlT2YoewogICAgICAgICAgICAgIHNjb3BlOiAwLAogICAgICAgICAgICAgIGluZGV4OiBpZCAtIDEKICAgICAgICAgICAgfSkgfHwgMCkudG9TdHJpbmcoKTsKICAgICAgICAgIGNhc2UgIkxUIjoKICAgICAgICAgICAgcmV0dXJuIChHYW1lTWFuYWdlci52YXJpYWJsZVN0b3JlLnN0cmluZ1ZhbHVlT2YoewogICAgICAgICAgICAgIHNjb3BlOiAwLAogICAgICAgICAgICAgIGluZGV4OiBpZCAtIDEKICAgICAgICAgICAgfSkgfHwgIiIpLnRvU3RyaW5nKCk7CiAgICAgICAgICBjYXNlICJMUyI6CiAgICAgICAgICAgIHJldHVybiAoR2FtZU1hbmFnZXIudmFyaWFibGVTdG9yZS5ib29sZWFuVmFsdWVPZih7CiAgICAgICAgICAgICAgc2NvcGU6IDAsCiAgICAgICAgICAgICAgaW5kZXg6IGlkIC0gMQogICAgICAgICAgICB9KSB8fCBmYWxzZSkudG9TdHJpbmcoKTsKICAgICAgICAgIGNhc2UgIkMiOgogICAgICAgICAgICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZSgxKSArIFN0cmluZy5mcm9tQ2hhckNvZGUoTWF0aC5tYXgoTWF0aC5taW4oaWQsIDcpLCAxKSk7CiAgICAgICAgICBjYXNlICJOIjoKICAgICAgICAgICAgcmV0dXJuIChSZWNvcmRNYW5hZ2VyLmFjdG9yc1tpZF0gIT0gbnVsbCA/IFJlY29yZE1hbmFnZXIuYWN0b3JzW2lkXS5uYW1lIDogIiIpOwogICAgICAgICAgY2FzZSAiUCI6CiAgICAgICAgICAgIHJldHVybiAoR2FtZU1hbmFnZXIucGFydHkubWVtYmVyc1tpZF0gIT0gbnVsbCA/IEdhbWVNYW5hZ2VyLnBhcnR5Lm1lbWJlcnNbaWRdLm5hbWUgOiAiIik7CiAgICAgICAgICBjYXNlICJTIjoKICAgICAgICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUoMykgKyBTdHJpbmcuZnJvbUNoYXJDb2RlKE1hdGgubWF4KE1hdGgubWluKGlkLCA3KSwgMSkpOwogICAgICAgICAgY2FzZSAiQ1VSIjoKICAgICAgICAgICAgcmV0dXJuICJHIjsKICAgICAgICB9CiAgICAgIH0pOwogICAgICB0ZXh0ID0gdGV4dC5yZXBsYWNlKC9ceyhbQS1aPjxdKylcfS9nbSwgZnVuY3Rpb24obWF0Y2gsIGNvZGUpIHsKICAgICAgICBzd2l0Y2ggKGNvZGUpIHsKICAgICAgICAgIGNhc2UgIldBIjoKICAgICAgICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUoNCkgKyBTdHJpbmcuZnJvbUNoYXJDb2RlKDEpOwogICAgICAgICAgY2FzZSAiV1FTIjoKICAgICAgICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUoNCkgKyBTdHJpbmcuZnJvbUNoYXJDb2RlKDIpOwogICAgICAgICAgY2FzZSAiV0hTIjoKICAgICAgICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUoNCkgKyBTdHJpbmcuZnJvbUNoYXJDb2RlKDMpOwogICAgICAgICAgY2FzZSAiV09TIjoKICAgICAgICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUoNCkgKyBTdHJpbmcuZnJvbUNoYXJDb2RlKDUpOwogICAgICAgICAgY2FzZSAiPj4iOgogICAgICAgICAgICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZSg1KSArIFN0cmluZy5mcm9tQ2hhckNvZGUoMSk7CiAgICAgICAgICBjYXNlICI8PCI6CiAgICAgICAgICAgIHJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlKDUpICsgU3RyaW5nLmZyb21DaGFyQ29kZSgyKTsKICAgICAgICAgIGNhc2UgIj4iOgogICAgICAgICAgICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZSg2KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICByZXR1cm4gdGV4dDsKICAgIH07CgogICAgV2luZG93X01lc3NhZ2UucHJvdG90eXBlLnN0YXJ0ID0gZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMuY29udGVudHMuY2xlYXIoKTsKICAgICAgdGhpcy5pc1J1bm5pbmcgPSB0cnVlOwogICAgICB0aGlzLmxpbmVBbmltYXRpb25Db3VudCA9IDE7CiAgICAgIHRoaXMubGluZSA9IDA7CiAgICAgIHRoaXMuY2hhckluZGV4ID0gMDsKICAgICAgdGhpcy5tZXNzYWdlID0gdGhpcy5yZXNvbHZlUGxhY2Vob2xkZXJzKHRoaXMubWVzc2FnZSk7CiAgICAgIHRoaXMubGluZXMgPSB0aGlzLm1lc3NhZ2Uuc3BsaXQoIlxuIik7CiAgICAgIHRoaXMubGluZUlzRHJhd2luZyA9IHRydWU7CiAgICAgIGlmICh0aGlzLmZhY2VHcmFwaGljICE9IG51bGwpIHsKICAgICAgICB0aGlzLmZhY2VzZXQgPSBSZXNvdXJjZU1hbmFnZXIuZ2V0Qml0bWFwKCJHcmFwaGljcy9GYWNlcy8iICsgdGhpcy5mYWNlR3JhcGhpYy5uYW1lKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmZhY2VzZXQgPSBudWxsOwogICAgICB9CiAgICAgIGlmICh0aGlzLmZhY2VzZXQgIT0gbnVsbCkgewogICAgICAgIHRoaXMucmVkcmF3RmFjZSgpOwogICAgICB9CiAgICAgIHRoaXMucmVkcmF3KCk7CiAgICAgIHRoaXMueCA9IDA7CiAgICAgIHN3aXRjaCAodGhpcy5wb3NpdGlvbikgewogICAgICAgIGNhc2UgV2luZG93X01lc3NhZ2UuUE9TSVRJT05fVE9QOgogICAgICAgICAgcmV0dXJuIHRoaXMueSA9IDA7CiAgICAgICAgY2FzZSBXaW5kb3dfTWVzc2FnZS5QT1NJVElPTl9NSURETEU6CiAgICAgICAgICByZXR1cm4gdGhpcy55ID0gTWF0aC5mbG9vcigoR3JhcGhpY3MuaGVpZ2h0IC0gdGhpcy5oZWlnaHQpIC8gMik7CiAgICAgICAgY2FzZSBXaW5kb3dfTWVzc2FnZS5QT1NJVElPTl9CT1RUT006CiAgICAgICAgICByZXR1cm4gdGhpcy55ID0gR3JhcGhpY3MuaGVpZ2h0IC0gdGhpcy5oZWlnaHQ7CiAgICAgIH0KICAgIH07CgogICAgV2luZG93X01lc3NhZ2UucHJvdG90eXBlLnJlZHJhdyA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgY29kZSwgZmFjZVNwYWNlLCBzaXplLCBzdWJDb2RlLCB3YWl0Q29kZTsKICAgICAgdGhpcy5jb250ZW50cy5mb250ID0gdGhpcy5tZXNzYWdlRm9udDsKICAgICAgdGhpcy5jaGFyID0gdGhpcy5saW5lc1t0aGlzLmxpbmVdLmNoYXJBdCh0aGlzLmNoYXJJbmRleCk7CiAgICAgIGNvZGUgPSB0aGlzLmNoYXIuY2hhckNvZGVBdCgwKTsKICAgICAgc2l6ZSA9IHRoaXMuY29udGVudHMuZm9udC5tZWFzdXJlVGV4dCh0aGlzLmNoYXIpOwogICAgICBmYWNlU3BhY2UgPSAoOTYgKyAxMCkgKiBXaW5kb3dfQmFzZS5zY2FsZTsKICAgICAgaWYgKGNvZGUgPCAzMikgewogICAgICAgIHN3aXRjaCAoY29kZSkgewogICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICB0aGlzLnNwZWVkID0gdGhpcy5saW5lc1t0aGlzLmxpbmVdLmNoYXJDb2RlQXQodGhpcy5jaGFySW5kZXggKyAxKTsKICAgICAgICAgICAgdGhpcy5jaGFySW5kZXgrKzsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgIHdhaXRDb2RlID0gdGhpcy5saW5lc1t0aGlzLmxpbmVdLmNoYXJDb2RlQXQodGhpcy5jaGFySW5kZXggKyAxKTsKICAgICAgICAgICAgaWYgKHdhaXRDb2RlID09PSAxKSB7CiAgICAgICAgICAgICAgdGhpcy53YWl0Rm9yS2V5ID0gdHJ1ZTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICB0aGlzLndhaXRDb3VudGVyID0gKHdhaXRDb2RlIC0gMSkgKiAxNTsKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLmNoYXJJbmRleCsrOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgc3ViQ29kZSA9IHRoaXMubGluZXNbdGhpcy5saW5lXS5jaGFyQ29kZUF0KHRoaXMuY2hhckluZGV4ICsgMSk7CiAgICAgICAgICAgIHRoaXMuZHJhd0ltbWVkaWF0bHkgPSBzdWJDb2RlID09PSAxOwogICAgICAgICAgICB0aGlzLmNoYXJJbmRleCsrOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgdGhpcy53YWl0QXRFbmQgPSBmYWxzZTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICB0aGlzLmNoYXIgKz0gdGhpcy5saW5lc1t0aGlzLmxpbmVdLmNoYXJBdCh0aGlzLmNoYXJJbmRleCArIDEpOwogICAgICAgICAgICB0aGlzLmNoYXJJbmRleCsrOwogICAgICAgIH0KICAgICAgfQogICAgICBpZiAodGhpcy5mYWNlc2V0ICE9IG51bGwpIHsKICAgICAgICB0aGlzLmNvbnRlbnRzLmRyYXdUZXh0RihmYWNlU3BhY2UgKyB0aGlzLmN1cnJlbnRYLCB0aGlzLmxpbmUgKiAoc2l6ZS5oZWlnaHQgKyA0KSwgc2l6ZS53aWR0aCwgc2l6ZS5oZWlnaHQgKyA0LCB0aGlzLmNoYXIsIDApOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuY29udGVudHMuZHJhd1RleHRGKHRoaXMuY3VycmVudFgsIHRoaXMubGluZSAqIChzaXplLmhlaWdodCArIDQpLCBzaXplLndpZHRoLCBzaXplLmhlaWdodCArIDQsIHRoaXMuY2hhciwgMCk7CiAgICAgIH0KICAgICAgcmV0dXJuIHRoaXMuY3VycmVudFggKz0gc2l6ZS53aWR0aDsKICAgIH07CgogICAgV2luZG93X01lc3NhZ2UucHJvdG90eXBlLnJlZHJhd0ZhY2UgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIHM7CiAgICAgIHMgPSBXaW5kb3dfQmFzZS5zY2FsZTsKICAgICAgdGhpcy5jb250ZW50cy5jbGVhclJlY3QoMCwgMCwgOTYgKiBzLCA5NiAqIHMpOwogICAgICB0aGlzLmNvbnRlbnRzLmJsdCgwLCAwLCB0aGlzLmZhY2VzZXQsIG5ldyBSZWN0KHRoaXMuZmFjZVBhdHRlcm4gJSA0ICogKDk2ICogcyksIE1hdGguZmxvb3IodGhpcy5mYWNlUGF0dGVybiAvIDQpICogKDk2ICogcyksIDk2ICogcywgOTYgKiBzKSk7CiAgICAgIHRoaXMuY29udGVudHMuZm9udCA9IHRoaXMubmFtZUZvbnQ7CiAgICAgIHRoaXMuY29udGVudHMuZHJhd1RleHQoMCwgODUgKiBzLCA5NiAqIHMsIDEyLCB0aGlzLm5hbWUsIDEpOwogICAgICByZXR1cm4gdGhpcy5jb250ZW50cy5mb250ID0gdGhpcy5tZXNzYWdlRm9udDsKICAgIH07CgogICAgV2luZG93X01lc3NhZ2UucHJvdG90eXBlLnVwZGF0ZUxpbmVXcml0aW5nID0gZnVuY3Rpb24oKSB7CiAgICAgIGlmICh0aGlzLmlzUnVubmluZyAmJiAhdGhpcy5pc1dhaXRpbmcgJiYgIXRoaXMud2FpdEZvcktleSAmJiAhdGhpcy53YWl0Q291bnRlciA+IDApIHsKICAgICAgICBpZiAodGhpcy5kcmF3SW1tZWRpYXRseSkgewogICAgICAgICAgd2hpbGUgKHRoaXMuZHJhd0ltbWVkaWF0bHkpIHsKICAgICAgICAgICAgdGhpcy5jaGFySW5kZXgrKzsKICAgICAgICAgICAgaWYgKHRoaXMuY2hhckluZGV4ID49IHRoaXMubGluZXNbdGhpcy5saW5lXS5sZW5ndGgpIHsKICAgICAgICAgICAgICB0aGlzLmNoYXJJbmRleCA9IDA7CiAgICAgICAgICAgICAgdGhpcy5jdXJyZW50WCA9IDA7CiAgICAgICAgICAgICAgdGhpcy5kcmF3SW1tZWRpYXRseSA9IGZhbHNlOwogICAgICAgICAgICAgIHRoaXMubGluZSsrOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHRoaXMucmVkcmF3KCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHRoaXMubGluZSA+PSB0aGlzLmxpbmVzLmxlbmd0aCkgewogICAgICAgICAgICAgIHRoaXMuaXNXYWl0aW5nID0gdHJ1ZTsKICAgICAgICAgICAgICB0aGlzLnBhdXNlID0gdHJ1ZTsKICAgICAgICAgICAgICB0aGlzLmRyYXdJbW1lZGlhdGx5ID0gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5saW5lQW5pbWF0aW9uQ291bnQtLTsKICAgICAgICAgIGlmICh0aGlzLmxpbmVBbmltYXRpb25Db3VudCA8PSAwKSB7CiAgICAgICAgICAgIHRoaXMuY2hhckluZGV4Kys7CiAgICAgICAgICAgIHRoaXMubGluZUFuaW1hdGlvbkNvdW50ID0gdGhpcy5zcGVlZDsKICAgICAgICAgICAgaWYgKHRoaXMuY2hhckluZGV4ID49IHRoaXMubGluZXNbdGhpcy5saW5lXS5sZW5ndGgpIHsKICAgICAgICAgICAgICB0aGlzLmNoYXJJbmRleCA9IDA7CiAgICAgICAgICAgICAgdGhpcy5jdXJyZW50WCA9IDA7CiAgICAgICAgICAgICAgdGhpcy5saW5lKys7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHRoaXMubGluZSA+PSB0aGlzLmxpbmVzLmxlbmd0aCkgewogICAgICAgICAgICAgIGlmICh0aGlzLndhaXRBdEVuZCkgewogICAgICAgICAgICAgICAgdGhpcy5pc1dhaXRpbmcgPSB0cnVlOwogICAgICAgICAgICAgICAgdGhpcy5wYXVzZSA9IHRydWU7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHRoaXMuaXNSdW5uaW5nID0gZmFsc2U7CiAgICAgICAgICAgICAgICB0aGlzLmlzV2FpdGluZyA9IGZhbHNlOwogICAgICAgICAgICAgICAgdGhpcy5wYXVzZSA9IGZhbHNlOwogICAgICAgICAgICAgICAgaWYgKHRoaXMub25GaW5pc2ggIT0gbnVsbCkgewogICAgICAgICAgICAgICAgICB0aGlzLm9uRmluaXNoKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHRoaXMucmVkcmF3KCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgdGhpcy5wYXVzZSA9IHRoaXMuaXNXYWl0aW5nIHx8IHRoaXMud2FpdEZvcktleTsKICAgICAgaWYgKHRoaXMud2FpdEZvcktleSAmJiBJbnB1dC50cmlnZ2VyKElucHV0LkMpKSB7CiAgICAgICAgSW5wdXQuY2xlYXIoKTsKICAgICAgICB0aGlzLndhaXRGb3JLZXkgPSBmYWxzZTsKICAgICAgfQogICAgICBpZiAodGhpcy53YWl0Q291bnRlciA+IDApIHsKICAgICAgICByZXR1cm4gdGhpcy53YWl0Q291bnRlci0tOwogICAgICB9CiAgICB9OwoKICAgIFdpbmRvd19NZXNzYWdlLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpIHsKICAgICAgV2luZG93X01lc3NhZ2UuX19zdXBlcl9fLnVwZGF0ZS5jYWxsKHRoaXMpOwogICAgICBpZiAodGhpcy5vcGVubmVzcyA9PT0gMjU1KSB7CiAgICAgICAgdGhpcy51cGRhdGVMaW5lV3JpdGluZygpOwogICAgICB9CiAgICAgIGlmICh0aGlzLmlzV2FpdGluZyAmJiBJbnB1dC50cmlnZ2VyKElucHV0LkMpKSB7CiAgICAgICAgSW5wdXQuY2xlYXIoKTsKICAgICAgICB0aGlzLmlzUnVubmluZyA9IGZhbHNlOwogICAgICAgIHRoaXMuaXNXYWl0aW5nID0gZmFsc2U7CiAgICAgICAgdGhpcy5wYXVzZSA9IGZhbHNlOwogICAgICAgIGlmICh0aGlzLm9uRmluaXNoICE9IG51bGwpIHsKICAgICAgICAgIHJldHVybiB0aGlzLm9uRmluaXNoKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9OwoKICAgIHJldHVybiBXaW5kb3dfTWVzc2FnZTsKCiAgfSkoV2luZG93X0Jhc2UpOwoKICB3aW5kb3cuV2luZG93X01lc3NhZ2UgPSBXaW5kb3dfTWVzc2FnZTsKCn0pLmNhbGwodGhpcyk7Cg=="},{"name":"Window_Party","content":"# ===================================================================\n#\n#   Script: Window_Party\n#   Created on: 2013-09-15\n#\n#   Copyright (C) 2013 AndrÃ© Radomski. All rights reserved.\n#\n# ===================================================================\n#\n#    Class: Window_Party\n#\n#   A window which displays a short information about each party member.\n#\n# ===================================================================\n\nclass Window_Party extends Window_Selection    \n    constructor: (viewport) ->\n        super(0, 0, 4, [GameManager.party.members], 154 * Window_Base.scale, 90 * Window_Base.scale, viewport)\n        @party = GameManager.party\n        @contents = new Bitmap(@width - @padding*2, @height - @padding*2)\n        @columnSpacing = 0\n        for member in @party.members\n            ResourceManager.getBitmap(\"Graphics/Faces/#{member.faceGraphic.name}\")  \n    prepare: ->\n        \n    drawCell: (x, y, cell) ->\n        @drawMember(x+2, y+4, cell)\n        \n        \n    \n        \nwindow.Window_Party = Window_Party","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBXaW5kb3dfUGFydHksCiAgICBfX2hhc1Byb3AgPSB7fS5oYXNPd25Qcm9wZXJ0eSwKICAgIF9fZXh0ZW5kcyA9IGZ1bmN0aW9uKGNoaWxkLCBwYXJlbnQpIHsgZm9yICh2YXIga2V5IGluIHBhcmVudCkgeyBpZiAoX19oYXNQcm9wLmNhbGwocGFyZW50LCBrZXkpKSBjaGlsZFtrZXldID0gcGFyZW50W2tleV07IH0gZnVuY3Rpb24gY3RvcigpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGNoaWxkOyB9IGN0b3IucHJvdG90eXBlID0gcGFyZW50LnByb3RvdHlwZTsgY2hpbGQucHJvdG90eXBlID0gbmV3IGN0b3IoKTsgY2hpbGQuX19zdXBlcl9fID0gcGFyZW50LnByb3RvdHlwZTsgcmV0dXJuIGNoaWxkOyB9OwoKICBXaW5kb3dfUGFydHkgPSAoZnVuY3Rpb24oX3N1cGVyKSB7CiAgICBfX2V4dGVuZHMoV2luZG93X1BhcnR5LCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFdpbmRvd19QYXJ0eSh2aWV3cG9ydCkgewogICAgICB2YXIgbWVtYmVyLCBfaSwgX2xlbiwgX3JlZjsKICAgICAgV2luZG93X1BhcnR5Ll9fc3VwZXJfXy5jb25zdHJ1Y3Rvci5jYWxsKHRoaXMsIDAsIDAsIDQsIFtHYW1lTWFuYWdlci5wYXJ0eS5tZW1iZXJzXSwgMTU0ICogV2luZG93X0Jhc2Uuc2NhbGUsIDkwICogV2luZG93X0Jhc2Uuc2NhbGUsIHZpZXdwb3J0KTsKICAgICAgdGhpcy5wYXJ0eSA9IEdhbWVNYW5hZ2VyLnBhcnR5OwogICAgICB0aGlzLmNvbnRlbnRzID0gbmV3IEJpdG1hcCh0aGlzLndpZHRoIC0gdGhpcy5wYWRkaW5nICogMiwgdGhpcy5oZWlnaHQgLSB0aGlzLnBhZGRpbmcgKiAyKTsKICAgICAgdGhpcy5jb2x1bW5TcGFjaW5nID0gMDsKICAgICAgX3JlZiA9IHRoaXMucGFydHkubWVtYmVyczsKICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBfcmVmLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7CiAgICAgICAgbWVtYmVyID0gX3JlZltfaV07CiAgICAgICAgUmVzb3VyY2VNYW5hZ2VyLmdldEJpdG1hcCgiR3JhcGhpY3MvRmFjZXMvIiArIG1lbWJlci5mYWNlR3JhcGhpYy5uYW1lKTsKICAgICAgfQogICAgfQoKICAgIFdpbmRvd19QYXJ0eS5wcm90b3R5cGUucHJlcGFyZSA9IGZ1bmN0aW9uKCkge307CgogICAgV2luZG93X1BhcnR5LnByb3RvdHlwZS5kcmF3Q2VsbCA9IGZ1bmN0aW9uKHgsIHksIGNlbGwpIHsKICAgICAgcmV0dXJuIHRoaXMuZHJhd01lbWJlcih4ICsgMiwgeSArIDQsIGNlbGwpOwogICAgfTsKCiAgICByZXR1cm4gV2luZG93X1BhcnR5OwoKICB9KShXaW5kb3dfU2VsZWN0aW9uKTsKCiAgd2luZG93LldpbmRvd19QYXJ0eSA9IFdpbmRvd19QYXJ0eTsKCn0pLmNhbGwodGhpcyk7Cg==","decoded":true},{"name":"Window_BattleParty","content":"# ===================================================================\n#\n#   Script: Window_BattleParty\n#   Created on: 2013-09-29\n#\n#   Copyright (C) 2013 AndrÃ© Radomski. All rights reserved.\n#\n# ===================================================================\n#\n#    Class: Window_BattleParty\n#\n#    A window which displays a short information about each party member.\n#\n# ===================================================================\n\nclass Window_BattleParty extends Window_Base    \n    constructor: (x, y, w, h, viewport) ->\n        super(x, y, w, h, viewport)\n        @members = []\n        @contents = new Bitmap(@width - @padding*2, @height - @padding*2)\n        @contents.font = @nameFont\n        @columnSpacing = 0\n        @activeMember = 0\n        @cursorRect = new Rect(0, 0, 0, 0)\n        @cursorVisible = yes\n    prepare: ->\n        \n        \n    redraw: ->\n        @contents.clear()\n        @contents.font.color = Colors.ENABLED_ITEM\n        textSize = @contents.textSize(\"hg\")\n        member = null\n        s = Window_Base.scale\n        ox = 2*s\n        oy = 0\n        \n        \n        for i in [0...@members.length]\n            member = @members[i].actor\n            \n            ox = 4*s\n            oy = i * (textSize.height+6*s)\n            @contents.drawText(ox, oy, textSize.width, textSize.height, member.name)\n            ox += (100 + 6) * s\n            @drawGauge(ox, oy+4*s, 100*s, 8*s, Colors.LP_GAUGE1, Colors.LP_GAUGE2, member.lp, member.mlp)\n            ox += (100 + 6) * s \n            @drawGauge(ox, oy+4*s, 100*s, 8*s, Colors.MP_GAUGE1, Colors.MP_GAUGE2, member.mp, member.mmp)\n            ox += (100 + 6) * s \n            @drawStates(ox, oy, member.states)\n            \n    update: ->\n        super()\n        s = Window_Base.scale\n        if @activeMember != -1\n            @cursorRect.set(0, @activeMember * (23*s), @contents.width, 22*s)\n        if @activeMember == -1 or not @cursorVisible\n            @cursorRect.set(0, 0, 0, 0)\n            \n        \n        \n    \n        \nwindow.Window_BattleParty = Window_BattleParty","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBXaW5kb3dfQmF0dGxlUGFydHksCiAgICBfX2hhc1Byb3AgPSB7fS5oYXNPd25Qcm9wZXJ0eSwKICAgIF9fZXh0ZW5kcyA9IGZ1bmN0aW9uKGNoaWxkLCBwYXJlbnQpIHsgZm9yICh2YXIga2V5IGluIHBhcmVudCkgeyBpZiAoX19oYXNQcm9wLmNhbGwocGFyZW50LCBrZXkpKSBjaGlsZFtrZXldID0gcGFyZW50W2tleV07IH0gZnVuY3Rpb24gY3RvcigpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGNoaWxkOyB9IGN0b3IucHJvdG90eXBlID0gcGFyZW50LnByb3RvdHlwZTsgY2hpbGQucHJvdG90eXBlID0gbmV3IGN0b3IoKTsgY2hpbGQuX19zdXBlcl9fID0gcGFyZW50LnByb3RvdHlwZTsgcmV0dXJuIGNoaWxkOyB9OwoKICBXaW5kb3dfQmF0dGxlUGFydHkgPSAoZnVuY3Rpb24oX3N1cGVyKSB7CiAgICBfX2V4dGVuZHMoV2luZG93X0JhdHRsZVBhcnR5LCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFdpbmRvd19CYXR0bGVQYXJ0eSh4LCB5LCB3LCBoLCB2aWV3cG9ydCkgewogICAgICBXaW5kb3dfQmF0dGxlUGFydHkuX19zdXBlcl9fLmNvbnN0cnVjdG9yLmNhbGwodGhpcywgeCwgeSwgdywgaCwgdmlld3BvcnQpOwogICAgICB0aGlzLm1lbWJlcnMgPSBbXTsKICAgICAgdGhpcy5jb250ZW50cyA9IG5ldyBCaXRtYXAodGhpcy53aWR0aCAtIHRoaXMucGFkZGluZyAqIDIsIHRoaXMuaGVpZ2h0IC0gdGhpcy5wYWRkaW5nICogMik7CiAgICAgIHRoaXMuY29udGVudHMuZm9udCA9IHRoaXMubmFtZUZvbnQ7CiAgICAgIHRoaXMuY29sdW1uU3BhY2luZyA9IDA7CiAgICAgIHRoaXMuYWN0aXZlTWVtYmVyID0gMDsKICAgICAgdGhpcy5jdXJzb3JSZWN0ID0gbmV3IFJlY3QoMCwgMCwgMCwgMCk7CiAgICAgIHRoaXMuY3Vyc29yVmlzaWJsZSA9IHRydWU7CiAgICB9CgogICAgV2luZG93X0JhdHRsZVBhcnR5LnByb3RvdHlwZS5wcmVwYXJlID0gZnVuY3Rpb24oKSB7fTsKCiAgICBXaW5kb3dfQmF0dGxlUGFydHkucHJvdG90eXBlLnJlZHJhdyA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgaSwgbWVtYmVyLCBveCwgb3ksIHMsIHRleHRTaXplLCBfaSwgX3JlZiwgX3Jlc3VsdHM7CiAgICAgIHRoaXMuY29udGVudHMuY2xlYXIoKTsKICAgICAgdGhpcy5jb250ZW50cy5mb250LmNvbG9yID0gQ29sb3JzLkVOQUJMRURfSVRFTTsKICAgICAgdGV4dFNpemUgPSB0aGlzLmNvbnRlbnRzLnRleHRTaXplKCJoZyIpOwogICAgICBtZW1iZXIgPSBudWxsOwogICAgICBzID0gV2luZG93X0Jhc2Uuc2NhbGU7CiAgICAgIG94ID0gMiAqIHM7CiAgICAgIG95ID0gMDsKICAgICAgX3Jlc3VsdHMgPSBbXTsKICAgICAgZm9yIChpID0gX2kgPSAwLCBfcmVmID0gdGhpcy5tZW1iZXJzLmxlbmd0aDsgMCA8PSBfcmVmID8gX2kgPCBfcmVmIDogX2kgPiBfcmVmOyBpID0gMCA8PSBfcmVmID8gKytfaSA6IC0tX2kpIHsKICAgICAgICBtZW1iZXIgPSB0aGlzLm1lbWJlcnNbaV0uYWN0b3I7CiAgICAgICAgb3ggPSA0ICogczsKICAgICAgICBveSA9IGkgKiAodGV4dFNpemUuaGVpZ2h0ICsgNiAqIHMpOwogICAgICAgIHRoaXMuY29udGVudHMuZHJhd1RleHQob3gsIG95LCB0ZXh0U2l6ZS53aWR0aCwgdGV4dFNpemUuaGVpZ2h0LCBtZW1iZXIubmFtZSk7CiAgICAgICAgb3ggKz0gKDEwMCArIDYpICogczsKICAgICAgICB0aGlzLmRyYXdHYXVnZShveCwgb3kgKyA0ICogcywgMTAwICogcywgOCAqIHMsIENvbG9ycy5MUF9HQVVHRTEsIENvbG9ycy5MUF9HQVVHRTIsIG1lbWJlci5scCwgbWVtYmVyLm1scCk7CiAgICAgICAgb3ggKz0gKDEwMCArIDYpICogczsKICAgICAgICB0aGlzLmRyYXdHYXVnZShveCwgb3kgKyA0ICogcywgMTAwICogcywgOCAqIHMsIENvbG9ycy5NUF9HQVVHRTEsIENvbG9ycy5NUF9HQVVHRTIsIG1lbWJlci5tcCwgbWVtYmVyLm1tcCk7CiAgICAgICAgb3ggKz0gKDEwMCArIDYpICogczsKICAgICAgICBfcmVzdWx0cy5wdXNoKHRoaXMuZHJhd1N0YXRlcyhveCwgb3ksIG1lbWJlci5zdGF0ZXMpKTsKICAgICAgfQogICAgICByZXR1cm4gX3Jlc3VsdHM7CiAgICB9OwoKICAgIFdpbmRvd19CYXR0bGVQYXJ0eS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBzOwogICAgICBXaW5kb3dfQmF0dGxlUGFydHkuX19zdXBlcl9fLnVwZGF0ZS5jYWxsKHRoaXMpOwogICAgICBzID0gV2luZG93X0Jhc2Uuc2NhbGU7CiAgICAgIGlmICh0aGlzLmFjdGl2ZU1lbWJlciAhPT0gLTEpIHsKICAgICAgICB0aGlzLmN1cnNvclJlY3Quc2V0KDAsIHRoaXMuYWN0aXZlTWVtYmVyICogKDIzICogcyksIHRoaXMuY29udGVudHMud2lkdGgsIDIyICogcyk7CiAgICAgIH0KICAgICAgaWYgKHRoaXMuYWN0aXZlTWVtYmVyID09PSAtMSB8fCAhdGhpcy5jdXJzb3JWaXNpYmxlKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuY3Vyc29yUmVjdC5zZXQoMCwgMCwgMCwgMCk7CiAgICAgIH0KICAgIH07CgogICAgcmV0dXJuIFdpbmRvd19CYXR0bGVQYXJ0eTsKCiAgfSkoV2luZG93X0Jhc2UpOwoKICB3aW5kb3cuV2luZG93X0JhdHRsZVBhcnR5ID0gV2luZG93X0JhdHRsZVBhcnR5OwoKfSkuY2FsbCh0aGlzKTsK","decoded":true},{"name":"Window_Status","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogV2luZG93X1N0YXR1cwojICAgQ3JlYXRlZCBvbjogMjAxMy0wOS0xNQojCiMgICBDb3B5cmlnaHQgKEMpIDIwMTMgQW5kcukgUmFkb21za2kuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgICBDbGFzczogV2luZG93X1N0YXR1cwojCiMgICBBIHdpbmRvdyB3aGljaCBkaXNwbGF5cyBzdGF0dXMgaW5mb3JtYXRpb24gYWJvdXQgYSBwYXJ0eSBtZW1iZXIuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpjbGFzcyBXaW5kb3dfU3RhdHVzIGV4dGVuZHMgV2luZG93X0Jhc2UKICAgIGNvbnN0cnVjdG9yOiAtPgogICAgICAgIHN1cGVyKDE3NCAqIFdpbmRvd19CYXNlLnNjYWxlLCAxMTQgKiBXaW5kb3dfQmFzZS5zY2FsZSwgNDY2ICogV2luZG93X0Jhc2Uuc2NhbGUsIEdyYXBoaWNzLmhlaWdodCAtIDExNCAqIFdpbmRvd19CYXNlLnNjYWxlKQogICAgICAgIEBtZW1iZXIgPSBudWxsCiAgICAgICAgQGNvbnRlbnRzID0gbmV3IEJpdG1hcChAd2lkdGggLSBAcGFkZGluZyoyLCBAaGVpZ2h0IC0gQHBhZGRpbmcqMikKICAgICAgICBAY29udGVudHMuZm9udCA9IEBuYW1lRm9udAogICAgcmVkcmF3OiAtPgogICAgICAgIEBjb25zdHJ1Y3Rvci5zY2FsZSA9IFdpbmRvd19CYXNlLnNjYWxlCiAgICAgICAgY2hhcmFjdGVyU2l6ZSA9IG51bGwKICAgICAgICB2b2NhYiA9IFJlY29yZE1hbmFnZXIudm9jYWJ1bGFyeQogICAgICAgIG94ID0gMAogICAgICAgIG95ID0gMAogICAgICAgIHRleHRTaXplID0gbnVsbAogICAgICAgIG1lbWJlciA9IEBtZW1iZXIKICAgICAgICAKICAgICAgICBAY29udGVudHMuY2xlYXIoKQogICAgICAgIGlmIEBtZW1iZXI/CiAgICAgICAgICAgIGNoYXJhY3RlclNpemUgPSBAbWVtYmVyQ2hhcmFjdGVyU2l6ZShAbWVtYmVyKQogICAgICAgICAgICBAZHJhd01lbWJlckZhY2UoMCwgMCwgQG1lbWJlcikKICAgICAgICAgICAgb3ggKz0gOTYgKiBAY29uc3RydWN0b3Iuc2NhbGUKICAgICAgICAgICAgI0BkcmF3TWVtYmVyQ2hhcmFjdGVyKDgwICogQGNvbnN0cnVjdG9yLnNjYWxlICogQGNvbnN0cnVjdG9yLnNjYWxlICsgTWF0aC5mbG9vcigoODAgKiBAY29uc3RydWN0b3Iuc2NhbGUgLSBjaGFyYWN0ZXJTaXplLncpIC8gMiksIAogICAgICAgICAgICAgIyAgICAgICAgICAgICAgICAgICAgTWF0aC5mbG9vcigoODAgKiBAY29uc3RydWN0b3Iuc2NhbGUgLSBjaGFyYWN0ZXJTaXplLmgpIC8gMiksIEBtZW1iZXIpCiAgICAgICAgICAgICNveCArPSA4MCAqIEBjb25zdHJ1Y3Rvci5zY2FsZSArIDEwICogQGNvbnN0cnVjdG9yLnNjYWxlCiAgICAgICAgICAgIG94ICs9IDEwICogQGNvbnN0cnVjdG9yLnNjYWxlCiAgICAgICAgICAgIG95ID0gMgogICAgICAgICAgICB0ZXh0U2l6ZSA9IG51bGwKICAgICAgICAgICAgQGNvbnRlbnRzLmZvbnQgPSBAbmFtZUZvbnQKICAgICAgICAgICAgaWYgQG1lbWJlci5uYW1lLmxlbmd0aCA+IDAKICAgICAgICAgICAgICAgIHRleHRTaXplID0gQGNvbnRlbnRzLnRleHRTaXplKEBtZW1iZXIubmFtZSkKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgdGV4dFNpemUgPSBAY29udGVudHMudGV4dFNpemUoIkgiKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgbGluZVNwYWNlID0gMCAqIEBjb25zdHJ1Y3Rvci5zY2FsZQogICAgICAgICAgICAKICAgICAgICAgICAgQGNvbnRlbnRzLmRyYXdUZXh0KG94LCBveSwgQGNvbnRlbnRzLndpZHRoIC0gb3gsIHRleHRTaXplLmhlaWdodCwgQG1lbWJlci5uYW1lLCAwKQogICAgICAgICAgICBAY29udGVudHMuZHJhd1RleHQob3gsIG95ICsgbGluZVNwYWNlICsgdGV4dFNpemUuaGVpZ2h0LCBAY29udGVudHMud2lkdGggLSBveCwgdGV4dFNpemUuaGVpZ2h0LCBsY3Modm9jYWIubWVudS5sZXZlbCksIDApCiAgICAgICAgICAgIEBjb250ZW50cy5kcmF3VGV4dChveCwgb3kgKyAobGluZVNwYWNlICsgdGV4dFNpemUuaGVpZ2h0KSoyLCBAY29udGVudHMud2lkdGggLSBveCwgdGV4dFNpemUuaGVpZ2h0LCBsY3Modm9jYWIubWVudS5leHApLCAwKQogICAgICAgICAgICBAY29udGVudHMuZHJhd1RleHQob3gsIG95ICsgKGxpbmVTcGFjZSArIHRleHRTaXplLmhlaWdodCkqMywgQGNvbnRlbnRzLndpZHRoIC0gb3gsIHRleHRTaXplLmhlaWdodCwgbGNzKHZvY2FiLm1lbnUudG9OZXh0TGV2ZWwpLCAwKQogICAgICAgICAgICAKICAgICAgICAgICAgb3ggKz0gMTUwICogQGNvbnN0cnVjdG9yLnNjYWxlCiAgICAgICAgICAgIEBjb250ZW50cy5kcmF3VGV4dChveCwgb3ksIEBjb250ZW50cy53aWR0aCAtIG94LCB0ZXh0U2l6ZS5oZWlnaHQsICIje21lbWJlci5jbGFzcy5uYW1lfSIsIDApCiAgICAgICAgICAgIEBjb250ZW50cy5kcmF3VGV4dChveCwgb3kgKyBsaW5lU3BhY2UgKyB0ZXh0U2l6ZS5oZWlnaHQsIEBjb250ZW50cy53aWR0aCAtIG94LCB0ZXh0U2l6ZS5oZWlnaHQsICIje21lbWJlci5sZXZlbH0iLCAwKQogICAgICAgICAgICBAY29udGVudHMuZHJhd1RleHQob3gsIG95ICsgKGxpbmVTcGFjZSArIHRleHRTaXplLmhlaWdodCkqMiwgQGNvbnRlbnRzLndpZHRoIC0gb3gsIHRleHRTaXplLmhlaWdodCwgIiN7bWVtYmVyLmV4cH0iLCAwKQogICAgICAgICAgICBAY29udGVudHMuZHJhd1RleHQob3gsIG95ICsgKGxpbmVTcGFjZSArIHRleHRTaXplLmhlaWdodCkqMywgQGNvbnRlbnRzLndpZHRoIC0gb3gsIHRleHRTaXplLmhlaWdodCwgIiN7bWVtYmVyLmV4cFRvTmV4dExldmVsfSIsIDApCiAgICAgICAgICAgIAogICAgICAgICAgICBveCA9IDAKICAgICAgICAgICAgb3kgPSAxMDAgKiBAY29uc3RydWN0b3Iuc2NhbGUgKyA1CiAgICAgICAgICAgIEBkcmF3R2F1Z2Uob3gsIG95LCAxNjAgKiBAY29uc3RydWN0b3Iuc2NhbGUsIDggKiBAY29uc3RydWN0b3Iuc2NhbGUsIENvbG9ycy5MUF9HQVVHRTEsIENvbG9ycy5MUF9HQVVHRTIsIG1lbWJlci5scCwgbWVtYmVyLm1scCkKICAgICAgICAgICAgQGRyYXdHYXVnZShveCwgb3kgKyAyMCAqIEBjb25zdHJ1Y3Rvci5zY2FsZSwgMTYwICogQGNvbnN0cnVjdG9yLnNjYWxlLCA4ICogQGNvbnN0cnVjdG9yLnNjYWxlLCBDb2xvcnMuTVBfR0FVR0UxLCBDb2xvcnMuTVBfR0FVR0UyLCBtZW1iZXIubXAsIG1lbWJlci5tbXApCiAgICAgICAgICAgIEBkcmF3U3RhdHVzKG94LCBveSArIDQwICogQGNvbnN0cnVjdG9yLnNjYWxlLCAxNjAgKiBAY29uc3RydWN0b3Iuc2NhbGUsICJOb3JtYWwiKQogICAgICAgICAgICAKICAgICAgICAgICAgb3kgKz0gNzAgKiBAY29uc3RydWN0b3Iuc2NhbGUKICAgICAgICAgICAgQGNvbnRlbnRzLmRyYXdUZXh0KG94LCBveSwgQGNvbnRlbnRzLndpZHRoIC0gb3gsIHRleHRTaXplLmhlaWdodCwgbGNzKHZvY2FiLnBhcmFtZXRlcnMuYXRrKSwgMCkKICAgICAgICAgICAgb3kgKz0gbGluZVNwYWNlCiAgICAgICAgICAgIEBjb250ZW50cy5kcmF3VGV4dChveCwgb3kgKyB0ZXh0U2l6ZS5oZWlnaHQsIEBjb250ZW50cy53aWR0aCAtIG94LCB0ZXh0U2l6ZS5oZWlnaHQsIGxjcyh2b2NhYi5wYXJhbWV0ZXJzLm1hdCksIDApCiAgICAgICAgICAgIG95ICs9IGxpbmVTcGFjZQogICAgICAgICAgICBAY29udGVudHMuZHJhd1RleHQob3gsIG95ICsgdGV4dFNpemUuaGVpZ2h0KjIsIEBjb250ZW50cy53aWR0aCAtIG94LCB0ZXh0U2l6ZS5oZWlnaHQsIGxjcyh2b2NhYi5wYXJhbWV0ZXJzLmRlZiksIDApCiAgICAgICAgICAgIG95ICs9IGxpbmVTcGFjZQogICAgICAgICAgICBAY29udGVudHMuZHJhd1RleHQob3gsIG95ICsgdGV4dFNpemUuaGVpZ2h0KjMsIEBjb250ZW50cy53aWR0aCAtIG94LCB0ZXh0U2l6ZS5oZWlnaHQsIGxjcyh2b2NhYi5wYXJhbWV0ZXJzLm1kZiksIDApCiAgICAgICAgICAgIG95ICs9IGxpbmVTcGFjZQogICAgICAgICAgICBAY29udGVudHMuZHJhd1RleHQob3gsIG95ICsgdGV4dFNpemUuaGVpZ2h0KjQsIEBjb250ZW50cy53aWR0aCAtIG94LCB0ZXh0U2l6ZS5oZWlnaHQsIGxjcyh2b2NhYi5wYXJhbWV0ZXJzLmFnaSksIDApCiAgICAgICAgICAgIG95ICs9IGxpbmVTcGFjZQogICAgICAgICAgICBAY29udGVudHMuZHJhd1RleHQob3gsIG95ICsgdGV4dFNpemUuaGVpZ2h0KjUsIEBjb250ZW50cy53aWR0aCAtIG94LCB0ZXh0U2l6ZS5oZWlnaHQsIGxjcyh2b2NhYi5wYXJhbWV0ZXJzLmx1ayksIDApCiAgICAgICAgICAgIG95ICs9IGxpbmVTcGFjZQogICAgICAgICAgICAKICAgICAgICAgICAgb3ggKz0gNjAgKiBAY29uc3RydWN0b3Iuc2NhbGUKICAgICAgICAgICAgb3kgLT0gbGluZVNwYWNlICogNgogICAgICAgICAgICBAY29udGVudHMuZHJhd1RleHQob3gsIG95LCBAY29udGVudHMud2lkdGggLSBveCwgdGV4dFNpemUuaGVpZ2h0LCAiI3ttZW1iZXIuYXRrfSIsIDApCiAgICAgICAgICAgIG95ICs9IGxpbmVTcGFjZQogICAgICAgICAgICBAY29udGVudHMuZHJhd1RleHQob3gsIG95ICsgdGV4dFNpemUuaGVpZ2h0LCBAY29udGVudHMud2lkdGggLSBveCwgdGV4dFNpemUuaGVpZ2h0LCAiI3ttZW1iZXIubWF0fSIsIDApCiAgICAgICAgICAgIG95ICs9IGxpbmVTcGFjZQogICAgICAgICAgICBAY29udGVudHMuZHJhd1RleHQob3gsIG95ICsgdGV4dFNpemUuaGVpZ2h0KjIsIEBjb250ZW50cy53aWR0aCAtIG94LCB0ZXh0U2l6ZS5oZWlnaHQsICIje21lbWJlci5kZWZ9IiwgMCkKICAgICAgICAgICAgb3kgKz0gbGluZVNwYWNlCiAgICAgICAgICAgIEBjb250ZW50cy5kcmF3VGV4dChveCwgb3kgKyB0ZXh0U2l6ZS5oZWlnaHQqMywgQGNvbnRlbnRzLndpZHRoIC0gb3gsIHRleHRTaXplLmhlaWdodCwgIiN7bWVtYmVyLm1kZn0iLCAwKQogICAgICAgICAgICBveSArPSBsaW5lU3BhY2UKICAgICAgICAgICAgQGNvbnRlbnRzLmRyYXdUZXh0KG94LCBveSArIHRleHRTaXplLmhlaWdodCo0LCBAY29udGVudHMud2lkdGggLSBveCwgdGV4dFNpemUuaGVpZ2h0LCAiI3ttZW1iZXIuYWdpfSIsIDApCiAgICAgICAgICAgIG95ICs9IGxpbmVTcGFjZQogICAgICAgICAgICBAY29udGVudHMuZHJhd1RleHQob3gsIG95ICsgdGV4dFNpemUuaGVpZ2h0KjUsIEBjb250ZW50cy53aWR0aCAtIG94LCB0ZXh0U2l6ZS5oZWlnaHQsICIje21lbWJlci5sdWt9IiwgMCkKICAgICAgICAgICAgb3kgKz0gbGluZVNwYWNlCiAgICAgICAgICAgIAogICAgICAgICAgICBveCArPSA1MCAqIEBjb25zdHJ1Y3Rvci5zY2FsZQogICAgICAgICAgICBveSAtPSBsaW5lU3BhY2UgKiA2CiAgICAgICAgICAgIEBjb250ZW50cy5kcmF3VGV4dChveCwgb3ksIEBjb250ZW50cy53aWR0aCAtIG94LCB0ZXh0U2l6ZS5oZWlnaHQsIGxjcyh2b2NhYi5lcXVpcFNsb3RzLndlYXBvbiksIDApCiAgICAgICAgICAgIG95ICs9IGxpbmVTcGFjZQogICAgICAgICAgICBAY29udGVudHMuZHJhd1RleHQob3gsIG95ICsgdGV4dFNpemUuaGVpZ2h0LCBAY29udGVudHMud2lkdGggLSBveCwgdGV4dFNpemUuaGVpZ2h0LCBsY3Modm9jYWIuZXF1aXBTbG90cy5zaGllbGQpLCAwKQogICAgICAgICAgICBveSArPSBsaW5lU3BhY2UKICAgICAgICAgICAgQGNvbnRlbnRzLmRyYXdUZXh0KG94LCBveSArIHRleHRTaXplLmhlaWdodCoyLCBAY29udGVudHMud2lkdGggLSBveCwgdGV4dFNpemUuaGVpZ2h0LCBsY3Modm9jYWIuZXF1aXBTbG90cy5oZWFkQXJtb3IpLCAwKQogICAgICAgICAgICBveSArPSBsaW5lU3BhY2UKICAgICAgICAgICAgQGNvbnRlbnRzLmRyYXdUZXh0KG94LCBveSArIHRleHRTaXplLmhlaWdodCozLCBAY29udGVudHMud2lkdGggLSBveCwgdGV4dFNpemUuaGVpZ2h0LCBsY3Modm9jYWIuZXF1aXBTbG90cy5ib2R5QXJtb3IpLCAwKQogICAgICAgICAgICBveSArPSBsaW5lU3BhY2UKICAgICAgICAgICAgQGNvbnRlbnRzLmRyYXdUZXh0KG94LCBveSArIHRleHRTaXplLmhlaWdodCo0LCBAY29udGVudHMud2lkdGggLSBveCwgdGV4dFNpemUuaGVpZ2h0LCBsY3Modm9jYWIuZXF1aXBTbG90cy5hY2Nlc3NvcnkpLCAwKQogICAgICAgICAgICBveSArPSBsaW5lU3BhY2UKICAgICAgICAgICAgCiAgICAgICAgICAgIAogICAgICAgICAgICBveCArPSAxNDIgKiBAY29uc3RydWN0b3Iuc2NhbGUKICAgICAgICAgICAgb3kgLT0gbGluZVNwYWNlICogNQogICAgICAgICAgICBAY29udGVudHMuZHJhd1RleHQob3gsIG95LCBAY29udGVudHMud2lkdGggLSBveCwgdGV4dFNpemUuaGVpZ2h0LCAoaWYgbWVtYmVyLndlYXBvbj8gdGhlbiBtZW1iZXIud2VhcG9uLm5hbWUgZWxzZSAiIiksIDApCiAgICAgICAgICAgIG95ICs9IGxpbmVTcGFjZQogICAgICAgICAgICBAY29udGVudHMuZHJhd1RleHQob3gsIG95ICsgdGV4dFNpemUuaGVpZ2h0LCBAY29udGVudHMud2lkdGggLSBveCwgdGV4dFNpemUuaGVpZ2h0LCAoaWYgbWVtYmVyLnNoaWVsZD8gdGhlbiBtZW1iZXIuc2hpZWxkLm5hbWUgZWxzZSAiIiksIDApCiAgICAgICAgICAgIG95ICs9IGxpbmVTcGFjZQogICAgICAgICAgICBAY29udGVudHMuZHJhd1RleHQob3gsIG95ICsgdGV4dFNpemUuaGVpZ2h0KjIsIEBjb250ZW50cy53aWR0aCAtIG94LCB0ZXh0U2l6ZS5oZWlnaHQsIChpZiBtZW1iZXIuaGVhZD8gdGhlbiBtZW1iZXIuaGVhZC5uYW1lIGVsc2UgIiIpLCAwKQogICAgICAgICAgICBveSArPSBsaW5lU3BhY2UKICAgICAgICAgICAgQGNvbnRlbnRzLmRyYXdUZXh0KG94LCBveSArIHRleHRTaXplLmhlaWdodCozLCBAY29udGVudHMud2lkdGggLSBveCwgdGV4dFNpemUuaGVpZ2h0LCAoaWYgbWVtYmVyLmJvZHk/IHRoZW4gbWVtYmVyLmJvZHkubmFtZSBlbHNlICIiKSwgMCkKICAgICAgICAgICAgb3kgKz0gbGluZVNwYWNlCiAgICAgICAgICAgIEBjb250ZW50cy5kcmF3VGV4dChveCwgb3kgKyB0ZXh0U2l6ZS5oZWlnaHQqNCwgQGNvbnRlbnRzLndpZHRoIC0gb3gsIHRleHRTaXplLmhlaWdodCwgKGlmIG1lbWJlci5hY2Nlc3Nvcnk/IHRoZW4gbWVtYmVyLmFjY2Vzc29yeS5uYW1lIGVsc2UgIiIpLCAwKQogICAgICAgICAgICBveSArPSBsaW5lU3BhY2UKICAgICAgICAgICAgCiAgICAgICAgICAgIAogICAgICAgICAgICBveSArPSB0ZXh0U2l6ZS5oZWlnaHQqOQogICAgICAgICAgICBveCA9IDAKICAgICAgICAgICAgCiAgICAgICAgICAgIGRlc2NyaXB0aW9uID0gbWVtYmVyLmFjdG9yLmRlc2NyaXB0aW9uLnNwbGl0KCJcbiIpCiAgICAgICAgICAgIGZvciBpIGluIFswLi4uZGVzY3JpcHRpb24ubGVuZ3RoXQogICAgICAgICAgICAgICAgQGNvbnRlbnRzLmRyYXdUZXh0KG94LCBveSArIHRleHRTaXplLmhlaWdodCppLCBAY29udGVudHMud2lkdGggLSBveCwgdGV4dFNpemUuaGVpZ2h0LCBkZXNjcmlwdGlvbltpXSwgMCkKICAgICAgICAgICAgCiAgICAgICAgICAgIAp3aW5kb3cuV2luZG93X1N0YXR1cyA9IFdpbmRvd19TdGF0dXM=","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBXaW5kb3dfU3RhdHVzLAogICAgX19oYXNQcm9wID0ge30uaGFzT3duUHJvcGVydHksCiAgICBfX2V4dGVuZHMgPSBmdW5jdGlvbihjaGlsZCwgcGFyZW50KSB7IGZvciAodmFyIGtleSBpbiBwYXJlbnQpIHsgaWYgKF9faGFzUHJvcC5jYWxsKHBhcmVudCwga2V5KSkgY2hpbGRba2V5XSA9IHBhcmVudFtrZXldOyB9IGZ1bmN0aW9uIGN0b3IoKSB7IHRoaXMuY29uc3RydWN0b3IgPSBjaGlsZDsgfSBjdG9yLnByb3RvdHlwZSA9IHBhcmVudC5wcm90b3R5cGU7IGNoaWxkLnByb3RvdHlwZSA9IG5ldyBjdG9yKCk7IGNoaWxkLl9fc3VwZXJfXyA9IHBhcmVudC5wcm90b3R5cGU7IHJldHVybiBjaGlsZDsgfTsKCiAgV2luZG93X1N0YXR1cyA9IChmdW5jdGlvbihfc3VwZXIpIHsKICAgIF9fZXh0ZW5kcyhXaW5kb3dfU3RhdHVzLCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFdpbmRvd19TdGF0dXMoKSB7CiAgICAgIFdpbmRvd19TdGF0dXMuX19zdXBlcl9fLmNvbnN0cnVjdG9yLmNhbGwodGhpcywgMTc0ICogV2luZG93X0Jhc2Uuc2NhbGUsIDExNCAqIFdpbmRvd19CYXNlLnNjYWxlLCA0NjYgKiBXaW5kb3dfQmFzZS5zY2FsZSwgR3JhcGhpY3MuaGVpZ2h0IC0gMTE0ICogV2luZG93X0Jhc2Uuc2NhbGUpOwogICAgICB0aGlzLm1lbWJlciA9IG51bGw7CiAgICAgIHRoaXMuY29udGVudHMgPSBuZXcgQml0bWFwKHRoaXMud2lkdGggLSB0aGlzLnBhZGRpbmcgKiAyLCB0aGlzLmhlaWdodCAtIHRoaXMucGFkZGluZyAqIDIpOwogICAgICB0aGlzLmNvbnRlbnRzLmZvbnQgPSB0aGlzLm5hbWVGb250OwogICAgfQoKICAgIFdpbmRvd19TdGF0dXMucHJvdG90eXBlLnJlZHJhdyA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgY2hhcmFjdGVyU2l6ZSwgZGVzY3JpcHRpb24sIGksIGxpbmVTcGFjZSwgbWVtYmVyLCBveCwgb3ksIHRleHRTaXplLCB2b2NhYiwgX2ksIF9yZWYsIF9yZXN1bHRzOwogICAgICB0aGlzLmNvbnN0cnVjdG9yLnNjYWxlID0gV2luZG93X0Jhc2Uuc2NhbGU7CiAgICAgIGNoYXJhY3RlclNpemUgPSBudWxsOwogICAgICB2b2NhYiA9IFJlY29yZE1hbmFnZXIudm9jYWJ1bGFyeTsKICAgICAgb3ggPSAwOwogICAgICBveSA9IDA7CiAgICAgIHRleHRTaXplID0gbnVsbDsKICAgICAgbWVtYmVyID0gdGhpcy5tZW1iZXI7CiAgICAgIHRoaXMuY29udGVudHMuY2xlYXIoKTsKICAgICAgaWYgKHRoaXMubWVtYmVyICE9IG51bGwpIHsKICAgICAgICBjaGFyYWN0ZXJTaXplID0gdGhpcy5tZW1iZXJDaGFyYWN0ZXJTaXplKHRoaXMubWVtYmVyKTsKICAgICAgICB0aGlzLmRyYXdNZW1iZXJGYWNlKDAsIDAsIHRoaXMubWVtYmVyKTsKICAgICAgICBveCArPSA5NiAqIHRoaXMuY29uc3RydWN0b3Iuc2NhbGU7CiAgICAgICAgb3ggKz0gMTAgKiB0aGlzLmNvbnN0cnVjdG9yLnNjYWxlOwogICAgICAgIG95ID0gMjsKICAgICAgICB0ZXh0U2l6ZSA9IG51bGw7CiAgICAgICAgdGhpcy5jb250ZW50cy5mb250ID0gdGhpcy5uYW1lRm9udDsKICAgICAgICBpZiAodGhpcy5tZW1iZXIubmFtZS5sZW5ndGggPiAwKSB7CiAgICAgICAgICB0ZXh0U2l6ZSA9IHRoaXMuY29udGVudHMudGV4dFNpemUodGhpcy5tZW1iZXIubmFtZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRleHRTaXplID0gdGhpcy5jb250ZW50cy50ZXh0U2l6ZSgiSCIpOwogICAgICAgIH0KICAgICAgICBsaW5lU3BhY2UgPSAwICogdGhpcy5jb25zdHJ1Y3Rvci5zY2FsZTsKICAgICAgICB0aGlzLmNvbnRlbnRzLmRyYXdUZXh0KG94LCBveSwgdGhpcy5jb250ZW50cy53aWR0aCAtIG94LCB0ZXh0U2l6ZS5oZWlnaHQsIHRoaXMubWVtYmVyLm5hbWUsIDApOwogICAgICAgIHRoaXMuY29udGVudHMuZHJhd1RleHQob3gsIG95ICsgbGluZVNwYWNlICsgdGV4dFNpemUuaGVpZ2h0LCB0aGlzLmNvbnRlbnRzLndpZHRoIC0gb3gsIHRleHRTaXplLmhlaWdodCwgbGNzKHZvY2FiLm1lbnUubGV2ZWwpLCAwKTsKICAgICAgICB0aGlzLmNvbnRlbnRzLmRyYXdUZXh0KG94LCBveSArIChsaW5lU3BhY2UgKyB0ZXh0U2l6ZS5oZWlnaHQpICogMiwgdGhpcy5jb250ZW50cy53aWR0aCAtIG94LCB0ZXh0U2l6ZS5oZWlnaHQsIGxjcyh2b2NhYi5tZW51LmV4cCksIDApOwogICAgICAgIHRoaXMuY29udGVudHMuZHJhd1RleHQob3gsIG95ICsgKGxpbmVTcGFjZSArIHRleHRTaXplLmhlaWdodCkgKiAzLCB0aGlzLmNvbnRlbnRzLndpZHRoIC0gb3gsIHRleHRTaXplLmhlaWdodCwgbGNzKHZvY2FiLm1lbnUudG9OZXh0TGV2ZWwpLCAwKTsKICAgICAgICBveCArPSAxNTAgKiB0aGlzLmNvbnN0cnVjdG9yLnNjYWxlOwogICAgICAgIHRoaXMuY29udGVudHMuZHJhd1RleHQob3gsIG95LCB0aGlzLmNvbnRlbnRzLndpZHRoIC0gb3gsIHRleHRTaXplLmhlaWdodCwgIiIgKyBtZW1iZXJbImNsYXNzIl0ubmFtZSwgMCk7CiAgICAgICAgdGhpcy5jb250ZW50cy5kcmF3VGV4dChveCwgb3kgKyBsaW5lU3BhY2UgKyB0ZXh0U2l6ZS5oZWlnaHQsIHRoaXMuY29udGVudHMud2lkdGggLSBveCwgdGV4dFNpemUuaGVpZ2h0LCAiIiArIG1lbWJlci5sZXZlbCwgMCk7CiAgICAgICAgdGhpcy5jb250ZW50cy5kcmF3VGV4dChveCwgb3kgKyAobGluZVNwYWNlICsgdGV4dFNpemUuaGVpZ2h0KSAqIDIsIHRoaXMuY29udGVudHMud2lkdGggLSBveCwgdGV4dFNpemUuaGVpZ2h0LCAiIiArIG1lbWJlci5leHAsIDApOwogICAgICAgIHRoaXMuY29udGVudHMuZHJhd1RleHQob3gsIG95ICsgKGxpbmVTcGFjZSArIHRleHRTaXplLmhlaWdodCkgKiAzLCB0aGlzLmNvbnRlbnRzLndpZHRoIC0gb3gsIHRleHRTaXplLmhlaWdodCwgIiIgKyBtZW1iZXIuZXhwVG9OZXh0TGV2ZWwsIDApOwogICAgICAgIG94ID0gMDsKICAgICAgICBveSA9IDEwMCAqIHRoaXMuY29uc3RydWN0b3Iuc2NhbGUgKyA1OwogICAgICAgIHRoaXMuZHJhd0dhdWdlKG94LCBveSwgMTYwICogdGhpcy5jb25zdHJ1Y3Rvci5zY2FsZSwgOCAqIHRoaXMuY29uc3RydWN0b3Iuc2NhbGUsIENvbG9ycy5MUF9HQVVHRTEsIENvbG9ycy5MUF9HQVVHRTIsIG1lbWJlci5scCwgbWVtYmVyLm1scCk7CiAgICAgICAgdGhpcy5kcmF3R2F1Z2Uob3gsIG95ICsgMjAgKiB0aGlzLmNvbnN0cnVjdG9yLnNjYWxlLCAxNjAgKiB0aGlzLmNvbnN0cnVjdG9yLnNjYWxlLCA4ICogdGhpcy5jb25zdHJ1Y3Rvci5zY2FsZSwgQ29sb3JzLk1QX0dBVUdFMSwgQ29sb3JzLk1QX0dBVUdFMiwgbWVtYmVyLm1wLCBtZW1iZXIubW1wKTsKICAgICAgICB0aGlzLmRyYXdTdGF0dXMob3gsIG95ICsgNDAgKiB0aGlzLmNvbnN0cnVjdG9yLnNjYWxlLCAxNjAgKiB0aGlzLmNvbnN0cnVjdG9yLnNjYWxlLCAiTm9ybWFsIik7CiAgICAgICAgb3kgKz0gNzAgKiB0aGlzLmNvbnN0cnVjdG9yLnNjYWxlOwogICAgICAgIHRoaXMuY29udGVudHMuZHJhd1RleHQob3gsIG95LCB0aGlzLmNvbnRlbnRzLndpZHRoIC0gb3gsIHRleHRTaXplLmhlaWdodCwgbGNzKHZvY2FiLnBhcmFtZXRlcnMuYXRrKSwgMCk7CiAgICAgICAgb3kgKz0gbGluZVNwYWNlOwogICAgICAgIHRoaXMuY29udGVudHMuZHJhd1RleHQob3gsIG95ICsgdGV4dFNpemUuaGVpZ2h0LCB0aGlzLmNvbnRlbnRzLndpZHRoIC0gb3gsIHRleHRTaXplLmhlaWdodCwgbGNzKHZvY2FiLnBhcmFtZXRlcnMubWF0KSwgMCk7CiAgICAgICAgb3kgKz0gbGluZVNwYWNlOwogICAgICAgIHRoaXMuY29udGVudHMuZHJhd1RleHQob3gsIG95ICsgdGV4dFNpemUuaGVpZ2h0ICogMiwgdGhpcy5jb250ZW50cy53aWR0aCAtIG94LCB0ZXh0U2l6ZS5oZWlnaHQsIGxjcyh2b2NhYi5wYXJhbWV0ZXJzLmRlZiksIDApOwogICAgICAgIG95ICs9IGxpbmVTcGFjZTsKICAgICAgICB0aGlzLmNvbnRlbnRzLmRyYXdUZXh0KG94LCBveSArIHRleHRTaXplLmhlaWdodCAqIDMsIHRoaXMuY29udGVudHMud2lkdGggLSBveCwgdGV4dFNpemUuaGVpZ2h0LCBsY3Modm9jYWIucGFyYW1ldGVycy5tZGYpLCAwKTsKICAgICAgICBveSArPSBsaW5lU3BhY2U7CiAgICAgICAgdGhpcy5jb250ZW50cy5kcmF3VGV4dChveCwgb3kgKyB0ZXh0U2l6ZS5oZWlnaHQgKiA0LCB0aGlzLmNvbnRlbnRzLndpZHRoIC0gb3gsIHRleHRTaXplLmhlaWdodCwgbGNzKHZvY2FiLnBhcmFtZXRlcnMuYWdpKSwgMCk7CiAgICAgICAgb3kgKz0gbGluZVNwYWNlOwogICAgICAgIHRoaXMuY29udGVudHMuZHJhd1RleHQob3gsIG95ICsgdGV4dFNpemUuaGVpZ2h0ICogNSwgdGhpcy5jb250ZW50cy53aWR0aCAtIG94LCB0ZXh0U2l6ZS5oZWlnaHQsIGxjcyh2b2NhYi5wYXJhbWV0ZXJzLmx1ayksIDApOwogICAgICAgIG95ICs9IGxpbmVTcGFjZTsKICAgICAgICBveCArPSA2MCAqIHRoaXMuY29uc3RydWN0b3Iuc2NhbGU7CiAgICAgICAgb3kgLT0gbGluZVNwYWNlICogNjsKICAgICAgICB0aGlzLmNvbnRlbnRzLmRyYXdUZXh0KG94LCBveSwgdGhpcy5jb250ZW50cy53aWR0aCAtIG94LCB0ZXh0U2l6ZS5oZWlnaHQsICIiICsgbWVtYmVyLmF0aywgMCk7CiAgICAgICAgb3kgKz0gbGluZVNwYWNlOwogICAgICAgIHRoaXMuY29udGVudHMuZHJhd1RleHQob3gsIG95ICsgdGV4dFNpemUuaGVpZ2h0LCB0aGlzLmNvbnRlbnRzLndpZHRoIC0gb3gsIHRleHRTaXplLmhlaWdodCwgIiIgKyBtZW1iZXIubWF0LCAwKTsKICAgICAgICBveSArPSBsaW5lU3BhY2U7CiAgICAgICAgdGhpcy5jb250ZW50cy5kcmF3VGV4dChveCwgb3kgKyB0ZXh0U2l6ZS5oZWlnaHQgKiAyLCB0aGlzLmNvbnRlbnRzLndpZHRoIC0gb3gsIHRleHRTaXplLmhlaWdodCwgIiIgKyBtZW1iZXIuZGVmLCAwKTsKICAgICAgICBveSArPSBsaW5lU3BhY2U7CiAgICAgICAgdGhpcy5jb250ZW50cy5kcmF3VGV4dChveCwgb3kgKyB0ZXh0U2l6ZS5oZWlnaHQgKiAzLCB0aGlzLmNvbnRlbnRzLndpZHRoIC0gb3gsIHRleHRTaXplLmhlaWdodCwgIiIgKyBtZW1iZXIubWRmLCAwKTsKICAgICAgICBveSArPSBsaW5lU3BhY2U7CiAgICAgICAgdGhpcy5jb250ZW50cy5kcmF3VGV4dChveCwgb3kgKyB0ZXh0U2l6ZS5oZWlnaHQgKiA0LCB0aGlzLmNvbnRlbnRzLndpZHRoIC0gb3gsIHRleHRTaXplLmhlaWdodCwgIiIgKyBtZW1iZXIuYWdpLCAwKTsKICAgICAgICBveSArPSBsaW5lU3BhY2U7CiAgICAgICAgdGhpcy5jb250ZW50cy5kcmF3VGV4dChveCwgb3kgKyB0ZXh0U2l6ZS5oZWlnaHQgKiA1LCB0aGlzLmNvbnRlbnRzLndpZHRoIC0gb3gsIHRleHRTaXplLmhlaWdodCwgIiIgKyBtZW1iZXIubHVrLCAwKTsKICAgICAgICBveSArPSBsaW5lU3BhY2U7CiAgICAgICAgb3ggKz0gNTAgKiB0aGlzLmNvbnN0cnVjdG9yLnNjYWxlOwogICAgICAgIG95IC09IGxpbmVTcGFjZSAqIDY7CiAgICAgICAgdGhpcy5jb250ZW50cy5kcmF3VGV4dChveCwgb3ksIHRoaXMuY29udGVudHMud2lkdGggLSBveCwgdGV4dFNpemUuaGVpZ2h0LCBsY3Modm9jYWIuZXF1aXBTbG90cy53ZWFwb24pLCAwKTsKICAgICAgICBveSArPSBsaW5lU3BhY2U7CiAgICAgICAgdGhpcy5jb250ZW50cy5kcmF3VGV4dChveCwgb3kgKyB0ZXh0U2l6ZS5oZWlnaHQsIHRoaXMuY29udGVudHMud2lkdGggLSBveCwgdGV4dFNpemUuaGVpZ2h0LCBsY3Modm9jYWIuZXF1aXBTbG90cy5zaGllbGQpLCAwKTsKICAgICAgICBveSArPSBsaW5lU3BhY2U7CiAgICAgICAgdGhpcy5jb250ZW50cy5kcmF3VGV4dChveCwgb3kgKyB0ZXh0U2l6ZS5oZWlnaHQgKiAyLCB0aGlzLmNvbnRlbnRzLndpZHRoIC0gb3gsIHRleHRTaXplLmhlaWdodCwgbGNzKHZvY2FiLmVxdWlwU2xvdHMuaGVhZEFybW9yKSwgMCk7CiAgICAgICAgb3kgKz0gbGluZVNwYWNlOwogICAgICAgIHRoaXMuY29udGVudHMuZHJhd1RleHQob3gsIG95ICsgdGV4dFNpemUuaGVpZ2h0ICogMywgdGhpcy5jb250ZW50cy53aWR0aCAtIG94LCB0ZXh0U2l6ZS5oZWlnaHQsIGxjcyh2b2NhYi5lcXVpcFNsb3RzLmJvZHlBcm1vciksIDApOwogICAgICAgIG95ICs9IGxpbmVTcGFjZTsKICAgICAgICB0aGlzLmNvbnRlbnRzLmRyYXdUZXh0KG94LCBveSArIHRleHRTaXplLmhlaWdodCAqIDQsIHRoaXMuY29udGVudHMud2lkdGggLSBveCwgdGV4dFNpemUuaGVpZ2h0LCBsY3Modm9jYWIuZXF1aXBTbG90cy5hY2Nlc3NvcnkpLCAwKTsKICAgICAgICBveSArPSBsaW5lU3BhY2U7CiAgICAgICAgb3ggKz0gMTQyICogdGhpcy5jb25zdHJ1Y3Rvci5zY2FsZTsKICAgICAgICBveSAtPSBsaW5lU3BhY2UgKiA1OwogICAgICAgIHRoaXMuY29udGVudHMuZHJhd1RleHQob3gsIG95LCB0aGlzLmNvbnRlbnRzLndpZHRoIC0gb3gsIHRleHRTaXplLmhlaWdodCwgKG1lbWJlci53ZWFwb24gIT0gbnVsbCA/IG1lbWJlci53ZWFwb24ubmFtZSA6ICIiKSwgMCk7CiAgICAgICAgb3kgKz0gbGluZVNwYWNlOwogICAgICAgIHRoaXMuY29udGVudHMuZHJhd1RleHQob3gsIG95ICsgdGV4dFNpemUuaGVpZ2h0LCB0aGlzLmNvbnRlbnRzLndpZHRoIC0gb3gsIHRleHRTaXplLmhlaWdodCwgKG1lbWJlci5zaGllbGQgIT0gbnVsbCA/IG1lbWJlci5zaGllbGQubmFtZSA6ICIiKSwgMCk7CiAgICAgICAgb3kgKz0gbGluZVNwYWNlOwogICAgICAgIHRoaXMuY29udGVudHMuZHJhd1RleHQob3gsIG95ICsgdGV4dFNpemUuaGVpZ2h0ICogMiwgdGhpcy5jb250ZW50cy53aWR0aCAtIG94LCB0ZXh0U2l6ZS5oZWlnaHQsIChtZW1iZXIuaGVhZCAhPSBudWxsID8gbWVtYmVyLmhlYWQubmFtZSA6ICIiKSwgMCk7CiAgICAgICAgb3kgKz0gbGluZVNwYWNlOwogICAgICAgIHRoaXMuY29udGVudHMuZHJhd1RleHQob3gsIG95ICsgdGV4dFNpemUuaGVpZ2h0ICogMywgdGhpcy5jb250ZW50cy53aWR0aCAtIG94LCB0ZXh0U2l6ZS5oZWlnaHQsIChtZW1iZXIuYm9keSAhPSBudWxsID8gbWVtYmVyLmJvZHkubmFtZSA6ICIiKSwgMCk7CiAgICAgICAgb3kgKz0gbGluZVNwYWNlOwogICAgICAgIHRoaXMuY29udGVudHMuZHJhd1RleHQob3gsIG95ICsgdGV4dFNpemUuaGVpZ2h0ICogNCwgdGhpcy5jb250ZW50cy53aWR0aCAtIG94LCB0ZXh0U2l6ZS5oZWlnaHQsIChtZW1iZXIuYWNjZXNzb3J5ICE9IG51bGwgPyBtZW1iZXIuYWNjZXNzb3J5Lm5hbWUgOiAiIiksIDApOwogICAgICAgIG95ICs9IGxpbmVTcGFjZTsKICAgICAgICBveSArPSB0ZXh0U2l6ZS5oZWlnaHQgKiA5OwogICAgICAgIG94ID0gMDsKICAgICAgICBkZXNjcmlwdGlvbiA9IG1lbWJlci5hY3Rvci5kZXNjcmlwdGlvbi5zcGxpdCgiXG4iKTsKICAgICAgICBfcmVzdWx0cyA9IFtdOwogICAgICAgIGZvciAoaSA9IF9pID0gMCwgX3JlZiA9IGRlc2NyaXB0aW9uLmxlbmd0aDsgMCA8PSBfcmVmID8gX2kgPCBfcmVmIDogX2kgPiBfcmVmOyBpID0gMCA8PSBfcmVmID8gKytfaSA6IC0tX2kpIHsKICAgICAgICAgIF9yZXN1bHRzLnB1c2godGhpcy5jb250ZW50cy5kcmF3VGV4dChveCwgb3kgKyB0ZXh0U2l6ZS5oZWlnaHQgKiBpLCB0aGlzLmNvbnRlbnRzLndpZHRoIC0gb3gsIHRleHRTaXplLmhlaWdodCwgZGVzY3JpcHRpb25baV0sIDApKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIF9yZXN1bHRzOwogICAgICB9CiAgICB9OwoKICAgIHJldHVybiBXaW5kb3dfU3RhdHVzOwoKICB9KShXaW5kb3dfQmFzZSk7CgogIHdpbmRvdy5XaW5kb3dfU3RhdHVzID0gV2luZG93X1N0YXR1czsKCn0pLmNhbGwodGhpcyk7Cg=="},{"name":"Window_Parameter","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogV2luZG93X1BhcmFtZXRlcgojICAgQ3JlYXRlZCBvbjogMjAxMy0xMC0yNwojCiMgICBDb3B5cmlnaHQgKEMpIDIwMTMgQW5kcukgUmFkb21za2kuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgICBDbGFzczogV2luZG93X1BhcmFtZXRlcgojCiMgICBBIHdpbmRvdyB3aGljaCBkaXNwbGF5cyBzdGF0dXMgaW5mb3JtYXRpb24gYWJvdXQgYSBwYXJ0eSBtZW1iZXIuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpjbGFzcyBXaW5kb3dfUGFyYW1ldGVyIGV4dGVuZHMgV2luZG93X0Jhc2UKICAgIGNvbnN0cnVjdG9yOiAoeCwgeSwgd2lkdGgsIGhlaWdodCkgLT4KICAgICAgICBzdXBlcih4IHx8IDAsIHkgfHwgMCwgd2lkdGggfHwgMTYwLCBoZWlnaHQgfHwgMTYwKQogICAgICAgIEBtZW1iZXIgPSBudWxsCiAgICAgICAgQGNvbnRlbnRzID0gbmV3IEJpdG1hcChAd2lkdGggLSBAcGFkZGluZyoyLCBAaGVpZ2h0IC0gQHBhZGRpbmcqMikKICAgICAgICBAY29udGVudHMuZm9udCA9IEBuYW1lRm9udAogICAgICAgIEBwcmV2aWV3ID0gbm8KICAgICAgICBAY3VycmVudEl0ZW0gPSBudWxsCiAgICAgICAgQGVxdWlwcGVkSXRlbSA9IG51bGwKICAgIHJlZHJhdzogLT4KICAgICAgICBpZiBub3QgQG1lbWJlcj8gdGhlbiByZXR1cm4KICAgICAgICBAY29udGVudHMuZm9udC5jb2xvciA9IENvbG9ycy5URVhUX05PUk1BTAogICAgICAgIHZvY2FiID0gUmVjb3JkTWFuYWdlci52b2NhYnVsYXJ5CiAgICAgICAgb3ggPSAwCiAgICAgICAgb3kgPSAwCiAgICAgICAgY29udGVudHMgPSBAY29udGVudHMKICAgICAgICBjb250ZW50cy5jbGVhcigpCiAgICAgICAgaWYgQG1lbWJlci5uYW1lLmxlbmd0aCA+IDAKICAgICAgICAgICAgdGV4dFNpemUgPSBjb250ZW50cy50ZXh0U2l6ZShAbWVtYmVyLm5hbWUpCiAgICAgICAgZWxzZQogICAgICAgICAgICB0ZXh0U2l6ZSA9IGNvbnRlbnRzLnRleHRTaXplKCJIIikKICAgICAgICAgICAgCiAgICAgICAgbGluZVNwYWNlID0gNCAqIFdpbmRvd19CYXNlLnNjYWxlCiAgICAgICAgY29sdW1uU2l6ZSA9IDUwICogV2luZG93X0Jhc2Uuc2NhbGUKICAgICAgICBpdGVtUG93ZXIgPSAwCiAgICAgICAgcGFyYW0gPSAwCiAgICAgIAogICAgICAgICMgRHJhdyBwYXJhbWV0ZXJzCiAgICAgICAgCiAgICAgICAgY29udGVudHMuZHJhd1RleHQob3gsIG95LCBjb2x1bW5TaXplLCB0ZXh0U2l6ZS5oZWlnaHQsIGxjcyh2b2NhYi5wYXJhbWV0ZXJzLm1scCkpCiAgICAgICAgY29udGVudHMuZHJhd1RleHQob3ggKyBjb2x1bW5TaXplLCBveSwgY29sdW1uU2l6ZSwgdGV4dFNpemUuaGVpZ2h0LCAiI3tAbWVtYmVyLm1scH0iKQogICAgICAgIGlmIEBwcmV2aWV3CiAgICAgICAgICAgIEBkcmF3UGFyYW1ldGVyUHJldmlldyhveCArIGNvbHVtblNpemUqMiwgb3ksIGNvbHVtblNpemUsIHRleHRTaXplLmhlaWdodCwgY29udGVudHMsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQG1lbWJlci5iYXNlTWxwKCksIEBtZW1iZXIubWxwLCAwKQogICAgICAgIG95ICs9IHRleHRTaXplLmhlaWdodCArIGxpbmVTcGFjZQogICAgICAgIAogICAgICAgIGNvbnRlbnRzLmRyYXdUZXh0KG94LCBveSwgY29sdW1uU2l6ZSwgdGV4dFNpemUuaGVpZ2h0LCBsY3Modm9jYWIucGFyYW1ldGVycy5tbXApKQogICAgICAgIGNvbnRlbnRzLmRyYXdUZXh0KG94ICsgY29sdW1uU2l6ZSwgb3ksIGNvbHVtblNpemUsIHRleHRTaXplLmhlaWdodCwgIiN7QG1lbWJlci5tbXB9IikKICAgICAgICBpZiBAcHJldmlldwogICAgICAgICAgICBAZHJhd1BhcmFtZXRlclByZXZpZXcob3ggKyBjb2x1bW5TaXplKjIsIG95LCBjb2x1bW5TaXplLCB0ZXh0U2l6ZS5oZWlnaHQsIGNvbnRlbnRzLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBtZW1iZXIuYmFzZU1tcCgpLCBAbWVtYmVyLm1tcCwgMSkKICAgICAgICBveSArPSB0ZXh0U2l6ZS5oZWlnaHQgKyBsaW5lU3BhY2UKICAgICAgICAKICAgICAgICBjb250ZW50cy5kcmF3VGV4dChveCwgb3ksIGNvbHVtblNpemUsIHRleHRTaXplLmhlaWdodCwgbGNzKHZvY2FiLnBhcmFtZXRlcnMuYXRrKSkKICAgICAgICBjb250ZW50cy5kcmF3VGV4dChveCArIGNvbHVtblNpemUsIG95LCBjb2x1bW5TaXplLCB0ZXh0U2l6ZS5oZWlnaHQsICIje0BtZW1iZXIuYXRrfSIpCiAgICAgICAgaWYgQHByZXZpZXcKICAgICAgICAgICAgQGRyYXdQYXJhbWV0ZXJQcmV2aWV3KG94ICsgY29sdW1uU2l6ZSoyLCBveSwgY29sdW1uU2l6ZSwgdGV4dFNpemUuaGVpZ2h0LCBjb250ZW50cywgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBAbWVtYmVyLmJhc2VBdGsoKSwgQG1lbWJlci5hdGssIDIpCiAgICAgICAgb3kgKz0gdGV4dFNpemUuaGVpZ2h0ICsgbGluZVNwYWNlCiAgICAgICAgCiAgICAgICAgY29udGVudHMuZHJhd1RleHQob3gsIG95LCBjb2x1bW5TaXplLCB0ZXh0U2l6ZS5oZWlnaHQsIGxjcyh2b2NhYi5wYXJhbWV0ZXJzLm1hdCkpCiAgICAgICAgY29udGVudHMuZHJhd1RleHQob3ggKyBjb2x1bW5TaXplLCBveSwgY29sdW1uU2l6ZSwgdGV4dFNpemUuaGVpZ2h0LCAiI3tAbWVtYmVyLm1hdH0iKQogICAgICAgIGlmIEBwcmV2aWV3CiAgICAgICAgICAgIEBkcmF3UGFyYW1ldGVyUHJldmlldyhveCArIGNvbHVtblNpemUqMiwgb3ksIGNvbHVtblNpemUsIHRleHRTaXplLmhlaWdodCwgY29udGVudHMsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQG1lbWJlci5iYXNlTWF0KCksIEBtZW1iZXIubWF0LCA0KQogICAgICAgIG95ICs9IHRleHRTaXplLmhlaWdodCArIGxpbmVTcGFjZQogICAgICAgIAogICAgICAgIGNvbnRlbnRzLmRyYXdUZXh0KG94LCBveSwgY29sdW1uU2l6ZSwgdGV4dFNpemUuaGVpZ2h0LCBsY3Modm9jYWIucGFyYW1ldGVycy5kZWYpKQogICAgICAgIGNvbnRlbnRzLmRyYXdUZXh0KG94ICsgY29sdW1uU2l6ZSwgb3ksIGNvbHVtblNpemUsIHRleHRTaXplLmhlaWdodCwgIiN7QG1lbWJlci5kZWZ9IikKICAgICAgICBpZiBAcHJldmlldwogICAgICAgICAgICBAZHJhd1BhcmFtZXRlclByZXZpZXcob3ggKyBjb2x1bW5TaXplKjIsIG95LCBjb2x1bW5TaXplLCB0ZXh0U2l6ZS5oZWlnaHQsIGNvbnRlbnRzLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBtZW1iZXIuYmFzZURlZigpLCBAbWVtYmVyLmRlZiwgMykKICAgICAgICBveSArPSB0ZXh0U2l6ZS5oZWlnaHQgKyBsaW5lU3BhY2UKICAgICAgICAKICAgICAgICBjb250ZW50cy5kcmF3VGV4dChveCwgb3ksIGNvbHVtblNpemUsIHRleHRTaXplLmhlaWdodCwgbGNzKHZvY2FiLnBhcmFtZXRlcnMubWRmKSkKICAgICAgICBjb250ZW50cy5kcmF3VGV4dChveCArIGNvbHVtblNpemUsIG95LCBjb2x1bW5TaXplLCB0ZXh0U2l6ZS5oZWlnaHQsICIje0BtZW1iZXIubWRmfSIpCiAgICAgICAgaWYgQHByZXZpZXcKICAgICAgICAgICAgQGRyYXdQYXJhbWV0ZXJQcmV2aWV3KG94ICsgY29sdW1uU2l6ZSoyLCBveSwgY29sdW1uU2l6ZSwgdGV4dFNpemUuaGVpZ2h0LCBjb250ZW50cywgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBAbWVtYmVyLmJhc2VNZGYoKSwgQG1lbWJlci5tZGYsIDUpCiAgICAgICAgb3kgKz0gdGV4dFNpemUuaGVpZ2h0ICsgbGluZVNwYWNlCiAgICAgICAgCiAgICAgICAgY29udGVudHMuZHJhd1RleHQob3gsIG95LCBjb2x1bW5TaXplLCB0ZXh0U2l6ZS5oZWlnaHQsIGxjcyh2b2NhYi5wYXJhbWV0ZXJzLmFnaSkpCiAgICAgICAgY29udGVudHMuZHJhd1RleHQob3ggKyBjb2x1bW5TaXplLCBveSwgY29sdW1uU2l6ZSwgdGV4dFNpemUuaGVpZ2h0LCAiI3tAbWVtYmVyLmFnaX0iKQogICAgICAgIGlmIEBwcmV2aWV3CiAgICAgICAgICAgIEBkcmF3UGFyYW1ldGVyUHJldmlldyhveCArIGNvbHVtblNpemUqMiwgb3ksIGNvbHVtblNpemUsIHRleHRTaXplLmhlaWdodCwgY29udGVudHMsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQG1lbWJlci5iYXNlQWdpKCksIEBtZW1iZXIuYWdpLCA2KQogICAgICAgIG95ICs9IHRleHRTaXplLmhlaWdodCArIGxpbmVTcGFjZQogICAgICAgIAogICAgICAgIGNvbnRlbnRzLmRyYXdUZXh0KG94LCBveSwgY29sdW1uU2l6ZSwgdGV4dFNpemUuaGVpZ2h0LCBsY3Modm9jYWIucGFyYW1ldGVycy5sdWspKQogICAgICAgIGNvbnRlbnRzLmRyYXdUZXh0KG94ICsgY29sdW1uU2l6ZSwgb3ksIGNvbHVtblNpemUsIHRleHRTaXplLmhlaWdodCwgIiN7QG1lbWJlci5sdWt9IikKICAgICAgICBpZiBAcHJldmlldwogICAgICAgICAgICBAZHJhd1BhcmFtZXRlclByZXZpZXcob3ggKyBjb2x1bW5TaXplKjIsIG95LCBjb2x1bW5TaXplLCB0ZXh0U2l6ZS5oZWlnaHQsIGNvbnRlbnRzLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBtZW1iZXIuYmFzZUx1aygpLCBAbWVtYmVyLmx1aywgNykKICAgICAgICBveSArPSB0ZXh0U2l6ZS5oZWlnaHQgKyBsaW5lU3BhY2UKICAgICAgICAKICAgIGRyYXdQYXJhbWV0ZXJQcmV2aWV3OiAoeCwgeSwgdywgaCwgY29udGVudHMsIGJhc2VQYXJhbSwgY3VycmVudFBhcmFtLCBwYXJhbUluZGV4KSAtPgogICAgICAgIGN1cnJlbnRQYXJhbSA9IGJhc2VQYXJhbQogICAgICAgIGZvciBpIGluIFswLi41XQogICAgICAgICAgICBpdGVtID0gQG1lbWJlci5lcXVpcHBlZEl0ZW0oaSkKICAgICAgICAgICAgaWYgaXRlbT8gdGhlbiBjdXJyZW50UGFyYW0gKz0gaXRlbS5wYXJhbXNbcGFyYW1JbmRleF0KICAgICAgICAgICAgCiAgICAgICAgaWYgQGN1cnJlbnRJdGVtPwogICAgICAgICAgICBpZiBAZXF1aXBwZWRJdGVtPwogICAgICAgICAgICAgICAgcGFyYW0gPSBjdXJyZW50UGFyYW0gLSBAZXF1aXBwZWRJdGVtLnBhcmFtc1twYXJhbUluZGV4XSArIEBjdXJyZW50SXRlbS5wYXJhbXNbcGFyYW1JbmRleF0KICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgcGFyYW0gPSBjdXJyZW50UGFyYW0gKyBAY3VycmVudEl0ZW0ucGFyYW1zW3BhcmFtSW5kZXhdCiAgICAgICAgZWxzZQogICAgICAgICAgICBpZiBAZXF1aXBwZWRJdGVtPwogICAgICAgICAgICAgICAgcGFyYW0gPSBjdXJyZW50UGFyYW0gLSBAZXF1aXBwZWRJdGVtLnBhcmFtc1twYXJhbUluZGV4XQogICAgICAgICAgICBlbHNlIAogICAgICAgICAgICAgICAgcGFyYW0gPSBjdXJyZW50UGFyYW0KICAgICAgICAgICAgCiAgICAgICAgcGFyYW0gPSBNYXRoLm1heChwYXJhbSwgMSkKICAgICAgICBjdXJyZW50UGFyYW0gPSBNYXRoLm1heChjdXJyZW50UGFyYW0sIDEpCiAgICAgICAgCiAgICAgICAgaWYgcGFyYW0gPiBjdXJyZW50UGFyYW0KICAgICAgICAgICAgY29udGVudHMuZm9udC5jb2xvciA9IENvbG9ycy5HUkVFTgogICAgICAgIGVsc2UgaWYgcGFyYW0gPCBjdXJyZW50UGFyYW0KICAgICAgICAgICAgY29udGVudHMuZm9udC5jb2xvciA9IENvbG9ycy5SRUQKICAgICAgICBlbHNlCiAgICAgICAgICAgIGNvbnRlbnRzLmZvbnQuY29sb3IgPSBDb2xvcnMuVEVYVF9OT1JNQUwKICAgICAgICAgICAgCiAgICAgICAgY29udGVudHMuZHJhd1RleHQoeCwgeSwgdywgaCwgIiN7cGFyYW19IikKICAgICAgICBjb250ZW50cy5mb250LmNvbG9yID0gQ29sb3JzLlRFWFRfTk9STUFMICAgCiAgICAgICAgICAgIAogICAgICAgICAgICAKd2luZG93LldpbmRvd19QYXJhbWV0ZXIgPSBXaW5kb3dfUGFyYW1ldGVy","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBXaW5kb3dfUGFyYW1ldGVyLAogICAgX19oYXNQcm9wID0ge30uaGFzT3duUHJvcGVydHksCiAgICBfX2V4dGVuZHMgPSBmdW5jdGlvbihjaGlsZCwgcGFyZW50KSB7IGZvciAodmFyIGtleSBpbiBwYXJlbnQpIHsgaWYgKF9faGFzUHJvcC5jYWxsKHBhcmVudCwga2V5KSkgY2hpbGRba2V5XSA9IHBhcmVudFtrZXldOyB9IGZ1bmN0aW9uIGN0b3IoKSB7IHRoaXMuY29uc3RydWN0b3IgPSBjaGlsZDsgfSBjdG9yLnByb3RvdHlwZSA9IHBhcmVudC5wcm90b3R5cGU7IGNoaWxkLnByb3RvdHlwZSA9IG5ldyBjdG9yKCk7IGNoaWxkLl9fc3VwZXJfXyA9IHBhcmVudC5wcm90b3R5cGU7IHJldHVybiBjaGlsZDsgfTsKCiAgV2luZG93X1BhcmFtZXRlciA9IChmdW5jdGlvbihfc3VwZXIpIHsKICAgIF9fZXh0ZW5kcyhXaW5kb3dfUGFyYW1ldGVyLCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFdpbmRvd19QYXJhbWV0ZXIoeCwgeSwgd2lkdGgsIGhlaWdodCkgewogICAgICBXaW5kb3dfUGFyYW1ldGVyLl9fc3VwZXJfXy5jb25zdHJ1Y3Rvci5jYWxsKHRoaXMsIHggfHwgMCwgeSB8fCAwLCB3aWR0aCB8fCAxNjAsIGhlaWdodCB8fCAxNjApOwogICAgICB0aGlzLm1lbWJlciA9IG51bGw7CiAgICAgIHRoaXMuY29udGVudHMgPSBuZXcgQml0bWFwKHRoaXMud2lkdGggLSB0aGlzLnBhZGRpbmcgKiAyLCB0aGlzLmhlaWdodCAtIHRoaXMucGFkZGluZyAqIDIpOwogICAgICB0aGlzLmNvbnRlbnRzLmZvbnQgPSB0aGlzLm5hbWVGb250OwogICAgICB0aGlzLnByZXZpZXcgPSBmYWxzZTsKICAgICAgdGhpcy5jdXJyZW50SXRlbSA9IG51bGw7CiAgICAgIHRoaXMuZXF1aXBwZWRJdGVtID0gbnVsbDsKICAgIH0KCiAgICBXaW5kb3dfUGFyYW1ldGVyLnByb3RvdHlwZS5yZWRyYXcgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGNvbHVtblNpemUsIGNvbnRlbnRzLCBpdGVtUG93ZXIsIGxpbmVTcGFjZSwgb3gsIG95LCBwYXJhbSwgdGV4dFNpemUsIHZvY2FiOwogICAgICBpZiAodGhpcy5tZW1iZXIgPT0gbnVsbCkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICB0aGlzLmNvbnRlbnRzLmZvbnQuY29sb3IgPSBDb2xvcnMuVEVYVF9OT1JNQUw7CiAgICAgIHZvY2FiID0gUmVjb3JkTWFuYWdlci52b2NhYnVsYXJ5OwogICAgICBveCA9IDA7CiAgICAgIG95ID0gMDsKICAgICAgY29udGVudHMgPSB0aGlzLmNvbnRlbnRzOwogICAgICBjb250ZW50cy5jbGVhcigpOwogICAgICBpZiAodGhpcy5tZW1iZXIubmFtZS5sZW5ndGggPiAwKSB7CiAgICAgICAgdGV4dFNpemUgPSBjb250ZW50cy50ZXh0U2l6ZSh0aGlzLm1lbWJlci5uYW1lKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0ZXh0U2l6ZSA9IGNvbnRlbnRzLnRleHRTaXplKCJIIik7CiAgICAgIH0KICAgICAgbGluZVNwYWNlID0gNCAqIFdpbmRvd19CYXNlLnNjYWxlOwogICAgICBjb2x1bW5TaXplID0gNTAgKiBXaW5kb3dfQmFzZS5zY2FsZTsKICAgICAgaXRlbVBvd2VyID0gMDsKICAgICAgcGFyYW0gPSAwOwogICAgICBjb250ZW50cy5kcmF3VGV4dChveCwgb3ksIGNvbHVtblNpemUsIHRleHRTaXplLmhlaWdodCwgbGNzKHZvY2FiLnBhcmFtZXRlcnMubWxwKSk7CiAgICAgIGNvbnRlbnRzLmRyYXdUZXh0KG94ICsgY29sdW1uU2l6ZSwgb3ksIGNvbHVtblNpemUsIHRleHRTaXplLmhlaWdodCwgIiIgKyB0aGlzLm1lbWJlci5tbHApOwogICAgICBpZiAodGhpcy5wcmV2aWV3KSB7CiAgICAgICAgdGhpcy5kcmF3UGFyYW1ldGVyUHJldmlldyhveCArIGNvbHVtblNpemUgKiAyLCBveSwgY29sdW1uU2l6ZSwgdGV4dFNpemUuaGVpZ2h0LCBjb250ZW50cywgdGhpcy5tZW1iZXIuYmFzZU1scCgpLCB0aGlzLm1lbWJlci5tbHAsIDApOwogICAgICB9CiAgICAgIG95ICs9IHRleHRTaXplLmhlaWdodCArIGxpbmVTcGFjZTsKICAgICAgY29udGVudHMuZHJhd1RleHQob3gsIG95LCBjb2x1bW5TaXplLCB0ZXh0U2l6ZS5oZWlnaHQsIGxjcyh2b2NhYi5wYXJhbWV0ZXJzLm1tcCkpOwogICAgICBjb250ZW50cy5kcmF3VGV4dChveCArIGNvbHVtblNpemUsIG95LCBjb2x1bW5TaXplLCB0ZXh0U2l6ZS5oZWlnaHQsICIiICsgdGhpcy5tZW1iZXIubW1wKTsKICAgICAgaWYgKHRoaXMucHJldmlldykgewogICAgICAgIHRoaXMuZHJhd1BhcmFtZXRlclByZXZpZXcob3ggKyBjb2x1bW5TaXplICogMiwgb3ksIGNvbHVtblNpemUsIHRleHRTaXplLmhlaWdodCwgY29udGVudHMsIHRoaXMubWVtYmVyLmJhc2VNbXAoKSwgdGhpcy5tZW1iZXIubW1wLCAxKTsKICAgICAgfQogICAgICBveSArPSB0ZXh0U2l6ZS5oZWlnaHQgKyBsaW5lU3BhY2U7CiAgICAgIGNvbnRlbnRzLmRyYXdUZXh0KG94LCBveSwgY29sdW1uU2l6ZSwgdGV4dFNpemUuaGVpZ2h0LCBsY3Modm9jYWIucGFyYW1ldGVycy5hdGspKTsKICAgICAgY29udGVudHMuZHJhd1RleHQob3ggKyBjb2x1bW5TaXplLCBveSwgY29sdW1uU2l6ZSwgdGV4dFNpemUuaGVpZ2h0LCAiIiArIHRoaXMubWVtYmVyLmF0ayk7CiAgICAgIGlmICh0aGlzLnByZXZpZXcpIHsKICAgICAgICB0aGlzLmRyYXdQYXJhbWV0ZXJQcmV2aWV3KG94ICsgY29sdW1uU2l6ZSAqIDIsIG95LCBjb2x1bW5TaXplLCB0ZXh0U2l6ZS5oZWlnaHQsIGNvbnRlbnRzLCB0aGlzLm1lbWJlci5iYXNlQXRrKCksIHRoaXMubWVtYmVyLmF0aywgMik7CiAgICAgIH0KICAgICAgb3kgKz0gdGV4dFNpemUuaGVpZ2h0ICsgbGluZVNwYWNlOwogICAgICBjb250ZW50cy5kcmF3VGV4dChveCwgb3ksIGNvbHVtblNpemUsIHRleHRTaXplLmhlaWdodCwgbGNzKHZvY2FiLnBhcmFtZXRlcnMubWF0KSk7CiAgICAgIGNvbnRlbnRzLmRyYXdUZXh0KG94ICsgY29sdW1uU2l6ZSwgb3ksIGNvbHVtblNpemUsIHRleHRTaXplLmhlaWdodCwgIiIgKyB0aGlzLm1lbWJlci5tYXQpOwogICAgICBpZiAodGhpcy5wcmV2aWV3KSB7CiAgICAgICAgdGhpcy5kcmF3UGFyYW1ldGVyUHJldmlldyhveCArIGNvbHVtblNpemUgKiAyLCBveSwgY29sdW1uU2l6ZSwgdGV4dFNpemUuaGVpZ2h0LCBjb250ZW50cywgdGhpcy5tZW1iZXIuYmFzZU1hdCgpLCB0aGlzLm1lbWJlci5tYXQsIDQpOwogICAgICB9CiAgICAgIG95ICs9IHRleHRTaXplLmhlaWdodCArIGxpbmVTcGFjZTsKICAgICAgY29udGVudHMuZHJhd1RleHQob3gsIG95LCBjb2x1bW5TaXplLCB0ZXh0U2l6ZS5oZWlnaHQsIGxjcyh2b2NhYi5wYXJhbWV0ZXJzLmRlZikpOwogICAgICBjb250ZW50cy5kcmF3VGV4dChveCArIGNvbHVtblNpemUsIG95LCBjb2x1bW5TaXplLCB0ZXh0U2l6ZS5oZWlnaHQsICIiICsgdGhpcy5tZW1iZXIuZGVmKTsKICAgICAgaWYgKHRoaXMucHJldmlldykgewogICAgICAgIHRoaXMuZHJhd1BhcmFtZXRlclByZXZpZXcob3ggKyBjb2x1bW5TaXplICogMiwgb3ksIGNvbHVtblNpemUsIHRleHRTaXplLmhlaWdodCwgY29udGVudHMsIHRoaXMubWVtYmVyLmJhc2VEZWYoKSwgdGhpcy5tZW1iZXIuZGVmLCAzKTsKICAgICAgfQogICAgICBveSArPSB0ZXh0U2l6ZS5oZWlnaHQgKyBsaW5lU3BhY2U7CiAgICAgIGNvbnRlbnRzLmRyYXdUZXh0KG94LCBveSwgY29sdW1uU2l6ZSwgdGV4dFNpemUuaGVpZ2h0LCBsY3Modm9jYWIucGFyYW1ldGVycy5tZGYpKTsKICAgICAgY29udGVudHMuZHJhd1RleHQob3ggKyBjb2x1bW5TaXplLCBveSwgY29sdW1uU2l6ZSwgdGV4dFNpemUuaGVpZ2h0LCAiIiArIHRoaXMubWVtYmVyLm1kZik7CiAgICAgIGlmICh0aGlzLnByZXZpZXcpIHsKICAgICAgICB0aGlzLmRyYXdQYXJhbWV0ZXJQcmV2aWV3KG94ICsgY29sdW1uU2l6ZSAqIDIsIG95LCBjb2x1bW5TaXplLCB0ZXh0U2l6ZS5oZWlnaHQsIGNvbnRlbnRzLCB0aGlzLm1lbWJlci5iYXNlTWRmKCksIHRoaXMubWVtYmVyLm1kZiwgNSk7CiAgICAgIH0KICAgICAgb3kgKz0gdGV4dFNpemUuaGVpZ2h0ICsgbGluZVNwYWNlOwogICAgICBjb250ZW50cy5kcmF3VGV4dChveCwgb3ksIGNvbHVtblNpemUsIHRleHRTaXplLmhlaWdodCwgbGNzKHZvY2FiLnBhcmFtZXRlcnMuYWdpKSk7CiAgICAgIGNvbnRlbnRzLmRyYXdUZXh0KG94ICsgY29sdW1uU2l6ZSwgb3ksIGNvbHVtblNpemUsIHRleHRTaXplLmhlaWdodCwgIiIgKyB0aGlzLm1lbWJlci5hZ2kpOwogICAgICBpZiAodGhpcy5wcmV2aWV3KSB7CiAgICAgICAgdGhpcy5kcmF3UGFyYW1ldGVyUHJldmlldyhveCArIGNvbHVtblNpemUgKiAyLCBveSwgY29sdW1uU2l6ZSwgdGV4dFNpemUuaGVpZ2h0LCBjb250ZW50cywgdGhpcy5tZW1iZXIuYmFzZUFnaSgpLCB0aGlzLm1lbWJlci5hZ2ksIDYpOwogICAgICB9CiAgICAgIG95ICs9IHRleHRTaXplLmhlaWdodCArIGxpbmVTcGFjZTsKICAgICAgY29udGVudHMuZHJhd1RleHQob3gsIG95LCBjb2x1bW5TaXplLCB0ZXh0U2l6ZS5oZWlnaHQsIGxjcyh2b2NhYi5wYXJhbWV0ZXJzLmx1aykpOwogICAgICBjb250ZW50cy5kcmF3VGV4dChveCArIGNvbHVtblNpemUsIG95LCBjb2x1bW5TaXplLCB0ZXh0U2l6ZS5oZWlnaHQsICIiICsgdGhpcy5tZW1iZXIubHVrKTsKICAgICAgaWYgKHRoaXMucHJldmlldykgewogICAgICAgIHRoaXMuZHJhd1BhcmFtZXRlclByZXZpZXcob3ggKyBjb2x1bW5TaXplICogMiwgb3ksIGNvbHVtblNpemUsIHRleHRTaXplLmhlaWdodCwgY29udGVudHMsIHRoaXMubWVtYmVyLmJhc2VMdWsoKSwgdGhpcy5tZW1iZXIubHVrLCA3KTsKICAgICAgfQogICAgICByZXR1cm4gb3kgKz0gdGV4dFNpemUuaGVpZ2h0ICsgbGluZVNwYWNlOwogICAgfTsKCiAgICBXaW5kb3dfUGFyYW1ldGVyLnByb3RvdHlwZS5kcmF3UGFyYW1ldGVyUHJldmlldyA9IGZ1bmN0aW9uKHgsIHksIHcsIGgsIGNvbnRlbnRzLCBiYXNlUGFyYW0sIGN1cnJlbnRQYXJhbSwgcGFyYW1JbmRleCkgewogICAgICB2YXIgaSwgaXRlbSwgcGFyYW0sIF9pOwogICAgICBjdXJyZW50UGFyYW0gPSBiYXNlUGFyYW07CiAgICAgIGZvciAoaSA9IF9pID0gMDsgX2kgPD0gNTsgaSA9ICsrX2kpIHsKICAgICAgICBpdGVtID0gdGhpcy5tZW1iZXIuZXF1aXBwZWRJdGVtKGkpOwogICAgICAgIGlmIChpdGVtICE9IG51bGwpIHsKICAgICAgICAgIGN1cnJlbnRQYXJhbSArPSBpdGVtLnBhcmFtc1twYXJhbUluZGV4XTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKHRoaXMuY3VycmVudEl0ZW0gIT0gbnVsbCkgewogICAgICAgIGlmICh0aGlzLmVxdWlwcGVkSXRlbSAhPSBudWxsKSB7CiAgICAgICAgICBwYXJhbSA9IGN1cnJlbnRQYXJhbSAtIHRoaXMuZXF1aXBwZWRJdGVtLnBhcmFtc1twYXJhbUluZGV4XSArIHRoaXMuY3VycmVudEl0ZW0ucGFyYW1zW3BhcmFtSW5kZXhdOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBwYXJhbSA9IGN1cnJlbnRQYXJhbSArIHRoaXMuY3VycmVudEl0ZW0ucGFyYW1zW3BhcmFtSW5kZXhdOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAodGhpcy5lcXVpcHBlZEl0ZW0gIT0gbnVsbCkgewogICAgICAgICAgcGFyYW0gPSBjdXJyZW50UGFyYW0gLSB0aGlzLmVxdWlwcGVkSXRlbS5wYXJhbXNbcGFyYW1JbmRleF07CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHBhcmFtID0gY3VycmVudFBhcmFtOwogICAgICAgIH0KICAgICAgfQogICAgICBwYXJhbSA9IE1hdGgubWF4KHBhcmFtLCAxKTsKICAgICAgY3VycmVudFBhcmFtID0gTWF0aC5tYXgoY3VycmVudFBhcmFtLCAxKTsKICAgICAgaWYgKHBhcmFtID4gY3VycmVudFBhcmFtKSB7CiAgICAgICAgY29udGVudHMuZm9udC5jb2xvciA9IENvbG9ycy5HUkVFTjsKICAgICAgfSBlbHNlIGlmIChwYXJhbSA8IGN1cnJlbnRQYXJhbSkgewogICAgICAgIGNvbnRlbnRzLmZvbnQuY29sb3IgPSBDb2xvcnMuUkVEOwogICAgICB9IGVsc2UgewogICAgICAgIGNvbnRlbnRzLmZvbnQuY29sb3IgPSBDb2xvcnMuVEVYVF9OT1JNQUw7CiAgICAgIH0KICAgICAgY29udGVudHMuZHJhd1RleHQoeCwgeSwgdywgaCwgIiIgKyBwYXJhbSk7CiAgICAgIHJldHVybiBjb250ZW50cy5mb250LmNvbG9yID0gQ29sb3JzLlRFWFRfTk9STUFMOwogICAgfTsKCiAgICByZXR1cm4gV2luZG93X1BhcmFtZXRlcjsKCiAgfSkoV2luZG93X0Jhc2UpOwoKICB3aW5kb3cuV2luZG93X1BhcmFtZXRlciA9IFdpbmRvd19QYXJhbWV0ZXI7Cgp9KS5jYWxsKHRoaXMpOwo="},{"name":"Window_Items","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogV2luZG93X0l0ZW1zCiMgICBDcmVhdGVkIG9uOiAyMDEzLTA5LTIyCiMKIyAgIENvcHlyaWdodCAoQykgMjAxMyBBbmRy6SBSYWRvbXNraS4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KIwojICAgQ2xhc3M6IFdpbmRvd19JdGVtcwojCiMgICBBIHdpbmRvdyB3aGljaCBkaXNwbGF5cyBhIHRleHQuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpjbGFzcyBXaW5kb3dfSXRlbXMgZXh0ZW5kcyBXaW5kb3dfU2VsZWN0aW9uICAgICAgICAKICAgIGNvbnN0cnVjdG9yOiAoeCwgeSwgY29sdW1uQ291bnQsIHJvd3MsIGNvbHVtbldpZHRoLCBjb2x1bW5IZWlnaHQsIHZpZXdwb3J0KSAtPgogICAgICAgIHN1cGVyKHgsIHksIGNvbHVtbkNvdW50LCByb3dzLCBjb2x1bW5XaWR0aCwgY29sdW1uSGVpZ2h0LCB2aWV3cG9ydCkKICAgICAgICBAdHlwZSA9IDAKICAgICAgICBAbWVtYmVyID0gbnVsbAogICAgICAgIEBlcXVpcFR5cGUgPSAtMQoKICAgIGRyYXdDZWxsOiAoeCwgeSwgY2VsbCwgZW5hYmxlZCkgLT4KICAgICAgICBpZiBub3QgY2VsbC5lbXB0eQogICAgICAgICAgICBAY29udGVudHMuZm9udCA9IEBuYW1lRm9udAogICAgICAgICAgICBAY29udGVudHMuZm9udC5jb2xvciA9IGlmIGVuYWJsZWQgdGhlbiBDb2xvcnMuRU5BQkxFRF9JVEVNIGVsc2UgQ29sb3JzLkRJU0FCTEVEX0lURU0KICAgICAgICAgICAgCiAgICAgICAgICAgIG9mZnNldCA9IDAKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIGNlbGwuaXRlbS5pY29uPyBhbmQgY2VsbC5pdGVtLmljb24ubmFtZS5sZW5ndGggPiAwCiAgICAgICAgICAgICAgICBpY29uU2V0ID0gUmVzb3VyY2VNYW5hZ2VyLmdldEJpdG1hcCgiR3JhcGhpY3MvSWNvbnMvI3tjZWxsLml0ZW0uaWNvbi5uYW1lfSIpCiAgICAgICAgICAgICAgICBAZHJhd0ljb24oaWNvblNldCwgY2VsbC5pdGVtLmljb25QYXR0ZXJuLCB4LTgsIHkpCiAgICAgICAgICAgICAgICBvZmZzZXQgPSAyOAogICAgICAgICAgICAgICAgCiAgICAgICAgICAgIEBjb250ZW50cy5kcmF3VGV4dCh4K29mZnNldCwgeSwgQGNvbHVtbldpZHRoLCBAY29sdW1uSGVpZ2h0LCAiI3tjZWxsLml0ZW0ubmFtZX0iLCAwKSAKICAgICAgICAgICAgCiAgICAgICAgICAgIAogICAgICAgICAgICBpZiBjZWxsLml0ZW0ubXBDb3N0PyBhbmQgY2VsbC5pdGVtLm1wQ29zdCA+IDAKICAgICAgICAgICAgICAgIEBjb250ZW50cy5kcmF3VGV4dCh4LTQsIHksIEBjb2x1bW5XaWR0aCwgQGNvbHVtbkhlaWdodCwgIiN7Y2VsbC5jb3VudH14IDogI3tjZWxsLml0ZW0ubXBDb3N0fSIsIDIpCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIEBjb250ZW50cy5kcmF3VGV4dCh4LTQsIHksIEBjb2x1bW5XaWR0aCwgQGNvbHVtbkhlaWdodCwgIiN7Y2VsbC5jb3VudH14IiwgMikKICAgIHZhbGlkYXRlQ2VsbDogKHgsIHksIGNlbGwpIC0+CiAgICAgICAgaWYgY2VsbC5lbXB0eSB0aGVuIHJldHVybiB5ZXMKICAgICAgICAKICAgICAgICByZXN1bHQgPSB5ZXMKICAgCiAgICAgICAgaWYgY2VsbC5pdGVtLml0ZW1UeXBlPyAjIEl0IGlzIGFuIGl0ZW0KICAgICAgICAgICAgc3dpdGNoIGNlbGwuaXRlbS5vY2Nhc2lvbgogICAgICAgICAgICAgICAgd2hlbiAwICMgQWx3YXlzCiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0geWVzCiAgICAgICAgICAgICAgICB3aGVuIDEgIyBPbmx5IGluIEJhdHRsZQogICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IFNjZW5lTWFuYWdlci5zY2VuZSBpbnN0YW5jZW9mIFNjZW5lX0JhdHRsZQogICAgICAgICAgICAgICAgd2hlbiAyICMgT25seSBmcm9tIE1lbnUKICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBTY2VuZU1hbmFnZXIuc2NlbmUgaW5zdGFuY2VvZiBTY2VuZV9NYWluTWVudQogICAgICAgICAgICAgICAgd2hlbiAzICMgTmV2ZXIKICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBubwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICBpZiByZXN1bHQgCiAgICAgICAgICAgICAgICByZXN1bHQgPSBub3QgKGNlbGwuaXRlbS5zY29wZSA+PSAxIGFuZCBjZWxsLml0ZW0uc2NvcGUgPD0gNikKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIHJlc3VsdAogICAgICAgICAgICAgICAgcmVzdWx0ID0gY2VsbC5pdGVtLm1wQ29zdCA9PSAwIG9yIChAbWVtYmVyLmlzQWxpdmUgYW5kIEBtZW1iZXIubXAgPj0gY2VsbC5pdGVtLm1wQ29zdCkKICAgICAgICBlbHNlIGlmIGNlbGwuaXRlbS53ZWFwb25UeXBlPyAjIEl0IGlzIGEgd2VhcG9uCiAgICAgICAgICAgIHJlc3VsdCA9IEBtZW1iZXIud2VhcG9uVHlwZXNbY2VsbC5pdGVtLndlYXBvblR5cGVdPwogICAgICAgIGVsc2UgaWYgY2VsbC5pdGVtLmFybW9yVHlwZT8gIyBJdCBpcyBhbiBhcm1vcgogICAgICAgICAgICByZXN1bHQgPSBAbWVtYmVyLmFybW9yVHlwZXNbY2VsbC5pdGVtLmFybW9yVHlwZV0/CiAgICAgICAgICAgIGlmIHJlc3VsdCBhbmQgQGVxdWlwVHlwZSA+IC0xCiAgICAgICAgICAgICAgICByZXN1bHQgPSBAZXF1aXBUeXBlID09IGNlbGwuaXRlbS5lcXVpcFR5cGUKICAgICAgICAgICAgCiAgICAgICAgcmV0dXJuIHJlc3VsdAogICAgICAgIAogICAgCiAgICByZWJ1aWxkUm93czogLT4KICAgICAgICBpdGVtcyA9IG51bGwKICAgICAgICBjdXJyZW50SXRlbXMgPSBbXQogICAgICAgIHJvd3MgPSBbXQogICAgICAgIHJvdyA9IDAKICAgICAgICBjb2x1bW4gPSAwCiAgICAgICAgc3dpdGNoIEB0eXBlCiAgICAgICAgICAgIHdoZW4gMAogICAgICAgICAgICAgICAgaXRlbXMgPSBHYW1lTWFuYWdlci5pbnZlbnRvcnkuaXRlbXMKICAgICAgICAgICAgd2hlbiAxCiAgICAgICAgICAgICAgICBpdGVtcyA9IEdhbWVNYW5hZ2VyLmludmVudG9yeS53ZWFwb25zCiAgICAgICAgICAgIHdoZW4gMgogICAgICAgICAgICAgICAgaXRlbXMgPSBHYW1lTWFuYWdlci5pbnZlbnRvcnkuYXJtb3JzCiAgICAgICAgICAgIHdoZW4gMwogICAgICAgICAgICAgICAgaXRlbXMgPSBHYW1lTWFuYWdlci5pbnZlbnRvcnkua2V5SXRlbXMKICAgICAgICAgICAgICAgIAogICAgICAgIGZvciBpIGluIFswLi4uaXRlbXMubGVuZ3RoXQogICAgICAgICAgICBpdGVtID0gR2FtZU1hbmFnZXIuaW52ZW50b3J5Lml0ZW0oQHR5cGUsIGkpCiAgICAgICAgICAgIGlmIGl0ZW0uY291bnQgPiAwCiAgICAgICAgICAgICAgICBjdXJyZW50SXRlbXMucHVzaChpdGVtKQogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICBpZiBAdHlwZSA9PSAxIG9yIEB0eXBlID09IDIgb3IgQHR5cGUgPT0gMwogICAgICAgICAgICBjdXJyZW50SXRlbXMucHVzaCh7ZW1wdHk6IHllc30pCiAgICAgICAgICAgICAgICAKICAgICAgICBmb3IgaSBpbiBbMC4uLmN1cnJlbnRJdGVtcy5sZW5ndGhdICAgICAgICAKICAgICAgICAgICAgcm93ID0gTWF0aC5mbG9vcihpIC8gMikKICAgICAgICAgICAgY29sdW1uID0gaSAlIDIKICAgICAgICAgICAgaWYgbm90IHJvd3Nbcm93XT8gdGhlbiByb3dzW3Jvd10gPSBbXQogICAgICAgICAgICByb3dzW3Jvd11bY29sdW1uXSA9IGN1cnJlbnRJdGVtc1tpXQogICAgICAgIAogICAgICAgIEByb3dzID0gcm93cwoKICAgICAgICAKd2luZG93LldpbmRvd19JdGVtcyA9IFdpbmRvd19JdGVtcw==","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBXaW5kb3dfSXRlbXMsCiAgICBfX2hhc1Byb3AgPSB7fS5oYXNPd25Qcm9wZXJ0eSwKICAgIF9fZXh0ZW5kcyA9IGZ1bmN0aW9uKGNoaWxkLCBwYXJlbnQpIHsgZm9yICh2YXIga2V5IGluIHBhcmVudCkgeyBpZiAoX19oYXNQcm9wLmNhbGwocGFyZW50LCBrZXkpKSBjaGlsZFtrZXldID0gcGFyZW50W2tleV07IH0gZnVuY3Rpb24gY3RvcigpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGNoaWxkOyB9IGN0b3IucHJvdG90eXBlID0gcGFyZW50LnByb3RvdHlwZTsgY2hpbGQucHJvdG90eXBlID0gbmV3IGN0b3IoKTsgY2hpbGQuX19zdXBlcl9fID0gcGFyZW50LnByb3RvdHlwZTsgcmV0dXJuIGNoaWxkOyB9OwoKICBXaW5kb3dfSXRlbXMgPSAoZnVuY3Rpb24oX3N1cGVyKSB7CiAgICBfX2V4dGVuZHMoV2luZG93X0l0ZW1zLCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFdpbmRvd19JdGVtcyh4LCB5LCBjb2x1bW5Db3VudCwgcm93cywgY29sdW1uV2lkdGgsIGNvbHVtbkhlaWdodCwgdmlld3BvcnQpIHsKICAgICAgV2luZG93X0l0ZW1zLl9fc3VwZXJfXy5jb25zdHJ1Y3Rvci5jYWxsKHRoaXMsIHgsIHksIGNvbHVtbkNvdW50LCByb3dzLCBjb2x1bW5XaWR0aCwgY29sdW1uSGVpZ2h0LCB2aWV3cG9ydCk7CiAgICAgIHRoaXMudHlwZSA9IDA7CiAgICAgIHRoaXMubWVtYmVyID0gbnVsbDsKICAgICAgdGhpcy5lcXVpcFR5cGUgPSAtMTsKICAgIH0KCiAgICBXaW5kb3dfSXRlbXMucHJvdG90eXBlLmRyYXdDZWxsID0gZnVuY3Rpb24oeCwgeSwgY2VsbCwgZW5hYmxlZCkgewogICAgICB2YXIgaWNvblNldCwgb2Zmc2V0OwogICAgICBpZiAoIWNlbGwuZW1wdHkpIHsKICAgICAgICB0aGlzLmNvbnRlbnRzLmZvbnQgPSB0aGlzLm5hbWVGb250OwogICAgICAgIHRoaXMuY29udGVudHMuZm9udC5jb2xvciA9IGVuYWJsZWQgPyBDb2xvcnMuRU5BQkxFRF9JVEVNIDogQ29sb3JzLkRJU0FCTEVEX0lURU07CiAgICAgICAgb2Zmc2V0ID0gMDsKICAgICAgICBpZiAoKGNlbGwuaXRlbS5pY29uICE9IG51bGwpICYmIGNlbGwuaXRlbS5pY29uLm5hbWUubGVuZ3RoID4gMCkgewogICAgICAgICAgaWNvblNldCA9IFJlc291cmNlTWFuYWdlci5nZXRCaXRtYXAoIkdyYXBoaWNzL0ljb25zLyIgKyBjZWxsLml0ZW0uaWNvbi5uYW1lKTsKICAgICAgICAgIHRoaXMuZHJhd0ljb24oaWNvblNldCwgY2VsbC5pdGVtLmljb25QYXR0ZXJuLCB4IC0gOCwgeSk7CiAgICAgICAgICBvZmZzZXQgPSAyODsKICAgICAgICB9CiAgICAgICAgdGhpcy5jb250ZW50cy5kcmF3VGV4dCh4ICsgb2Zmc2V0LCB5LCB0aGlzLmNvbHVtbldpZHRoLCB0aGlzLmNvbHVtbkhlaWdodCwgIiIgKyBjZWxsLml0ZW0ubmFtZSwgMCk7CiAgICAgICAgaWYgKChjZWxsLml0ZW0ubXBDb3N0ICE9IG51bGwpICYmIGNlbGwuaXRlbS5tcENvc3QgPiAwKSB7CiAgICAgICAgICByZXR1cm4gdGhpcy5jb250ZW50cy5kcmF3VGV4dCh4IC0gNCwgeSwgdGhpcy5jb2x1bW5XaWR0aCwgdGhpcy5jb2x1bW5IZWlnaHQsICIiICsgY2VsbC5jb3VudCArICJ4IDogIiArIGNlbGwuaXRlbS5tcENvc3QsIDIpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXR1cm4gdGhpcy5jb250ZW50cy5kcmF3VGV4dCh4IC0gNCwgeSwgdGhpcy5jb2x1bW5XaWR0aCwgdGhpcy5jb2x1bW5IZWlnaHQsICIiICsgY2VsbC5jb3VudCArICJ4IiwgMik7CiAgICAgICAgfQogICAgICB9CiAgICB9OwoKICAgIFdpbmRvd19JdGVtcy5wcm90b3R5cGUudmFsaWRhdGVDZWxsID0gZnVuY3Rpb24oeCwgeSwgY2VsbCkgewogICAgICB2YXIgcmVzdWx0OwogICAgICBpZiAoY2VsbC5lbXB0eSkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CiAgICAgIHJlc3VsdCA9IHRydWU7CiAgICAgIGlmIChjZWxsLml0ZW0uaXRlbVR5cGUgIT0gbnVsbCkgewogICAgICAgIHN3aXRjaCAoY2VsbC5pdGVtLm9jY2FzaW9uKSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIHJlc3VsdCA9IHRydWU7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICByZXN1bHQgPSBTY2VuZU1hbmFnZXIuc2NlbmUgaW5zdGFuY2VvZiBTY2VuZV9CYXR0bGU7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICByZXN1bHQgPSBTY2VuZU1hbmFnZXIuc2NlbmUgaW5zdGFuY2VvZiBTY2VuZV9NYWluTWVudTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgIHJlc3VsdCA9IGZhbHNlOwogICAgICAgIH0KICAgICAgICBpZiAocmVzdWx0KSB7CiAgICAgICAgICByZXN1bHQgPSAhKGNlbGwuaXRlbS5zY29wZSA+PSAxICYmIGNlbGwuaXRlbS5zY29wZSA8PSA2KTsKICAgICAgICB9CiAgICAgICAgaWYgKHJlc3VsdCkgewogICAgICAgICAgcmVzdWx0ID0gY2VsbC5pdGVtLm1wQ29zdCA9PT0gMCB8fCAodGhpcy5tZW1iZXIuaXNBbGl2ZSAmJiB0aGlzLm1lbWJlci5tcCA+PSBjZWxsLml0ZW0ubXBDb3N0KTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAoY2VsbC5pdGVtLndlYXBvblR5cGUgIT0gbnVsbCkgewogICAgICAgIHJlc3VsdCA9IHRoaXMubWVtYmVyLndlYXBvblR5cGVzW2NlbGwuaXRlbS53ZWFwb25UeXBlXSAhPSBudWxsOwogICAgICB9IGVsc2UgaWYgKGNlbGwuaXRlbS5hcm1vclR5cGUgIT0gbnVsbCkgewogICAgICAgIHJlc3VsdCA9IHRoaXMubWVtYmVyLmFybW9yVHlwZXNbY2VsbC5pdGVtLmFybW9yVHlwZV0gIT0gbnVsbDsKICAgICAgICBpZiAocmVzdWx0ICYmIHRoaXMuZXF1aXBUeXBlID4gLTEpIHsKICAgICAgICAgIHJlc3VsdCA9IHRoaXMuZXF1aXBUeXBlID09PSBjZWxsLml0ZW0uZXF1aXBUeXBlOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gcmVzdWx0OwogICAgfTsKCiAgICBXaW5kb3dfSXRlbXMucHJvdG90eXBlLnJlYnVpbGRSb3dzID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBjb2x1bW4sIGN1cnJlbnRJdGVtcywgaSwgaXRlbSwgaXRlbXMsIHJvdywgcm93cywgX2ksIF9qLCBfcmVmLCBfcmVmMTsKICAgICAgaXRlbXMgPSBudWxsOwogICAgICBjdXJyZW50SXRlbXMgPSBbXTsKICAgICAgcm93cyA9IFtdOwogICAgICByb3cgPSAwOwogICAgICBjb2x1bW4gPSAwOwogICAgICBzd2l0Y2ggKHRoaXMudHlwZSkgewogICAgICAgIGNhc2UgMDoKICAgICAgICAgIGl0ZW1zID0gR2FtZU1hbmFnZXIuaW52ZW50b3J5Lml0ZW1zOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAxOgogICAgICAgICAgaXRlbXMgPSBHYW1lTWFuYWdlci5pbnZlbnRvcnkud2VhcG9uczsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgMjoKICAgICAgICAgIGl0ZW1zID0gR2FtZU1hbmFnZXIuaW52ZW50b3J5LmFybW9yczsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgMzoKICAgICAgICAgIGl0ZW1zID0gR2FtZU1hbmFnZXIuaW52ZW50b3J5LmtleUl0ZW1zOwogICAgICB9CiAgICAgIGZvciAoaSA9IF9pID0gMCwgX3JlZiA9IGl0ZW1zLmxlbmd0aDsgMCA8PSBfcmVmID8gX2kgPCBfcmVmIDogX2kgPiBfcmVmOyBpID0gMCA8PSBfcmVmID8gKytfaSA6IC0tX2kpIHsKICAgICAgICBpdGVtID0gR2FtZU1hbmFnZXIuaW52ZW50b3J5Lml0ZW0odGhpcy50eXBlLCBpKTsKICAgICAgICBpZiAoaXRlbS5jb3VudCA+IDApIHsKICAgICAgICAgIGN1cnJlbnRJdGVtcy5wdXNoKGl0ZW0pOwogICAgICAgIH0KICAgICAgfQogICAgICBpZiAodGhpcy50eXBlID09PSAxIHx8IHRoaXMudHlwZSA9PT0gMiB8fCB0aGlzLnR5cGUgPT09IDMpIHsKICAgICAgICBjdXJyZW50SXRlbXMucHVzaCh7CiAgICAgICAgICBlbXB0eTogdHJ1ZQogICAgICAgIH0pOwogICAgICB9CiAgICAgIGZvciAoaSA9IF9qID0gMCwgX3JlZjEgPSBjdXJyZW50SXRlbXMubGVuZ3RoOyAwIDw9IF9yZWYxID8gX2ogPCBfcmVmMSA6IF9qID4gX3JlZjE7IGkgPSAwIDw9IF9yZWYxID8gKytfaiA6IC0tX2opIHsKICAgICAgICByb3cgPSBNYXRoLmZsb29yKGkgLyAyKTsKICAgICAgICBjb2x1bW4gPSBpICUgMjsKICAgICAgICBpZiAocm93c1tyb3ddID09IG51bGwpIHsKICAgICAgICAgIHJvd3Nbcm93XSA9IFtdOwogICAgICAgIH0KICAgICAgICByb3dzW3Jvd11bY29sdW1uXSA9IGN1cnJlbnRJdGVtc1tpXTsKICAgICAgfQogICAgICByZXR1cm4gdGhpcy5yb3dzID0gcm93czsKICAgIH07CgogICAgcmV0dXJuIFdpbmRvd19JdGVtczsKCiAgfSkoV2luZG93X1NlbGVjdGlvbik7CgogIHdpbmRvdy5XaW5kb3dfSXRlbXMgPSBXaW5kb3dfSXRlbXM7Cgp9KS5jYWxsKHRoaXMpOwo="},{"name":"Window_BuyItems","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogV2luZG93X0J1eUl0ZW1zCiMgICBDcmVhdGVkIG9uOiAyMDEzLTEwLTI5CiMKIyAgIENvcHlyaWdodCAoQykgMjAxMyBBbmRy6SBSYWRvbXNraS4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KIwojICAgQ2xhc3M6IFdpbmRvd19CdXlJdGVtcwojCiMgICBBIHdpbmRvdyB3aGljaCBkaXNwbGF5cyBhIHRleHQuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpjbGFzcyBXaW5kb3dfQnV5SXRlbXMgZXh0ZW5kcyBXaW5kb3dfSXRlbXMgCiAgICBjb25zdHJ1Y3RvcjogKHgsIHksIGNvbHVtbkNvdW50LCByb3dzLCBjb2x1bW5XaWR0aCwgY29sdW1uSGVpZ2h0LCB2aWV3cG9ydCkgLT4KICAgICAgICBzdXBlcih4LCB5LCBjb2x1bW5Db3VudCwgcm93cywgY29sdW1uV2lkdGgsIGNvbHVtbkhlaWdodCwgdmlld3BvcnQpCiAgICAgICAgQG1vZGUgPSAwCiAgICAKICAgIHZhbGlkYXRlQ2VsbDogKHgsIHksIGNlbGwpIC0+CiAgICAgICAgcmVzdWx0ID0gbm8KICAgICAgICAKICAKICAgICAgICBpZiBAbW9kZSA9PSAwCiAgICAgICAgICAgIHJlc3VsdCA9IEdhbWVNYW5hZ2VyLm1vbmV5ID49IGNlbGwucHJpY2UKICAgICAgICBlbHNlCiAgICAgICAgICAgIHJlc3VsdCA9IG5vdCBjZWxsLmVtcHR5PyBhbmQgY2VsbC5jb3VudCA+IDAKICAgICAgIAogICAgICAgICAgICAKICAgICAgICByZXR1cm4gcmVzdWx0CiAgICBkcmF3Q2VsbDogKHgsIHksIGNlbGwsIGVuYWJsZWQpIC0+CiAgICAgICAgaWYgbm90IGNlbGwuZW1wdHkKICAgICAgICAgICAgQGNvbnRlbnRzLmZvbnQgPSBAbmFtZUZvbnQKICAgICAgICAgICAgQGNvbnRlbnRzLmZvbnQuY29sb3IgPSBpZiBlbmFibGVkIHRoZW4gQ29sb3JzLkVOQUJMRURfSVRFTSBlbHNlIENvbG9ycy5ESVNBQkxFRF9JVEVNCiAgICAgICAgICAgIAogICAgICAgICAgICBvZmZzZXQgPSAwCiAgICAgICAgICAgIAogICAgICAgICAgICBpZiBjZWxsLml0ZW0uaWNvbj8gYW5kIGNlbGwuaXRlbS5pY29uLm5hbWUubGVuZ3RoID4gMAogICAgICAgICAgICAgICAgaWNvblNldCA9IFJlc291cmNlTWFuYWdlci5nZXRCaXRtYXAoIkdyYXBoaWNzL0ljb25zLyN7Y2VsbC5pdGVtLmljb24ubmFtZX0iKQogICAgICAgICAgICAgICAgQGRyYXdJY29uKGljb25TZXQsIGNlbGwuaXRlbS5pY29uUGF0dGVybiwgeC04LCB5KQogICAgICAgICAgICAgICAgb2Zmc2V0ID0gMjggKiBXaW5kb3dfQmFzZS5zY2FsZQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgIEBjb250ZW50cy5kcmF3VGV4dCh4K29mZnNldCwgeSwgQGNvbHVtbldpZHRoLCBAY29sdW1uSGVpZ2h0LCAiI3tjZWxsLml0ZW0ubmFtZX0iLCAwKSAKICAgICAgICAgICAgaWYgQG1vZGUgPT0gMAogICAgICAgICAgICAgICAgQGNvbnRlbnRzLmRyYXdUZXh0KHgtNCwgeSwgQGNvbHVtbldpZHRoLCBAY29sdW1uSGVpZ2h0LCAiI3tjZWxsLnByaWNlfSBHIiwgMikKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgQGNvbnRlbnRzLmRyYXdUZXh0KHgtNCwgeSwgQGNvbHVtbldpZHRoLCBAY29sdW1uSGVpZ2h0LCAiI3tjZWxsLmNvdW50fXgiLCAyKQogICAgICAgICAgICAKd2luZG93LldpbmRvd19CdXlJdGVtcyA9IFdpbmRvd19CdXlJdGVtcw==","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBXaW5kb3dfQnV5SXRlbXMsCiAgICBfX2hhc1Byb3AgPSB7fS5oYXNPd25Qcm9wZXJ0eSwKICAgIF9fZXh0ZW5kcyA9IGZ1bmN0aW9uKGNoaWxkLCBwYXJlbnQpIHsgZm9yICh2YXIga2V5IGluIHBhcmVudCkgeyBpZiAoX19oYXNQcm9wLmNhbGwocGFyZW50LCBrZXkpKSBjaGlsZFtrZXldID0gcGFyZW50W2tleV07IH0gZnVuY3Rpb24gY3RvcigpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGNoaWxkOyB9IGN0b3IucHJvdG90eXBlID0gcGFyZW50LnByb3RvdHlwZTsgY2hpbGQucHJvdG90eXBlID0gbmV3IGN0b3IoKTsgY2hpbGQuX19zdXBlcl9fID0gcGFyZW50LnByb3RvdHlwZTsgcmV0dXJuIGNoaWxkOyB9OwoKICBXaW5kb3dfQnV5SXRlbXMgPSAoZnVuY3Rpb24oX3N1cGVyKSB7CiAgICBfX2V4dGVuZHMoV2luZG93X0J1eUl0ZW1zLCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFdpbmRvd19CdXlJdGVtcyh4LCB5LCBjb2x1bW5Db3VudCwgcm93cywgY29sdW1uV2lkdGgsIGNvbHVtbkhlaWdodCwgdmlld3BvcnQpIHsKICAgICAgV2luZG93X0J1eUl0ZW1zLl9fc3VwZXJfXy5jb25zdHJ1Y3Rvci5jYWxsKHRoaXMsIHgsIHksIGNvbHVtbkNvdW50LCByb3dzLCBjb2x1bW5XaWR0aCwgY29sdW1uSGVpZ2h0LCB2aWV3cG9ydCk7CiAgICAgIHRoaXMubW9kZSA9IDA7CiAgICB9CgogICAgV2luZG93X0J1eUl0ZW1zLnByb3RvdHlwZS52YWxpZGF0ZUNlbGwgPSBmdW5jdGlvbih4LCB5LCBjZWxsKSB7CiAgICAgIHZhciByZXN1bHQ7CiAgICAgIHJlc3VsdCA9IGZhbHNlOwogICAgICBpZiAodGhpcy5tb2RlID09PSAwKSB7CiAgICAgICAgcmVzdWx0ID0gR2FtZU1hbmFnZXIubW9uZXkgPj0gY2VsbC5wcmljZTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXN1bHQgPSAoY2VsbC5lbXB0eSA9PSBudWxsKSAmJiBjZWxsLmNvdW50ID4gMDsKICAgICAgfQogICAgICByZXR1cm4gcmVzdWx0OwogICAgfTsKCiAgICBXaW5kb3dfQnV5SXRlbXMucHJvdG90eXBlLmRyYXdDZWxsID0gZnVuY3Rpb24oeCwgeSwgY2VsbCwgZW5hYmxlZCkgewogICAgICB2YXIgaWNvblNldCwgb2Zmc2V0OwogICAgICBpZiAoIWNlbGwuZW1wdHkpIHsKICAgICAgICB0aGlzLmNvbnRlbnRzLmZvbnQgPSB0aGlzLm5hbWVGb250OwogICAgICAgIHRoaXMuY29udGVudHMuZm9udC5jb2xvciA9IGVuYWJsZWQgPyBDb2xvcnMuRU5BQkxFRF9JVEVNIDogQ29sb3JzLkRJU0FCTEVEX0lURU07CiAgICAgICAgb2Zmc2V0ID0gMDsKICAgICAgICBpZiAoKGNlbGwuaXRlbS5pY29uICE9IG51bGwpICYmIGNlbGwuaXRlbS5pY29uLm5hbWUubGVuZ3RoID4gMCkgewogICAgICAgICAgaWNvblNldCA9IFJlc291cmNlTWFuYWdlci5nZXRCaXRtYXAoIkdyYXBoaWNzL0ljb25zLyIgKyBjZWxsLml0ZW0uaWNvbi5uYW1lKTsKICAgICAgICAgIHRoaXMuZHJhd0ljb24oaWNvblNldCwgY2VsbC5pdGVtLmljb25QYXR0ZXJuLCB4IC0gOCwgeSk7CiAgICAgICAgICBvZmZzZXQgPSAyOCAqIFdpbmRvd19CYXNlLnNjYWxlOwogICAgICAgIH0KICAgICAgICB0aGlzLmNvbnRlbnRzLmRyYXdUZXh0KHggKyBvZmZzZXQsIHksIHRoaXMuY29sdW1uV2lkdGgsIHRoaXMuY29sdW1uSGVpZ2h0LCAiIiArIGNlbGwuaXRlbS5uYW1lLCAwKTsKICAgICAgICBpZiAodGhpcy5tb2RlID09PSAwKSB7CiAgICAgICAgICByZXR1cm4gdGhpcy5jb250ZW50cy5kcmF3VGV4dCh4IC0gNCwgeSwgdGhpcy5jb2x1bW5XaWR0aCwgdGhpcy5jb2x1bW5IZWlnaHQsICIiICsgY2VsbC5wcmljZSArICIgRyIsIDIpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXR1cm4gdGhpcy5jb250ZW50cy5kcmF3VGV4dCh4IC0gNCwgeSwgdGhpcy5jb2x1bW5XaWR0aCwgdGhpcy5jb2x1bW5IZWlnaHQsICIiICsgY2VsbC5jb3VudCArICJ4IiwgMik7CiAgICAgICAgfQogICAgICB9CiAgICB9OwoKICAgIHJldHVybiBXaW5kb3dfQnV5SXRlbXM7CgogIH0pKFdpbmRvd19JdGVtcyk7CgogIHdpbmRvdy5XaW5kb3dfQnV5SXRlbXMgPSBXaW5kb3dfQnV5SXRlbXM7Cgp9KS5jYWxsKHRoaXMpOwo="},{"name":"Window_AmountSelection","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogV2luZG93X0Ftb3VudFNlbGVjdGlvbgojICAgQ3JlYXRlZCBvbjogMjAxMy0xMC0yOQojCiMgICBDb3B5cmlnaHQgKEMpIDIwMTMgQW5kcukgUmFkb21za2kuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIENsYXNzOiBXaW5kb3dfQW1vdW50U2VsZWN0aW9uCiMKIyAgIEEgd2luZG93IHdoaWNoIGRpc3BsYXlzIHRoZSBjdXJyZW50IG1vbmV5CiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpjbGFzcyBXaW5kb3dfQW1vdW50U2VsZWN0aW9uIGV4dGVuZHMgV2luZG93X01vZGFsQmFzZSAgICAKICAgIGNvbnN0cnVjdG9yOiAoeCwgeSkgLT4KICAgICAgICBzdXBlcih4IHx8IE1hdGguZmxvb3IoKEdyYXBoaWNzLndpZHRoIC0gMjI0KSAvIDIpLCB5IHx8IE1hdGguZmxvb3IoKEdyYXBoaWNzLmhlaWdodCAtIDQ1KSAvIDIpLCAyMjQsIDQ0KldpbmRvd19CYXNlLnNjYWxlKQogICAgICAgIHMgPSBXaW5kb3dfQmFzZS5zY2FsZQogICAgICAgIEBjb250ZW50cyA9IG5ldyBCaXRtYXAoQHdpZHRoIC0gQHBhZGRpbmcqMiwgQGhlaWdodCAtIEBwYWRkaW5nKjIpCiAgICAgICAgQGNvbnRlbnRzLmZvbnQgPSBAbmFtZUZvbnQKICAgICAgICBAYW1vdW50ID0gMQogICAgICAgIEB2YWx1ZSA9IDAKICAgICAgICBAbWF4VmFsdWUgPSAwCiAgICAgICAgQGJhY2tPcGFjaXR5ID0gMjU1CiAgICAgICAgQGN1cnNvclJlY3QgPSBuZXcgUmVjdCgoQGNvbnRlbnRzLndpZHRoIC0gNDAqcykgLyAyLCAwLCA0MCpzLCAyMCpzKQogICAgICAgIEBub01vbmV5ID0gbm8KICAgICAgICBAYWN0aXZlID0gbm8KICAgIHJlZHJhdzogLT4KICAgICAgICBzID0gV2luZG93X0Jhc2Uuc2NhbGUKICAgICAgICBob3dNdWNoU3RyaW5nID0gbGNzKFJlY29yZE1hbmFnZXIudm9jYWJ1bGFyeS5zaG9wTWVudS5ob3dNdWNoKQogICAgICAgIGN1ciA9IGxjcyhSZWNvcmRNYW5hZ2VyLnZvY2FidWxhcnkuc2hvcE1lbnUuY3VycmVuY3kpCiAgICAgICAgdGV4dFNpemUgPSBAY29udGVudHMudGV4dFNpemUoaG93TXVjaFN0cmluZykKICAgICAgICBAY29udGVudHMuY2xlYXIoKQogICAgICAgIEBjb250ZW50cy5kcmF3VGV4dCgwLCAwLCBAY29udGVudHMud2lkdGgsIEBjb250ZW50cy5oZWlnaHQsIGhvd011Y2hTdHJpbmcsIDApCiAgICAgICAgCiAgICAgICAgaWYgQG5vTW9uZXkKICAgICAgICAgICAgQGN1cnNvclJlY3Quc2V0KEBjb250ZW50cy53aWR0aCAtIDYwKnMsIDAsIDYwKnMsIDIwKnMpCiAgICAgICAgICAgIEBjb250ZW50cy5kcmF3VGV4dCgwLCAwLCBAY29udGVudHMud2lkdGgsIEBjb250ZW50cy5oZWlnaHQsICIje0BhbW91bnR9eCIsIDIpCiAgICAgICAgZWxzZQogICAgICAgICAgICBAY29udGVudHMuZHJhd1RleHQoMCwgMCwgQGNvbnRlbnRzLndpZHRoLCBAY29udGVudHMuaGVpZ2h0LCAiI3tAYW1vdW50fXgiLCAxKQogICAgICAgICAgICBAY29udGVudHMuZHJhd1RleHQoMCwgMCwgQGNvbnRlbnRzLndpZHRoLCBAY29udGVudHMuaGVpZ2h0LCAiI3tAdmFsdWUgKiBAYW1vdW50fSAje2N1cn0iLCAyKQogICAgICAgIAogICAgdXBkYXRlOiAtPgogICAgICAgIGlmIG5vdCBAYWN0aXZlIHRoZW4gcmV0dXJuCiAgICAgICAgCiAgICAgICAgaWYgQHZhbHVlID09IDAKICAgICAgICAgICAgbWF4ID0gOTkKICAgICAgICBlbHNlCiAgICAgICAgICAgIG1heCA9IE1hdGgubWluKE1hdGguZmxvb3IoQG1heFZhbHVlIC8gQHZhbHVlKSwgOTkpCiAgICAgICAgICAgIAogICAgICAgIGlmIElucHV0LnRyaWdnZXIoSW5wdXQuTEVGVCkKICAgICAgICAgICAgQGFtb3VudCA9IE1hdGgubWF4KEBhbW91bnQgLSAxLCAxKQogICAgICAgICAgICBAcmVkcmF3KCkKICAgICAgICBpZiBJbnB1dC50cmlnZ2VyKElucHV0LlJJR0hUKQogICAgICAgICAgICBAYW1vdW50ID0gTWF0aC5taW4oQGFtb3VudCArIDEsIG1heCkKICAgICAgICAgICAgQHJlZHJhdygpCiAgICAgICAgaWYgSW5wdXQudHJpZ2dlcihJbnB1dC5VUCkKICAgICAgICAgICAgQGFtb3VudCA9IE1hdGgubWluKEBhbW91bnQgKyAxMCwgbWF4KQogICAgICAgICAgICBAcmVkcmF3KCkKICAgICAgICBpZiBJbnB1dC50cmlnZ2VyKElucHV0LkRPV04pCiAgICAgICAgICAgIEBhbW91bnQgPSBNYXRoLm1heChAYW1vdW50IC0gMTAsIDEpICAgCiAgICAgICAgICAgIEByZWRyYXcoKQogICAgICAgIGlmIElucHV0LnRyaWdnZXIoSW5wdXQuQykKICAgICAgICAgICAgQGFjY2VwdCgpCiAgICAgICAgaWYgSW5wdXQudHJpZ2dlcihJbnB1dC5CKQogICAgICAgICAgICBAY2FuY2VsKCkKICAgICAgICAgICAgCiAgICAgICAgc3VwZXIKICAgICAgICAKd2luZG93LldpbmRvd19BbW91bnRTZWxlY3Rpb24gPSBXaW5kb3dfQW1vdW50U2VsZWN0aW9u","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBXaW5kb3dfQW1vdW50U2VsZWN0aW9uLAogICAgX19oYXNQcm9wID0ge30uaGFzT3duUHJvcGVydHksCiAgICBfX2V4dGVuZHMgPSBmdW5jdGlvbihjaGlsZCwgcGFyZW50KSB7IGZvciAodmFyIGtleSBpbiBwYXJlbnQpIHsgaWYgKF9faGFzUHJvcC5jYWxsKHBhcmVudCwga2V5KSkgY2hpbGRba2V5XSA9IHBhcmVudFtrZXldOyB9IGZ1bmN0aW9uIGN0b3IoKSB7IHRoaXMuY29uc3RydWN0b3IgPSBjaGlsZDsgfSBjdG9yLnByb3RvdHlwZSA9IHBhcmVudC5wcm90b3R5cGU7IGNoaWxkLnByb3RvdHlwZSA9IG5ldyBjdG9yKCk7IGNoaWxkLl9fc3VwZXJfXyA9IHBhcmVudC5wcm90b3R5cGU7IHJldHVybiBjaGlsZDsgfTsKCiAgV2luZG93X0Ftb3VudFNlbGVjdGlvbiA9IChmdW5jdGlvbihfc3VwZXIpIHsKICAgIF9fZXh0ZW5kcyhXaW5kb3dfQW1vdW50U2VsZWN0aW9uLCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFdpbmRvd19BbW91bnRTZWxlY3Rpb24oeCwgeSkgewogICAgICB2YXIgczsKICAgICAgV2luZG93X0Ftb3VudFNlbGVjdGlvbi5fX3N1cGVyX18uY29uc3RydWN0b3IuY2FsbCh0aGlzLCB4IHx8IE1hdGguZmxvb3IoKEdyYXBoaWNzLndpZHRoIC0gMjI0KSAvIDIpLCB5IHx8IE1hdGguZmxvb3IoKEdyYXBoaWNzLmhlaWdodCAtIDQ1KSAvIDIpLCAyMjQsIDQ0ICogV2luZG93X0Jhc2Uuc2NhbGUpOwogICAgICBzID0gV2luZG93X0Jhc2Uuc2NhbGU7CiAgICAgIHRoaXMuY29udGVudHMgPSBuZXcgQml0bWFwKHRoaXMud2lkdGggLSB0aGlzLnBhZGRpbmcgKiAyLCB0aGlzLmhlaWdodCAtIHRoaXMucGFkZGluZyAqIDIpOwogICAgICB0aGlzLmNvbnRlbnRzLmZvbnQgPSB0aGlzLm5hbWVGb250OwogICAgICB0aGlzLmFtb3VudCA9IDE7CiAgICAgIHRoaXMudmFsdWUgPSAwOwogICAgICB0aGlzLm1heFZhbHVlID0gMDsKICAgICAgdGhpcy5iYWNrT3BhY2l0eSA9IDI1NTsKICAgICAgdGhpcy5jdXJzb3JSZWN0ID0gbmV3IFJlY3QoKHRoaXMuY29udGVudHMud2lkdGggLSA0MCAqIHMpIC8gMiwgMCwgNDAgKiBzLCAyMCAqIHMpOwogICAgICB0aGlzLm5vTW9uZXkgPSBmYWxzZTsKICAgICAgdGhpcy5hY3RpdmUgPSBmYWxzZTsKICAgIH0KCiAgICBXaW5kb3dfQW1vdW50U2VsZWN0aW9uLnByb3RvdHlwZS5yZWRyYXcgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGN1ciwgaG93TXVjaFN0cmluZywgcywgdGV4dFNpemU7CiAgICAgIHMgPSBXaW5kb3dfQmFzZS5zY2FsZTsKICAgICAgaG93TXVjaFN0cmluZyA9IGxjcyhSZWNvcmRNYW5hZ2VyLnZvY2FidWxhcnkuc2hvcE1lbnUuaG93TXVjaCk7CiAgICAgIGN1ciA9IGxjcyhSZWNvcmRNYW5hZ2VyLnZvY2FidWxhcnkuc2hvcE1lbnUuY3VycmVuY3kpOwogICAgICB0ZXh0U2l6ZSA9IHRoaXMuY29udGVudHMudGV4dFNpemUoaG93TXVjaFN0cmluZyk7CiAgICAgIHRoaXMuY29udGVudHMuY2xlYXIoKTsKICAgICAgdGhpcy5jb250ZW50cy5kcmF3VGV4dCgwLCAwLCB0aGlzLmNvbnRlbnRzLndpZHRoLCB0aGlzLmNvbnRlbnRzLmhlaWdodCwgaG93TXVjaFN0cmluZywgMCk7CiAgICAgIGlmICh0aGlzLm5vTW9uZXkpIHsKICAgICAgICB0aGlzLmN1cnNvclJlY3Quc2V0KHRoaXMuY29udGVudHMud2lkdGggLSA2MCAqIHMsIDAsIDYwICogcywgMjAgKiBzKTsKICAgICAgICByZXR1cm4gdGhpcy5jb250ZW50cy5kcmF3VGV4dCgwLCAwLCB0aGlzLmNvbnRlbnRzLndpZHRoLCB0aGlzLmNvbnRlbnRzLmhlaWdodCwgIiIgKyB0aGlzLmFtb3VudCArICJ4IiwgMik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5jb250ZW50cy5kcmF3VGV4dCgwLCAwLCB0aGlzLmNvbnRlbnRzLndpZHRoLCB0aGlzLmNvbnRlbnRzLmhlaWdodCwgIiIgKyB0aGlzLmFtb3VudCArICJ4IiwgMSk7CiAgICAgICAgcmV0dXJuIHRoaXMuY29udGVudHMuZHJhd1RleHQoMCwgMCwgdGhpcy5jb250ZW50cy53aWR0aCwgdGhpcy5jb250ZW50cy5oZWlnaHQsICIiICsgKHRoaXMudmFsdWUgKiB0aGlzLmFtb3VudCkgKyAiICIgKyBjdXIsIDIpOwogICAgICB9CiAgICB9OwoKICAgIFdpbmRvd19BbW91bnRTZWxlY3Rpb24ucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgbWF4OwogICAgICBpZiAoIXRoaXMuYWN0aXZlKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGlmICh0aGlzLnZhbHVlID09PSAwKSB7CiAgICAgICAgbWF4ID0gOTk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbWF4ID0gTWF0aC5taW4oTWF0aC5mbG9vcih0aGlzLm1heFZhbHVlIC8gdGhpcy52YWx1ZSksIDk5KTsKICAgICAgfQogICAgICBpZiAoSW5wdXQudHJpZ2dlcihJbnB1dC5MRUZUKSkgewogICAgICAgIHRoaXMuYW1vdW50ID0gTWF0aC5tYXgodGhpcy5hbW91bnQgLSAxLCAxKTsKICAgICAgICB0aGlzLnJlZHJhdygpOwogICAgICB9CiAgICAgIGlmIChJbnB1dC50cmlnZ2VyKElucHV0LlJJR0hUKSkgewogICAgICAgIHRoaXMuYW1vdW50ID0gTWF0aC5taW4odGhpcy5hbW91bnQgKyAxLCBtYXgpOwogICAgICAgIHRoaXMucmVkcmF3KCk7CiAgICAgIH0KICAgICAgaWYgKElucHV0LnRyaWdnZXIoSW5wdXQuVVApKSB7CiAgICAgICAgdGhpcy5hbW91bnQgPSBNYXRoLm1pbih0aGlzLmFtb3VudCArIDEwLCBtYXgpOwogICAgICAgIHRoaXMucmVkcmF3KCk7CiAgICAgIH0KICAgICAgaWYgKElucHV0LnRyaWdnZXIoSW5wdXQuRE9XTikpIHsKICAgICAgICB0aGlzLmFtb3VudCA9IE1hdGgubWF4KHRoaXMuYW1vdW50IC0gMTAsIDEpOwogICAgICAgIHRoaXMucmVkcmF3KCk7CiAgICAgIH0KICAgICAgaWYgKElucHV0LnRyaWdnZXIoSW5wdXQuQykpIHsKICAgICAgICB0aGlzLmFjY2VwdCgpOwogICAgICB9CiAgICAgIGlmIChJbnB1dC50cmlnZ2VyKElucHV0LkIpKSB7CiAgICAgICAgdGhpcy5jYW5jZWwoKTsKICAgICAgfQogICAgICByZXR1cm4gV2luZG93X0Ftb3VudFNlbGVjdGlvbi5fX3N1cGVyX18udXBkYXRlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICB9OwoKICAgIHJldHVybiBXaW5kb3dfQW1vdW50U2VsZWN0aW9uOwoKICB9KShXaW5kb3dfTW9kYWxCYXNlKTsKCiAgd2luZG93LldpbmRvd19BbW91bnRTZWxlY3Rpb24gPSBXaW5kb3dfQW1vdW50U2VsZWN0aW9uOwoKfSkuY2FsbCh0aGlzKTsK"},{"name":"Window_Skills","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogV2luZG93X1NraWxscwojICAgQ3JlYXRlZCBvbjogMjAxMy0wOS0yNAojCiMgICBDb3B5cmlnaHQgKEMpIDIwMTMgQW5kcukgUmFkb21za2kuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIENsYXNzOiBXaW5kb3dfU2tpbGxzCiMKIyAgIEEgd2luZG93IHdoaWNoIGRpc3BsYXlzIGEgdGV4dC4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCmNsYXNzIFdpbmRvd19Ta2lsbHMgZXh0ZW5kcyBXaW5kb3dfU2VsZWN0aW9uICAgICAgICAKICAgIGNvbnN0cnVjdG9yOiAoeCwgeSwgY29sdW1uQ291bnQsIHJvd3MsIGNvbHVtbldpZHRoLCBjb2x1bW5IZWlnaHQsIHZpZXdwb3J0KSAtPgogICAgICAgIHN1cGVyKHgsIHksIGNvbHVtbkNvdW50LCByb3dzLCBjb2x1bW5XaWR0aCwgY29sdW1uSGVpZ2h0LCB2aWV3cG9ydCkKICAgICAgICBAdHlwZSA9IDAKICAgICAgICBAbWVtYmVyID0gbnVsbAogICAgZHJhd0NlbGw6ICh4LCB5LCBjZWxsKSAtPgogICAgICAgIEBjb250ZW50cy5mb250ID0gQG5hbWVGb250CiAgICAgICAgCiAgICAgICAgb2Zmc2V0ID0gMAogICAgICAgICAgICAKICAgICAgICBpZiBjZWxsLmljb24/IGFuZCBjZWxsLmljb24ubmFtZS5sZW5ndGggPiAwCiAgICAgICAgICAgIGljb25TZXQgPSBSZXNvdXJjZU1hbmFnZXIuZ2V0Qml0bWFwKCJHcmFwaGljcy9JY29ucy8je2NlbGwuaWNvbi5uYW1lfSIpCiAgICAgICAgICAgIEBkcmF3SWNvbihpY29uU2V0LCBjZWxsLmljb25QYXR0ZXJuLCB4LTgsIHkpCiAgICAgICAgICAgIG9mZnNldCA9IDI4CiAgICAgICAgICAgICAgICAKICAgICAgICBAY29udGVudHMuZHJhd1RleHQoeCtvZmZzZXQsIHksIEBjb2x1bW5XaWR0aCwgQGNvbHVtbkhlaWdodCwgIiN7Y2VsbC5uYW1lfSIsIDApIAogICAgICAgIAogICAgICAgIGlmIGNlbGwubXBDb3N0ID4gMAogICAgICAgICAgICBAY29udGVudHMuZHJhd1RleHQoeC0yLCB5LCBAY29sdW1uV2lkdGgsIEBjb2x1bW5IZWlnaHQsICIje2NlbGwubXBDb3N0fSIsIDIpIAogICAgICAgICAgICAKICAgIHZhbGlkYXRlQ2VsbDogKHgsIHksIGNlbGwpIC0+CiAgICAgICAgaWYgY2VsbC5lbXB0eSB0aGVuIHJldHVybiBubwogICAgICAgIAogICAgICAgIHJlc3VsdCA9IHllcwogICAgICAgIHNraWxsID0gY2VsbAogICAgICAgIGNvbnNvbGUubG9nKHNraWxsKQogICAgICAgIHN3aXRjaCBza2lsbC5vY2Nhc2lvbgogICAgICAgICAgICB3aGVuIDAgIyBBbHdheXMKICAgICAgICAgICAgICAgIHJlc3VsdCA9IHllcwogICAgICAgICAgICB3aGVuIDEgIyBPbmx5IGluIEJhdHRsZQogICAgICAgICAgICAgICAgcmVzdWx0ID0gU2NlbmVNYW5hZ2VyLnNjZW5lIGluc3RhbmNlb2YgU2NlbmVfQmF0dGxlCiAgICAgICAgICAgIHdoZW4gMiAjIE9ubHkgZnJvbSBNZW51CiAgICAgICAgICAgICAgICByZXN1bHQgPSBTY2VuZU1hbmFnZXIuc2NlbmUgaW5zdGFuY2VvZiBTY2VuZV9NYWluTWVudQogICAgICAgICAgICB3aGVuIDMgIyBOZXZlcgogICAgICAgICAgICAgICAgcmVzdWx0ID0gbm8KICAgICAgICAgICAgICAgIAogICAgICAgIGlmIHJlc3VsdCAKICAgICAgICAgICAgcmVzdWx0ID0gKHNraWxsLnNjb3BlID49IDEgYW5kIHNraWxsLnNjb3BlIDw9IDYpCiAgICAgICAgCiAgICAgICAgaWYgcmVzdWx0CiAgICAgICAgICAgIHJlc3VsdCA9IHNraWxsLm1wQ29zdCA9PSAwIG9yIChAbWVtYmVyLmlzQWxpdmUgYW5kIEBtZW1iZXIubXAgPj0gc2tpbGwubXBDb3N0KQogICAgICAgICAgICAKICAgICAgICBpZiByZXN1bHQgYW5kIHNraWxsLndlYXBvblR5cGVJZDEgPiAwCiAgICAgICAgICAgIHJlc3VsdCA9IEBtZW1iZXIud2VhcG9uVHlwZXNbc2tpbGwud2VhcG9uVHlwZUlkMS0xXT8KICAgICAgICAKICAgICAgICBpZiByZXN1bHQgYW5kIHNraWxsLndlYXBvblR5cGVJZDIgPiAwCiAgICAgICAgICAgIHJlc3VsdCA9IEBtZW1iZXIud2VhcG9uVHlwZXNbc2tpbGwud2VhcG9uVHlwZUlkMi0xXT8KICAgICAgICAgICAgCiAgICAgCiAgICAgICAgICAgIAogICAgICAgIHJldHVybiByZXN1bHQKICAgICAgICAKICAgIHJlYnVpbGRSb3dzOiAtPgogICAgICAgIGl0ZW1zID0gbnVsbAogICAgICAgIGN1cnJlbnRJdGVtcyA9IFtdCiAgICAgICAgcm93cyA9IFtdCiAgICAgICAgcm93ID0gMAogICAgICAgIGNvbHVtbiA9IDAKICAgICAgICAKICAgICAgICBpdGVtcyA9IEBtZW1iZXIuc2tpbGxzW0B0eXBlXQogICAgICAgIGNvbnNvbGUubG9nKGl0ZW1zKQogICAgICAgIGlmIGl0ZW1zPwogICAgICAgICAgICBmb3IgaSBpbiBbMC4uLml0ZW1zLmxlbmd0aF0KICAgICAgICAgICAgICAgIGlmIGl0ZW1zW2ldPwogICAgICAgICAgICAgICAgICAgIGN1cnJlbnRJdGVtcy5wdXNoKGl0ZW1zW2ldKQogICAgICAgICAgICAgICAgCiAgICAgICAgZm9yIGkgaW4gWzAuLi5jdXJyZW50SXRlbXMubGVuZ3RoXSAgICAgICAgCiAgICAgICAgICAgIHJvdyA9IE1hdGguZmxvb3IoaSAvIDIpCiAgICAgICAgICAgIGNvbHVtbiA9IGkgJSAyCiAgICAgICAgICAgIGlmIG5vdCByb3dzW3Jvd10/IHRoZW4gcm93c1tyb3ddID0gW10KICAgICAgICAgICAgcm93c1tyb3ddW2NvbHVtbl0gPSBjdXJyZW50SXRlbXNbaV0KICAgICAgICAgICAgCiAKICAgICAgICAgICAgCiAgICAgICAgQHJvd3MgPSByb3dzCiAgICAgICAgCiAgICAgICAgY29uc29sZS5sb2coQHJvd3MpCgogICAgICAgIAp3aW5kb3cuV2luZG93X1NraWxscyA9IFdpbmRvd19Ta2lsbHM=","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBXaW5kb3dfU2tpbGxzLAogICAgX19oYXNQcm9wID0ge30uaGFzT3duUHJvcGVydHksCiAgICBfX2V4dGVuZHMgPSBmdW5jdGlvbihjaGlsZCwgcGFyZW50KSB7IGZvciAodmFyIGtleSBpbiBwYXJlbnQpIHsgaWYgKF9faGFzUHJvcC5jYWxsKHBhcmVudCwga2V5KSkgY2hpbGRba2V5XSA9IHBhcmVudFtrZXldOyB9IGZ1bmN0aW9uIGN0b3IoKSB7IHRoaXMuY29uc3RydWN0b3IgPSBjaGlsZDsgfSBjdG9yLnByb3RvdHlwZSA9IHBhcmVudC5wcm90b3R5cGU7IGNoaWxkLnByb3RvdHlwZSA9IG5ldyBjdG9yKCk7IGNoaWxkLl9fc3VwZXJfXyA9IHBhcmVudC5wcm90b3R5cGU7IHJldHVybiBjaGlsZDsgfTsKCiAgV2luZG93X1NraWxscyA9IChmdW5jdGlvbihfc3VwZXIpIHsKICAgIF9fZXh0ZW5kcyhXaW5kb3dfU2tpbGxzLCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFdpbmRvd19Ta2lsbHMoeCwgeSwgY29sdW1uQ291bnQsIHJvd3MsIGNvbHVtbldpZHRoLCBjb2x1bW5IZWlnaHQsIHZpZXdwb3J0KSB7CiAgICAgIFdpbmRvd19Ta2lsbHMuX19zdXBlcl9fLmNvbnN0cnVjdG9yLmNhbGwodGhpcywgeCwgeSwgY29sdW1uQ291bnQsIHJvd3MsIGNvbHVtbldpZHRoLCBjb2x1bW5IZWlnaHQsIHZpZXdwb3J0KTsKICAgICAgdGhpcy50eXBlID0gMDsKICAgICAgdGhpcy5tZW1iZXIgPSBudWxsOwogICAgfQoKICAgIFdpbmRvd19Ta2lsbHMucHJvdG90eXBlLmRyYXdDZWxsID0gZnVuY3Rpb24oeCwgeSwgY2VsbCkgewogICAgICB2YXIgaWNvblNldCwgb2Zmc2V0OwogICAgICB0aGlzLmNvbnRlbnRzLmZvbnQgPSB0aGlzLm5hbWVGb250OwogICAgICBvZmZzZXQgPSAwOwogICAgICBpZiAoKGNlbGwuaWNvbiAhPSBudWxsKSAmJiBjZWxsLmljb24ubmFtZS5sZW5ndGggPiAwKSB7CiAgICAgICAgaWNvblNldCA9IFJlc291cmNlTWFuYWdlci5nZXRCaXRtYXAoIkdyYXBoaWNzL0ljb25zLyIgKyBjZWxsLmljb24ubmFtZSk7CiAgICAgICAgdGhpcy5kcmF3SWNvbihpY29uU2V0LCBjZWxsLmljb25QYXR0ZXJuLCB4IC0gOCwgeSk7CiAgICAgICAgb2Zmc2V0ID0gMjg7CiAgICAgIH0KICAgICAgdGhpcy5jb250ZW50cy5kcmF3VGV4dCh4ICsgb2Zmc2V0LCB5LCB0aGlzLmNvbHVtbldpZHRoLCB0aGlzLmNvbHVtbkhlaWdodCwgIiIgKyBjZWxsLm5hbWUsIDApOwogICAgICBpZiAoY2VsbC5tcENvc3QgPiAwKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuY29udGVudHMuZHJhd1RleHQoeCAtIDIsIHksIHRoaXMuY29sdW1uV2lkdGgsIHRoaXMuY29sdW1uSGVpZ2h0LCAiIiArIGNlbGwubXBDb3N0LCAyKTsKICAgICAgfQogICAgfTsKCiAgICBXaW5kb3dfU2tpbGxzLnByb3RvdHlwZS52YWxpZGF0ZUNlbGwgPSBmdW5jdGlvbih4LCB5LCBjZWxsKSB7CiAgICAgIHZhciByZXN1bHQsIHNraWxsOwogICAgICBpZiAoY2VsbC5lbXB0eSkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgICByZXN1bHQgPSB0cnVlOwogICAgICBza2lsbCA9IGNlbGw7CiAgICAgIGNvbnNvbGUubG9nKHNraWxsKTsKICAgICAgc3dpdGNoIChza2lsbC5vY2Nhc2lvbikgewogICAgICAgIGNhc2UgMDoKICAgICAgICAgIHJlc3VsdCA9IHRydWU7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDE6CiAgICAgICAgICByZXN1bHQgPSBTY2VuZU1hbmFnZXIuc2NlbmUgaW5zdGFuY2VvZiBTY2VuZV9CYXR0bGU7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDI6CiAgICAgICAgICByZXN1bHQgPSBTY2VuZU1hbmFnZXIuc2NlbmUgaW5zdGFuY2VvZiBTY2VuZV9NYWluTWVudTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgMzoKICAgICAgICAgIHJlc3VsdCA9IGZhbHNlOwogICAgICB9CiAgICAgIGlmIChyZXN1bHQpIHsKICAgICAgICByZXN1bHQgPSBza2lsbC5zY29wZSA+PSAxICYmIHNraWxsLnNjb3BlIDw9IDY7CiAgICAgIH0KICAgICAgaWYgKHJlc3VsdCkgewogICAgICAgIHJlc3VsdCA9IHNraWxsLm1wQ29zdCA9PT0gMCB8fCAodGhpcy5tZW1iZXIuaXNBbGl2ZSAmJiB0aGlzLm1lbWJlci5tcCA+PSBza2lsbC5tcENvc3QpOwogICAgICB9CiAgICAgIGlmIChyZXN1bHQgJiYgc2tpbGwud2VhcG9uVHlwZUlkMSA+IDApIHsKICAgICAgICByZXN1bHQgPSB0aGlzLm1lbWJlci53ZWFwb25UeXBlc1tza2lsbC53ZWFwb25UeXBlSWQxIC0gMV0gIT0gbnVsbDsKICAgICAgfQogICAgICBpZiAocmVzdWx0ICYmIHNraWxsLndlYXBvblR5cGVJZDIgPiAwKSB7CiAgICAgICAgcmVzdWx0ID0gdGhpcy5tZW1iZXIud2VhcG9uVHlwZXNbc2tpbGwud2VhcG9uVHlwZUlkMiAtIDFdICE9IG51bGw7CiAgICAgIH0KICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH07CgogICAgV2luZG93X1NraWxscy5wcm90b3R5cGUucmVidWlsZFJvd3MgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGNvbHVtbiwgY3VycmVudEl0ZW1zLCBpLCBpdGVtcywgcm93LCByb3dzLCBfaSwgX2osIF9yZWYsIF9yZWYxOwogICAgICBpdGVtcyA9IG51bGw7CiAgICAgIGN1cnJlbnRJdGVtcyA9IFtdOwogICAgICByb3dzID0gW107CiAgICAgIHJvdyA9IDA7CiAgICAgIGNvbHVtbiA9IDA7CiAgICAgIGl0ZW1zID0gdGhpcy5tZW1iZXIuc2tpbGxzW3RoaXMudHlwZV07CiAgICAgIGNvbnNvbGUubG9nKGl0ZW1zKTsKICAgICAgaWYgKGl0ZW1zICE9IG51bGwpIHsKICAgICAgICBmb3IgKGkgPSBfaSA9IDAsIF9yZWYgPSBpdGVtcy5sZW5ndGg7IDAgPD0gX3JlZiA/IF9pIDwgX3JlZiA6IF9pID4gX3JlZjsgaSA9IDAgPD0gX3JlZiA/ICsrX2kgOiAtLV9pKSB7CiAgICAgICAgICBpZiAoaXRlbXNbaV0gIT0gbnVsbCkgewogICAgICAgICAgICBjdXJyZW50SXRlbXMucHVzaChpdGVtc1tpXSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICAgIGZvciAoaSA9IF9qID0gMCwgX3JlZjEgPSBjdXJyZW50SXRlbXMubGVuZ3RoOyAwIDw9IF9yZWYxID8gX2ogPCBfcmVmMSA6IF9qID4gX3JlZjE7IGkgPSAwIDw9IF9yZWYxID8gKytfaiA6IC0tX2opIHsKICAgICAgICByb3cgPSBNYXRoLmZsb29yKGkgLyAyKTsKICAgICAgICBjb2x1bW4gPSBpICUgMjsKICAgICAgICBpZiAocm93c1tyb3ddID09IG51bGwpIHsKICAgICAgICAgIHJvd3Nbcm93XSA9IFtdOwogICAgICAgIH0KICAgICAgICByb3dzW3Jvd11bY29sdW1uXSA9IGN1cnJlbnRJdGVtc1tpXTsKICAgICAgfQogICAgICB0aGlzLnJvd3MgPSByb3dzOwogICAgICByZXR1cm4gY29uc29sZS5sb2codGhpcy5yb3dzKTsKICAgIH07CgogICAgcmV0dXJuIFdpbmRvd19Ta2lsbHM7CgogIH0pKFdpbmRvd19TZWxlY3Rpb24pOwoKICB3aW5kb3cuV2luZG93X1NraWxscyA9IFdpbmRvd19Ta2lsbHM7Cgp9KS5jYWxsKHRoaXMpOwo="},{"name":"Window_SkillType","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogV2luZG93X1NraWxsVHlwZQojICAgQ3JlYXRlZCBvbjogMjAxMy0wOS0yNAojCiMgICBDb3B5cmlnaHQgKEMpIDIwMTMgQW5kcukgUmFkb21za2kuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIENsYXNzOiBXaW5kb3dfU2tpbGxUeXBlCiMKIyAgIEEgd2luZG93IHdoaWNoIGRpc3BsYXlzIGEgdGV4dC4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCmNsYXNzIFdpbmRvd19Ta2lsbFR5cGUgZXh0ZW5kcyBXaW5kb3dfU2VsZWN0aW9uICAgICAgICAKICAgIGNvbnN0cnVjdG9yOiAoeCwgeSwgdmlld3BvcnQsIHdpZHRoKSAtPgogICAgICAgIHdpZHRoID0gd2lkdGggfHwgKDQxNipXaW5kb3dfQmFzZS5zY2FsZSkKICAgICAgICBzdXBlcih4LCB5LCA0LCBbXSwgTWF0aC5mbG9vcih3aWR0aCAvIDQpIC0gNiAqIFdpbmRvd19CYXNlLnNjYWxlLCAyMCAqIFdpbmRvd19CYXNlLnNjYWxlLCB2aWV3cG9ydCkKICAgICAgICBAdHlwZSA9IDAKICAgICAgICBAbWVtYmVyID0gbnVsbAogICAgICAgIEBjb250ZW50cy5mb250ID0gQG5hbWVGb250CiAgICBkcmF3Q2VsbDogKHgsIHksIGNlbGwpIC0+CiAgICAgICAgQGNvbnRlbnRzLmRyYXdUZXh0KHgsIHksIEBjb2x1bW5XaWR0aCwgQGNvbHVtbkhlaWdodCwgIiN7Y2VsbC5uYW1lfSIsIDApIAogICAgICAgIAp3aW5kb3cuV2luZG93X1NraWxsVHlwZSA9IFdpbmRvd19Ta2lsbFR5cGU=","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBXaW5kb3dfU2tpbGxUeXBlLAogICAgX19oYXNQcm9wID0ge30uaGFzT3duUHJvcGVydHksCiAgICBfX2V4dGVuZHMgPSBmdW5jdGlvbihjaGlsZCwgcGFyZW50KSB7IGZvciAodmFyIGtleSBpbiBwYXJlbnQpIHsgaWYgKF9faGFzUHJvcC5jYWxsKHBhcmVudCwga2V5KSkgY2hpbGRba2V5XSA9IHBhcmVudFtrZXldOyB9IGZ1bmN0aW9uIGN0b3IoKSB7IHRoaXMuY29uc3RydWN0b3IgPSBjaGlsZDsgfSBjdG9yLnByb3RvdHlwZSA9IHBhcmVudC5wcm90b3R5cGU7IGNoaWxkLnByb3RvdHlwZSA9IG5ldyBjdG9yKCk7IGNoaWxkLl9fc3VwZXJfXyA9IHBhcmVudC5wcm90b3R5cGU7IHJldHVybiBjaGlsZDsgfTsKCiAgV2luZG93X1NraWxsVHlwZSA9IChmdW5jdGlvbihfc3VwZXIpIHsKICAgIF9fZXh0ZW5kcyhXaW5kb3dfU2tpbGxUeXBlLCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFdpbmRvd19Ta2lsbFR5cGUoeCwgeSwgdmlld3BvcnQsIHdpZHRoKSB7CiAgICAgIHdpZHRoID0gd2lkdGggfHwgKDQxNiAqIFdpbmRvd19CYXNlLnNjYWxlKTsKICAgICAgV2luZG93X1NraWxsVHlwZS5fX3N1cGVyX18uY29uc3RydWN0b3IuY2FsbCh0aGlzLCB4LCB5LCA0LCBbXSwgTWF0aC5mbG9vcih3aWR0aCAvIDQpIC0gNiAqIFdpbmRvd19CYXNlLnNjYWxlLCAyMCAqIFdpbmRvd19CYXNlLnNjYWxlLCB2aWV3cG9ydCk7CiAgICAgIHRoaXMudHlwZSA9IDA7CiAgICAgIHRoaXMubWVtYmVyID0gbnVsbDsKICAgICAgdGhpcy5jb250ZW50cy5mb250ID0gdGhpcy5uYW1lRm9udDsKICAgIH0KCiAgICBXaW5kb3dfU2tpbGxUeXBlLnByb3RvdHlwZS5kcmF3Q2VsbCA9IGZ1bmN0aW9uKHgsIHksIGNlbGwpIHsKICAgICAgcmV0dXJuIHRoaXMuY29udGVudHMuZHJhd1RleHQoeCwgeSwgdGhpcy5jb2x1bW5XaWR0aCwgdGhpcy5jb2x1bW5IZWlnaHQsICIiICsgY2VsbC5uYW1lLCAwKTsKICAgIH07CgogICAgcmV0dXJuIFdpbmRvd19Ta2lsbFR5cGU7CgogIH0pKFdpbmRvd19TZWxlY3Rpb24pOwoKICB3aW5kb3cuV2luZG93X1NraWxsVHlwZSA9IFdpbmRvd19Ta2lsbFR5cGU7Cgp9KS5jYWxsKHRoaXMpOwo="},{"name":"Window_Equipment","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogV2luZG93X0VxdWlwbWVudAojICAgQ3JlYXRlZCBvbjogMjAxMy0wOS0yMgojCiMgICBDb3B5cmlnaHQgKEMpIDIwMTMgQW5kcukgUmFkb21za2kuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIENsYXNzOiBXaW5kb3dfRXF1aXBtZW50CiMKIyAgIEEgd2luZG93IHdoaWNoIGRpc3BsYXlzIHRoZSBlcXVpcG1lbnQgb2YgYSBwYXJ0eSBtZW1iZXIKIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCmNsYXNzIFdpbmRvd19FcXVpcG1lbnQgZXh0ZW5kcyBXaW5kb3dfU2VsZWN0aW9uICAgCiAgICBjb25zdHJ1Y3RvcjogKHgsIHkpIC0+CiAgICAgICAgc3VwZXIoeCwgeSwgMSwgW1swXSwgWzFdLCBbMl0sIFszXSwgWzRdXSwgMjgyICogV2luZG93X0Jhc2Uuc2NhbGUsIDI4ICogV2luZG93X0Jhc2Uuc2NhbGUpCiAgICAgICAgQGhlaWdodCA9IDE4MCAqIFdpbmRvd19CYXNlLnNjYWxlCiAgICAgICAgQG1lbWJlciA9IG51bGwKICAgICAgICBAY29udGVudHMuZm9udCA9IEBuYW1lRm9udAogICAgICAgIEB2b2NhYiA9IFJlY29yZE1hbmFnZXIudm9jYWJ1bGFyeQogICAgICAgIEB3ZWFwb25TdHJpbmcgPSBsY3MoQHZvY2FiLmVxdWlwU2xvdHMud2VhcG9uKQogICAgICAgIEBzaGllbGRTdHJpbmcgPSBsY3MoQHZvY2FiLmVxdWlwU2xvdHMuc2hpZWxkKQogICAgICAgIEBoZWFkU3RyaW5nID0gbGNzKEB2b2NhYi5lcXVpcFNsb3RzLmhlYWRBcm1vcikKICAgICAgICBAYm9keVN0cmluZyA9IGxjcyhAdm9jYWIuZXF1aXBTbG90cy5ib2R5QXJtb3IpCiAgICAgICAgQGFjY2Vzc29yeVN0cmluZyA9IGxjcyhAdm9jYWIuZXF1aXBTbG90cy5hY2Nlc3NvcnkpCiAgICBkcmF3Q2VsbDogKHgsIHksIGNlbGwpIC0+CiAgICAgICAgc3dpdGNoIGNlbGwKICAgICAgICAgICAgd2hlbiAwCiAgICAgICAgICAgICAgICBAY29udGVudHMuZHJhd1RleHQoeCwgeSwgQGNvbHVtbldpZHRoLCBAY29sdW1uSGVpZ2h0LCBAd2VhcG9uU3RyaW5nLCAwKSAKICAgICAgICAgICAgICAgIGlmIEBtZW1iZXIud2VhcG9uPwogICAgICAgICAgICAgICAgICAgIEBjb250ZW50cy5kcmF3VGV4dCh4LTQsIHksIEBjb2x1bW5XaWR0aCwgQGNvbHVtbkhlaWdodCwgIiN7QG1lbWJlci53ZWFwb24ubmFtZX0iLCAyKQogICAgICAgICAgICB3aGVuIDEKICAgICAgICAgICAgICAgIEBjb250ZW50cy5kcmF3VGV4dCh4LCB5LCBAY29sdW1uV2lkdGgsIEBjb2x1bW5IZWlnaHQsIEBzaGllbGRTdHJpbmcsIDApIAogICAgICAgICAgICAgICAgaWYgQG1lbWJlci5zaGllbGQ/CiAgICAgICAgICAgICAgICAgICAgQGNvbnRlbnRzLmRyYXdUZXh0KHgtNCwgeSwgQGNvbHVtbldpZHRoLCBAY29sdW1uSGVpZ2h0LCAiI3tAbWVtYmVyLnNoaWVsZC5uYW1lfSIsIDIpCiAgICAgICAgICAgIHdoZW4gMgogICAgICAgICAgICAgICAgQGNvbnRlbnRzLmRyYXdUZXh0KHgsIHksIEBjb2x1bW5XaWR0aCwgQGNvbHVtbkhlaWdodCwgQGhlYWRTdHJpbmcsIDApIAogICAgICAgICAgICAgICAgaWYgQG1lbWJlci5oZWFkPwogICAgICAgICAgICAgICAgICAgIEBjb250ZW50cy5kcmF3VGV4dCh4LTQsIHksIEBjb2x1bW5XaWR0aCwgQGNvbHVtbkhlaWdodCwgIiN7QG1lbWJlci5oZWFkLm5hbWV9IiwgMikKICAgICAgICAgICAgd2hlbiAzCiAgICAgICAgICAgICAgICBAY29udGVudHMuZHJhd1RleHQoeCwgeSwgQGNvbHVtbldpZHRoLCBAY29sdW1uSGVpZ2h0LCBAYm9keVN0cmluZywgMCkgCiAgICAgICAgICAgICAgICBpZiBAbWVtYmVyLmJvZHk/CiAgICAgICAgICAgICAgICAgICAgQGNvbnRlbnRzLmRyYXdUZXh0KHgtNCwgeSwgQGNvbHVtbldpZHRoLCBAY29sdW1uSGVpZ2h0LCAiI3tAbWVtYmVyLmJvZHkubmFtZX0iLCAyKQogICAgICAgICAgICB3aGVuIDQKICAgICAgICAgICAgICAgIEBjb250ZW50cy5kcmF3VGV4dCh4LCB5LCBAY29sdW1uV2lkdGgsIEBjb2x1bW5IZWlnaHQsIEBhY2Nlc3NvcnlTdHJpbmcsIDApIAogICAgICAgICAgICAgICAgaWYgQG1lbWJlci5hY2Nlc3Nvcnk/CiAgICAgICAgICAgICAgICAgICAgQGNvbnRlbnRzLmRyYXdUZXh0KHgtNCwgeSwgQGNvbHVtbldpZHRoLCBAY29sdW1uSGVpZ2h0LCAiI3tAbWVtYmVyLmFjY2Vzc29yeS5uYW1lfSIsIDIpICAgICAgICAgICAgICAgICAgICAKICAgICAgICAKd2luZG93LldpbmRvd19FcXVpcG1lbnQgPSBXaW5kb3dfRXF1aXBtZW50","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBXaW5kb3dfRXF1aXBtZW50LAogICAgX19oYXNQcm9wID0ge30uaGFzT3duUHJvcGVydHksCiAgICBfX2V4dGVuZHMgPSBmdW5jdGlvbihjaGlsZCwgcGFyZW50KSB7IGZvciAodmFyIGtleSBpbiBwYXJlbnQpIHsgaWYgKF9faGFzUHJvcC5jYWxsKHBhcmVudCwga2V5KSkgY2hpbGRba2V5XSA9IHBhcmVudFtrZXldOyB9IGZ1bmN0aW9uIGN0b3IoKSB7IHRoaXMuY29uc3RydWN0b3IgPSBjaGlsZDsgfSBjdG9yLnByb3RvdHlwZSA9IHBhcmVudC5wcm90b3R5cGU7IGNoaWxkLnByb3RvdHlwZSA9IG5ldyBjdG9yKCk7IGNoaWxkLl9fc3VwZXJfXyA9IHBhcmVudC5wcm90b3R5cGU7IHJldHVybiBjaGlsZDsgfTsKCiAgV2luZG93X0VxdWlwbWVudCA9IChmdW5jdGlvbihfc3VwZXIpIHsKICAgIF9fZXh0ZW5kcyhXaW5kb3dfRXF1aXBtZW50LCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFdpbmRvd19FcXVpcG1lbnQoeCwgeSkgewogICAgICBXaW5kb3dfRXF1aXBtZW50Ll9fc3VwZXJfXy5jb25zdHJ1Y3Rvci5jYWxsKHRoaXMsIHgsIHksIDEsIFtbMF0sIFsxXSwgWzJdLCBbM10sIFs0XV0sIDI4MiAqIFdpbmRvd19CYXNlLnNjYWxlLCAyOCAqIFdpbmRvd19CYXNlLnNjYWxlKTsKICAgICAgdGhpcy5oZWlnaHQgPSAxODAgKiBXaW5kb3dfQmFzZS5zY2FsZTsKICAgICAgdGhpcy5tZW1iZXIgPSBudWxsOwogICAgICB0aGlzLmNvbnRlbnRzLmZvbnQgPSB0aGlzLm5hbWVGb250OwogICAgICB0aGlzLnZvY2FiID0gUmVjb3JkTWFuYWdlci52b2NhYnVsYXJ5OwogICAgICB0aGlzLndlYXBvblN0cmluZyA9IGxjcyh0aGlzLnZvY2FiLmVxdWlwU2xvdHMud2VhcG9uKTsKICAgICAgdGhpcy5zaGllbGRTdHJpbmcgPSBsY3ModGhpcy52b2NhYi5lcXVpcFNsb3RzLnNoaWVsZCk7CiAgICAgIHRoaXMuaGVhZFN0cmluZyA9IGxjcyh0aGlzLnZvY2FiLmVxdWlwU2xvdHMuaGVhZEFybW9yKTsKICAgICAgdGhpcy5ib2R5U3RyaW5nID0gbGNzKHRoaXMudm9jYWIuZXF1aXBTbG90cy5ib2R5QXJtb3IpOwogICAgICB0aGlzLmFjY2Vzc29yeVN0cmluZyA9IGxjcyh0aGlzLnZvY2FiLmVxdWlwU2xvdHMuYWNjZXNzb3J5KTsKICAgIH0KCiAgICBXaW5kb3dfRXF1aXBtZW50LnByb3RvdHlwZS5kcmF3Q2VsbCA9IGZ1bmN0aW9uKHgsIHksIGNlbGwpIHsKICAgICAgc3dpdGNoIChjZWxsKSB7CiAgICAgICAgY2FzZSAwOgogICAgICAgICAgdGhpcy5jb250ZW50cy5kcmF3VGV4dCh4LCB5LCB0aGlzLmNvbHVtbldpZHRoLCB0aGlzLmNvbHVtbkhlaWdodCwgdGhpcy53ZWFwb25TdHJpbmcsIDApOwogICAgICAgICAgaWYgKHRoaXMubWVtYmVyLndlYXBvbiAhPSBudWxsKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnRlbnRzLmRyYXdUZXh0KHggLSA0LCB5LCB0aGlzLmNvbHVtbldpZHRoLCB0aGlzLmNvbHVtbkhlaWdodCwgIiIgKyB0aGlzLm1lbWJlci53ZWFwb24ubmFtZSwgMik7CiAgICAgICAgICB9CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDE6CiAgICAgICAgICB0aGlzLmNvbnRlbnRzLmRyYXdUZXh0KHgsIHksIHRoaXMuY29sdW1uV2lkdGgsIHRoaXMuY29sdW1uSGVpZ2h0LCB0aGlzLnNoaWVsZFN0cmluZywgMCk7CiAgICAgICAgICBpZiAodGhpcy5tZW1iZXIuc2hpZWxkICE9IG51bGwpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29udGVudHMuZHJhd1RleHQoeCAtIDQsIHksIHRoaXMuY29sdW1uV2lkdGgsIHRoaXMuY29sdW1uSGVpZ2h0LCAiIiArIHRoaXMubWVtYmVyLnNoaWVsZC5uYW1lLCAyKTsKICAgICAgICAgIH0KICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgMjoKICAgICAgICAgIHRoaXMuY29udGVudHMuZHJhd1RleHQoeCwgeSwgdGhpcy5jb2x1bW5XaWR0aCwgdGhpcy5jb2x1bW5IZWlnaHQsIHRoaXMuaGVhZFN0cmluZywgMCk7CiAgICAgICAgICBpZiAodGhpcy5tZW1iZXIuaGVhZCAhPSBudWxsKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnRlbnRzLmRyYXdUZXh0KHggLSA0LCB5LCB0aGlzLmNvbHVtbldpZHRoLCB0aGlzLmNvbHVtbkhlaWdodCwgIiIgKyB0aGlzLm1lbWJlci5oZWFkLm5hbWUsIDIpOwogICAgICAgICAgfQogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAzOgogICAgICAgICAgdGhpcy5jb250ZW50cy5kcmF3VGV4dCh4LCB5LCB0aGlzLmNvbHVtbldpZHRoLCB0aGlzLmNvbHVtbkhlaWdodCwgdGhpcy5ib2R5U3RyaW5nLCAwKTsKICAgICAgICAgIGlmICh0aGlzLm1lbWJlci5ib2R5ICE9IG51bGwpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29udGVudHMuZHJhd1RleHQoeCAtIDQsIHksIHRoaXMuY29sdW1uV2lkdGgsIHRoaXMuY29sdW1uSGVpZ2h0LCAiIiArIHRoaXMubWVtYmVyLmJvZHkubmFtZSwgMik7CiAgICAgICAgICB9CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDQ6CiAgICAgICAgICB0aGlzLmNvbnRlbnRzLmRyYXdUZXh0KHgsIHksIHRoaXMuY29sdW1uV2lkdGgsIHRoaXMuY29sdW1uSGVpZ2h0LCB0aGlzLmFjY2Vzc29yeVN0cmluZywgMCk7CiAgICAgICAgICBpZiAodGhpcy5tZW1iZXIuYWNjZXNzb3J5ICE9IG51bGwpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29udGVudHMuZHJhd1RleHQoeCAtIDQsIHksIHRoaXMuY29sdW1uV2lkdGgsIHRoaXMuY29sdW1uSGVpZ2h0LCAiIiArIHRoaXMubWVtYmVyLmFjY2Vzc29yeS5uYW1lLCAyKTsKICAgICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICByZXR1cm4gV2luZG93X0VxdWlwbWVudDsKCiAgfSkoV2luZG93X1NlbGVjdGlvbik7CgogIHdpbmRvdy5XaW5kb3dfRXF1aXBtZW50ID0gV2luZG93X0VxdWlwbWVudDsKCn0pLmNhbGwodGhpcyk7Cg=="},{"name":"Window_SaveGame","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogV2luZG93X1NraWxsVHlwZQojICAgQ3JlYXRlZCBvbjogMjAxMy0wOS0yNgojCiMgICBDb3B5cmlnaHQgKEMpIDIwMTMgQW5kcukgUmFkb21za2kuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIENsYXNzOiBXaW5kb3dfU2F2ZUdhbWUKIwojICAgQSB3aW5kb3cgd2hpY2ggZGlzcGxheXMgYSB0ZXh0LgojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKY2xhc3MgV2luZG93X1NhdmVHYW1lIGV4dGVuZHMgV2luZG93X0Jhc2UgICAgCiAgICBjb25zdHJ1Y3RvcjogKHgsIHkpIC0+CiAgICAgICAgc3VwZXIoeCwgeSwgNDY2ICogV2luZG93X0Jhc2Uuc2NhbGUsIDEwOCAqIFdpbmRvd19CYXNlLnNjYWxlKQogICAgICAgIEB0eXBlID0gMAogICAgICAgIEBtZW1iZXIgPSBudWxsCiAgICAgICAgQGNvbnRlbnRzID0gbmV3IEJpdG1hcChAd2lkdGggLSBAcGFkZGluZyoyLCBAaGVpZ2h0IC0gQHBhZGRpbmcqMikKICAgICAgICBAY29udGVudHMuZm9udCA9IEBuYW1lRm9udAogICAgICAgIEBzYXZlR2FtZSA9IG51bGwKICAgICAgICBAYWN0aXZlID0geWVzCiAgICAgICAgQHNsb3QgPSAwCiAgICByZWRyYXc6IC0+CiAgICAgICAgQGNvbnRlbnRzLmNsZWFyKCkKICAgICAgICBAc2F2ZUdhbWUgPSBHYW1lTWFuYWdlci5nZXRTYXZlR2FtZShAc2xvdCkKICAgICAgICB2b2NhYiA9IGxjcyhSZWNvcmRNYW5hZ2VyLnZvY2FidWxhcnkuc2F2ZUdhbWVNZW51KQogICAgICAgIGZpbGUgPSBsY3Modm9jYWIuZmlsZSkKICAgICAgICB0ZXh0U2l6ZSA9IEBjb250ZW50cy50ZXh0U2l6ZShmaWxlLnJlcGxhY2UoIntzbG90fSIsICIxIikpCiAgICAgICAgc2NhbGUgPSBXaW5kb3dfQmFzZS5zY2FsZQoKICAgICAgICBjaGFyYWN0ZXJTaXplID0gbnVsbAogICAgICAgIG1lbWJlciA9IG51bGwKICAgICAgICBAY29udGVudHMuZHJhd1RleHQoNCpzY2FsZSwgMCpzY2FsZSwgQGNvbnRlbnRzLndpZHRoLCB0ZXh0U2l6ZS5oZWlnaHQsIGZpbGUucmVwbGFjZSgie3Nsb3R9IiwgQHNsb3QrMSkpCiAgICAgICAgCiAgICAgICAgaWYgQHNhdmVHYW1lIGFuZCBAc2F2ZUdhbWUucGFydHk/CiAgICAgICAgICAgIG1pbnV0ZXMgPSBNYXRoLmZsb29yKEBzYXZlR2FtZS5mcmFtZUNvdW50IC8gNjAgLyA2MCkKICAgICAgICAgICAgaG91cnMgPSBNYXRoLmZsb29yKG1pbnV0ZXMgLyA2MCkKICAgICAgICAgICAgdGltZVN0cmluZyA9IGxjcyh2b2NhYi50aW1lKS5yZXBsYWNlKCJ7aH0iLCBob3VycykucmVwbGFjZSgie21pbn0iLCBtaW51dGVzKQogICAgICAgICAgICBtb25leVN0cmluZyA9IGxjcyh2b2NhYi5tb25leSkucmVwbGFjZSgie21vbmV5fSIsIEdhbWVNYW5hZ2VyLm1vbmV5KS5yZXBsYWNlKCJ7Y3VyfSIsIGxjcyhSZWNvcmRNYW5hZ2VyLnZvY2FidWxhcnkuc2hvcE1lbnUuY3VycmVuY3kpKQogICAgICAgICAgICBsdlN0cmluZyA9IGxjcyh2b2NhYi5sZXZlbCkKICAgICAgICAgICAgZm9yIGkgaW4gWzAuLi5Ac2F2ZUdhbWUucGFydHkubWVtYmVycy5sZW5ndGhdCiAgICAgICAgICAgICAgICBtZW1iZXIgPSBAc2F2ZUdhbWUucGFydHkubWVtYmVyc1tpXQogICAgICAgICAgICAgICAgbHZTdHJpbmcyID0gbHZTdHJpbmcucmVwbGFjZSgie2xldmVsfSIsIG1lbWJlci5sZXZlbCkKICAgICAgICAgICAgICAgIGlmIFJlY29yZE1hbmFnZXIuYWN0b3JzW21lbWJlci5hY3RvcklkXT8KICAgICAgICAgICAgICAgICAgICBtZW1iZXIuY2hhcmFjdGVyR3JhcGhpYyA9IFJlY29yZE1hbmFnZXIuYWN0b3JzW21lbWJlci5hY3RvcklkXS5jaGFyYWN0ZXJHcmFwaGljCiAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyU2l6ZSA9IEBtZW1iZXJDaGFyYWN0ZXJTaXplKG1lbWJlcikKICAgICAgICAgICAgICAgICAgICBAZHJhd01lbWJlckNoYXJhY3RlcigxMCpzY2FsZSArIGkgKiAoNzAqc2NhbGUpICsgTWF0aC5mbG9vcigoMzYqc2NhbGUgLSBjaGFyYWN0ZXJTaXplLncpIC8gMiksIDIwKnNjYWxlLCBtZW1iZXIpCiAgICAgICAgICAgICAgICBAY29udGVudHMuZHJhd1RleHQoMTAqc2NhbGUgKyBpICogKDcwKnNjYWxlKSwgMjAqc2NhbGUgKyA0NSpzY2FsZSwgNzAqc2NhbGUsIDEyKnNjYWxlLCBsdlN0cmluZzIsIDEpCiAgICAgICAgICAgIEBjb250ZW50cy5kcmF3VGV4dCgwLCAwKnNjYWxlLCBAY29udGVudHMud2lkdGgsIHRleHRTaXplLmhlaWdodCwgdGltZVN0cmluZywgMikKICAgICAgICAgICAgQGNvbnRlbnRzLmRyYXdUZXh0KDAsIEBjb250ZW50cy5oZWlnaHQgLSB0ZXh0U2l6ZS5oZWlnaHQgLSAyLCBAY29udGVudHMud2lkdGgsIHRleHRTaXplLmhlaWdodCwgbW9uZXlTdHJpbmcsIDIpCiAgICAgICAgZWxzZQogICAgICAgICAgICBAY29udGVudHMuZHJhd1RleHQoMCwgMCwgQGNvbnRlbnRzLndpZHRoLCBAY29udGVudHMuaGVpZ2h0LCBsY3Modm9jYWIubm9HYW1lRGF0YSksIDEpCndpbmRvdy5XaW5kb3dfU2F2ZUdhbWUgPSBXaW5kb3dfU2F2ZUdhbWU=","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBXaW5kb3dfU2F2ZUdhbWUsCiAgICBfX2hhc1Byb3AgPSB7fS5oYXNPd25Qcm9wZXJ0eSwKICAgIF9fZXh0ZW5kcyA9IGZ1bmN0aW9uKGNoaWxkLCBwYXJlbnQpIHsgZm9yICh2YXIga2V5IGluIHBhcmVudCkgeyBpZiAoX19oYXNQcm9wLmNhbGwocGFyZW50LCBrZXkpKSBjaGlsZFtrZXldID0gcGFyZW50W2tleV07IH0gZnVuY3Rpb24gY3RvcigpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGNoaWxkOyB9IGN0b3IucHJvdG90eXBlID0gcGFyZW50LnByb3RvdHlwZTsgY2hpbGQucHJvdG90eXBlID0gbmV3IGN0b3IoKTsgY2hpbGQuX19zdXBlcl9fID0gcGFyZW50LnByb3RvdHlwZTsgcmV0dXJuIGNoaWxkOyB9OwoKICBXaW5kb3dfU2F2ZUdhbWUgPSAoZnVuY3Rpb24oX3N1cGVyKSB7CiAgICBfX2V4dGVuZHMoV2luZG93X1NhdmVHYW1lLCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFdpbmRvd19TYXZlR2FtZSh4LCB5KSB7CiAgICAgIFdpbmRvd19TYXZlR2FtZS5fX3N1cGVyX18uY29uc3RydWN0b3IuY2FsbCh0aGlzLCB4LCB5LCA0NjYgKiBXaW5kb3dfQmFzZS5zY2FsZSwgMTA4ICogV2luZG93X0Jhc2Uuc2NhbGUpOwogICAgICB0aGlzLnR5cGUgPSAwOwogICAgICB0aGlzLm1lbWJlciA9IG51bGw7CiAgICAgIHRoaXMuY29udGVudHMgPSBuZXcgQml0bWFwKHRoaXMud2lkdGggLSB0aGlzLnBhZGRpbmcgKiAyLCB0aGlzLmhlaWdodCAtIHRoaXMucGFkZGluZyAqIDIpOwogICAgICB0aGlzLmNvbnRlbnRzLmZvbnQgPSB0aGlzLm5hbWVGb250OwogICAgICB0aGlzLnNhdmVHYW1lID0gbnVsbDsKICAgICAgdGhpcy5hY3RpdmUgPSB0cnVlOwogICAgICB0aGlzLnNsb3QgPSAwOwogICAgfQoKICAgIFdpbmRvd19TYXZlR2FtZS5wcm90b3R5cGUucmVkcmF3ID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBjaGFyYWN0ZXJTaXplLCBmaWxlLCBob3VycywgaSwgbHZTdHJpbmcsIGx2U3RyaW5nMiwgbWVtYmVyLCBtaW51dGVzLCBtb25leVN0cmluZywgc2NhbGUsIHRleHRTaXplLCB0aW1lU3RyaW5nLCB2b2NhYiwgX2ksIF9yZWY7CiAgICAgIHRoaXMuY29udGVudHMuY2xlYXIoKTsKICAgICAgdGhpcy5zYXZlR2FtZSA9IEdhbWVNYW5hZ2VyLmdldFNhdmVHYW1lKHRoaXMuc2xvdCk7CiAgICAgIHZvY2FiID0gbGNzKFJlY29yZE1hbmFnZXIudm9jYWJ1bGFyeS5zYXZlR2FtZU1lbnUpOwogICAgICBmaWxlID0gbGNzKHZvY2FiLmZpbGUpOwogICAgICB0ZXh0U2l6ZSA9IHRoaXMuY29udGVudHMudGV4dFNpemUoZmlsZS5yZXBsYWNlKCJ7c2xvdH0iLCAiMSIpKTsKICAgICAgc2NhbGUgPSBXaW5kb3dfQmFzZS5zY2FsZTsKICAgICAgY2hhcmFjdGVyU2l6ZSA9IG51bGw7CiAgICAgIG1lbWJlciA9IG51bGw7CiAgICAgIHRoaXMuY29udGVudHMuZHJhd1RleHQoNCAqIHNjYWxlLCAwICogc2NhbGUsIHRoaXMuY29udGVudHMud2lkdGgsIHRleHRTaXplLmhlaWdodCwgZmlsZS5yZXBsYWNlKCJ7c2xvdH0iLCB0aGlzLnNsb3QgKyAxKSk7CiAgICAgIGlmICh0aGlzLnNhdmVHYW1lICYmICh0aGlzLnNhdmVHYW1lLnBhcnR5ICE9IG51bGwpKSB7CiAgICAgICAgbWludXRlcyA9IE1hdGguZmxvb3IodGhpcy5zYXZlR2FtZS5mcmFtZUNvdW50IC8gNjAgLyA2MCk7CiAgICAgICAgaG91cnMgPSBNYXRoLmZsb29yKG1pbnV0ZXMgLyA2MCk7CiAgICAgICAgdGltZVN0cmluZyA9IGxjcyh2b2NhYi50aW1lKS5yZXBsYWNlKCJ7aH0iLCBob3VycykucmVwbGFjZSgie21pbn0iLCBtaW51dGVzKTsKICAgICAgICBtb25leVN0cmluZyA9IGxjcyh2b2NhYi5tb25leSkucmVwbGFjZSgie21vbmV5fSIsIEdhbWVNYW5hZ2VyLm1vbmV5KS5yZXBsYWNlKCJ7Y3VyfSIsIGxjcyhSZWNvcmRNYW5hZ2VyLnZvY2FidWxhcnkuc2hvcE1lbnUuY3VycmVuY3kpKTsKICAgICAgICBsdlN0cmluZyA9IGxjcyh2b2NhYi5sZXZlbCk7CiAgICAgICAgZm9yIChpID0gX2kgPSAwLCBfcmVmID0gdGhpcy5zYXZlR2FtZS5wYXJ0eS5tZW1iZXJzLmxlbmd0aDsgMCA8PSBfcmVmID8gX2kgPCBfcmVmIDogX2kgPiBfcmVmOyBpID0gMCA8PSBfcmVmID8gKytfaSA6IC0tX2kpIHsKICAgICAgICAgIG1lbWJlciA9IHRoaXMuc2F2ZUdhbWUucGFydHkubWVtYmVyc1tpXTsKICAgICAgICAgIGx2U3RyaW5nMiA9IGx2U3RyaW5nLnJlcGxhY2UoIntsZXZlbH0iLCBtZW1iZXIubGV2ZWwpOwogICAgICAgICAgaWYgKFJlY29yZE1hbmFnZXIuYWN0b3JzW21lbWJlci5hY3RvcklkXSAhPSBudWxsKSB7CiAgICAgICAgICAgIG1lbWJlci5jaGFyYWN0ZXJHcmFwaGljID0gUmVjb3JkTWFuYWdlci5hY3RvcnNbbWVtYmVyLmFjdG9ySWRdLmNoYXJhY3RlckdyYXBoaWM7CiAgICAgICAgICAgIGNoYXJhY3RlclNpemUgPSB0aGlzLm1lbWJlckNoYXJhY3RlclNpemUobWVtYmVyKTsKICAgICAgICAgICAgdGhpcy5kcmF3TWVtYmVyQ2hhcmFjdGVyKDEwICogc2NhbGUgKyBpICogKDcwICogc2NhbGUpICsgTWF0aC5mbG9vcigoMzYgKiBzY2FsZSAtIGNoYXJhY3RlclNpemUudykgLyAyKSwgMjAgKiBzY2FsZSwgbWVtYmVyKTsKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMuY29udGVudHMuZHJhd1RleHQoMTAgKiBzY2FsZSArIGkgKiAoNzAgKiBzY2FsZSksIDIwICogc2NhbGUgKyA0NSAqIHNjYWxlLCA3MCAqIHNjYWxlLCAxMiAqIHNjYWxlLCBsdlN0cmluZzIsIDEpOwogICAgICAgIH0KICAgICAgICB0aGlzLmNvbnRlbnRzLmRyYXdUZXh0KDAsIDAgKiBzY2FsZSwgdGhpcy5jb250ZW50cy53aWR0aCwgdGV4dFNpemUuaGVpZ2h0LCB0aW1lU3RyaW5nLCAyKTsKICAgICAgICByZXR1cm4gdGhpcy5jb250ZW50cy5kcmF3VGV4dCgwLCB0aGlzLmNvbnRlbnRzLmhlaWdodCAtIHRleHRTaXplLmhlaWdodCAtIDIsIHRoaXMuY29udGVudHMud2lkdGgsIHRleHRTaXplLmhlaWdodCwgbW9uZXlTdHJpbmcsIDIpOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiB0aGlzLmNvbnRlbnRzLmRyYXdUZXh0KDAsIDAsIHRoaXMuY29udGVudHMud2lkdGgsIHRoaXMuY29udGVudHMuaGVpZ2h0LCBsY3Modm9jYWIubm9HYW1lRGF0YSksIDEpOwogICAgICB9CiAgICB9OwoKICAgIHJldHVybiBXaW5kb3dfU2F2ZUdhbWU7CgogIH0pKFdpbmRvd19CYXNlKTsKCiAgd2luZG93LldpbmRvd19TYXZlR2FtZSA9IFdpbmRvd19TYXZlR2FtZTsKCn0pLmNhbGwodGhpcyk7Cg=="},{"name":"Window_Money","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogV2luZG93X01vbmV5CiMgICBDcmVhdGVkIG9uOiAyMDEzLTA5LTI4CiMKIyAgIENvcHlyaWdodCAoQykgMjAxMyBBbmRy6SBSYWRvbXNraS4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KIwojICAgQ2xhc3M6IFdpbmRvd19HYW1lVGltZQojCiMgICBBIHdpbmRvdyB3aGljaCBkaXNwbGF5cyB0aGUgY3VycmVudCBtb25leQojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKY2xhc3MgV2luZG93X01vbmV5IGV4dGVuZHMgV2luZG93X0Jhc2UgICAgCiAgICBjb25zdHJ1Y3RvcjogKHgsIHkpIC0+CiAgICAgICAgc3VwZXIoeCwgeSwgMTc0ICogV2luZG93X0Jhc2Uuc2NhbGUsIDU4ICogV2luZG93X0Jhc2Uuc2NhbGUpCiAgICAgICAgQGNvbnRlbnRzID0gbmV3IEJpdG1hcChAd2lkdGggLSBAcGFkZGluZyoyLCBAaGVpZ2h0IC0gQHBhZGRpbmcqMikKICAgICAgICBAY29udGVudHMuZm9udCA9IEBuYW1lRm9udAogICAgcmVkcmF3OiAtPgogICAgICAgIHZvY2FiID0gUmVjb3JkTWFuYWdlci52b2NhYnVsYXJ5CiAgICAgICAgbW9uZXlTdHJpbmcgPSBsY3Modm9jYWIubWVudS5tb25leSkKICAgICAgICBtb25leVZhbHVlU3RyaW5nID0gbGNzKHZvY2FiLm1lbnUubW9uZXlWYWx1ZSkucmVwbGFjZSgie21vbmV5fSIsIEdhbWVNYW5hZ2VyLm1vbmV5KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKCJ7Y3VyfSIsIGxjcyh2b2NhYi5zaG9wTWVudS5jdXJyZW5jeSkpCiAgICAgICAgdGV4dFNpemUgPSBAY29udGVudHMudGV4dFNpemUobW9uZXlTdHJpbmcpCiAgICAgICAgQGNvbnRlbnRzLmNsZWFyKCkKICAgICAgICAKICAgICAgICBAY29udGVudHMuZHJhd1RleHQoMCwgMiwgQGNvbnRlbnRzLndpZHRoLCB0ZXh0U2l6ZS5oZWlnaHQsIG1vbmV5U3RyaW5nLCAwKQogICAgICAgIEBjb250ZW50cy5kcmF3VGV4dCgwLCA1LCBAY29udGVudHMud2lkdGgsIEBjb250ZW50cy5oZWlnaHQsIG1vbmV5VmFsdWVTdHJpbmcsIDIpCiAgICAgICAgCndpbmRvdy5XaW5kb3dfTW9uZXkgPSBXaW5kb3dfTW9uZXk=","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBXaW5kb3dfTW9uZXksCiAgICBfX2hhc1Byb3AgPSB7fS5oYXNPd25Qcm9wZXJ0eSwKICAgIF9fZXh0ZW5kcyA9IGZ1bmN0aW9uKGNoaWxkLCBwYXJlbnQpIHsgZm9yICh2YXIga2V5IGluIHBhcmVudCkgeyBpZiAoX19oYXNQcm9wLmNhbGwocGFyZW50LCBrZXkpKSBjaGlsZFtrZXldID0gcGFyZW50W2tleV07IH0gZnVuY3Rpb24gY3RvcigpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGNoaWxkOyB9IGN0b3IucHJvdG90eXBlID0gcGFyZW50LnByb3RvdHlwZTsgY2hpbGQucHJvdG90eXBlID0gbmV3IGN0b3IoKTsgY2hpbGQuX19zdXBlcl9fID0gcGFyZW50LnByb3RvdHlwZTsgcmV0dXJuIGNoaWxkOyB9OwoKICBXaW5kb3dfTW9uZXkgPSAoZnVuY3Rpb24oX3N1cGVyKSB7CiAgICBfX2V4dGVuZHMoV2luZG93X01vbmV5LCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFdpbmRvd19Nb25leSh4LCB5KSB7CiAgICAgIFdpbmRvd19Nb25leS5fX3N1cGVyX18uY29uc3RydWN0b3IuY2FsbCh0aGlzLCB4LCB5LCAxNzQgKiBXaW5kb3dfQmFzZS5zY2FsZSwgNTggKiBXaW5kb3dfQmFzZS5zY2FsZSk7CiAgICAgIHRoaXMuY29udGVudHMgPSBuZXcgQml0bWFwKHRoaXMud2lkdGggLSB0aGlzLnBhZGRpbmcgKiAyLCB0aGlzLmhlaWdodCAtIHRoaXMucGFkZGluZyAqIDIpOwogICAgICB0aGlzLmNvbnRlbnRzLmZvbnQgPSB0aGlzLm5hbWVGb250OwogICAgfQoKICAgIFdpbmRvd19Nb25leS5wcm90b3R5cGUucmVkcmF3ID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBtb25leVN0cmluZywgbW9uZXlWYWx1ZVN0cmluZywgdGV4dFNpemUsIHZvY2FiOwogICAgICB2b2NhYiA9IFJlY29yZE1hbmFnZXIudm9jYWJ1bGFyeTsKICAgICAgbW9uZXlTdHJpbmcgPSBsY3Modm9jYWIubWVudS5tb25leSk7CiAgICAgIG1vbmV5VmFsdWVTdHJpbmcgPSBsY3Modm9jYWIubWVudS5tb25leVZhbHVlKS5yZXBsYWNlKCJ7bW9uZXl9IiwgR2FtZU1hbmFnZXIubW9uZXkpLnJlcGxhY2UoIntjdXJ9IiwgbGNzKHZvY2FiLnNob3BNZW51LmN1cnJlbmN5KSk7CiAgICAgIHRleHRTaXplID0gdGhpcy5jb250ZW50cy50ZXh0U2l6ZShtb25leVN0cmluZyk7CiAgICAgIHRoaXMuY29udGVudHMuY2xlYXIoKTsKICAgICAgdGhpcy5jb250ZW50cy5kcmF3VGV4dCgwLCAyLCB0aGlzLmNvbnRlbnRzLndpZHRoLCB0ZXh0U2l6ZS5oZWlnaHQsIG1vbmV5U3RyaW5nLCAwKTsKICAgICAgcmV0dXJuIHRoaXMuY29udGVudHMuZHJhd1RleHQoMCwgNSwgdGhpcy5jb250ZW50cy53aWR0aCwgdGhpcy5jb250ZW50cy5oZWlnaHQsIG1vbmV5VmFsdWVTdHJpbmcsIDIpOwogICAgfTsKCiAgICByZXR1cm4gV2luZG93X01vbmV5OwoKICB9KShXaW5kb3dfQmFzZSk7CgogIHdpbmRvdy5XaW5kb3dfTW9uZXkgPSBXaW5kb3dfTW9uZXk7Cgp9KS5jYWxsKHRoaXMpOwo="},{"name":"Window_GameTime","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogV2luZG93X0dhbWVUaW1lCiMgICBDcmVhdGVkIG9uOiAyMDEzLTA5LTI4CiMKIyAgIENvcHlyaWdodCAoQykgMjAxMyBBbmRy6SBSYWRvbXNraS4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KIwojICAgQ2xhc3M6IFdpbmRvd19HYW1lVGltZQojCiMgICBBIHdpbmRvdyB3aGljaCBkaXNwbGF5cyB0aGUgY3VycmVudCBnYW1lIHRpbWUuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpjbGFzcyBXaW5kb3dfR2FtZVRpbWUgZXh0ZW5kcyBXaW5kb3dfQmFzZSAgICAKICAgIGNvbnN0cnVjdG9yOiAoeCwgeSkgLT4KICAgICAgICBzdXBlcih4LCB5LCAxNzQgKiBXaW5kb3dfQmFzZS5zY2FsZSwgNjAgKiBXaW5kb3dfQmFzZS5zY2FsZSkKICAgICAgICBAY29udGVudHMgPSBuZXcgQml0bWFwKEB3aWR0aCAtIEBwYWRkaW5nKjIsIEBoZWlnaHQgLSBAcGFkZGluZyoyKQogICAgICAgIEBjb250ZW50cy5mb250ID0gQG5hbWVGb250CiAgICByZWRyYXc6IC0+CiAgICAgICAgdm9jYWIgPSBSZWNvcmRNYW5hZ2VyLnZvY2FidWxhcnkKICAgICAgICBnYW1lVGltZVN0cmluZyA9IGxjcyh2b2NhYi5tZW51LmdhbWVUaW1lKQogICAgICAgIHRleHRTaXplID0gQGNvbnRlbnRzLnRleHRTaXplKGdhbWVUaW1lU3RyaW5nKQogICAgICAgIGdhbWVUaW1lID0gR2FtZU1hbmFnZXIuZ2FtZVRpbWUKICAgICAgICBtaW51dGVzID0gTWF0aC5mbG9vcihHcmFwaGljcy5mcmFtZUNvdW50IC8gNjAgLyA2MCkKICAgICAgICBob3VycyA9IE1hdGguZmxvb3IobWludXRlcyAvIDYwKQogICAgICAgIHRpbWVTdHJpbmcgPSBsY3Modm9jYWIubWVudS50aW1lKS5yZXBsYWNlKCJ7aH0iLCBob3VycykucmVwbGFjZSgie21pbn0iLCBtaW51dGVzKQogICAgICAgIAogICAgICAgIEBjb250ZW50cy5jbGVhcigpCiAgICAgICAgCiAgICAgICAgQGNvbnRlbnRzLmRyYXdUZXh0KDAsIDIsIEBjb250ZW50cy53aWR0aCwgdGV4dFNpemUuaGVpZ2h0LCBnYW1lVGltZVN0cmluZywgMCkKICAgICAgICBAY29udGVudHMuZHJhd1RleHQoMCwgNSwgQGNvbnRlbnRzLndpZHRoLCBAY29udGVudHMuaGVpZ2h0LCB0aW1lU3RyaW5nLCAyKQogICAgICAgIAp3aW5kb3cuV2luZG93X0dhbWVUaW1lID0gV2luZG93X0dhbWVUaW1l","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBXaW5kb3dfR2FtZVRpbWUsCiAgICBfX2hhc1Byb3AgPSB7fS5oYXNPd25Qcm9wZXJ0eSwKICAgIF9fZXh0ZW5kcyA9IGZ1bmN0aW9uKGNoaWxkLCBwYXJlbnQpIHsgZm9yICh2YXIga2V5IGluIHBhcmVudCkgeyBpZiAoX19oYXNQcm9wLmNhbGwocGFyZW50LCBrZXkpKSBjaGlsZFtrZXldID0gcGFyZW50W2tleV07IH0gZnVuY3Rpb24gY3RvcigpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGNoaWxkOyB9IGN0b3IucHJvdG90eXBlID0gcGFyZW50LnByb3RvdHlwZTsgY2hpbGQucHJvdG90eXBlID0gbmV3IGN0b3IoKTsgY2hpbGQuX19zdXBlcl9fID0gcGFyZW50LnByb3RvdHlwZTsgcmV0dXJuIGNoaWxkOyB9OwoKICBXaW5kb3dfR2FtZVRpbWUgPSAoZnVuY3Rpb24oX3N1cGVyKSB7CiAgICBfX2V4dGVuZHMoV2luZG93X0dhbWVUaW1lLCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFdpbmRvd19HYW1lVGltZSh4LCB5KSB7CiAgICAgIFdpbmRvd19HYW1lVGltZS5fX3N1cGVyX18uY29uc3RydWN0b3IuY2FsbCh0aGlzLCB4LCB5LCAxNzQgKiBXaW5kb3dfQmFzZS5zY2FsZSwgNjAgKiBXaW5kb3dfQmFzZS5zY2FsZSk7CiAgICAgIHRoaXMuY29udGVudHMgPSBuZXcgQml0bWFwKHRoaXMud2lkdGggLSB0aGlzLnBhZGRpbmcgKiAyLCB0aGlzLmhlaWdodCAtIHRoaXMucGFkZGluZyAqIDIpOwogICAgICB0aGlzLmNvbnRlbnRzLmZvbnQgPSB0aGlzLm5hbWVGb250OwogICAgfQoKICAgIFdpbmRvd19HYW1lVGltZS5wcm90b3R5cGUucmVkcmF3ID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBnYW1lVGltZSwgZ2FtZVRpbWVTdHJpbmcsIGhvdXJzLCBtaW51dGVzLCB0ZXh0U2l6ZSwgdGltZVN0cmluZywgdm9jYWI7CiAgICAgIHZvY2FiID0gUmVjb3JkTWFuYWdlci52b2NhYnVsYXJ5OwogICAgICBnYW1lVGltZVN0cmluZyA9IGxjcyh2b2NhYi5tZW51LmdhbWVUaW1lKTsKICAgICAgdGV4dFNpemUgPSB0aGlzLmNvbnRlbnRzLnRleHRTaXplKGdhbWVUaW1lU3RyaW5nKTsKICAgICAgZ2FtZVRpbWUgPSBHYW1lTWFuYWdlci5nYW1lVGltZTsKICAgICAgbWludXRlcyA9IE1hdGguZmxvb3IoR3JhcGhpY3MuZnJhbWVDb3VudCAvIDYwIC8gNjApOwogICAgICBob3VycyA9IE1hdGguZmxvb3IobWludXRlcyAvIDYwKTsKICAgICAgdGltZVN0cmluZyA9IGxjcyh2b2NhYi5tZW51LnRpbWUpLnJlcGxhY2UoIntofSIsIGhvdXJzKS5yZXBsYWNlKCJ7bWlufSIsIG1pbnV0ZXMpOwogICAgICB0aGlzLmNvbnRlbnRzLmNsZWFyKCk7CiAgICAgIHRoaXMuY29udGVudHMuZHJhd1RleHQoMCwgMiwgdGhpcy5jb250ZW50cy53aWR0aCwgdGV4dFNpemUuaGVpZ2h0LCBnYW1lVGltZVN0cmluZywgMCk7CiAgICAgIHJldHVybiB0aGlzLmNvbnRlbnRzLmRyYXdUZXh0KDAsIDUsIHRoaXMuY29udGVudHMud2lkdGgsIHRoaXMuY29udGVudHMuaGVpZ2h0LCB0aW1lU3RyaW5nLCAyKTsKICAgIH07CgogICAgcmV0dXJuIFdpbmRvd19HYW1lVGltZTsKCiAgfSkoV2luZG93X0Jhc2UpOwoKICB3aW5kb3cuV2luZG93X0dhbWVUaW1lID0gV2luZG93X0dhbWVUaW1lOwoKfSkuY2FsbCh0aGlzKTsK"},{"name":"Window_TargetSelection","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogV2luZG93X1RhcmdldFNlbGVjdGlvbgojICAgQ3JlYXRlZCBvbjogMjAxMy0xMC0wMwojCiMgICBDb3B5cmlnaHQgKEMpIDIwMTMgQW5kcukgUmFkb21za2kuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIENsYXNzOiBXaW5kb3dfVGFyZ2V0U2VsZWN0aW9uCiMKIyAgIEEgd2luZG93IHdoaWNoIGRpc3BsYXlzIGEgdGFyZ2V0IHNlbGVjdGlvbiBpbiBiYXR0bGUuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpjbGFzcyBXaW5kb3dfVGFyZ2V0U2VsZWN0aW9uIGV4dGVuZHMgV2luZG93X1NlbGVjdGlvbiAgICAgICAgCiAgICBjb25zdHJ1Y3RvcjogKHgsIHksIHZpZXdwb3J0KSAtPgogICAgICAgIHN1cGVyKHgsIHksIDMsIFtdLCA5OCpXaW5kb3dfQmFzZS5zY2FsZSwgMjAqV2luZG93X0Jhc2Uuc2NhbGUsIHZpZXdwb3J0KQogICAgICAgIEBtZW1iZXIgPSBudWxsCiAgICAgICAgQGNvbnRlbnRzLmZvbnQgPSBAbmFtZUZvbnQKICAgICAgICBAYmFja09wYWNpdHkgPSAyNTUKICAgICAgICBAYmF0dGxlcnMgPSBbXQogICAgICAgIEBjb250ZW50cyA9IG5ldyBCaXRtYXAoQHdpZHRoIC0gQHBhZGRpbmcqMiwgODAqV2luZG93X0Jhc2Uuc2NhbGUpCiAgICAgICAgQGNvbnRlbnRzLmZvbnQgPSBAbmFtZUZvbnQKICAgICAgICBAYWN0aXZlID0gbm8KICAgIHJlZHJhdzogLT4KICAgICAgICBiYXR0bGVyID0gbnVsbAogICAgICAgIGJhdHRsZXJzID0gW10KICAgICAgICByb3cgPSAwCiAgICAgICAgY29sdW1uID0gMAoKICAgICAgICBAcm93cyA9IFtdCiAgICAgICAgQHNlbGVjdGVkUm93ID0gMAogICAgICAgIEBzZWxlY3RlZENvbHVtbiA9IDAKICAgICAgICAKICAgICAgICBmb3IgaSBpbiBbMC4uLkBiYXR0bGVycy5sZW5ndGhdCiAgICAgICAgICAgIGlmIEBiYXR0bGVyc1tpXS5hY3Rvci5pc0FsaXZlIGFuZCBub3QgQGJhdHRsZXJzW2ldLmlzSGlkZGVuIAogICAgICAgICAgICAgICAgYmF0dGxlcnMucHVzaChAYmF0dGxlcnNbaV0pCiAgICAgICAgICAgICAgICAKICAgICAgICBmb3IgaSBpbiBbMC4uLmJhdHRsZXJzLmxlbmd0aF0KICAgICAgICAgICAgYmF0dGxlciA9IGJhdHRsZXJzW2ldCiAgICAgICAgICAgIHJvdyA9IGkgJSA0CiAgICAgICAgICAgIGNvbHVtbiA9IE1hdGguZmxvb3IoaSAvIDQpCiAgICAgICAgICAgIAogICAgICAgICAgICBpZiBub3QgQHJvd3Nbcm93XT8gdGhlbiBAcm93c1tyb3ddID0gW10KICAgICAgICAgICAgQHJvd3Nbcm93XVtjb2x1bW5dID0gYmF0dGxlcgoKICAgICAgICBzdXBlcgogICAgICAgIAogICAgZHJhd0NlbGw6ICh4LCB5LCBjZWxsKSAtPgogICAgICAgIGNvbnNvbGUubG9nKCJEUkFXOiAje3h9LCAje0Bjb2x1bW5IZWlnaHR9IikKICAgICAgICBAY29udGVudHMuZHJhd1RleHQoeCwgeSwgQGNvbHVtbldpZHRoLCBAY29sdW1uSGVpZ2h0LCAiI3tjZWxsLmFjdG9yLm5hbWV9IiwgMCkgCiAgICAgICAgCiAgICB1cGRhdGU6IC0+CiAgICAgICAgc3VwZXIKICAgICAgICAKICAgICAgICBpZiBAYWN0aXZlCiAgICAgICAgICAgIGlmIElucHV0LnRyaWdnZXIoSW5wdXQuQykgYW5kIEBvblRhcmdldFNlbGVjdGlvbj8KICAgICAgICAgICAgICAgIEBvblRhcmdldFNlbGVjdGlvbigpCiAgICAgICAgICAgICAgICAKICAgICAgICAKd2luZG93LldpbmRvd19UYXJnZXRTZWxlY3Rpb24gPSBXaW5kb3dfVGFyZ2V0U2VsZWN0aW9u","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBXaW5kb3dfVGFyZ2V0U2VsZWN0aW9uLAogICAgX19oYXNQcm9wID0ge30uaGFzT3duUHJvcGVydHksCiAgICBfX2V4dGVuZHMgPSBmdW5jdGlvbihjaGlsZCwgcGFyZW50KSB7IGZvciAodmFyIGtleSBpbiBwYXJlbnQpIHsgaWYgKF9faGFzUHJvcC5jYWxsKHBhcmVudCwga2V5KSkgY2hpbGRba2V5XSA9IHBhcmVudFtrZXldOyB9IGZ1bmN0aW9uIGN0b3IoKSB7IHRoaXMuY29uc3RydWN0b3IgPSBjaGlsZDsgfSBjdG9yLnByb3RvdHlwZSA9IHBhcmVudC5wcm90b3R5cGU7IGNoaWxkLnByb3RvdHlwZSA9IG5ldyBjdG9yKCk7IGNoaWxkLl9fc3VwZXJfXyA9IHBhcmVudC5wcm90b3R5cGU7IHJldHVybiBjaGlsZDsgfTsKCiAgV2luZG93X1RhcmdldFNlbGVjdGlvbiA9IChmdW5jdGlvbihfc3VwZXIpIHsKICAgIF9fZXh0ZW5kcyhXaW5kb3dfVGFyZ2V0U2VsZWN0aW9uLCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFdpbmRvd19UYXJnZXRTZWxlY3Rpb24oeCwgeSwgdmlld3BvcnQpIHsKICAgICAgV2luZG93X1RhcmdldFNlbGVjdGlvbi5fX3N1cGVyX18uY29uc3RydWN0b3IuY2FsbCh0aGlzLCB4LCB5LCAzLCBbXSwgOTggKiBXaW5kb3dfQmFzZS5zY2FsZSwgMjAgKiBXaW5kb3dfQmFzZS5zY2FsZSwgdmlld3BvcnQpOwogICAgICB0aGlzLm1lbWJlciA9IG51bGw7CiAgICAgIHRoaXMuY29udGVudHMuZm9udCA9IHRoaXMubmFtZUZvbnQ7CiAgICAgIHRoaXMuYmFja09wYWNpdHkgPSAyNTU7CiAgICAgIHRoaXMuYmF0dGxlcnMgPSBbXTsKICAgICAgdGhpcy5jb250ZW50cyA9IG5ldyBCaXRtYXAodGhpcy53aWR0aCAtIHRoaXMucGFkZGluZyAqIDIsIDgwICogV2luZG93X0Jhc2Uuc2NhbGUpOwogICAgICB0aGlzLmNvbnRlbnRzLmZvbnQgPSB0aGlzLm5hbWVGb250OwogICAgICB0aGlzLmFjdGl2ZSA9IGZhbHNlOwogICAgfQoKICAgIFdpbmRvd19UYXJnZXRTZWxlY3Rpb24ucHJvdG90eXBlLnJlZHJhdyA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgYmF0dGxlciwgYmF0dGxlcnMsIGNvbHVtbiwgaSwgcm93LCBfaSwgX2osIF9yZWYsIF9yZWYxOwogICAgICBiYXR0bGVyID0gbnVsbDsKICAgICAgYmF0dGxlcnMgPSBbXTsKICAgICAgcm93ID0gMDsKICAgICAgY29sdW1uID0gMDsKICAgICAgdGhpcy5yb3dzID0gW107CiAgICAgIHRoaXMuc2VsZWN0ZWRSb3cgPSAwOwogICAgICB0aGlzLnNlbGVjdGVkQ29sdW1uID0gMDsKICAgICAgZm9yIChpID0gX2kgPSAwLCBfcmVmID0gdGhpcy5iYXR0bGVycy5sZW5ndGg7IDAgPD0gX3JlZiA/IF9pIDwgX3JlZiA6IF9pID4gX3JlZjsgaSA9IDAgPD0gX3JlZiA/ICsrX2kgOiAtLV9pKSB7CiAgICAgICAgaWYgKHRoaXMuYmF0dGxlcnNbaV0uYWN0b3IuaXNBbGl2ZSAmJiAhdGhpcy5iYXR0bGVyc1tpXS5pc0hpZGRlbikgewogICAgICAgICAgYmF0dGxlcnMucHVzaCh0aGlzLmJhdHRsZXJzW2ldKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgZm9yIChpID0gX2ogPSAwLCBfcmVmMSA9IGJhdHRsZXJzLmxlbmd0aDsgMCA8PSBfcmVmMSA/IF9qIDwgX3JlZjEgOiBfaiA+IF9yZWYxOyBpID0gMCA8PSBfcmVmMSA/ICsrX2ogOiAtLV9qKSB7CiAgICAgICAgYmF0dGxlciA9IGJhdHRsZXJzW2ldOwogICAgICAgIHJvdyA9IGkgJSA0OwogICAgICAgIGNvbHVtbiA9IE1hdGguZmxvb3IoaSAvIDQpOwogICAgICAgIGlmICh0aGlzLnJvd3Nbcm93XSA9PSBudWxsKSB7CiAgICAgICAgICB0aGlzLnJvd3Nbcm93XSA9IFtdOwogICAgICAgIH0KICAgICAgICB0aGlzLnJvd3Nbcm93XVtjb2x1bW5dID0gYmF0dGxlcjsKICAgICAgfQogICAgICByZXR1cm4gV2luZG93X1RhcmdldFNlbGVjdGlvbi5fX3N1cGVyX18ucmVkcmF3LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICB9OwoKICAgIFdpbmRvd19UYXJnZXRTZWxlY3Rpb24ucHJvdG90eXBlLmRyYXdDZWxsID0gZnVuY3Rpb24oeCwgeSwgY2VsbCkgewogICAgICBjb25zb2xlLmxvZygiRFJBVzogIiArIHggKyAiLCAiICsgdGhpcy5jb2x1bW5IZWlnaHQpOwogICAgICByZXR1cm4gdGhpcy5jb250ZW50cy5kcmF3VGV4dCh4LCB5LCB0aGlzLmNvbHVtbldpZHRoLCB0aGlzLmNvbHVtbkhlaWdodCwgIiIgKyBjZWxsLmFjdG9yLm5hbWUsIDApOwogICAgfTsKCiAgICBXaW5kb3dfVGFyZ2V0U2VsZWN0aW9uLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpIHsKICAgICAgV2luZG93X1RhcmdldFNlbGVjdGlvbi5fX3N1cGVyX18udXBkYXRlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIGlmICh0aGlzLmFjdGl2ZSkgewogICAgICAgIGlmIChJbnB1dC50cmlnZ2VyKElucHV0LkMpICYmICh0aGlzLm9uVGFyZ2V0U2VsZWN0aW9uICE9IG51bGwpKSB7CiAgICAgICAgICByZXR1cm4gdGhpcy5vblRhcmdldFNlbGVjdGlvbigpOwogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICByZXR1cm4gV2luZG93X1RhcmdldFNlbGVjdGlvbjsKCiAgfSkoV2luZG93X1NlbGVjdGlvbik7CgogIHdpbmRvdy5XaW5kb3dfVGFyZ2V0U2VsZWN0aW9uID0gV2luZG93X1RhcmdldFNlbGVjdGlvbjsKCn0pLmNhbGwodGhpcyk7Cg=="},{"name":"Window_Language","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogV2luZG93X0xhbmd1YWdlCiMgICBDcmVhdGVkIG9uOiAyMDEzLTExLTA5CiMKIyAgIENvcHlyaWdodCAoQykgMjAxMyBBbmRy6SBSYWRvbXNraS4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KIwojICAgQ2xhc3M6IFdpbmRvd19MYW5ndWFnZQojCiMgICBBIHdpbmRvdyB3aGVyZSB0aGUgdXNlciBjYW4gc2VsZWN0IGEgbGFuZ3VhZ2UKIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCmNsYXNzIFdpbmRvd19MYW5ndWFnZSBleHRlbmRzIFdpbmRvd19TZWxlY3Rpb24gICAgCiAgICBjb25zdHJ1Y3RvcjogKHgsIHksIGxhbmd1YWdlcykgLT4KICAgICAgICByb3dzID0gW10KICAgICAgICBmb3IgbGFuZ3VhZ2UgaW4gbGFuZ3VhZ2VzCiAgICAgICAgICAgIHJvd3MucHVzaChbbGFuZ3VhZ2VdKQogICAgICAgIAogICAgICAgIHN1cGVyKHgsIHksIDEsIHJvd3MsIDMwMCAqIFdpbmRvd19CYXNlLnNjYWxlKQoKICAgIGRyYXdDZWxsOiAoeCwgeSwgY2VsbCkgLT4KICAgICAgICBpZiBjZWxsLmljb24gYW5kIGNlbGwuaWNvbi5uYW1lLmxlbmd0aCA+IDAKICAgICAgICAgICAgYml0bWFwID0gUmVzb3VyY2VNYW5hZ2VyLmdldEJpdG1hcCgiR3JhcGhpY3MvSWNvbnMvI3tjZWxsLmljb24ubmFtZX0iKQogICAgICAgICAgICBAY29udGVudHMuYmx0KHgsIHksIGJpdG1hcCwgbmV3IFJlY3QoMCwgMCwgYml0bWFwLndpZHRoLCBiaXRtYXAuaGVpZ2h0KSkKICAgICAgICAgICAgQGNvbnRlbnRzLmRyYXdUZXh0KGJpdG1hcC53aWR0aCArIDUgKyB4LCB5LCBAY29udGVudHMud2lkdGgsIEBjb2x1bW5IZWlnaHQsIGNlbGwubmFtZSwgMCkKICAgICAgICBlbHNlCiAgICAgICAgICAgIEBjb250ZW50cy5kcmF3VGV4dCg1ICsgeCwgeSwgQGNvbnRlbnRzLndpZHRoLCBAY29sdW1uSGVpZ2h0LCBjZWxsLm5hbWUsIDApCiAgICAgICAgICAgIAp3aW5kb3cuV2luZG93X0xhbmd1YWdlID0gV2luZG93X0xhbmd1YWdl","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBXaW5kb3dfTGFuZ3VhZ2UsCiAgICBfX2hhc1Byb3AgPSB7fS5oYXNPd25Qcm9wZXJ0eSwKICAgIF9fZXh0ZW5kcyA9IGZ1bmN0aW9uKGNoaWxkLCBwYXJlbnQpIHsgZm9yICh2YXIga2V5IGluIHBhcmVudCkgeyBpZiAoX19oYXNQcm9wLmNhbGwocGFyZW50LCBrZXkpKSBjaGlsZFtrZXldID0gcGFyZW50W2tleV07IH0gZnVuY3Rpb24gY3RvcigpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGNoaWxkOyB9IGN0b3IucHJvdG90eXBlID0gcGFyZW50LnByb3RvdHlwZTsgY2hpbGQucHJvdG90eXBlID0gbmV3IGN0b3IoKTsgY2hpbGQuX19zdXBlcl9fID0gcGFyZW50LnByb3RvdHlwZTsgcmV0dXJuIGNoaWxkOyB9OwoKICBXaW5kb3dfTGFuZ3VhZ2UgPSAoZnVuY3Rpb24oX3N1cGVyKSB7CiAgICBfX2V4dGVuZHMoV2luZG93X0xhbmd1YWdlLCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFdpbmRvd19MYW5ndWFnZSh4LCB5LCBsYW5ndWFnZXMpIHsKICAgICAgdmFyIGxhbmd1YWdlLCByb3dzLCBfaSwgX2xlbjsKICAgICAgcm93cyA9IFtdOwogICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IGxhbmd1YWdlcy5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykgewogICAgICAgIGxhbmd1YWdlID0gbGFuZ3VhZ2VzW19pXTsKICAgICAgICByb3dzLnB1c2goW2xhbmd1YWdlXSk7CiAgICAgIH0KICAgICAgV2luZG93X0xhbmd1YWdlLl9fc3VwZXJfXy5jb25zdHJ1Y3Rvci5jYWxsKHRoaXMsIHgsIHksIDEsIHJvd3MsIDMwMCAqIFdpbmRvd19CYXNlLnNjYWxlKTsKICAgIH0KCiAgICBXaW5kb3dfTGFuZ3VhZ2UucHJvdG90eXBlLmRyYXdDZWxsID0gZnVuY3Rpb24oeCwgeSwgY2VsbCkgewogICAgICB2YXIgYml0bWFwOwogICAgICBpZiAoY2VsbC5pY29uICYmIGNlbGwuaWNvbi5uYW1lLmxlbmd0aCA+IDApIHsKICAgICAgICBiaXRtYXAgPSBSZXNvdXJjZU1hbmFnZXIuZ2V0Qml0bWFwKCJHcmFwaGljcy9JY29ucy8iICsgY2VsbC5pY29uLm5hbWUpOwogICAgICAgIHRoaXMuY29udGVudHMuYmx0KHgsIHksIGJpdG1hcCwgbmV3IFJlY3QoMCwgMCwgYml0bWFwLndpZHRoLCBiaXRtYXAuaGVpZ2h0KSk7CiAgICAgICAgcmV0dXJuIHRoaXMuY29udGVudHMuZHJhd1RleHQoYml0bWFwLndpZHRoICsgNSArIHgsIHksIHRoaXMuY29udGVudHMud2lkdGgsIHRoaXMuY29sdW1uSGVpZ2h0LCBjZWxsLm5hbWUsIDApOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiB0aGlzLmNvbnRlbnRzLmRyYXdUZXh0KDUgKyB4LCB5LCB0aGlzLmNvbnRlbnRzLndpZHRoLCB0aGlzLmNvbHVtbkhlaWdodCwgY2VsbC5uYW1lLCAwKTsKICAgICAgfQogICAgfTsKCiAgICByZXR1cm4gV2luZG93X0xhbmd1YWdlOwoKICB9KShXaW5kb3dfU2VsZWN0aW9uKTsKCiAgd2luZG93LldpbmRvd19MYW5ndWFnZSA9IFdpbmRvd19MYW5ndWFnZTsKCn0pLmNhbGwodGhpcyk7Cg=="},{"name":"Window_InputNumber","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogV2luZG93X0lucHV0TnVtYmVyCiMgICBDcmVhdGVkIG9uOiAyMDEzLTEyLTAyCiMKIyAgIENvcHlyaWdodCAoQykgMjAxMyBBbmRy6SBSYWRvbXNraS4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KIwojICAgQ2xhc3M6IFdpbmRvd19JbnB1dE51bWJlcgojCiMgICBBIHdpbmRvdyB3aGVyZSB0aGUgdXNlciBjYW4gaW5wdXQgYSBudW1iZXIuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpjbGFzcyBXaW5kb3dfSW5wdXROdW1iZXIgZXh0ZW5kcyBXaW5kb3dfQmFzZSAgICAKICAgIGNvbnN0cnVjdG9yOiAoZGlnaXRzKSAtPgogICAgICAgIHMgPSBXaW5kb3dfQmFzZS5zY2FsZQogICAgICAgIHN1cGVyKDEsIDEsIDEsIDEpCiAgICAgICAgcCA9IEBwYWRkaW5nKjIKICAgICAgICAKICAgICAgICBAeCA9IE1hdGguZmxvb3IoKEdyYXBoaWNzLndpZHRoIC0gKHAgKyBkaWdpdHMgKiBwKSkgLyAyKQogICAgICAgIEB5ID0gTWF0aC5mbG9vcigoR3JhcGhpY3MuaGVpZ2h0IC0gNDUqcykgLyAyKQogICAgICAgIEB3aWR0aCA9IChwICsgZGlnaXRzICogcCkKICAgICAgICBAaGVpZ2h0ID0gNDQqcwogICAgICAgIEBjb250ZW50cyA9IG5ldyBCaXRtYXAoQHdpZHRoIC0gcCwgQGhlaWdodCAtIHApCiAgICAgICAgQGNvbnRlbnRzLmZvbnQgPSBAbmFtZUZvbnQKICAgICAgICBAZGlnaXRzID0gZGlnaXRzCiAgICAgICAgQG51bWJlciA9ICIiLmxmaWxsKCcwJywgQGRpZ2l0cykKICAgICAgICBAY3Vyc29yUmVjdCA9IG5ldyBSZWN0KDAsIDAsIHAsIDIwICogcykKICAgICAgICBAaXNDYW5jZWxhYmxlID0geWVzCiAgICAgICAgQHogPSAyMDAKICAgIHJlZHJhdzogLT4KICAgICAgICBwID0gQHBhZGRpbmcqMgogICAgICAgIHRleHRTaXplID0gQGNvbnRlbnRzLnRleHRTaXplKCIwIikKICAgICAgICBAY29udGVudHMuY2xlYXIoKQogICAgICAgIAogICAgICAgIGZvciBpIGluIFswLi4uQGRpZ2l0c10KICAgICAgICAgICAgQGNvbnRlbnRzLmRyYXdUZXh0KGkqcCwgMCwgcCwgQGNvbnRlbnRzLmhlaWdodCwgQG51bWJlci5jaGFyQXQoaSksIDEpCiAgICAgICAgCiAgICBvcGVuOiAtPgogICAgICAgIHN1cGVyKCkKICAgICAgICBAcmVkcmF3KCkKICAgIHVwZGF0ZTogLT4KICAgICAgICBwID0gQHBhZGRpbmcqMgogICAgICAgIGlmIG5vdCBAYWN0aXZlIG9yIEBtYXhWYWx1ZSA9PSAwIHRoZW4gcmV0dXJuCiAgICAgICAgaW5kZXggPSBNYXRoLmZsb29yKEBjdXJzb3JSZWN0LngvcCkKICAgICAgICBtYXggPSBNYXRoLm1pbihNYXRoLmZsb29yKEBtYXhWYWx1ZSAvIEB2YWx1ZSksIDk5KQogICAgICAgIGlmIElucHV0LnRyaWdnZXIoSW5wdXQuTEVGVCkKICAgICAgICAgICAgQGN1cnNvclJlY3QueCA9IE1hdGgubWF4KEBjdXJzb3JSZWN0LnggLSBwLCAwKQogICAgICAgICAgICBAcmVkcmF3KCkKICAgICAgICBpZiBJbnB1dC50cmlnZ2VyKElucHV0LlJJR0hUKQogICAgICAgICAgICBAY3Vyc29yUmVjdC54ID0gTWF0aC5taW4oQGN1cnNvclJlY3QueCArIHAsIEBjb250ZW50cy53aWR0aCAtIHApCiAgICAgICAgICAgIEByZWRyYXcoKQogICAgICAgIGlmIElucHV0LnRyaWdnZXIoSW5wdXQuVVApCiAgICAgICAgICAgIEBudW1iZXIgPSBAbnVtYmVyLnJlcGxhY2VBdChpbmRleCwgKChwYXJzZUludChAbnVtYmVyLmNoYXJBdChpbmRleCkpKzEpICUgMTApLnRvU3RyaW5nKCkpCiAgICAgICAgICAgIEByZWRyYXcoKQogICAgICAgIGlmIElucHV0LnRyaWdnZXIoSW5wdXQuRE9XTikKICAgICAgICAgICAgdmFsdWUgPSBwYXJzZUludChAbnVtYmVyLmNoYXJBdChpbmRleCkpLTEKICAgICAgICAgICAgQG51bWJlciA9IEBudW1iZXIucmVwbGFjZUF0KGluZGV4LCBpZiB2YWx1ZSA9PSAtMSB0aGVuICI5IiBlbHNlIHZhbHVlLnRvU3RyaW5nKCkpCiAgICAgICAgICAgIEByZWRyYXcoKQogICAgICAgIGlmIElucHV0LnRyaWdnZXIoSW5wdXQuQykKICAgICAgICAgICAgQGFjY2VwdCgpCiAgICAgICAgaWYgSW5wdXQudHJpZ2dlcihJbnB1dC5CKSBhbmQgQGlzQ2FuY2VsYWJsZQogICAgICAgICAgICBAY2FuY2VsKCkKICAgICAgICAgICAgCiAgICAgICAgc3VwZXIKICAgICAgICAKICAgIGFjY2VwdDogLT4KICAgICAgICBpZiBAb25BY2NlcHQ/IHRoZW4gQG9uQWNjZXB0KHRoaXMsIHBhcnNlSW50KEBudW1iZXIpKQogICAgICAgIEBjbG9zZSgpCiAgICAgICAgCiAgICBjYW5jZWw6IC0+CiAgICAgICAgaWYgQG9uQ2FuY2VsPyB0aGVuIEBvbkNhbmNlbCh0aGlzKQogICAgICAgIEBjbG9zZSgpCiAgICAgICAgCndpbmRvdy5XaW5kb3dfSW5wdXROdW1iZXIgPSBXaW5kb3dfSW5wdXROdW1iZXI=","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBXaW5kb3dfSW5wdXROdW1iZXIsCiAgICBfX2hhc1Byb3AgPSB7fS5oYXNPd25Qcm9wZXJ0eSwKICAgIF9fZXh0ZW5kcyA9IGZ1bmN0aW9uKGNoaWxkLCBwYXJlbnQpIHsgZm9yICh2YXIga2V5IGluIHBhcmVudCkgeyBpZiAoX19oYXNQcm9wLmNhbGwocGFyZW50LCBrZXkpKSBjaGlsZFtrZXldID0gcGFyZW50W2tleV07IH0gZnVuY3Rpb24gY3RvcigpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGNoaWxkOyB9IGN0b3IucHJvdG90eXBlID0gcGFyZW50LnByb3RvdHlwZTsgY2hpbGQucHJvdG90eXBlID0gbmV3IGN0b3IoKTsgY2hpbGQuX19zdXBlcl9fID0gcGFyZW50LnByb3RvdHlwZTsgcmV0dXJuIGNoaWxkOyB9OwoKICBXaW5kb3dfSW5wdXROdW1iZXIgPSAoZnVuY3Rpb24oX3N1cGVyKSB7CiAgICBfX2V4dGVuZHMoV2luZG93X0lucHV0TnVtYmVyLCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFdpbmRvd19JbnB1dE51bWJlcihkaWdpdHMpIHsKICAgICAgdmFyIHAsIHM7CiAgICAgIHMgPSBXaW5kb3dfQmFzZS5zY2FsZTsKICAgICAgV2luZG93X0lucHV0TnVtYmVyLl9fc3VwZXJfXy5jb25zdHJ1Y3Rvci5jYWxsKHRoaXMsIDEsIDEsIDEsIDEpOwogICAgICBwID0gdGhpcy5wYWRkaW5nICogMjsKICAgICAgdGhpcy54ID0gTWF0aC5mbG9vcigoR3JhcGhpY3Mud2lkdGggLSAocCArIGRpZ2l0cyAqIHApKSAvIDIpOwogICAgICB0aGlzLnkgPSBNYXRoLmZsb29yKChHcmFwaGljcy5oZWlnaHQgLSA0NSAqIHMpIC8gMik7CiAgICAgIHRoaXMud2lkdGggPSBwICsgZGlnaXRzICogcDsKICAgICAgdGhpcy5oZWlnaHQgPSA0NCAqIHM7CiAgICAgIHRoaXMuY29udGVudHMgPSBuZXcgQml0bWFwKHRoaXMud2lkdGggLSBwLCB0aGlzLmhlaWdodCAtIHApOwogICAgICB0aGlzLmNvbnRlbnRzLmZvbnQgPSB0aGlzLm5hbWVGb250OwogICAgICB0aGlzLmRpZ2l0cyA9IGRpZ2l0czsKICAgICAgdGhpcy5udW1iZXIgPSAiIi5sZmlsbCgnMCcsIHRoaXMuZGlnaXRzKTsKICAgICAgdGhpcy5jdXJzb3JSZWN0ID0gbmV3IFJlY3QoMCwgMCwgcCwgMjAgKiBzKTsKICAgICAgdGhpcy5pc0NhbmNlbGFibGUgPSB0cnVlOwogICAgICB0aGlzLnogPSAyMDA7CiAgICB9CgogICAgV2luZG93X0lucHV0TnVtYmVyLnByb3RvdHlwZS5yZWRyYXcgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGksIHAsIHRleHRTaXplLCBfaSwgX3JlZiwgX3Jlc3VsdHM7CiAgICAgIHAgPSB0aGlzLnBhZGRpbmcgKiAyOwogICAgICB0ZXh0U2l6ZSA9IHRoaXMuY29udGVudHMudGV4dFNpemUoIjAiKTsKICAgICAgdGhpcy5jb250ZW50cy5jbGVhcigpOwogICAgICBfcmVzdWx0cyA9IFtdOwogICAgICBmb3IgKGkgPSBfaSA9IDAsIF9yZWYgPSB0aGlzLmRpZ2l0czsgMCA8PSBfcmVmID8gX2kgPCBfcmVmIDogX2kgPiBfcmVmOyBpID0gMCA8PSBfcmVmID8gKytfaSA6IC0tX2kpIHsKICAgICAgICBfcmVzdWx0cy5wdXNoKHRoaXMuY29udGVudHMuZHJhd1RleHQoaSAqIHAsIDAsIHAsIHRoaXMuY29udGVudHMuaGVpZ2h0LCB0aGlzLm51bWJlci5jaGFyQXQoaSksIDEpKTsKICAgICAgfQogICAgICByZXR1cm4gX3Jlc3VsdHM7CiAgICB9OwoKICAgIFdpbmRvd19JbnB1dE51bWJlci5wcm90b3R5cGUub3BlbiA9IGZ1bmN0aW9uKCkgewogICAgICBXaW5kb3dfSW5wdXROdW1iZXIuX19zdXBlcl9fLm9wZW4uY2FsbCh0aGlzKTsKICAgICAgcmV0dXJuIHRoaXMucmVkcmF3KCk7CiAgICB9OwoKICAgIFdpbmRvd19JbnB1dE51bWJlci5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBpbmRleCwgbWF4LCBwLCB2YWx1ZTsKICAgICAgcCA9IHRoaXMucGFkZGluZyAqIDI7CiAgICAgIGlmICghdGhpcy5hY3RpdmUgfHwgdGhpcy5tYXhWYWx1ZSA9PT0gMCkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBpbmRleCA9IE1hdGguZmxvb3IodGhpcy5jdXJzb3JSZWN0LnggLyBwKTsKICAgICAgbWF4ID0gTWF0aC5taW4oTWF0aC5mbG9vcih0aGlzLm1heFZhbHVlIC8gdGhpcy52YWx1ZSksIDk5KTsKICAgICAgaWYgKElucHV0LnRyaWdnZXIoSW5wdXQuTEVGVCkpIHsKICAgICAgICB0aGlzLmN1cnNvclJlY3QueCA9IE1hdGgubWF4KHRoaXMuY3Vyc29yUmVjdC54IC0gcCwgMCk7CiAgICAgICAgdGhpcy5yZWRyYXcoKTsKICAgICAgfQogICAgICBpZiAoSW5wdXQudHJpZ2dlcihJbnB1dC5SSUdIVCkpIHsKICAgICAgICB0aGlzLmN1cnNvclJlY3QueCA9IE1hdGgubWluKHRoaXMuY3Vyc29yUmVjdC54ICsgcCwgdGhpcy5jb250ZW50cy53aWR0aCAtIHApOwogICAgICAgIHRoaXMucmVkcmF3KCk7CiAgICAgIH0KICAgICAgaWYgKElucHV0LnRyaWdnZXIoSW5wdXQuVVApKSB7CiAgICAgICAgdGhpcy5udW1iZXIgPSB0aGlzLm51bWJlci5yZXBsYWNlQXQoaW5kZXgsICgocGFyc2VJbnQodGhpcy5udW1iZXIuY2hhckF0KGluZGV4KSkgKyAxKSAlIDEwKS50b1N0cmluZygpKTsKICAgICAgICB0aGlzLnJlZHJhdygpOwogICAgICB9CiAgICAgIGlmIChJbnB1dC50cmlnZ2VyKElucHV0LkRPV04pKSB7CiAgICAgICAgdmFsdWUgPSBwYXJzZUludCh0aGlzLm51bWJlci5jaGFyQXQoaW5kZXgpKSAtIDE7CiAgICAgICAgdGhpcy5udW1iZXIgPSB0aGlzLm51bWJlci5yZXBsYWNlQXQoaW5kZXgsIHZhbHVlID09PSAtMSA/ICI5IiA6IHZhbHVlLnRvU3RyaW5nKCkpOwogICAgICAgIHRoaXMucmVkcmF3KCk7CiAgICAgIH0KICAgICAgaWYgKElucHV0LnRyaWdnZXIoSW5wdXQuQykpIHsKICAgICAgICB0aGlzLmFjY2VwdCgpOwogICAgICB9CiAgICAgIGlmIChJbnB1dC50cmlnZ2VyKElucHV0LkIpICYmIHRoaXMuaXNDYW5jZWxhYmxlKSB7CiAgICAgICAgdGhpcy5jYW5jZWwoKTsKICAgICAgfQogICAgICByZXR1cm4gV2luZG93X0lucHV0TnVtYmVyLl9fc3VwZXJfXy51cGRhdGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH07CgogICAgV2luZG93X0lucHV0TnVtYmVyLnByb3RvdHlwZS5hY2NlcHQgPSBmdW5jdGlvbigpIHsKICAgICAgaWYgKHRoaXMub25BY2NlcHQgIT0gbnVsbCkgewogICAgICAgIHRoaXMub25BY2NlcHQodGhpcywgcGFyc2VJbnQodGhpcy5udW1iZXIpKTsKICAgICAgfQogICAgICByZXR1cm4gdGhpcy5jbG9zZSgpOwogICAgfTsKCiAgICBXaW5kb3dfSW5wdXROdW1iZXIucHJvdG90eXBlLmNhbmNlbCA9IGZ1bmN0aW9uKCkgewogICAgICBpZiAodGhpcy5vbkNhbmNlbCAhPSBudWxsKSB7CiAgICAgICAgdGhpcy5vbkNhbmNlbCh0aGlzKTsKICAgICAgfQogICAgICByZXR1cm4gdGhpcy5jbG9zZSgpOwogICAgfTsKCiAgICByZXR1cm4gV2luZG93X0lucHV0TnVtYmVyOwoKICB9KShXaW5kb3dfQmFzZSk7CgogIHdpbmRvdy5XaW5kb3dfSW5wdXROdW1iZXIgPSBXaW5kb3dfSW5wdXROdW1iZXI7Cgp9KS5jYWxsKHRoaXMpOwo="},{"name":"Window_InputText","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogV2luZG93X0lucHV0VGV4dAojICAgQ3JlYXRlZCBvbjogMjAxNC0wMS0wMQojCiMgICBDb3B5cmlnaHQgKEMpIDIwMTMgQW5kcukgUmFkb21za2kuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIENsYXNzOiBXaW5kb3dfSW5wdXRUZXh0CiMKIyAgIEEgd2luZG93IHdoZXJlIHRoZSB1c2VyIGNhbiBpbnB1dCBhIG51bWJlci4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCmNsYXNzIFdpbmRvd19JbnB1dFRleHQgZXh0ZW5kcyBXaW5kb3dfU2VsZWN0aW9uICAgCiAgICBjb25zdHJ1Y3RvcjogKHgsIHksIHZpZXdwb3J0KSAtPgogICAgICAgIEBjaGFyTWFwID0gbGNzKFJlY29yZE1hbmFnZXIudm9jYWJ1bGFyeS50ZXh0SW5wdXRNYXApCiAgICAgICAgQGNoYXJNYXAgPSBKU09OLnBhcnNlKEBjaGFyTWFwKQoKICAgICAgICBzdXBlcih4LCB5LCBAY2hhck1hcFswXS5sZW5ndGgsIEBjaGFyTWFwLCAzNCAqIFdpbmRvd19CYXNlLnNjYWxlLCAyMCAqIFdpbmRvd19CYXNlLnNjYWxlLCB2aWV3cG9ydCkKICAgICAgICAKICAgICAgICBAb25TZWxlY3Rpb25BY2NlcHQgPSAoc2VuZGVyLCBjZWxsKSA9PgogICAgICAgICAgICBsYXN0ID0gQGNoYXJNYXBbQGNoYXJNYXAubGVuZ3RoLTFdW0BjaGFyTWFwWzBdLmxlbmd0aC0xXQogICAgICAgICAgICBpZiBAb25DaGFyYWN0ZXJBY2NlcHQ/IGFuZCBjZWxsICE9IGxhc3QgdGhlbiBAb25DaGFyYWN0ZXJBY2NlcHQoc2VsZiwgY2VsbCkKICAgICAgICAgICAgaWYgQG9uQWNjZXB0IGFuZCBjZWxsID09IGxhc3QgdGhlbiBAb25BY2NlcHQoc2VsZikKICAgICAgICBAeiA9IDIwMAogICAgICAgIAp3aW5kb3cuV2luZG93X0lucHV0VGV4dCA9IFdpbmRvd19JbnB1dFRleHQ=","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBXaW5kb3dfSW5wdXRUZXh0LAogICAgX19oYXNQcm9wID0ge30uaGFzT3duUHJvcGVydHksCiAgICBfX2V4dGVuZHMgPSBmdW5jdGlvbihjaGlsZCwgcGFyZW50KSB7IGZvciAodmFyIGtleSBpbiBwYXJlbnQpIHsgaWYgKF9faGFzUHJvcC5jYWxsKHBhcmVudCwga2V5KSkgY2hpbGRba2V5XSA9IHBhcmVudFtrZXldOyB9IGZ1bmN0aW9uIGN0b3IoKSB7IHRoaXMuY29uc3RydWN0b3IgPSBjaGlsZDsgfSBjdG9yLnByb3RvdHlwZSA9IHBhcmVudC5wcm90b3R5cGU7IGNoaWxkLnByb3RvdHlwZSA9IG5ldyBjdG9yKCk7IGNoaWxkLl9fc3VwZXJfXyA9IHBhcmVudC5wcm90b3R5cGU7IHJldHVybiBjaGlsZDsgfTsKCiAgV2luZG93X0lucHV0VGV4dCA9IChmdW5jdGlvbihfc3VwZXIpIHsKICAgIF9fZXh0ZW5kcyhXaW5kb3dfSW5wdXRUZXh0LCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFdpbmRvd19JbnB1dFRleHQoeCwgeSwgdmlld3BvcnQpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgdGhpcy5jaGFyTWFwID0gbGNzKFJlY29yZE1hbmFnZXIudm9jYWJ1bGFyeS50ZXh0SW5wdXRNYXApOwogICAgICB0aGlzLmNoYXJNYXAgPSBKU09OLnBhcnNlKHRoaXMuY2hhck1hcCk7CiAgICAgIFdpbmRvd19JbnB1dFRleHQuX19zdXBlcl9fLmNvbnN0cnVjdG9yLmNhbGwodGhpcywgeCwgeSwgdGhpcy5jaGFyTWFwWzBdLmxlbmd0aCwgdGhpcy5jaGFyTWFwLCAzNCAqIFdpbmRvd19CYXNlLnNjYWxlLCAyMCAqIFdpbmRvd19CYXNlLnNjYWxlLCB2aWV3cG9ydCk7CiAgICAgIHRoaXMub25TZWxlY3Rpb25BY2NlcHQgPSBmdW5jdGlvbihzZW5kZXIsIGNlbGwpIHsKICAgICAgICB2YXIgbGFzdDsKICAgICAgICBsYXN0ID0gX3RoaXMuY2hhck1hcFtfdGhpcy5jaGFyTWFwLmxlbmd0aCAtIDFdW190aGlzLmNoYXJNYXBbMF0ubGVuZ3RoIC0gMV07CiAgICAgICAgaWYgKChfdGhpcy5vbkNoYXJhY3RlckFjY2VwdCAhPSBudWxsKSAmJiBjZWxsICE9PSBsYXN0KSB7CiAgICAgICAgICBfdGhpcy5vbkNoYXJhY3RlckFjY2VwdChzZWxmLCBjZWxsKTsKICAgICAgICB9CiAgICAgICAgaWYgKF90aGlzLm9uQWNjZXB0ICYmIGNlbGwgPT09IGxhc3QpIHsKICAgICAgICAgIHJldHVybiBfdGhpcy5vbkFjY2VwdChzZWxmKTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIHRoaXMueiA9IDIwMDsKICAgIH0KCiAgICByZXR1cm4gV2luZG93X0lucHV0VGV4dDsKCiAgfSkoV2luZG93X1NlbGVjdGlvbik7CgogIHdpbmRvdy5XaW5kb3dfSW5wdXRUZXh0ID0gV2luZG93X0lucHV0VGV4dDsKCn0pLmNhbGwodGhpcyk7Cg=="},{"name":"Window_TextEdit","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogV2luZG93X1RleHRFZGl0CiMgICBDcmVhdGVkIG9uOiAyMDE0LTAxLTAxCiMKIyAgIENvcHlyaWdodCAoQykgMjAxMyBBbmRy6SBSYWRvbXNraS4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KIwojICAgQ2xhc3M6IFdpbmRvd19UZXh0RWRpdAojCiMgICBBIHdpbmRvdyB3aGVyZSB0aGUgdXNlciBjYW4gaW5wdXQgYSB0ZXh0LgojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKY2xhc3MgV2luZG93X1RleHRFZGl0IGV4dGVuZHMgV2luZG93X0Jhc2UgICAgCiAgICBjb25zdHJ1Y3RvcjogKHgsIHksIGxldHRlcnMsIGFjdG9yKSAtPgogICAgICAgIHNjYWxlID0gV2luZG93X0Jhc2Uuc2NhbGUKICAgICAgICAKICAgICAgICBiaXRtYXAgPSBudWxsCiAgICAgICAgaWYgYWN0b3I/CiAgICAgICAgICAgIGJpdG1hcCA9IEBjcmVhdGVBY3RvckZhY2VCaXRtYXAoYWN0b3IpCiAgICAgICAgICAgIAogICAgICAgICAgICAKICAgICAgICBzdXBlcih4LCB5LCAoaWYgYml0bWFwPyB0aGVuIGJpdG1hcC53aWR0aCsxMCpzY2FsZSBlbHNlIDApICsgKDI0KnNjYWxlICsgbGV0dGVycyAqICgyNCpzY2FsZSkpLCBpZiBiaXRtYXA/IHRoZW4gYml0bWFwLmhlaWdodCsyNCpzY2FsZSBlbHNlIDQ0KnNjYWxlKQogICAgICAgIEBiaXRtYXAgPSBiaXRtYXAKICAgICAgICBAY29udGVudHMgPSBuZXcgQml0bWFwKEB3aWR0aCAtIEBwYWRkaW5nKjIsIEBoZWlnaHQgLSBAcGFkZGluZyoyKQogICAgICAgIEBjb250ZW50cy5mb250ID0gQG5hbWVGb250CiAgICAgICAgQGxldHRlcnMgPSBsZXR0ZXJzCiAgICAgICAgQHRleHQgPSAiIgogICAgICAgIEBjdXJzb3JSZWN0ID0gbmV3IFJlY3QoMCwgMCwgMjQgKiBzY2FsZSwgMjAgKiBzY2FsZSkKICAgICAgICBAeiA9IDIwMAogICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgcmVkcmF3OiAtPgogICAgICAgIHNjYWxlID0gV2luZG93X0Jhc2Uuc2NhbGUKICAgICAgICBAY29udGVudHMuY2xlYXIoKQogICAgICAgIHggPSBpZiBAYml0bWFwPyB0aGVuIEBiaXRtYXAud2lkdGggKyAxMCAqIHNjYWxlIGVsc2UgMAogICAgICAgIHkgPSBpZiBAYml0bWFwPyB0aGVuIChAYml0bWFwLmhlaWdodCAtIDI0ICogc2NhbGUpIC8gMiBlbHNlIDAKICAgICAgICBmb3IgaSBpbiBbMC4uLkBsZXR0ZXJzXQogICAgICAgICAgICBAY29udGVudHMuZHJhd1RleHQoeCArIGkqKDI0ICogc2NhbGUpLCAwLCAyNCAqIHNjYWxlLCBAY29udGVudHMuaGVpZ2h0LCAoaWYgQHRleHQubGVuZ3RoID4gaSB0aGVuIEB0ZXh0LmNoYXJBdChpKSBlbHNlICJfIiksIDEpCiAgICAgICAgICAgIAogICAgICAgIGlmIEB0ZXh0Lmxlbmd0aCA8IEBsZXR0ZXJzCiAgICAgICAgICAgIEBjdXJzb3JSZWN0LnNldCh4ICsgQHRleHQubGVuZ3RoICogKDI0ICogc2NhbGUpLCB5LCAyNCAqIHNjYWxlLCAyMCAqIHNjYWxlKQogICAgICAgICAgICAKICAgICAgICBpZiBAYml0bWFwPwogICAgICAgICAgICBAY29udGVudHMuYmx0KDAsIDAsIEBiaXRtYXAsIG5ldyBSZWN0KDAsIDAsIEBiaXRtYXAud2lkdGgsIEBiaXRtYXAuaGVpZ2h0KSkKICAgIG9wZW46IC0+CiAgICAgICAgc3VwZXIoKQogICAgICAgIEByZWRyYXcoKQogICAgdXBkYXRlOiAtPgogICAgICAgIGlmIG5vdCBAYWN0aXZlIHRoZW4gcmV0dXJuCiAgICAgICAgc3VwZXIKICAgICAgICAKd2luZG93LldpbmRvd19UZXh0RWRpdCA9IFdpbmRvd19UZXh0RWRpdA==","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBXaW5kb3dfVGV4dEVkaXQsCiAgICBfX2hhc1Byb3AgPSB7fS5oYXNPd25Qcm9wZXJ0eSwKICAgIF9fZXh0ZW5kcyA9IGZ1bmN0aW9uKGNoaWxkLCBwYXJlbnQpIHsgZm9yICh2YXIga2V5IGluIHBhcmVudCkgeyBpZiAoX19oYXNQcm9wLmNhbGwocGFyZW50LCBrZXkpKSBjaGlsZFtrZXldID0gcGFyZW50W2tleV07IH0gZnVuY3Rpb24gY3RvcigpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGNoaWxkOyB9IGN0b3IucHJvdG90eXBlID0gcGFyZW50LnByb3RvdHlwZTsgY2hpbGQucHJvdG90eXBlID0gbmV3IGN0b3IoKTsgY2hpbGQuX19zdXBlcl9fID0gcGFyZW50LnByb3RvdHlwZTsgcmV0dXJuIGNoaWxkOyB9OwoKICBXaW5kb3dfVGV4dEVkaXQgPSAoZnVuY3Rpb24oX3N1cGVyKSB7CiAgICBfX2V4dGVuZHMoV2luZG93X1RleHRFZGl0LCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFdpbmRvd19UZXh0RWRpdCh4LCB5LCBsZXR0ZXJzLCBhY3RvcikgewogICAgICB2YXIgYml0bWFwLCBzY2FsZTsKICAgICAgc2NhbGUgPSBXaW5kb3dfQmFzZS5zY2FsZTsKICAgICAgYml0bWFwID0gbnVsbDsKICAgICAgaWYgKGFjdG9yICE9IG51bGwpIHsKICAgICAgICBiaXRtYXAgPSB0aGlzLmNyZWF0ZUFjdG9yRmFjZUJpdG1hcChhY3Rvcik7CiAgICAgIH0KICAgICAgV2luZG93X1RleHRFZGl0Ll9fc3VwZXJfXy5jb25zdHJ1Y3Rvci5jYWxsKHRoaXMsIHgsIHksIChiaXRtYXAgIT0gbnVsbCA/IGJpdG1hcC53aWR0aCArIDEwICogc2NhbGUgOiAwKSArICgyNCAqIHNjYWxlICsgbGV0dGVycyAqICgyNCAqIHNjYWxlKSksIGJpdG1hcCAhPSBudWxsID8gYml0bWFwLmhlaWdodCArIDI0ICogc2NhbGUgOiA0NCAqIHNjYWxlKTsKICAgICAgdGhpcy5iaXRtYXAgPSBiaXRtYXA7CiAgICAgIHRoaXMuY29udGVudHMgPSBuZXcgQml0bWFwKHRoaXMud2lkdGggLSB0aGlzLnBhZGRpbmcgKiAyLCB0aGlzLmhlaWdodCAtIHRoaXMucGFkZGluZyAqIDIpOwogICAgICB0aGlzLmNvbnRlbnRzLmZvbnQgPSB0aGlzLm5hbWVGb250OwogICAgICB0aGlzLmxldHRlcnMgPSBsZXR0ZXJzOwogICAgICB0aGlzLnRleHQgPSAiIjsKICAgICAgdGhpcy5jdXJzb3JSZWN0ID0gbmV3IFJlY3QoMCwgMCwgMjQgKiBzY2FsZSwgMjAgKiBzY2FsZSk7CiAgICAgIHRoaXMueiA9IDIwMDsKICAgIH0KCiAgICBXaW5kb3dfVGV4dEVkaXQucHJvdG90eXBlLnJlZHJhdyA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgaSwgc2NhbGUsIHgsIHksIF9pLCBfcmVmOwogICAgICBzY2FsZSA9IFdpbmRvd19CYXNlLnNjYWxlOwogICAgICB0aGlzLmNvbnRlbnRzLmNsZWFyKCk7CiAgICAgIHggPSB0aGlzLmJpdG1hcCAhPSBudWxsID8gdGhpcy5iaXRtYXAud2lkdGggKyAxMCAqIHNjYWxlIDogMDsKICAgICAgeSA9IHRoaXMuYml0bWFwICE9IG51bGwgPyAodGhpcy5iaXRtYXAuaGVpZ2h0IC0gMjQgKiBzY2FsZSkgLyAyIDogMDsKICAgICAgZm9yIChpID0gX2kgPSAwLCBfcmVmID0gdGhpcy5sZXR0ZXJzOyAwIDw9IF9yZWYgPyBfaSA8IF9yZWYgOiBfaSA+IF9yZWY7IGkgPSAwIDw9IF9yZWYgPyArK19pIDogLS1faSkgewogICAgICAgIHRoaXMuY29udGVudHMuZHJhd1RleHQoeCArIGkgKiAoMjQgKiBzY2FsZSksIDAsIDI0ICogc2NhbGUsIHRoaXMuY29udGVudHMuaGVpZ2h0LCAodGhpcy50ZXh0Lmxlbmd0aCA+IGkgPyB0aGlzLnRleHQuY2hhckF0KGkpIDogIl8iKSwgMSk7CiAgICAgIH0KICAgICAgaWYgKHRoaXMudGV4dC5sZW5ndGggPCB0aGlzLmxldHRlcnMpIHsKICAgICAgICB0aGlzLmN1cnNvclJlY3Quc2V0KHggKyB0aGlzLnRleHQubGVuZ3RoICogKDI0ICogc2NhbGUpLCB5LCAyNCAqIHNjYWxlLCAyMCAqIHNjYWxlKTsKICAgICAgfQogICAgICBpZiAodGhpcy5iaXRtYXAgIT0gbnVsbCkgewogICAgICAgIHJldHVybiB0aGlzLmNvbnRlbnRzLmJsdCgwLCAwLCB0aGlzLmJpdG1hcCwgbmV3IFJlY3QoMCwgMCwgdGhpcy5iaXRtYXAud2lkdGgsIHRoaXMuYml0bWFwLmhlaWdodCkpOwogICAgICB9CiAgICB9OwoKICAgIFdpbmRvd19UZXh0RWRpdC5wcm90b3R5cGUub3BlbiA9IGZ1bmN0aW9uKCkgewogICAgICBXaW5kb3dfVGV4dEVkaXQuX19zdXBlcl9fLm9wZW4uY2FsbCh0aGlzKTsKICAgICAgcmV0dXJuIHRoaXMucmVkcmF3KCk7CiAgICB9OwoKICAgIFdpbmRvd19UZXh0RWRpdC5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKSB7CiAgICAgIGlmICghdGhpcy5hY3RpdmUpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgcmV0dXJuIFdpbmRvd19UZXh0RWRpdC5fX3N1cGVyX18udXBkYXRlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICB9OwoKICAgIHJldHVybiBXaW5kb3dfVGV4dEVkaXQ7CgogIH0pKFdpbmRvd19CYXNlKTsKCiAgd2luZG93LldpbmRvd19UZXh0RWRpdCA9IFdpbmRvd19UZXh0RWRpdDsKCn0pLmNhbGwodGhpcyk7Cg=="},{"name":"Windowset_Base","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogV2luZG93c2V0X0Jhc2UKIyAgIENyZWF0ZWQgb246IDIwMTMtMDktMjIKIwojICAgQ29weXJpZ2h0IChDKSAyMDEzIEFuZHLpIFJhZG9tc2tpLiBBbGwgcmlnaHRzIHJlc2VydmVkLgojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQojCiMgICAgQ2xhc3M6IFdpbmRvd3NldF9FcXVpcG1lbnQKIwojICAgIEEgYmFzZSBmb3IgYWxsZSB3aW5kb3dzZXRzLiBBIHdpbmRvd3NldCBkZWZpbmVzIGFuZCBjb250cm9scwojICAgIG11bHRpcGxlIHdpbmRvd3Mgd2hpY2ggYXJlIGRpcmVjdGx5IGNvbm5lY3RlZCB0byBlYWNoIG90aGVyLgojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKY2xhc3MgV2luZG93c2V0X0Jhc2UKICAgIEBzY2FsZSA9IDAuNQogICAgY29uc3RydWN0b3I6IC0+CiAgICAgICAgQHdpbmRvd3MgPSBbXQogICAgICAgIEBzY2FsZSA9IEBjb25zdHJ1Y3Rvci5zY2FsZQogICAgZGlzcG9zZTogLT4KICAgICAgICBmb3IgdyBpbiBAd2luZG93cwogICAgICAgICAgICB3LmRpc3Bvc2UoKQogICAgICAgICAgICAKICAgIHNob3c6IChzaG93LCBhY3RpdmUpIC0+CiAgICAgICAgZm9yIHcgaW4gQHdpbmRvd3MKICAgICAgICAgICAgdy52aXNpYmxlID0gc2hvdwogICAgICAgIAogICAgICAgIGlmIGFjdGl2ZT8KICAgICAgICAgICAgQGFjdGl2ZSA9IGFjdGl2ZQogICAgICAgIGVsc2UKICAgICAgICAgICAgQGFjdGl2ZSA9IHNob3cKICAgICAgICAKICAgICAgICBAcmVkcmF3KCkKICAgICAgICAKICAgIHNob3dNb2RhbDogLT4KICAgICAgICBmb3IgdyBpbiBAd2luZG93cwogICAgICAgICAgICB3Lm9wZW5Nb2RhbCgpCiAgICAgICAgICAgIAogICAgY2xvc2U6IC0+CiAgICAgICAgZm9yIHcgaW4gQHdpbmRvd3MKICAgICAgICAgICAgdy5jbG9zZSgpCiAgICAgICAgICAgIAogICAgdXBkYXRlOiAtPgogICAgICAgIGZvciB3IGluIEB3aW5kb3dzCiAgICAgICAgICAgIHcudXBkYXRlKCkKICAgICAgICAgICAgCiAgICByZWRyYXc6IC0+CiAgICAgICAgCiAgICByZWRyYXdBbGxXaW5kb3dzOiAtPgogICAgICAgIGZvciB3IGluIEB3aW5kb3dzCiAgICAgICAgICAgIHcucmVkcmF3KCkKICAgICAgICAgICAgCndpbmRvdy5XaW5kb3dzZXRfQmFzZSA9IFdpbmRvd3NldF9CYXNl","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBXaW5kb3dzZXRfQmFzZTsKCiAgV2luZG93c2V0X0Jhc2UgPSAoZnVuY3Rpb24oKSB7CiAgICBXaW5kb3dzZXRfQmFzZS5zY2FsZSA9IDAuNTsKCiAgICBmdW5jdGlvbiBXaW5kb3dzZXRfQmFzZSgpIHsKICAgICAgdGhpcy53aW5kb3dzID0gW107CiAgICAgIHRoaXMuc2NhbGUgPSB0aGlzLmNvbnN0cnVjdG9yLnNjYWxlOwogICAgfQoKICAgIFdpbmRvd3NldF9CYXNlLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciB3LCBfaSwgX2xlbiwgX3JlZiwgX3Jlc3VsdHM7CiAgICAgIF9yZWYgPSB0aGlzLndpbmRvd3M7CiAgICAgIF9yZXN1bHRzID0gW107CiAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gX3JlZi5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykgewogICAgICAgIHcgPSBfcmVmW19pXTsKICAgICAgICBfcmVzdWx0cy5wdXNoKHcuZGlzcG9zZSgpKTsKICAgICAgfQogICAgICByZXR1cm4gX3Jlc3VsdHM7CiAgICB9OwoKICAgIFdpbmRvd3NldF9CYXNlLnByb3RvdHlwZS5zaG93ID0gZnVuY3Rpb24oc2hvdywgYWN0aXZlKSB7CiAgICAgIHZhciB3LCBfaSwgX2xlbiwgX3JlZjsKICAgICAgX3JlZiA9IHRoaXMud2luZG93czsKICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBfcmVmLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7CiAgICAgICAgdyA9IF9yZWZbX2ldOwogICAgICAgIHcudmlzaWJsZSA9IHNob3c7CiAgICAgIH0KICAgICAgaWYgKGFjdGl2ZSAhPSBudWxsKSB7CiAgICAgICAgdGhpcy5hY3RpdmUgPSBhY3RpdmU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5hY3RpdmUgPSBzaG93OwogICAgICB9CiAgICAgIHJldHVybiB0aGlzLnJlZHJhdygpOwogICAgfTsKCiAgICBXaW5kb3dzZXRfQmFzZS5wcm90b3R5cGUuc2hvd01vZGFsID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciB3LCBfaSwgX2xlbiwgX3JlZiwgX3Jlc3VsdHM7CiAgICAgIF9yZWYgPSB0aGlzLndpbmRvd3M7CiAgICAgIF9yZXN1bHRzID0gW107CiAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gX3JlZi5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykgewogICAgICAgIHcgPSBfcmVmW19pXTsKICAgICAgICBfcmVzdWx0cy5wdXNoKHcub3Blbk1vZGFsKCkpOwogICAgICB9CiAgICAgIHJldHVybiBfcmVzdWx0czsKICAgIH07CgogICAgV2luZG93c2V0X0Jhc2UucHJvdG90eXBlLmNsb3NlID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciB3LCBfaSwgX2xlbiwgX3JlZiwgX3Jlc3VsdHM7CiAgICAgIF9yZWYgPSB0aGlzLndpbmRvd3M7CiAgICAgIF9yZXN1bHRzID0gW107CiAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gX3JlZi5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykgewogICAgICAgIHcgPSBfcmVmW19pXTsKICAgICAgICBfcmVzdWx0cy5wdXNoKHcuY2xvc2UoKSk7CiAgICAgIH0KICAgICAgcmV0dXJuIF9yZXN1bHRzOwogICAgfTsKCiAgICBXaW5kb3dzZXRfQmFzZS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciB3LCBfaSwgX2xlbiwgX3JlZiwgX3Jlc3VsdHM7CiAgICAgIF9yZWYgPSB0aGlzLndpbmRvd3M7CiAgICAgIF9yZXN1bHRzID0gW107CiAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gX3JlZi5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykgewogICAgICAgIHcgPSBfcmVmW19pXTsKICAgICAgICBfcmVzdWx0cy5wdXNoKHcudXBkYXRlKCkpOwogICAgICB9CiAgICAgIHJldHVybiBfcmVzdWx0czsKICAgIH07CgogICAgV2luZG93c2V0X0Jhc2UucHJvdG90eXBlLnJlZHJhdyA9IGZ1bmN0aW9uKCkge307CgogICAgV2luZG93c2V0X0Jhc2UucHJvdG90eXBlLnJlZHJhd0FsbFdpbmRvd3MgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIHcsIF9pLCBfbGVuLCBfcmVmLCBfcmVzdWx0czsKICAgICAgX3JlZiA9IHRoaXMud2luZG93czsKICAgICAgX3Jlc3VsdHMgPSBbXTsKICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBfcmVmLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7CiAgICAgICAgdyA9IF9yZWZbX2ldOwogICAgICAgIF9yZXN1bHRzLnB1c2gody5yZWRyYXcoKSk7CiAgICAgIH0KICAgICAgcmV0dXJuIF9yZXN1bHRzOwogICAgfTsKCiAgICByZXR1cm4gV2luZG93c2V0X0Jhc2U7CgogIH0pKCk7CgogIHdpbmRvdy5XaW5kb3dzZXRfQmFzZSA9IFdpbmRvd3NldF9CYXNlOwoKfSkuY2FsbCh0aGlzKTsK"},{"name":"Windowset_Alert","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogV2luZG93X0FsZXJ0CiMgICBDcmVhdGVkIG9uOiAyMDEzLTEyLTI0CiMKIyAgIENvcHlyaWdodCAoQykgMjAxMyBBbmRy6SBSYWRvbXNraS4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KIwojICAgQ2xhc3M6IFdpbmRvd19BbGVydAojCiMgICBBIHdpbmRvdyB3aGljaCBkaXNwbGF5cyB0aGUgY3VycmVudCBtb25leQojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKY2xhc3MgV2luZG93c2V0X0FsZXJ0IGV4dGVuZHMgV2luZG93c2V0X0Jhc2UgICAgCiAgICBjb25zdHJ1Y3RvcjogKGRlc2NyaXB0aW9uLCBvcHRpb25zLCB2aWV3cG9ydCkgLT4KICAgICAgICBzdXBlcgogICAgICAgIHMgPSBXaW5kb3dfQmFzZS5zY2FsZQogICAgICAgIEB3aWR0aCA9IDIyNAogICAgICAgIAogICAgICAgIHRleHRTaXplID0gRm9udHMuVEVYVC5tZWFzdXJlVGV4dChkZXNjcmlwdGlvbikKICAgCiAgICAgICAgQGRlc2NyaXB0aW9uV2luZG93ID0gbmV3IFdpbmRvd19UZXh0KChHcmFwaGljcy53aWR0aCAtIEB3aWR0aCkgLyAyLCAoR3JhcGhpY3MuaGVpZ2h0IC0gKHRleHRTaXplLmhlaWdodCsyOCpzKSkgLyAyLCBAd2lkdGgsIHRleHRTaXplLmhlaWdodCArIDI4KnMsIHZpZXdwb3J0KQogICAgICAgIEBkZXNjcmlwdGlvbldpbmRvdy50ZXh0ID0gZGVzY3JpcHRpb24KICAgICAgICBAb3B0aW9uV2luZG93ID0gbmV3IFdpbmRvd19TZWxlY3Rpb24oQGRlc2NyaXB0aW9uV2luZG93LngsIEBkZXNjcmlwdGlvbldpbmRvdy55K0BkZXNjcmlwdGlvbldpbmRvdy5oZWlnaHQsIG9wdGlvbnMubGVuZ3RoLCBbb3B0aW9uc10sIDIwMCAvIG9wdGlvbnMubGVuZ3RoLCAyMCpzLCB2aWV3cG9ydCkKICAgICAgICBAb3B0aW9uV2luZG93LmNvbnRlbnRzLmZvbnQgPSBGb250cy5URVhUCiAgICAgICAgQG9wdGlvbldpbmRvdy5vblNlbGVjdGlvbkFjY2VwdCA9IChzZW5kZXIpID0+IAogICAgICAgICAgICBAY2xvc2UoKQogICAgICAgICAgICBpZiBAb25BY2NlcHQ/IHRoZW4gQG9uQWNjZXB0KHNlbmRlciwgQG9wdGlvbldpbmRvdy5zZWxlY3RlZENvbHVtbikKICAgICAgICBAb3B0aW9uV2luZG93Lm9uQ2FuY2VsID0gPT4KICAgICAgICAgICAgQGNsb3NlKCkKICAgICAgICAgICAgaWYgQG9uQ2FuY2VsPyB0aGVuIEBvbkNhbmNlbCgpCiAgICAgICAgQGRlc2NyaXB0aW9uV2luZG93LndpZHRoID0gQG9wdGlvbldpbmRvdy53aWR0aAogICAgICAgIEB3aW5kb3dzLnB1c2goQGRlc2NyaXB0aW9uV2luZG93KQogICAgICAgIEB3aW5kb3dzLnB1c2goQG9wdGlvbldpbmRvdykKICAgICAgICAKICAgICAgICBAcmVkcmF3QWxsV2luZG93cygpCgogICAgICAgIAp3aW5kb3cuV2luZG93c2V0X0FsZXJ0ID0gV2luZG93c2V0X0FsZXJ0","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBXaW5kb3dzZXRfQWxlcnQsCiAgICBfX2hhc1Byb3AgPSB7fS5oYXNPd25Qcm9wZXJ0eSwKICAgIF9fZXh0ZW5kcyA9IGZ1bmN0aW9uKGNoaWxkLCBwYXJlbnQpIHsgZm9yICh2YXIga2V5IGluIHBhcmVudCkgeyBpZiAoX19oYXNQcm9wLmNhbGwocGFyZW50LCBrZXkpKSBjaGlsZFtrZXldID0gcGFyZW50W2tleV07IH0gZnVuY3Rpb24gY3RvcigpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGNoaWxkOyB9IGN0b3IucHJvdG90eXBlID0gcGFyZW50LnByb3RvdHlwZTsgY2hpbGQucHJvdG90eXBlID0gbmV3IGN0b3IoKTsgY2hpbGQuX19zdXBlcl9fID0gcGFyZW50LnByb3RvdHlwZTsgcmV0dXJuIGNoaWxkOyB9OwoKICBXaW5kb3dzZXRfQWxlcnQgPSAoZnVuY3Rpb24oX3N1cGVyKSB7CiAgICBfX2V4dGVuZHMoV2luZG93c2V0X0FsZXJ0LCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFdpbmRvd3NldF9BbGVydChkZXNjcmlwdGlvbiwgb3B0aW9ucywgdmlld3BvcnQpIHsKICAgICAgdmFyIHMsIHRleHRTaXplLAogICAgICAgIF90aGlzID0gdGhpczsKICAgICAgV2luZG93c2V0X0FsZXJ0Ll9fc3VwZXJfXy5jb25zdHJ1Y3Rvci5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICBzID0gV2luZG93X0Jhc2Uuc2NhbGU7CiAgICAgIHRoaXMud2lkdGggPSAyMjQ7CiAgICAgIHRleHRTaXplID0gRm9udHMuVEVYVC5tZWFzdXJlVGV4dChkZXNjcmlwdGlvbik7CiAgICAgIHRoaXMuZGVzY3JpcHRpb25XaW5kb3cgPSBuZXcgV2luZG93X1RleHQoKEdyYXBoaWNzLndpZHRoIC0gdGhpcy53aWR0aCkgLyAyLCAoR3JhcGhpY3MuaGVpZ2h0IC0gKHRleHRTaXplLmhlaWdodCArIDI4ICogcykpIC8gMiwgdGhpcy53aWR0aCwgdGV4dFNpemUuaGVpZ2h0ICsgMjggKiBzLCB2aWV3cG9ydCk7CiAgICAgIHRoaXMuZGVzY3JpcHRpb25XaW5kb3cudGV4dCA9IGRlc2NyaXB0aW9uOwogICAgICB0aGlzLm9wdGlvbldpbmRvdyA9IG5ldyBXaW5kb3dfU2VsZWN0aW9uKHRoaXMuZGVzY3JpcHRpb25XaW5kb3cueCwgdGhpcy5kZXNjcmlwdGlvbldpbmRvdy55ICsgdGhpcy5kZXNjcmlwdGlvbldpbmRvdy5oZWlnaHQsIG9wdGlvbnMubGVuZ3RoLCBbb3B0aW9uc10sIDIwMCAvIG9wdGlvbnMubGVuZ3RoLCAyMCAqIHMsIHZpZXdwb3J0KTsKICAgICAgdGhpcy5vcHRpb25XaW5kb3cuY29udGVudHMuZm9udCA9IEZvbnRzLlRFWFQ7CiAgICAgIHRoaXMub3B0aW9uV2luZG93Lm9uU2VsZWN0aW9uQWNjZXB0ID0gZnVuY3Rpb24oc2VuZGVyKSB7CiAgICAgICAgX3RoaXMuY2xvc2UoKTsKICAgICAgICBpZiAoX3RoaXMub25BY2NlcHQgIT0gbnVsbCkgewogICAgICAgICAgcmV0dXJuIF90aGlzLm9uQWNjZXB0KHNlbmRlciwgX3RoaXMub3B0aW9uV2luZG93LnNlbGVjdGVkQ29sdW1uKTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIHRoaXMub3B0aW9uV2luZG93Lm9uQ2FuY2VsID0gZnVuY3Rpb24oKSB7CiAgICAgICAgX3RoaXMuY2xvc2UoKTsKICAgICAgICBpZiAoX3RoaXMub25DYW5jZWwgIT0gbnVsbCkgewogICAgICAgICAgcmV0dXJuIF90aGlzLm9uQ2FuY2VsKCk7CiAgICAgICAgfQogICAgICB9OwogICAgICB0aGlzLmRlc2NyaXB0aW9uV2luZG93LndpZHRoID0gdGhpcy5vcHRpb25XaW5kb3cud2lkdGg7CiAgICAgIHRoaXMud2luZG93cy5wdXNoKHRoaXMuZGVzY3JpcHRpb25XaW5kb3cpOwogICAgICB0aGlzLndpbmRvd3MucHVzaCh0aGlzLm9wdGlvbldpbmRvdyk7CiAgICAgIHRoaXMucmVkcmF3QWxsV2luZG93cygpOwogICAgfQoKICAgIHJldHVybiBXaW5kb3dzZXRfQWxlcnQ7CgogIH0pKFdpbmRvd3NldF9CYXNlKTsKCiAgd2luZG93LldpbmRvd3NldF9BbGVydCA9IFdpbmRvd3NldF9BbGVydDsKCn0pLmNhbGwodGhpcyk7Cg=="},{"name":"Windowset_Items","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogV2luZG93c2V0X0l0ZW1zCiMgICBDcmVhdGVkIG9uOiAyMDEzLTA5LTIyCiMKIyAgIENvcHlyaWdodCAoQykgMjAxMyBBbmRy6SBSYWRvbXNraS4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KIwojICAgIENsYXNzOiBXaW5kb3dzZXRfSXRlbXMKIwojICAgQSB3aW5kb3cgd2hpY2ggZGlzcGxheXMgdGhlIHdpbmRvd3MgbmVlZGVkIGZvciBpdGVtIHNlbGVjdGlvbgojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKY2xhc3MgV2luZG93c2V0X0l0ZW1zIGV4dGVuZHMgV2luZG93c2V0X0Jhc2UKICAgIGNvbnN0cnVjdG9yOiAoeCwgeSwgdmlld3BvcnQsIHdpZHRoKSAtPgogICAgICAgIHN1cGVyCiAgICAgICAgd2lkdGggPSB3aWR0aCB8fCAoNDY2ICogV2luZG93X0Jhc2Uuc2NhbGUpCiAgICAgICAgdm9jYWIgPSBSZWNvcmRNYW5hZ2VyLnZvY2FidWxhcnkKICAgICAgICBAdHlwZVdpbmRvdyA9IG5ldyBXaW5kb3dfU2VsZWN0aW9uKHgsIHksIDMsIFtbbGNzKHZvY2FiLm1lbnUuaXRlbXMpLCBsY3Modm9jYWIubWVudS53ZWFwb25zKSwgbGNzKHZvY2FiLm1lbnUuYXJtb3JzKV1dLCBNYXRoLmZsb29yKHdpZHRoIC8gMykgLSA4ICogV2luZG93X0Jhc2Uuc2NhbGUsIDIwICogV2luZG93X0Jhc2Uuc2NhbGUsIHZpZXdwb3J0KQogICAgICAgIEB0eXBlV2luZG93LmNvbnRlbnRzLmZvbnQgPSBAdHlwZVdpbmRvdy5uYW1lRm9udAogICAgICAgIEB0eXBlV2luZG93LmFjdGl2ZSA9IG5vCiAgICAgICAgQHR5cGVXaW5kb3cuY3Vyc29yVmlzaWJsZSA9IG5vCiAgICAgICAgQHR5cGVXaW5kb3cud2lkdGggPSB3aWR0aAogICAgICAgIEB0eXBlV2luZG93Lm9uU2VsZWN0aW9uQ2hhbmdlID0gPT4gQG9uVHlwZUNoYW5nZSgpCiAgICAgICAgQHR5cGVXaW5kb3cub25TZWxlY3Rpb25BY2NlcHQgPSA9PiBAb25UeXBlQWNjZXB0KCkKICAgICAgICBAdHlwZVdpbmRvdy5vbkNhbmNlbCA9ID0+IEBvblR5cGVDYW5jZWwoKQogICAgICAgIEBpdGVtV2luZG93ID0gbmV3IFdpbmRvd19JdGVtcyh4LCB5K0B0eXBlV2luZG93LmhlaWdodCwgMiwgW10sICh3aWR0aCAvIDIpIC0gMTIgKiBXaW5kb3dfQmFzZS5zY2FsZSwgMjYqV2luZG93X0Jhc2Uuc2NhbGUsIHZpZXdwb3J0KQogICAgICAgIEBpdGVtV2luZG93Lm9uU2VsZWN0aW9uQ2hhbmdlID0gPT4gQG9uSXRlbUNoYW5nZSgpCiAgICAgICAgQGl0ZW1XaW5kb3cuY29udGVudHMuZm9udCA9IEBpdGVtV2luZG93Lm5hbWVGb250CiAgICAgICAgQGl0ZW1XaW5kb3cuaGVpZ2h0ID0gMjY0ICogV2luZG93X0Jhc2Uuc2NhbGUKICAgICAgICBAaXRlbVdpbmRvdy5hY3RpdmUgPSBubwogICAgICAgIEBpdGVtV2luZG93LmN1cnNvclZpc2libGUgPSBubwogICAgICAgIEBpdGVtV2luZG93Lm9uU2VsZWN0aW9uQWNjZXB0ID0gPT4gQG9uSXRlbUFjY2VwdCgpCiAgICAgICAgQGl0ZW1XaW5kb3cub25DYW5jZWwgPSA9PiBAb25JdGVtQ2FuY2VsKCkKICAgICAgICBAZGVzY3JpcHRpb25XaW5kb3cgPSBuZXcgV2luZG93X1RleHQoeCwgQGl0ZW1XaW5kb3cueStAaXRlbVdpbmRvdy5oZWlnaHQsIEB0eXBlV2luZG93LndpZHRoLCA1OCAqIFdpbmRvd19CYXNlLnNjYWxlLCB2aWV3cG9ydCkKICAgICAgICBAYWN0aXZlID0gbm8KICAgICAgICAKICAgICAgICBAd2luZG93cy5wdXNoKEB0eXBlV2luZG93KQogICAgICAgIEB3aW5kb3dzLnB1c2goQGl0ZW1XaW5kb3cpCiAgICAgICAgQHdpbmRvd3MucHVzaChAZGVzY3JpcHRpb25XaW5kb3cpCiAgICAgICAgCiAgICAgICAgQHdpZHRoID0gQGl0ZW1XaW5kb3cud2lkdGgKICAgIHVwZGF0ZTogLT4KICAgICAgICBzdXBlcgogICAgICAgIEBpdGVtV2luZG93Lm1lbWJlciA9IEBtZW1iZXIKICAgICAgICBpZiBub3QgQGFjdGl2ZQogICAgICAgICAgICBAdHlwZVdpbmRvdy5hY3RpdmUgPSBubwogICAgICAgICAgICBAaXRlbVdpbmRvdy5hY3RpdmUgPSBubwogICAgICAgICAgICByZXR1cm4KICAgICAgICAKICAgICAgICBpZiBub3QgQHR5cGVXaW5kb3cuYWN0aXZlIGFuZCBub3QgQGl0ZW1XaW5kb3cuYWN0aXZlCiAgICAgICAgICAgIEB0eXBlV2luZG93LmFjdGl2ZSA9IHllcwogICAgICAgICAgICBAaXRlbVdpbmRvdy5hY3RpdmUgPSBubwogICAgICAgICAgICBAaXRlbVdpbmRvdy5jdXJzb3JWaXNpYmxlID0gbm8KICAgICAgICAgICAgCiAgICAgICAgQHR5cGVXaW5kb3cuY3Vyc29yVmlzaWJsZSA9IEBhY3RpdmUKICAgICAgICBAdHlwZVdpbmRvdy5hY3RpdmUgPSAhQGl0ZW1XaW5kb3cuYWN0aXZlCiAgICAgICAgCiAgICByZWRyYXc6IC0+CiAgICAgICAgQHR5cGVXaW5kb3cucmVkcmF3KCkKICAgICAgICBAaXRlbVdpbmRvdy5yZWRyYXcoKQogICAgICAgIAogICAgcmVidWlsZDogLT4KICAgICAgICBAaXRlbVdpbmRvdy5yZWJ1aWxkUm93cygpCiAgICAgICAgQHJlZHJhdygpCiAgICAgICAgCiAgICBjbGVhckRlc2NyaXB0aW9uOiAtPgogICAgICAgIEBkZXNjcmlwdGlvbldpbmRvdy50ZXh0ID0gIiIKICAgICAgICBAZGVzY3JpcHRpb25XaW5kb3cucmVkcmF3KCkKICAgICAgICAKICAgICAKICAgIG9uVHlwZUFjY2VwdDogLT4KICAgICAgICBAdHlwZVdpbmRvdy5hY3RpdmUgPSBubwogICAgICAgIEBpdGVtV2luZG93LmFjdGl2ZSA9IHllcwogICAgICAgIEBpdGVtV2luZG93LmN1cnNvclZpc2libGUgPSB5ZXMgCiAgICAgICAgCiAgICBvblR5cGVDYW5jZWw6IC0+CiAgICAgICAgQHR5cGVXaW5kb3cuYWN0aXZlID0gbm8KICAgICAgICBAdHlwZVdpbmRvdy5jdXJzb3JWaXNpYmxlID0gbm8KICAgICAgICBAYWN0aXZlID0gbm8KICAgICAgICAKICAgICAgICBpZiBAb25DYW5jZWw/IAogICAgICAgICAgICBAb25DYW5jZWwoKQogICAgb25UeXBlQ2hhbmdlOiAtPgogICAgICAgICMjIwogICAgICAgIGl0ZW1zID0gbnVsbAogICAgICAgIHJvd3MgPSBbXQogICAgICAgIHJvdyA9IDAKICAgICAgICBjb2x1bW4gPSAwCiAgICAgICAgc3dpdGNoIEB0eXBlV2luZG93LnNlbGVjdGVkQ29sdW1uCiAgICAgICAgICAgIHdoZW4gMAogICAgICAgICAgICAgICAgaXRlbXMgPSBHYW1lTWFuYWdlci5pbnZlbnRvcnkuaXRlbXMKICAgICAgICAgICAgd2hlbiAxCiAgICAgICAgICAgICAgICBpdGVtcyA9IEdhbWVNYW5hZ2VyLmludmVudG9yeS53ZWFwb25zCiAgICAgICAgICAgIHdoZW4gMgogICAgICAgICAgICAgICAgaXRlbXMgPSBHYW1lTWFuYWdlci5pbnZlbnRvcnkuYXJtb3JzCiAgICAgICAgICAgIHdoZW4gMwogICAgICAgICAgICAgICAgaXRlbXMgPSBHYW1lTWFuYWdlci5pbnZlbnRvcnkua2V5SXRlbXMKICAgICAgICAgICAgICAgIAogICAgICAgIGZvciBpIGluIFswLi4uaXRlbXMubGVuZ3RoXQogICAgICAgICAgICByb3cgPSBNYXRoLmZsb29yKGkgLyAyKQogICAgICAgICAgICBjb2x1bW4gPSBpICUgMgogICAgICAgICAgICBpZiBub3Qgcm93c1tyb3ddPyB0aGVuIHJvd3Nbcm93XSA9IFtdCiAgICAgICAgICAgIHJvd3Nbcm93XVtjb2x1bW5dID0gaXRlbXNbaV0KICAgICAgICAgICAgIyMjCiAgICAgICAgI0BpdGVtV2luZG93LnJvd3MgPSByb3dzCiAgICAgICAgI0BpdGVtV2luZG93LnJlZHJhdygpCiAgICAgICAgQGl0ZW1XaW5kb3cudHlwZSA9IEB0eXBlV2luZG93LnNlbGVjdGVkQ29sdW1uCiAgICAgICAgQHJlYnVpbGQoKQogICAgICAgIAogICAgCiAgICBvbkl0ZW1BY2NlcHQ6IC0+CiAgICAgICAgaWYgQG9uSXRlbVNlbGVjdGlvbj8KICAgICAgICAgICAgQHNlbGVjdGVkSXRlbSA9IEBpdGVtV2luZG93LnNlbGVjdGVkQ2VsbAogICAgICAgICAgICBAb25JdGVtU2VsZWN0aW9uKEBpdGVtV2luZG93LnNlbGVjdGVkQ2VsbCkKICAgICAgICAgICAgCiAgICBvbkl0ZW1DYW5jZWw6IC0+CiAgICAgICAgQHR5cGVXaW5kb3cuYWN0aXZlID0geWVzCiAgICAgICAgQGl0ZW1XaW5kb3cuYWN0aXZlID0gbm8KICAgICAgICBAaXRlbVdpbmRvdy5jdXJzb3JWaXNpYmxlID0gbm8KICAgICAgICBAY2xlYXJEZXNjcmlwdGlvbigpCiAgICAgICAgICAgIAogICAgb25JdGVtQ2hhbmdlOiAtPgogICAgICAgIGNlbGwgPSBAaXRlbVdpbmRvdy5zZWxlY3RlZENlbGwKCiAgICAgICAgaWYgY2VsbD8gYW5kIGNlbGwuaXRlbT8KICAgICAgICAgICAgQGRlc2NyaXB0aW9uV2luZG93LnRleHQgPSBjZWxsLml0ZW0uZGVzY3JpcHRpb24gfHwgIiIKICAgICAgICAgICAgQGRlc2NyaXB0aW9uV2luZG93LnJlZHJhdygpCiAgICAgICAgZWxzZQogICAgICAgICAgICBAY2xlYXJEZXNjcmlwdGlvbigpCiAgICAgICAgCndpbmRvdy5XaW5kb3dzZXRfSXRlbXMgPSBXaW5kb3dzZXRfSXRlbXM=","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBXaW5kb3dzZXRfSXRlbXMsCiAgICBfX2hhc1Byb3AgPSB7fS5oYXNPd25Qcm9wZXJ0eSwKICAgIF9fZXh0ZW5kcyA9IGZ1bmN0aW9uKGNoaWxkLCBwYXJlbnQpIHsgZm9yICh2YXIga2V5IGluIHBhcmVudCkgeyBpZiAoX19oYXNQcm9wLmNhbGwocGFyZW50LCBrZXkpKSBjaGlsZFtrZXldID0gcGFyZW50W2tleV07IH0gZnVuY3Rpb24gY3RvcigpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGNoaWxkOyB9IGN0b3IucHJvdG90eXBlID0gcGFyZW50LnByb3RvdHlwZTsgY2hpbGQucHJvdG90eXBlID0gbmV3IGN0b3IoKTsgY2hpbGQuX19zdXBlcl9fID0gcGFyZW50LnByb3RvdHlwZTsgcmV0dXJuIGNoaWxkOyB9OwoKICBXaW5kb3dzZXRfSXRlbXMgPSAoZnVuY3Rpb24oX3N1cGVyKSB7CiAgICBfX2V4dGVuZHMoV2luZG93c2V0X0l0ZW1zLCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFdpbmRvd3NldF9JdGVtcyh4LCB5LCB2aWV3cG9ydCwgd2lkdGgpIHsKICAgICAgdmFyIHZvY2FiLAogICAgICAgIF90aGlzID0gdGhpczsKICAgICAgV2luZG93c2V0X0l0ZW1zLl9fc3VwZXJfXy5jb25zdHJ1Y3Rvci5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB3aWR0aCA9IHdpZHRoIHx8ICg0NjYgKiBXaW5kb3dfQmFzZS5zY2FsZSk7CiAgICAgIHZvY2FiID0gUmVjb3JkTWFuYWdlci52b2NhYnVsYXJ5OwogICAgICB0aGlzLnR5cGVXaW5kb3cgPSBuZXcgV2luZG93X1NlbGVjdGlvbih4LCB5LCAzLCBbW2xjcyh2b2NhYi5tZW51Lml0ZW1zKSwgbGNzKHZvY2FiLm1lbnUud2VhcG9ucyksIGxjcyh2b2NhYi5tZW51LmFybW9ycyldXSwgTWF0aC5mbG9vcih3aWR0aCAvIDMpIC0gOCAqIFdpbmRvd19CYXNlLnNjYWxlLCAyMCAqIFdpbmRvd19CYXNlLnNjYWxlLCB2aWV3cG9ydCk7CiAgICAgIHRoaXMudHlwZVdpbmRvdy5jb250ZW50cy5mb250ID0gdGhpcy50eXBlV2luZG93Lm5hbWVGb250OwogICAgICB0aGlzLnR5cGVXaW5kb3cuYWN0aXZlID0gZmFsc2U7CiAgICAgIHRoaXMudHlwZVdpbmRvdy5jdXJzb3JWaXNpYmxlID0gZmFsc2U7CiAgICAgIHRoaXMudHlwZVdpbmRvdy53aWR0aCA9IHdpZHRoOwogICAgICB0aGlzLnR5cGVXaW5kb3cub25TZWxlY3Rpb25DaGFuZ2UgPSBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gX3RoaXMub25UeXBlQ2hhbmdlKCk7CiAgICAgIH07CiAgICAgIHRoaXMudHlwZVdpbmRvdy5vblNlbGVjdGlvbkFjY2VwdCA9IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBfdGhpcy5vblR5cGVBY2NlcHQoKTsKICAgICAgfTsKICAgICAgdGhpcy50eXBlV2luZG93Lm9uQ2FuY2VsID0gZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIF90aGlzLm9uVHlwZUNhbmNlbCgpOwogICAgICB9OwogICAgICB0aGlzLml0ZW1XaW5kb3cgPSBuZXcgV2luZG93X0l0ZW1zKHgsIHkgKyB0aGlzLnR5cGVXaW5kb3cuaGVpZ2h0LCAyLCBbXSwgKHdpZHRoIC8gMikgLSAxMiAqIFdpbmRvd19CYXNlLnNjYWxlLCAyNiAqIFdpbmRvd19CYXNlLnNjYWxlLCB2aWV3cG9ydCk7CiAgICAgIHRoaXMuaXRlbVdpbmRvdy5vblNlbGVjdGlvbkNoYW5nZSA9IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBfdGhpcy5vbkl0ZW1DaGFuZ2UoKTsKICAgICAgfTsKICAgICAgdGhpcy5pdGVtV2luZG93LmNvbnRlbnRzLmZvbnQgPSB0aGlzLml0ZW1XaW5kb3cubmFtZUZvbnQ7CiAgICAgIHRoaXMuaXRlbVdpbmRvdy5oZWlnaHQgPSAyNjQgKiBXaW5kb3dfQmFzZS5zY2FsZTsKICAgICAgdGhpcy5pdGVtV2luZG93LmFjdGl2ZSA9IGZhbHNlOwogICAgICB0aGlzLml0ZW1XaW5kb3cuY3Vyc29yVmlzaWJsZSA9IGZhbHNlOwogICAgICB0aGlzLml0ZW1XaW5kb3cub25TZWxlY3Rpb25BY2NlcHQgPSBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gX3RoaXMub25JdGVtQWNjZXB0KCk7CiAgICAgIH07CiAgICAgIHRoaXMuaXRlbVdpbmRvdy5vbkNhbmNlbCA9IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBfdGhpcy5vbkl0ZW1DYW5jZWwoKTsKICAgICAgfTsKICAgICAgdGhpcy5kZXNjcmlwdGlvbldpbmRvdyA9IG5ldyBXaW5kb3dfVGV4dCh4LCB0aGlzLml0ZW1XaW5kb3cueSArIHRoaXMuaXRlbVdpbmRvdy5oZWlnaHQsIHRoaXMudHlwZVdpbmRvdy53aWR0aCwgNTggKiBXaW5kb3dfQmFzZS5zY2FsZSwgdmlld3BvcnQpOwogICAgICB0aGlzLmFjdGl2ZSA9IGZhbHNlOwogICAgICB0aGlzLndpbmRvd3MucHVzaCh0aGlzLnR5cGVXaW5kb3cpOwogICAgICB0aGlzLndpbmRvd3MucHVzaCh0aGlzLml0ZW1XaW5kb3cpOwogICAgICB0aGlzLndpbmRvd3MucHVzaCh0aGlzLmRlc2NyaXB0aW9uV2luZG93KTsKICAgICAgdGhpcy53aWR0aCA9IHRoaXMuaXRlbVdpbmRvdy53aWR0aDsKICAgIH0KCiAgICBXaW5kb3dzZXRfSXRlbXMucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkgewogICAgICBXaW5kb3dzZXRfSXRlbXMuX19zdXBlcl9fLnVwZGF0ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB0aGlzLml0ZW1XaW5kb3cubWVtYmVyID0gdGhpcy5tZW1iZXI7CiAgICAgIGlmICghdGhpcy5hY3RpdmUpIHsKICAgICAgICB0aGlzLnR5cGVXaW5kb3cuYWN0aXZlID0gZmFsc2U7CiAgICAgICAgdGhpcy5pdGVtV2luZG93LmFjdGl2ZSA9IGZhbHNlOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBpZiAoIXRoaXMudHlwZVdpbmRvdy5hY3RpdmUgJiYgIXRoaXMuaXRlbVdpbmRvdy5hY3RpdmUpIHsKICAgICAgICB0aGlzLnR5cGVXaW5kb3cuYWN0aXZlID0gdHJ1ZTsKICAgICAgICB0aGlzLml0ZW1XaW5kb3cuYWN0aXZlID0gZmFsc2U7CiAgICAgICAgdGhpcy5pdGVtV2luZG93LmN1cnNvclZpc2libGUgPSBmYWxzZTsKICAgICAgfQogICAgICB0aGlzLnR5cGVXaW5kb3cuY3Vyc29yVmlzaWJsZSA9IHRoaXMuYWN0aXZlOwogICAgICByZXR1cm4gdGhpcy50eXBlV2luZG93LmFjdGl2ZSA9ICF0aGlzLml0ZW1XaW5kb3cuYWN0aXZlOwogICAgfTsKCiAgICBXaW5kb3dzZXRfSXRlbXMucHJvdG90eXBlLnJlZHJhdyA9IGZ1bmN0aW9uKCkgewogICAgICB0aGlzLnR5cGVXaW5kb3cucmVkcmF3KCk7CiAgICAgIHJldHVybiB0aGlzLml0ZW1XaW5kb3cucmVkcmF3KCk7CiAgICB9OwoKICAgIFdpbmRvd3NldF9JdGVtcy5wcm90b3R5cGUucmVidWlsZCA9IGZ1bmN0aW9uKCkgewogICAgICB0aGlzLml0ZW1XaW5kb3cucmVidWlsZFJvd3MoKTsKICAgICAgcmV0dXJuIHRoaXMucmVkcmF3KCk7CiAgICB9OwoKICAgIFdpbmRvd3NldF9JdGVtcy5wcm90b3R5cGUuY2xlYXJEZXNjcmlwdGlvbiA9IGZ1bmN0aW9uKCkgewogICAgICB0aGlzLmRlc2NyaXB0aW9uV2luZG93LnRleHQgPSAiIjsKICAgICAgcmV0dXJuIHRoaXMuZGVzY3JpcHRpb25XaW5kb3cucmVkcmF3KCk7CiAgICB9OwoKICAgIFdpbmRvd3NldF9JdGVtcy5wcm90b3R5cGUub25UeXBlQWNjZXB0ID0gZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMudHlwZVdpbmRvdy5hY3RpdmUgPSBmYWxzZTsKICAgICAgdGhpcy5pdGVtV2luZG93LmFjdGl2ZSA9IHRydWU7CiAgICAgIHJldHVybiB0aGlzLml0ZW1XaW5kb3cuY3Vyc29yVmlzaWJsZSA9IHRydWU7CiAgICB9OwoKICAgIFdpbmRvd3NldF9JdGVtcy5wcm90b3R5cGUub25UeXBlQ2FuY2VsID0gZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMudHlwZVdpbmRvdy5hY3RpdmUgPSBmYWxzZTsKICAgICAgdGhpcy50eXBlV2luZG93LmN1cnNvclZpc2libGUgPSBmYWxzZTsKICAgICAgdGhpcy5hY3RpdmUgPSBmYWxzZTsKICAgICAgaWYgKHRoaXMub25DYW5jZWwgIT0gbnVsbCkgewogICAgICAgIHJldHVybiB0aGlzLm9uQ2FuY2VsKCk7CiAgICAgIH0KICAgIH07CgogICAgV2luZG93c2V0X0l0ZW1zLnByb3RvdHlwZS5vblR5cGVDaGFuZ2UgPSBmdW5jdGlvbigpIHsKICAgICAgLyoKICAgICAgaXRlbXMgPSBudWxsCiAgICAgIHJvd3MgPSBbXQogICAgICByb3cgPSAwCiAgICAgIGNvbHVtbiA9IDAKICAgICAgc3dpdGNoIEB0eXBlV2luZG93LnNlbGVjdGVkQ29sdW1uCiAgICAgICAgICB3aGVuIDAKICAgICAgICAgICAgICBpdGVtcyA9IEdhbWVNYW5hZ2VyLmludmVudG9yeS5pdGVtcwogICAgICAgICAgd2hlbiAxCiAgICAgICAgICAgICAgaXRlbXMgPSBHYW1lTWFuYWdlci5pbnZlbnRvcnkud2VhcG9ucwogICAgICAgICAgd2hlbiAyCiAgICAgICAgICAgICAgaXRlbXMgPSBHYW1lTWFuYWdlci5pbnZlbnRvcnkuYXJtb3JzCiAgICAgICAgICB3aGVuIDMKICAgICAgICAgICAgICBpdGVtcyA9IEdhbWVNYW5hZ2VyLmludmVudG9yeS5rZXlJdGVtcwogICAgICAgICAgICAgIAogICAgICBmb3IgaSBpbiBbMC4uLml0ZW1zLmxlbmd0aF0KICAgICAgICAgIHJvdyA9IE1hdGguZmxvb3IoaSAvIDIpCiAgICAgICAgICBjb2x1bW4gPSBpICUgMgogICAgICAgICAgaWYgbm90IHJvd3Nbcm93XT8gdGhlbiByb3dzW3Jvd10gPSBbXQogICAgICAgICAgcm93c1tyb3ddW2NvbHVtbl0gPSBpdGVtc1tpXQogICAgICAqLwoKICAgICAgdGhpcy5pdGVtV2luZG93LnR5cGUgPSB0aGlzLnR5cGVXaW5kb3cuc2VsZWN0ZWRDb2x1bW47CiAgICAgIHJldHVybiB0aGlzLnJlYnVpbGQoKTsKICAgIH07CgogICAgV2luZG93c2V0X0l0ZW1zLnByb3RvdHlwZS5vbkl0ZW1BY2NlcHQgPSBmdW5jdGlvbigpIHsKICAgICAgaWYgKHRoaXMub25JdGVtU2VsZWN0aW9uICE9IG51bGwpIHsKICAgICAgICB0aGlzLnNlbGVjdGVkSXRlbSA9IHRoaXMuaXRlbVdpbmRvdy5zZWxlY3RlZENlbGw7CiAgICAgICAgcmV0dXJuIHRoaXMub25JdGVtU2VsZWN0aW9uKHRoaXMuaXRlbVdpbmRvdy5zZWxlY3RlZENlbGwpOwogICAgICB9CiAgICB9OwoKICAgIFdpbmRvd3NldF9JdGVtcy5wcm90b3R5cGUub25JdGVtQ2FuY2VsID0gZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMudHlwZVdpbmRvdy5hY3RpdmUgPSB0cnVlOwogICAgICB0aGlzLml0ZW1XaW5kb3cuYWN0aXZlID0gZmFsc2U7CiAgICAgIHRoaXMuaXRlbVdpbmRvdy5jdXJzb3JWaXNpYmxlID0gZmFsc2U7CiAgICAgIHJldHVybiB0aGlzLmNsZWFyRGVzY3JpcHRpb24oKTsKICAgIH07CgogICAgV2luZG93c2V0X0l0ZW1zLnByb3RvdHlwZS5vbkl0ZW1DaGFuZ2UgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGNlbGw7CiAgICAgIGNlbGwgPSB0aGlzLml0ZW1XaW5kb3cuc2VsZWN0ZWRDZWxsOwogICAgICBpZiAoKGNlbGwgIT0gbnVsbCkgJiYgKGNlbGwuaXRlbSAhPSBudWxsKSkgewogICAgICAgIHRoaXMuZGVzY3JpcHRpb25XaW5kb3cudGV4dCA9IGNlbGwuaXRlbS5kZXNjcmlwdGlvbiB8fCAiIjsKICAgICAgICByZXR1cm4gdGhpcy5kZXNjcmlwdGlvbldpbmRvdy5yZWRyYXcoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gdGhpcy5jbGVhckRlc2NyaXB0aW9uKCk7CiAgICAgIH0KICAgIH07CgogICAgcmV0dXJuIFdpbmRvd3NldF9JdGVtczsKCiAgfSkoV2luZG93c2V0X0Jhc2UpOwoKICB3aW5kb3cuV2luZG93c2V0X0l0ZW1zID0gV2luZG93c2V0X0l0ZW1zOwoKfSkuY2FsbCh0aGlzKTsK"},{"name":"Windowset_BuyItems","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogV2luZG93c2V0X0J1eUl0ZW1zCiMgICBDcmVhdGVkIG9uOiAyMDEzLTEwLTI3CiMKIyAgIENvcHlyaWdodCAoQykgMjAxMyBBbmRy6SBSYWRvbXNraS4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KIwojICAgIENsYXNzOiBXaW5kb3dzZXRfQnV5SXRlbXMKIwojICAgQSB3aW5kb3cgd2hpY2ggZGlzcGxheXMgdGhlIHdpbmRvd3MgbmVlZGVkIGZvciBpdGVtIHNlbGVjdGlvbgojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKY2xhc3MgV2luZG93c2V0X0J1eUl0ZW1zIGV4dGVuZHMgV2luZG93c2V0X0Jhc2UKICAgIEBNT0RFX0JVWSA9IDAKICAgIEBNT0RFX1NFTEwgPSAxCiAgICAKICAgIGNvbnN0cnVjdG9yOiAoeCwgeSwgdmlld3BvcnQpIC0+CiAgICAgICAgc3VwZXIKICAgICAgICB2b2NhYiA9IFJlY29yZE1hbmFnZXIudm9jYWJ1bGFyeQogICAgICAgIEBpdGVtcyA9IFtdCiAgICAgICAgQHdlYXBvbnMgPSBbXQogICAgICAgIEBhcm1vcnMgPSBbXQogICAgICAgIEBtb2RlID0gV2luZG93c2V0X0J1eUl0ZW1zLk1PREVfQlVZCgogICAgICAgIEB0eXBlV2luZG93ID0gbmV3IFdpbmRvd19TZWxlY3Rpb24oeCwgeSwgMywgW1tsY3Modm9jYWIubWVudS5pdGVtcyksIGxjcyh2b2NhYi5tZW51LndlYXBvbnMpLCBsY3Modm9jYWIubWVudS5hcm1vcnMpXV0sIDE0NiAqIFdpbmRvd19CYXNlLnNjYWxlLCAyMCAqIFdpbmRvd19CYXNlLnNjYWxlLCB2aWV3cG9ydCkKICAgICAgICBAdHlwZVdpbmRvdy5jb250ZW50cy5mb250ID0gQHR5cGVXaW5kb3cubmFtZUZvbnQKICAgICAgICBAdHlwZVdpbmRvdy5hY3RpdmUgPSBubwogICAgICAgIEB0eXBlV2luZG93LmN1cnNvclZpc2libGUgPSBubwogICAgICAgIEB0eXBlV2luZG93Lm9uU2VsZWN0aW9uQ2hhbmdlID0gPT4gQG9uVHlwZUNoYW5nZSgpCiAgICAgICAgQHR5cGVXaW5kb3cub25TZWxlY3Rpb25BY2NlcHQgPSA9PiBAb25UeXBlQWNjZXB0KCkKICAgICAgICBAdHlwZVdpbmRvdy53aWR0aCArPSA0ICogV2luZG93X0Jhc2Uuc2NhbGUKICAgICAgICBAcGFyYW1ldGVyV2luZG93ID0gbmV3IFdpbmRvd19QYXJhbWV0ZXIoeCwgeSArIEB0eXBlV2luZG93LmhlaWdodCwgMTYwICogV2luZG93X0Jhc2Uuc2NhbGUsIDE4MCAqIFdpbmRvd19CYXNlLnNjYWxlKQogICAgICAgIEBwYXJhbWV0ZXJXaW5kb3cudmlzaWJsZSA9IG5vCiAgICAgICAgCiAgICAgICAgQGl0ZW1XaW5kb3cgPSBuZXcgV2luZG93X0J1eUl0ZW1zKHgsIHkrQHR5cGVXaW5kb3cuaGVpZ2h0LCAxLCBbXSwgNDQyICogV2luZG93X0Jhc2Uuc2NhbGUsIDI2ICogV2luZG93X0Jhc2Uuc2NhbGUsIHZpZXdwb3J0KQogICAgICAgIEBpdGVtV2luZG93Lm9uU2VsZWN0aW9uQ2hhbmdlID0gPT4gQG9uSXRlbUNoYW5nZSgpCiAgICAgICAgQGl0ZW1XaW5kb3cub25TZWxlY3Rpb25BY2NlcHQgPSAoc2VuZGVyLCBjZWxsKSA9PiBAb25JdGVtQWNjZXB0KHNlbmRlciwgY2VsbCkKICAgICAgICBAaXRlbVdpbmRvdy5jb250ZW50cy5mb250ID0gQGl0ZW1XaW5kb3cubmFtZUZvbnQKICAgICAgICBAaXRlbVdpbmRvdy5oZWlnaHQgPSAyNjQgKiBXaW5kb3dfQmFzZS5zY2FsZQogICAgICAgIEBpdGVtV2luZG93LmFjdGl2ZSA9IG5vCiAgICAgICAgQGl0ZW1XaW5kb3cuY3Vyc29yVmlzaWJsZSA9IG5vCiAgICAgICAgCiAgICAgICAgQHNtYWxsSXRlbVdpbmRvdyA9IG5ldyBXaW5kb3dfQnV5SXRlbXMoeCArIEBwYXJhbWV0ZXJXaW5kb3cud2lkdGgsIHkrQHR5cGVXaW5kb3cuaGVpZ2h0LCAxLCBbXSwgMjgyICogV2luZG93X0Jhc2Uuc2NhbGUsIDIwICogV2luZG93X0Jhc2Uuc2NhbGUsIHZpZXdwb3J0KQogICAgICAgIEBzbWFsbEl0ZW1XaW5kb3cub25TZWxlY3Rpb25DaGFuZ2UgPSA9PiBAb25JdGVtQ2hhbmdlKCkKICAgICAgICBAc21hbGxJdGVtV2luZG93LmNvbnRlbnRzLmZvbnQgPSBAc21hbGxJdGVtV2luZG93Lm5hbWVGb250CiAgICAgICAgQHNtYWxsSXRlbVdpbmRvdy5oZWlnaHQgPSAyNjQgKiBXaW5kb3dfQmFzZS5zY2FsZQogICAgICAgIEBzbWFsbEl0ZW1XaW5kb3cuYWN0aXZlID0gbm8KICAgICAgICBAc21hbGxJdGVtV2luZG93LmN1cnNvclZpc2libGUgPSBubwogICAgICAgIEBzbWFsbEl0ZW1XaW5kb3cudmlzaWJsZSA9IG5vCiAgICAgICAgQHNtYWxsSXRlbVdpbmRvdy5vblNlbGVjdGlvbkNoYW5nZSA9ID0+IEBvbkl0ZW1DaGFuZ2UoKQogICAgICAgIEBzbWFsbEl0ZW1XaW5kb3cub25TZWxlY3Rpb25BY2NlcHQgPSAoc2VuZGVyLCBjZWxsKSA9PiBAb25JdGVtQWNjZXB0KHNlbmRlciwgY2VsbCkKICAgICAgICAKICAgICAgICBAZGVzY3JpcHRpb25XaW5kb3cgPSBuZXcgV2luZG93X1RleHQoeCwgQGl0ZW1XaW5kb3cueStAaXRlbVdpbmRvdy5oZWlnaHQsIEB0eXBlV2luZG93LndpZHRoLCA1OCAqIFdpbmRvd19CYXNlLnNjYWxlLCB2aWV3cG9ydCkKICAgICAgICAKICAgICAgICBAYW1vdW50V2luZG93ID0gbmV3IFdpbmRvd19BbW91bnRTZWxlY3Rpb24oKQogICAgICAgIEBhbW91bnRXaW5kb3cuYWN0aXZlID0gbm8KICAgICAgICBAYW1vdW50V2luZG93LnZpc2libGUgPSBubwogICAgICAgIEBhbW91bnRXaW5kb3cub25BY2NlcHQgPSAoc2VuZGVyKSA9PiBAb25BbW91bnRBY2NlcHQoc2VuZGVyKQogICAgICAgIEBhbW91bnRXaW5kb3cub25DYW5jZWwgPSAoc2VuZGVyKSA9PiBAb25BbW91bnRDYW5jZWwoc2VuZGVyKQogICAgICAgIAogICAgICAgIEBhY3RpdmUgPSBubwogICAgICAgIAogICAgICAgIEB3aW5kb3dzLnB1c2goQHR5cGVXaW5kb3cpCiAgICAgICAgQHdpbmRvd3MucHVzaChAaXRlbVdpbmRvdykKICAgICAgICBAd2luZG93cy5wdXNoKEBzbWFsbEl0ZW1XaW5kb3cpCiAgICAgICAgQHdpbmRvd3MucHVzaChAcGFyYW1ldGVyV2luZG93KQogICAgICAgIEB3aW5kb3dzLnB1c2goQGRlc2NyaXB0aW9uV2luZG93KQogICAgICAgIEB3aW5kb3dzLnB1c2goQGFtb3VudFdpbmRvdykKICAgICAgICAKICAgICAgICBAd2lkdGggPSBAaXRlbVdpbmRvdy53aWR0aAogICAgICAgIEBtZW1iZXIgPSBudWxsCiAgICB1cGRhdGU6IC0+CiAgICAgICAgc3VwZXIKICAKICAgICAgICBpZiBub3QgQGFjdGl2ZSB0aGVuIEB0eXBlV2luZG93LnNlbGVjdGVkQ29sdW1uID0gMAogICAgICAgIAogICAgICAgIAogICAgICAgIEBzbWFsbEl0ZW1XaW5kb3cudmlzaWJsZSA9IEB0eXBlV2luZG93LnNlbGVjdGVkQ29sdW1uICE9IDAgYW5kIEBtb2RlID09IFdpbmRvd3NldF9CdXlJdGVtcy5NT0RFX0JVWSAKICAgICAgICBAcGFyYW1ldGVyV2luZG93LnZpc2libGUgPSBAdHlwZVdpbmRvdy5zZWxlY3RlZENvbHVtbiAhPSAwIGFuZCBAbW9kZSA9PSBXaW5kb3dzZXRfQnV5SXRlbXMuTU9ERV9CVVkKICAgICAgICBAcGFyYW1ldGVyV2luZG93Lm1lbWJlciA9IEBtZW1iZXIKICAgICAgICBAaXRlbVdpbmRvdy52aXNpYmxlID0gQG1vZGUgPCAyIGFuZCBAdHlwZVdpbmRvdy5zZWxlY3RlZENvbHVtbiA9PSAwIG9yIEBtb2RlID09IFdpbmRvd3NldF9CdXlJdGVtcy5NT0RFX1NFTEwgCiAgICAgICAgCiAgICAgICAgaWYgbm90IEBhY3RpdmUgdGhlbiByZXR1cm4KICAgICAgICAKICAgICAgICBpdGVtV2luZG93ID0gQGN1cnJlbnRJdGVtV2luZG93KCkKICAgICAgICAgICAgCiAgICAgICAgQHR5cGVXaW5kb3cuY3Vyc29yVmlzaWJsZSA9IEBhY3RpdmUKICAgICAgICAKICAgICAgICBpZiBJbnB1dC50cmlnZ2VyKElucHV0LkIpCiAgICAgICAgICAgIGlmIEB0eXBlV2luZG93LmFjdGl2ZQogICAgICAgICAgICAgICAgQHR5cGVXaW5kb3cuYWN0aXZlID0gbm8KICAgICAgICAgICAgICAgIEB0eXBlV2luZG93LmN1cnNvclZpc2libGUgPSBubwogICAgICAgICAgICAgICAgQGFjdGl2ZSA9IG5vCiAgICAgICAgICAgICAgICBpZiBAb25DYW5jZWw/IHRoZW4gQG9uQ2FuY2VsKCkKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgQHR5cGVXaW5kb3cuYWN0aXZlID0geWVzCiAgICAgICAgICAgICAgICBpdGVtV2luZG93IC5hY3RpdmUgPSBubwogICAgICAgICAgICAgICAgaXRlbVdpbmRvdyAuY3Vyc29yVmlzaWJsZSA9IG5vCiAgICAgICAgICAgICAgICBAY2xlYXJEZXNjcmlwdGlvbigpCiAgICAgICAgICAgICAgICBAcGFyYW1ldGVyV2luZG93LnJlZHJhdygpCiAgICAgICAgCiAgICByZWRyYXc6IC0+CiAgICAgICAgQGl0ZW1XaW5kb3cubW9kZSA9IEBtb2RlCiAgICAgICAgQG9uVHlwZUNoYW5nZSgpCiAgICAgICAgQHR5cGVXaW5kb3cucmVkcmF3KCkKICAgICAgICBAaXRlbVdpbmRvdy5yZWRyYXcoKQogICAgICAgIEBzbWFsbEl0ZW1XaW5kb3cucmVkcmF3KCkKICAgICAgICAKICAgIHNob3c6IChzaG93LCBhY3RpdmUpIC0+CiAgICAgICAgc3VwZXIoc2hvdywgYWN0aXZlKQogICAgICAgIAogICAgICAgIEBhbW91bnRXaW5kb3cudmlzaWJsZSA9IG5vCiAgICAgICAgQHNtYWxsSXRlbVdpbmRvdy52aXNpYmxlID0gc2hvdyBhbmQgQHR5cGVXaW5kb3cuc2VsZWN0ZWRDb2x1bW4gIT0gMCAKICAgICAgICBAcGFyYW1ldGVyV2luZG93LnZpc2libGUgPSBzaG93IGFuZCBAdHlwZVdpbmRvdy5zZWxlY3RlZENvbHVtbiAhPSAwIAogICAgICAgIEBpdGVtV2luZG93LnZpc2libGUgPSBzaG93IGFuZCBAdHlwZVdpbmRvdy5zZWxlY3RlZENvbHVtbiA9PSAwIAoKICAgIAogICAgYWN0aXZhdGU6IC0+CiAgICAgICAgQGFjdGl2ZSA9IHllcwogICAgICAgIEB0eXBlV2luZG93LmFjdGl2ZSA9IHllcwogICAgICAgIEBpdGVtV2luZG93Lm1vZGUgPSBAbW9kZQogICAgICAgIEBvblR5cGVDaGFuZ2UoKQogICAgCiAgICBjbGVhckRlc2NyaXB0aW9uOiAtPgogICAgICAgIEBkZXNjcmlwdGlvbldpbmRvdy50ZXh0ID0gIiIKICAgICAgICBAZGVzY3JpcHRpb25XaW5kb3cucmVkcmF3KCkKICAgICAgICAKICAgICAgICBAcGFyYW1ldGVyV2luZG93LmN1cnJlbnRJdGVtID0gbnVsbAogICAgICAgIEBwYXJhbWV0ZXJXaW5kb3cucHJldmlldyA9IG5vCiAgICAgICAgQHBhcmFtZXRlcldpbmRvdy5yZWRyYXcoKQogICAgICAgIAogICAgY3VycmVudEl0ZW1XaW5kb3c6IC0+CiAgICAgICAgcmVzdWx0ID0gbnVsbAogICAgICAgIGlmIEB0eXBlV2luZG93LnNlbGVjdGVkQ29sdW1uID09IDAgb3IgQG1vZGUgPT0gV2luZG93c2V0X0J1eUl0ZW1zLk1PREVfU0VMTAogICAgICAgICAgICByZXN1bHQgPSBAaXRlbVdpbmRvdyAKICAgICAgICBlbHNlIAogICAgICAgICAgICByZXN1bHQgPSBAc21hbGxJdGVtV2luZG93CiAgICAgICAgICAgIAogICAgICAgIHJldHVybiByZXN1bHQKICAgICAgICAKICAgIG9uVHlwZUFjY2VwdDogLT4KICAgICAgICBAdHlwZVdpbmRvdy5hY3RpdmUgPSBubwogICAgICAgIEBjdXJyZW50SXRlbVdpbmRvdygpLmFjdGl2ZSA9IHllcwogICAgICAgIEBjdXJyZW50SXRlbVdpbmRvdygpLmN1cnNvclZpc2libGUgPSB5ZXMKICAgICAgICBJbnB1dC5jbGVhcigpCiAgICAgICAgCiAgICBvblR5cGVDaGFuZ2U6IC0+CiAgICAgICAgaXRlbXMgPSBudWxsCiAgICAgICAgcm93cyA9IFtdCiAgICAgICAgcm93ID0gMAogICAgICAgIGNvbHVtbiA9IDAKICAgICAgICBjb2x1bW5Db3VudCA9IGlmIChAdHlwZVdpbmRvdy5zZWxlY3RlZENvbHVtbiA9PSAwIG9yIEBtb2RlID09IFdpbmRvd3NldF9CdXlJdGVtcy5NT0RFX1NFTEwpIHRoZW4gMSBlbHNlIDEKICAgICAgICBpdGVtV2luZG93ID0gQGN1cnJlbnRJdGVtV2luZG93KCkKICAgICAgICBAcGFyYW1ldGVyV2luZG93LnZpc2libGUgPSBAdHlwZVdpbmRvdy5zZWxlY3RlZENvbHVtbiAhPSAwIGFuZCBAbW9kZSA9PSBXaW5kb3dzZXRfQnV5SXRlbXMuTU9ERV9CVVkKICAgICAgICBpZiBAcGFyYW1ldGVyV2luZG93LnZpc2libGUgdGhlbiBAcGFyYW1ldGVyV2luZG93LnJlZHJhdygpCiAgICAgICAgCiAgICAgICAgQGNsZWFyRGVzY3JpcHRpb24oKQogICAgICAgICAgICAKICAgICAgICBjdXJyZW50SXRlbXMgPSBbXQogICAgICAgIHN3aXRjaCBAdHlwZVdpbmRvdy5zZWxlY3RlZENvbHVtbgogICAgICAgICAgICB3aGVuIDAgdGhlbiBpdGVtcyA9IEBpdGVtcwogICAgICAgICAgICB3aGVuIDEgdGhlbiBpdGVtcyA9IEB3ZWFwb25zCiAgICAgICAgICAgIHdoZW4gMiB0aGVuIGl0ZW1zID0gQGFybW9ycwogICAgICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgaWYgQG1vZGUgPT0gMAogICAgICAgICAgICBjdXJyZW50SXRlbXMgPSBpdGVtcwogICAgICAgIGVsc2UKICAgICAgICAgICAgZm9yIGkgaW4gWzAuLi5pdGVtcy5sZW5ndGhdCiAgICAgICAgICAgICAgICBpdGVtID0gR2FtZU1hbmFnZXIuaW52ZW50b3J5Lml0ZW0oQHR5cGVXaW5kb3cuc2VsZWN0ZWRDb2x1bW4sIGl0ZW1zW2ldLml0ZW0uaW5kZXgpCiAgICAgICAgICAgICAgICBpZiBpdGVtPyBhbmQgaXRlbS5jb3VudCA+IDAKICAgICAgICAgICAgICAgICAgICBjdXJyZW50SXRlbXMucHVzaChpdGVtKQoKICAgICAgICBmb3IgaSBpbiBbMC4uLmN1cnJlbnRJdGVtcy5sZW5ndGhdCiAgICAgICAgICAgIHJvdyA9IE1hdGguZmxvb3IoaSAvIGNvbHVtbkNvdW50KQogICAgICAgICAgICBjb2x1bW4gPSBpICUgY29sdW1uQ291bnQKICAgICAgICAgICAgaWYgbm90IHJvd3Nbcm93XT8gdGhlbiByb3dzW3Jvd10gPSBbXQogICAgICAgICAgICByb3dzW3Jvd11bY29sdW1uXSA9IGN1cnJlbnRJdGVtc1tpXQogICAgICAgIAogICAgICAgIGl0ZW1XaW5kb3cucm93cyA9IHJvd3MKICAgICAgICBpdGVtV2luZG93LnJlZHJhdygpCiAgICBvbkl0ZW1DaGFuZ2U6IC0+CiAgICAgICAgY2VsbCA9IEBjdXJyZW50SXRlbVdpbmRvdygpLnNlbGVjdGVkQ2VsbAogICAgICAgIAogICAgICAgIGlmIEBwYXJhbWV0ZXJXaW5kb3cudmlzaWJsZQogICAgICAgICAgICBAcGFyYW1ldGVyV2luZG93LmN1cnJlbnRJdGVtID0gaWYgY2VsbD8gdGhlbiBjZWxsLml0ZW0gZWxzZSBudWxsCiAgICAgICAgICAgIEBwYXJhbWV0ZXJXaW5kb3cucHJldmlldyA9IHllcwogICAgICAgICAgICBAcGFyYW1ldGVyV2luZG93LnJlZHJhdygpCgogICAgICAgIGlmIGNlbGw/CiAgICAgICAgICAgIEBkZXNjcmlwdGlvbldpbmRvdy50ZXh0ID0gY2VsbC5pdGVtLmRlc2NyaXB0aW9uIHx8ICIiCiAgICAgICAgICAgIEBkZXNjcmlwdGlvbldpbmRvdy5yZWRyYXcoKQogICAgICAgICAgICAKICAgIG9uSXRlbUFjY2VwdDogKHNlbmRlciwgY2VsbCkgLT4KICAgICAgICBAYW1vdW50V2luZG93LmFjdGl2ZSA9IHllcwogICAgICAgIEBhbW91bnRXaW5kb3cudmlzaWJsZSA9IHllcwogICAgICAgIEBhbW91bnRXaW5kb3cuYW1vdW50ID0gMQogICAgICAgIGlmIEBtb2RlID09IFdpbmRvd3NldF9CdXlJdGVtcy5NT0RFX0JVWQogICAgICAgICAgICBAYW1vdW50V2luZG93Lm1heFZhbHVlID0gR2FtZU1hbmFnZXIubW9uZXkKICAgICAgICAgICAgQGFtb3VudFdpbmRvdy52YWx1ZSA9IGNlbGwucHJpY2UKICAgICAgICBlbHNlCiAgICAgICAgICAgIEBhbW91bnRXaW5kb3cudmFsdWUgPSBNYXRoLmZsb29yKGNlbGwuaXRlbS5wcmljZSAqIDAuNSkKICAgICAgICAgICAgQGFtb3VudFdpbmRvdy5tYXhWYWx1ZSA9IEBhbW91bnRXaW5kb3cudmFsdWUgKiBjZWxsLmNvdW50CiAgICAgICAgQGFtb3VudFdpbmRvdy5yZWRyYXcoKQogICAgICAgIEBhbW91bnRXaW5kb3cub3BlbigpCgogICAgICAgIHNlbmRlci5hY3RpdmUgPSBubwogICAgICAgIEB0eXBlV2luZG93LmFjdGl2ZSA9IG5vCiAgICAgICAgSW5wdXQuY2xlYXIoKQogICAgICAgIAogICAgb25BbW91bnRBY2NlcHQ6IChzZW5kZXIpIC0+CiAgICAgICAgYW1vdW50ID0gc2VuZGVyLmFtb3VudAogICAgICAgIHZhbHVlID0gc2VuZGVyLnZhbHVlCiAgICAgICAgY2VsbCA9IEBpdGVtV2luZG93LnNlbGVjdGVkQ2VsbAogICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgIGlmIEBtb2RlID09IFdpbmRvd3NldF9CdXlJdGVtcy5NT0RFX0JVWSBhbmQgQG9uQnV5PyB0aGVuIEBvbkJ1eSh0aGlzLCBjZWxsLml0ZW0sIGFtb3VudCwgdmFsdWUpCiAgICAgICAgaWYgQG1vZGUgPT0gV2luZG93c2V0X0J1eUl0ZW1zLk1PREVfU0VMTCBhbmQgQG9uU2VsbD8gdGhlbiBAb25TZWxsKHRoaXMsIGNlbGwuaXRlbSwgYW1vdW50LCB2YWx1ZSkKICAgICAgICAKICAgICAgICBAb25UeXBlQ2hhbmdlKCkKICAgICAgICBAY3VycmVudEl0ZW1XaW5kb3coKS5hY3RpdmUgPSB5ZXMKICAgICAgICBAY3VycmVudEl0ZW1XaW5kb3coKS5yZWRyYXcoKQogICAgb25BbW91bnRDYW5jZWw6IChzZW5kZXIpIC0+CiAgICAgICAgQGN1cnJlbnRJdGVtV2luZG93KCkuYWN0aXZlID0geWVzCiAgICAgICAgQHR5cGVXaW5kb3cuYWN0aXZlID0geWVzCiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgIAp3aW5kb3cuV2luZG93c2V0X0J1eUl0ZW1zID0gV2luZG93c2V0X0J1eUl0ZW1z","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBXaW5kb3dzZXRfQnV5SXRlbXMsCiAgICBfX2hhc1Byb3AgPSB7fS5oYXNPd25Qcm9wZXJ0eSwKICAgIF9fZXh0ZW5kcyA9IGZ1bmN0aW9uKGNoaWxkLCBwYXJlbnQpIHsgZm9yICh2YXIga2V5IGluIHBhcmVudCkgeyBpZiAoX19oYXNQcm9wLmNhbGwocGFyZW50LCBrZXkpKSBjaGlsZFtrZXldID0gcGFyZW50W2tleV07IH0gZnVuY3Rpb24gY3RvcigpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGNoaWxkOyB9IGN0b3IucHJvdG90eXBlID0gcGFyZW50LnByb3RvdHlwZTsgY2hpbGQucHJvdG90eXBlID0gbmV3IGN0b3IoKTsgY2hpbGQuX19zdXBlcl9fID0gcGFyZW50LnByb3RvdHlwZTsgcmV0dXJuIGNoaWxkOyB9OwoKICBXaW5kb3dzZXRfQnV5SXRlbXMgPSAoZnVuY3Rpb24oX3N1cGVyKSB7CiAgICBfX2V4dGVuZHMoV2luZG93c2V0X0J1eUl0ZW1zLCBfc3VwZXIpOwoKICAgIFdpbmRvd3NldF9CdXlJdGVtcy5NT0RFX0JVWSA9IDA7CgogICAgV2luZG93c2V0X0J1eUl0ZW1zLk1PREVfU0VMTCA9IDE7CgogICAgZnVuY3Rpb24gV2luZG93c2V0X0J1eUl0ZW1zKHgsIHksIHZpZXdwb3J0KSB7CiAgICAgIHZhciB2b2NhYiwKICAgICAgICBfdGhpcyA9IHRoaXM7CiAgICAgIFdpbmRvd3NldF9CdXlJdGVtcy5fX3N1cGVyX18uY29uc3RydWN0b3IuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgdm9jYWIgPSBSZWNvcmRNYW5hZ2VyLnZvY2FidWxhcnk7CiAgICAgIHRoaXMuaXRlbXMgPSBbXTsKICAgICAgdGhpcy53ZWFwb25zID0gW107CiAgICAgIHRoaXMuYXJtb3JzID0gW107CiAgICAgIHRoaXMubW9kZSA9IFdpbmRvd3NldF9CdXlJdGVtcy5NT0RFX0JVWTsKICAgICAgdGhpcy50eXBlV2luZG93ID0gbmV3IFdpbmRvd19TZWxlY3Rpb24oeCwgeSwgMywgW1tsY3Modm9jYWIubWVudS5pdGVtcyksIGxjcyh2b2NhYi5tZW51LndlYXBvbnMpLCBsY3Modm9jYWIubWVudS5hcm1vcnMpXV0sIDE0NiAqIFdpbmRvd19CYXNlLnNjYWxlLCAyMCAqIFdpbmRvd19CYXNlLnNjYWxlLCB2aWV3cG9ydCk7CiAgICAgIHRoaXMudHlwZVdpbmRvdy5jb250ZW50cy5mb250ID0gdGhpcy50eXBlV2luZG93Lm5hbWVGb250OwogICAgICB0aGlzLnR5cGVXaW5kb3cuYWN0aXZlID0gZmFsc2U7CiAgICAgIHRoaXMudHlwZVdpbmRvdy5jdXJzb3JWaXNpYmxlID0gZmFsc2U7CiAgICAgIHRoaXMudHlwZVdpbmRvdy5vblNlbGVjdGlvbkNoYW5nZSA9IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBfdGhpcy5vblR5cGVDaGFuZ2UoKTsKICAgICAgfTsKICAgICAgdGhpcy50eXBlV2luZG93Lm9uU2VsZWN0aW9uQWNjZXB0ID0gZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIF90aGlzLm9uVHlwZUFjY2VwdCgpOwogICAgICB9OwogICAgICB0aGlzLnR5cGVXaW5kb3cud2lkdGggKz0gNCAqIFdpbmRvd19CYXNlLnNjYWxlOwogICAgICB0aGlzLnBhcmFtZXRlcldpbmRvdyA9IG5ldyBXaW5kb3dfUGFyYW1ldGVyKHgsIHkgKyB0aGlzLnR5cGVXaW5kb3cuaGVpZ2h0LCAxNjAgKiBXaW5kb3dfQmFzZS5zY2FsZSwgMTgwICogV2luZG93X0Jhc2Uuc2NhbGUpOwogICAgICB0aGlzLnBhcmFtZXRlcldpbmRvdy52aXNpYmxlID0gZmFsc2U7CiAgICAgIHRoaXMuaXRlbVdpbmRvdyA9IG5ldyBXaW5kb3dfQnV5SXRlbXMoeCwgeSArIHRoaXMudHlwZVdpbmRvdy5oZWlnaHQsIDEsIFtdLCA0NDIgKiBXaW5kb3dfQmFzZS5zY2FsZSwgMjYgKiBXaW5kb3dfQmFzZS5zY2FsZSwgdmlld3BvcnQpOwogICAgICB0aGlzLml0ZW1XaW5kb3cub25TZWxlY3Rpb25DaGFuZ2UgPSBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gX3RoaXMub25JdGVtQ2hhbmdlKCk7CiAgICAgIH07CiAgICAgIHRoaXMuaXRlbVdpbmRvdy5vblNlbGVjdGlvbkFjY2VwdCA9IGZ1bmN0aW9uKHNlbmRlciwgY2VsbCkgewogICAgICAgIHJldHVybiBfdGhpcy5vbkl0ZW1BY2NlcHQoc2VuZGVyLCBjZWxsKTsKICAgICAgfTsKICAgICAgdGhpcy5pdGVtV2luZG93LmNvbnRlbnRzLmZvbnQgPSB0aGlzLml0ZW1XaW5kb3cubmFtZUZvbnQ7CiAgICAgIHRoaXMuaXRlbVdpbmRvdy5oZWlnaHQgPSAyNjQgKiBXaW5kb3dfQmFzZS5zY2FsZTsKICAgICAgdGhpcy5pdGVtV2luZG93LmFjdGl2ZSA9IGZhbHNlOwogICAgICB0aGlzLml0ZW1XaW5kb3cuY3Vyc29yVmlzaWJsZSA9IGZhbHNlOwogICAgICB0aGlzLnNtYWxsSXRlbVdpbmRvdyA9IG5ldyBXaW5kb3dfQnV5SXRlbXMoeCArIHRoaXMucGFyYW1ldGVyV2luZG93LndpZHRoLCB5ICsgdGhpcy50eXBlV2luZG93LmhlaWdodCwgMSwgW10sIDI4MiAqIFdpbmRvd19CYXNlLnNjYWxlLCAyMCAqIFdpbmRvd19CYXNlLnNjYWxlLCB2aWV3cG9ydCk7CiAgICAgIHRoaXMuc21hbGxJdGVtV2luZG93Lm9uU2VsZWN0aW9uQ2hhbmdlID0gZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIF90aGlzLm9uSXRlbUNoYW5nZSgpOwogICAgICB9OwogICAgICB0aGlzLnNtYWxsSXRlbVdpbmRvdy5jb250ZW50cy5mb250ID0gdGhpcy5zbWFsbEl0ZW1XaW5kb3cubmFtZUZvbnQ7CiAgICAgIHRoaXMuc21hbGxJdGVtV2luZG93LmhlaWdodCA9IDI2NCAqIFdpbmRvd19CYXNlLnNjYWxlOwogICAgICB0aGlzLnNtYWxsSXRlbVdpbmRvdy5hY3RpdmUgPSBmYWxzZTsKICAgICAgdGhpcy5zbWFsbEl0ZW1XaW5kb3cuY3Vyc29yVmlzaWJsZSA9IGZhbHNlOwogICAgICB0aGlzLnNtYWxsSXRlbVdpbmRvdy52aXNpYmxlID0gZmFsc2U7CiAgICAgIHRoaXMuc21hbGxJdGVtV2luZG93Lm9uU2VsZWN0aW9uQ2hhbmdlID0gZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIF90aGlzLm9uSXRlbUNoYW5nZSgpOwogICAgICB9OwogICAgICB0aGlzLnNtYWxsSXRlbVdpbmRvdy5vblNlbGVjdGlvbkFjY2VwdCA9IGZ1bmN0aW9uKHNlbmRlciwgY2VsbCkgewogICAgICAgIHJldHVybiBfdGhpcy5vbkl0ZW1BY2NlcHQoc2VuZGVyLCBjZWxsKTsKICAgICAgfTsKICAgICAgdGhpcy5kZXNjcmlwdGlvbldpbmRvdyA9IG5ldyBXaW5kb3dfVGV4dCh4LCB0aGlzLml0ZW1XaW5kb3cueSArIHRoaXMuaXRlbVdpbmRvdy5oZWlnaHQsIHRoaXMudHlwZVdpbmRvdy53aWR0aCwgNTggKiBXaW5kb3dfQmFzZS5zY2FsZSwgdmlld3BvcnQpOwogICAgICB0aGlzLmFtb3VudFdpbmRvdyA9IG5ldyBXaW5kb3dfQW1vdW50U2VsZWN0aW9uKCk7CiAgICAgIHRoaXMuYW1vdW50V2luZG93LmFjdGl2ZSA9IGZhbHNlOwogICAgICB0aGlzLmFtb3VudFdpbmRvdy52aXNpYmxlID0gZmFsc2U7CiAgICAgIHRoaXMuYW1vdW50V2luZG93Lm9uQWNjZXB0ID0gZnVuY3Rpb24oc2VuZGVyKSB7CiAgICAgICAgcmV0dXJuIF90aGlzLm9uQW1vdW50QWNjZXB0KHNlbmRlcik7CiAgICAgIH07CiAgICAgIHRoaXMuYW1vdW50V2luZG93Lm9uQ2FuY2VsID0gZnVuY3Rpb24oc2VuZGVyKSB7CiAgICAgICAgcmV0dXJuIF90aGlzLm9uQW1vdW50Q2FuY2VsKHNlbmRlcik7CiAgICAgIH07CiAgICAgIHRoaXMuYWN0aXZlID0gZmFsc2U7CiAgICAgIHRoaXMud2luZG93cy5wdXNoKHRoaXMudHlwZVdpbmRvdyk7CiAgICAgIHRoaXMud2luZG93cy5wdXNoKHRoaXMuaXRlbVdpbmRvdyk7CiAgICAgIHRoaXMud2luZG93cy5wdXNoKHRoaXMuc21hbGxJdGVtV2luZG93KTsKICAgICAgdGhpcy53aW5kb3dzLnB1c2godGhpcy5wYXJhbWV0ZXJXaW5kb3cpOwogICAgICB0aGlzLndpbmRvd3MucHVzaCh0aGlzLmRlc2NyaXB0aW9uV2luZG93KTsKICAgICAgdGhpcy53aW5kb3dzLnB1c2godGhpcy5hbW91bnRXaW5kb3cpOwogICAgICB0aGlzLndpZHRoID0gdGhpcy5pdGVtV2luZG93LndpZHRoOwogICAgICB0aGlzLm1lbWJlciA9IG51bGw7CiAgICB9CgogICAgV2luZG93c2V0X0J1eUl0ZW1zLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGl0ZW1XaW5kb3c7CiAgICAgIFdpbmRvd3NldF9CdXlJdGVtcy5fX3N1cGVyX18udXBkYXRlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIGlmICghdGhpcy5hY3RpdmUpIHsKICAgICAgICB0aGlzLnR5cGVXaW5kb3cuc2VsZWN0ZWRDb2x1bW4gPSAwOwogICAgICB9CiAgICAgIHRoaXMuc21hbGxJdGVtV2luZG93LnZpc2libGUgPSB0aGlzLnR5cGVXaW5kb3cuc2VsZWN0ZWRDb2x1bW4gIT09IDAgJiYgdGhpcy5tb2RlID09PSBXaW5kb3dzZXRfQnV5SXRlbXMuTU9ERV9CVVk7CiAgICAgIHRoaXMucGFyYW1ldGVyV2luZG93LnZpc2libGUgPSB0aGlzLnR5cGVXaW5kb3cuc2VsZWN0ZWRDb2x1bW4gIT09IDAgJiYgdGhpcy5tb2RlID09PSBXaW5kb3dzZXRfQnV5SXRlbXMuTU9ERV9CVVk7CiAgICAgIHRoaXMucGFyYW1ldGVyV2luZG93Lm1lbWJlciA9IHRoaXMubWVtYmVyOwogICAgICB0aGlzLml0ZW1XaW5kb3cudmlzaWJsZSA9IHRoaXMubW9kZSA8IDIgJiYgdGhpcy50eXBlV2luZG93LnNlbGVjdGVkQ29sdW1uID09PSAwIHx8IHRoaXMubW9kZSA9PT0gV2luZG93c2V0X0J1eUl0ZW1zLk1PREVfU0VMTDsKICAgICAgaWYgKCF0aGlzLmFjdGl2ZSkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBpdGVtV2luZG93ID0gdGhpcy5jdXJyZW50SXRlbVdpbmRvdygpOwogICAgICB0aGlzLnR5cGVXaW5kb3cuY3Vyc29yVmlzaWJsZSA9IHRoaXMuYWN0aXZlOwogICAgICBpZiAoSW5wdXQudHJpZ2dlcihJbnB1dC5CKSkgewogICAgICAgIGlmICh0aGlzLnR5cGVXaW5kb3cuYWN0aXZlKSB7CiAgICAgICAgICB0aGlzLnR5cGVXaW5kb3cuYWN0aXZlID0gZmFsc2U7CiAgICAgICAgICB0aGlzLnR5cGVXaW5kb3cuY3Vyc29yVmlzaWJsZSA9IGZhbHNlOwogICAgICAgICAgdGhpcy5hY3RpdmUgPSBmYWxzZTsKICAgICAgICAgIGlmICh0aGlzLm9uQ2FuY2VsICE9IG51bGwpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMub25DYW5jZWwoKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy50eXBlV2luZG93LmFjdGl2ZSA9IHRydWU7CiAgICAgICAgICBpdGVtV2luZG93LmFjdGl2ZSA9IGZhbHNlOwogICAgICAgICAgaXRlbVdpbmRvdy5jdXJzb3JWaXNpYmxlID0gZmFsc2U7CiAgICAgICAgICB0aGlzLmNsZWFyRGVzY3JpcHRpb24oKTsKICAgICAgICAgIHJldHVybiB0aGlzLnBhcmFtZXRlcldpbmRvdy5yZWRyYXcoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgV2luZG93c2V0X0J1eUl0ZW1zLnByb3RvdHlwZS5yZWRyYXcgPSBmdW5jdGlvbigpIHsKICAgICAgdGhpcy5pdGVtV2luZG93Lm1vZGUgPSB0aGlzLm1vZGU7CiAgICAgIHRoaXMub25UeXBlQ2hhbmdlKCk7CiAgICAgIHRoaXMudHlwZVdpbmRvdy5yZWRyYXcoKTsKICAgICAgdGhpcy5pdGVtV2luZG93LnJlZHJhdygpOwogICAgICByZXR1cm4gdGhpcy5zbWFsbEl0ZW1XaW5kb3cucmVkcmF3KCk7CiAgICB9OwoKICAgIFdpbmRvd3NldF9CdXlJdGVtcy5wcm90b3R5cGUuc2hvdyA9IGZ1bmN0aW9uKHNob3csIGFjdGl2ZSkgewogICAgICBXaW5kb3dzZXRfQnV5SXRlbXMuX19zdXBlcl9fLnNob3cuY2FsbCh0aGlzLCBzaG93LCBhY3RpdmUpOwogICAgICB0aGlzLmFtb3VudFdpbmRvdy52aXNpYmxlID0gZmFsc2U7CiAgICAgIHRoaXMuc21hbGxJdGVtV2luZG93LnZpc2libGUgPSBzaG93ICYmIHRoaXMudHlwZVdpbmRvdy5zZWxlY3RlZENvbHVtbiAhPT0gMDsKICAgICAgdGhpcy5wYXJhbWV0ZXJXaW5kb3cudmlzaWJsZSA9IHNob3cgJiYgdGhpcy50eXBlV2luZG93LnNlbGVjdGVkQ29sdW1uICE9PSAwOwogICAgICByZXR1cm4gdGhpcy5pdGVtV2luZG93LnZpc2libGUgPSBzaG93ICYmIHRoaXMudHlwZVdpbmRvdy5zZWxlY3RlZENvbHVtbiA9PT0gMDsKICAgIH07CgogICAgV2luZG93c2V0X0J1eUl0ZW1zLnByb3RvdHlwZS5hY3RpdmF0ZSA9IGZ1bmN0aW9uKCkgewogICAgICB0aGlzLmFjdGl2ZSA9IHRydWU7CiAgICAgIHRoaXMudHlwZVdpbmRvdy5hY3RpdmUgPSB0cnVlOwogICAgICB0aGlzLml0ZW1XaW5kb3cubW9kZSA9IHRoaXMubW9kZTsKICAgICAgcmV0dXJuIHRoaXMub25UeXBlQ2hhbmdlKCk7CiAgICB9OwoKICAgIFdpbmRvd3NldF9CdXlJdGVtcy5wcm90b3R5cGUuY2xlYXJEZXNjcmlwdGlvbiA9IGZ1bmN0aW9uKCkgewogICAgICB0aGlzLmRlc2NyaXB0aW9uV2luZG93LnRleHQgPSAiIjsKICAgICAgdGhpcy5kZXNjcmlwdGlvbldpbmRvdy5yZWRyYXcoKTsKICAgICAgdGhpcy5wYXJhbWV0ZXJXaW5kb3cuY3VycmVudEl0ZW0gPSBudWxsOwogICAgICB0aGlzLnBhcmFtZXRlcldpbmRvdy5wcmV2aWV3ID0gZmFsc2U7CiAgICAgIHJldHVybiB0aGlzLnBhcmFtZXRlcldpbmRvdy5yZWRyYXcoKTsKICAgIH07CgogICAgV2luZG93c2V0X0J1eUl0ZW1zLnByb3RvdHlwZS5jdXJyZW50SXRlbVdpbmRvdyA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgcmVzdWx0OwogICAgICByZXN1bHQgPSBudWxsOwogICAgICBpZiAodGhpcy50eXBlV2luZG93LnNlbGVjdGVkQ29sdW1uID09PSAwIHx8IHRoaXMubW9kZSA9PT0gV2luZG93c2V0X0J1eUl0ZW1zLk1PREVfU0VMTCkgewogICAgICAgIHJlc3VsdCA9IHRoaXMuaXRlbVdpbmRvdzsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXN1bHQgPSB0aGlzLnNtYWxsSXRlbVdpbmRvdzsKICAgICAgfQogICAgICByZXR1cm4gcmVzdWx0OwogICAgfTsKCiAgICBXaW5kb3dzZXRfQnV5SXRlbXMucHJvdG90eXBlLm9uVHlwZUFjY2VwdCA9IGZ1bmN0aW9uKCkgewogICAgICB0aGlzLnR5cGVXaW5kb3cuYWN0aXZlID0gZmFsc2U7CiAgICAgIHRoaXMuY3VycmVudEl0ZW1XaW5kb3coKS5hY3RpdmUgPSB0cnVlOwogICAgICB0aGlzLmN1cnJlbnRJdGVtV2luZG93KCkuY3Vyc29yVmlzaWJsZSA9IHRydWU7CiAgICAgIHJldHVybiBJbnB1dC5jbGVhcigpOwogICAgfTsKCiAgICBXaW5kb3dzZXRfQnV5SXRlbXMucHJvdG90eXBlLm9uVHlwZUNoYW5nZSA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgY29sdW1uLCBjb2x1bW5Db3VudCwgY3VycmVudEl0ZW1zLCBpLCBpdGVtLCBpdGVtV2luZG93LCBpdGVtcywgcm93LCByb3dzLCBfaSwgX2osIF9yZWYsIF9yZWYxOwogICAgICBpdGVtcyA9IG51bGw7CiAgICAgIHJvd3MgPSBbXTsKICAgICAgcm93ID0gMDsKICAgICAgY29sdW1uID0gMDsKICAgICAgY29sdW1uQ291bnQgPSB0aGlzLnR5cGVXaW5kb3cuc2VsZWN0ZWRDb2x1bW4gPT09IDAgfHwgdGhpcy5tb2RlID09PSBXaW5kb3dzZXRfQnV5SXRlbXMuTU9ERV9TRUxMID8gMSA6IDE7CiAgICAgIGl0ZW1XaW5kb3cgPSB0aGlzLmN1cnJlbnRJdGVtV2luZG93KCk7CiAgICAgIHRoaXMucGFyYW1ldGVyV2luZG93LnZpc2libGUgPSB0aGlzLnR5cGVXaW5kb3cuc2VsZWN0ZWRDb2x1bW4gIT09IDAgJiYgdGhpcy5tb2RlID09PSBXaW5kb3dzZXRfQnV5SXRlbXMuTU9ERV9CVVk7CiAgICAgIGlmICh0aGlzLnBhcmFtZXRlcldpbmRvdy52aXNpYmxlKSB7CiAgICAgICAgdGhpcy5wYXJhbWV0ZXJXaW5kb3cucmVkcmF3KCk7CiAgICAgIH0KICAgICAgdGhpcy5jbGVhckRlc2NyaXB0aW9uKCk7CiAgICAgIGN1cnJlbnRJdGVtcyA9IFtdOwogICAgICBzd2l0Y2ggKHRoaXMudHlwZVdpbmRvdy5zZWxlY3RlZENvbHVtbikgewogICAgICAgIGNhc2UgMDoKICAgICAgICAgIGl0ZW1zID0gdGhpcy5pdGVtczsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgMToKICAgICAgICAgIGl0ZW1zID0gdGhpcy53ZWFwb25zOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAyOgogICAgICAgICAgaXRlbXMgPSB0aGlzLmFybW9yczsKICAgICAgfQogICAgICBpZiAodGhpcy5tb2RlID09PSAwKSB7CiAgICAgICAgY3VycmVudEl0ZW1zID0gaXRlbXM7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZm9yIChpID0gX2kgPSAwLCBfcmVmID0gaXRlbXMubGVuZ3RoOyAwIDw9IF9yZWYgPyBfaSA8IF9yZWYgOiBfaSA+IF9yZWY7IGkgPSAwIDw9IF9yZWYgPyArK19pIDogLS1faSkgewogICAgICAgICAgaXRlbSA9IEdhbWVNYW5hZ2VyLmludmVudG9yeS5pdGVtKHRoaXMudHlwZVdpbmRvdy5zZWxlY3RlZENvbHVtbiwgaXRlbXNbaV0uaXRlbS5pbmRleCk7CiAgICAgICAgICBpZiAoKGl0ZW0gIT0gbnVsbCkgJiYgaXRlbS5jb3VudCA+IDApIHsKICAgICAgICAgICAgY3VycmVudEl0ZW1zLnB1c2goaXRlbSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICAgIGZvciAoaSA9IF9qID0gMCwgX3JlZjEgPSBjdXJyZW50SXRlbXMubGVuZ3RoOyAwIDw9IF9yZWYxID8gX2ogPCBfcmVmMSA6IF9qID4gX3JlZjE7IGkgPSAwIDw9IF9yZWYxID8gKytfaiA6IC0tX2opIHsKICAgICAgICByb3cgPSBNYXRoLmZsb29yKGkgLyBjb2x1bW5Db3VudCk7CiAgICAgICAgY29sdW1uID0gaSAlIGNvbHVtbkNvdW50OwogICAgICAgIGlmIChyb3dzW3Jvd10gPT0gbnVsbCkgewogICAgICAgICAgcm93c1tyb3ddID0gW107CiAgICAgICAgfQogICAgICAgIHJvd3Nbcm93XVtjb2x1bW5dID0gY3VycmVudEl0ZW1zW2ldOwogICAgICB9CiAgICAgIGl0ZW1XaW5kb3cucm93cyA9IHJvd3M7CiAgICAgIHJldHVybiBpdGVtV2luZG93LnJlZHJhdygpOwogICAgfTsKCiAgICBXaW5kb3dzZXRfQnV5SXRlbXMucHJvdG90eXBlLm9uSXRlbUNoYW5nZSA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgY2VsbDsKICAgICAgY2VsbCA9IHRoaXMuY3VycmVudEl0ZW1XaW5kb3coKS5zZWxlY3RlZENlbGw7CiAgICAgIGlmICh0aGlzLnBhcmFtZXRlcldpbmRvdy52aXNpYmxlKSB7CiAgICAgICAgdGhpcy5wYXJhbWV0ZXJXaW5kb3cuY3VycmVudEl0ZW0gPSBjZWxsICE9IG51bGwgPyBjZWxsLml0ZW0gOiBudWxsOwogICAgICAgIHRoaXMucGFyYW1ldGVyV2luZG93LnByZXZpZXcgPSB0cnVlOwogICAgICAgIHRoaXMucGFyYW1ldGVyV2luZG93LnJlZHJhdygpOwogICAgICB9CiAgICAgIGlmIChjZWxsICE9IG51bGwpIHsKICAgICAgICB0aGlzLmRlc2NyaXB0aW9uV2luZG93LnRleHQgPSBjZWxsLml0ZW0uZGVzY3JpcHRpb24gfHwgIiI7CiAgICAgICAgcmV0dXJuIHRoaXMuZGVzY3JpcHRpb25XaW5kb3cucmVkcmF3KCk7CiAgICAgIH0KICAgIH07CgogICAgV2luZG93c2V0X0J1eUl0ZW1zLnByb3RvdHlwZS5vbkl0ZW1BY2NlcHQgPSBmdW5jdGlvbihzZW5kZXIsIGNlbGwpIHsKICAgICAgdGhpcy5hbW91bnRXaW5kb3cuYWN0aXZlID0gdHJ1ZTsKICAgICAgdGhpcy5hbW91bnRXaW5kb3cudmlzaWJsZSA9IHRydWU7CiAgICAgIHRoaXMuYW1vdW50V2luZG93LmFtb3VudCA9IDE7CiAgICAgIGlmICh0aGlzLm1vZGUgPT09IFdpbmRvd3NldF9CdXlJdGVtcy5NT0RFX0JVWSkgewogICAgICAgIHRoaXMuYW1vdW50V2luZG93Lm1heFZhbHVlID0gR2FtZU1hbmFnZXIubW9uZXk7CiAgICAgICAgdGhpcy5hbW91bnRXaW5kb3cudmFsdWUgPSBjZWxsLnByaWNlOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuYW1vdW50V2luZG93LnZhbHVlID0gTWF0aC5mbG9vcihjZWxsLml0ZW0ucHJpY2UgKiAwLjUpOwogICAgICAgIHRoaXMuYW1vdW50V2luZG93Lm1heFZhbHVlID0gdGhpcy5hbW91bnRXaW5kb3cudmFsdWUgKiBjZWxsLmNvdW50OwogICAgICB9CiAgICAgIHRoaXMuYW1vdW50V2luZG93LnJlZHJhdygpOwogICAgICB0aGlzLmFtb3VudFdpbmRvdy5vcGVuKCk7CiAgICAgIHNlbmRlci5hY3RpdmUgPSBmYWxzZTsKICAgICAgdGhpcy50eXBlV2luZG93LmFjdGl2ZSA9IGZhbHNlOwogICAgICByZXR1cm4gSW5wdXQuY2xlYXIoKTsKICAgIH07CgogICAgV2luZG93c2V0X0J1eUl0ZW1zLnByb3RvdHlwZS5vbkFtb3VudEFjY2VwdCA9IGZ1bmN0aW9uKHNlbmRlcikgewogICAgICB2YXIgYW1vdW50LCBjZWxsLCB2YWx1ZTsKICAgICAgYW1vdW50ID0gc2VuZGVyLmFtb3VudDsKICAgICAgdmFsdWUgPSBzZW5kZXIudmFsdWU7CiAgICAgIGNlbGwgPSB0aGlzLml0ZW1XaW5kb3cuc2VsZWN0ZWRDZWxsOwogICAgICBpZiAodGhpcy5tb2RlID09PSBXaW5kb3dzZXRfQnV5SXRlbXMuTU9ERV9CVVkgJiYgKHRoaXMub25CdXkgIT0gbnVsbCkpIHsKICAgICAgICB0aGlzLm9uQnV5KHRoaXMsIGNlbGwuaXRlbSwgYW1vdW50LCB2YWx1ZSk7CiAgICAgIH0KICAgICAgaWYgKHRoaXMubW9kZSA9PT0gV2luZG93c2V0X0J1eUl0ZW1zLk1PREVfU0VMTCAmJiAodGhpcy5vblNlbGwgIT0gbnVsbCkpIHsKICAgICAgICB0aGlzLm9uU2VsbCh0aGlzLCBjZWxsLml0ZW0sIGFtb3VudCwgdmFsdWUpOwogICAgICB9CiAgICAgIHRoaXMub25UeXBlQ2hhbmdlKCk7CiAgICAgIHRoaXMuY3VycmVudEl0ZW1XaW5kb3coKS5hY3RpdmUgPSB0cnVlOwogICAgICByZXR1cm4gdGhpcy5jdXJyZW50SXRlbVdpbmRvdygpLnJlZHJhdygpOwogICAgfTsKCiAgICBXaW5kb3dzZXRfQnV5SXRlbXMucHJvdG90eXBlLm9uQW1vdW50Q2FuY2VsID0gZnVuY3Rpb24oc2VuZGVyKSB7CiAgICAgIHRoaXMuY3VycmVudEl0ZW1XaW5kb3coKS5hY3RpdmUgPSB0cnVlOwogICAgICByZXR1cm4gdGhpcy50eXBlV2luZG93LmFjdGl2ZSA9IHRydWU7CiAgICB9OwoKICAgIHJldHVybiBXaW5kb3dzZXRfQnV5SXRlbXM7CgogIH0pKFdpbmRvd3NldF9CYXNlKTsKCiAgd2luZG93LldpbmRvd3NldF9CdXlJdGVtcyA9IFdpbmRvd3NldF9CdXlJdGVtczsKCn0pLmNhbGwodGhpcyk7Cg=="},{"name":"Windowset_Skills","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogV2luZG93c2V0X1NraWxscwojICAgQ3JlYXRlZCBvbjogMjAxMy0wOS0yNAojCiMgICBDb3B5cmlnaHQgKEMpIDIwMTMgQW5kcukgUmFkb21za2kuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgICBDbGFzczogV2luZG93c2V0X1NraWxscwojCiMgICBBIHdpbmRvdyB3aGljaCBkaXNwbGF5cyB0aGUgd2luZG93cyBuZWVkZWQgZm9yIHNraWxsIHNlbGVjdGlvbgojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKY2xhc3MgV2luZG93c2V0X1NraWxscyBleHRlbmRzIFdpbmRvd3NldF9CYXNlCiAgICBjb25zdHJ1Y3RvcjogKHgsIHksIHZpZXdwb3J0LCB3aWR0aCkgLT4KICAgICAgICBzdXBlcgogICAgICAgIHdpZHRoID0gd2lkdGggfHwgKDQ2NiAqIFdpbmRvd19CYXNlLnNjYWxlKQogICAgICAgIEB0eXBlV2luZG93ID0gbmV3IFdpbmRvd19Ta2lsbFR5cGUoeCwgeSwgdmlld3BvcnQsIHdpZHRoKQogICAgICAgIEB0eXBlV2luZG93LmFjdGl2ZSA9IG5vCiAgICAgICAgQHR5cGVXaW5kb3cud2lkdGggPSB3aWR0aAogICAgICAgIEB0eXBlV2luZG93LmN1cnNvclZpc2libGUgPSBubwogICAgICAgIEB0eXBlV2luZG93Lm9uU2VsZWN0aW9uQ2hhbmdlID0gPT4gQG9uVHlwZUNoYW5nZSgpCiAgICAgICAgQHR5cGVXaW5kb3cub25TZWxlY3Rpb25BY2NlcHQgPSA9PiBAb25UeXBlQWNjZXB0KCkKICAgICAgICBAdHlwZVdpbmRvdy5vbkNhbmNlbCA9ID0+IEBvblR5cGVDYW5jZWwoKQogICAgICAgIEBpdGVtV2luZG93ID0gbmV3IFdpbmRvd19Ta2lsbHMoeCwgeStAdHlwZVdpbmRvdy5oZWlnaHQsIDIsIFtdLCAod2lkdGggLyAyKSAtIDEyKldpbmRvd19CYXNlLnNjYWxlLCAyNipXaW5kb3dfQmFzZS5zY2FsZSwgdmlld3BvcnQpCiAgICAgICAgQGl0ZW1XaW5kb3cub25TZWxlY3Rpb25DaGFuZ2UgPSA9PiBAb25JdGVtQ2hhbmdlKCkKICAgICAgICBAaXRlbVdpbmRvdy5vblNlbGVjdGlvbkFjY2VwdCA9ID0+IEBvbkl0ZW1BY2NlcHQoKQogICAgICAgIEBpdGVtV2luZG93Lm9uQ2FuY2VsID0gPT4gQG9uSXRlbUNhbmNlbCgpCiAgICAgICAgQGl0ZW1XaW5kb3cuY29udGVudHMuZm9udCA9IEBpdGVtV2luZG93Lm5hbWVGb250CiAgICAgICAgQGl0ZW1XaW5kb3cuaGVpZ2h0ID0gMjY0ICogV2luZG93X0Jhc2Uuc2NhbGUKICAgICAgICBAaXRlbVdpbmRvdy5hY3RpdmUgPSBubwogICAgICAgIEBpdGVtV2luZG93LmN1cnNvclZpc2libGUgPSBubwogICAgICAgIEBkZXNjcmlwdGlvbldpbmRvdyA9IG5ldyBXaW5kb3dfVGV4dCh4LCBAaXRlbVdpbmRvdy55K0BpdGVtV2luZG93LmhlaWdodCwgQHR5cGVXaW5kb3cud2lkdGgsIDU4ICogV2luZG93X0Jhc2Uuc2NhbGUsIHZpZXdwb3J0KQogICAgICAgIEBhY3RpdmUgPSBubwogICAgICAgIAogICAgICAgIEB3aW5kb3dzLnB1c2goQHR5cGVXaW5kb3cpCiAgICAgICAgQHdpbmRvd3MucHVzaChAaXRlbVdpbmRvdykKICAgICAgICBAd2luZG93cy5wdXNoKEBkZXNjcmlwdGlvbldpbmRvdykKICAgICAgICAgICAgICAgIAogICAgdXBkYXRlOiAtPgogICAgICAgIHN1cGVyCiAgICAgICAgCiAgICAgICAgQGl0ZW1XaW5kb3cubWVtYmVyID0gQG1lbWJlcgogICAgICAgIAogICAgICAgIGlmIG5vdCBAYWN0aXZlCiAgICAgICAgICAgIEB0eXBlV2luZG93LmFjdGl2ZSA9IG5vCiAgICAgICAgICAgIEBpdGVtV2luZG93LmFjdGl2ZSA9IG5vCiAgICAgICAgICAgIHJldHVybgogICAgICAgIAogICAgICAgIGlmIG5vdCBAdHlwZVdpbmRvdy5hY3RpdmUgYW5kIG5vdCBAaXRlbVdpbmRvdy5hY3RpdmUKICAgICAgICAgICAgQHR5cGVXaW5kb3cuYWN0aXZlID0geWVzCiAgICAgICAgICAgIEBpdGVtV2luZG93LmFjdGl2ZSA9IG5vCiAgICAgICAgICAgIEBpdGVtV2luZG93LmN1cnNvclZpc2libGUgPSBubwogICAgICAgIAogICAgICAgIEB0eXBlV2luZG93LmN1cnNvclZpc2libGUgPSBAYWN0aXZlCiAgICAgICAgQHR5cGVXaW5kb3cuYWN0aXZlID0gIUBpdGVtV2luZG93LmFjdGl2ZQogICAgY2xlYXJEZXNjcmlwdGlvbjogLT4KICAgICAgICBAZGVzY3JpcHRpb25XaW5kb3cudGV4dCA9ICIiCiAgICAgICAgQGRlc2NyaXB0aW9uV2luZG93LnJlZHJhdygpCiAgICAgICAgCiAgICByZWJ1aWxkOiAtPgogICAgICAgIGlmIEBtZW1iZXI/CiAgICAgICAgICAgIHNraWxsVHlwZXMgPSBbXQogICAgICAgICAgICBmb3IgdHlwZSBpbiBAbWVtYmVyLnNraWxsVHlwZXMKICAgICAgICAgICAgICAgIGlmIHR5cGU/CiAgICAgICAgICAgICAgICAgICAgc2tpbGxUeXBlcy5wdXNoKHR5cGUpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgIEB0eXBlV2luZG93LnJvd3NbMF0gPSBza2lsbFR5cGVzCiAgICAgICAgICAgIAogICAgICAgIEBvblR5cGVDaGFuZ2UoKQogICAgICAgICAgICAKICAgIHJlZHJhdzogLT4KICAgICAgICBAdHlwZVdpbmRvdy5yZWRyYXcoKQogICAgICAgIEBpdGVtV2luZG93LnJlZHJhdygpCiAgICAgICAgCiAgICBvblR5cGVBY2NlcHQ6IC0+CiAgICAgICAgQHR5cGVXaW5kb3cuYWN0aXZlID0gbm8KICAgICAgICBAaXRlbVdpbmRvdy5hY3RpdmUgPSB5ZXMKICAgICAgICBAaXRlbVdpbmRvdy5jdXJzb3JWaXNpYmxlID0geWVzCiAgICAgICAgCiAgICBvblR5cGVDYW5jZWw6IC0+CiAgICAgICAgQHR5cGVXaW5kb3cuYWN0aXZlID0gbm8KICAgICAgICBAdHlwZVdpbmRvdy5jdXJzb3JWaXNpYmxlID0gbm8KICAgICAgICBAYWN0aXZlID0gbm8KICAgICAgICBpZiBAb25DYW5jZWw/IAogICAgICAgICAgICBAb25DYW5jZWwoKQogICAgICAgICAgICAgICAgCiAgICBvblR5cGVDaGFuZ2U6IC0+CiAgICAgICAgaXRlbXMgPSBudWxsCiAgICAgICAgcm93cyA9IFtdCiAgICAgICAgcm93ID0gMAogICAgICAgIGNvbHVtbiA9IDAKICAgICAgICAKICAgICAgICBpZiBub3QgQHR5cGVXaW5kb3cuc2VsZWN0ZWRDZWxsPyB0aGVuIHJldHVybgogICAgICAgIAogICAgICAgIEBpdGVtV2luZG93LnR5cGUgPSBAdHlwZVdpbmRvdy5zZWxlY3RlZENlbGwuaW5kZXgKICAgICAgICBAaXRlbVdpbmRvdy5tZW1iZXIgPSBAbWVtYmVyCiAgICAgICAgQGl0ZW1XaW5kb3cucmVidWlsZFJvd3MoKQogICAgICAgIEBpdGVtV2luZG93LnJlZHJhdygpCiAgICAgICAgCiAgICBvbkl0ZW1BY2NlcHQ6IC0+CiAgICAgICAgaWYgQG9uU2tpbGxTZWxlY3Rpb24/CiAgICAgICAgICAgIEBzZWxlY3RlZFNraWxsID0gQGl0ZW1XaW5kb3cuc2VsZWN0ZWRDZWxsCiAgICAgICAgICAgIEBvblNraWxsU2VsZWN0aW9uKEBpdGVtV2luZG93LnNlbGVjdGVkQ2VsbCkKICAgICAgICAgICAKICAgIG9uSXRlbUNhbmNlbDogLT4KICAgICAgICBAdHlwZVdpbmRvdy5hY3RpdmUgPSB5ZXMKICAgICAgICBAaXRlbVdpbmRvdy5hY3RpdmUgPSBubwogICAgICAgIEBpdGVtV2luZG93LmN1cnNvclZpc2libGUgPSBubwogICAgICAgIEBjbGVhckRlc2NyaXB0aW9uKCkKICAgICAgICAKICAgIG9uSXRlbUNoYW5nZTogLT4KICAgICAgICBjZWxsID0gQGl0ZW1XaW5kb3cuc2VsZWN0ZWRDZWxsCgogICAgICAgIGlmIGNlbGw/CiAgICAgICAgICAgIEBkZXNjcmlwdGlvbldpbmRvdy50ZXh0ID0gY2VsbC5kZXNjcmlwdGlvbgogICAgICAgICAgICBAZGVzY3JpcHRpb25XaW5kb3cucmVkcmF3KCkKICAgICAgICBlbHNlCiAgICAgICAgICAgIEBjbGVhckRlc2NyaXB0aW9uKCkKICAgICAgICAKd2luZG93LldpbmRvd3NldF9Ta2lsbHMgPSBXaW5kb3dzZXRfU2tpbGxz","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBXaW5kb3dzZXRfU2tpbGxzLAogICAgX19oYXNQcm9wID0ge30uaGFzT3duUHJvcGVydHksCiAgICBfX2V4dGVuZHMgPSBmdW5jdGlvbihjaGlsZCwgcGFyZW50KSB7IGZvciAodmFyIGtleSBpbiBwYXJlbnQpIHsgaWYgKF9faGFzUHJvcC5jYWxsKHBhcmVudCwga2V5KSkgY2hpbGRba2V5XSA9IHBhcmVudFtrZXldOyB9IGZ1bmN0aW9uIGN0b3IoKSB7IHRoaXMuY29uc3RydWN0b3IgPSBjaGlsZDsgfSBjdG9yLnByb3RvdHlwZSA9IHBhcmVudC5wcm90b3R5cGU7IGNoaWxkLnByb3RvdHlwZSA9IG5ldyBjdG9yKCk7IGNoaWxkLl9fc3VwZXJfXyA9IHBhcmVudC5wcm90b3R5cGU7IHJldHVybiBjaGlsZDsgfTsKCiAgV2luZG93c2V0X1NraWxscyA9IChmdW5jdGlvbihfc3VwZXIpIHsKICAgIF9fZXh0ZW5kcyhXaW5kb3dzZXRfU2tpbGxzLCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFdpbmRvd3NldF9Ta2lsbHMoeCwgeSwgdmlld3BvcnQsIHdpZHRoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIFdpbmRvd3NldF9Ta2lsbHMuX19zdXBlcl9fLmNvbnN0cnVjdG9yLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIHdpZHRoID0gd2lkdGggfHwgKDQ2NiAqIFdpbmRvd19CYXNlLnNjYWxlKTsKICAgICAgdGhpcy50eXBlV2luZG93ID0gbmV3IFdpbmRvd19Ta2lsbFR5cGUoeCwgeSwgdmlld3BvcnQsIHdpZHRoKTsKICAgICAgdGhpcy50eXBlV2luZG93LmFjdGl2ZSA9IGZhbHNlOwogICAgICB0aGlzLnR5cGVXaW5kb3cud2lkdGggPSB3aWR0aDsKICAgICAgdGhpcy50eXBlV2luZG93LmN1cnNvclZpc2libGUgPSBmYWxzZTsKICAgICAgdGhpcy50eXBlV2luZG93Lm9uU2VsZWN0aW9uQ2hhbmdlID0gZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIF90aGlzLm9uVHlwZUNoYW5nZSgpOwogICAgICB9OwogICAgICB0aGlzLnR5cGVXaW5kb3cub25TZWxlY3Rpb25BY2NlcHQgPSBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gX3RoaXMub25UeXBlQWNjZXB0KCk7CiAgICAgIH07CiAgICAgIHRoaXMudHlwZVdpbmRvdy5vbkNhbmNlbCA9IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBfdGhpcy5vblR5cGVDYW5jZWwoKTsKICAgICAgfTsKICAgICAgdGhpcy5pdGVtV2luZG93ID0gbmV3IFdpbmRvd19Ta2lsbHMoeCwgeSArIHRoaXMudHlwZVdpbmRvdy5oZWlnaHQsIDIsIFtdLCAod2lkdGggLyAyKSAtIDEyICogV2luZG93X0Jhc2Uuc2NhbGUsIDI2ICogV2luZG93X0Jhc2Uuc2NhbGUsIHZpZXdwb3J0KTsKICAgICAgdGhpcy5pdGVtV2luZG93Lm9uU2VsZWN0aW9uQ2hhbmdlID0gZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIF90aGlzLm9uSXRlbUNoYW5nZSgpOwogICAgICB9OwogICAgICB0aGlzLml0ZW1XaW5kb3cub25TZWxlY3Rpb25BY2NlcHQgPSBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gX3RoaXMub25JdGVtQWNjZXB0KCk7CiAgICAgIH07CiAgICAgIHRoaXMuaXRlbVdpbmRvdy5vbkNhbmNlbCA9IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBfdGhpcy5vbkl0ZW1DYW5jZWwoKTsKICAgICAgfTsKICAgICAgdGhpcy5pdGVtV2luZG93LmNvbnRlbnRzLmZvbnQgPSB0aGlzLml0ZW1XaW5kb3cubmFtZUZvbnQ7CiAgICAgIHRoaXMuaXRlbVdpbmRvdy5oZWlnaHQgPSAyNjQgKiBXaW5kb3dfQmFzZS5zY2FsZTsKICAgICAgdGhpcy5pdGVtV2luZG93LmFjdGl2ZSA9IGZhbHNlOwogICAgICB0aGlzLml0ZW1XaW5kb3cuY3Vyc29yVmlzaWJsZSA9IGZhbHNlOwogICAgICB0aGlzLmRlc2NyaXB0aW9uV2luZG93ID0gbmV3IFdpbmRvd19UZXh0KHgsIHRoaXMuaXRlbVdpbmRvdy55ICsgdGhpcy5pdGVtV2luZG93LmhlaWdodCwgdGhpcy50eXBlV2luZG93LndpZHRoLCA1OCAqIFdpbmRvd19CYXNlLnNjYWxlLCB2aWV3cG9ydCk7CiAgICAgIHRoaXMuYWN0aXZlID0gZmFsc2U7CiAgICAgIHRoaXMud2luZG93cy5wdXNoKHRoaXMudHlwZVdpbmRvdyk7CiAgICAgIHRoaXMud2luZG93cy5wdXNoKHRoaXMuaXRlbVdpbmRvdyk7CiAgICAgIHRoaXMud2luZG93cy5wdXNoKHRoaXMuZGVzY3JpcHRpb25XaW5kb3cpOwogICAgfQoKICAgIFdpbmRvd3NldF9Ta2lsbHMucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkgewogICAgICBXaW5kb3dzZXRfU2tpbGxzLl9fc3VwZXJfXy51cGRhdGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgdGhpcy5pdGVtV2luZG93Lm1lbWJlciA9IHRoaXMubWVtYmVyOwogICAgICBpZiAoIXRoaXMuYWN0aXZlKSB7CiAgICAgICAgdGhpcy50eXBlV2luZG93LmFjdGl2ZSA9IGZhbHNlOwogICAgICAgIHRoaXMuaXRlbVdpbmRvdy5hY3RpdmUgPSBmYWxzZTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgaWYgKCF0aGlzLnR5cGVXaW5kb3cuYWN0aXZlICYmICF0aGlzLml0ZW1XaW5kb3cuYWN0aXZlKSB7CiAgICAgICAgdGhpcy50eXBlV2luZG93LmFjdGl2ZSA9IHRydWU7CiAgICAgICAgdGhpcy5pdGVtV2luZG93LmFjdGl2ZSA9IGZhbHNlOwogICAgICAgIHRoaXMuaXRlbVdpbmRvdy5jdXJzb3JWaXNpYmxlID0gZmFsc2U7CiAgICAgIH0KICAgICAgdGhpcy50eXBlV2luZG93LmN1cnNvclZpc2libGUgPSB0aGlzLmFjdGl2ZTsKICAgICAgcmV0dXJuIHRoaXMudHlwZVdpbmRvdy5hY3RpdmUgPSAhdGhpcy5pdGVtV2luZG93LmFjdGl2ZTsKICAgIH07CgogICAgV2luZG93c2V0X1NraWxscy5wcm90b3R5cGUuY2xlYXJEZXNjcmlwdGlvbiA9IGZ1bmN0aW9uKCkgewogICAgICB0aGlzLmRlc2NyaXB0aW9uV2luZG93LnRleHQgPSAiIjsKICAgICAgcmV0dXJuIHRoaXMuZGVzY3JpcHRpb25XaW5kb3cucmVkcmF3KCk7CiAgICB9OwoKICAgIFdpbmRvd3NldF9Ta2lsbHMucHJvdG90eXBlLnJlYnVpbGQgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIHNraWxsVHlwZXMsIHR5cGUsIF9pLCBfbGVuLCBfcmVmOwogICAgICBpZiAodGhpcy5tZW1iZXIgIT0gbnVsbCkgewogICAgICAgIHNraWxsVHlwZXMgPSBbXTsKICAgICAgICBfcmVmID0gdGhpcy5tZW1iZXIuc2tpbGxUeXBlczsKICAgICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICAgIHR5cGUgPSBfcmVmW19pXTsKICAgICAgICAgIGlmICh0eXBlICE9IG51bGwpIHsKICAgICAgICAgICAgc2tpbGxUeXBlcy5wdXNoKHR5cGUpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICB0aGlzLnR5cGVXaW5kb3cucm93c1swXSA9IHNraWxsVHlwZXM7CiAgICAgIH0KICAgICAgcmV0dXJuIHRoaXMub25UeXBlQ2hhbmdlKCk7CiAgICB9OwoKICAgIFdpbmRvd3NldF9Ta2lsbHMucHJvdG90eXBlLnJlZHJhdyA9IGZ1bmN0aW9uKCkgewogICAgICB0aGlzLnR5cGVXaW5kb3cucmVkcmF3KCk7CiAgICAgIHJldHVybiB0aGlzLml0ZW1XaW5kb3cucmVkcmF3KCk7CiAgICB9OwoKICAgIFdpbmRvd3NldF9Ta2lsbHMucHJvdG90eXBlLm9uVHlwZUFjY2VwdCA9IGZ1bmN0aW9uKCkgewogICAgICB0aGlzLnR5cGVXaW5kb3cuYWN0aXZlID0gZmFsc2U7CiAgICAgIHRoaXMuaXRlbVdpbmRvdy5hY3RpdmUgPSB0cnVlOwogICAgICByZXR1cm4gdGhpcy5pdGVtV2luZG93LmN1cnNvclZpc2libGUgPSB0cnVlOwogICAgfTsKCiAgICBXaW5kb3dzZXRfU2tpbGxzLnByb3RvdHlwZS5vblR5cGVDYW5jZWwgPSBmdW5jdGlvbigpIHsKICAgICAgdGhpcy50eXBlV2luZG93LmFjdGl2ZSA9IGZhbHNlOwogICAgICB0aGlzLnR5cGVXaW5kb3cuY3Vyc29yVmlzaWJsZSA9IGZhbHNlOwogICAgICB0aGlzLmFjdGl2ZSA9IGZhbHNlOwogICAgICBpZiAodGhpcy5vbkNhbmNlbCAhPSBudWxsKSB7CiAgICAgICAgcmV0dXJuIHRoaXMub25DYW5jZWwoKTsKICAgICAgfQogICAgfTsKCiAgICBXaW5kb3dzZXRfU2tpbGxzLnByb3RvdHlwZS5vblR5cGVDaGFuZ2UgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGNvbHVtbiwgaXRlbXMsIHJvdywgcm93czsKICAgICAgaXRlbXMgPSBudWxsOwogICAgICByb3dzID0gW107CiAgICAgIHJvdyA9IDA7CiAgICAgIGNvbHVtbiA9IDA7CiAgICAgIGlmICh0aGlzLnR5cGVXaW5kb3cuc2VsZWN0ZWRDZWxsID09IG51bGwpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdGhpcy5pdGVtV2luZG93LnR5cGUgPSB0aGlzLnR5cGVXaW5kb3cuc2VsZWN0ZWRDZWxsLmluZGV4OwogICAgICB0aGlzLml0ZW1XaW5kb3cubWVtYmVyID0gdGhpcy5tZW1iZXI7CiAgICAgIHRoaXMuaXRlbVdpbmRvdy5yZWJ1aWxkUm93cygpOwogICAgICByZXR1cm4gdGhpcy5pdGVtV2luZG93LnJlZHJhdygpOwogICAgfTsKCiAgICBXaW5kb3dzZXRfU2tpbGxzLnByb3RvdHlwZS5vbkl0ZW1BY2NlcHQgPSBmdW5jdGlvbigpIHsKICAgICAgaWYgKHRoaXMub25Ta2lsbFNlbGVjdGlvbiAhPSBudWxsKSB7CiAgICAgICAgdGhpcy5zZWxlY3RlZFNraWxsID0gdGhpcy5pdGVtV2luZG93LnNlbGVjdGVkQ2VsbDsKICAgICAgICByZXR1cm4gdGhpcy5vblNraWxsU2VsZWN0aW9uKHRoaXMuaXRlbVdpbmRvdy5zZWxlY3RlZENlbGwpOwogICAgICB9CiAgICB9OwoKICAgIFdpbmRvd3NldF9Ta2lsbHMucHJvdG90eXBlLm9uSXRlbUNhbmNlbCA9IGZ1bmN0aW9uKCkgewogICAgICB0aGlzLnR5cGVXaW5kb3cuYWN0aXZlID0gdHJ1ZTsKICAgICAgdGhpcy5pdGVtV2luZG93LmFjdGl2ZSA9IGZhbHNlOwogICAgICB0aGlzLml0ZW1XaW5kb3cuY3Vyc29yVmlzaWJsZSA9IGZhbHNlOwogICAgICByZXR1cm4gdGhpcy5jbGVhckRlc2NyaXB0aW9uKCk7CiAgICB9OwoKICAgIFdpbmRvd3NldF9Ta2lsbHMucHJvdG90eXBlLm9uSXRlbUNoYW5nZSA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgY2VsbDsKICAgICAgY2VsbCA9IHRoaXMuaXRlbVdpbmRvdy5zZWxlY3RlZENlbGw7CiAgICAgIGlmIChjZWxsICE9IG51bGwpIHsKICAgICAgICB0aGlzLmRlc2NyaXB0aW9uV2luZG93LnRleHQgPSBjZWxsLmRlc2NyaXB0aW9uOwogICAgICAgIHJldHVybiB0aGlzLmRlc2NyaXB0aW9uV2luZG93LnJlZHJhdygpOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiB0aGlzLmNsZWFyRGVzY3JpcHRpb24oKTsKICAgICAgfQogICAgfTsKCiAgICByZXR1cm4gV2luZG93c2V0X1NraWxsczsKCiAgfSkoV2luZG93c2V0X0Jhc2UpOwoKICB3aW5kb3cuV2luZG93c2V0X1NraWxscyA9IFdpbmRvd3NldF9Ta2lsbHM7Cgp9KS5jYWxsKHRoaXMpOwo="},{"name":"Windowset_Equipment","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogV2luZG93c2V0X0VxdWlwbWVudAojICAgQ3JlYXRlZCBvbjogMjAxMy0wOS0yMgojCiMgICBDb3B5cmlnaHQgKEMpIDIwMTMgQW5kcukgUmFkb21za2kuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgICBDbGFzczogV2luZG93c2V0X0VxdWlwbWVudAojCiMgICBBIHdpbmRvdyB3aGljaCBkaXNwbGF5cyB0aGUgd2luZG93cyBuZWVkZWQgZm9yIGVxdWlwbWVudCBzZWxlY3Rpb24KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCmNsYXNzIFdpbmRvd3NldF9FcXVpcG1lbnQgZXh0ZW5kcyBXaW5kb3dzZXRfQmFzZQogICAgY29uc3RydWN0b3I6ICh4LCB5KSAtPgogICAgICAgIHN1cGVyCiAgICAgICAgQG1lbWJlciA9IG51bGwKICAgICAgICBAcGFyYW1ldGVyV2luZG93ID0gbmV3IFdpbmRvd19QYXJhbWV0ZXIoeCwgeSwgMTYwICogV2luZG93X0Jhc2Uuc2NhbGUsIDE4MCAqIFdpbmRvd19CYXNlLnNjYWxlKQogICAgICAgIEBlcXVpcHBlZFdpbmRvdyA9IG5ldyBXaW5kb3dfRXF1aXBtZW50KHggKyBAcGFyYW1ldGVyV2luZG93LndpZHRoLCB5KQogICAgICAgIEBlcXVpcHBlZFdpbmRvdy5oZWlnaHQgPSAxODAgKiBXaW5kb3dfQmFzZS5zY2FsZQogICAgICAgIEBlcXVpcHBlZFdpbmRvdy5hY3RpdmUgPSBubwogICAgICAgIEBlcXVpcHBlZFdpbmRvdy5jdXJzb3JWaXNpYmxlID0gbm8KICAgICAgICBAZXF1aXBwZWRXaW5kb3cub25TZWxlY3Rpb25DaGFuZ2UgPSA9PiBAb25TbG90Q2hhbmdlKCkKICAgICAgICBAZXF1aXBwZWRXaW5kb3cub25TZWxlY3Rpb25BY2NlcHQgPSA9PiBAb25TbG90QWNjZXB0KCkKICAgICAgICBAZXF1aXBwZWRXaW5kb3cub25DYW5jZWwgPSA9PiBAb25TbG90Q2FuY2VsKCkKICAgICAgICBAZXF1aXBtZW50V2luZG93ID0gbmV3IFdpbmRvd19JdGVtcyh4LCB5ICsgQHBhcmFtZXRlcldpbmRvdy5oZWlnaHQsIDIsIFtdLCAyMjEgKiBXaW5kb3dfQmFzZS5zY2FsZSwgMjUgKiBXaW5kb3dfQmFzZS5zY2FsZSkKICAgICAgICBAZXF1aXBtZW50V2luZG93Lm9uU2VsZWN0aW9uQ2hhbmdlID0gPT4gQG9uSXRlbUNoYW5nZSgpCiAgICAgICAgQGVxdWlwbWVudFdpbmRvdy5vblNlbGVjdGlvbkFjY2VwdCA9ID0+IEBvbkl0ZW1BY2NlcHQoKQogICAgICAgIEBlcXVpcG1lbnRXaW5kb3cub25DYW5jZWwgPSA9PiBAb25JdGVtQ2FuY2VsKCkKICAgICAgICBAZXF1aXBtZW50V2luZG93LmhlaWdodCA9IDEyOCAqIFdpbmRvd19CYXNlLnNjYWxlCiAgICAgICAgQGVxdWlwbWVudFdpbmRvdy5hY3RpdmUgPSBubwogICAgICAgIEBlcXVpcG1lbnRXaW5kb3cuY3Vyc29yVmlzaWJsZSA9IG5vCiAgICAgICAgQGRlc2NyaXB0aW9uV2luZG93ID0gbmV3IFdpbmRvd19UZXh0KHgsIEBlcXVpcG1lbnRXaW5kb3cueSArIEBlcXVpcG1lbnRXaW5kb3cuaGVpZ2h0LCBAZXF1aXBtZW50V2luZG93LndpZHRoLCA1OCAqIFdpbmRvd19CYXNlLnNjYWxlKQogICAgICAgIEB3aW5kb3dzLnB1c2goQHBhcmFtZXRlcldpbmRvdykKICAgICAgICBAd2luZG93cy5wdXNoKEBlcXVpcHBlZFdpbmRvdykKICAgICAgICBAd2luZG93cy5wdXNoKEBlcXVpcG1lbnRXaW5kb3cpCiAgICAgICAgQHdpbmRvd3MucHVzaChAZGVzY3JpcHRpb25XaW5kb3cpCiAgICAgICAgICAgICAgICAKICAgICAgICBAZXF1aXBwZWRXaW5kb3cuY29udGVudHMuZm9udCA9IEBwYXJhbWV0ZXJXaW5kb3cubmFtZUZvbnQKICAgICAgICBAYWN0aXZlID0gbm8KICAgICAgICBAY3VycmVudEl0ZW0gPSBudWxsCiAgICByZWRyYXc6IC0+CiAgICAgICAgaWYgbm90IEBtZW1iZXI/IHRoZW4gcmV0dXJuCiAgICAgICAgICAgICAgICAKICAgICAgICAjIERyYXcgcGFyYW1ldGVycwogICAgICAgIEBwYXJhbWV0ZXJXaW5kb3cubWVtYmVyID0gQG1lbWJlcgogICAgICAgIEBwYXJhbWV0ZXJXaW5kb3cuY3VycmVudEl0ZW0gID0gQGN1cnJlbnRJdGVtCiAgICAgICAgQHBhcmFtZXRlcldpbmRvdy5lcXVpcHBlZEl0ZW0gPSBAZXF1aXBwZWRJdGVtCiAgICAgICAgQHBhcmFtZXRlcldpbmRvdy5wcmV2aWV3ID0gQGVxdWlwbWVudFdpbmRvdy5hY3RpdmUgYW5kIEBlcXVpcG1lbnRXaW5kb3cudmFsaWRhdGVTZWxlY3RlZENlbGwoKQogICAgICAgIEBwYXJhbWV0ZXJXaW5kb3cucmVkcmF3KCkKICAgICAgICAKICAgICAgICAjIERyYXcgZXF1aXBwZWQgaXRlbXMKICAgICAgICBAZXF1aXBwZWRXaW5kb3cubWVtYmVyID0gQG1lbWJlcgogICAgICAgIEBlcXVpcHBlZFdpbmRvdy5yZWRyYXcoKQogICAgICAgIAogICAgdXBkYXRlOiAtPgogICAgICAgIEBlcXVpcHBlZFdpbmRvdy51cGRhdGUoKQogICAgICAgIEBwYXJhbWV0ZXJXaW5kb3cudXBkYXRlKCkKICAgICAgICBAZXF1aXBtZW50V2luZG93LnVwZGF0ZSgpCiAgICAgICAgQGRlc2NyaXB0aW9uV2luZG93LnVwZGF0ZSgpCiAgICAgICAgCiAgICAgICAgaWYgbm90IEBhY3RpdmUgdGhlbiByZXR1cm4KICAgICAgICAKICAgICAgICBAZXF1aXBtZW50V2luZG93Lm1lbWJlciA9IEBtZW1iZXIKICAgICAgICBAZXF1aXBwZWRXaW5kb3cuY3Vyc29yVmlzaWJsZSA9IEBhY3RpdmUKICAgICAgICBAZXF1aXBwZWRXaW5kb3cuYWN0aXZlID0gIUBlcXVpcG1lbnRXaW5kb3cuYWN0aXZlCiAgICBjbGVhckRlc2NyaXB0aW9uOiAtPgogICAgICAgIEBkZXNjcmlwdGlvbldpbmRvdy50ZXh0ID0gIiIKICAgICAgICBAZGVzY3JpcHRpb25XaW5kb3cucmVkcmF3KCkKICAgICAgICAKICAgIG9uU2xvdENoYW5nZTogLT4KICAgICAgICBpZiBAZXF1aXBwZWRXaW5kb3cuc2VsZWN0ZWRSb3cgPT0gMAogICAgICAgICAgICBAZXF1aXBtZW50V2luZG93LnR5cGUgPSAxCiAgICAgICAgZWxzZQogICAgICAgICAgICBAZXF1aXBtZW50V2luZG93LnR5cGUgPSAyCiAgICAgICAgICAgIEBlcXVpcG1lbnRXaW5kb3cuZXF1aXBUeXBlID0gQGVxdWlwcGVkV2luZG93LnNlbGVjdGVkUm93IC0gMQoKICAgICAgICBAZXF1aXBwZWRJdGVtID0gQG1lbWJlci5lcXVpcHBlZEl0ZW0oQGVxdWlwcGVkV2luZG93LnNlbGVjdGVkUm93KQogICAgICAgIEBlcXVpcG1lbnRXaW5kb3cucmVidWlsZFJvd3MoKQogICAgICAgIEBlcXVpcG1lbnRXaW5kb3cucmVkcmF3KCkKICAgICAgICAKICAgICAgICAKICAgIG9uU2xvdEFjY2VwdDogLT4KICAgICAgICBAZXF1aXBwZWRXaW5kb3cuYWN0aXZlID0gbm8KICAgICAgICBAZXF1aXBtZW50V2luZG93LmFjdGl2ZSA9IHllcwogICAgICAgIEBlcXVpcG1lbnRXaW5kb3cuY3Vyc29yVmlzaWJsZSA9IHllcwogICAgb25TbG90Q2FuY2VsOiAtPgogICAgICAgIEBlcXVpcHBlZFdpbmRvdy5hY3RpdmUgPSBubwogICAgICAgIEBlcXVpcHBlZFdpbmRvdy5jdXJzb3JWaXNpYmxlID0gbm8KICAgICAgICBAYWN0aXZlID0gbm8KICAgICAgICBpZiBAb25DYW5jZWw/IHRoZW4gQG9uQ2FuY2VsKCkKICAgICAgICAKICAgIG9uSXRlbUNoYW5nZTogLT4KICAgICAgICBjZWxsID0gQGVxdWlwbWVudFdpbmRvdy5zZWxlY3RlZENlbGwKICAgICAgIAogICAgICAgIGlmIGNlbGw/CiAgICAgICAgICAgIEBjdXJyZW50SXRlbSA9IGlmIGNlbGwuZW1wdHkgdGhlbiBudWxsIGVsc2UgY2VsbC5pdGVtCiAgICAgICAgICAgIEBkZXNjcmlwdGlvbldpbmRvdy50ZXh0ID0gaWYgQGN1cnJlbnRJdGVtPyB0aGVuIEBjdXJyZW50SXRlbS5kZXNjcmlwdGlvbiBlbHNlIG51bGwKICAgICAgICAgICAgQGRlc2NyaXB0aW9uV2luZG93LnJlZHJhdygpCiAgICAgICAgICAgIEByZWRyYXcoKQogICAgICAgIGVsc2UKICAgICAgICAgICAgQGNsZWFyRGVzY3JpcHRpb24oKQogICAgICAgICAgICAKICAgIG9uSXRlbUFjY2VwdDogLT4KICAgICAgICBAZXF1aXBTZWxlY3RlZEl0ZW0oKQogICAgICAgIEBlcXVpcHBlZFdpbmRvdy5hY3RpdmUgPSB5ZXMKICAgICAgICBAZXF1aXBtZW50V2luZG93LmFjdGl2ZSA9IG5vCiAgICAgICAgQGVxdWlwbWVudFdpbmRvdy5jdXJzb3JWaXNpYmxlID0gbm8KICAgICAgICBAY3VycmVudEl0ZW0gPSBudWxsCiAgICAgICAgQGVxdWlwcGVkSXRlbSA9IEBtZW1iZXIuZXF1aXBwZWRJdGVtKEBlcXVpcHBlZFdpbmRvdy5zZWxlY3RlZFJvdykKICAgICAgICBAcmVkcmF3KCkKICAgICAgICBAY2xlYXJEZXNjcmlwdGlvbigpCiAgICAgICAgCiAgICBvbkl0ZW1DYW5jZWw6IC0+CiAgICAgICAgQGVxdWlwcGVkV2luZG93LmFjdGl2ZSA9IHllcwogICAgICAgIEBlcXVpcG1lbnRXaW5kb3cuYWN0aXZlID0gbm8KICAgICAgICBAZXF1aXBtZW50V2luZG93LmN1cnNvclZpc2libGUgPSBubwogICAgICAgIEBjdXJyZW50SXRlbSA9IG51bGwKICAgICAgICBAZXF1aXBtZW50V2luZG93LnNlbGVjdGVkQ2VsbCA9IG51bGwKICAgICAgICBAcmVkcmF3KCkKICAgICAgICBAY2xlYXJEZXNjcmlwdGlvbigpCiAgICAgICAgCiAgICAgICAgCiAgICBlcXVpcFNlbGVjdGVkSXRlbTogLT4KICAgICAgICBjZWxsID0gQGVxdWlwbWVudFdpbmRvdy5zZWxlY3RlZENlbGwKICAgICAgICAKICAgICAgICBzd2l0Y2ggQGVxdWlwcGVkV2luZG93LnNlbGVjdGVkUm93CiAgICAgICAgICAgIHdoZW4gMAogICAgICAgICAgICAgICAgaWYgQG1lbWJlci53ZWFwb24/IAogICAgICAgICAgICAgICAgICAgIEdhbWVNYW5hZ2VyLmludmVudG9yeS5hZGRJdGVtKEBtZW1iZXIud2VhcG9uLCAxKQogICAgICAgICAgICAgICAgICAgICNHYW1lTWFuYWdlci5pbnZlbnRvcnkud2VhcG9uc1tAbWVtYmVyLndlYXBvbi5pbmRleF0uY291bnQrKwogICAgICAgICAgICAgICAgQG1lbWJlci53ZWFwb24gPSBpZiBjZWxsPyBhbmQgbm90IGNlbGwuZW1wdHkgdGhlbiBjZWxsLml0ZW0gZWxzZSBudWxsCiAgICAgICAgICAgIHdoZW4gMQogICAgICAgICAgICAgICAgaWYgQG1lbWJlci5zaGllbGQ/IAogICAgICAgICAgICAgICAgICAgIEdhbWVNYW5hZ2VyLmludmVudG9yeS5hZGRJdGVtKEBtZW1iZXIuc2hpZWxkLCAxKQogICAgICAgICAgICAgICAgICAgICNHYW1lTWFuYWdlci5pbnZlbnRvcnkuYXJtb3JzW0BtZW1iZXIuc2hpZWxkLmluZGV4XS5jb3VudCsrCiAgICAgICAgICAgICAgICBAbWVtYmVyLnNoaWVsZCA9IGlmIGNlbGw/IGFuZCBub3QgY2VsbC5lbXB0eSB0aGVuIGNlbGwuaXRlbSBlbHNlIG51bGwKICAgICAgICAgICAgd2hlbiAyCiAgICAgICAgICAgICAgICBpZiBAbWVtYmVyLmhlYWQ/IAogICAgICAgICAgICAgICAgICAgIEdhbWVNYW5hZ2VyLmludmVudG9yeS5hZGRJdGVtKEBtZW1iZXIuaGVhZCwgMSkKICAgICAgICAgICAgICAgICAgICAjR2FtZU1hbmFnZXIuaW52ZW50b3J5LmFybW9yc1tAbWVtYmVyLmhlYWQuaW5kZXhdLmNvdW50KysKICAgICAgICAgICAgICAgIEBtZW1iZXIuaGVhZCA9IGlmIGNlbGw/IGFuZCBub3QgY2VsbC5lbXB0eSB0aGVuIGNlbGwuaXRlbSBlbHNlIG51bGwKICAgICAgICAgICAgd2hlbiAzIAogICAgICAgICAgICAgICAgaWYgQG1lbWJlci5ib2R5PyAKICAgICAgICAgICAgICAgICAgICBHYW1lTWFuYWdlci5pbnZlbnRvcnkuYWRkSXRlbShAbWVtYmVyLmJvZHksIDEpCiAgICAgICAgICAgICAgICAgICAgI0dhbWVNYW5hZ2VyLmludmVudG9yeS5hcm1vcnNbQG1lbWJlci5ib2R5LmluZGV4XS5jb3VudCsrCiAgICAgICAgICAgICAgICBAbWVtYmVyLmJvZHkgPSBpZiBjZWxsPyBhbmQgbm90IGNlbGwuZW1wdHkgdGhlbiBjZWxsLml0ZW0gZWxzZSBudWxsCiAgICAgICAgICAgIHdoZW4gNAogICAgICAgICAgICAgICAgaWYgQG1lbWJlci5hY2Nlc3Nvcnk/IAogICAgICAgICAgICAgICAgICAgIEdhbWVNYW5hZ2VyLmludmVudG9yeS5hZGRJdGVtKEBtZW1iZXIuYWNjZXNzb3J5LCAxKQogICAgICAgICAgICAgICAgICAgICNHYW1lTWFuYWdlci5pbnZlbnRvcnkuYXJtb3JzW0BtZW1iZXIuYWNjZXNzb3J5LmluZGV4XS5jb3VudCsrCiAgICAgICAgCiAgICAgICAgICAgICAgICBAbWVtYmVyLmFjY2Vzc29yeSA9IGlmIGNlbGw/IGFuZCBub3QgY2VsbC5lbXB0eSB0aGVuIGNlbGwuaXRlbSBlbHNlIG51bGwKICAgICAgICBAbWVtYmVyLnJlZnJlc2goKSAgICAgICAKICAgICAgICBpZiBjZWxsPyB0aGVuIGNlbGwuY291bnQtLQogICAgICAgIAogICAgICAgIEBlcXVpcHBlZFdpbmRvdy5yZWRyYXcoKQogICAgICAgIEBlcXVpcG1lbnRXaW5kb3cucmVidWlsZFJvd3MoKQogICAgICAgIEBlcXVpcG1lbnRXaW5kb3cucmVkcmF3KCkKICAgICAgICAKICAgICAgICBpZiBAb25FcXVpcG1lbnRDaGFuZ2U/CiAgICAgICAgICAgIEBvbkVxdWlwbWVudENoYW5nZSh0aGlzKQogICAgICAgIAp3aW5kb3cuV2luZG93c2V0X0VxdWlwbWVudCA9IFdpbmRvd3NldF9FcXVpcG1lbnQ=","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBXaW5kb3dzZXRfRXF1aXBtZW50LAogICAgX19oYXNQcm9wID0ge30uaGFzT3duUHJvcGVydHksCiAgICBfX2V4dGVuZHMgPSBmdW5jdGlvbihjaGlsZCwgcGFyZW50KSB7IGZvciAodmFyIGtleSBpbiBwYXJlbnQpIHsgaWYgKF9faGFzUHJvcC5jYWxsKHBhcmVudCwga2V5KSkgY2hpbGRba2V5XSA9IHBhcmVudFtrZXldOyB9IGZ1bmN0aW9uIGN0b3IoKSB7IHRoaXMuY29uc3RydWN0b3IgPSBjaGlsZDsgfSBjdG9yLnByb3RvdHlwZSA9IHBhcmVudC5wcm90b3R5cGU7IGNoaWxkLnByb3RvdHlwZSA9IG5ldyBjdG9yKCk7IGNoaWxkLl9fc3VwZXJfXyA9IHBhcmVudC5wcm90b3R5cGU7IHJldHVybiBjaGlsZDsgfTsKCiAgV2luZG93c2V0X0VxdWlwbWVudCA9IChmdW5jdGlvbihfc3VwZXIpIHsKICAgIF9fZXh0ZW5kcyhXaW5kb3dzZXRfRXF1aXBtZW50LCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFdpbmRvd3NldF9FcXVpcG1lbnQoeCwgeSkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICBXaW5kb3dzZXRfRXF1aXBtZW50Ll9fc3VwZXJfXy5jb25zdHJ1Y3Rvci5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB0aGlzLm1lbWJlciA9IG51bGw7CiAgICAgIHRoaXMucGFyYW1ldGVyV2luZG93ID0gbmV3IFdpbmRvd19QYXJhbWV0ZXIoeCwgeSwgMTYwICogV2luZG93X0Jhc2Uuc2NhbGUsIDE4MCAqIFdpbmRvd19CYXNlLnNjYWxlKTsKICAgICAgdGhpcy5lcXVpcHBlZFdpbmRvdyA9IG5ldyBXaW5kb3dfRXF1aXBtZW50KHggKyB0aGlzLnBhcmFtZXRlcldpbmRvdy53aWR0aCwgeSk7CiAgICAgIHRoaXMuZXF1aXBwZWRXaW5kb3cuaGVpZ2h0ID0gMTgwICogV2luZG93X0Jhc2Uuc2NhbGU7CiAgICAgIHRoaXMuZXF1aXBwZWRXaW5kb3cuYWN0aXZlID0gZmFsc2U7CiAgICAgIHRoaXMuZXF1aXBwZWRXaW5kb3cuY3Vyc29yVmlzaWJsZSA9IGZhbHNlOwogICAgICB0aGlzLmVxdWlwcGVkV2luZG93Lm9uU2VsZWN0aW9uQ2hhbmdlID0gZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIF90aGlzLm9uU2xvdENoYW5nZSgpOwogICAgICB9OwogICAgICB0aGlzLmVxdWlwcGVkV2luZG93Lm9uU2VsZWN0aW9uQWNjZXB0ID0gZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIF90aGlzLm9uU2xvdEFjY2VwdCgpOwogICAgICB9OwogICAgICB0aGlzLmVxdWlwcGVkV2luZG93Lm9uQ2FuY2VsID0gZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIF90aGlzLm9uU2xvdENhbmNlbCgpOwogICAgICB9OwogICAgICB0aGlzLmVxdWlwbWVudFdpbmRvdyA9IG5ldyBXaW5kb3dfSXRlbXMoeCwgeSArIHRoaXMucGFyYW1ldGVyV2luZG93LmhlaWdodCwgMiwgW10sIDIyMSAqIFdpbmRvd19CYXNlLnNjYWxlLCAyNSAqIFdpbmRvd19CYXNlLnNjYWxlKTsKICAgICAgdGhpcy5lcXVpcG1lbnRXaW5kb3cub25TZWxlY3Rpb25DaGFuZ2UgPSBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gX3RoaXMub25JdGVtQ2hhbmdlKCk7CiAgICAgIH07CiAgICAgIHRoaXMuZXF1aXBtZW50V2luZG93Lm9uU2VsZWN0aW9uQWNjZXB0ID0gZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIF90aGlzLm9uSXRlbUFjY2VwdCgpOwogICAgICB9OwogICAgICB0aGlzLmVxdWlwbWVudFdpbmRvdy5vbkNhbmNlbCA9IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBfdGhpcy5vbkl0ZW1DYW5jZWwoKTsKICAgICAgfTsKICAgICAgdGhpcy5lcXVpcG1lbnRXaW5kb3cuaGVpZ2h0ID0gMTI4ICogV2luZG93X0Jhc2Uuc2NhbGU7CiAgICAgIHRoaXMuZXF1aXBtZW50V2luZG93LmFjdGl2ZSA9IGZhbHNlOwogICAgICB0aGlzLmVxdWlwbWVudFdpbmRvdy5jdXJzb3JWaXNpYmxlID0gZmFsc2U7CiAgICAgIHRoaXMuZGVzY3JpcHRpb25XaW5kb3cgPSBuZXcgV2luZG93X1RleHQoeCwgdGhpcy5lcXVpcG1lbnRXaW5kb3cueSArIHRoaXMuZXF1aXBtZW50V2luZG93LmhlaWdodCwgdGhpcy5lcXVpcG1lbnRXaW5kb3cud2lkdGgsIDU4ICogV2luZG93X0Jhc2Uuc2NhbGUpOwogICAgICB0aGlzLndpbmRvd3MucHVzaCh0aGlzLnBhcmFtZXRlcldpbmRvdyk7CiAgICAgIHRoaXMud2luZG93cy5wdXNoKHRoaXMuZXF1aXBwZWRXaW5kb3cpOwogICAgICB0aGlzLndpbmRvd3MucHVzaCh0aGlzLmVxdWlwbWVudFdpbmRvdyk7CiAgICAgIHRoaXMud2luZG93cy5wdXNoKHRoaXMuZGVzY3JpcHRpb25XaW5kb3cpOwogICAgICB0aGlzLmVxdWlwcGVkV2luZG93LmNvbnRlbnRzLmZvbnQgPSB0aGlzLnBhcmFtZXRlcldpbmRvdy5uYW1lRm9udDsKICAgICAgdGhpcy5hY3RpdmUgPSBmYWxzZTsKICAgICAgdGhpcy5jdXJyZW50SXRlbSA9IG51bGw7CiAgICB9CgogICAgV2luZG93c2V0X0VxdWlwbWVudC5wcm90b3R5cGUucmVkcmF3ID0gZnVuY3Rpb24oKSB7CiAgICAgIGlmICh0aGlzLm1lbWJlciA9PSBudWxsKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHRoaXMucGFyYW1ldGVyV2luZG93Lm1lbWJlciA9IHRoaXMubWVtYmVyOwogICAgICB0aGlzLnBhcmFtZXRlcldpbmRvdy5jdXJyZW50SXRlbSA9IHRoaXMuY3VycmVudEl0ZW07CiAgICAgIHRoaXMucGFyYW1ldGVyV2luZG93LmVxdWlwcGVkSXRlbSA9IHRoaXMuZXF1aXBwZWRJdGVtOwogICAgICB0aGlzLnBhcmFtZXRlcldpbmRvdy5wcmV2aWV3ID0gdGhpcy5lcXVpcG1lbnRXaW5kb3cuYWN0aXZlICYmIHRoaXMuZXF1aXBtZW50V2luZG93LnZhbGlkYXRlU2VsZWN0ZWRDZWxsKCk7CiAgICAgIHRoaXMucGFyYW1ldGVyV2luZG93LnJlZHJhdygpOwogICAgICB0aGlzLmVxdWlwcGVkV2luZG93Lm1lbWJlciA9IHRoaXMubWVtYmVyOwogICAgICByZXR1cm4gdGhpcy5lcXVpcHBlZFdpbmRvdy5yZWRyYXcoKTsKICAgIH07CgogICAgV2luZG93c2V0X0VxdWlwbWVudC5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMuZXF1aXBwZWRXaW5kb3cudXBkYXRlKCk7CiAgICAgIHRoaXMucGFyYW1ldGVyV2luZG93LnVwZGF0ZSgpOwogICAgICB0aGlzLmVxdWlwbWVudFdpbmRvdy51cGRhdGUoKTsKICAgICAgdGhpcy5kZXNjcmlwdGlvbldpbmRvdy51cGRhdGUoKTsKICAgICAgaWYgKCF0aGlzLmFjdGl2ZSkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICB0aGlzLmVxdWlwbWVudFdpbmRvdy5tZW1iZXIgPSB0aGlzLm1lbWJlcjsKICAgICAgdGhpcy5lcXVpcHBlZFdpbmRvdy5jdXJzb3JWaXNpYmxlID0gdGhpcy5hY3RpdmU7CiAgICAgIHJldHVybiB0aGlzLmVxdWlwcGVkV2luZG93LmFjdGl2ZSA9ICF0aGlzLmVxdWlwbWVudFdpbmRvdy5hY3RpdmU7CiAgICB9OwoKICAgIFdpbmRvd3NldF9FcXVpcG1lbnQucHJvdG90eXBlLmNsZWFyRGVzY3JpcHRpb24gPSBmdW5jdGlvbigpIHsKICAgICAgdGhpcy5kZXNjcmlwdGlvbldpbmRvdy50ZXh0ID0gIiI7CiAgICAgIHJldHVybiB0aGlzLmRlc2NyaXB0aW9uV2luZG93LnJlZHJhdygpOwogICAgfTsKCiAgICBXaW5kb3dzZXRfRXF1aXBtZW50LnByb3RvdHlwZS5vblNsb3RDaGFuZ2UgPSBmdW5jdGlvbigpIHsKICAgICAgaWYgKHRoaXMuZXF1aXBwZWRXaW5kb3cuc2VsZWN0ZWRSb3cgPT09IDApIHsKICAgICAgICB0aGlzLmVxdWlwbWVudFdpbmRvdy50eXBlID0gMTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmVxdWlwbWVudFdpbmRvdy50eXBlID0gMjsKICAgICAgICB0aGlzLmVxdWlwbWVudFdpbmRvdy5lcXVpcFR5cGUgPSB0aGlzLmVxdWlwcGVkV2luZG93LnNlbGVjdGVkUm93IC0gMTsKICAgICAgfQogICAgICB0aGlzLmVxdWlwcGVkSXRlbSA9IHRoaXMubWVtYmVyLmVxdWlwcGVkSXRlbSh0aGlzLmVxdWlwcGVkV2luZG93LnNlbGVjdGVkUm93KTsKICAgICAgdGhpcy5lcXVpcG1lbnRXaW5kb3cucmVidWlsZFJvd3MoKTsKICAgICAgcmV0dXJuIHRoaXMuZXF1aXBtZW50V2luZG93LnJlZHJhdygpOwogICAgfTsKCiAgICBXaW5kb3dzZXRfRXF1aXBtZW50LnByb3RvdHlwZS5vblNsb3RBY2NlcHQgPSBmdW5jdGlvbigpIHsKICAgICAgdGhpcy5lcXVpcHBlZFdpbmRvdy5hY3RpdmUgPSBmYWxzZTsKICAgICAgdGhpcy5lcXVpcG1lbnRXaW5kb3cuYWN0aXZlID0gdHJ1ZTsKICAgICAgcmV0dXJuIHRoaXMuZXF1aXBtZW50V2luZG93LmN1cnNvclZpc2libGUgPSB0cnVlOwogICAgfTsKCiAgICBXaW5kb3dzZXRfRXF1aXBtZW50LnByb3RvdHlwZS5vblNsb3RDYW5jZWwgPSBmdW5jdGlvbigpIHsKICAgICAgdGhpcy5lcXVpcHBlZFdpbmRvdy5hY3RpdmUgPSBmYWxzZTsKICAgICAgdGhpcy5lcXVpcHBlZFdpbmRvdy5jdXJzb3JWaXNpYmxlID0gZmFsc2U7CiAgICAgIHRoaXMuYWN0aXZlID0gZmFsc2U7CiAgICAgIGlmICh0aGlzLm9uQ2FuY2VsICE9IG51bGwpIHsKICAgICAgICByZXR1cm4gdGhpcy5vbkNhbmNlbCgpOwogICAgICB9CiAgICB9OwoKICAgIFdpbmRvd3NldF9FcXVpcG1lbnQucHJvdG90eXBlLm9uSXRlbUNoYW5nZSA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgY2VsbDsKICAgICAgY2VsbCA9IHRoaXMuZXF1aXBtZW50V2luZG93LnNlbGVjdGVkQ2VsbDsKICAgICAgaWYgKGNlbGwgIT0gbnVsbCkgewogICAgICAgIHRoaXMuY3VycmVudEl0ZW0gPSBjZWxsLmVtcHR5ID8gbnVsbCA6IGNlbGwuaXRlbTsKICAgICAgICB0aGlzLmRlc2NyaXB0aW9uV2luZG93LnRleHQgPSB0aGlzLmN1cnJlbnRJdGVtICE9IG51bGwgPyB0aGlzLmN1cnJlbnRJdGVtLmRlc2NyaXB0aW9uIDogbnVsbDsKICAgICAgICB0aGlzLmRlc2NyaXB0aW9uV2luZG93LnJlZHJhdygpOwogICAgICAgIHJldHVybiB0aGlzLnJlZHJhdygpOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiB0aGlzLmNsZWFyRGVzY3JpcHRpb24oKTsKICAgICAgfQogICAgfTsKCiAgICBXaW5kb3dzZXRfRXF1aXBtZW50LnByb3RvdHlwZS5vbkl0ZW1BY2NlcHQgPSBmdW5jdGlvbigpIHsKICAgICAgdGhpcy5lcXVpcFNlbGVjdGVkSXRlbSgpOwogICAgICB0aGlzLmVxdWlwcGVkV2luZG93LmFjdGl2ZSA9IHRydWU7CiAgICAgIHRoaXMuZXF1aXBtZW50V2luZG93LmFjdGl2ZSA9IGZhbHNlOwogICAgICB0aGlzLmVxdWlwbWVudFdpbmRvdy5jdXJzb3JWaXNpYmxlID0gZmFsc2U7CiAgICAgIHRoaXMuY3VycmVudEl0ZW0gPSBudWxsOwogICAgICB0aGlzLmVxdWlwcGVkSXRlbSA9IHRoaXMubWVtYmVyLmVxdWlwcGVkSXRlbSh0aGlzLmVxdWlwcGVkV2luZG93LnNlbGVjdGVkUm93KTsKICAgICAgdGhpcy5yZWRyYXcoKTsKICAgICAgcmV0dXJuIHRoaXMuY2xlYXJEZXNjcmlwdGlvbigpOwogICAgfTsKCiAgICBXaW5kb3dzZXRfRXF1aXBtZW50LnByb3RvdHlwZS5vbkl0ZW1DYW5jZWwgPSBmdW5jdGlvbigpIHsKICAgICAgdGhpcy5lcXVpcHBlZFdpbmRvdy5hY3RpdmUgPSB0cnVlOwogICAgICB0aGlzLmVxdWlwbWVudFdpbmRvdy5hY3RpdmUgPSBmYWxzZTsKICAgICAgdGhpcy5lcXVpcG1lbnRXaW5kb3cuY3Vyc29yVmlzaWJsZSA9IGZhbHNlOwogICAgICB0aGlzLmN1cnJlbnRJdGVtID0gbnVsbDsKICAgICAgdGhpcy5lcXVpcG1lbnRXaW5kb3cuc2VsZWN0ZWRDZWxsID0gbnVsbDsKICAgICAgdGhpcy5yZWRyYXcoKTsKICAgICAgcmV0dXJuIHRoaXMuY2xlYXJEZXNjcmlwdGlvbigpOwogICAgfTsKCiAgICBXaW5kb3dzZXRfRXF1aXBtZW50LnByb3RvdHlwZS5lcXVpcFNlbGVjdGVkSXRlbSA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgY2VsbDsKICAgICAgY2VsbCA9IHRoaXMuZXF1aXBtZW50V2luZG93LnNlbGVjdGVkQ2VsbDsKICAgICAgc3dpdGNoICh0aGlzLmVxdWlwcGVkV2luZG93LnNlbGVjdGVkUm93KSB7CiAgICAgICAgY2FzZSAwOgogICAgICAgICAgaWYgKHRoaXMubWVtYmVyLndlYXBvbiAhPSBudWxsKSB7CiAgICAgICAgICAgIEdhbWVNYW5hZ2VyLmludmVudG9yeS5hZGRJdGVtKHRoaXMubWVtYmVyLndlYXBvbiwgMSk7CiAgICAgICAgICB9CiAgICAgICAgICB0aGlzLm1lbWJlci53ZWFwb24gPSAoY2VsbCAhPSBudWxsKSAmJiAhY2VsbC5lbXB0eSA/IGNlbGwuaXRlbSA6IG51bGw7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDE6CiAgICAgICAgICBpZiAodGhpcy5tZW1iZXIuc2hpZWxkICE9IG51bGwpIHsKICAgICAgICAgICAgR2FtZU1hbmFnZXIuaW52ZW50b3J5LmFkZEl0ZW0odGhpcy5tZW1iZXIuc2hpZWxkLCAxKTsKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMubWVtYmVyLnNoaWVsZCA9IChjZWxsICE9IG51bGwpICYmICFjZWxsLmVtcHR5ID8gY2VsbC5pdGVtIDogbnVsbDsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgMjoKICAgICAgICAgIGlmICh0aGlzLm1lbWJlci5oZWFkICE9IG51bGwpIHsKICAgICAgICAgICAgR2FtZU1hbmFnZXIuaW52ZW50b3J5LmFkZEl0ZW0odGhpcy5tZW1iZXIuaGVhZCwgMSk7CiAgICAgICAgICB9CiAgICAgICAgICB0aGlzLm1lbWJlci5oZWFkID0gKGNlbGwgIT0gbnVsbCkgJiYgIWNlbGwuZW1wdHkgPyBjZWxsLml0ZW0gOiBudWxsOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAzOgogICAgICAgICAgaWYgKHRoaXMubWVtYmVyLmJvZHkgIT0gbnVsbCkgewogICAgICAgICAgICBHYW1lTWFuYWdlci5pbnZlbnRvcnkuYWRkSXRlbSh0aGlzLm1lbWJlci5ib2R5LCAxKTsKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMubWVtYmVyLmJvZHkgPSAoY2VsbCAhPSBudWxsKSAmJiAhY2VsbC5lbXB0eSA/IGNlbGwuaXRlbSA6IG51bGw7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDQ6CiAgICAgICAgICBpZiAodGhpcy5tZW1iZXIuYWNjZXNzb3J5ICE9IG51bGwpIHsKICAgICAgICAgICAgR2FtZU1hbmFnZXIuaW52ZW50b3J5LmFkZEl0ZW0odGhpcy5tZW1iZXIuYWNjZXNzb3J5LCAxKTsKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMubWVtYmVyLmFjY2Vzc29yeSA9IChjZWxsICE9IG51bGwpICYmICFjZWxsLmVtcHR5ID8gY2VsbC5pdGVtIDogbnVsbDsKICAgICAgfQogICAgICB0aGlzLm1lbWJlci5yZWZyZXNoKCk7CiAgICAgIGlmIChjZWxsICE9IG51bGwpIHsKICAgICAgICBjZWxsLmNvdW50LS07CiAgICAgIH0KICAgICAgdGhpcy5lcXVpcHBlZFdpbmRvdy5yZWRyYXcoKTsKICAgICAgdGhpcy5lcXVpcG1lbnRXaW5kb3cucmVidWlsZFJvd3MoKTsKICAgICAgdGhpcy5lcXVpcG1lbnRXaW5kb3cucmVkcmF3KCk7CiAgICAgIGlmICh0aGlzLm9uRXF1aXBtZW50Q2hhbmdlICE9IG51bGwpIHsKICAgICAgICByZXR1cm4gdGhpcy5vbkVxdWlwbWVudENoYW5nZSh0aGlzKTsKICAgICAgfQogICAgfTsKCiAgICByZXR1cm4gV2luZG93c2V0X0VxdWlwbWVudDsKCiAgfSkoV2luZG93c2V0X0Jhc2UpOwoKICB3aW5kb3cuV2luZG93c2V0X0VxdWlwbWVudCA9IFdpbmRvd3NldF9FcXVpcG1lbnQ7Cgp9KS5jYWxsKHRoaXMpOwo="},{"name":"Windowset_Save","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogV2luZG93c2V0X1NhdmUKIyAgIENyZWF0ZWQgb246IDIwMTMtMDktMjYKIwojICAgQ29weXJpZ2h0IChDKSAyMDEzIEFuZHLpIFJhZG9tc2tpLiBBbGwgcmlnaHRzIHJlc2VydmVkLgojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQojCiMgICAgQ2xhc3M6IFdpbmRvd3NldF9TYXZlCiMKIyAgIEEgd2luZG93IHdoaWNoIGRpc3BsYXlzIHRoZSBzYXZlZ2FtZSB3aW5kb3dzLgojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKY2xhc3MgV2luZG93c2V0X1NhdmUgZXh0ZW5kcyBXaW5kb3dzZXRfQmFzZQogICAgY29uc3RydWN0b3I6ICh4LCB5KSAtPgogICAgICAgIHN1cGVyCiAgICAgICAgCiAgICAgICAgQGRlc2NyaXB0aW9uV2luZG93ID0gbmV3IFdpbmRvd19UZXh0KHgsIHksIDQ2NiAqIFdpbmRvd19CYXNlLnNjYWxlLCA0MiAqIFdpbmRvd19CYXNlLnNjYWxlKQogICAgICAgIEBkZXNjcmlwdGlvbldpbmRvdy50ZXh0ID0gbGNzKFJlY29yZE1hbmFnZXIudm9jYWJ1bGFyeS5zYXZlR2FtZU1lbnUucGxlYXNlU2VsZWN0U2F2ZSkKICAgICAgICBveSA9IEBkZXNjcmlwdGlvbldpbmRvdy55ICsgQGRlc2NyaXB0aW9uV2luZG93LmhlaWdodAogICAgICAgIAogICAgICAgIEBzYXZlR2FtZVdpbmRvdyA9IG5ldyBXaW5kb3dfU2F2ZUdhbWUoeCwgb3kpCiAgICAgICAgQHNhdmVHYW1lV2luZG93LnNhdmVHYW1lID0gR2FtZU1hbmFnZXIuZ2V0U2F2ZUdhbWUoMCkKICAgICAgICBAc2F2ZUdhbWVXaW5kb3cuc2xvdCA9IDAKICAgICAgICBAd2luZG93cy5wdXNoKEBzYXZlR2FtZVdpbmRvdykKICAgICAgICBAc2F2ZUdhbWVXaW5kb3cgPSBuZXcgV2luZG93X1NhdmVHYW1lKHgsIG95K0BzYXZlR2FtZVdpbmRvdy5oZWlnaHQpCiAgICAgICAgQHNhdmVHYW1lV2luZG93LnNhdmVHYW1lID0gR2FtZU1hbmFnZXIuZ2V0U2F2ZUdhbWUoMSkKICAgICAgICBAc2F2ZUdhbWVXaW5kb3cuc2xvdCA9IDEKICAgICAgICBAd2luZG93cy5wdXNoKEBzYXZlR2FtZVdpbmRvdykKICAgICAgICBAc2F2ZUdhbWVXaW5kb3cgPSBuZXcgV2luZG93X1NhdmVHYW1lKHgsIG95K0BzYXZlR2FtZVdpbmRvdy5oZWlnaHQqMikKICAgICAgICBAc2F2ZUdhbWVXaW5kb3cuc2F2ZUdhbWUgPSBHYW1lTWFuYWdlci5nZXRTYXZlR2FtZSgyKQogICAgICAgIEBzYXZlR2FtZVdpbmRvdy5zbG90ID0gMgogICAgICAgIEB3aW5kb3dzLnB1c2goQHNhdmVHYW1lV2luZG93KQogICAgICAgIAogICAgICAgIAogICAgICAgIEBhY3RpdmUgPSBubwoKICAgICAgICBAd2luZG93cy5wdXNoKEBkZXNjcmlwdGlvbldpbmRvdykKICAgICAgICBAY3VycmVudFNlbGVjdGlvbiA9IDAgICAgICAgIAogICAgICAgIEBvbkZpbGVTZWxlY3Rpb24gPSBudWxsCiAgICB1cGRhdGU6IC0+CiAgICAgICAgc3VwZXIKCiAgICAgICAgaWYgbm90IEBhY3RpdmUgdGhlbiByZXR1cm4KICAgICAgICBzID0gV2luZG93X0Jhc2Uuc2NhbGUKICAgICAgICBjdyA9IEB3aW5kb3dzW0BjdXJyZW50U2VsZWN0aW9uXQogICAgICAgIGlmIGN3LmN1cnNvclJlY3QuaGVpZ2h0ID09IDAKICAgICAgICAgICAgY3cuY3Vyc29yUmVjdC5zZXQoMCwgMCwgMTAwKnMsIDIwKnMpCiAgICAgICAgICAgIAogICAgICAgIGZvciB3IGluIEB3aW5kb3dzCiAgICAgICAgICAgIGlmIHcgIT0gY3cKICAgICAgICAgICAgICAgIHcuY3Vyc29yUmVjdC5zZXQoMCwgMCwgMCwgMCkKICAgICAgICAKICAgICAgICAKICAgICAgICBpZiBJbnB1dC50cmlnZ2VyKElucHV0LkMpCiAgICAgICAgICAgIGlmIEBvbkZpbGVTZWxlY3Rpb24/CiAgICAgICAgICAgICAgICBAb25GaWxlU2VsZWN0aW9uKGN3LnNsb3QpCiAgICAgICAgICAgICAgICAjQGN1cnJlbnRTZWxlY3Rpb24gPSAwCiAgICAgICAgICAgICAgICBjdy5jdXJzb3JSZWN0LnNldCgwLCAwLCAwLCAwKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAKICAgICAgICAgIyAgIGN3LnNhdmVHYW1lID0gR2FtZU1hbmFnZXIuc2F2ZShjdy5zbG90KQogICAgICAgICAjICAgY3cuY3Vyc29yUmVjdC5zZXQoMCwgMCwgMCwgMCkKICAgICAgICAgIyAgIEBhY3RpdmUgPSBubwogICAgICAgICAgIyAgQGN1cnJlbnRTZWxlY3Rpb24gPSAwCiAgICAgICAgIyAgICBAcmVkcmF3KCkKICAgICAgICAgICAgCiAgICAgICAgaWYgSW5wdXQudHJpZ2dlcihJbnB1dC5CKQogICAgICAgICAgICBjdy5jdXJzb3JSZWN0LnNldCgwLCAwLCAwLCAwKQogICAgICAgICAgICBAYWN0aXZlID0gbm8KICAgICAgICAgICAgQGN1cnJlbnRTZWxlY3Rpb24gPSAwCiAgICAgICAgICAgIElucHV0LmNsZWFyKCkKICAgICAgICAgICAgaWYgQG9uQ2FuY2VsPyB0aGVuIEBvbkNhbmNlbCh0aGlzKQogICAgICAgICAgICAKICAgICAgICBpZiBJbnB1dC50cmlnZ2VyKElucHV0LkRPV04pCiAgICAgICAgICAgIEBjdXJyZW50U2VsZWN0aW9uID0gTWF0aC5taW4oQGN1cnJlbnRTZWxlY3Rpb24rMSwgMikKICAgICAgICBpZiBJbnB1dC50cmlnZ2VyKElucHV0LlVQKQogICAgICAgICAgICBAY3VycmVudFNlbGVjdGlvbiA9IE1hdGgubWF4KEBjdXJyZW50U2VsZWN0aW9uLTEsIDApCiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAKICAgIHJlZHJhdzogLT4KICAgICAgICBAcmVkcmF3QWxsV2luZG93cygpCiAgICAgICAgCndpbmRvdy5XaW5kb3dzZXRfU2F2ZSA9IFdpbmRvd3NldF9TYXZl","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBXaW5kb3dzZXRfU2F2ZSwKICAgIF9faGFzUHJvcCA9IHt9Lmhhc093blByb3BlcnR5LAogICAgX19leHRlbmRzID0gZnVuY3Rpb24oY2hpbGQsIHBhcmVudCkgeyBmb3IgKHZhciBrZXkgaW4gcGFyZW50KSB7IGlmIChfX2hhc1Byb3AuY2FsbChwYXJlbnQsIGtleSkpIGNoaWxkW2tleV0gPSBwYXJlbnRba2V5XTsgfSBmdW5jdGlvbiBjdG9yKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gY2hpbGQ7IH0gY3Rvci5wcm90b3R5cGUgPSBwYXJlbnQucHJvdG90eXBlOyBjaGlsZC5wcm90b3R5cGUgPSBuZXcgY3RvcigpOyBjaGlsZC5fX3N1cGVyX18gPSBwYXJlbnQucHJvdG90eXBlOyByZXR1cm4gY2hpbGQ7IH07CgogIFdpbmRvd3NldF9TYXZlID0gKGZ1bmN0aW9uKF9zdXBlcikgewogICAgX19leHRlbmRzKFdpbmRvd3NldF9TYXZlLCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFdpbmRvd3NldF9TYXZlKHgsIHkpIHsKICAgICAgdmFyIG95OwogICAgICBXaW5kb3dzZXRfU2F2ZS5fX3N1cGVyX18uY29uc3RydWN0b3IuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgdGhpcy5kZXNjcmlwdGlvbldpbmRvdyA9IG5ldyBXaW5kb3dfVGV4dCh4LCB5LCA0NjYgKiBXaW5kb3dfQmFzZS5zY2FsZSwgNDIgKiBXaW5kb3dfQmFzZS5zY2FsZSk7CiAgICAgIHRoaXMuZGVzY3JpcHRpb25XaW5kb3cudGV4dCA9IGxjcyhSZWNvcmRNYW5hZ2VyLnZvY2FidWxhcnkuc2F2ZUdhbWVNZW51LnBsZWFzZVNlbGVjdFNhdmUpOwogICAgICBveSA9IHRoaXMuZGVzY3JpcHRpb25XaW5kb3cueSArIHRoaXMuZGVzY3JpcHRpb25XaW5kb3cuaGVpZ2h0OwogICAgICB0aGlzLnNhdmVHYW1lV2luZG93ID0gbmV3IFdpbmRvd19TYXZlR2FtZSh4LCBveSk7CiAgICAgIHRoaXMuc2F2ZUdhbWVXaW5kb3cuc2F2ZUdhbWUgPSBHYW1lTWFuYWdlci5nZXRTYXZlR2FtZSgwKTsKICAgICAgdGhpcy5zYXZlR2FtZVdpbmRvdy5zbG90ID0gMDsKICAgICAgdGhpcy53aW5kb3dzLnB1c2godGhpcy5zYXZlR2FtZVdpbmRvdyk7CiAgICAgIHRoaXMuc2F2ZUdhbWVXaW5kb3cgPSBuZXcgV2luZG93X1NhdmVHYW1lKHgsIG95ICsgdGhpcy5zYXZlR2FtZVdpbmRvdy5oZWlnaHQpOwogICAgICB0aGlzLnNhdmVHYW1lV2luZG93LnNhdmVHYW1lID0gR2FtZU1hbmFnZXIuZ2V0U2F2ZUdhbWUoMSk7CiAgICAgIHRoaXMuc2F2ZUdhbWVXaW5kb3cuc2xvdCA9IDE7CiAgICAgIHRoaXMud2luZG93cy5wdXNoKHRoaXMuc2F2ZUdhbWVXaW5kb3cpOwogICAgICB0aGlzLnNhdmVHYW1lV2luZG93ID0gbmV3IFdpbmRvd19TYXZlR2FtZSh4LCBveSArIHRoaXMuc2F2ZUdhbWVXaW5kb3cuaGVpZ2h0ICogMik7CiAgICAgIHRoaXMuc2F2ZUdhbWVXaW5kb3cuc2F2ZUdhbWUgPSBHYW1lTWFuYWdlci5nZXRTYXZlR2FtZSgyKTsKICAgICAgdGhpcy5zYXZlR2FtZVdpbmRvdy5zbG90ID0gMjsKICAgICAgdGhpcy53aW5kb3dzLnB1c2godGhpcy5zYXZlR2FtZVdpbmRvdyk7CiAgICAgIHRoaXMuYWN0aXZlID0gZmFsc2U7CiAgICAgIHRoaXMud2luZG93cy5wdXNoKHRoaXMuZGVzY3JpcHRpb25XaW5kb3cpOwogICAgICB0aGlzLmN1cnJlbnRTZWxlY3Rpb24gPSAwOwogICAgICB0aGlzLm9uRmlsZVNlbGVjdGlvbiA9IG51bGw7CiAgICB9CgogICAgV2luZG93c2V0X1NhdmUucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgY3csIHMsIHcsIF9pLCBfbGVuLCBfcmVmOwogICAgICBXaW5kb3dzZXRfU2F2ZS5fX3N1cGVyX18udXBkYXRlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIGlmICghdGhpcy5hY3RpdmUpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgcyA9IFdpbmRvd19CYXNlLnNjYWxlOwogICAgICBjdyA9IHRoaXMud2luZG93c1t0aGlzLmN1cnJlbnRTZWxlY3Rpb25dOwogICAgICBpZiAoY3cuY3Vyc29yUmVjdC5oZWlnaHQgPT09IDApIHsKICAgICAgICBjdy5jdXJzb3JSZWN0LnNldCgwLCAwLCAxMDAgKiBzLCAyMCAqIHMpOwogICAgICB9CiAgICAgIF9yZWYgPSB0aGlzLndpbmRvd3M7CiAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gX3JlZi5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykgewogICAgICAgIHcgPSBfcmVmW19pXTsKICAgICAgICBpZiAodyAhPT0gY3cpIHsKICAgICAgICAgIHcuY3Vyc29yUmVjdC5zZXQoMCwgMCwgMCwgMCk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmIChJbnB1dC50cmlnZ2VyKElucHV0LkMpKSB7CiAgICAgICAgaWYgKHRoaXMub25GaWxlU2VsZWN0aW9uICE9IG51bGwpIHsKICAgICAgICAgIHRoaXMub25GaWxlU2VsZWN0aW9uKGN3LnNsb3QpOwogICAgICAgICAgY3cuY3Vyc29yUmVjdC5zZXQoMCwgMCwgMCwgMCk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmIChJbnB1dC50cmlnZ2VyKElucHV0LkIpKSB7CiAgICAgICAgY3cuY3Vyc29yUmVjdC5zZXQoMCwgMCwgMCwgMCk7CiAgICAgICAgdGhpcy5hY3RpdmUgPSBmYWxzZTsKICAgICAgICB0aGlzLmN1cnJlbnRTZWxlY3Rpb24gPSAwOwogICAgICAgIElucHV0LmNsZWFyKCk7CiAgICAgICAgaWYgKHRoaXMub25DYW5jZWwgIT0gbnVsbCkgewogICAgICAgICAgdGhpcy5vbkNhbmNlbCh0aGlzKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKElucHV0LnRyaWdnZXIoSW5wdXQuRE9XTikpIHsKICAgICAgICB0aGlzLmN1cnJlbnRTZWxlY3Rpb24gPSBNYXRoLm1pbih0aGlzLmN1cnJlbnRTZWxlY3Rpb24gKyAxLCAyKTsKICAgICAgfQogICAgICBpZiAoSW5wdXQudHJpZ2dlcihJbnB1dC5VUCkpIHsKICAgICAgICByZXR1cm4gdGhpcy5jdXJyZW50U2VsZWN0aW9uID0gTWF0aC5tYXgodGhpcy5jdXJyZW50U2VsZWN0aW9uIC0gMSwgMCk7CiAgICAgIH0KICAgIH07CgogICAgV2luZG93c2V0X1NhdmUucHJvdG90eXBlLnJlZHJhdyA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gdGhpcy5yZWRyYXdBbGxXaW5kb3dzKCk7CiAgICB9OwoKICAgIHJldHVybiBXaW5kb3dzZXRfU2F2ZTsKCiAgfSkoV2luZG93c2V0X0Jhc2UpOwoKICB3aW5kb3cuV2luZG93c2V0X1NhdmUgPSBXaW5kb3dzZXRfU2F2ZTsKCn0pLmNhbGwodGhpcyk7Cg=="},{"name":"Windowset_InputText","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogV2luZG93c2V0X0lucHV0VGV4dAojICAgQ3JlYXRlZCBvbjogMjAxNC0wMS0wMQojCiMgICBDb3B5cmlnaHQgKEMpIDIwMTMgQW5kcukgUmFkb21za2kuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgICBDbGFzczogV2luZG93c2V0X0lucHV0VGV4dAojCiMgICBBIHdpbmRvdyB3aGljaCBkaXNwbGF5cyB0aGUgc2F2ZWdhbWUgd2luZG93cy4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCmNsYXNzIFdpbmRvd3NldF9JbnB1dFRleHQgZXh0ZW5kcyBXaW5kb3dzZXRfQmFzZQogICAgY29uc3RydWN0b3I6ICh4LCB5LCBsZXR0ZXJzLCBhY3Rvciwgdmlld3BvcnQpIC0+CiAgICAgICAgc3VwZXIKICAgICAgICAKICAgICAgICBAdGV4dEVkaXRXaW5kb3cgPSBuZXcgV2luZG93X1RleHRFZGl0KHgsIHksIGxldHRlcnMsIGFjdG9yLCB2aWV3cG9ydCkKICAgICAgICBAaW5wdXRUZXh0V2luZG93ID0gbmV3IFdpbmRvd19JbnB1dFRleHQoeCwgeSArIEB0ZXh0RWRpdFdpbmRvdy5oZWlnaHQsIHZpZXdwb3J0KQogICAgICAgIEB0ZXh0RWRpdFdpbmRvdy53aWR0aCA9IEBpbnB1dFRleHRXaW5kb3cud2lkdGgKICAgICAgICAKICAgICAgICBAd2luZG93cy5wdXNoKEBpbnB1dFRleHRXaW5kb3cpCiAgICAgICAgQHdpbmRvd3MucHVzaChAdGV4dEVkaXRXaW5kb3cpCiAgICAgICAgCiAgICAgICAgQGlucHV0VGV4dFdpbmRvdy5vbkNoYXJhY3RlckFjY2VwdCA9IChzZW5kZXIsIGNoYXJhY3RlcikgPT4gQG9uQ2hhcmFjdGVyQWNjZXB0KGNoYXJhY3RlcikKICAgICAgICBAaW5wdXRUZXh0V2luZG93Lm9uQWNjZXB0ID0gPT4gQG9uVGV4dEFjY2VwdCgpCiAgICAgICAgQGlucHV0VGV4dFdpbmRvdy5vbkNhbmNlbCA9ID0+IEBvbkNoYXJhY3RlckRlbGV0ZSgpCiAgICAgICAgCiAgICAgICAgQGFjdGl2ZSA9IG5vCiAgICB1cGRhdGU6IC0+CiAgICAgICAgc3VwZXIKCiAgICAgICAgaWYgbm90IEBhY3RpdmUgdGhlbiByZXR1cm4KICAgICAgICAgIAogICAgcmVkcmF3OiAtPgogICAgICAgIEByZWRyYXdBbGxXaW5kb3dzKCkKICAgICAgICAKICAgIG9uVGV4dEFjY2VwdDogLT4KICAgICAgICBAc2hvdyhubywgbm8pCiAgICAgICAgQGlucHV0VGV4dFdpbmRvdy5hY3RpdmUgPSBubwogICAgICAgIEB0ZXh0RWRpdFdpbmRvdy5hY3RpdmUgPSBubwogICAgICAgIGlmIEBvbkFjY2VwdD8gdGhlbiBAb25BY2NlcHQoQHRleHRFZGl0V2luZG93LnRleHQpCiAgICAgICAgCiAgICBvbkNoYXJhY3RlckFjY2VwdDogKGNoYXJhY3RlcikgLT4KICAgICAgICBpZiBAdGV4dEVkaXRXaW5kb3cudGV4dC5sZW5ndGggPCBAdGV4dEVkaXRXaW5kb3cubGV0dGVycwogICAgICAgICAgICBAdGV4dEVkaXRXaW5kb3cudGV4dCArPSBjaGFyYWN0ZXIKICAgICAgICAgICAgQHRleHRFZGl0V2luZG93LnJlZHJhdygpCiAgICAgICAgCiAgICBvbkNoYXJhY3RlckRlbGV0ZTogLT4KICAgICAgICBpZiBAdGV4dEVkaXRXaW5kb3cudGV4dC5sZW5ndGggPiAwCiAgICAgICAgICAgIEB0ZXh0RWRpdFdpbmRvdy50ZXh0ID0gQHRleHRFZGl0V2luZG93LnRleHQuc3Vic3RyaW5nKDAsIEB0ZXh0RWRpdFdpbmRvdy50ZXh0Lmxlbmd0aC0xKQogICAgICAgICAgICBAdGV4dEVkaXRXaW5kb3cucmVkcmF3KCkKICAgICAgICAKd2luZG93LldpbmRvd3NldF9JbnB1dFRleHQgPSBXaW5kb3dzZXRfSW5wdXRUZXh0","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBXaW5kb3dzZXRfSW5wdXRUZXh0LAogICAgX19oYXNQcm9wID0ge30uaGFzT3duUHJvcGVydHksCiAgICBfX2V4dGVuZHMgPSBmdW5jdGlvbihjaGlsZCwgcGFyZW50KSB7IGZvciAodmFyIGtleSBpbiBwYXJlbnQpIHsgaWYgKF9faGFzUHJvcC5jYWxsKHBhcmVudCwga2V5KSkgY2hpbGRba2V5XSA9IHBhcmVudFtrZXldOyB9IGZ1bmN0aW9uIGN0b3IoKSB7IHRoaXMuY29uc3RydWN0b3IgPSBjaGlsZDsgfSBjdG9yLnByb3RvdHlwZSA9IHBhcmVudC5wcm90b3R5cGU7IGNoaWxkLnByb3RvdHlwZSA9IG5ldyBjdG9yKCk7IGNoaWxkLl9fc3VwZXJfXyA9IHBhcmVudC5wcm90b3R5cGU7IHJldHVybiBjaGlsZDsgfTsKCiAgV2luZG93c2V0X0lucHV0VGV4dCA9IChmdW5jdGlvbihfc3VwZXIpIHsKICAgIF9fZXh0ZW5kcyhXaW5kb3dzZXRfSW5wdXRUZXh0LCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFdpbmRvd3NldF9JbnB1dFRleHQoeCwgeSwgbGV0dGVycywgYWN0b3IsIHZpZXdwb3J0KSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIFdpbmRvd3NldF9JbnB1dFRleHQuX19zdXBlcl9fLmNvbnN0cnVjdG9yLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIHRoaXMudGV4dEVkaXRXaW5kb3cgPSBuZXcgV2luZG93X1RleHRFZGl0KHgsIHksIGxldHRlcnMsIGFjdG9yLCB2aWV3cG9ydCk7CiAgICAgIHRoaXMuaW5wdXRUZXh0V2luZG93ID0gbmV3IFdpbmRvd19JbnB1dFRleHQoeCwgeSArIHRoaXMudGV4dEVkaXRXaW5kb3cuaGVpZ2h0LCB2aWV3cG9ydCk7CiAgICAgIHRoaXMudGV4dEVkaXRXaW5kb3cud2lkdGggPSB0aGlzLmlucHV0VGV4dFdpbmRvdy53aWR0aDsKICAgICAgdGhpcy53aW5kb3dzLnB1c2godGhpcy5pbnB1dFRleHRXaW5kb3cpOwogICAgICB0aGlzLndpbmRvd3MucHVzaCh0aGlzLnRleHRFZGl0V2luZG93KTsKICAgICAgdGhpcy5pbnB1dFRleHRXaW5kb3cub25DaGFyYWN0ZXJBY2NlcHQgPSBmdW5jdGlvbihzZW5kZXIsIGNoYXJhY3RlcikgewogICAgICAgIHJldHVybiBfdGhpcy5vbkNoYXJhY3RlckFjY2VwdChjaGFyYWN0ZXIpOwogICAgICB9OwogICAgICB0aGlzLmlucHV0VGV4dFdpbmRvdy5vbkFjY2VwdCA9IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBfdGhpcy5vblRleHRBY2NlcHQoKTsKICAgICAgfTsKICAgICAgdGhpcy5pbnB1dFRleHRXaW5kb3cub25DYW5jZWwgPSBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gX3RoaXMub25DaGFyYWN0ZXJEZWxldGUoKTsKICAgICAgfTsKICAgICAgdGhpcy5hY3RpdmUgPSBmYWxzZTsKICAgIH0KCiAgICBXaW5kb3dzZXRfSW5wdXRUZXh0LnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpIHsKICAgICAgV2luZG93c2V0X0lucHV0VGV4dC5fX3N1cGVyX18udXBkYXRlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIGlmICghdGhpcy5hY3RpdmUpIHsKCiAgICAgIH0KICAgIH07CgogICAgV2luZG93c2V0X0lucHV0VGV4dC5wcm90b3R5cGUucmVkcmF3ID0gZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiB0aGlzLnJlZHJhd0FsbFdpbmRvd3MoKTsKICAgIH07CgogICAgV2luZG93c2V0X0lucHV0VGV4dC5wcm90b3R5cGUub25UZXh0QWNjZXB0ID0gZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMuc2hvdyhmYWxzZSwgZmFsc2UpOwogICAgICB0aGlzLmlucHV0VGV4dFdpbmRvdy5hY3RpdmUgPSBmYWxzZTsKICAgICAgdGhpcy50ZXh0RWRpdFdpbmRvdy5hY3RpdmUgPSBmYWxzZTsKICAgICAgaWYgKHRoaXMub25BY2NlcHQgIT0gbnVsbCkgewogICAgICAgIHJldHVybiB0aGlzLm9uQWNjZXB0KHRoaXMudGV4dEVkaXRXaW5kb3cudGV4dCk7CiAgICAgIH0KICAgIH07CgogICAgV2luZG93c2V0X0lucHV0VGV4dC5wcm90b3R5cGUub25DaGFyYWN0ZXJBY2NlcHQgPSBmdW5jdGlvbihjaGFyYWN0ZXIpIHsKICAgICAgaWYgKHRoaXMudGV4dEVkaXRXaW5kb3cudGV4dC5sZW5ndGggPCB0aGlzLnRleHRFZGl0V2luZG93LmxldHRlcnMpIHsKICAgICAgICB0aGlzLnRleHRFZGl0V2luZG93LnRleHQgKz0gY2hhcmFjdGVyOwogICAgICAgIHJldHVybiB0aGlzLnRleHRFZGl0V2luZG93LnJlZHJhdygpOwogICAgICB9CiAgICB9OwoKICAgIFdpbmRvd3NldF9JbnB1dFRleHQucHJvdG90eXBlLm9uQ2hhcmFjdGVyRGVsZXRlID0gZnVuY3Rpb24oKSB7CiAgICAgIGlmICh0aGlzLnRleHRFZGl0V2luZG93LnRleHQubGVuZ3RoID4gMCkgewogICAgICAgIHRoaXMudGV4dEVkaXRXaW5kb3cudGV4dCA9IHRoaXMudGV4dEVkaXRXaW5kb3cudGV4dC5zdWJzdHJpbmcoMCwgdGhpcy50ZXh0RWRpdFdpbmRvdy50ZXh0Lmxlbmd0aCAtIDEpOwogICAgICAgIHJldHVybiB0aGlzLnRleHRFZGl0V2luZG93LnJlZHJhdygpOwogICAgICB9CiAgICB9OwoKICAgIHJldHVybiBXaW5kb3dzZXRfSW5wdXRUZXh0OwoKICB9KShXaW5kb3dzZXRfQmFzZSk7CgogIHdpbmRvdy5XaW5kb3dzZXRfSW5wdXRUZXh0ID0gV2luZG93c2V0X0lucHV0VGV4dDsKCn0pLmNhbGwodGhpcyk7Cg=="},{"name":"GameStorage","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogR2FtZVN0b3JhZ2UKIyAgIENyZWF0ZWQgb246IDIwMTMtMDktMjYKIwojICAgQ29weXJpZ2h0IChDKSAyMDEzIEFuZHLpIFJhZG9tc2tpLiBBbGwgcmlnaHRzIHJlc2VydmVkLgojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQojCiMgICBDbGFzczogR2FtZVN0b3JhZ2UKIwojICAgRGVzY3JpcHRpb24uLi4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCmNsYXNzIEdhbWVTdG9yYWdlCiAgICBjb25zdHJ1Y3RvcjogLT4KICAgIAogICAgY2xlYXI6IC0+CiAgICAgICAgbG9jYWxTdG9yYWdlLmNsZWFyKCkKICAgICAgICAKICAgIHNldERhdGE6IChpZCwgZGF0YSkgLT4KICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShpZCwgZGF0YSkKICAgICAgICAKICAgIGdldERhdGE6IChpZCkgLT4gCiAgICAgICAgbG9jYWxTdG9yYWdlLmdldEl0ZW0oaWQpCiAgICAgICAgCiAgICBzZXRPYmplY3Q6KGlkLCBvYmplY3QpIC0+CiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oaWQsIEpTT04uc3RyaW5naWZ5KG9iamVjdCkpCiAgICAgICAgCiAgICBnZXRPYmplY3Q6KGlkKSAtPgogICAgICAgIGl0ZW0gPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShpZCkKICAgICAgICByZXN1bHQgPSBudWxsCiAgICAgICAgCiAgICAgICAgaWYgaXRlbT8KICAgICAgICAgICAgcmVzdWx0ID0gSlNPTi5wYXJzZShpdGVtKQogICAgICAgICAgICAKICAgICAgICByZXR1cm4gcmVzdWx0CiAgICAgICAgCiAgICAgICAgCndpbmRvdy5HYW1lU3RvcmFnZSA9IG5ldyBHYW1lU3RvcmFnZSgp","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBHYW1lU3RvcmFnZTsKCiAgR2FtZVN0b3JhZ2UgPSAoZnVuY3Rpb24oKSB7CiAgICBmdW5jdGlvbiBHYW1lU3RvcmFnZSgpIHt9CgogICAgR2FtZVN0b3JhZ2UucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiBsb2NhbFN0b3JhZ2UuY2xlYXIoKTsKICAgIH07CgogICAgR2FtZVN0b3JhZ2UucHJvdG90eXBlLnNldERhdGEgPSBmdW5jdGlvbihpZCwgZGF0YSkgewogICAgICByZXR1cm4gbG9jYWxTdG9yYWdlLnNldEl0ZW0oaWQsIGRhdGEpOwogICAgfTsKCiAgICBHYW1lU3RvcmFnZS5wcm90b3R5cGUuZ2V0RGF0YSA9IGZ1bmN0aW9uKGlkKSB7CiAgICAgIHJldHVybiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShpZCk7CiAgICB9OwoKICAgIEdhbWVTdG9yYWdlLnByb3RvdHlwZS5zZXRPYmplY3QgPSBmdW5jdGlvbihpZCwgb2JqZWN0KSB7CiAgICAgIHJldHVybiBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShpZCwgSlNPTi5zdHJpbmdpZnkob2JqZWN0KSk7CiAgICB9OwoKICAgIEdhbWVTdG9yYWdlLnByb3RvdHlwZS5nZXRPYmplY3QgPSBmdW5jdGlvbihpZCkgewogICAgICB2YXIgaXRlbSwgcmVzdWx0OwogICAgICBpdGVtID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oaWQpOwogICAgICByZXN1bHQgPSBudWxsOwogICAgICBpZiAoaXRlbSAhPSBudWxsKSB7CiAgICAgICAgcmVzdWx0ID0gSlNPTi5wYXJzZShpdGVtKTsKICAgICAgfQogICAgICByZXR1cm4gcmVzdWx0OwogICAgfTsKCiAgICByZXR1cm4gR2FtZVN0b3JhZ2U7CgogIH0pKCk7CgogIHdpbmRvdy5HYW1lU3RvcmFnZSA9IG5ldyBHYW1lU3RvcmFnZSgpOwoKfSkuY2FsbCh0aGlzKTsK"},{"name":"GameManager","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogR2FtZU1hbmFnZXIKIyAgIENyZWF0ZWQgb246IDIwMTMtMDktMDcKIwojICAgQ29weXJpZ2h0IChDKSAyMDEzIEFuZHLpIFJhZG9tc2tpLiBBbGwgcmlnaHRzIHJlc2VydmVkLgojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQojCiMgCUNsYXNzOiBHYW1lTWFuYWdlcgojCiMgICBEZXNjcmlwdGlvbi4uLgojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKY2xhc3MgR2FtZU1hbmFnZXIKICAgIGNvbnN0cnVjdG9yOiAtPgogICAgICAgIEBtYXAgPSBudWxsCiAgICAgICAgQHBsYXllciA9IG51bGwKICAgICAgICBAY3VycmVudE1hcElkID0gIiIKICAgICAgICAKICAgICAgICBAbWVzc2FnZVdpbmRvdyA9IG51bGwKICAgICAgICBAcGFydHkgPSBudWxsCiAgICAgICAgQGludmVudG9yeSA9IG51bGwKICAgICAgICBAbW9uZXkgPSAwCiAgICAgICAgQGdhbWVUaW1lID0geyBob3VyczogMCwgbWludXRlczogMCwgc2Vjb25kczogMCB9CiAgICAgICAgQG1vZGFsU3ByaXRlID0gbnVsbAogICAgICAgIEBnbG9iYWxFdmVudHMgPSBbXQogICAgICAgIEBnbG9iYWxFdmVudHNCeUlkID0ge30KICAgICAgICBAbWVudUFjY2VzcyA9IDAKICAgICAgICBAc2F2ZU1lbnVBY2Nlc3MgPSB5ZXMKICAgICAgICBAbWFwRW5jb3VudGVyID0gdHJ1ZQogICAgICAgIEBjb21tb25FdmVudHMgPSBbXQogICAgICAgIEBpbnB1dFRleHRXaW5kb3dzZXQgPSBudWxsCiAgICAgICAgCiAgICAgICAgQGJhdHRsZVRlcnJhaW4gPSBudWxsCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgQGludGVycHJldGVyID0gbnVsbAogICAgICAgIAogICAgaW5pdGlhbGl6ZTogLT4KICAgICAgICBAdmFyaWFibGVTdG9yZSA9IG5ldyBMb2dpY19WYXJpYWJsZVN0b3JlKCkKICAgICAgICAKICAgICAgICAjIERFUFJFQ0FURUQgQU5EIE9OTFkgRk9SIEJBQ0tXQVJEIENPTVBBVElCSUxJVFkuIERPTidUIFVTRSBAbnVtYmVycywgZXRjLgogICAgICAgICMgVVNFIEFMV0FZUyBAdmFyaWFibGVTdG9yZQogICAgICAgIEBudW1iZXJzID0gQHZhcmlhYmxlU3RvcmUubnVtYmVycwogICAgICAgIEBib29sZWFucyA9IEB2YXJpYWJsZVN0b3JlLmJvb2xlYW5zCiAgICAgICAgQHN0cmluZ3MgPSBAdmFyaWFibGVTdG9yZS5zdHJpbmdzCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgQHRpbWVyID0gbmV3IExvZ2ljX1RpbWVyKCkKICAgICAgICBAd2luZG93U2tpbiA9IFJlc291cmNlTWFuYWdlci5nZXRCaXRtYXAoIkdyYXBoaWNzLyN7UmVjb3JkTWFuYWdlci5zeXN0ZW0ud2luZG93U2tpbkdyYXBoaWMubmFtZX0iKQogICAgICAgIEB3aW5kb3dTa2luVG9uZSA9IFJlY29yZE1hbmFnZXIuc3lzdGVtLndpbmRvd1NraW5Ub25lCiAgICAgICAgQHBpY3R1cmVzID0gW10KICAgICAgICBAYW5pbWF0aW9ucyA9IFtdCiAgICAgICAgQHRleHRzID0gW10KICAgICAgICBAdGV4dFBpY3R1cmVzID0gW10KICAgICAgICBAc2NyZWVuVmlld3BvcnQgPSBudWxsCiAgICAgICAgQHNjcmVlbiA9IG5ldyBMb2dpY19TY3JlZW4oKQogICAgICAgIEBtZXNzYWdlV2luZG93ID0gbmV3IFdpbmRvd19NZXNzYWdlKCkKICAgICAgICBAcGFydHkgPSBuZXcgTG9naWNfUGFydHkoKQogICAgICAgIEBpbnZlbnRvcnkgPSBuZXcgTG9naWNfSW52ZW50b3J5KCkKICAgICAgICBAaW50ZXJwcmV0ZXIgPSBuZXcgQ29tbWFuZEludGVycHJldGVyKFtdKQogICAgICAgIEBldmVudElkQ291bnRlciA9IDAKICAgICAgICBAZXZlbnRDcmVhdGlvbnMgPSB7fQogICAgICAgIEBldmVudERlbGV0aW9ucyA9IHt9CiAgICAgICAgQGdsb2JhbEV2ZW50cyA9IFtdCiAgICAgICAgQGdsb2JhbEV2ZW50c0J5SWQgPSB7fQogICAgICAgIAogICAgICAgIAogICAgICAgIGJpdG1hcCA9IG5ldyBCaXRtYXAoR3JhcGhpY3Mud2lkdGgsIEdyYXBoaWNzLmhlaWdodCkKICAgICAgICBiaXRtYXAuZmlsbFJlY3QoMCwgMCwgR3JhcGhpY3Mud2lkdGgsIEdyYXBoaWNzLmhlaWdodCwgbmV3IENvbG9yKDAsIDAsIDAsIDAuNSkpCiAgICAgICAgQG1vZGFsU3ByaXRlID0gbmV3IFNwcml0ZSgpCiAgICAgICAgQG1vZGFsU3ByaXRlLnogPSAyMDAwCiAgICAgICAgQG1vZGFsU3ByaXRlLmJpdG1hcCA9IGJpdG1hcAogICAgICAgIEBtb2RhbFNwcml0ZS5zcmNSZWN0ID0gbmV3IFJlY3QoMCwgMCwgR3JhcGhpY3Mud2lkdGgsIEdyYXBoaWNzLmhlaWdodCkKICAgICAgICBAbW9kYWxTcHJpdGUudmlzaWJsZSA9IG5vCiAgICAgICAgCiAgICAgICAgZ2xvYmFsRXZlbnRzID0gRGF0YU1hbmFnZXIuZ2V0RG9jdW1lbnRzQnlUeXBlKCJnbG9iYWxfbWFwX2V2ZW50IikKICAgICAgICBmb3IgZXZlbnREb2N1bWVudCBpbiBnbG9iYWxFdmVudHMKICAgICAgICAgICAgZXZlbnQgPSBldmVudERvY3VtZW50Lml0ZW1zCiAgICAgICAgICAgIGxvZ2ljID0gbmV3IExvZ2ljX0dsb2JhbEV2ZW50KE9iamVjdC5jb3B5KGV2ZW50KSwgZXZlbnQuaWQpCiAgICAgICAgICAgIEBnbG9iYWxFdmVudHMucHVzaChsb2dpYykKICAgICAgICAgICAgQGdsb2JhbEV2ZW50c0J5SWRbZXZlbnQuaWRdID0gbG9naWMKICAgICAgICAgICAgICAgIAogICAgICAKICAgICAgICBmb3IgZXZlbnQgaW4gUmVjb3JkTWFuYWdlci5jb21tb25FdmVudHMKICAgICAgICAgICAgQGNvbW1vbkV2ZW50cy5wdXNoKG5ldyBMb2dpY19Db21tb25FdmVudChldmVudCwgZXZlbnQuaW5kZXgpKQogICAgICAgICAgICAgICAgCiAgICAgICAgcGxheWVyQWN0b3IgPSBSZWNvcmRNYW5hZ2VyLmFjdG9yc1tSZWNvcmRNYW5hZ2VyLnN5c3RlbS5hY3RvcjFdCiAgICAgICAgQHBsYXllckV2ZW50ID0gQGdsb2JhbEV2ZW50c1swXQogICAgICAgIAogIAogICAgICAgIEBwbGF5ZXIgPSBAZ2xvYmFsRXZlbnRzWzBdCiAgICAgICAgQHBsYXllci5ncmFwaGljID0gcGxheWVyQWN0b3IuY2hhcmFjdGVyR3JhcGhpYwogICAgICAgIEBwbGF5ZXIucGF0dGVybiA9IHBsYXllckFjdG9yLmNoYXJhY3RlclBhdHRlcm4KICAgICAgICBAcGxheWVyLnN1YlBhdHRlcm4gPSAwCiAgICAgICAgQHBsYXllci5ncmFwaGljUGF0dGVybiA9IDAKICAgICAgICBAcGxheWVyLmlzUGxheWVyID0geWVzCiAgICAgICAgQGN1cnJlbnRNYXBJZCA9IEBwbGF5ZXIubWFwVWlkCiAgICAgICAgCiAgICAgICAgQHdlYXRoZXIgPSBuZXcgU3ByaXRlc2V0X1dlYXRoZXIoKQogICAgICAgIEB3ZWF0aGVyLnBvd2VyID0gMAogICAgICAgIEB3ZWF0aGVyLnVwZGF0ZSgpCiAgICAgIAogICAgZGlzcG9zZTogLT4KICAgICAgICBkZWxldGUgQG1hcAogICAgICAgIEBtYXAgPSBudWxsCiAgICAgICAgQG1vZGFsU3ByaXRlLmRpc3Bvc2UoKQogICAgICAgIEB3ZWF0aGVyLmRpc3Bvc2UoKQogICAgICAgIEBtZXNzYWdlV2luZG93LmRpc3Bvc2UoKQogICAgICAgIGZvciBwaWN0dXJlIGluIEBwaWN0dXJlcwogICAgICAgICAgICBpZiBwaWN0dXJlPyB0aGVuIHBpY3R1cmUuZGlzcG9zZSgpCiAgICAgICAgZm9yIHRleHQgaW4gQHRleHRzCiAgICAgICAgICAgIGlmIHRleHQ/IHRoZW4gdGV4dC5kaXNwb3NlKCkKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAogICAgZXhpdDogLT4KICAgICAgICBpZiAkUEFSQU1TLmlzT2ZmbGluZQogICAgICAgICAgICBndWkgPSByZXF1aXJlKCdudy5ndWknKQogICAgICAgICAgICBndWkuQXBwLnF1aXQoKQogICAgICAgICAgICAKICAgIHJlc2V0OiAtPgogICAgICAgIEBpbnRlcnByZXRlciA9IG51bGwKICAgICAgICBAbWFwID0gbnVsbAogICAgICAgIEBkaXNwb3NlKCkKICAgICAgICBAaW5pdGlhbGl6ZSgpCiAgICAgICAgCiAgICAKICAgIGFkZEV2ZW50Q3JlYXRpb246IChtYXBVaWQsIHgsIHksIHRlbXBsYXRlSWQsIHBhcmFtZXRlcnMsIHBlcm1hbmVudGx5KSAtPgogICAgICAgIGlmIG5vdCBAZXZlbnRDcmVhdGlvbnNbbWFwVWlkXT8KICAgICAgICAgICAgQGV2ZW50Q3JlYXRpb25zW21hcFVpZF0gPSBbXQogICAgICAgIEBldmVudElkQ291bnRlcisrICAgIAogICAgICAgIAogICAgICAgIGRhdGEgPSB7IG1hcFVpZDogbWFwVWlkLCBpZDogKCdEJyArIEBldmVudElkQ291bnRlciksIHg6IHgsIHk6IHksIHRlbXBsYXRlSWQ6IHRlbXBsYXRlSWQsIHBhcmFtZXRlcnM6IHBhcmFtZXRlcnMsIHBlcm1hbmVudGx5OiBwZXJtYW5lbnRseSB9CiAgICAgICAgCiAgICAgICAgaWYgcGVybWFuZW50bHkKICAgICAgICAgICAgQGV2ZW50Q3JlYXRpb25zW21hcFVpZF0ucHVzaChkYXRhKQogICAgICAgIAogICAgICAgIHJldHVybiBkYXRhCiAgICBhZGRFdmVudERlbGV0aW9uOiAobWFwVWlkLCBldmVudElkKSAtPgogICAgICAgIGlmIG5vdCBAZXZlbnREZWxldGlvbnNbbWFwVWlkXT8KICAgICAgICAgICAgQGV2ZW50RGVsZXRpb25zW21hcFVpZF0gPSBbXQogICAgICAgICAgICAKICAgICAgICBAZXZlbnREZWxldGlvbnNbbWFwVWlkXS5wdXNoKHsgbWFwVWlkOiBtYXBVaWQsIGV2ZW50SWQ6IGV2ZW50SWR9KQogICAgCiAgICB1cGRhdGU6IC0+CiAgICAgICAgaWYgQGlucHV0TnVtYmVyV2luZG93CiAgICAgICAgICAgIEBpbnB1dE51bWJlcldpbmRvdy51cGRhdGUoKQogICAgICAgIGlmIEBpbnB1dFRleHRXaW5kb3dzZXQ/CiAgICAgICAgICAgIEBpbnB1dFRleHRXaW5kb3dzZXQudXBkYXRlKCkKICAgICAgICBpZiBAY2hvaWNlV2luZG93CiAgICAgICAgICAgIEBjaG9pY2VXaW5kb3cudXBkYXRlKCkKICAgICAgICBpZiBAdGltZXI/CiAgICAgICAgICAgIEB0aW1lci51cGRhdGUoKQoKICAgICAgICBmb3IgZXZlbnQgaW4gQGNvbW1vbkV2ZW50cwogICAgICAgICAgICBpZiBldmVudD8KICAgICAgICAgICAgICAgICNHYW1lTWFuYWdlci5tYXAuY3VycmVudEV2ZW50ID0gZXZlbnQKICAgICAgICAgICAgICAgIGV2ZW50LnVwZGF0ZSgpCiAgICAgICAgICAgIAogICAgICAgIEB3ZWF0aGVyLnVwZGF0ZSgpCiAgICAgICAgQHNjcmVlbi51cGRhdGUoKQogICAgICAjICBHYW1lTWFuYWdlci5pbnRlcnByZXRlci51cGRhdGUoKQogICAgICAKICAgICAgICBAcGxheWVyRXZlbnQuZ3JhcGhpYyA9IEBwYXJ0eS5tZW1iZXJzWzBdLmNoYXJhY3RlckdyYXBoaWMKICAgICAgICBAcGxheWVyRXZlbnQucGF0dGVybiA9IEBwYXJ0eS5tZW1iZXJzWzBdLmNoYXJhY3RlclBhdHRlcm4KICAgICAgICAKICAgICAgICBmb3IgcGljdHVyZSBpbiBAcGljdHVyZXMKICAgICAgICAgICAgaWYgcGljdHVyZT8gYW5kIHBpY3R1cmUudmlzaWJsZSB0aGVuIHBpY3R1cmUudXBkYXRlKCkKICAgICAgICBmb3IgdGV4dCBpbiBAdGV4dHMKICAgICAgICAgICAgaWYgdGV4dD8gYW5kIHRleHQudmlzaWJsZSB0aGVuIHRleHQudXBkYXRlKCkKICAgICAgICBmb3IgaSBpbiBbMC4uLkBhbmltYXRpb25zLmxlbmd0aF0KICAgICAgICAgICAgYW5pbWF0aW9uID0gQGFuaW1hdGlvbnNbaV0KICAgICAgICAgICAgaWYgYW5pbWF0aW9uPwogICAgICAgICAgICAgICAgaWYgYW5pbWF0aW9uLmxvZ2ljLmlzUnVubmluZwogICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbi5sb2dpYy51cGRhdGUoKQogICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbi51cGRhdGUoKQogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbi5kaXNwb3NlKCkKICAgICAgICAgICAgICAgICAgICBAYW5pbWF0aW9ucy5yZW1vdmUoYW5pbWF0aW9uKQogICAgICAgICAgICAgICAgICAgIGktLQogICAgICAgICAgICAgICAgICAgIAogICAgc2F2ZTogKHNsb3QpIC0+CiAgICAgICAgc2F2ZUdhbWUgPSB7fQogICAgICAgIHNhdmVHYW1lLnBsYXllciA9IAogICAgICAgIHsgCiAgICAgICAgICAgIGdyYXBoaWM6IEBwbGF5ZXIuZ3JhcGhpYywgCiAgICAgICAgICAgIHg6IE1hdGguZmxvb3IoQHBsYXllci54IC8gQG1hcC50aWxlU2l6ZSksIAogICAgICAgICAgICB5OiBNYXRoLmZsb29yKEBwbGF5ZXIueSAvIEBtYXAudGlsZVNpemUpLAogICAgICAgICAgICBwYXR0ZXJuOiBAcGxheWVyLnBhdHRlcm4sIAogICAgICAgICAgICBzdWJQYXR0ZXJuOiBAcGxheWVyLnN1YlBhdHRlcm4sIAogICAgICAgICAgICBkaXJlY3Rpb246IEBwbGF5ZXIuZGlyZWN0aW9uLAogICAgICAgICAgICBtYXBVaWQ6IEBwbGF5ZXIubWFwVWlkCiAgICAgICAgfQogICAgICAgIAogICAgICAgIHNhdmVHYW1lLmN1cnJlbnRNYXBJZCA9IEBwbGF5ZXIubWFwVWlkCiAgICAgICAgc2F2ZUdhbWUuZXZlbnREZWxldGlvbnMgPSBAZXZlbnREZWxldGlvbnMKICAgICAgICBzYXZlR2FtZS5ldmVudENyZWF0aW9ucyA9IEBldmVudENyZWF0aW9ucwogICAgICAgICAgICAgICAgICAgIAogCiAgICAgICAgc2F2ZUdhbWUuZXZlbnRJZENvdW50ZXIgPSBAZXZlbnRJZENvdW50ZXIKICAgICAgICBzYXZlR2FtZS5udW1iZXJzID0gQHZhcmlhYmxlU3RvcmUubnVtYmVycwogICAgICAgIHNhdmVHYW1lLmJvb2xlYW5zID0gQHZhcmlhYmxlU3RvcmUuYm9vbGVhbnMKICAgICAgICBzYXZlR2FtZS5zdHJpbmdzID0gQHZhcmlhYmxlU3RvcmUuc3RyaW5ncwogICAgICAgIHNhdmVHYW1lLmxvY2FsTnVtYmVycyA9IEB2YXJpYWJsZVN0b3JlLmxvY2FsTnVtYmVycwogICAgICAgIHNhdmVHYW1lLmxvY2FsU3RyaW5ncyA9IEB2YXJpYWJsZVN0b3JlLmxvY2FsU3RyaW5ncwogICAgICAgIHNhdmVHYW1lLmxvY2FsQm9vbGVhbnMgPSBAdmFyaWFibGVTdG9yZS5sb2NhbEJvb2xlYW5zCiAgICAgICAgc2F2ZUdhbWUucGFydHkgPSBAcGFydHkudG9EYXRhQnVuZGxlKCkKICAgICAgICBzYXZlR2FtZS5pbnZlbnRvcnkgPSBAaW52ZW50b3J5LnRvRGF0YUJ1bmRsZSgpCiAgICAgICAgc2F2ZUdhbWUubW9uZXkgPSBAbW9uZXkKICAgICAgICBzYXZlR2FtZS5mcmFtZUNvdW50ID0gR3JhcGhpY3MuZnJhbWVDb3VudAogICAgICAgIAogICAgICAgIEdhbWVTdG9yYWdlLnNldERhdGEoIlNhdmVHYW1lXyN7c2xvdH0iLCBKU09OLnN0cmluZ2lmeShzYXZlR2FtZSkpCiAgICAgICAgCiAgICAgICAgcmV0dXJuIHNhdmVHYW1lCiAgICAgICAgCiAgICBsb2FkOiAoc2xvdCkgLT4KICAgICAgICBzYXZlR2FtZSA9IEpTT04ucGFyc2UoR2FtZVN0b3JhZ2UuZ2V0RGF0YSgiU2F2ZUdhbWVfI3tzbG90fSIpKQogICAgICAgIEBwbGF5ZXIgPSBAZ2xvYmFsRXZlbnRzWzBdICNuZXcgTG9naWNfUGxheWVyKCkKICAgICAgICBAcGxheWVyLmdyYXBoaWMgPSBzYXZlR2FtZS5wbGF5ZXIuZ3JhcGhpYwogICAgICAgIEBwbGF5ZXIuZXZlbnQueCA9IHNhdmVHYW1lLnBsYXllci54CiAgICAgICAgQHBsYXllci5ldmVudC55ID0gc2F2ZUdhbWUucGxheWVyLnkKICAgICAgICBAcGxheWVyLnBhdHRlcm4gPSBzYXZlR2FtZS5wbGF5ZXIucGF0dGVybgogICAgICAgIEBwbGF5ZXIuc3ViUGF0dGVybiA9IHNhdmVHYW1lLnBsYXllci5zdWJQYXR0ZXJuCiAgICAgICAgQHBsYXllci5kaXJlY3Rpb24gPSBzYXZlR2FtZS5wbGF5ZXIuZGlyZWN0aW9uCiAgICAgICAgQHBsYXllci5tYXBVaWQgPSBzYXZlR2FtZS5wbGF5ZXIubWFwVWlkCiAgICAgICAgQHBsYXllci5pc1BsYXllciA9IHllcwoKICAgICAgICBAZXZlbnREZWxldGlvbnMgPSBzYXZlR2FtZS5ldmVudERlbGV0aW9ucwogICAgICAgIEBldmVudENyZWF0aW9ucyA9IHNhdmVHYW1lLmV2ZW50Q3JlYXRpb25zCiAgICAgICAgQHBsYXllckV2ZW50ID0gQHBsYXllcgogICAgICAgIEBjdXJyZW50TWFwSWQgPSBzYXZlR2FtZS5jdXJyZW50TWFwSWQKICAgICAgICBAdmFyaWFibGVTdG9yZS5udW1iZXJzID0gc2F2ZUdhbWUubnVtYmVycwogICAgICAgIEB2YXJpYWJsZVN0b3JlLmJvb2xlYW5zID0gc2F2ZUdhbWUuYm9vbGVhbnMKICAgICAgICBAdmFyaWFibGVTdG9yZS5zdHJpbmdzID0gc2F2ZUdhbWUuc3RyaW5ncwogICAgICAgIEB2YXJpYWJsZVN0b3JlLmxvY2FsTnVtYmVycyA9IHNhdmVHYW1lLmxvY2FsTnVtYmVycwogICAgICAgIEB2YXJpYWJsZVN0b3JlLmxvY2FsU3RyaW5ncyA9IHNhdmVHYW1lLmxvY2FsU3RyaW5ncwogICAgICAgIEB2YXJpYWJsZVN0b3JlLmxvY2FsQm9vbGVhbnMgPSBzYXZlR2FtZS5sb2NhbEJvb2xlYW5zCiAgICAgICAgQHBhcnR5ID0gbmV3IExvZ2ljX1BhcnR5KCkKICAgICAgICAKICAgICAgICBtZW1iZXIgPSBudWxsCiAgICAgICAgZm9yIGkgaW4gWzAuLi5zYXZlR2FtZS5wYXJ0eS5tZW1iZXJzLmxlbmd0aF0KICAgICAgICAgICAgbWVtYmVyID0gc2F2ZUdhbWUucGFydHkubWVtYmVyc1tpXQogICAgICAgICAgICBAcGFydHkubWVtYmVyc1tpXSA9IG5ldyBMb2dpY19BY3RvcihSZWNvcmRNYW5hZ2VyLmFjdG9yc1ttZW1iZXIuYWN0b3JJZF0sIG1lbWJlcikKICAgICAgICAgICAgCiAgICAgICAgQGludmVudG9yeSA9IG5ldyBMb2dpY19JbnZlbnRvcnkoc2F2ZUdhbWUuaW52ZW50b3J5KQogICAgICAgIEBtb25leSA9IHNhdmVHYW1lLm1vbmV5CiAgICAgICAgR3JhcGhpY3MuZnJhbWVDb3VudCA9IHNhdmVHYW1lLmZyYW1lQ291bnQKICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgIGdldFNhdmVHYW1lOiAoc2xvdCkgLT4gSlNPTi5wYXJzZShHYW1lU3RvcmFnZS5nZXREYXRhKCJTYXZlR2FtZV8je3Nsb3R9IikpCiAgICBoYXNTYXZlR2FtZXM6IC0+IEBnZXRTYXZlR2FtZSgwKT8gb3IgQGdldFNhdmVHYW1lKDEpPyBvciBAZ2V0U2F2ZUdhbWUoMik/CndpbmRvdy5HYW1lTWFuYWdlciA9IG5ldyBHYW1lTWFuYWdlcigp","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBHYW1lTWFuYWdlcjsKCiAgR2FtZU1hbmFnZXIgPSAoZnVuY3Rpb24oKSB7CiAgICBmdW5jdGlvbiBHYW1lTWFuYWdlcigpIHsKICAgICAgdGhpcy5tYXAgPSBudWxsOwogICAgICB0aGlzLnBsYXllciA9IG51bGw7CiAgICAgIHRoaXMuY3VycmVudE1hcElkID0gIiI7CiAgICAgIHRoaXMubWVzc2FnZVdpbmRvdyA9IG51bGw7CiAgICAgIHRoaXMucGFydHkgPSBudWxsOwogICAgICB0aGlzLmludmVudG9yeSA9IG51bGw7CiAgICAgIHRoaXMubW9uZXkgPSAwOwogICAgICB0aGlzLmdhbWVUaW1lID0gewogICAgICAgIGhvdXJzOiAwLAogICAgICAgIG1pbnV0ZXM6IDAsCiAgICAgICAgc2Vjb25kczogMAogICAgICB9OwogICAgICB0aGlzLm1vZGFsU3ByaXRlID0gbnVsbDsKICAgICAgdGhpcy5nbG9iYWxFdmVudHMgPSBbXTsKICAgICAgdGhpcy5nbG9iYWxFdmVudHNCeUlkID0ge307CiAgICAgIHRoaXMubWVudUFjY2VzcyA9IDA7CiAgICAgIHRoaXMuc2F2ZU1lbnVBY2Nlc3MgPSB0cnVlOwogICAgICB0aGlzLm1hcEVuY291bnRlciA9IHRydWU7CiAgICAgIHRoaXMuY29tbW9uRXZlbnRzID0gW107CiAgICAgIHRoaXMuaW5wdXRUZXh0V2luZG93c2V0ID0gbnVsbDsKICAgICAgdGhpcy5iYXR0bGVUZXJyYWluID0gbnVsbDsKICAgICAgdGhpcy5pbnRlcnByZXRlciA9IG51bGw7CiAgICB9CgogICAgR2FtZU1hbmFnZXIucHJvdG90eXBlLmluaXRpYWxpemUgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGJpdG1hcCwgZXZlbnQsIGV2ZW50RG9jdW1lbnQsIGdsb2JhbEV2ZW50cywgbG9naWMsIHBsYXllckFjdG9yLCBfaSwgX2osIF9sZW4sIF9sZW4xLCBfcmVmOwogICAgICB0aGlzLnZhcmlhYmxlU3RvcmUgPSBuZXcgTG9naWNfVmFyaWFibGVTdG9yZSgpOwogICAgICB0aGlzLm51bWJlcnMgPSB0aGlzLnZhcmlhYmxlU3RvcmUubnVtYmVyczsKICAgICAgdGhpcy5ib29sZWFucyA9IHRoaXMudmFyaWFibGVTdG9yZS5ib29sZWFuczsKICAgICAgdGhpcy5zdHJpbmdzID0gdGhpcy52YXJpYWJsZVN0b3JlLnN0cmluZ3M7CiAgICAgIHRoaXMudGltZXIgPSBuZXcgTG9naWNfVGltZXIoKTsKICAgICAgdGhpcy53aW5kb3dTa2luID0gUmVzb3VyY2VNYW5hZ2VyLmdldEJpdG1hcCgiR3JhcGhpY3MvIiArIFJlY29yZE1hbmFnZXIuc3lzdGVtLndpbmRvd1NraW5HcmFwaGljLm5hbWUpOwogICAgICB0aGlzLndpbmRvd1NraW5Ub25lID0gUmVjb3JkTWFuYWdlci5zeXN0ZW0ud2luZG93U2tpblRvbmU7CiAgICAgIHRoaXMucGljdHVyZXMgPSBbXTsKICAgICAgdGhpcy5hbmltYXRpb25zID0gW107CiAgICAgIHRoaXMudGV4dHMgPSBbXTsKICAgICAgdGhpcy50ZXh0UGljdHVyZXMgPSBbXTsKICAgICAgdGhpcy5zY3JlZW5WaWV3cG9ydCA9IG51bGw7CiAgICAgIHRoaXMuc2NyZWVuID0gbmV3IExvZ2ljX1NjcmVlbigpOwogICAgICB0aGlzLm1lc3NhZ2VXaW5kb3cgPSBuZXcgV2luZG93X01lc3NhZ2UoKTsKICAgICAgdGhpcy5wYXJ0eSA9IG5ldyBMb2dpY19QYXJ0eSgpOwogICAgICB0aGlzLmludmVudG9yeSA9IG5ldyBMb2dpY19JbnZlbnRvcnkoKTsKICAgICAgdGhpcy5pbnRlcnByZXRlciA9IG5ldyBDb21tYW5kSW50ZXJwcmV0ZXIoW10pOwogICAgICB0aGlzLmV2ZW50SWRDb3VudGVyID0gMDsKICAgICAgdGhpcy5ldmVudENyZWF0aW9ucyA9IHt9OwogICAgICB0aGlzLmV2ZW50RGVsZXRpb25zID0ge307CiAgICAgIHRoaXMuZ2xvYmFsRXZlbnRzID0gW107CiAgICAgIHRoaXMuZ2xvYmFsRXZlbnRzQnlJZCA9IHt9OwogICAgICBiaXRtYXAgPSBuZXcgQml0bWFwKEdyYXBoaWNzLndpZHRoLCBHcmFwaGljcy5oZWlnaHQpOwogICAgICBiaXRtYXAuZmlsbFJlY3QoMCwgMCwgR3JhcGhpY3Mud2lkdGgsIEdyYXBoaWNzLmhlaWdodCwgbmV3IENvbG9yKDAsIDAsIDAsIDAuNSkpOwogICAgICB0aGlzLm1vZGFsU3ByaXRlID0gbmV3IFNwcml0ZSgpOwogICAgICB0aGlzLm1vZGFsU3ByaXRlLnogPSAyMDAwOwogICAgICB0aGlzLm1vZGFsU3ByaXRlLmJpdG1hcCA9IGJpdG1hcDsKICAgICAgdGhpcy5tb2RhbFNwcml0ZS5zcmNSZWN0ID0gbmV3IFJlY3QoMCwgMCwgR3JhcGhpY3Mud2lkdGgsIEdyYXBoaWNzLmhlaWdodCk7CiAgICAgIHRoaXMubW9kYWxTcHJpdGUudmlzaWJsZSA9IGZhbHNlOwogICAgICBnbG9iYWxFdmVudHMgPSBEYXRhTWFuYWdlci5nZXREb2N1bWVudHNCeVR5cGUoImdsb2JhbF9tYXBfZXZlbnQiKTsKICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBnbG9iYWxFdmVudHMubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICBldmVudERvY3VtZW50ID0gZ2xvYmFsRXZlbnRzW19pXTsKICAgICAgICBldmVudCA9IGV2ZW50RG9jdW1lbnQuaXRlbXM7CiAgICAgICAgbG9naWMgPSBuZXcgTG9naWNfR2xvYmFsRXZlbnQoT2JqZWN0LmNvcHkoZXZlbnQpLCBldmVudC5pZCk7CiAgICAgICAgdGhpcy5nbG9iYWxFdmVudHMucHVzaChsb2dpYyk7CiAgICAgICAgdGhpcy5nbG9iYWxFdmVudHNCeUlkW2V2ZW50LmlkXSA9IGxvZ2ljOwogICAgICB9CiAgICAgIF9yZWYgPSBSZWNvcmRNYW5hZ2VyLmNvbW1vbkV2ZW50czsKICAgICAgZm9yIChfaiA9IDAsIF9sZW4xID0gX3JlZi5sZW5ndGg7IF9qIDwgX2xlbjE7IF9qKyspIHsKICAgICAgICBldmVudCA9IF9yZWZbX2pdOwogICAgICAgIHRoaXMuY29tbW9uRXZlbnRzLnB1c2gobmV3IExvZ2ljX0NvbW1vbkV2ZW50KGV2ZW50LCBldmVudC5pbmRleCkpOwogICAgICB9CiAgICAgIHBsYXllckFjdG9yID0gUmVjb3JkTWFuYWdlci5hY3RvcnNbUmVjb3JkTWFuYWdlci5zeXN0ZW0uYWN0b3IxXTsKICAgICAgdGhpcy5wbGF5ZXJFdmVudCA9IHRoaXMuZ2xvYmFsRXZlbnRzWzBdOwogICAgICB0aGlzLnBsYXllciA9IHRoaXMuZ2xvYmFsRXZlbnRzWzBdOwogICAgICB0aGlzLnBsYXllci5ncmFwaGljID0gcGxheWVyQWN0b3IuY2hhcmFjdGVyR3JhcGhpYzsKICAgICAgdGhpcy5wbGF5ZXIucGF0dGVybiA9IHBsYXllckFjdG9yLmNoYXJhY3RlclBhdHRlcm47CiAgICAgIHRoaXMucGxheWVyLnN1YlBhdHRlcm4gPSAwOwogICAgICB0aGlzLnBsYXllci5ncmFwaGljUGF0dGVybiA9IDA7CiAgICAgIHRoaXMucGxheWVyLmlzUGxheWVyID0gdHJ1ZTsKICAgICAgdGhpcy5jdXJyZW50TWFwSWQgPSB0aGlzLnBsYXllci5tYXBVaWQ7CiAgICAgIHRoaXMud2VhdGhlciA9IG5ldyBTcHJpdGVzZXRfV2VhdGhlcigpOwogICAgICB0aGlzLndlYXRoZXIucG93ZXIgPSAwOwogICAgICByZXR1cm4gdGhpcy53ZWF0aGVyLnVwZGF0ZSgpOwogICAgfTsKCiAgICBHYW1lTWFuYWdlci5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgcGljdHVyZSwgdGV4dCwgX2ksIF9qLCBfbGVuLCBfbGVuMSwgX3JlZiwgX3JlZjEsIF9yZXN1bHRzOwogICAgICBkZWxldGUgdGhpcy5tYXA7CiAgICAgIHRoaXMubWFwID0gbnVsbDsKICAgICAgdGhpcy5tb2RhbFNwcml0ZS5kaXNwb3NlKCk7CiAgICAgIHRoaXMud2VhdGhlci5kaXNwb3NlKCk7CiAgICAgIHRoaXMubWVzc2FnZVdpbmRvdy5kaXNwb3NlKCk7CiAgICAgIF9yZWYgPSB0aGlzLnBpY3R1cmVzOwogICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICBwaWN0dXJlID0gX3JlZltfaV07CiAgICAgICAgaWYgKHBpY3R1cmUgIT0gbnVsbCkgewogICAgICAgICAgcGljdHVyZS5kaXNwb3NlKCk7CiAgICAgICAgfQogICAgICB9CiAgICAgIF9yZWYxID0gdGhpcy50ZXh0czsKICAgICAgX3Jlc3VsdHMgPSBbXTsKICAgICAgZm9yIChfaiA9IDAsIF9sZW4xID0gX3JlZjEubGVuZ3RoOyBfaiA8IF9sZW4xOyBfaisrKSB7CiAgICAgICAgdGV4dCA9IF9yZWYxW19qXTsKICAgICAgICBpZiAodGV4dCAhPSBudWxsKSB7CiAgICAgICAgICBfcmVzdWx0cy5wdXNoKHRleHQuZGlzcG9zZSgpKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgX3Jlc3VsdHMucHVzaCh2b2lkIDApOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gX3Jlc3VsdHM7CiAgICB9OwoKICAgIEdhbWVNYW5hZ2VyLnByb3RvdHlwZS5leGl0ID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBndWk7CiAgICAgIGlmICgkUEFSQU1TLmlzT2ZmbGluZSkgewogICAgICAgIGd1aSA9IHJlcXVpcmUoJ253Lmd1aScpOwogICAgICAgIHJldHVybiBndWkuQXBwLnF1aXQoKTsKICAgICAgfQogICAgfTsKCiAgICBHYW1lTWFuYWdlci5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbigpIHsKICAgICAgdGhpcy5pbnRlcnByZXRlciA9IG51bGw7CiAgICAgIHRoaXMubWFwID0gbnVsbDsKICAgICAgdGhpcy5kaXNwb3NlKCk7CiAgICAgIHJldHVybiB0aGlzLmluaXRpYWxpemUoKTsKICAgIH07CgogICAgR2FtZU1hbmFnZXIucHJvdG90eXBlLmFkZEV2ZW50Q3JlYXRpb24gPSBmdW5jdGlvbihtYXBVaWQsIHgsIHksIHRlbXBsYXRlSWQsIHBhcmFtZXRlcnMsIHBlcm1hbmVudGx5KSB7CiAgICAgIHZhciBkYXRhOwogICAgICBpZiAodGhpcy5ldmVudENyZWF0aW9uc1ttYXBVaWRdID09IG51bGwpIHsKICAgICAgICB0aGlzLmV2ZW50Q3JlYXRpb25zW21hcFVpZF0gPSBbXTsKICAgICAgfQogICAgICB0aGlzLmV2ZW50SWRDb3VudGVyKys7CiAgICAgIGRhdGEgPSB7CiAgICAgICAgbWFwVWlkOiBtYXBVaWQsCiAgICAgICAgaWQ6ICdEJyArIHRoaXMuZXZlbnRJZENvdW50ZXIsCiAgICAgICAgeDogeCwKICAgICAgICB5OiB5LAogICAgICAgIHRlbXBsYXRlSWQ6IHRlbXBsYXRlSWQsCiAgICAgICAgcGFyYW1ldGVyczogcGFyYW1ldGVycywKICAgICAgICBwZXJtYW5lbnRseTogcGVybWFuZW50bHkKICAgICAgfTsKICAgICAgaWYgKHBlcm1hbmVudGx5KSB7CiAgICAgICAgdGhpcy5ldmVudENyZWF0aW9uc1ttYXBVaWRdLnB1c2goZGF0YSk7CiAgICAgIH0KICAgICAgcmV0dXJuIGRhdGE7CiAgICB9OwoKICAgIEdhbWVNYW5hZ2VyLnByb3RvdHlwZS5hZGRFdmVudERlbGV0aW9uID0gZnVuY3Rpb24obWFwVWlkLCBldmVudElkKSB7CiAgICAgIGlmICh0aGlzLmV2ZW50RGVsZXRpb25zW21hcFVpZF0gPT0gbnVsbCkgewogICAgICAgIHRoaXMuZXZlbnREZWxldGlvbnNbbWFwVWlkXSA9IFtdOwogICAgICB9CiAgICAgIHJldHVybiB0aGlzLmV2ZW50RGVsZXRpb25zW21hcFVpZF0ucHVzaCh7CiAgICAgICAgbWFwVWlkOiBtYXBVaWQsCiAgICAgICAgZXZlbnRJZDogZXZlbnRJZAogICAgICB9KTsKICAgIH07CgogICAgR2FtZU1hbmFnZXIucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgYW5pbWF0aW9uLCBldmVudCwgaSwgcGljdHVyZSwgdGV4dCwgX2ksIF9qLCBfaywgX2wsIF9sZW4sIF9sZW4xLCBfbGVuMiwgX3JlZiwgX3JlZjEsIF9yZWYyLCBfcmVmMywgX3Jlc3VsdHM7CiAgICAgIGlmICh0aGlzLmlucHV0TnVtYmVyV2luZG93KSB7CiAgICAgICAgdGhpcy5pbnB1dE51bWJlcldpbmRvdy51cGRhdGUoKTsKICAgICAgfQogICAgICBpZiAodGhpcy5pbnB1dFRleHRXaW5kb3dzZXQgIT0gbnVsbCkgewogICAgICAgIHRoaXMuaW5wdXRUZXh0V2luZG93c2V0LnVwZGF0ZSgpOwogICAgICB9CiAgICAgIGlmICh0aGlzLmNob2ljZVdpbmRvdykgewogICAgICAgIHRoaXMuY2hvaWNlV2luZG93LnVwZGF0ZSgpOwogICAgICB9CiAgICAgIGlmICh0aGlzLnRpbWVyICE9IG51bGwpIHsKICAgICAgICB0aGlzLnRpbWVyLnVwZGF0ZSgpOwogICAgICB9CiAgICAgIF9yZWYgPSB0aGlzLmNvbW1vbkV2ZW50czsKICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBfcmVmLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7CiAgICAgICAgZXZlbnQgPSBfcmVmW19pXTsKICAgICAgICBpZiAoZXZlbnQgIT0gbnVsbCkgewogICAgICAgICAgZXZlbnQudXBkYXRlKCk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHRoaXMud2VhdGhlci51cGRhdGUoKTsKICAgICAgdGhpcy5zY3JlZW4udXBkYXRlKCk7CiAgICAgIHRoaXMucGxheWVyRXZlbnQuZ3JhcGhpYyA9IHRoaXMucGFydHkubWVtYmVyc1swXS5jaGFyYWN0ZXJHcmFwaGljOwogICAgICB0aGlzLnBsYXllckV2ZW50LnBhdHRlcm4gPSB0aGlzLnBhcnR5Lm1lbWJlcnNbMF0uY2hhcmFjdGVyUGF0dGVybjsKICAgICAgX3JlZjEgPSB0aGlzLnBpY3R1cmVzOwogICAgICBmb3IgKF9qID0gMCwgX2xlbjEgPSBfcmVmMS5sZW5ndGg7IF9qIDwgX2xlbjE7IF9qKyspIHsKICAgICAgICBwaWN0dXJlID0gX3JlZjFbX2pdOwogICAgICAgIGlmICgocGljdHVyZSAhPSBudWxsKSAmJiBwaWN0dXJlLnZpc2libGUpIHsKICAgICAgICAgIHBpY3R1cmUudXBkYXRlKCk7CiAgICAgICAgfQogICAgICB9CiAgICAgIF9yZWYyID0gdGhpcy50ZXh0czsKICAgICAgZm9yIChfayA9IDAsIF9sZW4yID0gX3JlZjIubGVuZ3RoOyBfayA8IF9sZW4yOyBfaysrKSB7CiAgICAgICAgdGV4dCA9IF9yZWYyW19rXTsKICAgICAgICBpZiAoKHRleHQgIT0gbnVsbCkgJiYgdGV4dC52aXNpYmxlKSB7CiAgICAgICAgICB0ZXh0LnVwZGF0ZSgpOwogICAgICAgIH0KICAgICAgfQogICAgICBfcmVzdWx0cyA9IFtdOwogICAgICBmb3IgKGkgPSBfbCA9IDAsIF9yZWYzID0gdGhpcy5hbmltYXRpb25zLmxlbmd0aDsgMCA8PSBfcmVmMyA/IF9sIDwgX3JlZjMgOiBfbCA+IF9yZWYzOyBpID0gMCA8PSBfcmVmMyA/ICsrX2wgOiAtLV9sKSB7CiAgICAgICAgYW5pbWF0aW9uID0gdGhpcy5hbmltYXRpb25zW2ldOwogICAgICAgIGlmIChhbmltYXRpb24gIT0gbnVsbCkgewogICAgICAgICAgaWYgKGFuaW1hdGlvbi5sb2dpYy5pc1J1bm5pbmcpIHsKICAgICAgICAgICAgYW5pbWF0aW9uLmxvZ2ljLnVwZGF0ZSgpOwogICAgICAgICAgICBfcmVzdWx0cy5wdXNoKGFuaW1hdGlvbi51cGRhdGUoKSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBhbmltYXRpb24uZGlzcG9zZSgpOwogICAgICAgICAgICB0aGlzLmFuaW1hdGlvbnMucmVtb3ZlKGFuaW1hdGlvbik7CiAgICAgICAgICAgIF9yZXN1bHRzLnB1c2goaS0tKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgX3Jlc3VsdHMucHVzaCh2b2lkIDApOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gX3Jlc3VsdHM7CiAgICB9OwoKICAgIEdhbWVNYW5hZ2VyLnByb3RvdHlwZS5zYXZlID0gZnVuY3Rpb24oc2xvdCkgewogICAgICB2YXIgc2F2ZUdhbWU7CiAgICAgIHNhdmVHYW1lID0ge307CiAgICAgIHNhdmVHYW1lLnBsYXllciA9IHsKICAgICAgICBncmFwaGljOiB0aGlzLnBsYXllci5ncmFwaGljLAogICAgICAgIHg6IE1hdGguZmxvb3IodGhpcy5wbGF5ZXIueCAvIHRoaXMubWFwLnRpbGVTaXplKSwKICAgICAgICB5OiBNYXRoLmZsb29yKHRoaXMucGxheWVyLnkgLyB0aGlzLm1hcC50aWxlU2l6ZSksCiAgICAgICAgcGF0dGVybjogdGhpcy5wbGF5ZXIucGF0dGVybiwKICAgICAgICBzdWJQYXR0ZXJuOiB0aGlzLnBsYXllci5zdWJQYXR0ZXJuLAogICAgICAgIGRpcmVjdGlvbjogdGhpcy5wbGF5ZXIuZGlyZWN0aW9uLAogICAgICAgIG1hcFVpZDogdGhpcy5wbGF5ZXIubWFwVWlkCiAgICAgIH07CiAgICAgIHNhdmVHYW1lLmN1cnJlbnRNYXBJZCA9IHRoaXMucGxheWVyLm1hcFVpZDsKICAgICAgc2F2ZUdhbWUuZXZlbnREZWxldGlvbnMgPSB0aGlzLmV2ZW50RGVsZXRpb25zOwogICAgICBzYXZlR2FtZS5ldmVudENyZWF0aW9ucyA9IHRoaXMuZXZlbnRDcmVhdGlvbnM7CiAgICAgIHNhdmVHYW1lLmV2ZW50SWRDb3VudGVyID0gdGhpcy5ldmVudElkQ291bnRlcjsKICAgICAgc2F2ZUdhbWUubnVtYmVycyA9IHRoaXMudmFyaWFibGVTdG9yZS5udW1iZXJzOwogICAgICBzYXZlR2FtZS5ib29sZWFucyA9IHRoaXMudmFyaWFibGVTdG9yZS5ib29sZWFuczsKICAgICAgc2F2ZUdhbWUuc3RyaW5ncyA9IHRoaXMudmFyaWFibGVTdG9yZS5zdHJpbmdzOwogICAgICBzYXZlR2FtZS5sb2NhbE51bWJlcnMgPSB0aGlzLnZhcmlhYmxlU3RvcmUubG9jYWxOdW1iZXJzOwogICAgICBzYXZlR2FtZS5sb2NhbFN0cmluZ3MgPSB0aGlzLnZhcmlhYmxlU3RvcmUubG9jYWxTdHJpbmdzOwogICAgICBzYXZlR2FtZS5sb2NhbEJvb2xlYW5zID0gdGhpcy52YXJpYWJsZVN0b3JlLmxvY2FsQm9vbGVhbnM7CiAgICAgIHNhdmVHYW1lLnBhcnR5ID0gdGhpcy5wYXJ0eS50b0RhdGFCdW5kbGUoKTsKICAgICAgc2F2ZUdhbWUuaW52ZW50b3J5ID0gdGhpcy5pbnZlbnRvcnkudG9EYXRhQnVuZGxlKCk7CiAgICAgIHNhdmVHYW1lLm1vbmV5ID0gdGhpcy5tb25leTsKICAgICAgc2F2ZUdhbWUuZnJhbWVDb3VudCA9IEdyYXBoaWNzLmZyYW1lQ291bnQ7CiAgICAgIEdhbWVTdG9yYWdlLnNldERhdGEoIlNhdmVHYW1lXyIgKyBzbG90LCBKU09OLnN0cmluZ2lmeShzYXZlR2FtZSkpOwogICAgICByZXR1cm4gc2F2ZUdhbWU7CiAgICB9OwoKICAgIEdhbWVNYW5hZ2VyLnByb3RvdHlwZS5sb2FkID0gZnVuY3Rpb24oc2xvdCkgewogICAgICB2YXIgaSwgbWVtYmVyLCBzYXZlR2FtZSwgX2ksIF9yZWY7CiAgICAgIHNhdmVHYW1lID0gSlNPTi5wYXJzZShHYW1lU3RvcmFnZS5nZXREYXRhKCJTYXZlR2FtZV8iICsgc2xvdCkpOwogICAgICB0aGlzLnBsYXllciA9IHRoaXMuZ2xvYmFsRXZlbnRzWzBdOwogICAgICB0aGlzLnBsYXllci5ncmFwaGljID0gc2F2ZUdhbWUucGxheWVyLmdyYXBoaWM7CiAgICAgIHRoaXMucGxheWVyLmV2ZW50LnggPSBzYXZlR2FtZS5wbGF5ZXIueDsKICAgICAgdGhpcy5wbGF5ZXIuZXZlbnQueSA9IHNhdmVHYW1lLnBsYXllci55OwogICAgICB0aGlzLnBsYXllci5wYXR0ZXJuID0gc2F2ZUdhbWUucGxheWVyLnBhdHRlcm47CiAgICAgIHRoaXMucGxheWVyLnN1YlBhdHRlcm4gPSBzYXZlR2FtZS5wbGF5ZXIuc3ViUGF0dGVybjsKICAgICAgdGhpcy5wbGF5ZXIuZGlyZWN0aW9uID0gc2F2ZUdhbWUucGxheWVyLmRpcmVjdGlvbjsKICAgICAgdGhpcy5wbGF5ZXIubWFwVWlkID0gc2F2ZUdhbWUucGxheWVyLm1hcFVpZDsKICAgICAgdGhpcy5wbGF5ZXIuaXNQbGF5ZXIgPSB0cnVlOwogICAgICB0aGlzLmV2ZW50RGVsZXRpb25zID0gc2F2ZUdhbWUuZXZlbnREZWxldGlvbnM7CiAgICAgIHRoaXMuZXZlbnRDcmVhdGlvbnMgPSBzYXZlR2FtZS5ldmVudENyZWF0aW9uczsKICAgICAgdGhpcy5wbGF5ZXJFdmVudCA9IHRoaXMucGxheWVyOwogICAgICB0aGlzLmN1cnJlbnRNYXBJZCA9IHNhdmVHYW1lLmN1cnJlbnRNYXBJZDsKICAgICAgdGhpcy52YXJpYWJsZVN0b3JlLm51bWJlcnMgPSBzYXZlR2FtZS5udW1iZXJzOwogICAgICB0aGlzLnZhcmlhYmxlU3RvcmUuYm9vbGVhbnMgPSBzYXZlR2FtZS5ib29sZWFuczsKICAgICAgdGhpcy52YXJpYWJsZVN0b3JlLnN0cmluZ3MgPSBzYXZlR2FtZS5zdHJpbmdzOwogICAgICB0aGlzLnZhcmlhYmxlU3RvcmUubG9jYWxOdW1iZXJzID0gc2F2ZUdhbWUubG9jYWxOdW1iZXJzOwogICAgICB0aGlzLnZhcmlhYmxlU3RvcmUubG9jYWxTdHJpbmdzID0gc2F2ZUdhbWUubG9jYWxTdHJpbmdzOwogICAgICB0aGlzLnZhcmlhYmxlU3RvcmUubG9jYWxCb29sZWFucyA9IHNhdmVHYW1lLmxvY2FsQm9vbGVhbnM7CiAgICAgIHRoaXMucGFydHkgPSBuZXcgTG9naWNfUGFydHkoKTsKICAgICAgbWVtYmVyID0gbnVsbDsKICAgICAgZm9yIChpID0gX2kgPSAwLCBfcmVmID0gc2F2ZUdhbWUucGFydHkubWVtYmVycy5sZW5ndGg7IDAgPD0gX3JlZiA/IF9pIDwgX3JlZiA6IF9pID4gX3JlZjsgaSA9IDAgPD0gX3JlZiA/ICsrX2kgOiAtLV9pKSB7CiAgICAgICAgbWVtYmVyID0gc2F2ZUdhbWUucGFydHkubWVtYmVyc1tpXTsKICAgICAgICB0aGlzLnBhcnR5Lm1lbWJlcnNbaV0gPSBuZXcgTG9naWNfQWN0b3IoUmVjb3JkTWFuYWdlci5hY3RvcnNbbWVtYmVyLmFjdG9ySWRdLCBtZW1iZXIpOwogICAgICB9CiAgICAgIHRoaXMuaW52ZW50b3J5ID0gbmV3IExvZ2ljX0ludmVudG9yeShzYXZlR2FtZS5pbnZlbnRvcnkpOwogICAgICB0aGlzLm1vbmV5ID0gc2F2ZUdhbWUubW9uZXk7CiAgICAgIHJldHVybiBHcmFwaGljcy5mcmFtZUNvdW50ID0gc2F2ZUdhbWUuZnJhbWVDb3VudDsKICAgIH07CgogICAgR2FtZU1hbmFnZXIucHJvdG90eXBlLmdldFNhdmVHYW1lID0gZnVuY3Rpb24oc2xvdCkgewogICAgICByZXR1cm4gSlNPTi5wYXJzZShHYW1lU3RvcmFnZS5nZXREYXRhKCJTYXZlR2FtZV8iICsgc2xvdCkpOwogICAgfTsKCiAgICBHYW1lTWFuYWdlci5wcm90b3R5cGUuaGFzU2F2ZUdhbWVzID0gZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiAodGhpcy5nZXRTYXZlR2FtZSgwKSAhPSBudWxsKSB8fCAodGhpcy5nZXRTYXZlR2FtZSgxKSAhPSBudWxsKSB8fCAodGhpcy5nZXRTYXZlR2FtZSgyKSAhPSBudWxsKTsKICAgIH07CgogICAgcmV0dXJuIEdhbWVNYW5hZ2VyOwoKICB9KSgpOwoKICB3aW5kb3cuR2FtZU1hbmFnZXIgPSBuZXcgR2FtZU1hbmFnZXIoKTsKCn0pLmNhbGwodGhpcyk7Cg=="},{"name":"Scene_Battle","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogU2NlbmVfQmF0dGxlCiMgICBDcmVhdGVkIG9uOiAyMDEzLTA5LTI5CiMKIyAJQ29weXJpZ2h0IChDKSAyMDEzIEFuZHLpIFJhZG9tc2tpLiBBbGwgcmlnaHRzIHJlc2VydmVkLgojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQojCiMgCUNsYXNzOiBTY2VuZV9CYXR0bGUKIwojICAgRGVzY3JpcHRpb24uLi4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCmNsYXNzIFNjZW5lX0JhdHRsZSBleHRlbmRzIFNjZW5lCiAgICBAVklFV19NT0RFX1NJREUgPSAwCiAgICBAVklFV19NT0RFX0ZST05UID0gMQogICAgQFZJRVdfTU9ERV9GUk9OVF9DSEFSQUNURVJTID0gMgogICAgY29uc3RydWN0b3I6IC0+CiAgICAgICAgc3VwZXIoKQogICAgCiAgICBpbml0aWFsaXplOiAtPgogICAgICAgIEB0ZXJyYWluID0gR2FtZU1hbmFnZXIuYmF0dGxlVGVycmFpbgogICAgICAgIAogICAgICAgIGlmICRQQVJBTVMuYmF0dGxlVGVzdD8gYW5kIEdhbWVNYW5hZ2VyLnRyb29wLmJhY2tncm91bmRHcmFwaGljPwogICAgICAgICAgICBAYmFja2dyb3VuZCA9IFJlc291cmNlTWFuYWdlci5nZXRCaXRtYXAoIkdyYXBoaWNzL0JhdHRsZWJhY2tzLyN7R2FtZU1hbmFnZXIudHJvb3AuYmFja2dyb3VuZEdyYXBoaWMubmFtZX0iKQogICAgICAgICAgICBpZiBub3QgQGJhY2tncm91bmQ/IAogICAgICAgICAgICAgICAgQGJhY2tncm91bmQgPSBHcmFwaGljcy5zbmFwc2hvdCgpCiAgICAgICAgICAgICAgICBAYmFja2dyb3VuZC5maWxsUmVjdCgwLCAwLCBAYmFja2dyb3VuZC53aWR0aCwgQGJhY2tncm91bmQuaGVpZ2h0LCBuZXcgQ29sb3IoMCwgMCwgMCwgMC43KSkKICAgICAgICBlbHNlIGlmIEB0ZXJyYWluPwogICAgICAgICAgICBpZiBAdGVycmFpbi5iYWNrZ3JvdW5kLmltYWdlLm5hbWUubGVuZ3RoID4gMAogICAgICAgICAgICAgICAgQGJhY2tncm91bmQgPSBSZXNvdXJjZU1hbmFnZXIuZ2V0Qml0bWFwKCJHcmFwaGljcy9CYXR0bGViYWNrcy8je0B0ZXJyYWluLmJhY2tncm91bmQuaW1hZ2UubmFtZX0iKQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBAYmFja2dyb3VuZCA9IEdyYXBoaWNzLnNuYXBzaG90KCkKICAgICAgICAgICAgICAgIEBiYWNrZ3JvdW5kLmZpbGxSZWN0KDAsIDAsIEBiYWNrZ3JvdW5kLndpZHRoLCBAYmFja2dyb3VuZC5oZWlnaHQsIG5ldyBDb2xvcigwLCAwLCAwLCAwLjcpKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgIEBmb3JlZ3JvdW5kID0gUmVzb3VyY2VNYW5hZ2VyLmdldEJpdG1hcCgiR3JhcGhpY3MvUGljdHVyZXMvI3tAdGVycmFpbi5mb3JlZ3JvdW5kLmltYWdlLm5hbWV9IikKICAgICAgICBlbHNlCiAgICAgICAgICAgIEBmb3JlZ3JvdW5kID0gbnVsbAogICAgICAgICAgICBAYmFja2dyb3VuZCA9IEdyYXBoaWNzLnNuYXBzaG90KCkKICAgICAgICAgICAgQGJhY2tncm91bmQuZmlsbFJlY3QoMCwgMCwgQGJhY2tncm91bmQud2lkdGgsIEBiYWNrZ3JvdW5kLmhlaWdodCwgbmV3IENvbG9yKDAsIDAsIDAsIDAuNykpCiAgICAgICAgCiAgICAgICAgQGJhdHRsZXJTcHJpdGVzID0gW10KICAgICAgICBAbWVtYmVyU3ByaXRlcyA9IFtdCiAgICAgICAgQGVuZW15U3ByaXRlcyA9IFtdCiAgICAgICAgQHBhcnR5ID0gR2FtZU1hbmFnZXIucGFydHkKICAgICAgICBAYmF0dGxlcnMgPSBbXQogICAgICAgIEBvcmRlcmVkQmF0dGxlcnMgPSBbXQogICAgICAgIEBwbGF5ZXJzVHVybiA9IHllcwogICAgICAgIEBzZWxlY3RCYXR0bGVyID0gbm8KICAgICAgICBAc2VsZWN0ZWRCYXR0bGVyID0gMAogICAgICAgIEBhY3Rpb25MaXN0ID0gW10KICAgICAgICBAYWN0aXZlTWVtYmVyID0gbnVsbAogICAgICAgIEBhY3RpdmVNZW1iZXJJbmRleCA9IDAKICAgICAgICBAcHJvY2Vzc2luZ0FjdGlvbkxpc3QgPSBubwogICAgICAgIEBiYXR0bGVXb24gPSBubwogICAgICAgIEBiYXR0bGVMb3N0ID0gbm8KICAgICAgICBAYmF0dGxlRW5kID0gbm8KICAgICAgICBAYWN0aW9uUG9pbnRlciA9IDAKICAgICAgICBAd2FpdENvdW50ZXIgPSAwCiAgICAgICAgQHRhcmdldEFuaW1hdGlvbiA9IG5ldyBTcHJpdGVzZXRfQW5pbWF0aW9uKCkKICAgICAgICBAZGFtYWdlU3ByaXRlID0gbmV3IFNwcml0ZV9EYW1hZ2UoKQogICAgICAgIEBhbmltYXRpb25MaXN0ID0gW1tdLCBbXV0KICAgICAgICBAYW5pbWF0aW9uUG9pbnRlciA9IDAKICAgICAgICBAYW5pbWF0aW9uc1J1bm5pbmcgPSBubwogICAgICAgIEBhbmltYXRpb25QaGFzZSA9IDAKICAgICAgICBAdGV4dEFuaW1hdGlvbnMgPSBbXQogICAgICAgIEBjb21wbGV4QW5pbWF0aW9ucyA9IFtdCiAgICAgICAgQHNpbXBsZUFuaW1hdGlvbnMgPSBbXQogICAgICAgIEB2aWV3TW9kZSA9IFNjZW5lX0JhdHRsZS5WSUVXX01PREVfU0lERQogICAgICAgIEBzZWxlY3RlZFRhcmdldHMgPSBbXQogICAgICAgIEBpbnRlcnByZXRlcnMgPSBbXQogICAgICAgIEBpbnRlcnByZXRlciA9IG5ldyBDb21tYW5kSW50ZXJwcmV0ZXIoW10pCiAgICAgICAgQGludGVycHJldGVyLm9uRmluaXNoID0gPT4gCiAgICAgICAgICAgIEBvbkludGVycHJldGVyRmluaXNoKCkKICAgICAgICBAY3VycmVudEV2ZW50UGFnZSA9IG51bGwKICAgICAgICBAdHVybiA9IDAKICAgICAgICBAdm9jYWIgPSBSZWNvcmRNYW5hZ2VyLnZvY2FidWxhcnkKICAgICAgICAKICAgICAgICBHYW1lTWFuYWdlci5pbkJhdHRsZSA9IHllcwogICAgICAgIAogICAgZGlzcG9zZTogLT4KICAgICAgICBmb3Igc3ByaXRlIGluIEBiYXR0bGVyU3ByaXRlcwogICAgICAgICAgICBzcHJpdGUuZGlzcG9zZSgpCiAgICAgICAgQGFjdGlvbldpbmRvdy5kaXNwb3NlKCkKICAgICAgICBAcGFydHlXaW5kb3cuZGlzcG9zZSgpCiAgICAgICAgQGJhY2tncm91bmRTcHJpdGUuZGlzcG9zZSgpCiAgICAgICAgQG1lc3NhZ2VDb250YWluZXJTcHJpdGVzZXQuZGlzcG9zZSgpCiAgICAgICAgQHRhcmdldFNlbGVjdGlvbldpbmRvdy5kaXNwb3NlKCkKICAgICAgICBAc2tpbGxzV2luZG93c2V0LmRpc3Bvc2UoKQogICAgICAgIEBpdGVtc1dpbmRvd3NldC5kaXNwb3NlKCkKICAgICAgICBAdWlWaWV3cG9ydC5kaXNwb3NlKCkKICAgIHByZXBhcmVEYXRhOiAtPgogICAgICAgIEB0cm9vcCA9IEdhbWVNYW5hZ2VyLnRyb29wCiAgICAgICAgQGVuZW1pZXMgPSBbXQogICAgICAgIEBtZW1iZXJzID0gW10KICAgICAgICBAZGVhZEVuZW1pZXMgPSBbXQogICAgICAgIEBkZWFkTWVtYmVycyA9IFtdCiAgICAgICAgQGFsaXZlRW5lbWllcyA9IFtdCiAgICAgICAgQGFsaXZlTWVtYmVycyA9IFtdCiAgICAgICAgQG1lc3NhZ2VDb250YWluZXIgPSBuZXcgTG9naWNfQmF0dGxlTWVzc2FnZSgpCiAgICAgICAgCiAgICAgICAgaWYgR2FtZU1hbmFnZXIuYmF0dGxlTXVzaWM/CiAgICAgICAgICAgIEF1ZGlvTWFuYWdlci5sb2FkTXVzaWMoR2FtZU1hbmFnZXIuYmF0dGxlTXVzaWMpCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgZm9yIHBhZ2UgaW4gQHRyb29wLnBhZ2VzCiAgICAgICAgICAgIEBpbnRlcnByZXRlcnMucHVzaChuZXcgQ29tbWFuZEludGVycHJldGVyKHBhZ2UuY29tbWFuZHMpKQogICAgICAgICAgICAKICAgICAgICBjaGFyYWN0ZXIgPSBudWxsCiAgICAgICAgZW5lbXkgPSBudWxsCiAgICAgICAgcmVjb3JkID0gbnVsbAogICAgICAgIGZvciBtZW1iZXIgaW4gQHRyb29wLm1lbWJlcnMKICAgICAgICAgICAgcmVjb3JkID0gUmVjb3JkTWFuYWdlci5lbmVtaWVzW21lbWJlci5pZF0KICAgICAgICAgICAgZW5lbXkgPSBuZXcgTG9naWNfQmF0dGxlcihuZXcgTG9naWNfRW5lbXkocmVjb3JkKSkKICAgICAgICAgICAgZW5lbXkuaXNIaWRkZW4gPSBtZW1iZXIuaGlkZGVuCiAgICAgICAgICAgIGVuZW15LmdyYXBoaWMgPSByZWNvcmQuZ3JhcGhpYwogICAgICAgICAgICBlbmVteS5tZXNzYWdlQ29udGFpbmVyID0gQG1lc3NhZ2VDb250YWluZXIKICAgICAgICAgICAgZW5lbXkueCA9IG1lbWJlci54ICogKDIqV2luZG93X0Jhc2Uuc2NhbGUpCiAgICAgICAgICAgIGVuZW15LnkgPSBtZW1iZXIueSAqICgyKldpbmRvd19CYXNlLnNjYWxlKQogICAgICAgICAgICBAZW5lbWllcy5wdXNoKGVuZW15KQogICAgICAgICAgICBAYWxpdmVFbmVtaWVzLnB1c2goZW5lbXkpCiAgICAgICAgICAgIEBiYXR0bGVycy5wdXNoKGVuZW15KQogICAgICAgICAgICBAb3JkZXJlZEJhdHRsZXJzLnB1c2goZW5lbXkpCiAgICAgICAgICAgIAogICAgICAgICAgICBlbmVteVNwcml0ZSA9IG5ldyBTcHJpdGVfQmF0dGxlcihlbmVteSkKICAgICAgICAgICAgZW5lbXlTcHJpdGUub3BhY2l0eSA9IDAKICAgICAgICAgICAgZW5lbXlTcHJpdGUubWlycm9yID0gbWVtYmVyLmZsaXAKIAogICAgICAgICAgICBAZW5lbXlTcHJpdGVzLnB1c2goZW5lbXlTcHJpdGUpCiAgICAgICAgICAgIEBiYXR0bGVyU3ByaXRlcy5wdXNoKGVuZW15U3ByaXRlKQogICAgICAgICAgICAKICAgICAgICAgICAgUmVzb3VyY2VMb2FkZXIubG9hZEFjdG9yU2tpbGxBbmltYXRpb25zKGVuZW15LmFjdG9yKQogICAgICAgICAgICBSZXNvdXJjZUxvYWRlci5sb2FkQWN0b3JCYXR0bGVBbmltYXRpb25zKGVuZW15LmFjdG9yKQogICAgICAgICAgICAKICAgICAgICBpZiBAdHJvb3AubWVtYmVycy5sZW5ndGggPT0gMAogICAgICAgICAgICBAYmF0dGxlV29uID0geWVzCiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICBmb3IgaSBpbiBbMC4uLkBwYXJ0eS5tZW1iZXJzLmxlbmd0aF0KICAgICAgICAgICAgbWVtYmVyID0gQHBhcnR5Lm1lbWJlcnNbaV0KICAgICAgICAgICAgcyA9IFdpbmRvd19CYXNlLnNjYWxlCiAgICAgICAgICAgIGNoYXJhY3RlciA9IG5ldyBMb2dpY19CYXR0bGVyKG1lbWJlcikKICAgICAgICAgICAgY2hhcmFjdGVyLm1lc3NhZ2VDb250YWluZXIgPSBAbWVzc2FnZUNvbnRhaW5lcgogICAgICAgICAgICBpZiBtZW1iZXIuc3RhbmRBbmltYXRpb24/CiAgICAgICAgICAgICAgICBjaGFyYWN0ZXIueSA9IG1lbWJlci5iYXR0bGVQb3NpdGlvbi55ICogKDIqcykKICAgICAgICAgICAgICAgIGNoYXJhY3Rlci54ID0gbWVtYmVyLmJhdHRsZVBvc2l0aW9uLnggKiAoMipzKQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBjaGFyYWN0ZXIueCA9IDQ4KnMgKyBpICogKDE1NCpzKQogICAgICAgICAgICAgICAgY2hhcmFjdGVyLnkgPSAoR3JhcGhpY3MuaGVpZ2h0IC0gNjUqcykKICAgICAgICAgICAgICAgIAogICAgICAgICAgICBAbWVtYmVycy5wdXNoKGNoYXJhY3RlcikKICAgICAgICAgICAgQGJhdHRsZXJzLnB1c2goY2hhcmFjdGVyKQogICAgICAgICAgICBAYWxpdmVNZW1iZXJzLnB1c2goY2hhcmFjdGVyKQogICAgICAgICAgICBAb3JkZXJlZEJhdHRsZXJzLnB1c2goY2hhcmFjdGVyKQogICAgICAgICAgICAKICAgICAgICAgICAgbWVtYmVyU3ByaXRlID0gbmV3IFNwcml0ZV9CYXR0bGVyKGNoYXJhY3RlcikKICAgICAgICAgICAgQG1lbWJlclNwcml0ZXMucHVzaChtZW1iZXJTcHJpdGUpCiAgICAgICAgICAgIEBiYXR0bGVyU3ByaXRlcy5wdXNoKG1lbWJlclNwcml0ZSkKICAgICAgICAgICAgCiAgICAgICAgICAgIFJlc291cmNlTG9hZGVyLmxvYWRBY3RvclNraWxsQW5pbWF0aW9ucyhtZW1iZXIpCiAgICAgICAgICAgIFJlc291cmNlTG9hZGVyLmxvYWRBY3RvckJhdHRsZUFuaW1hdGlvbnMobWVtYmVyKQogICAgICAgICAgICAKICAgICAgICBSZXNvdXJjZUxvYWRlci5sb2FkSXRlbUFuaW1hdGlvbnMoR2FtZU1hbmFnZXIuaW52ZW50b3J5KQogICAgICAgIEBhY3RpdmVNZW1iZXIgPSBAbWVtYmVyc1swXSAgCiAgICAgICAjIEBtZW1iZXJzWzFdLmFjdG9yLmFkZFN0YXRlKFJlY29yZE1hbmFnZXIuc3RhdGVzWzFdKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgcHJlcGFyZVZpc3VhbDogLT4KICAgICAgICAjIEZpeGVzIGNlbnRlcmluZyBvbiB4LWF4aXMgKFNob3VsZCBiZSByZWZhY3RvcmVkKQogICAgICAgIGZvciBiYXR0bGVyU3ByaXRlIGluIEBiYXR0bGVyU3ByaXRlcwogICAgICAgICAgICAjaWYgYmF0dGxlclNwcml0ZS5sb2dpYzIuYWN0b3Iuc3RhbmRBbmltYXRpb24/CiAgICAgICAgICAgIGJhdHRsZXJTcHJpdGUudXBkYXRlKCkKICAgICAgICAgICAgYmF0dGxlclNwcml0ZS5sb2dpYzIueCArPSBiYXR0bGVyU3ByaXRlLnNyY1JlY3Qud2lkdGggLyAyCiAgICAgICAgICAgIGJhdHRsZXJTcHJpdGUueCA9IGJhdHRsZXJTcHJpdGUubG9naWMyLngKICAgICAgICAgICAgICAgIAogICAgICAgIHZvY2FiID0gUmVjb3JkTWFuYWdlci52b2NhYnVsYXJ5CiAgICAgICAgQHVpVmlld3BvcnQgPSBuZXcgVmlld3BvcnQoMCwgMCwgR3JhcGhpY3Mud2lkdGgsIEdyYXBoaWNzLmhlaWdodCkKICAgICAgICBAdWlWaWV3cG9ydC56ID0gMTAwMAogICAgICAgIEBtZXNzYWdlQ29udGFpbmVyU3ByaXRlc2V0ID0gbmV3IFNwcml0ZXNldF9CYXR0bGVNZXNzYWdlKEBtZXNzYWdlQ29udGFpbmVyLCBAdWlWaWV3cG9ydCkKICAgICAgICBAYmFja2dyb3VuZFNwcml0ZSA9IG5ldyBQbGFuZSgpCiAgICAgICAgQGJhY2tncm91bmRTcHJpdGUuYml0bWFwID0gQGJhY2tncm91bmQKICAgICAgICBAYmFja2dyb3VuZFNwcml0ZS5zcmNSZWN0ID0gbmV3IFJlY3QoMCwgMCwgQGJhY2tncm91bmQud2lkdGgsIEBiYWNrZ3JvdW5kLmhlaWdodCkKICAgICAgICAjQGJhY2tncm91bmRTcHJpdGUueCA9IE1hdGguZmxvb3IoKEdyYXBoaWNzLndpZHRoIC0gQGJhY2tncm91bmQud2lkdGgpIC8gMikKICAgICAgICAjQGJhY2tncm91bmRTcHJpdGUueSA9IE1hdGguZmxvb3IoKEdyYXBoaWNzLmhlaWdodCAtIEBiYWNrZ3JvdW5kLmhlaWdodCkgLyAyKSAgICAgCiAgICAgICAgCiAgICAgICAgaWYgQGZvcmVncm91bmQ/CiAgICAgICAgICAgIEBmb3JlZ3JvdW5kU3ByaXRlID0gbmV3IFBsYW5lKCkKICAgICAgICAgICAgQGZvcmVncm91bmRTcHJpdGUuYml0bWFwID0gQGZvcmVncm91bmQKICAgICAgICAgICAgQGZvcmVncm91bmRTcHJpdGUuc3JjUmVjdCA9IG5ldyBSZWN0KDAsIDAsIEBmb3JlZ3JvdW5kLndpZHRoLCBAZm9yZWdyb3VuZC5oZWlnaHQpCiAgICAgICAgICAgIEBmb3JlZ3JvdW5kU3ByaXRlLnggPSBNYXRoLmZsb29yKChHcmFwaGljcy53aWR0aCAtIEBiYWNrZ3JvdW5kLndpZHRoKSAvIDIpCiAgICAgICAgICAgIEBmb3JlZ3JvdW5kU3ByaXRlLnkgPSBNYXRoLmZsb29yKChHcmFwaGljcy5oZWlnaHQgLSBAYmFja2dyb3VuZC5oZWlnaHQpIC8gMikgCiAgICAgICAgICAgIEBmb3JlZ3JvdW5kU3ByaXRlLnogPSAxMDAKICAgICAgICAKICAgICAgICBHYW1lTWFuYWdlci5iYWNrZ3JvdW5kID0gQGJhY2tncm91bmRTcHJpdGUKICAgICAgICBHYW1lTWFuYWdlci5pbnRlcmZhY2UgPSBAdWlWaWV3cG9ydAogICAgICAgIAogICAgICAgIEBhY3Rpb25XaW5kb3cgPSBuZXcgV2luZG93X1NlbGVjdGlvbigwLCAwLCAxLCBbW2xjcyh2b2NhYi5iYXR0bGUuYXR0YWNrKV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbbGNzKHZvY2FiLm1lbnUuc2tpbGxzKV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbbGNzKHZvY2FiLmJhdHRsZS5ndWFyZCldLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2xjcyh2b2NhYi5tZW51Lml0ZW1zKV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbbGNzKHZvY2FiLmJhdHRsZS5lc2NhcGUpXV0sIDE1MCAqIFdpbmRvd19CYXNlLnNjYWxlLCAyMiAqIFdpbmRvd19CYXNlLnNjYWxlLCBAdWlWaWV3cG9ydCkKICAgICAgICBAYWN0aW9uV2luZG93LnZhbGlkYXRlQ2VsbCA9ICh4LCB5LCBjZWxsKSA9PiBpZiB5ID09IDQgdGhlbiAhQG5vRXNjYXBlIGVsc2UgeWVzICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICBAYWN0aW9uV2luZG93LmNvbnRlbnRzLmZvbnQgPSBAYWN0aW9uV2luZG93LmFjdGlvbkZvbnQKICAgICAgICBAYWN0aW9uV2luZG93LmhlaWdodCA9IDExNCAqIFdpbmRvd19CYXNlLnNjYWxlICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgQGFjdGlvbldpbmRvdy55ID0gR3JhcGhpY3MuaGVpZ2h0IC0gQGFjdGlvbldpbmRvdy5oZWlnaHQKICAgICAgICBAYWN0aW9uV2luZG93LnJlZHJhdygpICAgICAKICAgICAgICBAYWN0aW9uV2luZG93Lm9uU2VsZWN0aW9uQWNjZXB0ID0gPT4gQG9uQWN0aW9uKCkKICAgICAgICBAYWN0aW9uV2luZG93Lm9uQ2FuY2VsID0gPT4gQG9uQWN0aW9uQ2FuY2VsKCkKICAgICAgICAKICAgICAgICBAcGFydHlXaW5kb3cgPSBuZXcgV2luZG93X0JhdHRsZVBhcnR5KDAsIDAsIEdyYXBoaWNzLndpZHRoIC0gQGFjdGlvbldpbmRvdy53aWR0aCwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAxMTQgKiBXaW5kb3dfQmFzZS5zY2FsZSwgQHVpVmlld3BvcnQpCiAgICAgICAgQHBhcnR5V2luZG93Lm1lbWJlcnMgPSBAbWVtYmVycyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgIEBwYXJ0eVdpbmRvdy54ID0gQGFjdGlvbldpbmRvdy53aWR0aAogICAgICAgIEBwYXJ0eVdpbmRvdy55ID0gQGFjdGlvbldpbmRvdy55CiAgICAgICAgQHBhcnR5V2luZG93LnJlZHJhdygpCiAgICAgICAgCiAgICAgICAgQGdyYXBoaWNhbFBhcnR5V2luZG93ID0gbmV3IFdpbmRvd19QYXJ0eShAdWlWaWV3cG9ydCkKICAgICAgICBAZ3JhcGhpY2FsUGFydHlXaW5kb3cueCA9IDAKICAgICAgICBAZ3JhcGhpY2FsUGFydHlXaW5kb3cueSA9IEBhY3Rpb25XaW5kb3cueQogICAgICAgIEBncmFwaGljYWxQYXJ0eVdpbmRvdy53aWR0aCA9IEdyYXBoaWNzLndpZHRoCiAgICAgICAgQGdyYXBoaWNhbFBhcnR5V2luZG93LmhlaWdodCA9IDExNCAqIFdpbmRvd19CYXNlLnNjYWxlCiAgICAgICAgQGdyYXBoaWNhbFBhcnR5V2luZG93LmN1cnNvclZpc2libGUgPSBubwogICAgICAgIEBncmFwaGljYWxQYXJ0eVdpbmRvdy5yZWRyYXcoKQogICAgICAgIAogICAgICAgIGZvciBiYXR0bGVyIGluIEBiYXR0bGVyU3ByaXRlcwogICAgICAgICAgICBiYXR0bGVyLnByZXBhcmUoKQogICAgICAgICAgICAKICAgICAgICBAaXRlbXNXaW5kb3dzZXQgPSBuZXcgV2luZG93c2V0X0l0ZW1zKDAsIDAsIEB1aVZpZXdwb3J0LCBHcmFwaGljcy53aWR0aCkKICAgICAgICBAaXRlbXNXaW5kb3dzZXQub25JdGVtU2VsZWN0aW9uID0gKGl0ZW0pID0+IEBvbkl0ZW1TZWxlY3Rpb24oaXRlbSkKICAgICAgICBAaXRlbXNXaW5kb3dzZXQub25DYW5jZWwgPSA9PiBAb25JdGVtU2VsZWN0aW9uQ2FuY2VsKCkKICAgICAgICBAaXRlbXNXaW5kb3dzZXQuaXRlbXMgPSBbeyBpdGVtOiBSZWNvcmRNYW5hZ2VyLml0ZW1zWzBdLCBwcmljZTogNTAgfV0KICAgICAgICBAaXRlbXNXaW5kb3dzZXQuc2hvdyhubykKICAgICAgICAKICAgICAgICBAc2tpbGxzV2luZG93c2V0ID0gbmV3IFdpbmRvd3NldF9Ta2lsbHMoMCwgMCwgQHVpVmlld3BvcnQsIEdyYXBoaWNzLndpZHRoKQogICAgICAgIEBza2lsbHNXaW5kb3dzZXQub25Ta2lsbFNlbGVjdGlvbiA9IChpdGVtKSA9PiBAb25Ta2lsbFNlbGVjdGlvbihpdGVtKQogICAgICAgIEBza2lsbHNXaW5kb3dzZXQub25DYW5jZWwgPSA9PiBAb25Ta2lsbFNlbGVjdGlvbkNhbmNlbCgpCiAgICAgICAgQHNraWxsc1dpbmRvd3NldC5zaG93KG5vKQogICAgICAgIAogICAgICAgIEB0YXJnZXRTZWxlY3Rpb25XaW5kb3cgPSBuZXcgV2luZG93X1RhcmdldFNlbGVjdGlvbigwLCBAYWN0aW9uV2luZG93LnksIEB1aVZpZXdwb3J0KQogICAgICAgIEB0YXJnZXRTZWxlY3Rpb25XaW5kb3cudmlzaWJsZSA9IG5vICAgIAogICAgICAgIEB0YXJnZXRTZWxlY3Rpb25XaW5kb3cueiA9IDEKICAgICAgICBAdGFyZ2V0U2VsZWN0aW9uV2luZG93LmhlaWdodCA9IEBhY3Rpb25XaW5kb3cuaGVpZ2h0CiAgICAgICAgQHRhcmdldFNlbGVjdGlvbldpbmRvdy5vblNlbGVjdGlvbkNoYW5nZSA9ID0+IEBvblRhcmdldFNlbGVjdGlvbkNoYW5nZSgpCiAgICAgICAgQHRhcmdldFNlbGVjdGlvbldpbmRvdy5vblRhcmdldFNlbGVjdGlvbiA9ID0+IEBvblRhcmdldFNlbGVjdGlvbigpCiAgICAgICAgQHRhcmdldFNlbGVjdGlvbldpbmRvdy5vbkNhbmNlbCA9ID0+IEBvblRhcmdldFNlbGVjdGlvbkNhbmNlbCgpCiAgICAgICAgCiAgICAgICAgYXBwZWFyU3RyaW5nID0gbGNzKHZvY2FiLmJhdHRsZS5hcHBlYXJzKQogICAgICAgIGZvciBlbmVteSBpbiBAZW5lbWllcwogICAgICAgICAgICBpZiBub3QgZW5lbXkuaXNIaWRkZW4KICAgICAgICAgICAgICAgIEBtZXNzYWdlQ29udGFpbmVyLmFkZE1lc3NhZ2UoMCwgYXBwZWFyU3RyaW5nLnJlcGxhY2UoIntlbmVteX0iLCBlbmVteS5hY3Rvci5uYW1lKSkKICAgICAgICBAbWVzc2FnZUNvbnRhaW5lci5yZWZyZXNoTmVlZGVkID0geWVzCiAgICAgICAgCiAgICAgICAgQGNoZWNrQmF0dGxlRXZlbnRDb25kaXRpb25zKCkKICAgICAgICAKICAgICAgICBpZiBHYW1lTWFuYWdlci5iYXR0bGVNdXNpYz8KICAgICAgICAgICAgQXVkaW9NYW5hZ2VyLnBsYXlNdXNpYyhHYW1lTWFuYWdlci5iYXR0bGVNdXNpYykKICAgICAgICAgICAgCiAgICAgICAgQGNoZWNrQmF0dGxlRW5kKCkKICAgIHVwZGF0ZUFjdGlvbk9yZGVyOiAtPgogICAgICAgIEBhY3Rpb25MaXN0LnNvcnQgKGEsIGIpID0+CiAgICAgICAgICAgIGl0ZW0gPSBhLml0ZW0gfHwgYS5za2lsbAogICAgICAgICAgICBpZiAoYS5iYXR0bGVyLmFnaStpdGVtLnNwZWVkKSA+IGIuYmF0dGxlci5hZ2kKICAgICAgICAgICAgICAgIHJldHVybiAxCiAgICAgICAgICAgIGVsc2UgaWYgKGEuYmF0dGxlci5hZ2kraXRlbS5zcGVlZCkgPCBiLmJhdHRsZXIuYWdpCiAgICAgICAgICAgICAgICByZXR1cm4gLTEKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgcmV0dXJuIDAKICAgIHVwZGF0ZVNjcm9sbGluZzogKGluZm8sIHNwcml0ZSkgLT4KICAgICAgICBpZiBpbmZvPyBhbmQgc3ByaXRlPwogICAgICAgICAgICBpZiBpbmZvLmxvb3BYIHRoZW4gc3ByaXRlLm94ICs9IGluZm8uc2Nyb2xsLngKICAgICAgICAgICAgaWYgaW5mby5sb29wWSB0aGVuIHNwcml0ZS5veSArPSBpbmZvLnNjcm9sbC55CiAgICAgICAgCiAgICB1cGRhdGVCYWNrZ3JvdW5kOiAtPiBpZiBAdGVycmFpbj8gdGhlbiBAdXBkYXRlU2Nyb2xsaW5nKEB0ZXJyYWluLmJhY2tncm91bmQsIEBiYWNrZ3JvdW5kU3ByaXRlKQogICAgdXBkYXRlRm9yZWdyb3VuZDogLT4gaWYgQHRlcnJhaW4/IHRoZW4gQHVwZGF0ZVNjcm9sbGluZyhAdGVycmFpbi5mb3JlZ3JvdW5kLCBAZm9yZWdyb3VuZFNwcml0ZSkKICAgIAogICAgdXBkYXRlVWk6IC0+CiAgICAgICAgQGFjdGlvbldpbmRvdy51cGRhdGUoKQogICAgICAgIEBwYXJ0eVdpbmRvdy51cGRhdGUoKQogICAgICAgIEBncmFwaGljYWxQYXJ0eVdpbmRvdy51cGRhdGUoKQogICAgICAgIEBpdGVtc1dpbmRvd3NldC51cGRhdGUoKQogICAgICAgIEBza2lsbHNXaW5kb3dzZXQudXBkYXRlKCkKICAgICAgICBAdGFyZ2V0U2VsZWN0aW9uV2luZG93LnVwZGF0ZSgpCiAgICAgICAgQG1lc3NhZ2VDb250YWluZXIudXBkYXRlKCkKICAgICAgICBAbWVzc2FnZUNvbnRhaW5lclNwcml0ZXNldC51cGRhdGUoKQogICAgICAgIAogICAgdXBkYXRlQW5pbWF0aW9uczogLT4KICAgICAgICBmb3IgYW5pbWF0aW9uIGluIEB0ZXh0QW5pbWF0aW9ucwogICAgICAgICAgICBpZiBhbmltYXRpb24/CiAgICAgICAgICAgICAgICBhbmltYXRpb24udXBkYXRlKCkKICAgICAgICAgICAgICAgIAogICAgICAgIGZvciBhbmltYXRpb24gaW4gQGNvbXBsZXhBbmltYXRpb25zCiAgICAgICAgICAgIGlmIGFuaW1hdGlvbj8KICAgICAgICAgICAgICAgIGFuaW1hdGlvbi51cGRhdGUoKQogICAgICAgICAgICAgICAgCiAgICAgICAgZm9yIGFuaW1hdGlvbiBpbiBAc2ltcGxlQW5pbWF0aW9ucwogICAgICAgICAgICBpZiBhbmltYXRpb24/CiAgICAgICAgICAgICAgICBhbmltYXRpb24udXBkYXRlKCkKICAgICAgICAgICAgICAgIGFuaW1hdGlvbi52aXNpYmxlID0gYW5pbWF0aW9uLmxvZ2ljPyBhbmQgYW5pbWF0aW9uLmxvZ2ljLmlzUnVubmluZwogICAgICAgICAKICAgICAgICBmb3IgYmF0dGxlciBpbiBAYmF0dGxlcnMgIAogICAgICAgICAgICBhbmltYXRpb25zID0gYmF0dGxlci5jdXJyZW50QW5pbWF0aW9ucwogICAgICAgICAgICBpZiBhbmltYXRpb25zPwogICAgICAgICAgICAgICAgZm9yIGkgaW4gWzAuLi5hbmltYXRpb25zLmxlbmd0aF0KICAgICAgICAgICAgICAgICAgICBhbmltYXRpb24gPSBpZiBhbmltYXRpb25zW2ldPyB0aGVuIGFuaW1hdGlvbnNbaV0uYW5pbWF0aW9uIGVsc2UgbnVsbAogICAgICAgICAgICAgICAgICAgIGlmIGFuaW1hdGlvbj8gYW5kIGFuaW1hdGlvbnNbaV0udHlwZSAhPSAic2ltcGxlIgogICAgICAgICAgICAgICAgICAgICAgICBpZiBhbmltYXRpb24gYW5kIGFuaW1hdGlvbi50ZXh0PyBhbmQgKG5vdCBAdGV4dEFuaW1hdGlvbnNbaV0/IG9yIGFuaW1hdGlvbiAhPSBAdGV4dEFuaW1hdGlvbnNbaV0ubG9naWMpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBub3QgQHRleHRBbmltYXRpb25zW2ldPyB0aGVuIEB0ZXh0QW5pbWF0aW9uc1tpXSA9IG5ldyBTcHJpdGVfRGFtYWdlKG51bGwsIEB2aWV3cG9ydCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIEB0ZXh0QW5pbWF0aW9uc1tpXS5sb2dpYyA9IGFuaW1hdGlvbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgQHRleHRBbmltYXRpb25zW2ldLnogPSAyMAogICAgICAgICAgICAgICAgICAgICAgICAgICAgQHRleHRBbmltYXRpb25zW2ldLnRhcmdldCA9IEBzcHJpdGVGb3JMb2dpYyhiYXR0bGVyKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgQHRleHRBbmltYXRpb25zW2ldLnJlZnJlc2goKQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIGFuaW1hdGlvbnNbaV0udHlwZSA9PSAiY29tcGxleCIgYW5kIG5vdCBhbmltYXRpb24udGV4dCBhbmQgKG5vdCBAY29tcGxleEFuaW1hdGlvbnNbaV0/IG9yIEBjb21wbGV4QW5pbWF0aW9uc1tpXS5sb2dpYyAhPSBhbmltYXRpb24pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBub3QgQGNvbXBsZXhBbmltYXRpb25zW2ldPyB0aGVuIEBjb21wbGV4QW5pbWF0aW9uc1tpXSA9IG5ldyBTcHJpdGVzZXRfQW5pbWF0aW9uKGFuaW1hdGlvbiwgQHZpZXdwb3J0KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgQGNvbXBsZXhBbmltYXRpb25zW2ldLmxvZ2ljID0gYW5pbWF0aW9uICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBjb21wbGV4QW5pbWF0aW9uc1tpXS5yZWZyZXNoKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBjb21wbGV4QW5pbWF0aW9uc1tpXS50YXJnZXQuc3ByaXRlID0gQHNwcml0ZUZvckxvZ2ljKGJhdHRsZXIpCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgYW5pbWF0aW9uc1tpXS50eXBlLnN0YXJ0c1dpdGgoInNpbXBsZV8iKSBhbmQgKG5vdCBAc2ltcGxlQW5pbWF0aW9uc1tpXT8gb3IgQHNpbXBsZUFuaW1hdGlvbnNbaV0ubG9naWMgIT0gYW5pbWF0aW9uKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgbm90IEBzaW1wbGVBbmltYXRpb25zW2ldPyB0aGVuIEBzaW1wbGVBbmltYXRpb25zW2ldID0gbmV3IFNwcml0ZV9TaW1wbGVBbmltYXRpb24oYW5pbWF0aW9uLCBAdmlld3BvcnQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZUJhdHRsZXIgPSBudWxsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRCYXR0bGVyID0gbnVsbAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlQW5pbWF0aW9uID0gbnVsbAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0QW5pbWF0aW9uID0gbnVsbAogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgYW5pbWF0aW9uc1tpXS50eXBlID09ICJzaW1wbGVfZm9yd2FyZCIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VCYXR0bGVyID0gYmF0dGxlci5hdHRhY2tlcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldEJhdHRsZXIgPSBiYXR0bGVyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlQW5pbWF0aW9uID0gc291cmNlQmF0dGxlci51c2VyQW5pbWF0aW9uCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0QW5pbWF0aW9uID0gdGFyZ2V0QmF0dGxlci50YXJnZXRBbmltYXRpb24KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2VCYXR0bGVyID0gYmF0dGxlcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldEJhdHRsZXIgPSBiYXR0bGVyLmF0dGFja2VyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlQW5pbWF0aW9uID0gc291cmNlQmF0dGxlci50YXJnZXRBbmltYXRpb24KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRBbmltYXRpb24gPSBudWxsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhdHRsZXJTcHJpdGUgPSBAc3ByaXRlRm9yTG9naWMoc291cmNlQmF0dGxlcikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwcml0ZXNldCA9IG5ldyBTcHJpdGVzZXRfQW5pbWF0aW9uKHNvdXJjZUFuaW1hdGlvbikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50ID0gc3ByaXRlc2V0LmNhbGN1bGF0ZUxhc3RMaW5rUG9pbnQoYmF0dGxlclNwcml0ZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbi5zb3VyY2UgPSBwb2ludAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ByaXRlc2V0LmRpc3Bvc2UoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBub3QgcG9pbnQueD8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmltYXRpb24uc291cmNlID0gCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeDogYmF0dGxlclNwcml0ZS54ICsgYmF0dGxlclNwcml0ZS5zcmNSZWN0LndpZHRoIC8gMiAtIDk2LCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeTogYmF0dGxlclNwcml0ZS55ICsgYmF0dGxlclNwcml0ZS5zcmNSZWN0LmhlaWdodCAvIDIgLSA5NgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhdHRsZXJTcHJpdGUgPSBAc3ByaXRlRm9yTG9naWModGFyZ2V0QmF0dGxlcikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHRhcmdldEFuaW1hdGlvbj8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcHJpdGVzZXQgPSBuZXcgU3ByaXRlc2V0X0FuaW1hdGlvbih0YXJnZXRBbmltYXRpb24pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnQgPSBzcHJpdGVzZXQuY2FsY3VsYXRlRmlyc3RMaW5rUG9pbnQoYmF0dGxlclNwcml0ZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmltYXRpb24udGFyZ2V0ID0gcG9pbnQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcHJpdGVzZXQuZGlzcG9zZSgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIG5vdCB0YXJnZXRBbmltYXRpb24/IG9yIG5vdCBwb2ludC54PwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbi50YXJnZXQgPSAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB4OiBiYXR0bGVyU3ByaXRlLnggKyBiYXR0bGVyU3ByaXRlLnNyY1JlY3Qud2lkdGggLyAyIC0gOTYsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5OiBiYXR0bGVyU3ByaXRlLnkgKyBiYXR0bGVyU3ByaXRlLnNyY1JlY3QuaGVpZ2h0IC8gMiAtIDk2CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBzaW1wbGVBbmltYXRpb25zW2ldLmxvZ2ljID0gYW5pbWF0aW9uICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBzaW1wbGVBbmltYXRpb25zW2ldLnJlZnJlc2goKQogICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmltYXRpb24uc3RhcnQoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAKICAgIHVwZGF0ZTogLT4KICAgICAgICBAdXBkYXRlQmF0dGxlRXZlbnQoKQogICAgICAgIAogICAgICAgIEdhbWVNYW5hZ2VyLmJhY2tncm91bmQudmlzaWJsZSA9IHllcwogICAgICAgIEdhbWVNYW5hZ2VyLmludGVyZmFjZS52aXNpYmxlID0geWVzCiAgICAgICAgR2FtZU1hbmFnZXIudXBkYXRlKCkKICAgICAgICAgIAogICAgICAgIEB1cGRhdGVVaSgpCiAgICAgICAgQHVwZGF0ZUJhY2tncm91bmQoKQogICAgICAgIEB1cGRhdGVGb3JlZ3JvdW5kKCkKICAgICAgICAKICAgICAgICBAZ3JhcGhpY2FsUGFydHlXaW5kb3cudmlzaWJsZSA9IG5vdCBAcGxheWVyc1R1cm4KICAgICAgICBAcGFydHlXaW5kb3cudmlzaWJsZSA9IEBwbGF5ZXJzVHVybgogICAgICAgIEBhY3Rpb25XaW5kb3cudmlzaWJsZSA9IEBwbGF5ZXJzVHVybgogICAgICAgIAogICAgICAgIGZvciBiYXR0bGVyIGluIEBiYXR0bGVycwogICAgICAgICAgICBiYXR0bGVyLmFuaW1hdGlvblBoYXNlID0gQGFuaW1hdGlvblBoYXNlCiAgICAgICAgICAgIGJhdHRsZXIudXBkYXRlKCkKICAgICAgICAgIAogICAgICAgIEB1cGRhdGVBbmltYXRpb25zKCkKICAgICAgICAKICAgICAgICBpZiBAYW5pbWF0aW9uc1J1bm5pbmcgCiAgICAgICAgICAgIEBhbmltYXRpb25zUnVubmluZyA9IG5vICAgIAogICAgICAgICAgICBmb3IgYmF0dGxlciBpbiBAYmF0dGxlcnMKICAgICAgICAgICAgICAgIGlmIGJhdHRsZXIuaXNBbmltYXRpb25SdW5uaW5nCiAgICAgICAgICAgICAgICAgICAgQGFuaW1hdGlvbnNSdW5uaW5nID0geWVzCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIG5vdCBAYW5pbWF0aW9uc1J1bm5pbmcKICAgICAgICAgICAgICAgIGFuaW1hdGlvblBoYXNlTWF4ID0gMAogICAgICAgICAgICAgICAgZm9yIGJhdHRsZXIgaW4gQGJhdHRsZXJzCiAgICAgICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvblBoYXNlTWF4ID0gTWF0aC5tYXgoYW5pbWF0aW9uUGhhc2VNYXgsIGJhdHRsZXIuYW5pbWF0aW9ucy5sZW5ndGgtMSkKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBoYXNBbmltYXRpb25zID0gbm8KICAgICAgICAgICAgICAgIEBhbmltYXRpb25QaGFzZSsrCiAgICAgICAgICAgICAgICB3aGlsZSBub3QgaGFzQW5pbWF0aW9ucyBhbmQgQGFuaW1hdGlvblBoYXNlIDw9IGFuaW1hdGlvblBoYXNlTWF4CiAgICAgICAgICAgICAgICAgICAgZm9yIGJhdHRsZXIgaW4gQGJhdHRsZXJzCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGJhdHRsZXIuYW5pbWF0aW9uc1tAYW5pbWF0aW9uUGhhc2VdPwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGFuaW1hdGlvbiBpbiBiYXR0bGVyLmFuaW1hdGlvbnNbQGFuaW1hdGlvblBoYXNlXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGFuaW1hdGlvbj8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzQW5pbWF0aW9ucyA9IHllcwogICAgICAgICAgICAgICAgICAgIGlmIG5vdCBoYXNBbmltYXRpb25zCiAgICAgICAgICAgICAgICAgICAgICAgIEBhbmltYXRpb25QaGFzZSsrCiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBAYW5pbWF0aW9uc1J1bm5pbmcgPSB5ZXMKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaWYgQGFuaW1hdGlvblBoYXNlID4gYW5pbWF0aW9uUGhhc2VNYXgKICAgICAgICAgICAgICAgICAgICBAYW5pbWF0aW9uUGhhc2UgPSAwCiAgICAgICAgICAgICAgICAgICAgQGFuaW1hdGlvbnNSdW5uaW5nID0gbm8KICAgICAgICAgICAgICAgICAgICBHcmFwaGljcy52aWV3cG9ydC5veSA9IDAKICAgICAgICAKICAgICAgICBmb3Igc3ByaXRlIGluIEBiYXR0bGVyU3ByaXRlcwogICAgICAgICAgICBzcHJpdGUudXBkYXRlKCkKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAogICAgICAgIGlmIEBpbnRlcnByZXRlci5pc1J1bm5pbmcKICAgICAgICAgICAgc3VwZXIoKQogICAgICAgICAgICByZXR1cm4KIAogICAgICAgIGlmIG5vdCBAYmF0dGxlV29uIGFuZCBub3QgQGJhdHRsZUxvc3QKICAgICAgICAgICAgaWYgQHBsYXllcnNUdXJuCiAgICAgICAgICAgICAgICBAYWN0aW9uV2luZG93LmN1cnNvclZpc2libGUgPSB5ZXMKICAgICAgICAgICAgICAgIEBwYXJ0eVdpbmRvdy5jdXJzb3JWaXNpYmxlID0geWVzICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgIGVsc2UgaWYgbm90IEBwcm9jZXNzaW5nQWN0aW9uTGlzdAogICAgICAgICAgICAgICAgQGFjdGlvbldpbmRvdy5jdXJzb3JWaXNpYmxlID0gbm8KICAgICAgICAgICAgICAgIEBwYXJ0eVdpbmRvdy5jdXJzb3JWaXNpYmxlID0gbm8KICAgICAgICAgICAgICAgIGZvciBlbmVteSBpbiBAZW5lbWllcwogICAgICAgICAgICAgICAgICAgIGlmIG5vdCBlbmVteS5pc0hpZGRlbiBhbmQgZW5lbXkuYWN0b3IuaXNBbGl2ZQogICAgICAgICAgICAgICAgICAgICAgICBpZiBlbmVteS5mb3JjZWRBY3Rpb24/CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgciBpbiBbMC4uLmVuZW15LmZvcmNlZEFjdGlvbi5za2lsbC5yZXBlYXRzXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBhY3Rpb25MaXN0LnB1c2goZW5lbXkuZm9yY2VkQWN0aW9uKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5lbXkubGFzdFRhcmdldCA9IGVuZW15LmZvcmNlZEFjdGlvbi50YXJnZXRzWzBdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmVteS5mb3JjZWRBY3Rpb24gPSBudWxsCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbiA9IGVuZW15LnRha2VBY3Rpb24oMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGFjdGlvbj8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24udGFyZ2V0cyA9IGVuZW15LnNlbGVjdFRhcmdldHMoYWN0aW9uLnNraWxsLnNjb3BlLCBAZW5lbWllcywgQG1lbWJlcnMsIEBiYXR0bGVycykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmVteS5sYXN0VGFyZ2V0ID0gYWN0aW9uLnRhcmdldHNbMF0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgciBpbiBbMC4uLmFjdGlvbi5za2lsbC5yZXBlYXRzXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBAYWN0aW9uTGlzdC5wdXNoKGFjdGlvbikKICAgICAgICAgICAgICAgIEB1cGRhdGVBY3Rpb25PcmRlcigpCiAgICAgICAgICAgICAgICBAcHJvY2Vzc2luZ0FjdGlvbkxpc3QgPSB5ZXMKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZm9yIGJhdHRsZXIgaW4gQGJhdHRsZXJzCiAgICAgICAgICAgICAgICAgICAgYmF0dGxlci5hcHBseUV4UGFyYW1ldGVycygpCiAgICAgICAgICAgIGVsc2UgaWYgbm90IEBhbmltYXRpb25zUnVubmluZwogICAgICAgICAgICAgICAgQGNoZWNrQmF0dGxlRW5kKCkKICAgICAgICAgICAgICAgIGlmIEBhY3Rpb25Qb2ludGVyID49IEBhY3Rpb25MaXN0Lmxlbmd0aCBvciBAYmF0dGxlRW5kCiAgICAgICAgICAgICAgICAgICAgQHVwZGF0ZUJhdHRsZXJzKCkKICAgICAgICAgICAgICAgICAgICBAYWN0aW9uV2luZG93LmFjdGl2ZSA9IHllcwogICAgICAgICAgICAgICAgICAgIEBhY3Rpb25Qb2ludGVyID0gMAogICAgICAgICAgICAgICAgICAgIEB1cGRhdGVCYXR0bGVyU3ByaXRlcygpCiAgICAgICAgICAgICAgICAgICAgQHBhcnR5V2luZG93LnJlZHJhdygpCiAgICAgICAgICAgICAgICAgICAgQGdyYXBoaWNhbFBhcnR5V2luZG93LnJlZHJhdygpCiAgICAgICAgICAgICAgICAgICAgQHByb2Nlc3NpbmdBY3Rpb25MaXN0ID0gbm8KICAgICAgICAgICAgICAgICAgICBAcGxheWVyc1R1cm4gPSB5ZXMKICAgICAgICAgICAgICAgICAgICBAYWN0aW9uTGlzdCA9IFtdCiAgICAgICAgICAgICAgICAgICAgQHNlbGVjdFZhbGlkTWVtYmVyKCkKICAgICAgICAgICAgICAgICAgICBAdHVybisrCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgZm9yIGJhdHRsZXIgaW4gQGJhdHRsZXJzCiAgICAgICAgICAgICAgICAgICAgICAgIGJhdHRsZXIuY2hlY2tTdGF0ZXMobm8sIHllcywgbm8sIEB0dXJuLTEsIDAsIDApCiAgICAgICAgICAgICAgICAgICAgICAgIGJhdHRsZXIuYWN0b3IucmVmcmVzaCgpCiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGlmIEBiYXR0bGVFbmQKICAgICAgICAgICAgICAgICAgICAgICAgQGFjdGlvbldpbmRvdy5hY3RpdmUgPSBubwogICAgICAgICAgICAgICAgICAgICAgICBAYWN0aW9uV2luZG93LnZpc2libGUgPSBubwogICAgICAgICAgICAgICAgICAgICAgICBAcGFydHlXaW5kb3cudmlzaWJsZSA9IG5vCiAgICAgICAgICAgICAgICAgICAgICAgIEBwbGF5ZXJzVHVybiA9IG5vCiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgQGNoZWNrQmF0dGxlRXZlbnRDb25kaXRpb25zKCkKICAgICAgICAgICAgICAgICAgICBhY3Rpb24gPSBAYWN0aW9uTGlzdFtAYWN0aW9uUG9pbnRlcl0KICAgICAgICAgICAgICAgICAgICBAYWN0aW9uV2luZG93LmFjdGl2ZSA9IG5vCiAgICAgICAgICAgICAgICAgICAgQHVwZGF0ZUJhdHRsZXJzKCkKICAgICAgICAgICAgICAgICAgICBAcGFydHlXaW5kb3cucmVkcmF3KCkKICAgICAgICAgICAgICAgICAgICBAZ3JhcGhpY2FsUGFydHlXaW5kb3cucmVkcmF3KCkKICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggYWN0aW9uLnR5cGUKICAgICAgICAgICAgICAgICAgICAgICAgd2hlbiAxICMgSXRlbQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgYWN0aW9uLmJhdHRsZXIuYWN0b3IuaXNBbGl2ZSBhbmQgbm90IGFjdGlvbi5iYXR0bGVyLmFjdG9yLmlzSGlkZGVuIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5iYXR0bGVyLnRhcmdldHMgPSBbXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGFjdGlvbi50YXJnZXRzLmxlbmd0aCA9PSAxIGFuZCBub3QgYWN0aW9uLnRhcmdldHNbMF0uYWN0b3IuaXNBbGl2ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBAbWVtYmVycy5pbmRleE9mKGFjdGlvbi5iYXR0bGVyKSAhPSAtMQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLnRhcmdldHMgPSBhY3Rpb24uYmF0dGxlci5zZWxlY3RUYXJnZXRzKGFjdGlvbi5pdGVtLml0ZW0uc2NvcGUsIEBtZW1iZXJzLCBAZW5lbWllcywgQGJhdHRsZXJzKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24udGFyZ2V0cyA9IGFjdGlvbi5iYXR0bGVyLnNlbGVjdFRhcmdldHMoYWN0aW9uLml0ZW0uaXRlbS5zY29wZSwgQGVuZW1pZXMsIEBtZW1iZXJzLCBAYmF0dGxlcnMpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLmJhdHRsZXIudGFyZ2V0cyA9IGFjdGlvbi50YXJnZXRzCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLmJhdHRsZXIudXNlSXRlbShhY3Rpb24uaXRlbS5pdGVtKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICNpZiBhY3Rpb24uYmF0dGxlci50YXJnZXRzLmxlbmd0aCA9PSAxCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyAgICBAc3ByaXRlRm9yTG9naWMoYWN0aW9uLmJhdHRsZXIpLnRhcmdldCA9IEBzcHJpdGVGb3JMb2dpYyhhY3Rpb24udGFyZ2V0c1swXSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyAgQG1lc3NhZ2VDb250YWluZXIubWVzc2FnZXMgPSBbXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGFjdGlvbi5pdGVtLml0ZW0udXNpbmdNZXNzYWdlPwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBAbWVzc2FnZUNvbnRhaW5lci5hZGRNZXNzYWdlKDAsICIje2FjdGlvbi5iYXR0bGVyLmFjdG9yLm5hbWV9ICN7YWN0aW9uLml0ZW0uaXRlbS51c2luZ01lc3NhZ2V9IikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQG1lc3NhZ2VDb250YWluZXIucmVmcmVzaE5lZWRlZCA9IHllcwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQG1lc3NhZ2VDb250YWluZXIuYWRkTWVzc2FnZSgwLCAiI3thY3Rpb24uYmF0dGxlci5hY3Rvci5uYW1lfSB1c2VzICN7YWN0aW9uLml0ZW0uaXRlbS5uYW1lfSEiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBAbWVzc2FnZUNvbnRhaW5lci5yZWZyZXNoTmVlZGVkID0geWVzCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBhbmltYXRpb25zUnVubmluZyA9IHllcwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5pdGVtLmNvdW50KysKICAgICAgICAgICAgICAgICAgICAgICAgd2hlbiAyICMgU2tpbGwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGFjdGlvbi5iYXR0bGVyLmFjdG9yLmlzQWxpdmUgYW5kIG5vdCBhY3Rpb24uYmF0dGxlci5hY3Rvci5pc0hpZGRlbiAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLmJhdHRsZXIudGFyZ2V0cyA9IFtdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgYWN0aW9uLnRhcmdldHMubGVuZ3RoID09IDEgYW5kIG5vdCBhY3Rpb24udGFyZ2V0c1swXS5hY3Rvci5pc0FsaXZlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIEBtZW1iZXJzLmluZGV4T2YoYWN0aW9uLmJhdHRsZXIpICE9IC0xCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24udGFyZ2V0cyA9IGFjdGlvbi5iYXR0bGVyLnNlbGVjdFRhcmdldHMoYWN0aW9uLnNraWxsLnNjb3BlLCBAbWVtYmVycywgQGVuZW1pZXMsIEBiYXR0bGVycykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLnRhcmdldHMgPSBhY3Rpb24uYmF0dGxlci5zZWxlY3RUYXJnZXRzKGFjdGlvbi5za2lsbC5zY29wZSwgQGVuZW1pZXMsIEBtZW1iZXJzLCBAYmF0dGxlcnMpCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24uYmF0dGxlci50YXJnZXRzID0gYWN0aW9uLnRhcmdldHMKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24uYmF0dGxlci51c2VTa2lsbChhY3Rpb24uc2tpbGwpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIGlmIGFjdGlvbi5iYXR0bGVyLnRhcmdldHMubGVuZ3RoID09IDEKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgICAgIEBzcHJpdGVGb3JMb2dpYyhhY3Rpb24uYmF0dGxlcikudGFyZ2V0ID0gQHNwcml0ZUZvckxvZ2ljKGFjdGlvbi50YXJnZXRzWzBdKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgIEBtZXNzYWdlQ29udGFpbmVyLm1lc3NhZ2VzID0gW10KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBhY3Rpb24uc2tpbGwudXNpbmdNZXNzYWdlPwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBAbWVzc2FnZUNvbnRhaW5lci5hZGRNZXNzYWdlKDAsICIje2FjdGlvbi5iYXR0bGVyLmFjdG9yLm5hbWV9ICN7YWN0aW9uLnNraWxsLnVzaW5nTWVzc2FnZX0iKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBAbWVzc2FnZUNvbnRhaW5lci5yZWZyZXNoTmVlZGVkID0geWVzCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQGFuaW1hdGlvbnNSdW5uaW5nID0geWVzCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICNAYmF0dGxlclNwcml0ZXNbYWN0aW9uLnNvdXJjZV0udGFyZ2V0ID0gQGJhdHRsZXJTcHJpdGVzW3RhcmdldF0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgd2hlbiAzICMgR3VhcmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGFjdGlvbi5iYXR0bGVyLmFjdG9yLmlzQWxpdmUgYW5kIG5vdCBhY3Rpb24uYmF0dGxlci5hY3Rvci5pc0hpZGRlbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5iYXR0bGVyLmd1YXJkKCkKICAgICAgICAKICAgICAgICAgICAgICAgICAgICBhY3Rpb24uYmF0dGxlci5hY3Rvci5yZWZyZXNoKCkKICAgICAgICAgICAgICAgICAgICBpZiBhY3Rpb24uYmF0dGxlci5hY3Rvci5pc0FsaXZlIGFuZCBub3QgYWN0aW9uLmJhdHRsZXIuYWN0b3IuaXNIaWRkZW4gCiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5iYXR0bGVyLmNoZWNrU3RhdGVzKHllcywgbm8sIG5vLCBAdHVybiwgMCwgMCkKICAgICAgICAgICAgICAgICAgICBmb3IgdGFyZ2V0IGluIGFjdGlvbi50YXJnZXRzCiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldC5hY3Rvci5yZWZyZXNoKCkKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBAYWN0aW9uUG9pbnRlcisrIAogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgICAgIAogICAgICAgIHN1cGVyKCkKICAgIAogICAgdHJhbnNmb3JtRW5lbXk6KGVuZW15SWQsIHRhcmdldCkgLT4KICAgICAgICBlbmVteSA9IEBlbmVtaWVzW2VuZW15SWRdCiAgICAgICAgaWYgZW5lbXk/IGFuZCBlbmVteS5hY3Rvci5pc0FsaXZlCiAgICAgICAgICAgIG5ld0VuZW15ID0gbmV3IExvZ2ljX0JhdHRsZXIobmV3IExvZ2ljX0VuZW15KHRhcmdldCkpCiAgICAgICAgICAgIG5ld0VuZW15LmFjdG9yLmxwID0gZW5lbXkuYWN0b3IubHAKICAgICAgICAgICAgbmV3RW5lbXkuYWN0b3IubXAgPSBlbmVteS5hY3Rvci5tcAogICAgICAgICAgICAKICAgICAgICAgICAgQGVuZW1pZXNbZW5lbXlJZF0gPSBuZXdFbmVteQogICAgICAgICAgICBpbmRleCA9IEBhbGl2ZUVuZW1pZXMuaW5kZXhPZihlbmVteSkKICAgICAgICAgICAgQGFsaXZlRW5lbWllc1tpbmRleF0gPSBuZXdFbmVteQogICAgICAgICAgICBpbmRleCA9IEBhbGl2ZUVuZW1pZXMuaW5kZXhPZihlbmVteSkKICAgICAgICAgICAgQGJhdHRsZXJzW2luZGV4XSA9IG5ld0VuZW15CiAgICAgICAgICAgIGluZGV4ID0gQGFsaXZlRW5lbWllcy5pbmRleE9mKGVuZW15KQogICAgICAgICAgICBAb3JkZXJlZEJhdHRsZXJzW2luZGV4XSA9IG5ld0VuZW15CiAgICAgICAgICAgIHNwcml0ZSA9IEBlbmVteVNwcml0ZXNbZW5lbXlJZF0KICAgICAgICAgICAgbmV3U3ByaXRlID0gbmV3IFNwcml0ZXNldF9CYXR0bGVyKG5ld0VuZW15KQogICAgICAgICAgICBAZW5lbXlTcHJpdGVzW2VuZW15SWRdID0gbmV3U3ByaXRlCiAgICAgICAgICAgIEBlbmVteVNwcml0ZXNbZW5lbXlJZF0uc3ByaXRlLnggPSBzcHJpdGUuc3ByaXRlLnggKyAoc3ByaXRlLnNwcml0ZS5iaXRtYXAud2lkdGggLSBuZXdTcHJpdGUuc3ByaXRlLmJpdG1hcC53aWR0aCkgLyAyCiAgICAgICAgICAgIEBlbmVteVNwcml0ZXNbZW5lbXlJZF0uc3ByaXRlLnkgPSBzcHJpdGUuc3ByaXRlLnkgKyAoc3ByaXRlLnNwcml0ZS5iaXRtYXAuaGVpZ2h0IC0gbmV3U3ByaXRlLnNwcml0ZS5iaXRtYXAuaGVpZ2h0KSAvIDIKICAgICAgICAgICAgaW5kZXggPSBAYmF0dGxlclNwcml0ZXMuaW5kZXhPZihzcHJpdGUpCiAgICAgICAgICAgIEBiYXR0bGVyU3ByaXRlc1tpbmRleF0gPSBuZXdTcHJpdGUKICAgICAgICAgICAgc3ByaXRlLmRpc3Bvc2UoKQogICAgICAgICAgICAKICAgIGZvcmNlQWN0aW9uOiAoc2tpbGwsIHVzZXIsIHRhcmdldCkgLT4KICAgICAgICB1c2VyLmZvcmNlZEFjdGlvbiA9IHsgdHlwZTogMiwgc2tpbGw6IHNraWxsLCBiYXR0bGVyOiB1c2VyLCB0YXJnZXRzOiBbdGFyZ2V0XSB9CiAgICAgICAgCiAgICBjaGVja0JhdHRsZUV2ZW50Q29uZGl0aW9uOiAoY29uZGl0aW9uKSAtPgogICAgICAgIHJlc3VsdCA9IG5vCiAgICAgICAgCiAgICAgICAgc3dpdGNoIGNvbmRpdGlvbi50eXBlCiAgICAgICAgICAgIHdoZW4gMCAjIEVhY2ggVHVybgogICAgICAgICAgICAgICAgcmVzdWx0ID0geWVzCiAgICAgICAgICAgIHdoZW4gMSAjIEZyb20gVHVybiBYIEVhY2ggWSBUdXJuCgogICAgICAgICAgICAgICAgcmVzdWx0ID0gaWYgQHR1cm4gPj0gY29uZGl0aW9uLmZyb21UdXJuIHRoZW4gKChAdHVybiAtIGNvbmRpdGlvbi5mcm9tVHVybikgJSBjb25kaXRpb24uZWFjaFR1cm4pID09IDAgZWxzZSBubwogICAgICAgICAgICB3aGVuIDIgIyBMUCBvZiBFbmVteSBYIGlzIFklCiAgICAgICAgICAgICAgICBlbmVteSA9IEBlbmVtaWVzW2NvbmRpdGlvbi5scEVuZW15SWRdCiAgICAgICAgICAgICAgICByZXN1bHQgPSBNYXRoLmZsb29yKGVuZW15LmFjdG9yLmxwIC8gZW5lbXkuYWN0b3IubWxwICogMTAwKSA8PSBjb25kaXRpb24uZW5lbXlMcAogICAgICAgICAgICB3aGVuIDMgIyBNUCBvZiBFbmVteSBYIGlzIFklCiAgICAgICAgICAgICAgICBlbmVteSA9IEBlbmVtaWVzW2NvbmRpdGlvbi5tcEVuZW15SWRdCiAgICAgICAgICAgICAgICByZXN1bHQgPSBNYXRoLmZsb29yKGVuZW15LmFjdG9yLm1wIC8gZW5lbXkuYWN0b3IubW1wICogMTAwKSA8PSBjb25kaXRpb24uZW5lbXlNcAogICAgICAgICAgICB3aGVuIDQgIyBTd2l0Y2ggWCBpcyBPTgogICAgICAgICAgICAgICAgcmVzdWx0ID0gR2FtZU1hbmFnZXIuYm9vbGVhbnNbY29uZGl0aW9uLnN3aXRjaC5pbmRleF0gPT0gY29uZGl0aW9uLnN3aXRjaFN0YXRlCiAgICAgICAgICAgIAogICAgICAgIHJldHVybiByZXN1bHQKICAgICAgCiAgICBjaGVja0JhdHRsZUV2ZW50Q29uZGl0aW9uczogLT4KICAgICAgICBmb3IgcGFnZSBpbiBAdHJvb3AucGFnZXMgYnkgLTEKICAgICAgICAgICAgaWYgbm90IHBhZ2UuZXhlY3V0ZWQKICAgICAgICAgICAgICAgIHZhbGlkYXRpb25SZXN1bHQgPSB5ZXMKICAgICAKICAgICAgICAgICAgICAgIGlmIHBhZ2UuY29uZGl0aW9uRW5hYmxlZDEKICAgICAgICAgICAgICAgICAgICB2YWxpZGF0aW9uUmVzdWx0ID0gQGNoZWNrQmF0dGxlRXZlbnRDb25kaXRpb24ocGFnZS5jb25kaXRpb24xKQogICAgICAgICAgICAgICAgaWYgdmFsaWRhdGlvblJlc3VsdCBhbmQgcGFnZS5jb25kaXRpb25FbmFibGVkMgogICAgICAgICAgICAgICAgICAgIHZhbGlkYXRpb25SZXN1bHQgPSBAY2hlY2tCYXR0bGVFdmVudENvbmRpdGlvbihwYWdlLmNvbmRpdGlvbjIpCiAgICAgICAgICAgICAgICBpZiB2YWxpZGF0aW9uUmVzdWx0IGFuZCBwYWdlLmNvbmRpdGlvbkVuYWJsZWQzCiAgICAgICAgICAgICAgICAgICAgdmFsaWRhdGlvblJlc3VsdCA9IEBjaGVja0JhdHRsZUV2ZW50Q29uZGl0aW9uKHBhZ2UuY29uZGl0aW9uMykKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGlmIHZhbGlkYXRpb25SZXN1bHQKICAgICAgICAgICAgICAgICAgICBwYWdlLmV4ZWN1dGVkID0geWVzCiAgICAgICAgICAgICAgICAgICAgcGFnZS5leGVjdXRpb25UdXJuID0gQHR1cm4KICAgICAgICAgICAgICAgICAgICBAaW50ZXJwcmV0ZXIuY29tbWFuZHMgPSBwYWdlLmNvbW1hbmRzCiAgICAgICAgICAgICAgICAgICAgQGludGVycHJldGVyLnN0YXJ0KCkKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAKICAgIHVwZGF0ZUJhdHRsZUV2ZW50OiAtPiAgIAogICAgICAgIGZvciBwYWdlIGluIEB0cm9vcC5wYWdlcwogICAgICAgICAgICBpZiBwYWdlLmV4ZWN1dGVkCiAgICAgICAgICAgICAgICBzd2l0Y2ggcGFnZS5leGVjdXRpb24KICAgICAgICAgICAgICAgICAgICB3aGVuIDEgIyBPbmNlIHBlciBUdXJuCiAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2UuZXhlY3V0ZWQgPSBwYWdlLmV4ZWN1dGlvblR1cm4gPT0gQHR1cm4KICAgICAgICAgICAgICAgICAgICB3aGVuIDIgIyBBdCB0aGUgTW9tZW50CiAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2UuZXhlY3V0ZWQgPSBubwogICAgICAgIEBpbnRlcnByZXRlci51cGRhdGUoKQogICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgCiAgICB1cGRhdGVCYXR0bGVyU3ByaXRlczogLT4KICAgICAgICAgICAgICAgIAogICAgdXBkYXRlQmF0dGxlcnM6IC0+CiAgICAgICAgZGVhZEJhdHRsZXJzID0gW10KICAgICAgICBiYXR0bGVyID0gbnVsbAogICAgICAgIGZvciBpIGluIFswLi4uQGVuZW1pZXMubGVuZ3RoXQogICAgICAgICAgICBiYXR0bGVyID0gQGVuZW1pZXNbaV0KICAgICAgICAgICAgaWYgYmF0dGxlci5hY3Rvci5scCA8PSAwIGFuZCBAZGVhZEVuZW1pZXMuaW5kZXhPZihiYXR0bGVyKSA9PSAtMQogICAgICAgICAgICAgICAgZGVhZEJhdHRsZXJzLnB1c2goYmF0dGxlcikKICAgICAgICAgICAgICAgIEBkZWFkRW5lbWllcy5wdXNoKGJhdHRsZXIpCiAgICAgICAgICAgICAgICBAYWxpdmVFbmVtaWVzLnJlbW92ZShiYXR0bGVyKQogICAgICAgICAgICAgICAgaWYgbm90IEBhbmltYXRpb25zUnVubmluZwogICAgICAgICAgICAgICAgICAgIGJhdHRsZXIuZGVhZCA9IHllcwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgI2lmIEBiYXR0bGVyU3ByaXRlc1tpXT8KICAgICAgICAgICAgICAgICAjICAgQGJhdHRsZXJTcHJpdGVzW2ldLmtpbGwoKQogICAgICAgICAgICAgICAgICAgIAogICAjICAgICBmb3IgaSBpbiBbMC4uLkBtZW1iZXJzLmxlbmd0aF0KICAgICMgICAgICAgIGJhdHRsZXIgPSBAbWVtYmVyc1tpXQogICAjICAgICAgICAgaWYgYmF0dGxlci5hY3Rvci5scCA8PSAwCiAgICAjICAgICAgICAgICAgaWYgQGJhdHRsZXJTcHJpdGVzW0BlbmVtaWVzLmxlbmd0aCArIGldPwogICAgIyAgICAgICAgICAgICAgICBAYmF0dGxlclNwcml0ZXNbQGVuZW1pZXMubGVuZ3RoICsgaV0ua2lsbCgpCiAgICAjICAgICAgICBlbHNlCiAgICAgIyAgICAgICAgICAgaWYgQGJhdHRsZXJTcHJpdGVzW0BlbmVtaWVzLmxlbmd0aCArIGldPwogICAgICMgICAgICAgICAgICAgICBAYmF0dGxlclNwcml0ZXNbQGVuZW1pZXMubGVuZ3RoICsgaV0uYXBwZWFyKCkKICAgICAgICAgICAgICAgIAogICAgICAgIyBmb3IgYmF0dGxlciBpbiBkZWFkQmF0dGxlcnMKICAgICAgICAgICAgI0BiYXR0bGVycy5yZW1vdmUoYmF0dGxlcikKICAgICAgICAgICAgI0BlbmVtaWVzLnJlbW92ZShiYXR0bGVyKQogICAgICAgICAgICAKICAgIHN0YXJ0QW5pbWF0aW9uOiAoYW5pbWF0aW9uLCB0YXJnZXQpIC0+CiAgICAgICAgQGFuaW1hdGlvbnNSdW5uaW5nID0geWVzCiAgICAgICAgbG9naWMgPSBuZXcgTG9naWNfQW5pbWF0aW9uKGFuaW1hdGlvbikKICAgICAgICBAdGFyZ2V0QW5pbWF0aW9uLmxvZ2ljID0gbG9naWMKICAgICAgICBAdGFyZ2V0QW5pbWF0aW9uLnJlZnJlc2goKQogICAgICAgIEB0YXJnZXRBbmltYXRpb24ucHJlcGFyZSgpCiAgICAgICAgQHRhcmdldEFuaW1hdGlvbi50YXJnZXQuc3ByaXRlID0gQGJhdHRsZXJTcHJpdGVzW3RhcmdldF0KICAgICAgICBAd2FpdENvdW50ZXIgPSBsb2dpYy5kdXJhdGlvbgogICAgICAgIGxvZ2ljLnN0YXJ0KCkKICAgICAgICAKICAgICAgICBAYW5pbWF0aW9uTGlzdFswXS5wdXNoKEB0YXJnZXRBbmltYXRpb24pCiAgICAgICAgCiAgICBzdGFydERhbWFnZUFuaW1hdGlvbjogKHRhcmdldCwgdmFsdWUpIC0+CiAgICAgICAgQGFuaW1hdGlvbnNSdW5uaW5nID0geWVzCiAgICAgICAgQGRhbWFnZVNwcml0ZS52YWx1ZSA9IHZhbHVlCiAgICAgICAgQGRhbWFnZVNwcml0ZS50YXJnZXQgPSBAYmF0dGxlclNwcml0ZXNbdGFyZ2V0XQogICAgICAgIEBkYW1hZ2VTcHJpdGUucmVkcmF3KCkKICAgICAgICBAZGFtYWdlU3ByaXRlLmlzUnVubmluZyA9IHllcwogICAgICAgIAogICAgICAgIEBhbmltYXRpb25MaXN0WzFdLnB1c2goQGRhbWFnZVNwcml0ZSkKCiAgICBzZWxlY3RWYWxpZE1lbWJlcjogKGJhY2t3YXJkcykgLT4KICAgICAgICBvbGRJbmRleCA9IEBhY3RpdmVNZW1iZXJJbmRleAogICAgICAgIAogICAgICAgIGlmIGJhY2t3YXJkcz8KICAgICAgICAgICAgd2hpbGUgQGFjdGl2ZU1lbWJlckluZGV4ID49IDAgYW5kIG5vdCBAbWVtYmVyc1tAYWN0aXZlTWVtYmVySW5kZXhdLmFjdG9yLmlzQWxpdmUKICAgICAgICAgICAgICAgIEBhY3RpdmVNZW1iZXJJbmRleC0tCiAgICAgICAgZWxzZQogICAgICAgICAgICB3aGlsZSBAYWN0aXZlTWVtYmVySW5kZXggPCBAbWVtYmVycy5sZW5ndGggYW5kIG5vdCBAbWVtYmVyc1tAYWN0aXZlTWVtYmVySW5kZXhdLmFjdG9yLmlzQWxpdmUKICAgICAgICAgICAgICAgIEBhY3RpdmVNZW1iZXJJbmRleCsrCiAgICAgICAgICAgIAogICAgICAgIGlmIEBhY3RpdmVNZW1iZXJJbmRleCA+PSBAbWVtYmVycy5sZW5ndGgKICAgICAgICAgICAgQGFjdGl2ZU1lbWJlckluZGV4ID0gMAogICAgICAgICAgICBAcGxheWVyc1R1cm4gPSBubwogICAgICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgaWYgQGFjdGl2ZU1lbWJlckluZGV4IDwgMAogICAgICAgICAgICBAYWN0aXZlTWVtYmVySW5kZXggPSBvbGRJbmRleCsxCiAgICAgICAgCiAgICAgICAgQGFjdGl2ZU1lbWJlciA9IEBtZW1iZXJzW0BhY3RpdmVNZW1iZXJJbmRleF0KICAgICAgICBAcGFydHlXaW5kb3cuYWN0aXZlTWVtYmVyID0gQGFjdGl2ZU1lbWJlckluZGV4CiAgICAgICAgICAgIAogICAgZW5kVHVybjogLT4KICAgICAgICBAYWN0aXZlTWVtYmVySW5kZXgrKwogICAgICAgIEBzZWxlY3RWYWxpZE1lbWJlcigpCiAgICAgICAgICAgIAogICAgICAgIEBhY3RpdmVNZW1iZXIgPSBAbWVtYmVyc1tAYWN0aXZlTWVtYmVySW5kZXhdCiAgICAgICAgCiAgICAgICAgaWYgQHBsYXllcnNUdXJuIGFuZCBAYWN0aXZlTWVtYmVyLmZvcmNlZEFjdGlvbj8KICAgICAgICAgICAgQGFjdGlvbkxpc3QucHVzaChAYWN0aXZlTWVtYmVyLmZvcmNlZEFjdGlvbikKICAgICAgICAgICAgQGFjdGl2ZU1lbWJlci5sYXN0VGFyZ2V0ID0gQGFjdGl2ZU1lbWJlci5mb3JjZWRBY3Rpb24udGFyZ2V0c1swXQogICAgICAgICAgICBAYWN0aXZlTWVtYmVyLmZvcmNlZEFjdGlvbiA9IG51bGwKICAgICAgICAgICAgQGVuZFR1cm4oKQogICAgICAgIGVsc2UKICAgICAgICAgICAgQHBhcnR5V2luZG93LmFjdGl2ZU1lbWJlciA9IEBhY3RpdmVNZW1iZXJJbmRleAogICAgICAgIAogICAgZW5kQmF0dGxlOiAtPgogICAgICAgIGlmIEBiYXR0bGVXb24gIAogICAgICAgICAgICAKICAgICAgICAgICAgZXhwID0gMAogICAgICAgICAgICBtb25leSA9IDAKICAgICAgICAgICAgZm9yIGVuZW15IGluIEBkZWFkRW5lbWllcwogICAgICAgICAgICAgICAgZXhwICs9IGVuZW15LmFjdG9yLmV4cAogICAgICAgICAgICAgICAgbW9uZXkgKz0gZW5lbXkuYWN0b3IubW9uZXkKICAgICAgICAgICAgCiAgICAgICAgICAgIEBtZXNzYWdlQ29udGFpbmVyLndhaXRGb3JLZXkgPSB5ZXMKICAgICAgICAgICAgQG1lc3NhZ2VDb250YWluZXIubWVzc2FnZXMgPSBbXQogICAgICAgICAgICBAbWVzc2FnZUNvbnRhaW5lci5hZGRNZXNzYWdlKDAsIGxjcyhAdm9jYWIuYmF0dGxlLndvbikpCiAgICAgICAgICAgIGxldmVsVXBTdHJpbmcgPSBsY3MoQHZvY2FiLmJhdHRsZS5sZXZlbFVwKQogICAgICAgICAgICBsZWFyblN0cmluZyA9IGxjcyhAdm9jYWIuYmF0dGxlLmxlYXJuc1NraWxsKQogICAgICAgICAgICBleHBTdHJpbmcgPSBsY3MoQHZvY2FiLmJhdHRsZS5leHBSZWNlaXZlZCkKICAgICAgICAgICAgbW9uZXlTdHJpbmcgPSBsY3MoQHZvY2FiLmJhdHRsZS5tb25leVJlY2VpdmVkKQogICAgICAgICAgICBkcm9wU3RyaW5nID0gbGNzKEB2b2NhYi5iYXR0bGUuZHJvcCkKICAgICAgICAgICAgZm9yIGkgaW4gWzAuLi5AbWVtYmVycy5sZW5ndGhdCiAgICAgICAgICAgICAgICBtZW1iZXIgPSBAbWVtYmVyc1tpXQogICAgICAgICAgICAgICAgaWYgbWVtYmVyLmFjdG9yLmlzQWxpdmUKICAgICAgICAgICAgICAgICAgICBsZXZlbCA9IG1lbWJlci5hY3Rvci5sZXZlbAogICAgICAgICAgICAgICAgICAgIG1lbWJlci5hY3Rvci5leHAgKz0gZXhwCiAgICAgICAgICAgICAgICAgICAgbWVtYmVyLmFjdG9yLnJlZnJlc2goKQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGlmIG1lbWJlci5hY3Rvci5sZXZlbCAhPSBsZXZlbAogICAgICAgICAgICAgICAgICAgICAgICBAbWVzc2FnZUNvbnRhaW5lci5hZGRNZXNzYWdlKGkrMSwgbGV2ZWxVcFN0cmluZy5yZXBsYWNlKCJ7YWN0b3J9IiwgbWVtYmVyLmFjdG9yLm5hbWUpLnJlcGxhY2UoIntsZXZlbH0iLCBtZW1iZXIuYWN0b3IubGV2ZWwpKQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgbGVhcm5hYmxlU2tpbGwgaW4gbWVtYmVyLmFjdG9yLmNsYXNzLnNraWxscwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgbGVhcm5hYmxlU2tpbGwubGV2ZWwgPiBsZXZlbCBhbmQgbGVhcm5hYmxlU2tpbGwubGV2ZWwgPD0gbWVtYmVyLmFjdG9yLmxldmVsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2tpbGwgPSBSZWNvcmRNYW5hZ2VyLnNraWxsc1tsZWFybmFibGVTa2lsbC5za2lsbElkXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBtZXNzYWdlQ29udGFpbmVyLmFkZE1lc3NhZ2UoaSsxLCBsZWFybnNTdHJpbmcucmVwbGFjZSgie2FjdG9yfSIsIG1lbWJlci5hY3Rvci5uYW1lKS5yZXBsYWNlKCJ7c2tpbGx9Iiwgc2tpbGwubmFtZSkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgQG1lc3NhZ2VDb250YWluZXIuYWRkTWVzc2FnZSgwLCBleHBTdHJpbmcucmVwbGFjZSgie2FjdG9yfSIsIG1lbWJlci5hY3Rvci5uYW1lKS5yZXBsYWNlKCJ7ZXhwfSIsIGV4cCkpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgIEdhbWVNYW5hZ2VyLm1vbmV5ICs9IG1vbmV5CiAgICAgICAgICAgIEBtZXNzYWdlQ29udGFpbmVyLmFkZE1lc3NhZ2UoMCwgbW9uZXlTdHJpbmcucmVwbGFjZSgie21vbmV5fSIsIG1vbmV5KS5yZXBsYWNlKCJ7Y3VyfSIsIGxjcyhAdm9jYWIuc2hvcE1lbnUuY3VycmVuY3kpKSkKICAgICAgICAgICAgZHJvcEl0ZW1zID0gW10KICAgICAgICAgICAgZm9yIGVuZW15IGluIEBkZWFkRW5lbWllcwogICAgICAgICAgICAgICAgaWYgbm90IGVuZW15LmlzSGlkZGVuCiAgICAgICAgICAgICAgICAgICAgZm9yIGl0ZW0gaW4gZW5lbXkuYWN0b3IuZHJvcEl0ZW1zCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIE1hdGgucmFuZG9tKCkgKiAxMDAgPD0gaXRlbS5wcm9wYWJpbGl0eQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZGl0aW9uUmVzdWx0ID0geWVzCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBpdGVtLmNvbmRpdGlvbi5zdGF0ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlID0gUmVjb3JkTWFuYWdlci5zdGF0ZXNbaXRlbS5jb25kaXRpb24uc3RhdGVJZF0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25kaXRpb25SZXN1bHQgPSBzdGF0ZT8gYW5kIGVuZW15LmFjdG9yLmhhc1N0YXRlKHN0YXRlKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgY29uZGl0aW9uUmVzdWx0IGFuZCBpdGVtLmNvbmRpdGlvbi5zd2l0Y2gKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25kaXRpb25SZXN1bHQgPSBHYW1lTWFuYWdlci52YXJpYWJsZVN0b3JlLmJvb2xlYW5WYWx1ZU9mKGl0ZW0uY29uZGl0aW9uLnN3aXRjaElkKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgY29uZGl0aW9uUmVzdWx0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZHJvcHBlZEl0ZW0gPSBudWxsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIGl0ZW0uZHJvcFR5cGUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hlbiAwICMgSXRlbQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZHJvcHBlZEl0ZW0gPSBSZWNvcmRNYW5hZ2VyLml0ZW1zW2l0ZW0uaXRlbUlkXSAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hlbiAxICMgV2VhcG9uCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkcm9wcGVkSXRlbSA9IFJlY29yZE1hbmFnZXIud2VhcG9uc1tpdGVtLml0ZW1JZF0gICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hlbiAyICMgQXJtb3IKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRyb3BwZWRJdGVtID0gUmVjb3JkTWFuYWdlci5hcm1vcnNbaXRlbS5pdGVtSWRdICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgZHJvcHBlZEl0ZW0/CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdhbWVNYW5hZ2VyLmludmVudG9yeS5hZGRJdGVtKGRyb3BwZWRJdGVtLCAxKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkcm9wSXRlbXMucHVzaChkcm9wcGVkSXRlbS5uYW1lKSAgICAgICAgCiAgICAgICAgICAgIGlmIGRyb3BJdGVtcy5sZW5ndGggPiAwCiAgICAgICAgICAgICAgICBAbWVzc2FnZUNvbnRhaW5lci5hZGRNZXNzYWdlKDAsIGRyb3BTdHJpbmcucmVwbGFjZSgie3Ryb29wfSIsIEB0cm9vcC5uYW1lKS5yZXBsYWNlKCJ7aXRlbXN9IiwgZHJvcEl0ZW1zLmpvaW4oIiwgIikpKQogICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgQGFjdGlvbldpbmRvdy5hY3RpdmUgPSBubwogICAgICAgICAgICBAYWN0aW9uV2luZG93LnZpc2libGUgPSBubwogICAgICAgICAgICBAcGFydHlXaW5kb3cudmlzaWJsZSA9IG5vCiAgICAgICAgICAgIAogICAgICAgICAgICBAbWVzc2FnZUNvbnRhaW5lci5yZWZyZXNoTmVlZGVkID0geWVzCiAgICAgICAgICAgIEBtZXNzYWdlQ29udGFpbmVyLm9uVGltZXJUaWNrID0gPT4gCiAgICAgICAgICAgICAgICBpZiAkUEFSQU1TLmJhdHRsZVRlc3Q/CiAgICAgICAgICAgICAgICAgICAgU2NlbmVNYW5hZ2VyLnN3aXRjaFRvKG5ldyBTY2VuZV9CYXR0bGVUZXN0KCkpCiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgU2NlbmVNYW5hZ2VyLnN3aXRjaFRvKG5ldyBTY2VuZV9CYXR0bGVXb24oKSkKICAgICAgICBpZiBAYmF0dGxlTG9zdAogICAgICAgICAgICBAYWN0aW9uV2luZG93LmFjdGl2ZSA9IG5vCiAgICAgICAgICAgIEBhY3Rpb25XaW5kb3cudmlzaWJsZSA9IG5vCiAgICAgICAgICAgIEBwYXJ0eVdpbmRvdy52aXNpYmxlID0gbm8KICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIEBjb250aW51ZU9uTG9zZQogICAgICAgICAgICAgICAgQG1lc3NhZ2VDb250YWluZXIud2FpdEZvcktleSA9IHllcwogICAgICAgICAgICAgICAgQG1lc3NhZ2VDb250YWluZXIubWVzc2FnZXMgPSBbXQogICAgICAgICAgICAgICAgQG1lc3NhZ2VDb250YWluZXIuYWRkTWVzc2FnZSgwLCBsY3MoQHZvY2FiLmJhdHRsZS5vdmVyKSkKICAgICAgICAgICAgICAgIEBtZXNzYWdlQ29udGFpbmVyLm9uVGltZXJUaWNrID0gPT4gCiAgICAgICAgICAgICAgICAgICAgaWYgJFBBUkFNUy5iYXR0bGVUZXN0PwogICAgICAgICAgICAgICAgICAgICAgICBTY2VuZU1hbmFnZXIuc3dpdGNoVG8obmV3IFNjZW5lX0JhdHRsZVRlc3QoKSkKICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIFNjZW5lTWFuYWdlci5zd2l0Y2hUbyhuZXcgU2NlbmVfTWFwKCkpCiAgICAgICAgICAgIGVsc2UgICAgICAgICAgICAKICAgICAgICAgICAgICAgIEBtZXNzYWdlQ29udGFpbmVyLndhaXRGb3JLZXkgPSB5ZXMKICAgICAgICAgICAgICAgIEBtZXNzYWdlQ29udGFpbmVyLm1lc3NhZ2VzID0gW10KICAgICAgICAgICAgICAgIEBtZXNzYWdlQ29udGFpbmVyLmFkZE1lc3NhZ2UoMCwgbGNzKEB2b2NhYi5iYXR0bGUubG9zdCkpCiAgICAgICAgICAgICAgICBAbWVzc2FnZUNvbnRhaW5lci5vblRpbWVyVGljayA9ID0+IAogICAgICAgICAgICAgICAgICAgIGlmICRQQVJBTVMuYmF0dGxlVGVzdD8KICAgICAgICAgICAgICAgICAgICAgICAgU2NlbmVNYW5hZ2VyLnN3aXRjaFRvKG5ldyBTY2VuZV9CYXR0bGVUZXN0KCkpCiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICBTY2VuZU1hbmFnZXIuc3dpdGNoVG8obmV3IFNjZW5lX0dhbWVPdmVyKCkpCiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgY2hlY2tCYXR0bGVFbmQ6IC0+CiAgICAgICAgaWYgQGJhdHRsZVdvbiBvciBAYmF0dGxlTG9zdCB0aGVuIHJldHVybiBAZW5kQmF0dGxlKCkKICAgICAgICAKICAgICAgICBAYmF0dGxlV29uID0geWVzCiAgICAgICAgZm9yIGVuZW15IGluIEBlbmVtaWVzCiAgICAgICAgICAgIGlmIGVuZW15LmFjdG9yLmxwID4gMCBhbmQgbm90IGVuZW15LmlzSGlkZGVuCiAgICAgICAgICAgICAgICBAYmF0dGxlV29uID0gbm8KICAgICAgICAgICAgICAgIAogICAgICAgIEBiYXR0bGVMb3N0ID0geWVzCiAgICAgICAgZm9yIG1lbWJlciBpbiBAbWVtYmVycwogICAgICAgICAgICBpZiBtZW1iZXIuYWN0b3IubHAgPiAwCiAgICAgICAgICAgICAgICBAYmF0dGxlTG9zdCA9IG5vCiAgICAgICAgICAgICAgICAKICAgICAgICBAYmF0dGxlRW5kID0gQGJhdHRsZVdvbiBvciBAYmF0dGxlTG9zdAogICAgICAgIEBlbmRCYXR0bGUoKQogICAgICAgIAogICAgICAgIHJldHVybiBAYmF0dGxlRW5kCiAgICAgICAgICAgICAgICAKICAgIAogICAgc3ByaXRlRm9yTG9naWM6IChsb2dpYykgLT4KICAgICAgICByZXN1bHQgPSBudWxsCiAgICAgICAgZm9yIHNwcml0ZSBpbiBAYmF0dGxlclNwcml0ZXMKICAgICAgICAgICAgaWYgc3ByaXRlLmxvZ2ljMiA9PSBsb2dpYwogICAgICAgICAgICAgICAgcmVzdWx0ID0gc3ByaXRlCiAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgCiAgICAgICAgcmV0dXJuIHJlc3VsdAogICAgICAgIAogICAgZXNjYXBlOiAtPgogICAgICAgIEBtZXNzYWdlQ29udGFpbmVyLmFkZE1lc3NhZ2UoMCwgbGNzKEB2b2NhYi5iYXR0bGUuZXNjYXBlZCkpCiAgICAgICAgQG1lc3NhZ2VDb250YWluZXIub25UaW1lclRpY2sgPSA9PiBTY2VuZU1hbmFnZXIuc3dpdGNoVG8obmV3IFNjZW5lX01hcCgpKQogICAgICAgIAogICAgb25BY3Rpb246IC0+CiAgICAgICAgc3dpdGNoIEBhY3Rpb25XaW5kb3cuc2VsZWN0ZWRSb3cKICAgICAgICAgICAgd2hlbiAwICMgQXR0YWNrCiAgICAgICAgICAgICAgICBAYWN0aW9uV2luZG93LmFjdGl2ZSA9IG5vCiAgICAgICAgICAgICAgICBAb25Ta2lsbFNlbGVjdGlvbihAYWN0aXZlTWVtYmVyLmFjdG9yLmF0dGFja1NraWxsKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgIHdoZW4gMSAjIFNraWxscwogICAgICAgICAgICAgICAgQGFjdGlvbldpbmRvdy5hY3RpdmUgPSBubwoKICAgICAgICAgICAgICAgIEBza2lsbHNXaW5kb3dzZXQubWVtYmVyID0gQGFjdGl2ZU1lbWJlci5hY3RvcgogICAgICAgICAgICAgICAgQHNraWxsc1dpbmRvd3NldC5yZWJ1aWxkKCkKICAgICAgICAgICAgICAgIEBza2lsbHNXaW5kb3dzZXQuc2hvdyh5ZXMpCiAgICAgICAgICAgICAgICBAc2tpbGxzV2luZG93c2V0LmFjdGl2ZSA9IHllcwogICAgICAgICAgICB3aGVuIDIgIyBHdWFyZAogICAgICAgICAgICAgICAgQGFjdGlvbldpbmRvdy5hY3RpdmUgPSBubwogICAgICAgICAgICAgICAgQG9uU2tpbGxTZWxlY3Rpb24oUmVjb3JkTWFuYWdlci5za2lsbHNbMV0pCiAgICAgICAgICAgIHdoZW4gMyAjIEl0ZW1zCiAgICAgICAgICAgICAgICBAYWN0aW9uV2luZG93LmFjdGl2ZSA9IG5vCiAgICAgICAgICAgICAgICBAaXRlbXNXaW5kb3dzZXQuc2hvdyh5ZXMpCiAgICAgICAgICAgICAgICBAaXRlbXNXaW5kb3dzZXQuYWN0aXZlID0geWVzCiAgICAgICAgICAgIHdoZW4gNCAjIEVzY2FwZQogICAgICAgICAgICAgICAgQGFjdGlvbldpbmRvdy5hY3RpdmUgPSBubwogICAgICAgICAgICAgICAgQGVzY2FwZSgpCiAgICAgICAgICAgICAgICAKICAgIG9uQWN0aW9uQ2FuY2VsOiAtPgogICAgICAgIGlmIEBhY3RpdmVNZW1iZXJJbmRleCA+IDAKICAgICAgICAgICAgQGFjdGl2ZU1lbWJlckluZGV4LS0KICAgICAgICAgICAgQHNlbGVjdFZhbGlkTWVtYmVyKHllcykKICAgICAgICAgICAgQGFjdGlvbkxpc3Quc3BsaWNlKEBhY3Rpb25MaXN0Lmxlbmd0aC0xLCAxKQogICAgICAgICAgICBAYWN0aXZlTWVtYmVyLmNhbmNlbFByZXBhcmF0aW9uKCkKICAgICAgICAgICAgCiAgICAgCiAgICBvblRhcmdldFNlbGVjdGlvbkNhbmNlbDogLT4KICAgICAgICBAc2VsZWN0QmF0dGxlciA9IG5vCiAgICAgICAgQGFjdGlvbldpbmRvdy5hY3RpdmUgPSB5ZXMKICAgICAgICBAdGFyZ2V0U2VsZWN0aW9uV2luZG93LmFjdGl2ZSA9IG5vCiAgICAgICAgQHRhcmdldFNlbGVjdGlvbldpbmRvdy52aXNpYmxlID0gbm8KICAgICAgICBAYmF0dGxlclNwcml0ZXNbQHNlbGVjdGVkQmF0dGxlcl0uY29sb3IgPSBDb2xvci5UUkFOU1BBUkVOVAogICAgICAgIEBhY3RpdmVNZW1iZXIuY2FuY2VsUHJlcGFyYXRpb24oKQogICAgICAgIAogICAgb25UYXJnZXRTZWxlY3Rpb25DaGFuZ2U6IC0+CiAgICAgICAgQHNlbGVjdGVkVGFyZ2V0cyA9IFtAdGFyZ2V0U2VsZWN0aW9uV2luZG93LnNlbGVjdGVkQ2VsbF0KICAgCiAgICAgICAgZm9yIHNwcml0ZSBpbiBAYmF0dGxlclNwcml0ZXMKICAgICAgICAgICAgc3ByaXRlLmNvbG9yID0gQ29sb3IuVFJBTlNQQVJFTlQKICAgICAgICAKICAgICAgICBzcHJpdGUgPSBAc3ByaXRlRm9yTG9naWMoQHNlbGVjdGVkVGFyZ2V0c1swXSkKICAgICAgICBpZiBzcHJpdGU/CiAgICAgICAgICAgIHNwcml0ZS5jb2xvciA9IENvbG9ycy5CQVRUTEVSX1NFTEVDVElPTgogICAgICAgICAgICAKICAgIG9uVGFyZ2V0U2VsZWN0aW9uOiAtPgogICAgICAgIGlmIEBzZWxlY3RlZEl0ZW0/ICAgICAgICAKICAgICAgICAgICAgQHNlbGVjdEJhdHRsZXIgPSBubwogICAgICAgICAgICBzcHJpdGUgPSBAc3ByaXRlRm9yTG9naWMoQHNlbGVjdGVkVGFyZ2V0c1swXSkKICAgICAgICAgICAgaWYgc3ByaXRlPwogICAgICAgICAgICAgICAgc3ByaXRlLmNvbG9yID0gQ29sb3IuVFJBTlNQQVJFTlQKICAgICAgICAgICAgZm9yIGkgaW4gWzAuLi5Ac2VsZWN0ZWRJdGVtLml0ZW0ucmVwZWF0c10KICAgICAgICAgICAgICAgIEBhY3Rpb25MaXN0LnB1c2goeyB0eXBlOiAxLCBub01lc3NhZ2U6IGkgPiAwLCBpdGVtOiBAc2VsZWN0ZWRJdGVtLCBiYXR0bGVyOiBAYWN0aXZlTWVtYmVyLCBzb3VyY2U6IEBlbmVtaWVzLmxlbmd0aCArIEBhY3RpdmVNZW1iZXJJbmRleCwgdGFyZ2V0czogQHNlbGVjdGVkVGFyZ2V0cyB9KQogICAgICAgICAgICBAc2VsZWN0ZWRJdGVtLmNvdW50LS0KICAgICAgICAgICAgQHNlbGVjdGVkSXRlbSA9IG51bGwKICAgICAgICAgICAgQGVuZFR1cm4oKQogICAgICAgIGVsc2UgaWYgQHNlbGVjdGVkU2tpbGw/CiAgICAgICAgICAgIEBzZWxlY3RCYXR0bGVyID0gbm8KICAgICAgICAgICAgc3ByaXRlID0gQHNwcml0ZUZvckxvZ2ljKEBzZWxlY3RlZFRhcmdldHNbMF0pCiAgICAgICAgICAgIGlmIHNwcml0ZT8KICAgICAgICAgICAgICAgIHNwcml0ZS5jb2xvciA9IENvbG9yLlRSQU5TUEFSRU5UCiAgICAgICAgICAgIGZvciBpIGluIFswLi4uQHNlbGVjdGVkU2tpbGwucmVwZWF0c10KICAgICAgICAgICAgICAgIEBhY3Rpb25MaXN0LnB1c2goeyB0eXBlOiAyLCBub01lc3NhZ2U6IGkgPiAwLCBza2lsbDogQHNlbGVjdGVkU2tpbGwsIGJhdHRsZXI6IEBhY3RpdmVNZW1iZXIsIHNvdXJjZTogQGVuZW1pZXMubGVuZ3RoICsgQGFjdGl2ZU1lbWJlckluZGV4LCB0YXJnZXRzOiBAc2VsZWN0ZWRUYXJnZXRzIH0pCiAgICAgICAgICAgIEBhY3RpdmVNZW1iZXIucHJlcGFyZVNraWxsKEBzZWxlY3RlZFNraWxsKQogICAgICAgICAgICBAc2VsZWN0ZWRTa2lsbCA9IG51bGwKICAgICAgICAgICAgQGVuZFR1cm4oKQogICAgICAgICAgICAKICAgICAgICBAYWN0aXZlTWVtYmVyLmxhc3RUYXJnZXQgPSBAc2VsZWN0ZWRUYXJnZXRzWzBdCiAgICAgICAgQGFjdGlvbldpbmRvdy5hY3RpdmUgPSB5ZXMKICAgICAgICBAdGFyZ2V0U2VsZWN0aW9uV2luZG93LmFjdGl2ZSA9IG5vCiAgICAgICAgQHRhcmdldFNlbGVjdGlvbldpbmRvdy52aXNpYmxlID0gbm8KICAgICAgICAKICAgICAgICBJbnB1dC5jbGVhcigpCiAgICAgICAgICAgIAogICAgb25JdGVtU2VsZWN0aW9uOiAoaXRlbSkgLT4KICAgICAgICBJbnB1dC5jbGVhcigpCiAgICAgICAgQGl0ZW1zV2luZG93c2V0LnNob3cobm8pCiAgICAgICAgQGl0ZW1zV2luZG93c2V0LmFjdGl2ZSA9IG5vCiAgICAgICAgQHNlbGVjdGVkSXRlbSA9IGl0ZW0KICAgICAgICBAc2hvd1RhcmdldFNlbGVjdGlvbigpCiAgICAgICAgCiAgICBvbkl0ZW1TZWxlY3Rpb25DYW5jZWw6IC0+CiAgICAgICAgQGFjdGlvbldpbmRvdy5hY3RpdmUgPSB5ZXMKICAgICAgICBAaXRlbXNXaW5kb3dzZXQuc2hvdyhubykKICAgICAgICAKICAgIG9uU2tpbGxTZWxlY3Rpb246IChza2lsbCkgLT4KICAgICAgICBJbnB1dC5jbGVhcigpCiAgICAgICAgQHNraWxsc1dpbmRvd3NldC5zaG93KG5vKQogICAgICAgIEBzZWxlY3RlZFNraWxsID0gc2tpbGwKICAgICAgICBAc2hvd1RhcmdldFNlbGVjdGlvbigpCiAgICAgICAgCiAgICBvblNraWxsU2VsZWN0aW9uQ2FuY2VsOiAtPgogICAgICAgIEBhY3Rpb25XaW5kb3cuYWN0aXZlID0geWVzCiAgICAgICAgQHNraWxsc1dpbmRvd3NldC5zaG93KG5vKQogICAgb25JbnRlcnByZXRlckZpbmlzaDogLT4gCiAgICAgICAgQGNoZWNrQmF0dGxlRXZlbnRDb25kaXRpb25zKCkKCiAgICBzaG93VGFyZ2V0U2VsZWN0aW9uOiAtPgogICAgICAgIGl0ZW0gPSBudWxsCiAgICAgICAgc2tpcCA9IG5vCiAgICAgICAgQHRhcmdldE9mZnNldCA9IDAKICAgICAgICBpZiBAc2VsZWN0ZWRJdGVtPyB0aGVuIGl0ZW0gPSBAc2VsZWN0ZWRJdGVtCiAgICAgICAgaWYgQHNlbGVjdGVkU2tpbGw/CiAgICAgICAgICAgIGl0ZW0gPSBAc2VsZWN0ZWRTa2lsbAogICAgICAgICAgICBAYWN0aXZlTWVtYmVyLnByZXBhcmVTa2lsbChAc2VsZWN0ZWRTa2lsbCkKICAgICAgICAKICAgICAgICBpZiBpdGVtPwogICAgICAgICAgICBzd2l0Y2ggKGlmIGl0ZW0uaXRlbT8gdGhlbiBpdGVtLml0ZW0uc2NvcGUgZWxzZSBpdGVtLnNjb3BlKQogICAgICAgICAgICAgICAgd2hlbiAwICMgTm9uZQogICAgICAgICAgICAgICAgICAgIEB0YXJnZXRTZWxlY3Rpb25XaW5kb3cuYmF0dGxlcnMgPSBAYmF0dGxlcnMKICAgICAgICAgICAgICAgIHdoZW4gMSAjIE9uZSBFbmVteQogICAgICAgICAgICAgICAgICAgIEB0YXJnZXRTZWxlY3Rpb25XaW5kb3cuYmF0dGxlcnMgPSBAYWxpdmVFbmVtaWVzCiAgICAgICAgICAgICAgICB3aGVuIDIgIyBBbGwgRW5lbWllcwogICAgICAgICAgICAgICAgICAgIEBzZWxlY3RlZFRhcmdldHMgPSBAYWxpdmVFbmVtaWVzCiAgICAgICAgICAgICAgICAgICAgc2tpcCA9IHllcwogICAgICAgICAgICAgICAgd2hlbiA3ICMgT25lIE1lbWJlcgogICAgICAgICAgICAgICAgICAgIEB0YXJnZXRTZWxlY3Rpb25XaW5kb3cuYmF0dGxlcnMgPSBAbWVtYmVycwogICAgICAgICAgICAgICAgICAgIEB0YXJnZXRPZmZzZXQgPSBAZW5lbWllcy5sZW5ndGgKICAgICAgICAgICAgICAgIHdoZW4gOCAjIEFsbCBNZW1iZXJzCiAgICAgICAgICAgICAgICAgICAgQHNlbGVjdGVkVGFyZ2V0cyA9IEBtZW1iZXJzCiAgICAgICAgICAgICAgICAgICAgQHRhcmdldE9mZnNldCA9IEBlbmVtaWVzLmxlbmd0aAogICAgICAgICAgICAgICAgICAgIHNraXAgPSB5ZXMKICAgICAgICAgICAgICAgIHdoZW4gOSAjIE9uZSBNZW1iZXIgKERlYWQpCiAgICAgICAgICAgICAgICAgICAgZGVhZE1lbWJlcnMgPSBbXQogICAgICAgICAgICAgICAgICAgIGZvciBtZW1iZXIgaW4gQG1lbWJlcnMKICAgICAgICAgICAgICAgICAgICAgICAgaWYgbm90IG1lbWJlci5hY3Rvci5pc0FsaXZlICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWFkTWVtYmVycy5wdXNoKG1lbWJlcikKICAgICAgICAgICAgICAgICAgICBAdGFyZ2V0U2VsZWN0aW9uV2luZG93LmJhdHRsZXJzID0gZGVhZE1lbWJlcnMKICAgICAgICAgICAgICAgICAgICBAdGFyZ2V0T2Zmc2V0ID0gQGVuZW1pZXMubGVuZ3RoCiAgICAgICAgICAgICAgICB3aGVuIDEwICMgQWxsIE1lbWJlcnMoRGVhZCkKICAgICAgICAgICAgICAgICAgICBkZWFkTWVtYmVycyA9IFtdCiAgICAgICAgICAgICAgICAgICAgZm9yIG1lbWJlciBpbiBAbWVtYmVycwogICAgICAgICAgICAgICAgICAgICAgICBpZiBub3QgbWVtYmVyLmFjdG9yLmlzQWxpdmUKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlYWRNZW1iZXJzLnB1c2gobWVtYmVyKQogICAgICAgICAgICAgICAgICAgIEBzZWxlY3RlZFRhcmdldHMgPSBkZWFkTWVtYmVycwogICAgICAgICAgICAgICAgICAgIEB0YXJnZXRPZmZzZXQgPSBAZW5lbWllcy5sZW5ndGgKICAgICAgICAgICAgICAgICAgICBza2lwID0geWVzCiAgICAgICAgICAgICAgICB3aGVuIDExICMgVXNlcgogICAgICAgICAgICAgICAgICAgIEBzZWxlY3RlZFRhcmdldHMgPSBbQGFjdGl2ZU1lbWJlcl0KICAgICAgICAgICAgICAgICAgICBza2lwID0geWVzCiAgICAgICAgZWxzZQogICAgICAgICAgICBAdGFyZ2V0U2VsZWN0aW9uV2luZG93LmJhdHRsZXJzID0gQGJhdHRsZXJzCiAgICAgICAgCiAgICAgICAgaWYgc2tpcAogICAgICAgICAgICBAb25UYXJnZXRTZWxlY3Rpb24oKQogICAgICAgIGVsc2UKICAgICAgICAgICAgQGFjdGlvbldpbmRvdy5hY3RpdmUgPSBubwogICAgICAgICAgICBAdGFyZ2V0U2VsZWN0aW9uV2luZG93LmFjdGl2ZSA9IHllcwogICAgICAgICAgICBAdGFyZ2V0U2VsZWN0aW9uV2luZG93LnZpc2libGUgPSB5ZXMKICAgICAgICAgICAgQHRhcmdldFNlbGVjdGlvbldpbmRvdy5yZWRyYXcoKQogICAgICAgICAgICBAc2VsZWN0ZWRUYXJnZXRzID0gW0B0YXJnZXRTZWxlY3Rpb25XaW5kb3cuc2VsZWN0ZWRDZWxsXQogICAgICAgICAgICBAc2VsZWN0QmF0dGxlciA9IHllcwogICAgICAgICAgICBAc2VsZWN0ZWRCYXR0bGVyID0gMAogICAgICAgICAgICBAb25UYXJnZXRTZWxlY3Rpb25DaGFuZ2UoKQogICAgICAgIAoKICAgICAgICAgICAgICAgIAogICAgICAgIAogICAgCiAgICAgICAgCiAgICAKICAKCndpbmRvdy5TY2VuZV9CYXR0bGUgPSBTY2VuZV9CYXR0bGU=","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBTY2VuZV9CYXR0bGUsCiAgICBfX2hhc1Byb3AgPSB7fS5oYXNPd25Qcm9wZXJ0eSwKICAgIF9fZXh0ZW5kcyA9IGZ1bmN0aW9uKGNoaWxkLCBwYXJlbnQpIHsgZm9yICh2YXIga2V5IGluIHBhcmVudCkgeyBpZiAoX19oYXNQcm9wLmNhbGwocGFyZW50LCBrZXkpKSBjaGlsZFtrZXldID0gcGFyZW50W2tleV07IH0gZnVuY3Rpb24gY3RvcigpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGNoaWxkOyB9IGN0b3IucHJvdG90eXBlID0gcGFyZW50LnByb3RvdHlwZTsgY2hpbGQucHJvdG90eXBlID0gbmV3IGN0b3IoKTsgY2hpbGQuX19zdXBlcl9fID0gcGFyZW50LnByb3RvdHlwZTsgcmV0dXJuIGNoaWxkOyB9OwoKICBTY2VuZV9CYXR0bGUgPSAoZnVuY3Rpb24oX3N1cGVyKSB7CiAgICBfX2V4dGVuZHMoU2NlbmVfQmF0dGxlLCBfc3VwZXIpOwoKICAgIFNjZW5lX0JhdHRsZS5WSUVXX01PREVfU0lERSA9IDA7CgogICAgU2NlbmVfQmF0dGxlLlZJRVdfTU9ERV9GUk9OVCA9IDE7CgogICAgU2NlbmVfQmF0dGxlLlZJRVdfTU9ERV9GUk9OVF9DSEFSQUNURVJTID0gMjsKCiAgICBmdW5jdGlvbiBTY2VuZV9CYXR0bGUoKSB7CiAgICAgIFNjZW5lX0JhdHRsZS5fX3N1cGVyX18uY29uc3RydWN0b3IuY2FsbCh0aGlzKTsKICAgIH0KCiAgICBTY2VuZV9CYXR0bGUucHJvdG90eXBlLmluaXRpYWxpemUgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgdGhpcy50ZXJyYWluID0gR2FtZU1hbmFnZXIuYmF0dGxlVGVycmFpbjsKICAgICAgaWYgKCgkUEFSQU1TLmJhdHRsZVRlc3QgIT0gbnVsbCkgJiYgKEdhbWVNYW5hZ2VyLnRyb29wLmJhY2tncm91bmRHcmFwaGljICE9IG51bGwpKSB7CiAgICAgICAgdGhpcy5iYWNrZ3JvdW5kID0gUmVzb3VyY2VNYW5hZ2VyLmdldEJpdG1hcCgiR3JhcGhpY3MvQmF0dGxlYmFja3MvIiArIEdhbWVNYW5hZ2VyLnRyb29wLmJhY2tncm91bmRHcmFwaGljLm5hbWUpOwogICAgICAgIGlmICh0aGlzLmJhY2tncm91bmQgPT0gbnVsbCkgewogICAgICAgICAgdGhpcy5iYWNrZ3JvdW5kID0gR3JhcGhpY3Muc25hcHNob3QoKTsKICAgICAgICAgIHRoaXMuYmFja2dyb3VuZC5maWxsUmVjdCgwLCAwLCB0aGlzLmJhY2tncm91bmQud2lkdGgsIHRoaXMuYmFja2dyb3VuZC5oZWlnaHQsIG5ldyBDb2xvcigwLCAwLCAwLCAwLjcpKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAodGhpcy50ZXJyYWluICE9IG51bGwpIHsKICAgICAgICBpZiAodGhpcy50ZXJyYWluLmJhY2tncm91bmQuaW1hZ2UubmFtZS5sZW5ndGggPiAwKSB7CiAgICAgICAgICB0aGlzLmJhY2tncm91bmQgPSBSZXNvdXJjZU1hbmFnZXIuZ2V0Qml0bWFwKCJHcmFwaGljcy9CYXR0bGViYWNrcy8iICsgdGhpcy50ZXJyYWluLmJhY2tncm91bmQuaW1hZ2UubmFtZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuYmFja2dyb3VuZCA9IEdyYXBoaWNzLnNuYXBzaG90KCk7CiAgICAgICAgICB0aGlzLmJhY2tncm91bmQuZmlsbFJlY3QoMCwgMCwgdGhpcy5iYWNrZ3JvdW5kLndpZHRoLCB0aGlzLmJhY2tncm91bmQuaGVpZ2h0LCBuZXcgQ29sb3IoMCwgMCwgMCwgMC43KSk7CiAgICAgICAgfQogICAgICAgIHRoaXMuZm9yZWdyb3VuZCA9IFJlc291cmNlTWFuYWdlci5nZXRCaXRtYXAoIkdyYXBoaWNzL1BpY3R1cmVzLyIgKyB0aGlzLnRlcnJhaW4uZm9yZWdyb3VuZC5pbWFnZS5uYW1lKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmZvcmVncm91bmQgPSBudWxsOwogICAgICAgIHRoaXMuYmFja2dyb3VuZCA9IEdyYXBoaWNzLnNuYXBzaG90KCk7CiAgICAgICAgdGhpcy5iYWNrZ3JvdW5kLmZpbGxSZWN0KDAsIDAsIHRoaXMuYmFja2dyb3VuZC53aWR0aCwgdGhpcy5iYWNrZ3JvdW5kLmhlaWdodCwgbmV3IENvbG9yKDAsIDAsIDAsIDAuNykpOwogICAgICB9CiAgICAgIHRoaXMuYmF0dGxlclNwcml0ZXMgPSBbXTsKICAgICAgdGhpcy5tZW1iZXJTcHJpdGVzID0gW107CiAgICAgIHRoaXMuZW5lbXlTcHJpdGVzID0gW107CiAgICAgIHRoaXMucGFydHkgPSBHYW1lTWFuYWdlci5wYXJ0eTsKICAgICAgdGhpcy5iYXR0bGVycyA9IFtdOwogICAgICB0aGlzLm9yZGVyZWRCYXR0bGVycyA9IFtdOwogICAgICB0aGlzLnBsYXllcnNUdXJuID0gdHJ1ZTsKICAgICAgdGhpcy5zZWxlY3RCYXR0bGVyID0gZmFsc2U7CiAgICAgIHRoaXMuc2VsZWN0ZWRCYXR0bGVyID0gMDsKICAgICAgdGhpcy5hY3Rpb25MaXN0ID0gW107CiAgICAgIHRoaXMuYWN0aXZlTWVtYmVyID0gbnVsbDsKICAgICAgdGhpcy5hY3RpdmVNZW1iZXJJbmRleCA9IDA7CiAgICAgIHRoaXMucHJvY2Vzc2luZ0FjdGlvbkxpc3QgPSBmYWxzZTsKICAgICAgdGhpcy5iYXR0bGVXb24gPSBmYWxzZTsKICAgICAgdGhpcy5iYXR0bGVMb3N0ID0gZmFsc2U7CiAgICAgIHRoaXMuYmF0dGxlRW5kID0gZmFsc2U7CiAgICAgIHRoaXMuYWN0aW9uUG9pbnRlciA9IDA7CiAgICAgIHRoaXMud2FpdENvdW50ZXIgPSAwOwogICAgICB0aGlzLnRhcmdldEFuaW1hdGlvbiA9IG5ldyBTcHJpdGVzZXRfQW5pbWF0aW9uKCk7CiAgICAgIHRoaXMuZGFtYWdlU3ByaXRlID0gbmV3IFNwcml0ZV9EYW1hZ2UoKTsKICAgICAgdGhpcy5hbmltYXRpb25MaXN0ID0gW1tdLCBbXV07CiAgICAgIHRoaXMuYW5pbWF0aW9uUG9pbnRlciA9IDA7CiAgICAgIHRoaXMuYW5pbWF0aW9uc1J1bm5pbmcgPSBmYWxzZTsKICAgICAgdGhpcy5hbmltYXRpb25QaGFzZSA9IDA7CiAgICAgIHRoaXMudGV4dEFuaW1hdGlvbnMgPSBbXTsKICAgICAgdGhpcy5jb21wbGV4QW5pbWF0aW9ucyA9IFtdOwogICAgICB0aGlzLnNpbXBsZUFuaW1hdGlvbnMgPSBbXTsKICAgICAgdGhpcy52aWV3TW9kZSA9IFNjZW5lX0JhdHRsZS5WSUVXX01PREVfU0lERTsKICAgICAgdGhpcy5zZWxlY3RlZFRhcmdldHMgPSBbXTsKICAgICAgdGhpcy5pbnRlcnByZXRlcnMgPSBbXTsKICAgICAgdGhpcy5pbnRlcnByZXRlciA9IG5ldyBDb21tYW5kSW50ZXJwcmV0ZXIoW10pOwogICAgICB0aGlzLmludGVycHJldGVyLm9uRmluaXNoID0gZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIF90aGlzLm9uSW50ZXJwcmV0ZXJGaW5pc2goKTsKICAgICAgfTsKICAgICAgdGhpcy5jdXJyZW50RXZlbnRQYWdlID0gbnVsbDsKICAgICAgdGhpcy50dXJuID0gMDsKICAgICAgdGhpcy52b2NhYiA9IFJlY29yZE1hbmFnZXIudm9jYWJ1bGFyeTsKICAgICAgcmV0dXJuIEdhbWVNYW5hZ2VyLmluQmF0dGxlID0gdHJ1ZTsKICAgIH07CgogICAgU2NlbmVfQmF0dGxlLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBzcHJpdGUsIF9pLCBfbGVuLCBfcmVmOwogICAgICBfcmVmID0gdGhpcy5iYXR0bGVyU3ByaXRlczsKICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBfcmVmLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7CiAgICAgICAgc3ByaXRlID0gX3JlZltfaV07CiAgICAgICAgc3ByaXRlLmRpc3Bvc2UoKTsKICAgICAgfQogICAgICB0aGlzLmFjdGlvbldpbmRvdy5kaXNwb3NlKCk7CiAgICAgIHRoaXMucGFydHlXaW5kb3cuZGlzcG9zZSgpOwogICAgICB0aGlzLmJhY2tncm91bmRTcHJpdGUuZGlzcG9zZSgpOwogICAgICB0aGlzLm1lc3NhZ2VDb250YWluZXJTcHJpdGVzZXQuZGlzcG9zZSgpOwogICAgICB0aGlzLnRhcmdldFNlbGVjdGlvbldpbmRvdy5kaXNwb3NlKCk7CiAgICAgIHRoaXMuc2tpbGxzV2luZG93c2V0LmRpc3Bvc2UoKTsKICAgICAgdGhpcy5pdGVtc1dpbmRvd3NldC5kaXNwb3NlKCk7CiAgICAgIHJldHVybiB0aGlzLnVpVmlld3BvcnQuZGlzcG9zZSgpOwogICAgfTsKCiAgICBTY2VuZV9CYXR0bGUucHJvdG90eXBlLnByZXBhcmVEYXRhID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBjaGFyYWN0ZXIsIGVuZW15LCBlbmVteVNwcml0ZSwgaSwgbWVtYmVyLCBtZW1iZXJTcHJpdGUsIHBhZ2UsIHJlY29yZCwgcywgX2ksIF9qLCBfaywgX2xlbiwgX2xlbjEsIF9yZWYsIF9yZWYxLCBfcmVmMjsKICAgICAgdGhpcy50cm9vcCA9IEdhbWVNYW5hZ2VyLnRyb29wOwogICAgICB0aGlzLmVuZW1pZXMgPSBbXTsKICAgICAgdGhpcy5tZW1iZXJzID0gW107CiAgICAgIHRoaXMuZGVhZEVuZW1pZXMgPSBbXTsKICAgICAgdGhpcy5kZWFkTWVtYmVycyA9IFtdOwogICAgICB0aGlzLmFsaXZlRW5lbWllcyA9IFtdOwogICAgICB0aGlzLmFsaXZlTWVtYmVycyA9IFtdOwogICAgICB0aGlzLm1lc3NhZ2VDb250YWluZXIgPSBuZXcgTG9naWNfQmF0dGxlTWVzc2FnZSgpOwogICAgICBpZiAoR2FtZU1hbmFnZXIuYmF0dGxlTXVzaWMgIT0gbnVsbCkgewogICAgICAgIEF1ZGlvTWFuYWdlci5sb2FkTXVzaWMoR2FtZU1hbmFnZXIuYmF0dGxlTXVzaWMpOwogICAgICB9CiAgICAgIF9yZWYgPSB0aGlzLnRyb29wLnBhZ2VzOwogICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICBwYWdlID0gX3JlZltfaV07CiAgICAgICAgdGhpcy5pbnRlcnByZXRlcnMucHVzaChuZXcgQ29tbWFuZEludGVycHJldGVyKHBhZ2UuY29tbWFuZHMpKTsKICAgICAgfQogICAgICBjaGFyYWN0ZXIgPSBudWxsOwogICAgICBlbmVteSA9IG51bGw7CiAgICAgIHJlY29yZCA9IG51bGw7CiAgICAgIF9yZWYxID0gdGhpcy50cm9vcC5tZW1iZXJzOwogICAgICBmb3IgKF9qID0gMCwgX2xlbjEgPSBfcmVmMS5sZW5ndGg7IF9qIDwgX2xlbjE7IF9qKyspIHsKICAgICAgICBtZW1iZXIgPSBfcmVmMVtfal07CiAgICAgICAgcmVjb3JkID0gUmVjb3JkTWFuYWdlci5lbmVtaWVzW21lbWJlci5pZF07CiAgICAgICAgZW5lbXkgPSBuZXcgTG9naWNfQmF0dGxlcihuZXcgTG9naWNfRW5lbXkocmVjb3JkKSk7CiAgICAgICAgZW5lbXkuaXNIaWRkZW4gPSBtZW1iZXIuaGlkZGVuOwogICAgICAgIGVuZW15LmdyYXBoaWMgPSByZWNvcmQuZ3JhcGhpYzsKICAgICAgICBlbmVteS5tZXNzYWdlQ29udGFpbmVyID0gdGhpcy5tZXNzYWdlQ29udGFpbmVyOwogICAgICAgIGVuZW15LnggPSBtZW1iZXIueCAqICgyICogV2luZG93X0Jhc2Uuc2NhbGUpOwogICAgICAgIGVuZW15LnkgPSBtZW1iZXIueSAqICgyICogV2luZG93X0Jhc2Uuc2NhbGUpOwogICAgICAgIHRoaXMuZW5lbWllcy5wdXNoKGVuZW15KTsKICAgICAgICB0aGlzLmFsaXZlRW5lbWllcy5wdXNoKGVuZW15KTsKICAgICAgICB0aGlzLmJhdHRsZXJzLnB1c2goZW5lbXkpOwogICAgICAgIHRoaXMub3JkZXJlZEJhdHRsZXJzLnB1c2goZW5lbXkpOwogICAgICAgIGVuZW15U3ByaXRlID0gbmV3IFNwcml0ZV9CYXR0bGVyKGVuZW15KTsKICAgICAgICBlbmVteVNwcml0ZS5vcGFjaXR5ID0gMDsKICAgICAgICBlbmVteVNwcml0ZS5taXJyb3IgPSBtZW1iZXIuZmxpcDsKICAgICAgICB0aGlzLmVuZW15U3ByaXRlcy5wdXNoKGVuZW15U3ByaXRlKTsKICAgICAgICB0aGlzLmJhdHRsZXJTcHJpdGVzLnB1c2goZW5lbXlTcHJpdGUpOwogICAgICAgIFJlc291cmNlTG9hZGVyLmxvYWRBY3RvclNraWxsQW5pbWF0aW9ucyhlbmVteS5hY3Rvcik7CiAgICAgICAgUmVzb3VyY2VMb2FkZXIubG9hZEFjdG9yQmF0dGxlQW5pbWF0aW9ucyhlbmVteS5hY3Rvcik7CiAgICAgIH0KICAgICAgaWYgKHRoaXMudHJvb3AubWVtYmVycy5sZW5ndGggPT09IDApIHsKICAgICAgICB0aGlzLmJhdHRsZVdvbiA9IHRydWU7CiAgICAgIH0KICAgICAgZm9yIChpID0gX2sgPSAwLCBfcmVmMiA9IHRoaXMucGFydHkubWVtYmVycy5sZW5ndGg7IDAgPD0gX3JlZjIgPyBfayA8IF9yZWYyIDogX2sgPiBfcmVmMjsgaSA9IDAgPD0gX3JlZjIgPyArK19rIDogLS1faykgewogICAgICAgIG1lbWJlciA9IHRoaXMucGFydHkubWVtYmVyc1tpXTsKICAgICAgICBzID0gV2luZG93X0Jhc2Uuc2NhbGU7CiAgICAgICAgY2hhcmFjdGVyID0gbmV3IExvZ2ljX0JhdHRsZXIobWVtYmVyKTsKICAgICAgICBjaGFyYWN0ZXIubWVzc2FnZUNvbnRhaW5lciA9IHRoaXMubWVzc2FnZUNvbnRhaW5lcjsKICAgICAgICBpZiAobWVtYmVyLnN0YW5kQW5pbWF0aW9uICE9IG51bGwpIHsKICAgICAgICAgIGNoYXJhY3Rlci55ID0gbWVtYmVyLmJhdHRsZVBvc2l0aW9uLnkgKiAoMiAqIHMpOwogICAgICAgICAgY2hhcmFjdGVyLnggPSBtZW1iZXIuYmF0dGxlUG9zaXRpb24ueCAqICgyICogcyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNoYXJhY3Rlci54ID0gNDggKiBzICsgaSAqICgxNTQgKiBzKTsKICAgICAgICAgIGNoYXJhY3Rlci55ID0gR3JhcGhpY3MuaGVpZ2h0IC0gNjUgKiBzOwogICAgICAgIH0KICAgICAgICB0aGlzLm1lbWJlcnMucHVzaChjaGFyYWN0ZXIpOwogICAgICAgIHRoaXMuYmF0dGxlcnMucHVzaChjaGFyYWN0ZXIpOwogICAgICAgIHRoaXMuYWxpdmVNZW1iZXJzLnB1c2goY2hhcmFjdGVyKTsKICAgICAgICB0aGlzLm9yZGVyZWRCYXR0bGVycy5wdXNoKGNoYXJhY3Rlcik7CiAgICAgICAgbWVtYmVyU3ByaXRlID0gbmV3IFNwcml0ZV9CYXR0bGVyKGNoYXJhY3Rlcik7CiAgICAgICAgdGhpcy5tZW1iZXJTcHJpdGVzLnB1c2gobWVtYmVyU3ByaXRlKTsKICAgICAgICB0aGlzLmJhdHRsZXJTcHJpdGVzLnB1c2gobWVtYmVyU3ByaXRlKTsKICAgICAgICBSZXNvdXJjZUxvYWRlci5sb2FkQWN0b3JTa2lsbEFuaW1hdGlvbnMobWVtYmVyKTsKICAgICAgICBSZXNvdXJjZUxvYWRlci5sb2FkQWN0b3JCYXR0bGVBbmltYXRpb25zKG1lbWJlcik7CiAgICAgIH0KICAgICAgUmVzb3VyY2VMb2FkZXIubG9hZEl0ZW1BbmltYXRpb25zKEdhbWVNYW5hZ2VyLmludmVudG9yeSk7CiAgICAgIHJldHVybiB0aGlzLmFjdGl2ZU1lbWJlciA9IHRoaXMubWVtYmVyc1swXTsKICAgIH07CgogICAgU2NlbmVfQmF0dGxlLnByb3RvdHlwZS5wcmVwYXJlVmlzdWFsID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBhcHBlYXJTdHJpbmcsIGJhdHRsZXIsIGJhdHRsZXJTcHJpdGUsIGVuZW15LCB2b2NhYiwgX2ksIF9qLCBfaywgX2xlbiwgX2xlbjEsIF9sZW4yLCBfcmVmLCBfcmVmMSwgX3JlZjIsCiAgICAgICAgX3RoaXMgPSB0aGlzOwogICAgICBfcmVmID0gdGhpcy5iYXR0bGVyU3ByaXRlczsKICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBfcmVmLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7CiAgICAgICAgYmF0dGxlclNwcml0ZSA9IF9yZWZbX2ldOwogICAgICAgIGJhdHRsZXJTcHJpdGUudXBkYXRlKCk7CiAgICAgICAgYmF0dGxlclNwcml0ZS5sb2dpYzIueCArPSBiYXR0bGVyU3ByaXRlLnNyY1JlY3Qud2lkdGggLyAyOwogICAgICAgIGJhdHRsZXJTcHJpdGUueCA9IGJhdHRsZXJTcHJpdGUubG9naWMyLng7CiAgICAgIH0KICAgICAgdm9jYWIgPSBSZWNvcmRNYW5hZ2VyLnZvY2FidWxhcnk7CiAgICAgIHRoaXMudWlWaWV3cG9ydCA9IG5ldyBWaWV3cG9ydCgwLCAwLCBHcmFwaGljcy53aWR0aCwgR3JhcGhpY3MuaGVpZ2h0KTsKICAgICAgdGhpcy51aVZpZXdwb3J0LnogPSAxMDAwOwogICAgICB0aGlzLm1lc3NhZ2VDb250YWluZXJTcHJpdGVzZXQgPSBuZXcgU3ByaXRlc2V0X0JhdHRsZU1lc3NhZ2UodGhpcy5tZXNzYWdlQ29udGFpbmVyLCB0aGlzLnVpVmlld3BvcnQpOwogICAgICB0aGlzLmJhY2tncm91bmRTcHJpdGUgPSBuZXcgUGxhbmUoKTsKICAgICAgdGhpcy5iYWNrZ3JvdW5kU3ByaXRlLmJpdG1hcCA9IHRoaXMuYmFja2dyb3VuZDsKICAgICAgdGhpcy5iYWNrZ3JvdW5kU3ByaXRlLnNyY1JlY3QgPSBuZXcgUmVjdCgwLCAwLCB0aGlzLmJhY2tncm91bmQud2lkdGgsIHRoaXMuYmFja2dyb3VuZC5oZWlnaHQpOwogICAgICBpZiAodGhpcy5mb3JlZ3JvdW5kICE9IG51bGwpIHsKICAgICAgICB0aGlzLmZvcmVncm91bmRTcHJpdGUgPSBuZXcgUGxhbmUoKTsKICAgICAgICB0aGlzLmZvcmVncm91bmRTcHJpdGUuYml0bWFwID0gdGhpcy5mb3JlZ3JvdW5kOwogICAgICAgIHRoaXMuZm9yZWdyb3VuZFNwcml0ZS5zcmNSZWN0ID0gbmV3IFJlY3QoMCwgMCwgdGhpcy5mb3JlZ3JvdW5kLndpZHRoLCB0aGlzLmZvcmVncm91bmQuaGVpZ2h0KTsKICAgICAgICB0aGlzLmZvcmVncm91bmRTcHJpdGUueCA9IE1hdGguZmxvb3IoKEdyYXBoaWNzLndpZHRoIC0gdGhpcy5iYWNrZ3JvdW5kLndpZHRoKSAvIDIpOwogICAgICAgIHRoaXMuZm9yZWdyb3VuZFNwcml0ZS55ID0gTWF0aC5mbG9vcigoR3JhcGhpY3MuaGVpZ2h0IC0gdGhpcy5iYWNrZ3JvdW5kLmhlaWdodCkgLyAyKTsKICAgICAgICB0aGlzLmZvcmVncm91bmRTcHJpdGUueiA9IDEwMDsKICAgICAgfQogICAgICBHYW1lTWFuYWdlci5iYWNrZ3JvdW5kID0gdGhpcy5iYWNrZ3JvdW5kU3ByaXRlOwogICAgICBHYW1lTWFuYWdlclsiaW50ZXJmYWNlIl0gPSB0aGlzLnVpVmlld3BvcnQ7CiAgICAgIHRoaXMuYWN0aW9uV2luZG93ID0gbmV3IFdpbmRvd19TZWxlY3Rpb24oMCwgMCwgMSwgW1tsY3Modm9jYWIuYmF0dGxlLmF0dGFjayldLCBbbGNzKHZvY2FiLm1lbnUuc2tpbGxzKV0sIFtsY3Modm9jYWIuYmF0dGxlLmd1YXJkKV0sIFtsY3Modm9jYWIubWVudS5pdGVtcyldLCBbbGNzKHZvY2FiLmJhdHRsZS5lc2NhcGUpXV0sIDE1MCAqIFdpbmRvd19CYXNlLnNjYWxlLCAyMiAqIFdpbmRvd19CYXNlLnNjYWxlLCB0aGlzLnVpVmlld3BvcnQpOwogICAgICB0aGlzLmFjdGlvbldpbmRvdy52YWxpZGF0ZUNlbGwgPSBmdW5jdGlvbih4LCB5LCBjZWxsKSB7CiAgICAgICAgaWYgKHkgPT09IDQpIHsKICAgICAgICAgIHJldHVybiAhX3RoaXMubm9Fc2NhcGU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgfTsKICAgICAgdGhpcy5hY3Rpb25XaW5kb3cuY29udGVudHMuZm9udCA9IHRoaXMuYWN0aW9uV2luZG93LmFjdGlvbkZvbnQ7CiAgICAgIHRoaXMuYWN0aW9uV2luZG93LmhlaWdodCA9IDExNCAqIFdpbmRvd19CYXNlLnNjYWxlOwogICAgICB0aGlzLmFjdGlvbldpbmRvdy55ID0gR3JhcGhpY3MuaGVpZ2h0IC0gdGhpcy5hY3Rpb25XaW5kb3cuaGVpZ2h0OwogICAgICB0aGlzLmFjdGlvbldpbmRvdy5yZWRyYXcoKTsKICAgICAgdGhpcy5hY3Rpb25XaW5kb3cub25TZWxlY3Rpb25BY2NlcHQgPSBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gX3RoaXMub25BY3Rpb24oKTsKICAgICAgfTsKICAgICAgdGhpcy5hY3Rpb25XaW5kb3cub25DYW5jZWwgPSBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gX3RoaXMub25BY3Rpb25DYW5jZWwoKTsKICAgICAgfTsKICAgICAgdGhpcy5wYXJ0eVdpbmRvdyA9IG5ldyBXaW5kb3dfQmF0dGxlUGFydHkoMCwgMCwgR3JhcGhpY3Mud2lkdGggLSB0aGlzLmFjdGlvbldpbmRvdy53aWR0aCwgMTE0ICogV2luZG93X0Jhc2Uuc2NhbGUsIHRoaXMudWlWaWV3cG9ydCk7CiAgICAgIHRoaXMucGFydHlXaW5kb3cubWVtYmVycyA9IHRoaXMubWVtYmVyczsKICAgICAgdGhpcy5wYXJ0eVdpbmRvdy54ID0gdGhpcy5hY3Rpb25XaW5kb3cud2lkdGg7CiAgICAgIHRoaXMucGFydHlXaW5kb3cueSA9IHRoaXMuYWN0aW9uV2luZG93Lnk7CiAgICAgIHRoaXMucGFydHlXaW5kb3cucmVkcmF3KCk7CiAgICAgIHRoaXMuZ3JhcGhpY2FsUGFydHlXaW5kb3cgPSBuZXcgV2luZG93X1BhcnR5KHRoaXMudWlWaWV3cG9ydCk7CiAgICAgIHRoaXMuZ3JhcGhpY2FsUGFydHlXaW5kb3cueCA9IDA7CiAgICAgIHRoaXMuZ3JhcGhpY2FsUGFydHlXaW5kb3cueSA9IHRoaXMuYWN0aW9uV2luZG93Lnk7CiAgICAgIHRoaXMuZ3JhcGhpY2FsUGFydHlXaW5kb3cud2lkdGggPSBHcmFwaGljcy53aWR0aDsKICAgICAgdGhpcy5ncmFwaGljYWxQYXJ0eVdpbmRvdy5oZWlnaHQgPSAxMTQgKiBXaW5kb3dfQmFzZS5zY2FsZTsKICAgICAgdGhpcy5ncmFwaGljYWxQYXJ0eVdpbmRvdy5jdXJzb3JWaXNpYmxlID0gZmFsc2U7CiAgICAgIHRoaXMuZ3JhcGhpY2FsUGFydHlXaW5kb3cucmVkcmF3KCk7CiAgICAgIF9yZWYxID0gdGhpcy5iYXR0bGVyU3ByaXRlczsKICAgICAgZm9yIChfaiA9IDAsIF9sZW4xID0gX3JlZjEubGVuZ3RoOyBfaiA8IF9sZW4xOyBfaisrKSB7CiAgICAgICAgYmF0dGxlciA9IF9yZWYxW19qXTsKICAgICAgICBiYXR0bGVyLnByZXBhcmUoKTsKICAgICAgfQogICAgICB0aGlzLml0ZW1zV2luZG93c2V0ID0gbmV3IFdpbmRvd3NldF9JdGVtcygwLCAwLCB0aGlzLnVpVmlld3BvcnQsIEdyYXBoaWNzLndpZHRoKTsKICAgICAgdGhpcy5pdGVtc1dpbmRvd3NldC5vbkl0ZW1TZWxlY3Rpb24gPSBmdW5jdGlvbihpdGVtKSB7CiAgICAgICAgcmV0dXJuIF90aGlzLm9uSXRlbVNlbGVjdGlvbihpdGVtKTsKICAgICAgfTsKICAgICAgdGhpcy5pdGVtc1dpbmRvd3NldC5vbkNhbmNlbCA9IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBfdGhpcy5vbkl0ZW1TZWxlY3Rpb25DYW5jZWwoKTsKICAgICAgfTsKICAgICAgdGhpcy5pdGVtc1dpbmRvd3NldC5pdGVtcyA9IFsKICAgICAgICB7CiAgICAgICAgICBpdGVtOiBSZWNvcmRNYW5hZ2VyLml0ZW1zWzBdLAogICAgICAgICAgcHJpY2U6IDUwCiAgICAgICAgfQogICAgICBdOwogICAgICB0aGlzLml0ZW1zV2luZG93c2V0LnNob3coZmFsc2UpOwogICAgICB0aGlzLnNraWxsc1dpbmRvd3NldCA9IG5ldyBXaW5kb3dzZXRfU2tpbGxzKDAsIDAsIHRoaXMudWlWaWV3cG9ydCwgR3JhcGhpY3Mud2lkdGgpOwogICAgICB0aGlzLnNraWxsc1dpbmRvd3NldC5vblNraWxsU2VsZWN0aW9uID0gZnVuY3Rpb24oaXRlbSkgewogICAgICAgIHJldHVybiBfdGhpcy5vblNraWxsU2VsZWN0aW9uKGl0ZW0pOwogICAgICB9OwogICAgICB0aGlzLnNraWxsc1dpbmRvd3NldC5vbkNhbmNlbCA9IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBfdGhpcy5vblNraWxsU2VsZWN0aW9uQ2FuY2VsKCk7CiAgICAgIH07CiAgICAgIHRoaXMuc2tpbGxzV2luZG93c2V0LnNob3coZmFsc2UpOwogICAgICB0aGlzLnRhcmdldFNlbGVjdGlvbldpbmRvdyA9IG5ldyBXaW5kb3dfVGFyZ2V0U2VsZWN0aW9uKDAsIHRoaXMuYWN0aW9uV2luZG93LnksIHRoaXMudWlWaWV3cG9ydCk7CiAgICAgIHRoaXMudGFyZ2V0U2VsZWN0aW9uV2luZG93LnZpc2libGUgPSBmYWxzZTsKICAgICAgdGhpcy50YXJnZXRTZWxlY3Rpb25XaW5kb3cueiA9IDE7CiAgICAgIHRoaXMudGFyZ2V0U2VsZWN0aW9uV2luZG93LmhlaWdodCA9IHRoaXMuYWN0aW9uV2luZG93LmhlaWdodDsKICAgICAgdGhpcy50YXJnZXRTZWxlY3Rpb25XaW5kb3cub25TZWxlY3Rpb25DaGFuZ2UgPSBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gX3RoaXMub25UYXJnZXRTZWxlY3Rpb25DaGFuZ2UoKTsKICAgICAgfTsKICAgICAgdGhpcy50YXJnZXRTZWxlY3Rpb25XaW5kb3cub25UYXJnZXRTZWxlY3Rpb24gPSBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gX3RoaXMub25UYXJnZXRTZWxlY3Rpb24oKTsKICAgICAgfTsKICAgICAgdGhpcy50YXJnZXRTZWxlY3Rpb25XaW5kb3cub25DYW5jZWwgPSBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gX3RoaXMub25UYXJnZXRTZWxlY3Rpb25DYW5jZWwoKTsKICAgICAgfTsKICAgICAgYXBwZWFyU3RyaW5nID0gbGNzKHZvY2FiLmJhdHRsZS5hcHBlYXJzKTsKICAgICAgX3JlZjIgPSB0aGlzLmVuZW1pZXM7CiAgICAgIGZvciAoX2sgPSAwLCBfbGVuMiA9IF9yZWYyLmxlbmd0aDsgX2sgPCBfbGVuMjsgX2srKykgewogICAgICAgIGVuZW15ID0gX3JlZjJbX2tdOwogICAgICAgIGlmICghZW5lbXkuaXNIaWRkZW4pIHsKICAgICAgICAgIHRoaXMubWVzc2FnZUNvbnRhaW5lci5hZGRNZXNzYWdlKDAsIGFwcGVhclN0cmluZy5yZXBsYWNlKCJ7ZW5lbXl9IiwgZW5lbXkuYWN0b3IubmFtZSkpOwogICAgICAgIH0KICAgICAgfQogICAgICB0aGlzLm1lc3NhZ2VDb250YWluZXIucmVmcmVzaE5lZWRlZCA9IHRydWU7CiAgICAgIHRoaXMuY2hlY2tCYXR0bGVFdmVudENvbmRpdGlvbnMoKTsKICAgICAgaWYgKEdhbWVNYW5hZ2VyLmJhdHRsZU11c2ljICE9IG51bGwpIHsKICAgICAgICBBdWRpb01hbmFnZXIucGxheU11c2ljKEdhbWVNYW5hZ2VyLmJhdHRsZU11c2ljKTsKICAgICAgfQogICAgICByZXR1cm4gdGhpcy5jaGVja0JhdHRsZUVuZCgpOwogICAgfTsKCiAgICBTY2VuZV9CYXR0bGUucHJvdG90eXBlLnVwZGF0ZUFjdGlvbk9yZGVyID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIHJldHVybiB0aGlzLmFjdGlvbkxpc3Quc29ydChmdW5jdGlvbihhLCBiKSB7CiAgICAgICAgdmFyIGl0ZW07CiAgICAgICAgaXRlbSA9IGEuaXRlbSB8fCBhLnNraWxsOwogICAgICAgIGlmICgoYS5iYXR0bGVyLmFnaSArIGl0ZW0uc3BlZWQpID4gYi5iYXR0bGVyLmFnaSkgewogICAgICAgICAgcmV0dXJuIDE7CiAgICAgICAgfSBlbHNlIGlmICgoYS5iYXR0bGVyLmFnaSArIGl0ZW0uc3BlZWQpIDwgYi5iYXR0bGVyLmFnaSkgewogICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB9CiAgICAgIH0pOwogICAgfTsKCiAgICBTY2VuZV9CYXR0bGUucHJvdG90eXBlLnVwZGF0ZVNjcm9sbGluZyA9IGZ1bmN0aW9uKGluZm8sIHNwcml0ZSkgewogICAgICBpZiAoKGluZm8gIT0gbnVsbCkgJiYgKHNwcml0ZSAhPSBudWxsKSkgewogICAgICAgIGlmIChpbmZvLmxvb3BYKSB7CiAgICAgICAgICBzcHJpdGUub3ggKz0gaW5mby5zY3JvbGwueDsKICAgICAgICB9CiAgICAgICAgaWYgKGluZm8ubG9vcFkpIHsKICAgICAgICAgIHJldHVybiBzcHJpdGUub3kgKz0gaW5mby5zY3JvbGwueTsKICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgU2NlbmVfQmF0dGxlLnByb3RvdHlwZS51cGRhdGVCYWNrZ3JvdW5kID0gZnVuY3Rpb24oKSB7CiAgICAgIGlmICh0aGlzLnRlcnJhaW4gIT0gbnVsbCkgewogICAgICAgIHJldHVybiB0aGlzLnVwZGF0ZVNjcm9sbGluZyh0aGlzLnRlcnJhaW4uYmFja2dyb3VuZCwgdGhpcy5iYWNrZ3JvdW5kU3ByaXRlKTsKICAgICAgfQogICAgfTsKCiAgICBTY2VuZV9CYXR0bGUucHJvdG90eXBlLnVwZGF0ZUZvcmVncm91bmQgPSBmdW5jdGlvbigpIHsKICAgICAgaWYgKHRoaXMudGVycmFpbiAhPSBudWxsKSB7CiAgICAgICAgcmV0dXJuIHRoaXMudXBkYXRlU2Nyb2xsaW5nKHRoaXMudGVycmFpbi5mb3JlZ3JvdW5kLCB0aGlzLmZvcmVncm91bmRTcHJpdGUpOwogICAgICB9CiAgICB9OwoKICAgIFNjZW5lX0JhdHRsZS5wcm90b3R5cGUudXBkYXRlVWkgPSBmdW5jdGlvbigpIHsKICAgICAgdGhpcy5hY3Rpb25XaW5kb3cudXBkYXRlKCk7CiAgICAgIHRoaXMucGFydHlXaW5kb3cudXBkYXRlKCk7CiAgICAgIHRoaXMuZ3JhcGhpY2FsUGFydHlXaW5kb3cudXBkYXRlKCk7CiAgICAgIHRoaXMuaXRlbXNXaW5kb3dzZXQudXBkYXRlKCk7CiAgICAgIHRoaXMuc2tpbGxzV2luZG93c2V0LnVwZGF0ZSgpOwogICAgICB0aGlzLnRhcmdldFNlbGVjdGlvbldpbmRvdy51cGRhdGUoKTsKICAgICAgdGhpcy5tZXNzYWdlQ29udGFpbmVyLnVwZGF0ZSgpOwogICAgICByZXR1cm4gdGhpcy5tZXNzYWdlQ29udGFpbmVyU3ByaXRlc2V0LnVwZGF0ZSgpOwogICAgfTsKCiAgICBTY2VuZV9CYXR0bGUucHJvdG90eXBlLnVwZGF0ZUFuaW1hdGlvbnMgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGFuaW1hdGlvbiwgYW5pbWF0aW9ucywgYmF0dGxlciwgYmF0dGxlclNwcml0ZSwgaSwgcG9pbnQsIHNvdXJjZUFuaW1hdGlvbiwgc291cmNlQmF0dGxlciwgc3ByaXRlc2V0LCB0YXJnZXRBbmltYXRpb24sIHRhcmdldEJhdHRsZXIsIF9pLCBfaiwgX2ssIF9sLCBfbGVuLCBfbGVuMSwgX2xlbjIsIF9sZW4zLCBfcmVmLCBfcmVmMSwgX3JlZjIsIF9yZWYzLCBfcmVzdWx0czsKICAgICAgX3JlZiA9IHRoaXMudGV4dEFuaW1hdGlvbnM7CiAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gX3JlZi5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykgewogICAgICAgIGFuaW1hdGlvbiA9IF9yZWZbX2ldOwogICAgICAgIGlmIChhbmltYXRpb24gIT0gbnVsbCkgewogICAgICAgICAgYW5pbWF0aW9uLnVwZGF0ZSgpOwogICAgICAgIH0KICAgICAgfQogICAgICBfcmVmMSA9IHRoaXMuY29tcGxleEFuaW1hdGlvbnM7CiAgICAgIGZvciAoX2ogPSAwLCBfbGVuMSA9IF9yZWYxLmxlbmd0aDsgX2ogPCBfbGVuMTsgX2orKykgewogICAgICAgIGFuaW1hdGlvbiA9IF9yZWYxW19qXTsKICAgICAgICBpZiAoYW5pbWF0aW9uICE9IG51bGwpIHsKICAgICAgICAgIGFuaW1hdGlvbi51cGRhdGUoKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgX3JlZjIgPSB0aGlzLnNpbXBsZUFuaW1hdGlvbnM7CiAgICAgIGZvciAoX2sgPSAwLCBfbGVuMiA9IF9yZWYyLmxlbmd0aDsgX2sgPCBfbGVuMjsgX2srKykgewogICAgICAgIGFuaW1hdGlvbiA9IF9yZWYyW19rXTsKICAgICAgICBpZiAoYW5pbWF0aW9uICE9IG51bGwpIHsKICAgICAgICAgIGFuaW1hdGlvbi51cGRhdGUoKTsKICAgICAgICAgIGFuaW1hdGlvbi52aXNpYmxlID0gKGFuaW1hdGlvbi5sb2dpYyAhPSBudWxsKSAmJiBhbmltYXRpb24ubG9naWMuaXNSdW5uaW5nOwogICAgICAgIH0KICAgICAgfQogICAgICBfcmVmMyA9IHRoaXMuYmF0dGxlcnM7CiAgICAgIF9yZXN1bHRzID0gW107CiAgICAgIGZvciAoX2wgPSAwLCBfbGVuMyA9IF9yZWYzLmxlbmd0aDsgX2wgPCBfbGVuMzsgX2wrKykgewogICAgICAgIGJhdHRsZXIgPSBfcmVmM1tfbF07CiAgICAgICAgYW5pbWF0aW9ucyA9IGJhdHRsZXIuY3VycmVudEFuaW1hdGlvbnM7CiAgICAgICAgaWYgKGFuaW1hdGlvbnMgIT0gbnVsbCkgewogICAgICAgICAgX3Jlc3VsdHMucHVzaCgoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIHZhciBfbSwgX3JlZjQsIF9yZXN1bHRzMTsKICAgICAgICAgICAgX3Jlc3VsdHMxID0gW107CiAgICAgICAgICAgIGZvciAoaSA9IF9tID0gMCwgX3JlZjQgPSBhbmltYXRpb25zLmxlbmd0aDsgMCA8PSBfcmVmNCA/IF9tIDwgX3JlZjQgOiBfbSA+IF9yZWY0OyBpID0gMCA8PSBfcmVmNCA/ICsrX20gOiAtLV9tKSB7CiAgICAgICAgICAgICAgYW5pbWF0aW9uID0gYW5pbWF0aW9uc1tpXSAhPSBudWxsID8gYW5pbWF0aW9uc1tpXS5hbmltYXRpb24gOiBudWxsOwogICAgICAgICAgICAgIGlmICgoYW5pbWF0aW9uICE9IG51bGwpICYmIGFuaW1hdGlvbnNbaV0udHlwZSAhPT0gInNpbXBsZSIpIHsKICAgICAgICAgICAgICAgIGlmIChhbmltYXRpb24gJiYgKGFuaW1hdGlvbi50ZXh0ICE9IG51bGwpICYmICgodGhpcy50ZXh0QW5pbWF0aW9uc1tpXSA9PSBudWxsKSB8fCBhbmltYXRpb24gIT09IHRoaXMudGV4dEFuaW1hdGlvbnNbaV0ubG9naWMpKSB7CiAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnRleHRBbmltYXRpb25zW2ldID09IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLnRleHRBbmltYXRpb25zW2ldID0gbmV3IFNwcml0ZV9EYW1hZ2UobnVsbCwgdGhpcy52aWV3cG9ydCk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgdGhpcy50ZXh0QW5pbWF0aW9uc1tpXS5sb2dpYyA9IGFuaW1hdGlvbjsKICAgICAgICAgICAgICAgICAgdGhpcy50ZXh0QW5pbWF0aW9uc1tpXS56ID0gMjA7CiAgICAgICAgICAgICAgICAgIHRoaXMudGV4dEFuaW1hdGlvbnNbaV0udGFyZ2V0ID0gdGhpcy5zcHJpdGVGb3JMb2dpYyhiYXR0bGVyKTsKICAgICAgICAgICAgICAgICAgX3Jlc3VsdHMxLnB1c2godGhpcy50ZXh0QW5pbWF0aW9uc1tpXS5yZWZyZXNoKCkpOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhbmltYXRpb25zW2ldLnR5cGUgPT09ICJjb21wbGV4IiAmJiAhYW5pbWF0aW9uLnRleHQgJiYgKCh0aGlzLmNvbXBsZXhBbmltYXRpb25zW2ldID09IG51bGwpIHx8IHRoaXMuY29tcGxleEFuaW1hdGlvbnNbaV0ubG9naWMgIT09IGFuaW1hdGlvbikpIHsKICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuY29tcGxleEFuaW1hdGlvbnNbaV0gPT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuY29tcGxleEFuaW1hdGlvbnNbaV0gPSBuZXcgU3ByaXRlc2V0X0FuaW1hdGlvbihhbmltYXRpb24sIHRoaXMudmlld3BvcnQpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIHRoaXMuY29tcGxleEFuaW1hdGlvbnNbaV0ubG9naWMgPSBhbmltYXRpb247CiAgICAgICAgICAgICAgICAgIHRoaXMuY29tcGxleEFuaW1hdGlvbnNbaV0ucmVmcmVzaCgpOwogICAgICAgICAgICAgICAgICBfcmVzdWx0czEucHVzaCh0aGlzLmNvbXBsZXhBbmltYXRpb25zW2ldLnRhcmdldC5zcHJpdGUgPSB0aGlzLnNwcml0ZUZvckxvZ2ljKGJhdHRsZXIpKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYW5pbWF0aW9uc1tpXS50eXBlLnN0YXJ0c1dpdGgoInNpbXBsZV8iKSAmJiAoKHRoaXMuc2ltcGxlQW5pbWF0aW9uc1tpXSA9PSBudWxsKSB8fCB0aGlzLnNpbXBsZUFuaW1hdGlvbnNbaV0ubG9naWMgIT09IGFuaW1hdGlvbikpIHsKICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc2ltcGxlQW5pbWF0aW9uc1tpXSA9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5zaW1wbGVBbmltYXRpb25zW2ldID0gbmV3IFNwcml0ZV9TaW1wbGVBbmltYXRpb24oYW5pbWF0aW9uLCB0aGlzLnZpZXdwb3J0KTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICBzb3VyY2VCYXR0bGVyID0gbnVsbDsKICAgICAgICAgICAgICAgICAgdGFyZ2V0QmF0dGxlciA9IG51bGw7CiAgICAgICAgICAgICAgICAgIHNvdXJjZUFuaW1hdGlvbiA9IG51bGw7CiAgICAgICAgICAgICAgICAgIHRhcmdldEFuaW1hdGlvbiA9IG51bGw7CiAgICAgICAgICAgICAgICAgIGlmIChhbmltYXRpb25zW2ldLnR5cGUgPT09ICJzaW1wbGVfZm9yd2FyZCIpIHsKICAgICAgICAgICAgICAgICAgICBzb3VyY2VCYXR0bGVyID0gYmF0dGxlci5hdHRhY2tlcjsKICAgICAgICAgICAgICAgICAgICB0YXJnZXRCYXR0bGVyID0gYmF0dGxlcjsKICAgICAgICAgICAgICAgICAgICBzb3VyY2VBbmltYXRpb24gPSBzb3VyY2VCYXR0bGVyLnVzZXJBbmltYXRpb247CiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0QW5pbWF0aW9uID0gdGFyZ2V0QmF0dGxlci50YXJnZXRBbmltYXRpb247CiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgc291cmNlQmF0dGxlciA9IGJhdHRsZXI7CiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0QmF0dGxlciA9IGJhdHRsZXIuYXR0YWNrZXI7CiAgICAgICAgICAgICAgICAgICAgc291cmNlQW5pbWF0aW9uID0gc291cmNlQmF0dGxlci50YXJnZXRBbmltYXRpb247CiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0QW5pbWF0aW9uID0gbnVsbDsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICBiYXR0bGVyU3ByaXRlID0gdGhpcy5zcHJpdGVGb3JMb2dpYyhzb3VyY2VCYXR0bGVyKTsKICAgICAgICAgICAgICAgICAgc3ByaXRlc2V0ID0gbmV3IFNwcml0ZXNldF9BbmltYXRpb24oc291cmNlQW5pbWF0aW9uKTsKICAgICAgICAgICAgICAgICAgcG9pbnQgPSBzcHJpdGVzZXQuY2FsY3VsYXRlTGFzdExpbmtQb2ludChiYXR0bGVyU3ByaXRlKTsKICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uLnNvdXJjZSA9IHBvaW50OwogICAgICAgICAgICAgICAgICBzcHJpdGVzZXQuZGlzcG9zZSgpOwogICAgICAgICAgICAgICAgICBpZiAocG9pbnQueCA9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uLnNvdXJjZSA9IHsKICAgICAgICAgICAgICAgICAgICAgIHg6IGJhdHRsZXJTcHJpdGUueCArIGJhdHRsZXJTcHJpdGUuc3JjUmVjdC53aWR0aCAvIDIgLSA5NiwKICAgICAgICAgICAgICAgICAgICAgIHk6IGJhdHRsZXJTcHJpdGUueSArIGJhdHRsZXJTcHJpdGUuc3JjUmVjdC5oZWlnaHQgLyAyIC0gOTYKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIGJhdHRsZXJTcHJpdGUgPSB0aGlzLnNwcml0ZUZvckxvZ2ljKHRhcmdldEJhdHRsZXIpOwogICAgICAgICAgICAgICAgICBpZiAodGFyZ2V0QW5pbWF0aW9uICE9IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICBzcHJpdGVzZXQgPSBuZXcgU3ByaXRlc2V0X0FuaW1hdGlvbih0YXJnZXRBbmltYXRpb24pOwogICAgICAgICAgICAgICAgICAgIHBvaW50ID0gc3ByaXRlc2V0LmNhbGN1bGF0ZUZpcnN0TGlua1BvaW50KGJhdHRsZXJTcHJpdGUpOwogICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbi50YXJnZXQgPSBwb2ludDsKICAgICAgICAgICAgICAgICAgICBzcHJpdGVzZXQuZGlzcG9zZSgpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIGlmICgodGFyZ2V0QW5pbWF0aW9uID09IG51bGwpIHx8IChwb2ludC54ID09IG51bGwpKSB7CiAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uLnRhcmdldCA9IHsKICAgICAgICAgICAgICAgICAgICAgIHg6IGJhdHRsZXJTcHJpdGUueCArIGJhdHRsZXJTcHJpdGUuc3JjUmVjdC53aWR0aCAvIDIgLSA5NiwKICAgICAgICAgICAgICAgICAgICAgIHk6IGJhdHRsZXJTcHJpdGUueSArIGJhdHRsZXJTcHJpdGUuc3JjUmVjdC5oZWlnaHQgLyAyIC0gOTYKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIHRoaXMuc2ltcGxlQW5pbWF0aW9uc1tpXS5sb2dpYyA9IGFuaW1hdGlvbjsKICAgICAgICAgICAgICAgICAgdGhpcy5zaW1wbGVBbmltYXRpb25zW2ldLnJlZnJlc2goKTsKICAgICAgICAgICAgICAgICAgX3Jlc3VsdHMxLnB1c2goYW5pbWF0aW9uLnN0YXJ0KCkpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgX3Jlc3VsdHMxLnB1c2godm9pZCAwKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgX3Jlc3VsdHMxLnB1c2godm9pZCAwKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIF9yZXN1bHRzMTsKICAgICAgICAgIH0pLmNhbGwodGhpcykpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBfcmVzdWx0cy5wdXNoKHZvaWQgMCk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiBfcmVzdWx0czsKICAgIH07CgogICAgU2NlbmVfQmF0dGxlLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGFjdGlvbiwgYW5pbWF0aW9uLCBhbmltYXRpb25QaGFzZU1heCwgYmF0dGxlciwgZW5lbXksIGhhc0FuaW1hdGlvbnMsIHIsIHNwcml0ZSwgdGFyZ2V0LCBfaSwgX2osIF9rLCBfbCwgX2xlbiwgX2xlbjEsIF9sZW4yLCBfbGVuMywgX2xlbjQsIF9sZW41LCBfbGVuNiwgX2xlbjcsIF9sZW44LCBfbGVuOSwgX20sIF9uLCBfbywgX3AsIF9xLCBfciwgX3JlZiwgX3JlZjEsIF9yZWYxMCwgX3JlZjExLCBfcmVmMiwgX3JlZjMsIF9yZWY0LCBfcmVmNSwgX3JlZjYsIF9yZWY3LCBfcmVmOCwgX3JlZjksIF9zLCBfdDsKICAgICAgdGhpcy51cGRhdGVCYXR0bGVFdmVudCgpOwogICAgICBHYW1lTWFuYWdlci5iYWNrZ3JvdW5kLnZpc2libGUgPSB0cnVlOwogICAgICBHYW1lTWFuYWdlclsiaW50ZXJmYWNlIl0udmlzaWJsZSA9IHRydWU7CiAgICAgIEdhbWVNYW5hZ2VyLnVwZGF0ZSgpOwogICAgICB0aGlzLnVwZGF0ZVVpKCk7CiAgICAgIHRoaXMudXBkYXRlQmFja2dyb3VuZCgpOwogICAgICB0aGlzLnVwZGF0ZUZvcmVncm91bmQoKTsKICAgICAgdGhpcy5ncmFwaGljYWxQYXJ0eVdpbmRvdy52aXNpYmxlID0gIXRoaXMucGxheWVyc1R1cm47CiAgICAgIHRoaXMucGFydHlXaW5kb3cudmlzaWJsZSA9IHRoaXMucGxheWVyc1R1cm47CiAgICAgIHRoaXMuYWN0aW9uV2luZG93LnZpc2libGUgPSB0aGlzLnBsYXllcnNUdXJuOwogICAgICBfcmVmID0gdGhpcy5iYXR0bGVyczsKICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBfcmVmLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7CiAgICAgICAgYmF0dGxlciA9IF9yZWZbX2ldOwogICAgICAgIGJhdHRsZXIuYW5pbWF0aW9uUGhhc2UgPSB0aGlzLmFuaW1hdGlvblBoYXNlOwogICAgICAgIGJhdHRsZXIudXBkYXRlKCk7CiAgICAgIH0KICAgICAgdGhpcy51cGRhdGVBbmltYXRpb25zKCk7CiAgICAgIGlmICh0aGlzLmFuaW1hdGlvbnNSdW5uaW5nKSB7CiAgICAgICAgdGhpcy5hbmltYXRpb25zUnVubmluZyA9IGZhbHNlOwogICAgICAgIF9yZWYxID0gdGhpcy5iYXR0bGVyczsKICAgICAgICBmb3IgKF9qID0gMCwgX2xlbjEgPSBfcmVmMS5sZW5ndGg7IF9qIDwgX2xlbjE7IF9qKyspIHsKICAgICAgICAgIGJhdHRsZXIgPSBfcmVmMVtfal07CiAgICAgICAgICBpZiAoYmF0dGxlci5pc0FuaW1hdGlvblJ1bm5pbmcpIHsKICAgICAgICAgICAgdGhpcy5hbmltYXRpb25zUnVubmluZyA9IHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmICghdGhpcy5hbmltYXRpb25zUnVubmluZykgewogICAgICAgICAgYW5pbWF0aW9uUGhhc2VNYXggPSAwOwogICAgICAgICAgX3JlZjIgPSB0aGlzLmJhdHRsZXJzOwogICAgICAgICAgZm9yIChfayA9IDAsIF9sZW4yID0gX3JlZjIubGVuZ3RoOyBfayA8IF9sZW4yOyBfaysrKSB7CiAgICAgICAgICAgIGJhdHRsZXIgPSBfcmVmMltfa107CiAgICAgICAgICAgIGFuaW1hdGlvblBoYXNlTWF4ID0gTWF0aC5tYXgoYW5pbWF0aW9uUGhhc2VNYXgsIGJhdHRsZXIuYW5pbWF0aW9ucy5sZW5ndGggLSAxKTsKICAgICAgICAgIH0KICAgICAgICAgIGhhc0FuaW1hdGlvbnMgPSBmYWxzZTsKICAgICAgICAgIHRoaXMuYW5pbWF0aW9uUGhhc2UrKzsKICAgICAgICAgIHdoaWxlICghaGFzQW5pbWF0aW9ucyAmJiB0aGlzLmFuaW1hdGlvblBoYXNlIDw9IGFuaW1hdGlvblBoYXNlTWF4KSB7CiAgICAgICAgICAgIF9yZWYzID0gdGhpcy5iYXR0bGVyczsKICAgICAgICAgICAgZm9yIChfbCA9IDAsIF9sZW4zID0gX3JlZjMubGVuZ3RoOyBfbCA8IF9sZW4zOyBfbCsrKSB7CiAgICAgICAgICAgICAgYmF0dGxlciA9IF9yZWYzW19sXTsKICAgICAgICAgICAgICBpZiAoYmF0dGxlci5hbmltYXRpb25zW3RoaXMuYW5pbWF0aW9uUGhhc2VdICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIF9yZWY0ID0gYmF0dGxlci5hbmltYXRpb25zW3RoaXMuYW5pbWF0aW9uUGhhc2VdOwogICAgICAgICAgICAgICAgZm9yIChfbSA9IDAsIF9sZW40ID0gX3JlZjQubGVuZ3RoOyBfbSA8IF9sZW40OyBfbSsrKSB7CiAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbiA9IF9yZWY0W19tXTsKICAgICAgICAgICAgICAgICAgaWYgKGFuaW1hdGlvbiAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgaGFzQW5pbWF0aW9ucyA9IHRydWU7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKCFoYXNBbmltYXRpb25zKSB7CiAgICAgICAgICAgICAgdGhpcy5hbmltYXRpb25QaGFzZSsrOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICB0aGlzLmFuaW1hdGlvbnNSdW5uaW5nID0gdHJ1ZTsKICAgICAgICAgIGlmICh0aGlzLmFuaW1hdGlvblBoYXNlID4gYW5pbWF0aW9uUGhhc2VNYXgpIHsKICAgICAgICAgICAgdGhpcy5hbmltYXRpb25QaGFzZSA9IDA7CiAgICAgICAgICAgIHRoaXMuYW5pbWF0aW9uc1J1bm5pbmcgPSBmYWxzZTsKICAgICAgICAgICAgR3JhcGhpY3Mudmlld3BvcnQub3kgPSAwOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICBfcmVmNSA9IHRoaXMuYmF0dGxlclNwcml0ZXM7CiAgICAgIGZvciAoX24gPSAwLCBfbGVuNSA9IF9yZWY1Lmxlbmd0aDsgX24gPCBfbGVuNTsgX24rKykgewogICAgICAgIHNwcml0ZSA9IF9yZWY1W19uXTsKICAgICAgICBzcHJpdGUudXBkYXRlKCk7CiAgICAgIH0KICAgICAgaWYgKHRoaXMuaW50ZXJwcmV0ZXIuaXNSdW5uaW5nKSB7CiAgICAgICAgU2NlbmVfQmF0dGxlLl9fc3VwZXJfXy51cGRhdGUuY2FsbCh0aGlzKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgaWYgKCF0aGlzLmJhdHRsZVdvbiAmJiAhdGhpcy5iYXR0bGVMb3N0KSB7CiAgICAgICAgaWYgKHRoaXMucGxheWVyc1R1cm4pIHsKICAgICAgICAgIHRoaXMuYWN0aW9uV2luZG93LmN1cnNvclZpc2libGUgPSB0cnVlOwogICAgICAgICAgdGhpcy5wYXJ0eVdpbmRvdy5jdXJzb3JWaXNpYmxlID0gdHJ1ZTsKICAgICAgICB9IGVsc2UgaWYgKCF0aGlzLnByb2Nlc3NpbmdBY3Rpb25MaXN0KSB7CiAgICAgICAgICB0aGlzLmFjdGlvbldpbmRvdy5jdXJzb3JWaXNpYmxlID0gZmFsc2U7CiAgICAgICAgICB0aGlzLnBhcnR5V2luZG93LmN1cnNvclZpc2libGUgPSBmYWxzZTsKICAgICAgICAgIF9yZWY2ID0gdGhpcy5lbmVtaWVzOwogICAgICAgICAgZm9yIChfbyA9IDAsIF9sZW42ID0gX3JlZjYubGVuZ3RoOyBfbyA8IF9sZW42OyBfbysrKSB7CiAgICAgICAgICAgIGVuZW15ID0gX3JlZjZbX29dOwogICAgICAgICAgICBpZiAoIWVuZW15LmlzSGlkZGVuICYmIGVuZW15LmFjdG9yLmlzQWxpdmUpIHsKICAgICAgICAgICAgICBpZiAoZW5lbXkuZm9yY2VkQWN0aW9uICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIGZvciAociA9IF9wID0gMCwgX3JlZjcgPSBlbmVteS5mb3JjZWRBY3Rpb24uc2tpbGwucmVwZWF0czsgMCA8PSBfcmVmNyA/IF9wIDwgX3JlZjcgOiBfcCA+IF9yZWY3OyByID0gMCA8PSBfcmVmNyA/ICsrX3AgOiAtLV9wKSB7CiAgICAgICAgICAgICAgICAgIHRoaXMuYWN0aW9uTGlzdC5wdXNoKGVuZW15LmZvcmNlZEFjdGlvbik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbmVteS5sYXN0VGFyZ2V0ID0gZW5lbXkuZm9yY2VkQWN0aW9uLnRhcmdldHNbMF07CiAgICAgICAgICAgICAgICBlbmVteS5mb3JjZWRBY3Rpb24gPSBudWxsOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBhY3Rpb24gPSBlbmVteS50YWtlQWN0aW9uKDApOwogICAgICAgICAgICAgICAgaWYgKGFjdGlvbiAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICAgIGFjdGlvbi50YXJnZXRzID0gZW5lbXkuc2VsZWN0VGFyZ2V0cyhhY3Rpb24uc2tpbGwuc2NvcGUsIHRoaXMuZW5lbWllcywgdGhpcy5tZW1iZXJzLCB0aGlzLmJhdHRsZXJzKTsKICAgICAgICAgICAgICAgICAgZW5lbXkubGFzdFRhcmdldCA9IGFjdGlvbi50YXJnZXRzWzBdOwogICAgICAgICAgICAgICAgICBmb3IgKHIgPSBfcSA9IDAsIF9yZWY4ID0gYWN0aW9uLnNraWxsLnJlcGVhdHM7IDAgPD0gX3JlZjggPyBfcSA8IF9yZWY4IDogX3EgPiBfcmVmODsgciA9IDAgPD0gX3JlZjggPyArK19xIDogLS1fcSkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuYWN0aW9uTGlzdC5wdXNoKGFjdGlvbik7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIHRoaXMudXBkYXRlQWN0aW9uT3JkZXIoKTsKICAgICAgICAgIHRoaXMucHJvY2Vzc2luZ0FjdGlvbkxpc3QgPSB0cnVlOwogICAgICAgICAgX3JlZjkgPSB0aGlzLmJhdHRsZXJzOwogICAgICAgICAgZm9yIChfciA9IDAsIF9sZW43ID0gX3JlZjkubGVuZ3RoOyBfciA8IF9sZW43OyBfcisrKSB7CiAgICAgICAgICAgIGJhdHRsZXIgPSBfcmVmOVtfcl07CiAgICAgICAgICAgIGJhdHRsZXIuYXBwbHlFeFBhcmFtZXRlcnMoKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKCF0aGlzLmFuaW1hdGlvbnNSdW5uaW5nKSB7CiAgICAgICAgICB0aGlzLmNoZWNrQmF0dGxlRW5kKCk7CiAgICAgICAgICBpZiAodGhpcy5hY3Rpb25Qb2ludGVyID49IHRoaXMuYWN0aW9uTGlzdC5sZW5ndGggfHwgdGhpcy5iYXR0bGVFbmQpIHsKICAgICAgICAgICAgdGhpcy51cGRhdGVCYXR0bGVycygpOwogICAgICAgICAgICB0aGlzLmFjdGlvbldpbmRvdy5hY3RpdmUgPSB0cnVlOwogICAgICAgICAgICB0aGlzLmFjdGlvblBvaW50ZXIgPSAwOwogICAgICAgICAgICB0aGlzLnVwZGF0ZUJhdHRsZXJTcHJpdGVzKCk7CiAgICAgICAgICAgIHRoaXMucGFydHlXaW5kb3cucmVkcmF3KCk7CiAgICAgICAgICAgIHRoaXMuZ3JhcGhpY2FsUGFydHlXaW5kb3cucmVkcmF3KCk7CiAgICAgICAgICAgIHRoaXMucHJvY2Vzc2luZ0FjdGlvbkxpc3QgPSBmYWxzZTsKICAgICAgICAgICAgdGhpcy5wbGF5ZXJzVHVybiA9IHRydWU7CiAgICAgICAgICAgIHRoaXMuYWN0aW9uTGlzdCA9IFtdOwogICAgICAgICAgICB0aGlzLnNlbGVjdFZhbGlkTWVtYmVyKCk7CiAgICAgICAgICAgIHRoaXMudHVybisrOwogICAgICAgICAgICBfcmVmMTAgPSB0aGlzLmJhdHRsZXJzOwogICAgICAgICAgICBmb3IgKF9zID0gMCwgX2xlbjggPSBfcmVmMTAubGVuZ3RoOyBfcyA8IF9sZW44OyBfcysrKSB7CiAgICAgICAgICAgICAgYmF0dGxlciA9IF9yZWYxMFtfc107CiAgICAgICAgICAgICAgYmF0dGxlci5jaGVja1N0YXRlcyhmYWxzZSwgdHJ1ZSwgZmFsc2UsIHRoaXMudHVybiAtIDEsIDAsIDApOwogICAgICAgICAgICAgIGJhdHRsZXIuYWN0b3IucmVmcmVzaCgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICh0aGlzLmJhdHRsZUVuZCkgewogICAgICAgICAgICAgIHRoaXMuYWN0aW9uV2luZG93LmFjdGl2ZSA9IGZhbHNlOwogICAgICAgICAgICAgIHRoaXMuYWN0aW9uV2luZG93LnZpc2libGUgPSBmYWxzZTsKICAgICAgICAgICAgICB0aGlzLnBhcnR5V2luZG93LnZpc2libGUgPSBmYWxzZTsKICAgICAgICAgICAgICB0aGlzLnBsYXllcnNUdXJuID0gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRoaXMuY2hlY2tCYXR0bGVFdmVudENvbmRpdGlvbnMoKTsKICAgICAgICAgICAgYWN0aW9uID0gdGhpcy5hY3Rpb25MaXN0W3RoaXMuYWN0aW9uUG9pbnRlcl07CiAgICAgICAgICAgIHRoaXMuYWN0aW9uV2luZG93LmFjdGl2ZSA9IGZhbHNlOwogICAgICAgICAgICB0aGlzLnVwZGF0ZUJhdHRsZXJzKCk7CiAgICAgICAgICAgIHRoaXMucGFydHlXaW5kb3cucmVkcmF3KCk7CiAgICAgICAgICAgIHRoaXMuZ3JhcGhpY2FsUGFydHlXaW5kb3cucmVkcmF3KCk7CiAgICAgICAgICAgIHN3aXRjaCAoYWN0aW9uLnR5cGUpIHsKICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgICBpZiAoYWN0aW9uLmJhdHRsZXIuYWN0b3IuaXNBbGl2ZSAmJiAhYWN0aW9uLmJhdHRsZXIuYWN0b3IuaXNIaWRkZW4pIHsKICAgICAgICAgICAgICAgICAgYWN0aW9uLmJhdHRsZXIudGFyZ2V0cyA9IFtdOwogICAgICAgICAgICAgICAgICBpZiAoYWN0aW9uLnRhcmdldHMubGVuZ3RoID09PSAxICYmICFhY3Rpb24udGFyZ2V0c1swXS5hY3Rvci5pc0FsaXZlKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMubWVtYmVycy5pbmRleE9mKGFjdGlvbi5iYXR0bGVyKSAhPT0gLTEpIHsKICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi50YXJnZXRzID0gYWN0aW9uLmJhdHRsZXIuc2VsZWN0VGFyZ2V0cyhhY3Rpb24uaXRlbS5pdGVtLnNjb3BlLCB0aGlzLm1lbWJlcnMsIHRoaXMuZW5lbWllcywgdGhpcy5iYXR0bGVycyk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi50YXJnZXRzID0gYWN0aW9uLmJhdHRsZXIuc2VsZWN0VGFyZ2V0cyhhY3Rpb24uaXRlbS5pdGVtLnNjb3BlLCB0aGlzLmVuZW1pZXMsIHRoaXMubWVtYmVycywgdGhpcy5iYXR0bGVycyk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIGFjdGlvbi5iYXR0bGVyLnRhcmdldHMgPSBhY3Rpb24udGFyZ2V0czsKICAgICAgICAgICAgICAgICAgYWN0aW9uLmJhdHRsZXIudXNlSXRlbShhY3Rpb24uaXRlbS5pdGVtKTsKICAgICAgICAgICAgICAgICAgaWYgKGFjdGlvbi5pdGVtLml0ZW0udXNpbmdNZXNzYWdlICE9IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2VDb250YWluZXIuYWRkTWVzc2FnZSgwLCAiIiArIGFjdGlvbi5iYXR0bGVyLmFjdG9yLm5hbWUgKyAiICIgKyBhY3Rpb24uaXRlbS5pdGVtLnVzaW5nTWVzc2FnZSk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlQ29udGFpbmVyLnJlZnJlc2hOZWVkZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHRoaXMubWVzc2FnZUNvbnRhaW5lci5hZGRNZXNzYWdlKDAsICIiICsgYWN0aW9uLmJhdHRsZXIuYWN0b3IubmFtZSArICIgdXNlcyAiICsgYWN0aW9uLml0ZW0uaXRlbS5uYW1lICsgIiEiKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2VDb250YWluZXIucmVmcmVzaE5lZWRlZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgdGhpcy5hbmltYXRpb25zUnVubmluZyA9IHRydWU7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBhY3Rpb24uaXRlbS5jb3VudCsrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgaWYgKGFjdGlvbi5iYXR0bGVyLmFjdG9yLmlzQWxpdmUgJiYgIWFjdGlvbi5iYXR0bGVyLmFjdG9yLmlzSGlkZGVuKSB7CiAgICAgICAgICAgICAgICAgIGFjdGlvbi5iYXR0bGVyLnRhcmdldHMgPSBbXTsKICAgICAgICAgICAgICAgICAgaWYgKGFjdGlvbi50YXJnZXRzLmxlbmd0aCA9PT0gMSAmJiAhYWN0aW9uLnRhcmdldHNbMF0uYWN0b3IuaXNBbGl2ZSkgewogICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm1lbWJlcnMuaW5kZXhPZihhY3Rpb24uYmF0dGxlcikgIT09IC0xKSB7CiAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24udGFyZ2V0cyA9IGFjdGlvbi5iYXR0bGVyLnNlbGVjdFRhcmdldHMoYWN0aW9uLnNraWxsLnNjb3BlLCB0aGlzLm1lbWJlcnMsIHRoaXMuZW5lbWllcywgdGhpcy5iYXR0bGVycyk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi50YXJnZXRzID0gYWN0aW9uLmJhdHRsZXIuc2VsZWN0VGFyZ2V0cyhhY3Rpb24uc2tpbGwuc2NvcGUsIHRoaXMuZW5lbWllcywgdGhpcy5tZW1iZXJzLCB0aGlzLmJhdHRsZXJzKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgYWN0aW9uLmJhdHRsZXIudGFyZ2V0cyA9IGFjdGlvbi50YXJnZXRzOwogICAgICAgICAgICAgICAgICBhY3Rpb24uYmF0dGxlci51c2VTa2lsbChhY3Rpb24uc2tpbGwpOwogICAgICAgICAgICAgICAgICBpZiAoYWN0aW9uLnNraWxsLnVzaW5nTWVzc2FnZSAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlQ29udGFpbmVyLmFkZE1lc3NhZ2UoMCwgIiIgKyBhY3Rpb24uYmF0dGxlci5hY3Rvci5uYW1lICsgIiAiICsgYWN0aW9uLnNraWxsLnVzaW5nTWVzc2FnZSk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlQ29udGFpbmVyLnJlZnJlc2hOZWVkZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIHRoaXMuYW5pbWF0aW9uc1J1bm5pbmcgPSB0cnVlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgaWYgKGFjdGlvbi5iYXR0bGVyLmFjdG9yLmlzQWxpdmUgJiYgIWFjdGlvbi5iYXR0bGVyLmFjdG9yLmlzSGlkZGVuKSB7CiAgICAgICAgICAgICAgICAgIGFjdGlvbi5iYXR0bGVyLmd1YXJkKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgYWN0aW9uLmJhdHRsZXIuYWN0b3IucmVmcmVzaCgpOwogICAgICAgICAgICBpZiAoYWN0aW9uLmJhdHRsZXIuYWN0b3IuaXNBbGl2ZSAmJiAhYWN0aW9uLmJhdHRsZXIuYWN0b3IuaXNIaWRkZW4pIHsKICAgICAgICAgICAgICBhY3Rpb24uYmF0dGxlci5jaGVja1N0YXRlcyh0cnVlLCBmYWxzZSwgZmFsc2UsIHRoaXMudHVybiwgMCwgMCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgX3JlZjExID0gYWN0aW9uLnRhcmdldHM7CiAgICAgICAgICAgIGZvciAoX3QgPSAwLCBfbGVuOSA9IF9yZWYxMS5sZW5ndGg7IF90IDwgX2xlbjk7IF90KyspIHsKICAgICAgICAgICAgICB0YXJnZXQgPSBfcmVmMTFbX3RdOwogICAgICAgICAgICAgIHRhcmdldC5hY3Rvci5yZWZyZXNoKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhpcy5hY3Rpb25Qb2ludGVyKys7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiBTY2VuZV9CYXR0bGUuX19zdXBlcl9fLnVwZGF0ZS5jYWxsKHRoaXMpOwogICAgfTsKCiAgICBTY2VuZV9CYXR0bGUucHJvdG90eXBlLnRyYW5zZm9ybUVuZW15ID0gZnVuY3Rpb24oZW5lbXlJZCwgdGFyZ2V0KSB7CiAgICAgIHZhciBlbmVteSwgaW5kZXgsIG5ld0VuZW15LCBuZXdTcHJpdGUsIHNwcml0ZTsKICAgICAgZW5lbXkgPSB0aGlzLmVuZW1pZXNbZW5lbXlJZF07CiAgICAgIGlmICgoZW5lbXkgIT0gbnVsbCkgJiYgZW5lbXkuYWN0b3IuaXNBbGl2ZSkgewogICAgICAgIG5ld0VuZW15ID0gbmV3IExvZ2ljX0JhdHRsZXIobmV3IExvZ2ljX0VuZW15KHRhcmdldCkpOwogICAgICAgIG5ld0VuZW15LmFjdG9yLmxwID0gZW5lbXkuYWN0b3IubHA7CiAgICAgICAgbmV3RW5lbXkuYWN0b3IubXAgPSBlbmVteS5hY3Rvci5tcDsKICAgICAgICB0aGlzLmVuZW1pZXNbZW5lbXlJZF0gPSBuZXdFbmVteTsKICAgICAgICBpbmRleCA9IHRoaXMuYWxpdmVFbmVtaWVzLmluZGV4T2YoZW5lbXkpOwogICAgICAgIHRoaXMuYWxpdmVFbmVtaWVzW2luZGV4XSA9IG5ld0VuZW15OwogICAgICAgIGluZGV4ID0gdGhpcy5hbGl2ZUVuZW1pZXMuaW5kZXhPZihlbmVteSk7CiAgICAgICAgdGhpcy5iYXR0bGVyc1tpbmRleF0gPSBuZXdFbmVteTsKICAgICAgICBpbmRleCA9IHRoaXMuYWxpdmVFbmVtaWVzLmluZGV4T2YoZW5lbXkpOwogICAgICAgIHRoaXMub3JkZXJlZEJhdHRsZXJzW2luZGV4XSA9IG5ld0VuZW15OwogICAgICAgIHNwcml0ZSA9IHRoaXMuZW5lbXlTcHJpdGVzW2VuZW15SWRdOwogICAgICAgIG5ld1Nwcml0ZSA9IG5ldyBTcHJpdGVzZXRfQmF0dGxlcihuZXdFbmVteSk7CiAgICAgICAgdGhpcy5lbmVteVNwcml0ZXNbZW5lbXlJZF0gPSBuZXdTcHJpdGU7CiAgICAgICAgdGhpcy5lbmVteVNwcml0ZXNbZW5lbXlJZF0uc3ByaXRlLnggPSBzcHJpdGUuc3ByaXRlLnggKyAoc3ByaXRlLnNwcml0ZS5iaXRtYXAud2lkdGggLSBuZXdTcHJpdGUuc3ByaXRlLmJpdG1hcC53aWR0aCkgLyAyOwogICAgICAgIHRoaXMuZW5lbXlTcHJpdGVzW2VuZW15SWRdLnNwcml0ZS55ID0gc3ByaXRlLnNwcml0ZS55ICsgKHNwcml0ZS5zcHJpdGUuYml0bWFwLmhlaWdodCAtIG5ld1Nwcml0ZS5zcHJpdGUuYml0bWFwLmhlaWdodCkgLyAyOwogICAgICAgIGluZGV4ID0gdGhpcy5iYXR0bGVyU3ByaXRlcy5pbmRleE9mKHNwcml0ZSk7CiAgICAgICAgdGhpcy5iYXR0bGVyU3ByaXRlc1tpbmRleF0gPSBuZXdTcHJpdGU7CiAgICAgICAgcmV0dXJuIHNwcml0ZS5kaXNwb3NlKCk7CiAgICAgIH0KICAgIH07CgogICAgU2NlbmVfQmF0dGxlLnByb3RvdHlwZS5mb3JjZUFjdGlvbiA9IGZ1bmN0aW9uKHNraWxsLCB1c2VyLCB0YXJnZXQpIHsKICAgICAgcmV0dXJuIHVzZXIuZm9yY2VkQWN0aW9uID0gewogICAgICAgIHR5cGU6IDIsCiAgICAgICAgc2tpbGw6IHNraWxsLAogICAgICAgIGJhdHRsZXI6IHVzZXIsCiAgICAgICAgdGFyZ2V0czogW3RhcmdldF0KICAgICAgfTsKICAgIH07CgogICAgU2NlbmVfQmF0dGxlLnByb3RvdHlwZS5jaGVja0JhdHRsZUV2ZW50Q29uZGl0aW9uID0gZnVuY3Rpb24oY29uZGl0aW9uKSB7CiAgICAgIHZhciBlbmVteSwgcmVzdWx0OwogICAgICByZXN1bHQgPSBmYWxzZTsKICAgICAgc3dpdGNoIChjb25kaXRpb24udHlwZSkgewogICAgICAgIGNhc2UgMDoKICAgICAgICAgIHJlc3VsdCA9IHRydWU7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDE6CiAgICAgICAgICByZXN1bHQgPSB0aGlzLnR1cm4gPj0gY29uZGl0aW9uLmZyb21UdXJuID8gKCh0aGlzLnR1cm4gLSBjb25kaXRpb24uZnJvbVR1cm4pICUgY29uZGl0aW9uLmVhY2hUdXJuKSA9PT0gMCA6IGZhbHNlOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAyOgogICAgICAgICAgZW5lbXkgPSB0aGlzLmVuZW1pZXNbY29uZGl0aW9uLmxwRW5lbXlJZF07CiAgICAgICAgICByZXN1bHQgPSBNYXRoLmZsb29yKGVuZW15LmFjdG9yLmxwIC8gZW5lbXkuYWN0b3IubWxwICogMTAwKSA8PSBjb25kaXRpb24uZW5lbXlMcDsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgMzoKICAgICAgICAgIGVuZW15ID0gdGhpcy5lbmVtaWVzW2NvbmRpdGlvbi5tcEVuZW15SWRdOwogICAgICAgICAgcmVzdWx0ID0gTWF0aC5mbG9vcihlbmVteS5hY3Rvci5tcCAvIGVuZW15LmFjdG9yLm1tcCAqIDEwMCkgPD0gY29uZGl0aW9uLmVuZW15TXA7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDQ6CiAgICAgICAgICByZXN1bHQgPSBHYW1lTWFuYWdlci5ib29sZWFuc1tjb25kaXRpb25bInN3aXRjaCJdLmluZGV4XSA9PT0gY29uZGl0aW9uLnN3aXRjaFN0YXRlOwogICAgICB9CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9OwoKICAgIFNjZW5lX0JhdHRsZS5wcm90b3R5cGUuY2hlY2tCYXR0bGVFdmVudENvbmRpdGlvbnMgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIHBhZ2UsIHZhbGlkYXRpb25SZXN1bHQsIF9pLCBfcmVmLCBfcmVzdWx0czsKICAgICAgX3JlZiA9IHRoaXMudHJvb3AucGFnZXM7CiAgICAgIF9yZXN1bHRzID0gW107CiAgICAgIGZvciAoX2kgPSBfcmVmLmxlbmd0aCAtIDE7IF9pID49IDA7IF9pICs9IC0xKSB7CiAgICAgICAgcGFnZSA9IF9yZWZbX2ldOwogICAgICAgIGlmICghcGFnZS5leGVjdXRlZCkgewogICAgICAgICAgdmFsaWRhdGlvblJlc3VsdCA9IHRydWU7CiAgICAgICAgICBpZiAocGFnZS5jb25kaXRpb25FbmFibGVkMSkgewogICAgICAgICAgICB2YWxpZGF0aW9uUmVzdWx0ID0gdGhpcy5jaGVja0JhdHRsZUV2ZW50Q29uZGl0aW9uKHBhZ2UuY29uZGl0aW9uMSk7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAodmFsaWRhdGlvblJlc3VsdCAmJiBwYWdlLmNvbmRpdGlvbkVuYWJsZWQyKSB7CiAgICAgICAgICAgIHZhbGlkYXRpb25SZXN1bHQgPSB0aGlzLmNoZWNrQmF0dGxlRXZlbnRDb25kaXRpb24ocGFnZS5jb25kaXRpb24yKTsKICAgICAgICAgIH0KICAgICAgICAgIGlmICh2YWxpZGF0aW9uUmVzdWx0ICYmIHBhZ2UuY29uZGl0aW9uRW5hYmxlZDMpIHsKICAgICAgICAgICAgdmFsaWRhdGlvblJlc3VsdCA9IHRoaXMuY2hlY2tCYXR0bGVFdmVudENvbmRpdGlvbihwYWdlLmNvbmRpdGlvbjMpOwogICAgICAgICAgfQogICAgICAgICAgaWYgKHZhbGlkYXRpb25SZXN1bHQpIHsKICAgICAgICAgICAgcGFnZS5leGVjdXRlZCA9IHRydWU7CiAgICAgICAgICAgIHBhZ2UuZXhlY3V0aW9uVHVybiA9IHRoaXMudHVybjsKICAgICAgICAgICAgdGhpcy5pbnRlcnByZXRlci5jb21tYW5kcyA9IHBhZ2UuY29tbWFuZHM7CiAgICAgICAgICAgIHRoaXMuaW50ZXJwcmV0ZXIuc3RhcnQoKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBfcmVzdWx0cy5wdXNoKHZvaWQgMCk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIF9yZXN1bHRzLnB1c2godm9pZCAwKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIF9yZXN1bHRzOwogICAgfTsKCiAgICBTY2VuZV9CYXR0bGUucHJvdG90eXBlLnVwZGF0ZUJhdHRsZUV2ZW50ID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBwYWdlLCBfaSwgX2xlbiwgX3JlZjsKICAgICAgX3JlZiA9IHRoaXMudHJvb3AucGFnZXM7CiAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gX3JlZi5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykgewogICAgICAgIHBhZ2UgPSBfcmVmW19pXTsKICAgICAgICBpZiAocGFnZS5leGVjdXRlZCkgewogICAgICAgICAgc3dpdGNoIChwYWdlLmV4ZWN1dGlvbikgewogICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgcGFnZS5leGVjdXRlZCA9IHBhZ2UuZXhlY3V0aW9uVHVybiA9PT0gdGhpcy50dXJuOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgcGFnZS5leGVjdXRlZCA9IGZhbHNlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gdGhpcy5pbnRlcnByZXRlci51cGRhdGUoKTsKICAgIH07CgogICAgU2NlbmVfQmF0dGxlLnByb3RvdHlwZS51cGRhdGVCYXR0bGVyU3ByaXRlcyA9IGZ1bmN0aW9uKCkge307CgogICAgU2NlbmVfQmF0dGxlLnByb3RvdHlwZS51cGRhdGVCYXR0bGVycyA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgYmF0dGxlciwgZGVhZEJhdHRsZXJzLCBpLCBfaSwgX3JlZiwgX3Jlc3VsdHM7CiAgICAgIGRlYWRCYXR0bGVycyA9IFtdOwogICAgICBiYXR0bGVyID0gbnVsbDsKICAgICAgX3Jlc3VsdHMgPSBbXTsKICAgICAgZm9yIChpID0gX2kgPSAwLCBfcmVmID0gdGhpcy5lbmVtaWVzLmxlbmd0aDsgMCA8PSBfcmVmID8gX2kgPCBfcmVmIDogX2kgPiBfcmVmOyBpID0gMCA8PSBfcmVmID8gKytfaSA6IC0tX2kpIHsKICAgICAgICBiYXR0bGVyID0gdGhpcy5lbmVtaWVzW2ldOwogICAgICAgIGlmIChiYXR0bGVyLmFjdG9yLmxwIDw9IDAgJiYgdGhpcy5kZWFkRW5lbWllcy5pbmRleE9mKGJhdHRsZXIpID09PSAtMSkgewogICAgICAgICAgZGVhZEJhdHRsZXJzLnB1c2goYmF0dGxlcik7CiAgICAgICAgICB0aGlzLmRlYWRFbmVtaWVzLnB1c2goYmF0dGxlcik7CiAgICAgICAgICB0aGlzLmFsaXZlRW5lbWllcy5yZW1vdmUoYmF0dGxlcik7CiAgICAgICAgICBpZiAoIXRoaXMuYW5pbWF0aW9uc1J1bm5pbmcpIHsKICAgICAgICAgICAgX3Jlc3VsdHMucHVzaChiYXR0bGVyLmRlYWQgPSB0cnVlKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIF9yZXN1bHRzLnB1c2godm9pZCAwKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgX3Jlc3VsdHMucHVzaCh2b2lkIDApOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gX3Jlc3VsdHM7CiAgICB9OwoKICAgIFNjZW5lX0JhdHRsZS5wcm90b3R5cGUuc3RhcnRBbmltYXRpb24gPSBmdW5jdGlvbihhbmltYXRpb24sIHRhcmdldCkgewogICAgICB2YXIgbG9naWM7CiAgICAgIHRoaXMuYW5pbWF0aW9uc1J1bm5pbmcgPSB0cnVlOwogICAgICBsb2dpYyA9IG5ldyBMb2dpY19BbmltYXRpb24oYW5pbWF0aW9uKTsKICAgICAgdGhpcy50YXJnZXRBbmltYXRpb24ubG9naWMgPSBsb2dpYzsKICAgICAgdGhpcy50YXJnZXRBbmltYXRpb24ucmVmcmVzaCgpOwogICAgICB0aGlzLnRhcmdldEFuaW1hdGlvbi5wcmVwYXJlKCk7CiAgICAgIHRoaXMudGFyZ2V0QW5pbWF0aW9uLnRhcmdldC5zcHJpdGUgPSB0aGlzLmJhdHRsZXJTcHJpdGVzW3RhcmdldF07CiAgICAgIHRoaXMud2FpdENvdW50ZXIgPSBsb2dpYy5kdXJhdGlvbjsKICAgICAgbG9naWMuc3RhcnQoKTsKICAgICAgcmV0dXJuIHRoaXMuYW5pbWF0aW9uTGlzdFswXS5wdXNoKHRoaXMudGFyZ2V0QW5pbWF0aW9uKTsKICAgIH07CgogICAgU2NlbmVfQmF0dGxlLnByb3RvdHlwZS5zdGFydERhbWFnZUFuaW1hdGlvbiA9IGZ1bmN0aW9uKHRhcmdldCwgdmFsdWUpIHsKICAgICAgdGhpcy5hbmltYXRpb25zUnVubmluZyA9IHRydWU7CiAgICAgIHRoaXMuZGFtYWdlU3ByaXRlLnZhbHVlID0gdmFsdWU7CiAgICAgIHRoaXMuZGFtYWdlU3ByaXRlLnRhcmdldCA9IHRoaXMuYmF0dGxlclNwcml0ZXNbdGFyZ2V0XTsKICAgICAgdGhpcy5kYW1hZ2VTcHJpdGUucmVkcmF3KCk7CiAgICAgIHRoaXMuZGFtYWdlU3ByaXRlLmlzUnVubmluZyA9IHRydWU7CiAgICAgIHJldHVybiB0aGlzLmFuaW1hdGlvbkxpc3RbMV0ucHVzaCh0aGlzLmRhbWFnZVNwcml0ZSk7CiAgICB9OwoKICAgIFNjZW5lX0JhdHRsZS5wcm90b3R5cGUuc2VsZWN0VmFsaWRNZW1iZXIgPSBmdW5jdGlvbihiYWNrd2FyZHMpIHsKICAgICAgdmFyIG9sZEluZGV4OwogICAgICBvbGRJbmRleCA9IHRoaXMuYWN0aXZlTWVtYmVySW5kZXg7CiAgICAgIGlmIChiYWNrd2FyZHMgIT0gbnVsbCkgewogICAgICAgIHdoaWxlICh0aGlzLmFjdGl2ZU1lbWJlckluZGV4ID49IDAgJiYgIXRoaXMubWVtYmVyc1t0aGlzLmFjdGl2ZU1lbWJlckluZGV4XS5hY3Rvci5pc0FsaXZlKSB7CiAgICAgICAgICB0aGlzLmFjdGl2ZU1lbWJlckluZGV4LS07CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHdoaWxlICh0aGlzLmFjdGl2ZU1lbWJlckluZGV4IDwgdGhpcy5tZW1iZXJzLmxlbmd0aCAmJiAhdGhpcy5tZW1iZXJzW3RoaXMuYWN0aXZlTWVtYmVySW5kZXhdLmFjdG9yLmlzQWxpdmUpIHsKICAgICAgICAgIHRoaXMuYWN0aXZlTWVtYmVySW5kZXgrKzsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKHRoaXMuYWN0aXZlTWVtYmVySW5kZXggPj0gdGhpcy5tZW1iZXJzLmxlbmd0aCkgewogICAgICAgIHRoaXMuYWN0aXZlTWVtYmVySW5kZXggPSAwOwogICAgICAgIHRoaXMucGxheWVyc1R1cm4gPSBmYWxzZTsKICAgICAgfQogICAgICBpZiAodGhpcy5hY3RpdmVNZW1iZXJJbmRleCA8IDApIHsKICAgICAgICB0aGlzLmFjdGl2ZU1lbWJlckluZGV4ID0gb2xkSW5kZXggKyAxOwogICAgICB9CiAgICAgIHRoaXMuYWN0aXZlTWVtYmVyID0gdGhpcy5tZW1iZXJzW3RoaXMuYWN0aXZlTWVtYmVySW5kZXhdOwogICAgICByZXR1cm4gdGhpcy5wYXJ0eVdpbmRvdy5hY3RpdmVNZW1iZXIgPSB0aGlzLmFjdGl2ZU1lbWJlckluZGV4OwogICAgfTsKCiAgICBTY2VuZV9CYXR0bGUucHJvdG90eXBlLmVuZFR1cm4gPSBmdW5jdGlvbigpIHsKICAgICAgdGhpcy5hY3RpdmVNZW1iZXJJbmRleCsrOwogICAgICB0aGlzLnNlbGVjdFZhbGlkTWVtYmVyKCk7CiAgICAgIHRoaXMuYWN0aXZlTWVtYmVyID0gdGhpcy5tZW1iZXJzW3RoaXMuYWN0aXZlTWVtYmVySW5kZXhdOwogICAgICBpZiAodGhpcy5wbGF5ZXJzVHVybiAmJiAodGhpcy5hY3RpdmVNZW1iZXIuZm9yY2VkQWN0aW9uICE9IG51bGwpKSB7CiAgICAgICAgdGhpcy5hY3Rpb25MaXN0LnB1c2godGhpcy5hY3RpdmVNZW1iZXIuZm9yY2VkQWN0aW9uKTsKICAgICAgICB0aGlzLmFjdGl2ZU1lbWJlci5sYXN0VGFyZ2V0ID0gdGhpcy5hY3RpdmVNZW1iZXIuZm9yY2VkQWN0aW9uLnRhcmdldHNbMF07CiAgICAgICAgdGhpcy5hY3RpdmVNZW1iZXIuZm9yY2VkQWN0aW9uID0gbnVsbDsKICAgICAgICByZXR1cm4gdGhpcy5lbmRUdXJuKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIHRoaXMucGFydHlXaW5kb3cuYWN0aXZlTWVtYmVyID0gdGhpcy5hY3RpdmVNZW1iZXJJbmRleDsKICAgICAgfQogICAgfTsKCiAgICBTY2VuZV9CYXR0bGUucHJvdG90eXBlLmVuZEJhdHRsZSA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgY29uZGl0aW9uUmVzdWx0LCBkcm9wSXRlbXMsIGRyb3BTdHJpbmcsIGRyb3BwZWRJdGVtLCBlbmVteSwgZXhwLCBleHBTdHJpbmcsIGksIGl0ZW0sIGxlYXJuU3RyaW5nLCBsZWFybmFibGVTa2lsbCwgbGV2ZWwsIGxldmVsVXBTdHJpbmcsIG1lbWJlciwgbW9uZXksIG1vbmV5U3RyaW5nLCBza2lsbCwgc3RhdGUsIF9pLCBfaiwgX2ssIF9sLCBfbGVuLCBfbGVuMSwgX2xlbjIsIF9sZW4zLCBfbSwgX3JlZiwgX3JlZjEsIF9yZWYyLCBfcmVmMywgX3JlZjQsCiAgICAgICAgX3RoaXMgPSB0aGlzOwogICAgICBpZiAodGhpcy5iYXR0bGVXb24pIHsKICAgICAgICBleHAgPSAwOwogICAgICAgIG1vbmV5ID0gMDsKICAgICAgICBfcmVmID0gdGhpcy5kZWFkRW5lbWllczsKICAgICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICAgIGVuZW15ID0gX3JlZltfaV07CiAgICAgICAgICBleHAgKz0gZW5lbXkuYWN0b3IuZXhwOwogICAgICAgICAgbW9uZXkgKz0gZW5lbXkuYWN0b3IubW9uZXk7CiAgICAgICAgfQogICAgICAgIHRoaXMubWVzc2FnZUNvbnRhaW5lci53YWl0Rm9yS2V5ID0gdHJ1ZTsKICAgICAgICB0aGlzLm1lc3NhZ2VDb250YWluZXIubWVzc2FnZXMgPSBbXTsKICAgICAgICB0aGlzLm1lc3NhZ2VDb250YWluZXIuYWRkTWVzc2FnZSgwLCBsY3ModGhpcy52b2NhYi5iYXR0bGUud29uKSk7CiAgICAgICAgbGV2ZWxVcFN0cmluZyA9IGxjcyh0aGlzLnZvY2FiLmJhdHRsZS5sZXZlbFVwKTsKICAgICAgICBsZWFyblN0cmluZyA9IGxjcyh0aGlzLnZvY2FiLmJhdHRsZS5sZWFybnNTa2lsbCk7CiAgICAgICAgZXhwU3RyaW5nID0gbGNzKHRoaXMudm9jYWIuYmF0dGxlLmV4cFJlY2VpdmVkKTsKICAgICAgICBtb25leVN0cmluZyA9IGxjcyh0aGlzLnZvY2FiLmJhdHRsZS5tb25leVJlY2VpdmVkKTsKICAgICAgICBkcm9wU3RyaW5nID0gbGNzKHRoaXMudm9jYWIuYmF0dGxlLmRyb3ApOwogICAgICAgIGZvciAoaSA9IF9qID0gMCwgX3JlZjEgPSB0aGlzLm1lbWJlcnMubGVuZ3RoOyAwIDw9IF9yZWYxID8gX2ogPCBfcmVmMSA6IF9qID4gX3JlZjE7IGkgPSAwIDw9IF9yZWYxID8gKytfaiA6IC0tX2opIHsKICAgICAgICAgIG1lbWJlciA9IHRoaXMubWVtYmVyc1tpXTsKICAgICAgICAgIGlmIChtZW1iZXIuYWN0b3IuaXNBbGl2ZSkgewogICAgICAgICAgICBsZXZlbCA9IG1lbWJlci5hY3Rvci5sZXZlbDsKICAgICAgICAgICAgbWVtYmVyLmFjdG9yLmV4cCArPSBleHA7CiAgICAgICAgICAgIG1lbWJlci5hY3Rvci5yZWZyZXNoKCk7CiAgICAgICAgICAgIGlmIChtZW1iZXIuYWN0b3IubGV2ZWwgIT09IGxldmVsKSB7CiAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlQ29udGFpbmVyLmFkZE1lc3NhZ2UoaSArIDEsIGxldmVsVXBTdHJpbmcucmVwbGFjZSgie2FjdG9yfSIsIG1lbWJlci5hY3Rvci5uYW1lKS5yZXBsYWNlKCJ7bGV2ZWx9IiwgbWVtYmVyLmFjdG9yLmxldmVsKSk7CiAgICAgICAgICAgICAgX3JlZjIgPSBtZW1iZXIuYWN0b3JbImNsYXNzIl0uc2tpbGxzOwogICAgICAgICAgICAgIGZvciAoX2sgPSAwLCBfbGVuMSA9IF9yZWYyLmxlbmd0aDsgX2sgPCBfbGVuMTsgX2srKykgewogICAgICAgICAgICAgICAgbGVhcm5hYmxlU2tpbGwgPSBfcmVmMltfa107CiAgICAgICAgICAgICAgICBpZiAobGVhcm5hYmxlU2tpbGwubGV2ZWwgPiBsZXZlbCAmJiBsZWFybmFibGVTa2lsbC5sZXZlbCA8PSBtZW1iZXIuYWN0b3IubGV2ZWwpIHsKICAgICAgICAgICAgICAgICAgc2tpbGwgPSBSZWNvcmRNYW5hZ2VyLnNraWxsc1tsZWFybmFibGVTa2lsbC5za2lsbElkXTsKICAgICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlQ29udGFpbmVyLmFkZE1lc3NhZ2UoaSArIDEsIGxlYXJuc1N0cmluZy5yZXBsYWNlKCJ7YWN0b3J9IiwgbWVtYmVyLmFjdG9yLm5hbWUpLnJlcGxhY2UoIntza2lsbH0iLCBza2lsbC5uYW1lKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXMubWVzc2FnZUNvbnRhaW5lci5hZGRNZXNzYWdlKDAsIGV4cFN0cmluZy5yZXBsYWNlKCJ7YWN0b3J9IiwgbWVtYmVyLmFjdG9yLm5hbWUpLnJlcGxhY2UoIntleHB9IiwgZXhwKSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIEdhbWVNYW5hZ2VyLm1vbmV5ICs9IG1vbmV5OwogICAgICAgIHRoaXMubWVzc2FnZUNvbnRhaW5lci5hZGRNZXNzYWdlKDAsIG1vbmV5U3RyaW5nLnJlcGxhY2UoInttb25leX0iLCBtb25leSkucmVwbGFjZSgie2N1cn0iLCBsY3ModGhpcy52b2NhYi5zaG9wTWVudS5jdXJyZW5jeSkpKTsKICAgICAgICBkcm9wSXRlbXMgPSBbXTsKICAgICAgICBfcmVmMyA9IHRoaXMuZGVhZEVuZW1pZXM7CiAgICAgICAgZm9yIChfbCA9IDAsIF9sZW4yID0gX3JlZjMubGVuZ3RoOyBfbCA8IF9sZW4yOyBfbCsrKSB7CiAgICAgICAgICBlbmVteSA9IF9yZWYzW19sXTsKICAgICAgICAgIGlmICghZW5lbXkuaXNIaWRkZW4pIHsKICAgICAgICAgICAgX3JlZjQgPSBlbmVteS5hY3Rvci5kcm9wSXRlbXM7CiAgICAgICAgICAgIGZvciAoX20gPSAwLCBfbGVuMyA9IF9yZWY0Lmxlbmd0aDsgX20gPCBfbGVuMzsgX20rKykgewogICAgICAgICAgICAgIGl0ZW0gPSBfcmVmNFtfbV07CiAgICAgICAgICAgICAgaWYgKE1hdGgucmFuZG9tKCkgKiAxMDAgPD0gaXRlbS5wcm9wYWJpbGl0eSkgewogICAgICAgICAgICAgICAgY29uZGl0aW9uUmVzdWx0ID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGlmIChpdGVtLmNvbmRpdGlvbi5zdGF0ZSkgewogICAgICAgICAgICAgICAgICBzdGF0ZSA9IFJlY29yZE1hbmFnZXIuc3RhdGVzW2l0ZW0uY29uZGl0aW9uLnN0YXRlSWRdOwogICAgICAgICAgICAgICAgICBjb25kaXRpb25SZXN1bHQgPSAoc3RhdGUgIT0gbnVsbCkgJiYgZW5lbXkuYWN0b3IuaGFzU3RhdGUoc3RhdGUpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKGNvbmRpdGlvblJlc3VsdCAmJiBpdGVtLmNvbmRpdGlvblsic3dpdGNoIl0pIHsKICAgICAgICAgICAgICAgICAgY29uZGl0aW9uUmVzdWx0ID0gR2FtZU1hbmFnZXIudmFyaWFibGVTdG9yZS5ib29sZWFuVmFsdWVPZihpdGVtLmNvbmRpdGlvbi5zd2l0Y2hJZCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoY29uZGl0aW9uUmVzdWx0KSB7CiAgICAgICAgICAgICAgICAgIGRyb3BwZWRJdGVtID0gbnVsbDsKICAgICAgICAgICAgICAgICAgc3dpdGNoIChpdGVtLmRyb3BUeXBlKSB7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgZHJvcHBlZEl0ZW0gPSBSZWNvcmRNYW5hZ2VyLml0ZW1zW2l0ZW0uaXRlbUlkXTsKICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICAgICAgICAgIGRyb3BwZWRJdGVtID0gUmVjb3JkTWFuYWdlci53ZWFwb25zW2l0ZW0uaXRlbUlkXTsKICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgICAgIGRyb3BwZWRJdGVtID0gUmVjb3JkTWFuYWdlci5hcm1vcnNbaXRlbS5pdGVtSWRdOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIGlmIChkcm9wcGVkSXRlbSAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgR2FtZU1hbmFnZXIuaW52ZW50b3J5LmFkZEl0ZW0oZHJvcHBlZEl0ZW0sIDEpOwogICAgICAgICAgICAgICAgICAgIGRyb3BJdGVtcy5wdXNoKGRyb3BwZWRJdGVtLm5hbWUpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmIChkcm9wSXRlbXMubGVuZ3RoID4gMCkgewogICAgICAgICAgdGhpcy5tZXNzYWdlQ29udGFpbmVyLmFkZE1lc3NhZ2UoMCwgZHJvcFN0cmluZy5yZXBsYWNlKCJ7dHJvb3B9IiwgdGhpcy50cm9vcC5uYW1lKS5yZXBsYWNlKCJ7aXRlbXN9IiwgZHJvcEl0ZW1zLmpvaW4oIiwgIikpKTsKICAgICAgICB9CiAgICAgICAgdGhpcy5hY3Rpb25XaW5kb3cuYWN0aXZlID0gZmFsc2U7CiAgICAgICAgdGhpcy5hY3Rpb25XaW5kb3cudmlzaWJsZSA9IGZhbHNlOwogICAgICAgIHRoaXMucGFydHlXaW5kb3cudmlzaWJsZSA9IGZhbHNlOwogICAgICAgIHRoaXMubWVzc2FnZUNvbnRhaW5lci5yZWZyZXNoTmVlZGVkID0gdHJ1ZTsKICAgICAgICB0aGlzLm1lc3NhZ2VDb250YWluZXIub25UaW1lclRpY2sgPSBmdW5jdGlvbigpIHsKICAgICAgICAgIGlmICgkUEFSQU1TLmJhdHRsZVRlc3QgIT0gbnVsbCkgewogICAgICAgICAgICByZXR1cm4gU2NlbmVNYW5hZ2VyLnN3aXRjaFRvKG5ldyBTY2VuZV9CYXR0bGVUZXN0KCkpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIFNjZW5lTWFuYWdlci5zd2l0Y2hUbyhuZXcgU2NlbmVfQmF0dGxlV29uKCkpOwogICAgICAgICAgfQogICAgICAgIH07CiAgICAgIH0KICAgICAgaWYgKHRoaXMuYmF0dGxlTG9zdCkgewogICAgICAgIHRoaXMuYWN0aW9uV2luZG93LmFjdGl2ZSA9IGZhbHNlOwogICAgICAgIHRoaXMuYWN0aW9uV2luZG93LnZpc2libGUgPSBmYWxzZTsKICAgICAgICB0aGlzLnBhcnR5V2luZG93LnZpc2libGUgPSBmYWxzZTsKICAgICAgICBpZiAodGhpcy5jb250aW51ZU9uTG9zZSkgewogICAgICAgICAgdGhpcy5tZXNzYWdlQ29udGFpbmVyLndhaXRGb3JLZXkgPSB0cnVlOwogICAgICAgICAgdGhpcy5tZXNzYWdlQ29udGFpbmVyLm1lc3NhZ2VzID0gW107CiAgICAgICAgICB0aGlzLm1lc3NhZ2VDb250YWluZXIuYWRkTWVzc2FnZSgwLCBsY3ModGhpcy52b2NhYi5iYXR0bGUub3ZlcikpOwogICAgICAgICAgcmV0dXJuIHRoaXMubWVzc2FnZUNvbnRhaW5lci5vblRpbWVyVGljayA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICBpZiAoJFBBUkFNUy5iYXR0bGVUZXN0ICE9IG51bGwpIHsKICAgICAgICAgICAgICByZXR1cm4gU2NlbmVNYW5hZ2VyLnN3aXRjaFRvKG5ldyBTY2VuZV9CYXR0bGVUZXN0KCkpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHJldHVybiBTY2VuZU1hbmFnZXIuc3dpdGNoVG8obmV3IFNjZW5lX01hcCgpKTsKICAgICAgICAgICAgfQogICAgICAgICAgfTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5tZXNzYWdlQ29udGFpbmVyLndhaXRGb3JLZXkgPSB0cnVlOwogICAgICAgICAgdGhpcy5tZXNzYWdlQ29udGFpbmVyLm1lc3NhZ2VzID0gW107CiAgICAgICAgICB0aGlzLm1lc3NhZ2VDb250YWluZXIuYWRkTWVzc2FnZSgwLCBsY3ModGhpcy52b2NhYi5iYXR0bGUubG9zdCkpOwogICAgICAgICAgcmV0dXJuIHRoaXMubWVzc2FnZUNvbnRhaW5lci5vblRpbWVyVGljayA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICBpZiAoJFBBUkFNUy5iYXR0bGVUZXN0ICE9IG51bGwpIHsKICAgICAgICAgICAgICByZXR1cm4gU2NlbmVNYW5hZ2VyLnN3aXRjaFRvKG5ldyBTY2VuZV9CYXR0bGVUZXN0KCkpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHJldHVybiBTY2VuZU1hbmFnZXIuc3dpdGNoVG8obmV3IFNjZW5lX0dhbWVPdmVyKCkpOwogICAgICAgICAgICB9CiAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICBTY2VuZV9CYXR0bGUucHJvdG90eXBlLmNoZWNrQmF0dGxlRW5kID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBlbmVteSwgbWVtYmVyLCBfaSwgX2osIF9sZW4sIF9sZW4xLCBfcmVmLCBfcmVmMTsKICAgICAgaWYgKHRoaXMuYmF0dGxlV29uIHx8IHRoaXMuYmF0dGxlTG9zdCkgewogICAgICAgIHJldHVybiB0aGlzLmVuZEJhdHRsZSgpOwogICAgICB9CiAgICAgIHRoaXMuYmF0dGxlV29uID0gdHJ1ZTsKICAgICAgX3JlZiA9IHRoaXMuZW5lbWllczsKICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBfcmVmLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7CiAgICAgICAgZW5lbXkgPSBfcmVmW19pXTsKICAgICAgICBpZiAoZW5lbXkuYWN0b3IubHAgPiAwICYmICFlbmVteS5pc0hpZGRlbikgewogICAgICAgICAgdGhpcy5iYXR0bGVXb24gPSBmYWxzZTsKICAgICAgICB9CiAgICAgIH0KICAgICAgdGhpcy5iYXR0bGVMb3N0ID0gdHJ1ZTsKICAgICAgX3JlZjEgPSB0aGlzLm1lbWJlcnM7CiAgICAgIGZvciAoX2ogPSAwLCBfbGVuMSA9IF9yZWYxLmxlbmd0aDsgX2ogPCBfbGVuMTsgX2orKykgewogICAgICAgIG1lbWJlciA9IF9yZWYxW19qXTsKICAgICAgICBpZiAobWVtYmVyLmFjdG9yLmxwID4gMCkgewogICAgICAgICAgdGhpcy5iYXR0bGVMb3N0ID0gZmFsc2U7CiAgICAgICAgfQogICAgICB9CiAgICAgIHRoaXMuYmF0dGxlRW5kID0gdGhpcy5iYXR0bGVXb24gfHwgdGhpcy5iYXR0bGVMb3N0OwogICAgICB0aGlzLmVuZEJhdHRsZSgpOwogICAgICByZXR1cm4gdGhpcy5iYXR0bGVFbmQ7CiAgICB9OwoKICAgIFNjZW5lX0JhdHRsZS5wcm90b3R5cGUuc3ByaXRlRm9yTG9naWMgPSBmdW5jdGlvbihsb2dpYykgewogICAgICB2YXIgcmVzdWx0LCBzcHJpdGUsIF9pLCBfbGVuLCBfcmVmOwogICAgICByZXN1bHQgPSBudWxsOwogICAgICBfcmVmID0gdGhpcy5iYXR0bGVyU3ByaXRlczsKICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBfcmVmLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7CiAgICAgICAgc3ByaXRlID0gX3JlZltfaV07CiAgICAgICAgaWYgKHNwcml0ZS5sb2dpYzIgPT09IGxvZ2ljKSB7CiAgICAgICAgICByZXN1bHQgPSBzcHJpdGU7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH07CgogICAgU2NlbmVfQmF0dGxlLnByb3RvdHlwZS5lc2NhcGUgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgdGhpcy5tZXNzYWdlQ29udGFpbmVyLmFkZE1lc3NhZ2UoMCwgbGNzKHRoaXMudm9jYWIuYmF0dGxlLmVzY2FwZWQpKTsKICAgICAgcmV0dXJuIHRoaXMubWVzc2FnZUNvbnRhaW5lci5vblRpbWVyVGljayA9IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBTY2VuZU1hbmFnZXIuc3dpdGNoVG8obmV3IFNjZW5lX01hcCgpKTsKICAgICAgfTsKICAgIH07CgogICAgU2NlbmVfQmF0dGxlLnByb3RvdHlwZS5vbkFjdGlvbiA9IGZ1bmN0aW9uKCkgewogICAgICBzd2l0Y2ggKHRoaXMuYWN0aW9uV2luZG93LnNlbGVjdGVkUm93KSB7CiAgICAgICAgY2FzZSAwOgogICAgICAgICAgdGhpcy5hY3Rpb25XaW5kb3cuYWN0aXZlID0gZmFsc2U7CiAgICAgICAgICByZXR1cm4gdGhpcy5vblNraWxsU2VsZWN0aW9uKHRoaXMuYWN0aXZlTWVtYmVyLmFjdG9yLmF0dGFja1NraWxsKTsKICAgICAgICBjYXNlIDE6CiAgICAgICAgICB0aGlzLmFjdGlvbldpbmRvdy5hY3RpdmUgPSBmYWxzZTsKICAgICAgICAgIHRoaXMuc2tpbGxzV2luZG93c2V0Lm1lbWJlciA9IHRoaXMuYWN0aXZlTWVtYmVyLmFjdG9yOwogICAgICAgICAgdGhpcy5za2lsbHNXaW5kb3dzZXQucmVidWlsZCgpOwogICAgICAgICAgdGhpcy5za2lsbHNXaW5kb3dzZXQuc2hvdyh0cnVlKTsKICAgICAgICAgIHJldHVybiB0aGlzLnNraWxsc1dpbmRvd3NldC5hY3RpdmUgPSB0cnVlOwogICAgICAgIGNhc2UgMjoKICAgICAgICAgIHRoaXMuYWN0aW9uV2luZG93LmFjdGl2ZSA9IGZhbHNlOwogICAgICAgICAgcmV0dXJuIHRoaXMub25Ta2lsbFNlbGVjdGlvbihSZWNvcmRNYW5hZ2VyLnNraWxsc1sxXSk7CiAgICAgICAgY2FzZSAzOgogICAgICAgICAgdGhpcy5hY3Rpb25XaW5kb3cuYWN0aXZlID0gZmFsc2U7CiAgICAgICAgICB0aGlzLml0ZW1zV2luZG93c2V0LnNob3codHJ1ZSk7CiAgICAgICAgICByZXR1cm4gdGhpcy5pdGVtc1dpbmRvd3NldC5hY3RpdmUgPSB0cnVlOwogICAgICAgIGNhc2UgNDoKICAgICAgICAgIHRoaXMuYWN0aW9uV2luZG93LmFjdGl2ZSA9IGZhbHNlOwogICAgICAgICAgcmV0dXJuIHRoaXMuZXNjYXBlKCk7CiAgICAgIH0KICAgIH07CgogICAgU2NlbmVfQmF0dGxlLnByb3RvdHlwZS5vbkFjdGlvbkNhbmNlbCA9IGZ1bmN0aW9uKCkgewogICAgICBpZiAodGhpcy5hY3RpdmVNZW1iZXJJbmRleCA+IDApIHsKICAgICAgICB0aGlzLmFjdGl2ZU1lbWJlckluZGV4LS07CiAgICAgICAgdGhpcy5zZWxlY3RWYWxpZE1lbWJlcih0cnVlKTsKICAgICAgICB0aGlzLmFjdGlvbkxpc3Quc3BsaWNlKHRoaXMuYWN0aW9uTGlzdC5sZW5ndGggLSAxLCAxKTsKICAgICAgICByZXR1cm4gdGhpcy5hY3RpdmVNZW1iZXIuY2FuY2VsUHJlcGFyYXRpb24oKTsKICAgICAgfQogICAgfTsKCiAgICBTY2VuZV9CYXR0bGUucHJvdG90eXBlLm9uVGFyZ2V0U2VsZWN0aW9uQ2FuY2VsID0gZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMuc2VsZWN0QmF0dGxlciA9IGZhbHNlOwogICAgICB0aGlzLmFjdGlvbldpbmRvdy5hY3RpdmUgPSB0cnVlOwogICAgICB0aGlzLnRhcmdldFNlbGVjdGlvbldpbmRvdy5hY3RpdmUgPSBmYWxzZTsKICAgICAgdGhpcy50YXJnZXRTZWxlY3Rpb25XaW5kb3cudmlzaWJsZSA9IGZhbHNlOwogICAgICB0aGlzLmJhdHRsZXJTcHJpdGVzW3RoaXMuc2VsZWN0ZWRCYXR0bGVyXS5jb2xvciA9IENvbG9yLlRSQU5TUEFSRU5UOwogICAgICByZXR1cm4gdGhpcy5hY3RpdmVNZW1iZXIuY2FuY2VsUHJlcGFyYXRpb24oKTsKICAgIH07CgogICAgU2NlbmVfQmF0dGxlLnByb3RvdHlwZS5vblRhcmdldFNlbGVjdGlvbkNoYW5nZSA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgc3ByaXRlLCBfaSwgX2xlbiwgX3JlZjsKICAgICAgdGhpcy5zZWxlY3RlZFRhcmdldHMgPSBbdGhpcy50YXJnZXRTZWxlY3Rpb25XaW5kb3cuc2VsZWN0ZWRDZWxsXTsKICAgICAgX3JlZiA9IHRoaXMuYmF0dGxlclNwcml0ZXM7CiAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gX3JlZi5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykgewogICAgICAgIHNwcml0ZSA9IF9yZWZbX2ldOwogICAgICAgIHNwcml0ZS5jb2xvciA9IENvbG9yLlRSQU5TUEFSRU5UOwogICAgICB9CiAgICAgIHNwcml0ZSA9IHRoaXMuc3ByaXRlRm9yTG9naWModGhpcy5zZWxlY3RlZFRhcmdldHNbMF0pOwogICAgICBpZiAoc3ByaXRlICE9IG51bGwpIHsKICAgICAgICByZXR1cm4gc3ByaXRlLmNvbG9yID0gQ29sb3JzLkJBVFRMRVJfU0VMRUNUSU9OOwogICAgICB9CiAgICB9OwoKICAgIFNjZW5lX0JhdHRsZS5wcm90b3R5cGUub25UYXJnZXRTZWxlY3Rpb24gPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGksIHNwcml0ZSwgX2ksIF9qLCBfcmVmLCBfcmVmMTsKICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRJdGVtICE9IG51bGwpIHsKICAgICAgICB0aGlzLnNlbGVjdEJhdHRsZXIgPSBmYWxzZTsKICAgICAgICBzcHJpdGUgPSB0aGlzLnNwcml0ZUZvckxvZ2ljKHRoaXMuc2VsZWN0ZWRUYXJnZXRzWzBdKTsKICAgICAgICBpZiAoc3ByaXRlICE9IG51bGwpIHsKICAgICAgICAgIHNwcml0ZS5jb2xvciA9IENvbG9yLlRSQU5TUEFSRU5UOwogICAgICAgIH0KICAgICAgICBmb3IgKGkgPSBfaSA9IDAsIF9yZWYgPSB0aGlzLnNlbGVjdGVkSXRlbS5pdGVtLnJlcGVhdHM7IDAgPD0gX3JlZiA/IF9pIDwgX3JlZiA6IF9pID4gX3JlZjsgaSA9IDAgPD0gX3JlZiA/ICsrX2kgOiAtLV9pKSB7CiAgICAgICAgICB0aGlzLmFjdGlvbkxpc3QucHVzaCh7CiAgICAgICAgICAgIHR5cGU6IDEsCiAgICAgICAgICAgIG5vTWVzc2FnZTogaSA+IDAsCiAgICAgICAgICAgIGl0ZW06IHRoaXMuc2VsZWN0ZWRJdGVtLAogICAgICAgICAgICBiYXR0bGVyOiB0aGlzLmFjdGl2ZU1lbWJlciwKICAgICAgICAgICAgc291cmNlOiB0aGlzLmVuZW1pZXMubGVuZ3RoICsgdGhpcy5hY3RpdmVNZW1iZXJJbmRleCwKICAgICAgICAgICAgdGFyZ2V0czogdGhpcy5zZWxlY3RlZFRhcmdldHMKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgICB0aGlzLnNlbGVjdGVkSXRlbS5jb3VudC0tOwogICAgICAgIHRoaXMuc2VsZWN0ZWRJdGVtID0gbnVsbDsKICAgICAgICB0aGlzLmVuZFR1cm4oKTsKICAgICAgfSBlbHNlIGlmICh0aGlzLnNlbGVjdGVkU2tpbGwgIT0gbnVsbCkgewogICAgICAgIHRoaXMuc2VsZWN0QmF0dGxlciA9IGZhbHNlOwogICAgICAgIHNwcml0ZSA9IHRoaXMuc3ByaXRlRm9yTG9naWModGhpcy5zZWxlY3RlZFRhcmdldHNbMF0pOwogICAgICAgIGlmIChzcHJpdGUgIT0gbnVsbCkgewogICAgICAgICAgc3ByaXRlLmNvbG9yID0gQ29sb3IuVFJBTlNQQVJFTlQ7CiAgICAgICAgfQogICAgICAgIGZvciAoaSA9IF9qID0gMCwgX3JlZjEgPSB0aGlzLnNlbGVjdGVkU2tpbGwucmVwZWF0czsgMCA8PSBfcmVmMSA/IF9qIDwgX3JlZjEgOiBfaiA+IF9yZWYxOyBpID0gMCA8PSBfcmVmMSA/ICsrX2ogOiAtLV9qKSB7CiAgICAgICAgICB0aGlzLmFjdGlvbkxpc3QucHVzaCh7CiAgICAgICAgICAgIHR5cGU6IDIsCiAgICAgICAgICAgIG5vTWVzc2FnZTogaSA+IDAsCiAgICAgICAgICAgIHNraWxsOiB0aGlzLnNlbGVjdGVkU2tpbGwsCiAgICAgICAgICAgIGJhdHRsZXI6IHRoaXMuYWN0aXZlTWVtYmVyLAogICAgICAgICAgICBzb3VyY2U6IHRoaXMuZW5lbWllcy5sZW5ndGggKyB0aGlzLmFjdGl2ZU1lbWJlckluZGV4LAogICAgICAgICAgICB0YXJnZXRzOiB0aGlzLnNlbGVjdGVkVGFyZ2V0cwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICAgIHRoaXMuYWN0aXZlTWVtYmVyLnByZXBhcmVTa2lsbCh0aGlzLnNlbGVjdGVkU2tpbGwpOwogICAgICAgIHRoaXMuc2VsZWN0ZWRTa2lsbCA9IG51bGw7CiAgICAgICAgdGhpcy5lbmRUdXJuKCk7CiAgICAgIH0KICAgICAgdGhpcy5hY3RpdmVNZW1iZXIubGFzdFRhcmdldCA9IHRoaXMuc2VsZWN0ZWRUYXJnZXRzWzBdOwogICAgICB0aGlzLmFjdGlvbldpbmRvdy5hY3RpdmUgPSB0cnVlOwogICAgICB0aGlzLnRhcmdldFNlbGVjdGlvbldpbmRvdy5hY3RpdmUgPSBmYWxzZTsKICAgICAgdGhpcy50YXJnZXRTZWxlY3Rpb25XaW5kb3cudmlzaWJsZSA9IGZhbHNlOwogICAgICByZXR1cm4gSW5wdXQuY2xlYXIoKTsKICAgIH07CgogICAgU2NlbmVfQmF0dGxlLnByb3RvdHlwZS5vbkl0ZW1TZWxlY3Rpb24gPSBmdW5jdGlvbihpdGVtKSB7CiAgICAgIElucHV0LmNsZWFyKCk7CiAgICAgIHRoaXMuaXRlbXNXaW5kb3dzZXQuc2hvdyhmYWxzZSk7CiAgICAgIHRoaXMuaXRlbXNXaW5kb3dzZXQuYWN0aXZlID0gZmFsc2U7CiAgICAgIHRoaXMuc2VsZWN0ZWRJdGVtID0gaXRlbTsKICAgICAgcmV0dXJuIHRoaXMuc2hvd1RhcmdldFNlbGVjdGlvbigpOwogICAgfTsKCiAgICBTY2VuZV9CYXR0bGUucHJvdG90eXBlLm9uSXRlbVNlbGVjdGlvbkNhbmNlbCA9IGZ1bmN0aW9uKCkgewogICAgICB0aGlzLmFjdGlvbldpbmRvdy5hY3RpdmUgPSB0cnVlOwogICAgICByZXR1cm4gdGhpcy5pdGVtc1dpbmRvd3NldC5zaG93KGZhbHNlKTsKICAgIH07CgogICAgU2NlbmVfQmF0dGxlLnByb3RvdHlwZS5vblNraWxsU2VsZWN0aW9uID0gZnVuY3Rpb24oc2tpbGwpIHsKICAgICAgSW5wdXQuY2xlYXIoKTsKICAgICAgdGhpcy5za2lsbHNXaW5kb3dzZXQuc2hvdyhmYWxzZSk7CiAgICAgIHRoaXMuc2VsZWN0ZWRTa2lsbCA9IHNraWxsOwogICAgICByZXR1cm4gdGhpcy5zaG93VGFyZ2V0U2VsZWN0aW9uKCk7CiAgICB9OwoKICAgIFNjZW5lX0JhdHRsZS5wcm90b3R5cGUub25Ta2lsbFNlbGVjdGlvbkNhbmNlbCA9IGZ1bmN0aW9uKCkgewogICAgICB0aGlzLmFjdGlvbldpbmRvdy5hY3RpdmUgPSB0cnVlOwogICAgICByZXR1cm4gdGhpcy5za2lsbHNXaW5kb3dzZXQuc2hvdyhmYWxzZSk7CiAgICB9OwoKICAgIFNjZW5lX0JhdHRsZS5wcm90b3R5cGUub25JbnRlcnByZXRlckZpbmlzaCA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gdGhpcy5jaGVja0JhdHRsZUV2ZW50Q29uZGl0aW9ucygpOwogICAgfTsKCiAgICBTY2VuZV9CYXR0bGUucHJvdG90eXBlLnNob3dUYXJnZXRTZWxlY3Rpb24gPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGRlYWRNZW1iZXJzLCBpdGVtLCBtZW1iZXIsIHNraXAsIF9pLCBfaiwgX2xlbiwgX2xlbjEsIF9yZWYsIF9yZWYxOwogICAgICBpdGVtID0gbnVsbDsKICAgICAgc2tpcCA9IGZhbHNlOwogICAgICB0aGlzLnRhcmdldE9mZnNldCA9IDA7CiAgICAgIGlmICh0aGlzLnNlbGVjdGVkSXRlbSAhPSBudWxsKSB7CiAgICAgICAgaXRlbSA9IHRoaXMuc2VsZWN0ZWRJdGVtOwogICAgICB9CiAgICAgIGlmICh0aGlzLnNlbGVjdGVkU2tpbGwgIT0gbnVsbCkgewogICAgICAgIGl0ZW0gPSB0aGlzLnNlbGVjdGVkU2tpbGw7CiAgICAgICAgdGhpcy5hY3RpdmVNZW1iZXIucHJlcGFyZVNraWxsKHRoaXMuc2VsZWN0ZWRTa2lsbCk7CiAgICAgIH0KICAgICAgaWYgKGl0ZW0gIT0gbnVsbCkgewogICAgICAgIHN3aXRjaCAoKGl0ZW0uaXRlbSAhPSBudWxsID8gaXRlbS5pdGVtLnNjb3BlIDogaXRlbS5zY29wZSkpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgdGhpcy50YXJnZXRTZWxlY3Rpb25XaW5kb3cuYmF0dGxlcnMgPSB0aGlzLmJhdHRsZXJzOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgdGhpcy50YXJnZXRTZWxlY3Rpb25XaW5kb3cuYmF0dGxlcnMgPSB0aGlzLmFsaXZlRW5lbWllczsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRUYXJnZXRzID0gdGhpcy5hbGl2ZUVuZW1pZXM7CiAgICAgICAgICAgIHNraXAgPSB0cnVlOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgdGhpcy50YXJnZXRTZWxlY3Rpb25XaW5kb3cuYmF0dGxlcnMgPSB0aGlzLm1lbWJlcnM7CiAgICAgICAgICAgIHRoaXMudGFyZ2V0T2Zmc2V0ID0gdGhpcy5lbmVtaWVzLmxlbmd0aDsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRUYXJnZXRzID0gdGhpcy5tZW1iZXJzOwogICAgICAgICAgICB0aGlzLnRhcmdldE9mZnNldCA9IHRoaXMuZW5lbWllcy5sZW5ndGg7CiAgICAgICAgICAgIHNraXAgPSB0cnVlOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgZGVhZE1lbWJlcnMgPSBbXTsKICAgICAgICAgICAgX3JlZiA9IHRoaXMubWVtYmVyczsKICAgICAgICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBfcmVmLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7CiAgICAgICAgICAgICAgbWVtYmVyID0gX3JlZltfaV07CiAgICAgICAgICAgICAgaWYgKCFtZW1iZXIuYWN0b3IuaXNBbGl2ZSkgewogICAgICAgICAgICAgICAgZGVhZE1lbWJlcnMucHVzaChtZW1iZXIpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLnRhcmdldFNlbGVjdGlvbldpbmRvdy5iYXR0bGVycyA9IGRlYWRNZW1iZXJzOwogICAgICAgICAgICB0aGlzLnRhcmdldE9mZnNldCA9IHRoaXMuZW5lbWllcy5sZW5ndGg7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgZGVhZE1lbWJlcnMgPSBbXTsKICAgICAgICAgICAgX3JlZjEgPSB0aGlzLm1lbWJlcnM7CiAgICAgICAgICAgIGZvciAoX2ogPSAwLCBfbGVuMSA9IF9yZWYxLmxlbmd0aDsgX2ogPCBfbGVuMTsgX2orKykgewogICAgICAgICAgICAgIG1lbWJlciA9IF9yZWYxW19qXTsKICAgICAgICAgICAgICBpZiAoIW1lbWJlci5hY3Rvci5pc0FsaXZlKSB7CiAgICAgICAgICAgICAgICBkZWFkTWVtYmVycy5wdXNoKG1lbWJlcik7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRUYXJnZXRzID0gZGVhZE1lbWJlcnM7CiAgICAgICAgICAgIHRoaXMudGFyZ2V0T2Zmc2V0ID0gdGhpcy5lbmVtaWVzLmxlbmd0aDsKICAgICAgICAgICAgc2tpcCA9IHRydWU7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFRhcmdldHMgPSBbdGhpcy5hY3RpdmVNZW1iZXJdOwogICAgICAgICAgICBza2lwID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy50YXJnZXRTZWxlY3Rpb25XaW5kb3cuYmF0dGxlcnMgPSB0aGlzLmJhdHRsZXJzOwogICAgICB9CiAgICAgIGlmIChza2lwKSB7CiAgICAgICAgcmV0dXJuIHRoaXMub25UYXJnZXRTZWxlY3Rpb24oKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmFjdGlvbldpbmRvdy5hY3RpdmUgPSBmYWxzZTsKICAgICAgICB0aGlzLnRhcmdldFNlbGVjdGlvbldpbmRvdy5hY3RpdmUgPSB0cnVlOwogICAgICAgIHRoaXMudGFyZ2V0U2VsZWN0aW9uV2luZG93LnZpc2libGUgPSB0cnVlOwogICAgICAgIHRoaXMudGFyZ2V0U2VsZWN0aW9uV2luZG93LnJlZHJhdygpOwogICAgICAgIHRoaXMuc2VsZWN0ZWRUYXJnZXRzID0gW3RoaXMudGFyZ2V0U2VsZWN0aW9uV2luZG93LnNlbGVjdGVkQ2VsbF07CiAgICAgICAgdGhpcy5zZWxlY3RCYXR0bGVyID0gdHJ1ZTsKICAgICAgICB0aGlzLnNlbGVjdGVkQmF0dGxlciA9IDA7CiAgICAgICAgcmV0dXJuIHRoaXMub25UYXJnZXRTZWxlY3Rpb25DaGFuZ2UoKTsKICAgICAgfQogICAgfTsKCiAgICByZXR1cm4gU2NlbmVfQmF0dGxlOwoKICB9KShTY2VuZSk7CgogIHdpbmRvdy5TY2VuZV9CYXR0bGUgPSBTY2VuZV9CYXR0bGU7Cgp9KS5jYWxsKHRoaXMpOwo="},{"name":"Scene_BattleTest","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogU2NlbmVfQmF0dGxlVGVzdAojIAlDcmVhdGVkIG9uOiAyMDEzLTA1LTE5CiMKIyAJQ29weXJpZ2h0IChDKSAyMDEzIEFuZHLpIFJhZG9tc2tpLiBBbGwgcmlnaHRzIHJlc2VydmVkLgojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQojCiMgCUNsYXNzOiBTY2VuZV9CYXR0bGVUZXN0CiMKIyAgIERlc2NyaXB0aW9uLi4uCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpjbGFzcyBTY2VuZV9CYXR0bGVUZXN0IGV4dGVuZHMgU2NlbmUKICAgIGNvbnN0cnVjdG9yOiAtPgogICAgICAgIHN1cGVyKCkKICAgIAogICAgaW5pdGlhbGl6ZTogLT4KICAgICAgICBMYW5ndWFnZU1hbmFnZXIubG9hZCgpCiAgICAKICAgIGRpc3Bvc2U6IC0+CgogICAgcHJlcGFyZURhdGE6IC0+CiAgICAgICAgQG1lbnVTZWxlY3RTb3VuZCA9IFJlY29yZE1hbmFnZXIuc3lzdGVtLm1lbnVTZWxlY3RTb3VuZAogICAgICAgIEBtZW51Q3Vyc29yU291bmQgPSBSZWNvcmRNYW5hZ2VyLnN5c3RlbS5tZW51Q3Vyc29yU291bmQKICAgICAgICAKICAgICAgICBBdWRpb01hbmFnZXIubG9hZFNvdW5kKEBtZW51U2VsZWN0U291bmQpCiAgICAgICAgQXVkaW9NYW5hZ2VyLmxvYWRTb3VuZChAbWVudUN1cnNvclNvdW5kKQogICAgICAgIAogICAgICAgIGlmIG5vdCBMYW5ndWFnZU1hbmFnZXIucHJvZmlsZS5idW5kbGVzPwogICAgICAgICAgICBHYW1lTWFuYWdlci5pbml0aWFsaXplKCkKICAgICAgICAgICAgTGFuZ3VhZ2VNYW5hZ2VyLmxvYWRCdW5kbGVzKCkKICAgICAgICBlbHNlCiAgICAgICAgICAgIExhbmd1YWdlTWFuYWdlci5wcmVwYXJlKCkKICAgIHByZXBhcmVWaXN1YWw6IC0+CiAgICAgICAgbWVtYmVycyA9ICRQQVJBTVMuYmF0dGxlVGVzdC5tZW1iZXJzCiAgICAgICAgR2FtZU1hbmFnZXIudHJvb3AgPSAkUEFSQU1TCiAgICAgICAgZmlyc3RBY3RvciA9ICRQQVJBTVMuYmF0dGxlVGVzdC5tZW1iZXJzWzBdLmFjdG9yCiAgICAgICAgR2FtZU1hbmFnZXIucGFydHkubWVtYmVycyA9IAogICAgICAgIFsKICAgICAgICBdCiAgICAgICAgCiAgICAgICAgaWYgbWVtYmVyc1swXS5hY3Rvcj8gYW5kIFJlY29yZE1hbmFnZXIuYWN0b3JzW21lbWJlcnNbMF0uYWN0b3JdPwogICAgICAgICAgICBHYW1lTWFuYWdlci5wYXJ0eS5hZGQoUmVjb3JkTWFuYWdlci5hY3RvcnNbbWVtYmVyc1swXS5hY3Rvcl0pCiAgICAgICAgaWYgbWVtYmVyc1sxXS5hY3Rvcj8gYW5kIFJlY29yZE1hbmFnZXIuYWN0b3JzW21lbWJlcnNbMV0uYWN0b3JdPwogICAgICAgICAgICBHYW1lTWFuYWdlci5wYXJ0eS5hZGQoUmVjb3JkTWFuYWdlci5hY3RvcnNbbWVtYmVyc1sxXS5hY3Rvcl0pCiAgICAgICAgaWYgbWVtYmVyc1syXS5hY3Rvcj8gYW5kIFJlY29yZE1hbmFnZXIuYWN0b3JzW21lbWJlcnNbMl0uYWN0b3JdPwogICAgICAgICAgICBHYW1lTWFuYWdlci5wYXJ0eS5hZGQoUmVjb3JkTWFuYWdlci5hY3RvcnNbbWVtYmVyc1syXS5hY3Rvcl0pCiAgICAgICAgaWYgbWVtYmVyc1szXS5hY3Rvcj8gYW5kIFJlY29yZE1hbmFnZXIuYWN0b3JzW21lbWJlcnNbM10uYWN0b3JdPwogICAgICAgICAgICBHYW1lTWFuYWdlci5wYXJ0eS5hZGQoUmVjb3JkTWFuYWdlci5hY3RvcnNbbWVtYmVyc1szXS5hY3Rvcl0pCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgc2NlbmUgPSBpZiBHYW1lTWFuYWdlci5wYXJ0eS5tZW1iZXJzLmxlbmd0aCA9PSAwIHRoZW4gbmV3IFNjZW5lX0dhbWVPdmVyKCkgZWxzZSBuZXcgU2NlbmVfQmF0dGxlKCkKICAgICAgICBzY2VuZS5ub0VzY2FwZSA9IHllcwogICAgICAgIFNjZW5lTWFuYWdlci5zd2l0Y2hUbyhzY2VuZSkKCiAgICAgICAgCiAgICB1cGRhdGU6IC0+ICAgICAgICAgICAgCiAgICAgICAgc3VwZXIoKQogICAgICAgIAogCiAgICAgICAgCiAgICAgICAgCiAgICAKICAKCndpbmRvdy5TY2VuZV9CYXR0bGVUZXN0ID0gU2NlbmVfQmF0dGxlVGVzdA==","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBTY2VuZV9CYXR0bGVUZXN0LAogICAgX19oYXNQcm9wID0ge30uaGFzT3duUHJvcGVydHksCiAgICBfX2V4dGVuZHMgPSBmdW5jdGlvbihjaGlsZCwgcGFyZW50KSB7IGZvciAodmFyIGtleSBpbiBwYXJlbnQpIHsgaWYgKF9faGFzUHJvcC5jYWxsKHBhcmVudCwga2V5KSkgY2hpbGRba2V5XSA9IHBhcmVudFtrZXldOyB9IGZ1bmN0aW9uIGN0b3IoKSB7IHRoaXMuY29uc3RydWN0b3IgPSBjaGlsZDsgfSBjdG9yLnByb3RvdHlwZSA9IHBhcmVudC5wcm90b3R5cGU7IGNoaWxkLnByb3RvdHlwZSA9IG5ldyBjdG9yKCk7IGNoaWxkLl9fc3VwZXJfXyA9IHBhcmVudC5wcm90b3R5cGU7IHJldHVybiBjaGlsZDsgfTsKCiAgU2NlbmVfQmF0dGxlVGVzdCA9IChmdW5jdGlvbihfc3VwZXIpIHsKICAgIF9fZXh0ZW5kcyhTY2VuZV9CYXR0bGVUZXN0LCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFNjZW5lX0JhdHRsZVRlc3QoKSB7CiAgICAgIFNjZW5lX0JhdHRsZVRlc3QuX19zdXBlcl9fLmNvbnN0cnVjdG9yLmNhbGwodGhpcyk7CiAgICB9CgogICAgU2NlbmVfQmF0dGxlVGVzdC5wcm90b3R5cGUuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gTGFuZ3VhZ2VNYW5hZ2VyLmxvYWQoKTsKICAgIH07CgogICAgU2NlbmVfQmF0dGxlVGVzdC5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uKCkge307CgogICAgU2NlbmVfQmF0dGxlVGVzdC5wcm90b3R5cGUucHJlcGFyZURhdGEgPSBmdW5jdGlvbigpIHsKICAgICAgdGhpcy5tZW51U2VsZWN0U291bmQgPSBSZWNvcmRNYW5hZ2VyLnN5c3RlbS5tZW51U2VsZWN0U291bmQ7CiAgICAgIHRoaXMubWVudUN1cnNvclNvdW5kID0gUmVjb3JkTWFuYWdlci5zeXN0ZW0ubWVudUN1cnNvclNvdW5kOwogICAgICBBdWRpb01hbmFnZXIubG9hZFNvdW5kKHRoaXMubWVudVNlbGVjdFNvdW5kKTsKICAgICAgQXVkaW9NYW5hZ2VyLmxvYWRTb3VuZCh0aGlzLm1lbnVDdXJzb3JTb3VuZCk7CiAgICAgIGlmIChMYW5ndWFnZU1hbmFnZXIucHJvZmlsZS5idW5kbGVzID09IG51bGwpIHsKICAgICAgICBHYW1lTWFuYWdlci5pbml0aWFsaXplKCk7CiAgICAgICAgcmV0dXJuIExhbmd1YWdlTWFuYWdlci5sb2FkQnVuZGxlcygpOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBMYW5ndWFnZU1hbmFnZXIucHJlcGFyZSgpOwogICAgICB9CiAgICB9OwoKICAgIFNjZW5lX0JhdHRsZVRlc3QucHJvdG90eXBlLnByZXBhcmVWaXN1YWwgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGZpcnN0QWN0b3IsIG1lbWJlcnMsIHNjZW5lOwogICAgICBtZW1iZXJzID0gJFBBUkFNUy5iYXR0bGVUZXN0Lm1lbWJlcnM7CiAgICAgIEdhbWVNYW5hZ2VyLnRyb29wID0gJFBBUkFNUzsKICAgICAgZmlyc3RBY3RvciA9ICRQQVJBTVMuYmF0dGxlVGVzdC5tZW1iZXJzWzBdLmFjdG9yOwogICAgICBHYW1lTWFuYWdlci5wYXJ0eS5tZW1iZXJzID0gW107CiAgICAgIGlmICgobWVtYmVyc1swXS5hY3RvciAhPSBudWxsKSAmJiAoUmVjb3JkTWFuYWdlci5hY3RvcnNbbWVtYmVyc1swXS5hY3Rvcl0gIT0gbnVsbCkpIHsKICAgICAgICBHYW1lTWFuYWdlci5wYXJ0eS5hZGQoUmVjb3JkTWFuYWdlci5hY3RvcnNbbWVtYmVyc1swXS5hY3Rvcl0pOwogICAgICB9CiAgICAgIGlmICgobWVtYmVyc1sxXS5hY3RvciAhPSBudWxsKSAmJiAoUmVjb3JkTWFuYWdlci5hY3RvcnNbbWVtYmVyc1sxXS5hY3Rvcl0gIT0gbnVsbCkpIHsKICAgICAgICBHYW1lTWFuYWdlci5wYXJ0eS5hZGQoUmVjb3JkTWFuYWdlci5hY3RvcnNbbWVtYmVyc1sxXS5hY3Rvcl0pOwogICAgICB9CiAgICAgIGlmICgobWVtYmVyc1syXS5hY3RvciAhPSBudWxsKSAmJiAoUmVjb3JkTWFuYWdlci5hY3RvcnNbbWVtYmVyc1syXS5hY3Rvcl0gIT0gbnVsbCkpIHsKICAgICAgICBHYW1lTWFuYWdlci5wYXJ0eS5hZGQoUmVjb3JkTWFuYWdlci5hY3RvcnNbbWVtYmVyc1syXS5hY3Rvcl0pOwogICAgICB9CiAgICAgIGlmICgobWVtYmVyc1szXS5hY3RvciAhPSBudWxsKSAmJiAoUmVjb3JkTWFuYWdlci5hY3RvcnNbbWVtYmVyc1szXS5hY3Rvcl0gIT0gbnVsbCkpIHsKICAgICAgICBHYW1lTWFuYWdlci5wYXJ0eS5hZGQoUmVjb3JkTWFuYWdlci5hY3RvcnNbbWVtYmVyc1szXS5hY3Rvcl0pOwogICAgICB9CiAgICAgIHNjZW5lID0gR2FtZU1hbmFnZXIucGFydHkubWVtYmVycy5sZW5ndGggPT09IDAgPyBuZXcgU2NlbmVfR2FtZU92ZXIoKSA6IG5ldyBTY2VuZV9CYXR0bGUoKTsKICAgICAgc2NlbmUubm9Fc2NhcGUgPSB0cnVlOwogICAgICByZXR1cm4gU2NlbmVNYW5hZ2VyLnN3aXRjaFRvKHNjZW5lKTsKICAgIH07CgogICAgU2NlbmVfQmF0dGxlVGVzdC5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiBTY2VuZV9CYXR0bGVUZXN0Ll9fc3VwZXJfXy51cGRhdGUuY2FsbCh0aGlzKTsKICAgIH07CgogICAgcmV0dXJuIFNjZW5lX0JhdHRsZVRlc3Q7CgogIH0pKFNjZW5lKTsKCiAgd2luZG93LlNjZW5lX0JhdHRsZVRlc3QgPSBTY2VuZV9CYXR0bGVUZXN0OwoKfSkuY2FsbCh0aGlzKTsK"},{"name":"Scene_BattleWon","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogU2NlbmVfQmF0dGxlV29uCiMgICBDcmVhdGVkIG9uOiAyMDEzLTA5LTI5CiMKIyAJQ29weXJpZ2h0IChDKSAyMDEzIEFuZHLpIFJhZG9tc2tpLiBBbGwgcmlnaHRzIHJlc2VydmVkLgojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQojCiMgCUNsYXNzOiBTY2VuZV9CYXR0bGVXb24KIwojICAgRGVzY3JpcHRpb24uLi4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCmNsYXNzIFNjZW5lX0JhdHRsZVdvbiBleHRlbmRzIFNjZW5lCiAgICBjb25zdHJ1Y3RvcjogLT4KICAgICAgICBzdXBlcigpCiAgICAKICAgIGluaXRpYWxpemU6IC0+CiAgICAgICAgCiAgICBkaXNwb3NlOiAtPgoKICAgIHByZXBhcmVEYXRhOiAtPgogCiAgICAgICAgCiAgICBwcmVwYXJlVmlzdWFsOiAtPgoKICAgIHVwZGF0ZTogLT4KICAgICAgICBTY2VuZU1hbmFnZXIuc3dpdGNoVG8obmV3IFNjZW5lX01hcCgpKQogICAgICAgIAogICAgICAgIHN1cGVyKCkKICAgICAgICAKICAgIAogIAoKd2luZG93LlNjZW5lX0JhdHRsZVdvbiA9IFNjZW5lX0JhdHRsZVdvbg==","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBTY2VuZV9CYXR0bGVXb24sCiAgICBfX2hhc1Byb3AgPSB7fS5oYXNPd25Qcm9wZXJ0eSwKICAgIF9fZXh0ZW5kcyA9IGZ1bmN0aW9uKGNoaWxkLCBwYXJlbnQpIHsgZm9yICh2YXIga2V5IGluIHBhcmVudCkgeyBpZiAoX19oYXNQcm9wLmNhbGwocGFyZW50LCBrZXkpKSBjaGlsZFtrZXldID0gcGFyZW50W2tleV07IH0gZnVuY3Rpb24gY3RvcigpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGNoaWxkOyB9IGN0b3IucHJvdG90eXBlID0gcGFyZW50LnByb3RvdHlwZTsgY2hpbGQucHJvdG90eXBlID0gbmV3IGN0b3IoKTsgY2hpbGQuX19zdXBlcl9fID0gcGFyZW50LnByb3RvdHlwZTsgcmV0dXJuIGNoaWxkOyB9OwoKICBTY2VuZV9CYXR0bGVXb24gPSAoZnVuY3Rpb24oX3N1cGVyKSB7CiAgICBfX2V4dGVuZHMoU2NlbmVfQmF0dGxlV29uLCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFNjZW5lX0JhdHRsZVdvbigpIHsKICAgICAgU2NlbmVfQmF0dGxlV29uLl9fc3VwZXJfXy5jb25zdHJ1Y3Rvci5jYWxsKHRoaXMpOwogICAgfQoKICAgIFNjZW5lX0JhdHRsZVdvbi5wcm90b3R5cGUuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uKCkge307CgogICAgU2NlbmVfQmF0dGxlV29uLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24oKSB7fTsKCiAgICBTY2VuZV9CYXR0bGVXb24ucHJvdG90eXBlLnByZXBhcmVEYXRhID0gZnVuY3Rpb24oKSB7fTsKCiAgICBTY2VuZV9CYXR0bGVXb24ucHJvdG90eXBlLnByZXBhcmVWaXN1YWwgPSBmdW5jdGlvbigpIHt9OwoKICAgIFNjZW5lX0JhdHRsZVdvbi5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKSB7CiAgICAgIFNjZW5lTWFuYWdlci5zd2l0Y2hUbyhuZXcgU2NlbmVfTWFwKCkpOwogICAgICByZXR1cm4gU2NlbmVfQmF0dGxlV29uLl9fc3VwZXJfXy51cGRhdGUuY2FsbCh0aGlzKTsKICAgIH07CgogICAgcmV0dXJuIFNjZW5lX0JhdHRsZVdvbjsKCiAgfSkoU2NlbmUpOwoKICB3aW5kb3cuU2NlbmVfQmF0dGxlV29uID0gU2NlbmVfQmF0dGxlV29uOwoKfSkuY2FsbCh0aGlzKTsK"},{"name":"Scene_GameOver","content":"# ===================================================================\n#\n#   Script: Scene_EndGame\n#   \n#   Copyright (C) 2014 AndrÃ© Radomski. All rights reserved.\n#\n# ===================================================================\n#\n# \tClass: Scene_GameOver\n#\n#   Description...\n#\n# ===================================================================\n\nclass Scene_GameOver extends Scene\n    constructor: () ->\n        super()\n\n    initialize: ->\n        @bitmap = ResourceManager.getBitmap(\"Graphics/Pictures/#{RecordManager.system.gameOverGraphic.name}\")\n        @music = RecordManager.system.gameOverMusic\n        \n        AudioManager.loadMusic(@music)\n    dispose: ->\n        @sprite.dispose()\n\n    prepareData: ->\n\n    prepareVisual: ->\n        @sprite = new Sprite()\n        @sprite.bitmap = @bitmap\n        @sprite.srcRect = new Rect(0, 0, Graphics.width, Graphics.height)\n        \n        AudioManager.playMusic(@music)\n    update: ->      \n        if Input.trigger(Input.C) and not $PARAMS.battleTest?\n            SceneManager.switchTo(new Scene_Title())\n        \n        super()\n        \n        \n    \n  \n\nwindow.Scene_GameOver = Scene_GameOver","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBTY2VuZV9HYW1lT3ZlciwKICAgIF9faGFzUHJvcCA9IHt9Lmhhc093blByb3BlcnR5LAogICAgX19leHRlbmRzID0gZnVuY3Rpb24oY2hpbGQsIHBhcmVudCkgeyBmb3IgKHZhciBrZXkgaW4gcGFyZW50KSB7IGlmIChfX2hhc1Byb3AuY2FsbChwYXJlbnQsIGtleSkpIGNoaWxkW2tleV0gPSBwYXJlbnRba2V5XTsgfSBmdW5jdGlvbiBjdG9yKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gY2hpbGQ7IH0gY3Rvci5wcm90b3R5cGUgPSBwYXJlbnQucHJvdG90eXBlOyBjaGlsZC5wcm90b3R5cGUgPSBuZXcgY3RvcigpOyBjaGlsZC5fX3N1cGVyX18gPSBwYXJlbnQucHJvdG90eXBlOyByZXR1cm4gY2hpbGQ7IH07CgogIFNjZW5lX0dhbWVPdmVyID0gKGZ1bmN0aW9uKF9zdXBlcikgewogICAgX19leHRlbmRzKFNjZW5lX0dhbWVPdmVyLCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFNjZW5lX0dhbWVPdmVyKCkgewogICAgICBTY2VuZV9HYW1lT3Zlci5fX3N1cGVyX18uY29uc3RydWN0b3IuY2FsbCh0aGlzKTsKICAgIH0KCiAgICBTY2VuZV9HYW1lT3Zlci5wcm90b3R5cGUuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uKCkgewogICAgICB0aGlzLmJpdG1hcCA9IFJlc291cmNlTWFuYWdlci5nZXRCaXRtYXAoIkdyYXBoaWNzL1BpY3R1cmVzLyIgKyBSZWNvcmRNYW5hZ2VyLnN5c3RlbS5nYW1lT3ZlckdyYXBoaWMubmFtZSk7CiAgICAgIHRoaXMubXVzaWMgPSBSZWNvcmRNYW5hZ2VyLnN5c3RlbS5nYW1lT3Zlck11c2ljOwogICAgICByZXR1cm4gQXVkaW9NYW5hZ2VyLmxvYWRNdXNpYyh0aGlzLm11c2ljKTsKICAgIH07CgogICAgU2NlbmVfR2FtZU92ZXIucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIHRoaXMuc3ByaXRlLmRpc3Bvc2UoKTsKICAgIH07CgogICAgU2NlbmVfR2FtZU92ZXIucHJvdG90eXBlLnByZXBhcmVEYXRhID0gZnVuY3Rpb24oKSB7fTsKCiAgICBTY2VuZV9HYW1lT3Zlci5wcm90b3R5cGUucHJlcGFyZVZpc3VhbCA9IGZ1bmN0aW9uKCkgewogICAgICB0aGlzLnNwcml0ZSA9IG5ldyBTcHJpdGUoKTsKICAgICAgdGhpcy5zcHJpdGUuYml0bWFwID0gdGhpcy5iaXRtYXA7CiAgICAgIHRoaXMuc3ByaXRlLnNyY1JlY3QgPSBuZXcgUmVjdCgwLCAwLCBHcmFwaGljcy53aWR0aCwgR3JhcGhpY3MuaGVpZ2h0KTsKICAgICAgcmV0dXJuIEF1ZGlvTWFuYWdlci5wbGF5TXVzaWModGhpcy5tdXNpYyk7CiAgICB9OwoKICAgIFNjZW5lX0dhbWVPdmVyLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpIHsKICAgICAgaWYgKElucHV0LnRyaWdnZXIoSW5wdXQuQykgJiYgKCRQQVJBTVMuYmF0dGxlVGVzdCA9PSBudWxsKSkgewogICAgICAgIFNjZW5lTWFuYWdlci5zd2l0Y2hUbyhuZXcgU2NlbmVfVGl0bGUoKSk7CiAgICAgIH0KICAgICAgcmV0dXJuIFNjZW5lX0dhbWVPdmVyLl9fc3VwZXJfXy51cGRhdGUuY2FsbCh0aGlzKTsKICAgIH07CgogICAgcmV0dXJuIFNjZW5lX0dhbWVPdmVyOwoKICB9KShTY2VuZSk7CgogIHdpbmRvdy5TY2VuZV9HYW1lT3ZlciA9IFNjZW5lX0dhbWVPdmVyOwoKfSkuY2FsbCh0aGlzKTsK","decoded":true},{"name":"Scene_Map","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogU2NlbmVfTWFwCiMgICBDcmVhdGVkIG9uOiAyMDEzLTA1LTE5CiMKIyAJQ29weXJpZ2h0IChDKSAyMDEzIEFuZHLpIFJhZG9tc2tpLiBBbGwgcmlnaHRzIHJlc2VydmVkLgojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQojCiMgCUNsYXNzOiBTY2VuZV9NYXAKIwojICAgRGVzY3JpcHRpb24uLi4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCmNsYXNzIFNjZW5lX01hcCBleHRlbmRzIFNjZW5lCiAgICBjb25zdHJ1Y3RvcjogLT4KICAgICAgICBzdXBlcigpCiAgICAgICAgQG5lZWRNYXBQcmVwYXJlID0gbm8KICAgIGluaXRpYWxpemU6IC0+CiAgICAgICAgR2FtZU1hbmFnZXIuaW50ZXJwcmV0ZXIuc3RvcCgpCiAgICAgICAgaWYgbm90IEdhbWVNYW5hZ2VyLm1hcD8gb3IgR2FtZU1hbmFnZXIubWFwLmlkICE9IEdhbWVNYW5hZ2VyLmN1cnJlbnRNYXBJZAogICAgICAgICAgICBAbWFwTG9naWMgPSBuZXcgTG9naWNfTWFwKEdhbWVNYW5hZ2VyLmN1cnJlbnRNYXBJZCkKICAgICAgICAgICAgR2FtZU1hbmFnZXIubWFwID0gQG1hcExvZ2ljCiAgICAgICAgICAgIEBuZWVkTWFwUHJlcGFyZSA9IHllcwogICAgICAgICAgICAKICAgICAgICAgICAgY29uc29sZS5sb2coIklEOiAiICsgR2FtZU1hbmFnZXIuY3VycmVudE1hcElkKQogICAgICAgIGVsc2UKICAgICAgICAgICAgQG1hcExvZ2ljID0gR2FtZU1hbmFnZXIubWFwCiAgICAgICAgICAgIAogICAgICAgIExhbmd1YWdlTWFuYWdlci5sb2FkTWFwQnVuZGxlKEdhbWVNYW5hZ2VyLmN1cnJlbnRNYXBJZCkKICAgICAgICAKICAgICAgICBmb3IgcGljdHVyZSBpbiBHYW1lTWFuYWdlci5waWN0dXJlcwogICAgICAgICAgICBpZiBwaWN0dXJlPwogICAgICAgICAgICAgICAgcGljdHVyZS52aXNpYmxlID0geWVzCiAgICAgICAgICAgICAgICAKICAgICAgICBmb3IgdGV4dCBpbiBHYW1lTWFuYWdlci50ZXh0cwogICAgICAgICAgICBpZiB0ZXh0PwogICAgICAgICAgICAgICAgdGV4dC52aXNpYmxlID0geWVzCiAgICAgICAgR2FtZU1hbmFnZXIud2VhdGhlci52aXNpYmxlKHllcykKICAgICAgICBHcmFwaGljcy5mcmVlemUoKQogIAogICAgZGlzcG9zZTogLT4KICAgICAgICBHYW1lTWFuYWdlci53ZWF0aGVyLnZpc2libGUobm8pCiAgICAgICAgQG1hcC5kaXNwb3NlKCkKICAgICAgICBAdGltZXIuZGlzcG9zZSgpCiAgICAgICAgCiAgICAgICAgZm9yIHBpY3R1cmUgaW4gR2FtZU1hbmFnZXIucGljdHVyZXMKICAgICAgICAgICAgaWYgcGljdHVyZT8gYW5kIHBpY3R1cmUudmlzaWJsZQogICAgICAgICAgICAgICAgcGljdHVyZS52aXNpYmxlID0gbm8KICAgICAgICAgICAgICAgIAogICAgICAgIGZvciB0ZXh0IGluIEdhbWVNYW5hZ2VyLnRleHRzCiAgICAgICAgICAgIGlmIHRleHQ/IGFuZCB0ZXh0LnZpc2libGUKICAgICAgICAgICAgICAgIHRleHQudmlzaWJsZSA9IG5vCiAgICAgICAgCiAgICBwcmVwYXJlRGF0YTogLT4KICAgICAgICAKICAgICAgICBpZiBAbmVlZE1hcFByZXBhcmUKICAgICAgICAgICAgR2FtZU1hbmFnZXIudmFyaWFibGVTdG9yZS5zZXR1cChAbWFwTG9naWMpCiAgICAgICAgICAgIEBtYXBMb2dpYy5wcmVwYXJlKCkKICAgICAgICAgICAgCiAgICAKICAgICAgICBSZXNvdXJjZU1hbmFnZXIuZ2V0Qml0bWFwKCJHcmFwaGljcy9TaGFkb3ciKQogICAgICAgIEBtYXAgPSBuZXcgU3ByaXRlc2V0X01hcChAbWFwTG9naWMpCiAgICAgICAgQHRpbWVyID0gbmV3IFNwcml0ZV9UaW1lcihHYW1lTWFuYWdlci50aW1lcikKICAgICAgICBAdGltZXIudXBkYXRlKCkKICAgICAgICBAdGltZXIucmVmcmVzaCgpCiAKICAgIHByZXBhcmVWaXN1YWw6IC0+ICAgICAgCiAgICAgICAgQG1hcC5wcmVwYXJlKCkKICAgICAgICBHYW1lTWFuYWdlci5zY3JlZW4uY2VudGVyT25QbGF5ZXIoKQogICAgICAgIEB1cGRhdGUoKQogCiAgICAgICAgR2FtZU1hbmFnZXIuc2NyZWVuVmlld3BvcnQgPSBAbWFwLm1hcFZpZXdwb3J0CiAgICAgICAgR3JhcGhpY3MudHJhbnNpdGlvbigyMCkKICAgICAgICAKICAgICAgICBpZiBAbmVlZE1hcFByZXBhcmUKICAgICAgICAgICAgaWYgQG1hcExvZ2ljLmF1dG9QbGF5TXVzaWMKICAgICAgICAgICAgICAgIEF1ZGlvTWFuYWdlci5jaGFuZ2VNdXNpYyhAbWFwTG9naWMubXVzaWMpCiAgICAgICAgICAgIGlmIEBtYXBMb2dpYy5hdXRvUGxheUJhY2tncm91bmRTb3VuZAogICAgICAgICAgICAgICAgQXVkaW9NYW5hZ2VyLmNoYW5nZUJhY2tncm91bmRTb3VuZChAbWFwTG9naWMuYmFja2dyb3VuZFNvdW5kKQogICAgICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgCiAgICAgCiAgICBjaGVja01lbnVBY2Nlc3M6IC0+CiAgICAgICAgd2luID0gR2FtZU1hbmFnZXIubWVzc2FnZVdpbmRvdwogICAgICAgIHJldHVybiBHYW1lTWFuYWdlci5tZW51QWNjZXNzID09IDAgYW5kIChub3Qgd2luLnZpc2libGUgb3Igd2luLm9wZW5uZXNzID09IDApIGFuZCBub3QgR2FtZU1hbmFnZXIuaW50ZXJwcmV0ZXIuaXNSdW5uaW5nCiAgICB1cGRhdGU6IC0+CiAgICAgICAgCiAgICAgICAgaWYgR2FtZU1hbmFnZXIubWVzc2FnZVdpbmRvdz8KICAgICAgICAgICAgR2FtZU1hbmFnZXIubWVzc2FnZVdpbmRvdy51cGRhdGUoKQogICAgICAgIGlmIEdhbWVNYW5hZ2VyLmlucHV0TnVtYmVyV2luZG93CiAgICAgICAgICAgIEdhbWVNYW5hZ2VyLmlucHV0TnVtYmVyV2luZG93LnVwZGF0ZSgpCiAgICAgICAgaWYgR2FtZU1hbmFnZXIuaW5wdXRUZXh0V2luZG93c2V0PwogICAgICAgICAgICBHYW1lTWFuYWdlci5pbnB1dFRleHRXaW5kb3dzZXQudXBkYXRlKCkKICAgICAgICBpZiBHYW1lTWFuYWdlci5jaG9pY2VXaW5kb3cKICAgICAgICAgICAgR2FtZU1hbmFnZXIuY2hvaWNlV2luZG93LnVwZGF0ZSgpCiAgICAgICAgR2FtZU1hbmFnZXIudGltZXIudXBkYXRlKCkKICAgICAgICBHYW1lTWFuYWdlci5zY3JlZW4udXBkYXRlKCkKICAgICAgICBAbWFwTG9naWMudXBkYXRlKCkKICAgICAgICBmb3IgZXZlbnQgaW4gR2FtZU1hbmFnZXIuY29tbW9uRXZlbnRzCiAgICAgICAgICAgIGlmIGV2ZW50PwogICAgICAgICAgICAgICAgR2FtZU1hbmFnZXIubWFwLmN1cnJlbnRFdmVudCA9IGV2ZW50CiAgICAgICAgICAgICAgICBldmVudC51cGRhdGUoKQogICAgICAgIAogICAgICAgIAogICAgICAgIEBtYXAudXBkYXRlKCkKICAgICAgICBHYW1lTWFuYWdlci53ZWF0aGVyLnVwZGF0ZSgpCiAgICAgICAgCiAgICAgICMgIEdhbWVNYW5hZ2VyLmludGVycHJldGVyLnVwZGF0ZSgpCiAgICAgIAogICAgICAgIEdhbWVNYW5hZ2VyLnBsYXllckV2ZW50LmdyYXBoaWMgPSBHYW1lTWFuYWdlci5wYXJ0eS5tZW1iZXJzWzBdLmNoYXJhY3RlckdyYXBoaWMKICAgICAgICBHYW1lTWFuYWdlci5wbGF5ZXJFdmVudC5wYXR0ZXJuID0gR2FtZU1hbmFnZXIucGFydHkubWVtYmVyc1swXS5jaGFyYWN0ZXJQYXR0ZXJuCiAgICAgICAgCiAgICAgICAgZm9yIHBpY3R1cmUgaW4gR2FtZU1hbmFnZXIucGljdHVyZXMKICAgICAgICAgICAgaWYgcGljdHVyZT8gYW5kIHBpY3R1cmUudmlzaWJsZQogICAgICAgICAgICAgICAgcGljdHVyZS51cGRhdGUoKQogICAgICAgIGZvciB0ZXh0IGluIEdhbWVNYW5hZ2VyLnRleHRzCiAgICAgICAgICAgIGlmIHRleHQ/IGFuZCB0ZXh0LnZpc2libGUgdGhlbiB0ZXh0LnVwZGF0ZSgpCiAgICAgICAgZm9yIGkgaW4gWzAuLi5HYW1lTWFuYWdlci5hbmltYXRpb25zLmxlbmd0aF0KICAgICAgICAgICAgYW5pbWF0aW9uID0gR2FtZU1hbmFnZXIuYW5pbWF0aW9uc1tpXQogICAgICAgICAgICBpZiBhbmltYXRpb24/CiAgICAgICAgICAgICAgICBpZiBhbmltYXRpb24ubG9naWMuaXNSdW5uaW5nCiAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uLmxvZ2ljLnVwZGF0ZSgpCiAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uLnVwZGF0ZSgpCiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uLmRpc3Bvc2UoKQogICAgICAgICAgICAgICAgICAgIEdhbWVNYW5hZ2VyLmFuaW1hdGlvbnMucmVtb3ZlKGFuaW1hdGlvbikKICAgICAgICAgICAgICAgICAgICBpLS0KICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgQHRpbWVyLnVwZGF0ZSgpCiAgICAgCiAgICAgICAgCiAgICAgICAgaWYgSW5wdXQudHJpZ2dlcihJbnB1dC5CKSBhbmQgQGNoZWNrTWVudUFjY2VzcygpCiAgICAgICAgICAgIFNjZW5lTWFuYWdlci5zd2l0Y2hUbyhuZXcgU2NlbmVfTWFpbk1lbnUoKSkKICAgICAgICMgaWYgSW5wdXQudHJpZ2dlcihJbnB1dC5DKQogICAgICAgICMgICAgU2NlbmVNYW5hZ2VyLnN3aXRjaFRvKG5ldyBTY2VuZV9TaG9wKCkpCiAgICAgICAgaWYgSW5wdXQudHJpZ2dlcihJbnB1dC5YKQogICAgICAgICAgICBHYW1lTWFuYWdlci50cm9vcCA9IFJlY29yZE1hbmFnZXIudHJvb3BzWzRdCiAgICAgICAgICAgIFNjZW5lTWFuYWdlci5zd2l0Y2hUbyhuZXcgU2NlbmVfQmF0dGxlKCkpCiAgICAgICAgICAgIAogICAgICAgIHN1cGVyKCkKICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAKCndpbmRvdy5TY2VuZV9NYXAgPSBTY2VuZV9NYXA=","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBTY2VuZV9NYXAsCiAgICBfX2hhc1Byb3AgPSB7fS5oYXNPd25Qcm9wZXJ0eSwKICAgIF9fZXh0ZW5kcyA9IGZ1bmN0aW9uKGNoaWxkLCBwYXJlbnQpIHsgZm9yICh2YXIga2V5IGluIHBhcmVudCkgeyBpZiAoX19oYXNQcm9wLmNhbGwocGFyZW50LCBrZXkpKSBjaGlsZFtrZXldID0gcGFyZW50W2tleV07IH0gZnVuY3Rpb24gY3RvcigpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGNoaWxkOyB9IGN0b3IucHJvdG90eXBlID0gcGFyZW50LnByb3RvdHlwZTsgY2hpbGQucHJvdG90eXBlID0gbmV3IGN0b3IoKTsgY2hpbGQuX19zdXBlcl9fID0gcGFyZW50LnByb3RvdHlwZTsgcmV0dXJuIGNoaWxkOyB9OwoKICBTY2VuZV9NYXAgPSAoZnVuY3Rpb24oX3N1cGVyKSB7CiAgICBfX2V4dGVuZHMoU2NlbmVfTWFwLCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFNjZW5lX01hcCgpIHsKICAgICAgU2NlbmVfTWFwLl9fc3VwZXJfXy5jb25zdHJ1Y3Rvci5jYWxsKHRoaXMpOwogICAgICB0aGlzLm5lZWRNYXBQcmVwYXJlID0gZmFsc2U7CiAgICB9CgogICAgU2NlbmVfTWFwLnByb3RvdHlwZS5pbml0aWFsaXplID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBwaWN0dXJlLCB0ZXh0LCBfaSwgX2osIF9sZW4sIF9sZW4xLCBfcmVmLCBfcmVmMTsKICAgICAgR2FtZU1hbmFnZXIuaW50ZXJwcmV0ZXIuc3RvcCgpOwogICAgICBpZiAoKEdhbWVNYW5hZ2VyLm1hcCA9PSBudWxsKSB8fCBHYW1lTWFuYWdlci5tYXAuaWQgIT09IEdhbWVNYW5hZ2VyLmN1cnJlbnRNYXBJZCkgewogICAgICAgIHRoaXMubWFwTG9naWMgPSBuZXcgTG9naWNfTWFwKEdhbWVNYW5hZ2VyLmN1cnJlbnRNYXBJZCk7CiAgICAgICAgR2FtZU1hbmFnZXIubWFwID0gdGhpcy5tYXBMb2dpYzsKICAgICAgICB0aGlzLm5lZWRNYXBQcmVwYXJlID0gdHJ1ZTsKICAgICAgICBjb25zb2xlLmxvZygiSUQ6ICIgKyBHYW1lTWFuYWdlci5jdXJyZW50TWFwSWQpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMubWFwTG9naWMgPSBHYW1lTWFuYWdlci5tYXA7CiAgICAgIH0KICAgICAgTGFuZ3VhZ2VNYW5hZ2VyLmxvYWRNYXBCdW5kbGUoR2FtZU1hbmFnZXIuY3VycmVudE1hcElkKTsKICAgICAgX3JlZiA9IEdhbWVNYW5hZ2VyLnBpY3R1cmVzOwogICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICBwaWN0dXJlID0gX3JlZltfaV07CiAgICAgICAgaWYgKHBpY3R1cmUgIT0gbnVsbCkgewogICAgICAgICAgcGljdHVyZS52aXNpYmxlID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0KICAgICAgX3JlZjEgPSBHYW1lTWFuYWdlci50ZXh0czsKICAgICAgZm9yIChfaiA9IDAsIF9sZW4xID0gX3JlZjEubGVuZ3RoOyBfaiA8IF9sZW4xOyBfaisrKSB7CiAgICAgICAgdGV4dCA9IF9yZWYxW19qXTsKICAgICAgICBpZiAodGV4dCAhPSBudWxsKSB7CiAgICAgICAgICB0ZXh0LnZpc2libGUgPSB0cnVlOwogICAgICAgIH0KICAgICAgfQogICAgICBHYW1lTWFuYWdlci53ZWF0aGVyLnZpc2libGUodHJ1ZSk7CiAgICAgIHJldHVybiBHcmFwaGljcy5mcmVlemUoKTsKICAgIH07CgogICAgU2NlbmVfTWFwLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBwaWN0dXJlLCB0ZXh0LCBfaSwgX2osIF9sZW4sIF9sZW4xLCBfcmVmLCBfcmVmMSwgX3Jlc3VsdHM7CiAgICAgIEdhbWVNYW5hZ2VyLndlYXRoZXIudmlzaWJsZShmYWxzZSk7CiAgICAgIHRoaXMubWFwLmRpc3Bvc2UoKTsKICAgICAgdGhpcy50aW1lci5kaXNwb3NlKCk7CiAgICAgIF9yZWYgPSBHYW1lTWFuYWdlci5waWN0dXJlczsKICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBfcmVmLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7CiAgICAgICAgcGljdHVyZSA9IF9yZWZbX2ldOwogICAgICAgIGlmICgocGljdHVyZSAhPSBudWxsKSAmJiBwaWN0dXJlLnZpc2libGUpIHsKICAgICAgICAgIHBpY3R1cmUudmlzaWJsZSA9IGZhbHNlOwogICAgICAgIH0KICAgICAgfQogICAgICBfcmVmMSA9IEdhbWVNYW5hZ2VyLnRleHRzOwogICAgICBfcmVzdWx0cyA9IFtdOwogICAgICBmb3IgKF9qID0gMCwgX2xlbjEgPSBfcmVmMS5sZW5ndGg7IF9qIDwgX2xlbjE7IF9qKyspIHsKICAgICAgICB0ZXh0ID0gX3JlZjFbX2pdOwogICAgICAgIGlmICgodGV4dCAhPSBudWxsKSAmJiB0ZXh0LnZpc2libGUpIHsKICAgICAgICAgIF9yZXN1bHRzLnB1c2godGV4dC52aXNpYmxlID0gZmFsc2UpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBfcmVzdWx0cy5wdXNoKHZvaWQgMCk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiBfcmVzdWx0czsKICAgIH07CgogICAgU2NlbmVfTWFwLnByb3RvdHlwZS5wcmVwYXJlRGF0YSA9IGZ1bmN0aW9uKCkgewogICAgICBpZiAodGhpcy5uZWVkTWFwUHJlcGFyZSkgewogICAgICAgIEdhbWVNYW5hZ2VyLnZhcmlhYmxlU3RvcmUuc2V0dXAodGhpcy5tYXBMb2dpYyk7CiAgICAgICAgdGhpcy5tYXBMb2dpYy5wcmVwYXJlKCk7CiAgICAgIH0KICAgICAgUmVzb3VyY2VNYW5hZ2VyLmdldEJpdG1hcCgiR3JhcGhpY3MvU2hhZG93Iik7CiAgICAgIHRoaXMubWFwID0gbmV3IFNwcml0ZXNldF9NYXAodGhpcy5tYXBMb2dpYyk7CiAgICAgIHRoaXMudGltZXIgPSBuZXcgU3ByaXRlX1RpbWVyKEdhbWVNYW5hZ2VyLnRpbWVyKTsKICAgICAgdGhpcy50aW1lci51cGRhdGUoKTsKICAgICAgcmV0dXJuIHRoaXMudGltZXIucmVmcmVzaCgpOwogICAgfTsKCiAgICBTY2VuZV9NYXAucHJvdG90eXBlLnByZXBhcmVWaXN1YWwgPSBmdW5jdGlvbigpIHsKICAgICAgdGhpcy5tYXAucHJlcGFyZSgpOwogICAgICBHYW1lTWFuYWdlci5zY3JlZW4uY2VudGVyT25QbGF5ZXIoKTsKICAgICAgdGhpcy51cGRhdGUoKTsKICAgICAgR2FtZU1hbmFnZXIuc2NyZWVuVmlld3BvcnQgPSB0aGlzLm1hcC5tYXBWaWV3cG9ydDsKICAgICAgR3JhcGhpY3MudHJhbnNpdGlvbigyMCk7CiAgICAgIGlmICh0aGlzLm5lZWRNYXBQcmVwYXJlKSB7CiAgICAgICAgaWYgKHRoaXMubWFwTG9naWMuYXV0b1BsYXlNdXNpYykgewogICAgICAgICAgQXVkaW9NYW5hZ2VyLmNoYW5nZU11c2ljKHRoaXMubWFwTG9naWMubXVzaWMpOwogICAgICAgIH0KICAgICAgICBpZiAodGhpcy5tYXBMb2dpYy5hdXRvUGxheUJhY2tncm91bmRTb3VuZCkgewogICAgICAgICAgcmV0dXJuIEF1ZGlvTWFuYWdlci5jaGFuZ2VCYWNrZ3JvdW5kU291bmQodGhpcy5tYXBMb2dpYy5iYWNrZ3JvdW5kU291bmQpOwogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICBTY2VuZV9NYXAucHJvdG90eXBlLmNoZWNrTWVudUFjY2VzcyA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgd2luOwogICAgICB3aW4gPSBHYW1lTWFuYWdlci5tZXNzYWdlV2luZG93OwogICAgICByZXR1cm4gR2FtZU1hbmFnZXIubWVudUFjY2VzcyA9PT0gMCAmJiAoIXdpbi52aXNpYmxlIHx8IHdpbi5vcGVubmVzcyA9PT0gMCkgJiYgIUdhbWVNYW5hZ2VyLmludGVycHJldGVyLmlzUnVubmluZzsKICAgIH07CgogICAgU2NlbmVfTWFwLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGFuaW1hdGlvbiwgZXZlbnQsIGksIHBpY3R1cmUsIHRleHQsIF9pLCBfaiwgX2ssIF9sLCBfbGVuLCBfbGVuMSwgX2xlbjIsIF9yZWYsIF9yZWYxLCBfcmVmMiwgX3JlZjM7CiAgICAgIGlmIChHYW1lTWFuYWdlci5tZXNzYWdlV2luZG93ICE9IG51bGwpIHsKICAgICAgICBHYW1lTWFuYWdlci5tZXNzYWdlV2luZG93LnVwZGF0ZSgpOwogICAgICB9CiAgICAgIGlmIChHYW1lTWFuYWdlci5pbnB1dE51bWJlcldpbmRvdykgewogICAgICAgIEdhbWVNYW5hZ2VyLmlucHV0TnVtYmVyV2luZG93LnVwZGF0ZSgpOwogICAgICB9CiAgICAgIGlmIChHYW1lTWFuYWdlci5pbnB1dFRleHRXaW5kb3dzZXQgIT0gbnVsbCkgewogICAgICAgIEdhbWVNYW5hZ2VyLmlucHV0VGV4dFdpbmRvd3NldC51cGRhdGUoKTsKICAgICAgfQogICAgICBpZiAoR2FtZU1hbmFnZXIuY2hvaWNlV2luZG93KSB7CiAgICAgICAgR2FtZU1hbmFnZXIuY2hvaWNlV2luZG93LnVwZGF0ZSgpOwogICAgICB9CiAgICAgIEdhbWVNYW5hZ2VyLnRpbWVyLnVwZGF0ZSgpOwogICAgICBHYW1lTWFuYWdlci5zY3JlZW4udXBkYXRlKCk7CiAgICAgIHRoaXMubWFwTG9naWMudXBkYXRlKCk7CiAgICAgIF9yZWYgPSBHYW1lTWFuYWdlci5jb21tb25FdmVudHM7CiAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gX3JlZi5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykgewogICAgICAgIGV2ZW50ID0gX3JlZltfaV07CiAgICAgICAgaWYgKGV2ZW50ICE9IG51bGwpIHsKICAgICAgICAgIEdhbWVNYW5hZ2VyLm1hcC5jdXJyZW50RXZlbnQgPSBldmVudDsKICAgICAgICAgIGV2ZW50LnVwZGF0ZSgpOwogICAgICAgIH0KICAgICAgfQogICAgICB0aGlzLm1hcC51cGRhdGUoKTsKICAgICAgR2FtZU1hbmFnZXIud2VhdGhlci51cGRhdGUoKTsKICAgICAgR2FtZU1hbmFnZXIucGxheWVyRXZlbnQuZ3JhcGhpYyA9IEdhbWVNYW5hZ2VyLnBhcnR5Lm1lbWJlcnNbMF0uY2hhcmFjdGVyR3JhcGhpYzsKICAgICAgR2FtZU1hbmFnZXIucGxheWVyRXZlbnQucGF0dGVybiA9IEdhbWVNYW5hZ2VyLnBhcnR5Lm1lbWJlcnNbMF0uY2hhcmFjdGVyUGF0dGVybjsKICAgICAgX3JlZjEgPSBHYW1lTWFuYWdlci5waWN0dXJlczsKICAgICAgZm9yIChfaiA9IDAsIF9sZW4xID0gX3JlZjEubGVuZ3RoOyBfaiA8IF9sZW4xOyBfaisrKSB7CiAgICAgICAgcGljdHVyZSA9IF9yZWYxW19qXTsKICAgICAgICBpZiAoKHBpY3R1cmUgIT0gbnVsbCkgJiYgcGljdHVyZS52aXNpYmxlKSB7CiAgICAgICAgICBwaWN0dXJlLnVwZGF0ZSgpOwogICAgICAgIH0KICAgICAgfQogICAgICBfcmVmMiA9IEdhbWVNYW5hZ2VyLnRleHRzOwogICAgICBmb3IgKF9rID0gMCwgX2xlbjIgPSBfcmVmMi5sZW5ndGg7IF9rIDwgX2xlbjI7IF9rKyspIHsKICAgICAgICB0ZXh0ID0gX3JlZjJbX2tdOwogICAgICAgIGlmICgodGV4dCAhPSBudWxsKSAmJiB0ZXh0LnZpc2libGUpIHsKICAgICAgICAgIHRleHQudXBkYXRlKCk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGZvciAoaSA9IF9sID0gMCwgX3JlZjMgPSBHYW1lTWFuYWdlci5hbmltYXRpb25zLmxlbmd0aDsgMCA8PSBfcmVmMyA/IF9sIDwgX3JlZjMgOiBfbCA+IF9yZWYzOyBpID0gMCA8PSBfcmVmMyA/ICsrX2wgOiAtLV9sKSB7CiAgICAgICAgYW5pbWF0aW9uID0gR2FtZU1hbmFnZXIuYW5pbWF0aW9uc1tpXTsKICAgICAgICBpZiAoYW5pbWF0aW9uICE9IG51bGwpIHsKICAgICAgICAgIGlmIChhbmltYXRpb24ubG9naWMuaXNSdW5uaW5nKSB7CiAgICAgICAgICAgIGFuaW1hdGlvbi5sb2dpYy51cGRhdGUoKTsKICAgICAgICAgICAgYW5pbWF0aW9uLnVwZGF0ZSgpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgYW5pbWF0aW9uLmRpc3Bvc2UoKTsKICAgICAgICAgICAgR2FtZU1hbmFnZXIuYW5pbWF0aW9ucy5yZW1vdmUoYW5pbWF0aW9uKTsKICAgICAgICAgICAgaS0tOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICB0aGlzLnRpbWVyLnVwZGF0ZSgpOwogICAgICBpZiAoSW5wdXQudHJpZ2dlcihJbnB1dC5CKSAmJiB0aGlzLmNoZWNrTWVudUFjY2VzcygpKSB7CiAgICAgICAgU2NlbmVNYW5hZ2VyLnN3aXRjaFRvKG5ldyBTY2VuZV9NYWluTWVudSgpKTsKICAgICAgfQogICAgICBpZiAoSW5wdXQudHJpZ2dlcihJbnB1dC5YKSkgewogICAgICAgIEdhbWVNYW5hZ2VyLnRyb29wID0gUmVjb3JkTWFuYWdlci50cm9vcHNbNF07CiAgICAgICAgU2NlbmVNYW5hZ2VyLnN3aXRjaFRvKG5ldyBTY2VuZV9CYXR0bGUoKSk7CiAgICAgIH0KICAgICAgcmV0dXJuIFNjZW5lX01hcC5fX3N1cGVyX18udXBkYXRlLmNhbGwodGhpcyk7CiAgICB9OwoKICAgIHJldHVybiBTY2VuZV9NYXA7CgogIH0pKFNjZW5lKTsKCiAgd2luZG93LlNjZW5lX01hcCA9IFNjZW5lX01hcDsKCn0pLmNhbGwodGhpcyk7Cg=="},{"name":"Scene_MainMenu","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogU2NlbmVfTWFpbk1lbnUKIyAgIENyZWF0ZWQgb246IDIwMTMtMDktMTUKIwojIAlDb3B5cmlnaHQgKEMpIDIwMTMgQW5kcukgUmFkb21za2kuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAJQ2xhc3M6IFNjZW5lX01haW5NZW51CiMKIyAgIERlc2NyaXB0aW9uLi4uCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpjbGFzcyBTY2VuZV9NYWluTWVudSBleHRlbmRzIFNjZW5lCiAgICBjb25zdHJ1Y3RvcjogLT4KICAgICAgICBzdXBlcigpCiAgICAKICAgIGluaXRpYWxpemU6IC0+CiAgICAgICAgQGJhY2tncm91bmQgPSBHcmFwaGljcy5zbmFwc2hvdCgpCiAgICAgICAgQGJhY2tncm91bmQuZmlsbFJlY3QoMCwgMCwgQGJhY2tncm91bmQud2lkdGgsIEBiYWNrZ3JvdW5kLmhlaWdodCwgbmV3IENvbG9yKDAsIDAsIDAsIDAuNSkpCiAgICAgICAgQHZvY2FiID0gUmVjb3JkTWFuYWdlci52b2NhYnVsYXJ5CiAgICAgICAgR3JhcGhpY3MuZnJlZXplKCkKICAgIGRpc3Bvc2U6IC0+CiAgICAgICAgQHNwcml0ZS5kaXNwb3NlKCkKICAgICAgICBAaXRlbXNXaW5kb3dzZXQuZGlzcG9zZSgpCiAgICAgICAgQGVxdWlwbWVudFdpbmRvd3NldC5kaXNwb3NlKCkKICAgICAgICBAc2tpbGxzV2luZG93c2V0LmRpc3Bvc2UoKQogICAgICAgIEBzYXZlV2luZG93c2V0LmRpc3Bvc2UoKQogICAgICAgIEBwYXJ0eVdpbmRvdy5kaXNwb3NlKCkKICAgICAgICBAc3RhdHVzV2luZG93LmRpc3Bvc2UoKQogICAgICAgIEBhY3Rpb25XaW5kb3cuZGlzcG9zZSgpCiAgICAgICAgQGdhbWVUaW1lV2luZG93LmRpc3Bvc2UoKQogICAgICAgIEBtb25leVdpbmRvdy5kaXNwb3NlKCkKICAgICAgICAKICAgIHNob3c6ICh2aXNpYmxlKSAtPgogICAgICAgIEBzcHJpdGUudmlzaWJsZSA9IHZpc2libGUKICAgICAgICBAaXRlbXNXaW5kb3dzZXQudmlzaWJsZSA9IHZpc2libGUKICAgICAgICBAZXF1aXBtZW50V2luZG93c2V0LnZpc2libGUgPSB2aXNpYmxlCiAgICAgICAgQHNraWxsc1dpbmRvd3NldC52aXNpYmxlID0gdmlzaWJsZQogICAgICAgIEBzYXZlV2luZG93c2V0LnZpc2libGUgPSB2aXNpYmxlCiAgICAgICAgQHBhcnR5V2luZG93LnZpc2libGUgPSB2aXNpYmxlCiAgICAgICAgQHN0YXR1c1dpbmRvdy52aXNpYmxlID0gdmlzaWJsZQogICAgICAgIEBhY3Rpb25XaW5kb3cudmlzaWJsZSA9IHZpc2libGUKICAgICAgICBAZ2FtZVRpbWVXaW5kb3cudmlzaWJsZSA9IHZpc2libGUKICAgICAgICBAbW9uZXlXaW5kb3cudmlzaWJsZSA9IHZpc2libGUKICAgIAogICAgcHJlcGFyZURhdGE6IC0+ICAgCiAgICAgICAgc2NhbGUgPSBXaW5kb3dfQmFzZS5zY2FsZQogICAgICAgIAogICAgICAgIEBzcHJpdGUgPSBuZXcgU3ByaXRlCiAgICAgICAgQHNwcml0ZS5iaXRtYXAgPSBAYmFja2dyb3VuZAogICAgICAgIEBzcHJpdGUuc3JjUmVjdCA9IG5ldyBSZWN0KDAsIDAsIEdyYXBoaWNzLndpZHRoLCBHcmFwaGljcy5oZWlnaHQpCiAgICAgICAgQHNwcml0ZS56ID0gLTEKICAgICAgICAKICAgICAgICBAcGFydHlXaW5kb3cgPSBuZXcgV2luZG93X1BhcnR5KCkKICAgICAgICBAcGFydHlXaW5kb3cub25TZWxlY3Rpb25DaGFuZ2UgPSA9PiBAb25QYXJ0eU1lbWJlckNoYW5nZSgpCiAgICAgICAgQHBhcnR5V2luZG93LnogPSAwCiAgICAgICAgCiAgICAgICAgQGFjdGlvbldpbmRvdyA9IG5ldyBXaW5kb3dfU2VsZWN0aW9uKDAsIEBwYXJ0eVdpbmRvdy5oZWlnaHQsIDEsIFtbbGNzKEB2b2NhYi5tZW51LnN0YXR1cyldICwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtsY3MoQHZvY2FiLm1lbnUuaXRlbXMpXSAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbbGNzKEB2b2NhYi5tZW51LnNraWxscyldLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2xjcyhAdm9jYWIubWVudS5lcXVpcG1lbnQpXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtsY3MoQHZvY2FiLm1lbnUuc2F2ZSldLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW2xjcyhAdm9jYWIubWVudS5lbmRHYW1lKV1dLCAxNTAgKiBzY2FsZSwgMzIgKiBzY2FsZSkKICAgICAgICBAYWN0aW9uV2luZG93LnZhbGlkYXRlQ2VsbCA9ICh4LCB5LCBjZWxsKSA9PiBpZiB5ID09IDQgdGhlbiBHYW1lTWFuYWdlci5zYXZlTWVudUFjY2VzcyBlbHNlIHllcyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgIEBhY3Rpb25XaW5kb3cub25TZWxlY3Rpb25DaGFuZ2UgPSA9PiBAb25BY3Rpb25DaGFuZ2UoKQogICAgICAgIEBhY3Rpb25XaW5kb3cub25TZWxlY3Rpb25BY2NlcHQgPSA9PiBAb25BY3Rpb24oKQogICAgICAgIEBhY3Rpb25XaW5kb3cub25DYW5jZWwgPSA9PiBAb25BY3Rpb25DYW5jZWwoKQogICAgICAgIEBhY3Rpb25XaW5kb3cudGV4dEFsaWdubWVudCA9IDAKICAgICAgICAKICAgICAgICBAaXRlbXNXaW5kb3dzZXQgPSBuZXcgV2luZG93c2V0X0l0ZW1zKEBhY3Rpb25XaW5kb3cueCtAYWN0aW9uV2luZG93LndpZHRoLCAxMTQgKiBzY2FsZSwgbnVsbCwgR3JhcGhpY3Mud2lkdGggLSBAYWN0aW9uV2luZG93LndpZHRoKQogICAgICAgIEBpdGVtc1dpbmRvd3NldC5zaG93KG5vKQogICAgICAgIEBpdGVtc1dpbmRvd3NldC5vbkl0ZW1TZWxlY3Rpb24gPSAoaXRlbSkgPT4gQG9uSXRlbVNlbGVjdGlvbihpdGVtKQogICAgICAgIEBpdGVtc1dpbmRvd3NldC5vbkNhbmNlbCA9ID0+IEBvblN1Yk1lbnVDYW5jZWwoKQogICAgICAgIEBlcXVpcG1lbnRXaW5kb3dzZXQgPSBuZXcgV2luZG93c2V0X0VxdWlwbWVudChAYWN0aW9uV2luZG93LngrQGFjdGlvbldpbmRvdy53aWR0aCwgMTE0ICogc2NhbGUpCiAgICAgICAgQGVxdWlwbWVudFdpbmRvd3NldC5zaG93KG5vKQogICAgICAgIEBlcXVpcG1lbnRXaW5kb3dzZXQub25DYW5jZWwgPSA9PiBAb25TdWJNZW51Q2FuY2VsKCkKICAgICAgICBAZXF1aXBtZW50V2luZG93c2V0Lm9uRXF1aXBtZW50Q2hhbmdlID0gPT4gQHBhcnR5V2luZG93LnJlZHJhdygpCiAgICAgICAgQHNraWxsc1dpbmRvd3NldCA9IG5ldyBXaW5kb3dzZXRfU2tpbGxzKEBhY3Rpb25XaW5kb3cueCtAYWN0aW9uV2luZG93LndpZHRoLCAxMTQgKiBzY2FsZSwgbnVsbCwgR3JhcGhpY3Mud2lkdGggLSBAYWN0aW9uV2luZG93LndpZHRoKQogICAgICAgIEBza2lsbHNXaW5kb3dzZXQuc2hvdyhubykKICAgICAgICBAc2tpbGxzV2luZG93c2V0Lm9uU2tpbGxTZWxlY3Rpb24gPSAoc2tpbGwpID0+IEBvblNraWxsU2VsZWN0aW9uKHNraWxsKQogICAgICAgIEBza2lsbHNXaW5kb3dzZXQub25DYW5jZWwgPSA9PiBAb25TdWJNZW51Q2FuY2VsKCkKICAgICAgICAKICAgICAgICBAdXNlRHJvcEFsZXJ0V2luZG93c2V0ID0gbmV3IFdpbmRvd3NldF9BbGVydCgiV2hhdCBkbyB5b3Ugd2FudCB0byBkbz8iLCBbIlVzZSIsICJEcm9wIl0pCiAgICAgICAgQHVzZURyb3BBbGVydFdpbmRvd3NldC5zaG93KG5vKQogICAgICAgIEB1c2VEcm9wQWxlcnRXaW5kb3dzZXQub25BY2NlcHQgPSAoc2VuZGVyLCBjb2RlKSA9PiBAb25Vc2VEcm9wQWxlcnRBY2NlcHQoY29kZSkKICAgICAgICBAdXNlRHJvcEFsZXJ0V2luZG93c2V0Lm9uQ2FuY2VsID0gPT4gQG9uVXNlRHJvcEFsZXJ0Q2FuY2VsKCkKICAgICAgICAKICAgICAgICBAYW1vdW50U2VsZWN0aW9uV2luZG93ID0gbmV3IFdpbmRvd19BbW91bnRTZWxlY3Rpb24oKQogICAgICAgIEBhbW91bnRTZWxlY3Rpb25XaW5kb3cudmlzaWJsZSA9IG5vCiAgICAgICAgCiAgICAgICAgCgogICAgICAgIEBzYXZlV2luZG93c2V0ID0gbmV3IFdpbmRvd3NldF9TYXZlKDE3NCAqIHNjYWxlLCBAcGFydHlXaW5kb3cuaGVpZ2h0KQogICAgICAgIEBzYXZlV2luZG93c2V0Lm9uRmlsZVNlbGVjdGlvbiA9IChzbG90KSA9PiBAb25GaWxlU2VsZWN0aW9uKHNsb3QpCiAgICAgICAgQHNhdmVXaW5kb3dzZXQub25DYW5jZWwgPSAoc2xvdCkgPT4gQG9uRmlsZUNhbmNlbChzbG90KQogICAgICAgIEBzYXZlV2luZG93c2V0LnNob3cobm8pCiAgICAgICAgQHN0YXR1c1dpbmRvdyA9IG5ldyBXaW5kb3dfU3RhdHVzKCkKICAgICAgICAKICAgICAgICBAZ2FtZVRpbWVXaW5kb3cgPSBuZXcgV2luZG93X0dhbWVUaW1lKDAsIDApCiAgICAgICAgQGdhbWVUaW1lV2luZG93LnkgPSBHcmFwaGljcy5oZWlnaHQgLSBAZ2FtZVRpbWVXaW5kb3cuaGVpZ2h0CiAgICAgICAgQGdhbWVUaW1lV2luZG93LnJlZHJhdygpCiAgICAgICAgQG1vbmV5V2luZG93ID0gbmV3IFdpbmRvd19Nb25leSgwLCAwKQogICAgICAgIEBtb25leVdpbmRvdy55ID0gQGdhbWVUaW1lV2luZG93LnkgLSBAbW9uZXlXaW5kb3cuaGVpZ2h0CiAgICAgICAgQG1vbmV5V2luZG93LnJlZHJhdygpCiAgICAgICAgQGFjdGlvbldpbmRvdy5yZWRyYXcoKQogICAgICAgIEBwYXJ0eVdpbmRvdy5wcmVwYXJlKCkKICAgICAgICBAcGFydHlXaW5kb3cucmVkcmF3KCkKICAgICAgCiAgICBwcmVwYXJlVmlzdWFsOiAtPgogICAgICAgIEB1cGRhdGUoKQogICAgICAgIEdyYXBoaWNzLnRyYW5zaXRpb24oMjApCiAgICAKICAgIHVwZGF0ZTogLT4KICAgICAgICBAaXRlbXNXaW5kb3dzZXQudXBkYXRlKCkKICAgICAgICBAZXF1aXBtZW50V2luZG93c2V0LnVwZGF0ZSgpCiAgICAgICAgQHNraWxsc1dpbmRvd3NldC51cGRhdGUoKQogICAgICAgIEBzYXZlV2luZG93c2V0LnVwZGF0ZSgpCiAgICAgICAgQHN0YXR1c1dpbmRvdy51cGRhdGUoKQogICAgICAgIEBwYXJ0eVdpbmRvdy51cGRhdGUoKQogICAgICAgIEBhY3Rpb25XaW5kb3cudXBkYXRlKCkKICAgICAgICBAdXNlRHJvcEFsZXJ0V2luZG93c2V0LnVwZGF0ZSgpCiAgICAgICAgQGFtb3VudFNlbGVjdGlvbldpbmRvdy51cGRhdGUoKQogICAgICAgICAgICAgICAgICAgIAogICAgICAgIHN1cGVyCiAgICAKICAgIG9uUGFydHlNZW1iZXJDaGFuZ2U6IC0+CiAgICAgICAgc3dpdGNoIEBhY3Rpb25XaW5kb3cuc2VsZWN0ZWRSb3cKICAgICAgICAgICAgd2hlbiAwCiAgICAgICAgICAgICAgICBAc3RhdHVzV2luZG93Lm1lbWJlciA9IEdhbWVNYW5hZ2VyLnBhcnR5Lm1lbWJlcnNbQHBhcnR5V2luZG93LnNlbGVjdGVkQ29sdW1uXQogICAgICAgICAgICAgICAgQHN0YXR1c1dpbmRvdy5yZWRyYXcoKQogICAgICAgICAgICB3aGVuIDEKICAgICAgICAgICAgICAgIEBpdGVtc1dpbmRvd3NldC5tZW1iZXIgPSBAcGFydHlXaW5kb3cuc2VsZWN0ZWRDZWxsCiAgICAgICAgICAgICAgICBAaXRlbXNXaW5kb3dzZXQucmVkcmF3KCkKICAgICAgICAgICAgd2hlbiAyCiAgICAgICAgICAgICAgICBAc2tpbGxzV2luZG93c2V0Lm1lbWJlciA9IEdhbWVNYW5hZ2VyLnBhcnR5Lm1lbWJlcnNbQHBhcnR5V2luZG93LnNlbGVjdGVkQ29sdW1uXQogICAgICAgICAgICAgICAgQHNraWxsc1dpbmRvd3NldC5yZWJ1aWxkKCkKICAgICAgICAgICAgICAgIEBza2lsbHNXaW5kb3dzZXQucmVkcmF3KCkKICAgICAgICAgICAgd2hlbiAzCiAgICAgICAgICAgICAgICBAZXF1aXBtZW50V2luZG93c2V0Lm1lbWJlciA9IEdhbWVNYW5hZ2VyLnBhcnR5Lm1lbWJlcnNbQHBhcnR5V2luZG93LnNlbGVjdGVkQ29sdW1uXQogICAgICAgICAgICAgICAgQGVxdWlwbWVudFdpbmRvd3NldC5yZWRyYXcoKQogICAgICAgICAgICAgCiAgICAKICAgIG9uU3ViTWVudUNhbmNlbDogLT4KICAgICAgICBzd2l0Y2ggQGFjdGlvbldpbmRvdy5zZWxlY3RlZFJvdwogICAgICAgICAgICB3aGVuIDEKICAgICAgICAgICAgICAgIEBhY3Rpb25XaW5kb3cuYWN0aXZlID0geWVzCiAgICAgICAgICAgICAgICBAcGFydHlXaW5kb3cuYWN0aXZlID0geWVzCiAgICAgICAgICAgICAgICBAaXRlbXNXaW5kb3dzZXQuYWN0aXZlID0gbm8KICAgICAgICAgICAgd2hlbiAyCiAgICAgICAgICAgICAgICBAYWN0aW9uV2luZG93LmFjdGl2ZSA9IHllcwogICAgICAgICAgICAgICAgQHBhcnR5V2luZG93LmFjdGl2ZSA9IHllcwogICAgICAgICAgICAgICAgQHNraWxsc1dpbmRvd3NldC5hY3RpdmUgPSBubwogICAgICAgICAgICB3aGVuIDMKICAgICAgICAgICAgICAgIEBhY3Rpb25XaW5kb3cuYWN0aXZlID0geWVzCiAgICAgICAgICAgICAgICBAcGFydHlXaW5kb3cuYWN0aXZlID0geWVzCiAgICAgICAgICAgICAgICBAZXF1aXBtZW50V2luZG93c2V0LmFjdGl2ZSA9IG5vCiAgICAgICAgICAgIHdoZW4gNAogICAgICAgICAgICAgICAgQGFjdGlvbldpbmRvdy5hY3RpdmUgPSB5ZXMKICAgICAgICAgICAgICAgIEBwYXJ0eVdpbmRvdy5hY3RpdmUgPSB5ZXMKICAgICAgICAgICAgICAgIEBzYXZlV2luZG93c2V0LmFjdGl2ZSA9IG5vCiAgICAgICAgICAgICAgICAgICAgCiAgICBvbkFjdGlvbjogLT4KICAgICAgICBzd2l0Y2ggQGFjdGlvbldpbmRvdy5zZWxlY3RlZFJvdwogICAgICAgICAgICB3aGVuIDEKICAgICAgICAgICAgICAgIEBhY3Rpb25XaW5kb3cuYWN0aXZlID0gbm8KICAgICAgICAgICAgICAgIEBwYXJ0eVdpbmRvdy5hY3RpdmUgPSBubwogICAgICAgICAgICAgICAgQGl0ZW1zV2luZG93c2V0LmFjdGl2ZSA9IHllcwogICAgICAgICAgICB3aGVuIDIKICAgICAgICAgICAgICAgIEBhY3Rpb25XaW5kb3cuYWN0aXZlID0gbm8KICAgICAgICAgICAgICAgIEBwYXJ0eVdpbmRvdy5hY3RpdmUgPSBubwogICAgICAgICAgICAgICAgQHNraWxsc1dpbmRvd3NldC5hY3RpdmUgPSB5ZXMKICAgICAgICAgICAgd2hlbiAzCiAgICAgICAgICAgICAgICBAYWN0aW9uV2luZG93LmFjdGl2ZSA9IG5vCiAgICAgICAgICAgICAgICBAcGFydHlXaW5kb3cuYWN0aXZlID0gbm8KICAgICAgICAgICAgICAgIEBlcXVpcG1lbnRXaW5kb3dzZXQuYWN0aXZlID0geWVzCiAgICAgICAgICAgIHdoZW4gNAogICAgICAgICAgICAgICAgQGFjdGlvbldpbmRvdy5hY3RpdmUgPSBubwogICAgICAgICAgICAgICAgQHBhcnR5V2luZG93LmFjdGl2ZSA9IG5vCiAgICAgICAgICAgICAgICBAc2F2ZVdpbmRvd3NldC5hY3RpdmUgPSB5ZXMKICAgICAgICAgICAgd2hlbiA1CiAgICAgICAgICAgICAgICBTY2VuZU1hbmFnZXIuc3dpdGNoVG8obmV3IFNjZW5lX0VuZEdhbWUoQGJhY2tncm91bmQpLCB5ZXMpCiAgICAKICAgIG9uQWN0aW9uQ2FuY2VsOiAtPgogICAgICAgIFNjZW5lTWFuYWdlci5zd2l0Y2hUbyhuZXcgU2NlbmVfTWFwKCkpCiAgICAgICAgCiAgICBvbkFjdGlvbkNoYW5nZTogLT4KICAgICAgICBAc3RhdHVzV2luZG93LnZpc2libGUgPSBAYWN0aW9uV2luZG93LnNlbGVjdGVkUm93ID09IDAKICAgICAgICBpZiBAc3RhdHVzV2luZG93LnZpc2libGUgdGhlbiBAc3RhdHVzV2luZG93LnJlZHJhdygpCiAgICAgICAgCiAgICAgICAgQGl0ZW1zV2luZG93c2V0LnNob3coQGFjdGlvbldpbmRvdy5zZWxlY3RlZFJvdyA9PSAxLCBubykKICAgICAgICBAZXF1aXBtZW50V2luZG93c2V0Lm1lbWJlciA9IEdhbWVNYW5hZ2VyLnBhcnR5Lm1lbWJlcnNbQHBhcnR5V2luZG93LnNlbGVjdGVkQ29sdW1uXQogICAgICAgIEBlcXVpcG1lbnRXaW5kb3dzZXQuc2hvdyhAYWN0aW9uV2luZG93LnNlbGVjdGVkUm93ID09IDMsIG5vKQogICAgICAgIAoKICAgICAgICBAc2F2ZVdpbmRvd3NldC5zaG93KEBhY3Rpb25XaW5kb3cuc2VsZWN0ZWRSb3cgPT0gNCBhbmQgR2FtZU1hbmFnZXIuc2F2ZU1lbnVBY2Nlc3MsIG5vKQogICAgICAgIAogICAgICAgIEBza2lsbHNXaW5kb3dzZXQubWVtYmVyID0gR2FtZU1hbmFnZXIucGFydHkubWVtYmVyc1tAcGFydHlXaW5kb3cuc2VsZWN0ZWRDb2x1bW5dCiAgICAgICAgQGl0ZW1zV2luZG93c2V0Lm1lbWJlciA9IEBwYXJ0eVdpbmRvdy5zZWxlY3RlZENlbGwKICAgICAgICAKICAgICAgICBpZiBAYWN0aW9uV2luZG93LnNlbGVjdGVkUm93ID09IDEgdGhlbiBAaXRlbXNXaW5kb3dzZXQucmVkcmF3KCkKICAgICAgICBpZiBAYWN0aW9uV2luZG93LnNlbGVjdGVkUm93ID09IDIgdGhlbiBAc2tpbGxzV2luZG93c2V0LnJlYnVpbGQoKQogICAgICAgIEBza2lsbHNXaW5kb3dzZXQuc2hvdyhAYWN0aW9uV2luZG93LnNlbGVjdGVkUm93ID09IDIsIG5vKQogICAgb25GaWxlU2VsZWN0aW9uOiAoc2xvdCkgLT4KICAgICAgICBHYW1lTWFuYWdlci5zYXZlKHNsb3QpCiAgICAgICAgQHNhdmVXaW5kb3dzZXQucmVkcmF3KCkKICAgICAgICBAYWN0aW9uV2luZG93LmFjdGl2ZSA9IHllcwogICAgICAgIEBwYXJ0eVdpbmRvdy5hY3RpdmUgPSB5ZXMKICAgICAgICBAc2F2ZVdpbmRvd3NldC5hY3RpdmUgPSBubwogICAgICAgIElucHV0LmNsZWFyKCkKICAgICAgICAKICAgIG9uRmlsZUNhbmNlbDogKHNsb3QpIC0+CiAgICAgICAgQGFjdGlvbldpbmRvdy5hY3RpdmUgPSB5ZXMKICAgICAgICBAcGFydHlXaW5kb3cuYWN0aXZlID0geWVzCiAgICAgICAgQHNhdmVXaW5kb3dzZXQuYWN0aXZlID0gbm8KICAgICAgICAKICAgIG9uSXRlbVNlbGVjdGlvbjogKGl0ZW0pIC0+CiAgICAgICAgaWYgaXRlbT8gYW5kIG5vdCBpdGVtLmVtcHR5CiAgICAgICAgICAgIEBpdGVtc1dpbmRvd3NldC5hY3RpdmUgPSBubwogICAgICAgICAgICBAdXNlRHJvcEFsZXJ0V2luZG93c2V0LnNob3dNb2RhbCgpCiAgICAgICAgCiAgICBvblNraWxsU2VsZWN0aW9uOiAoc2tpbGwpIC0+CiAgICAgICAgdXNlciA9IEBwYXJ0eVdpbmRvdy5zZWxlY3RlZENlbGwKICAgICAgICBAc2tpbGxzV2luZG93c2V0LmFjdGl2ZSA9IG5vCiAgICAgICAgQHBhcnR5V2luZG93LmFjdGl2ZSA9IHllcwogICAgICAgIEBwYXJ0eVdpbmRvdy5vblNlbGVjdGlvbkFjY2VwdCA9ID0+CiAgICAgICAgICAgIEBwYXJ0eVdpbmRvdy5yZWRyYXcoKQogICAgICAgICAgICBAc2tpbGxzV2luZG93c2V0LnJlZHJhdygpCiAgICAgICAgICAgIAogICAgICAgICAgICBpdGVtID0gQHNraWxsc1dpbmRvd3NldC5zZWxlY3RlZFNraWxsCiAgICAgICAgICAgIEB1c2VJdGVtKGl0ZW0sIHVzZXIpCiAgICAgICAgICAgIEBwYXJ0eVdpbmRvdy5yZWRyYXcoKQogICAgICAgICAgICBAc2tpbGxzV2luZG93c2V0LnJlZHJhdygpCgogICAgICAgIEBwYXJ0eVdpbmRvdy5vbkNhbmNlbCA9ID0+ICAKICAgICAgICAgICAgQHBhcnR5V2luZG93Lm9uU2VsZWN0aW9uQWNjZXB0ID0gbnVsbAogICAgICAgICAgICBAcGFydHlXaW5kb3cub25DYW5jZWwgPSBudWxsCiAgICAgICAgICAgIEBwYXJ0eVdpbmRvdy5hY3RpdmUgPSBubwogICAgICAgICAgICBAc2tpbGxzV2luZG93c2V0LmFjdGl2ZSA9IHllcwoKICAgIHVzZUl0ZW06IChpdGVtLCB1c2VyKSAtPgogICAgICAgIHN3aXRjaCBpdGVtLnNjb3BlCiAgICAgICAgICAgIHdoZW4gMCAjIE5vbmUgLyBPbmUgTWVtYmVyCiAgICAgICAgICAgICAgICB1c2VyLnVzZUl0ZW0oaXRlbSwgQHBhcnR5V2luZG93LnNlbGVjdGVkQ2VsbCkKICAgICAgICAgICAgd2hlbiA3ICMgT25lIE1lbWJlcgogICAgICAgICAgICAgICAgdXNlci51c2VJdGVtKGl0ZW0sIEBwYXJ0eVdpbmRvdy5zZWxlY3RlZENlbGwpCiAgICAgICAgICAgIHdoZW4gOCAjIEFsbCBNZW1iZXJzCiAgICAgICAgICAgICAgICBmb3IgbWVtYmVyIGluIEBwYXJ0eVdpbmRvdy5tZW1iZXJzCiAgICAgICAgICAgICAgICAgICAgdXNlci51c2VJdGVtKGl0ZW0sIG1lbWJlcikgaWYgbWVtYmVyLmlzQWxpdmUKICAgICAgICAgICAgd2hlbiA5ICMgT25lIE1lbWJlciAoRGVhZCkKICAgICAgICAgICAgICAgIGlmIG5vdCBAcGFydHlXaW5kb3cuc2VsZWN0ZWRDZWxsLmlzQWxpdmUKICAgICAgICAgICAgICAgICAgICB1c2VyLnVzZUl0ZW0oaXRlbSwgQHBhcnR5V2luZG93LnNlbGVjdGVkQ2VsbCkKICAgICAgICAgICAgd2hlbiAxMCAjIEFsbCBNZW1iZXJzIChEZWFkKQogICAgICAgICAgICAgICAgZm9yIG1lbWJlciBpbiBAcGFydHlXaW5kb3cubWVtYmVycwogICAgICAgICAgICAgICAgICAgIHVzZXIudXNlSXRlbShpdGVtLCBtZW1iZXIpIGlmIG5vdCBtZW1iZXIuaXNBbGl2ZQogICAgICAgICAgICB3aGVuIDExICMgVGhlIHVzZXIKICAgICAgICAgICAgICAgIHVzZXIudXNlSXRlbShpdGVtLCB1c2VyKQogICAgICAgICAgICAgICAgCiAgICBvblVzZURyb3BBbGVydEFjY2VwdDogKGNvZGUpIC0+CiAgICAgICAgc3dpdGNoIGNvZGUKICAgICAgICAgICAgd2hlbiAwICMgVXNlCiAgICAgICAgICAgICAgICB1c2VyID0gQHBhcnR5V2luZG93LnNlbGVjdGVkQ2VsbAogICAgICAgICAgICAgICAgQHBhcnR5V2luZG93LmFjdGl2ZSA9IHllcwogICAgICAgICAgICAgICAgQHBhcnR5V2luZG93Lm9uU2VsZWN0aW9uQWNjZXB0ID0gPT4KICAgICAgICAgICAgICAgICAgICBpdGVtID0gQGl0ZW1zV2luZG93c2V0LnNlbGVjdGVkSXRlbS5pdGVtCiAgICAgICAgICAgICAgICAgICAgQHVzZUl0ZW0oaXRlbSwgdXNlcikKICAgICAgICAgICAgICAgICAgICBAcGFydHlXaW5kb3cucmVkcmF3KCkKICAgICAgICAgICAgICAgICAgICBAaXRlbXNXaW5kb3dzZXQuc2VsZWN0ZWRJdGVtLmNvdW50LS0KICAgICAgICAgICAgICAgICAgICBAaXRlbXNXaW5kb3dzZXQucmVkcmF3KCkKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBpZiBAaXRlbXNXaW5kb3dzZXQuc2VsZWN0ZWRJdGVtLmNvdW50ID09IDAKICAgICAgICAgICAgICAgICAgICAgICAgQGl0ZW1zV2luZG93c2V0LnJlYnVpbGQoKQogICAgICAgICAgICAgICAgICAgICAgICBAcGFydHlXaW5kb3cub25DYW5jZWwoKQogICAgICAgICAgICAgICAgQHBhcnR5V2luZG93Lm9uQ2FuY2VsID0gPT4gIAogICAgICAgICAgICAgICAgICAgIEBwYXJ0eVdpbmRvdy5vblNlbGVjdGlvbkFjY2VwdCA9IG51bGwKICAgICAgICAgICAgICAgICAgICBAcGFydHlXaW5kb3cub25DYW5jZWwgPSBudWxsCiAgICAgICAgICAgICAgICAgICAgQHBhcnR5V2luZG93LmFjdGl2ZSA9IG5vCiAgICAgICAgICAgICAgICAgICAgQGl0ZW1zV2luZG93c2V0LmFjdGl2ZSA9IHllcwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICB3aGVuIDEgIyBEcm9wCiAgICAgICAgICAgICAgICBAYW1vdW50U2VsZWN0aW9uV2luZG93Lm1heFZhbHVlID0gQGl0ZW1zV2luZG93c2V0LnNlbGVjdGVkSXRlbS5jb3VudAogICAgICAgICAgICAgICAgQGFtb3VudFNlbGVjdGlvbldpbmRvdy52YWx1ZSA9IDEKICAgICAgICAgICAgICAgIEBhbW91bnRTZWxlY3Rpb25XaW5kb3cubm9Nb25leSA9IHllcwogICAgICAgICAgICAgICAgQGFtb3VudFNlbGVjdGlvbldpbmRvdy5hY3RpdmUgPSB5ZXMKICAgICAgICAgICAgICAgIEBhbW91bnRTZWxlY3Rpb25XaW5kb3cucmVkcmF3KCkKICAgICAgICAgICAgICAgIEBhbW91bnRTZWxlY3Rpb25XaW5kb3cub25BY2NlcHQgPSA9PgogICAgICAgICAgICAgICAgICAgIEBpdGVtc1dpbmRvd3NldC5zZWxlY3RlZEl0ZW0uY291bnQgLT0gQGFtb3VudFNlbGVjdGlvbldpbmRvdy5hbW91bnQKICAgICAgICAgICAgICAgICAgICBAaXRlbXNXaW5kb3dzZXQucmVidWlsZCgpCiAgICAgICAgICAgICAgICAgICAgQGl0ZW1zV2luZG93c2V0LmFjdGl2ZSA9IHllcwogICAgICAgICAgICAgICAgQGFtb3VudFNlbGVjdGlvbldpbmRvdy5vbkNhbmNlbCA9ID0+CiAgICAgICAgICAgICAgICAgICAgQGl0ZW1zV2luZG93c2V0LmFjdGl2ZSA9IHllcwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgQGFtb3VudFNlbGVjdGlvbldpbmRvdy5vcGVuKCkKICAgICAgICAgICAgICAgIAogICAgICAgIEBpdGVtc1dpbmRvd3NldC5jbGVhckRlc2NyaXB0aW9uKCkKICAgICAgICAgICAgICAgIAogICAgb25Vc2VEcm9wQWxlcnRDYW5jZWw6IC0+CiAgICAgICAgQGl0ZW1zV2luZG93c2V0LmFjdGl2ZSA9IHllcwogICAgICAgIAogICAgICAgIAoKCndpbmRvdy5TY2VuZV9NYWluTWVudSA9IFNjZW5lX01haW5NZW51","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBTY2VuZV9NYWluTWVudSwKICAgIF9faGFzUHJvcCA9IHt9Lmhhc093blByb3BlcnR5LAogICAgX19leHRlbmRzID0gZnVuY3Rpb24oY2hpbGQsIHBhcmVudCkgeyBmb3IgKHZhciBrZXkgaW4gcGFyZW50KSB7IGlmIChfX2hhc1Byb3AuY2FsbChwYXJlbnQsIGtleSkpIGNoaWxkW2tleV0gPSBwYXJlbnRba2V5XTsgfSBmdW5jdGlvbiBjdG9yKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gY2hpbGQ7IH0gY3Rvci5wcm90b3R5cGUgPSBwYXJlbnQucHJvdG90eXBlOyBjaGlsZC5wcm90b3R5cGUgPSBuZXcgY3RvcigpOyBjaGlsZC5fX3N1cGVyX18gPSBwYXJlbnQucHJvdG90eXBlOyByZXR1cm4gY2hpbGQ7IH07CgogIFNjZW5lX01haW5NZW51ID0gKGZ1bmN0aW9uKF9zdXBlcikgewogICAgX19leHRlbmRzKFNjZW5lX01haW5NZW51LCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFNjZW5lX01haW5NZW51KCkgewogICAgICBTY2VuZV9NYWluTWVudS5fX3N1cGVyX18uY29uc3RydWN0b3IuY2FsbCh0aGlzKTsKICAgIH0KCiAgICBTY2VuZV9NYWluTWVudS5wcm90b3R5cGUuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uKCkgewogICAgICB0aGlzLmJhY2tncm91bmQgPSBHcmFwaGljcy5zbmFwc2hvdCgpOwogICAgICB0aGlzLmJhY2tncm91bmQuZmlsbFJlY3QoMCwgMCwgdGhpcy5iYWNrZ3JvdW5kLndpZHRoLCB0aGlzLmJhY2tncm91bmQuaGVpZ2h0LCBuZXcgQ29sb3IoMCwgMCwgMCwgMC41KSk7CiAgICAgIHRoaXMudm9jYWIgPSBSZWNvcmRNYW5hZ2VyLnZvY2FidWxhcnk7CiAgICAgIHJldHVybiBHcmFwaGljcy5mcmVlemUoKTsKICAgIH07CgogICAgU2NlbmVfTWFpbk1lbnUucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbigpIHsKICAgICAgdGhpcy5zcHJpdGUuZGlzcG9zZSgpOwogICAgICB0aGlzLml0ZW1zV2luZG93c2V0LmRpc3Bvc2UoKTsKICAgICAgdGhpcy5lcXVpcG1lbnRXaW5kb3dzZXQuZGlzcG9zZSgpOwogICAgICB0aGlzLnNraWxsc1dpbmRvd3NldC5kaXNwb3NlKCk7CiAgICAgIHRoaXMuc2F2ZVdpbmRvd3NldC5kaXNwb3NlKCk7CiAgICAgIHRoaXMucGFydHlXaW5kb3cuZGlzcG9zZSgpOwogICAgICB0aGlzLnN0YXR1c1dpbmRvdy5kaXNwb3NlKCk7CiAgICAgIHRoaXMuYWN0aW9uV2luZG93LmRpc3Bvc2UoKTsKICAgICAgdGhpcy5nYW1lVGltZVdpbmRvdy5kaXNwb3NlKCk7CiAgICAgIHJldHVybiB0aGlzLm1vbmV5V2luZG93LmRpc3Bvc2UoKTsKICAgIH07CgogICAgU2NlbmVfTWFpbk1lbnUucHJvdG90eXBlLnNob3cgPSBmdW5jdGlvbih2aXNpYmxlKSB7CiAgICAgIHRoaXMuc3ByaXRlLnZpc2libGUgPSB2aXNpYmxlOwogICAgICB0aGlzLml0ZW1zV2luZG93c2V0LnZpc2libGUgPSB2aXNpYmxlOwogICAgICB0aGlzLmVxdWlwbWVudFdpbmRvd3NldC52aXNpYmxlID0gdmlzaWJsZTsKICAgICAgdGhpcy5za2lsbHNXaW5kb3dzZXQudmlzaWJsZSA9IHZpc2libGU7CiAgICAgIHRoaXMuc2F2ZVdpbmRvd3NldC52aXNpYmxlID0gdmlzaWJsZTsKICAgICAgdGhpcy5wYXJ0eVdpbmRvdy52aXNpYmxlID0gdmlzaWJsZTsKICAgICAgdGhpcy5zdGF0dXNXaW5kb3cudmlzaWJsZSA9IHZpc2libGU7CiAgICAgIHRoaXMuYWN0aW9uV2luZG93LnZpc2libGUgPSB2aXNpYmxlOwogICAgICB0aGlzLmdhbWVUaW1lV2luZG93LnZpc2libGUgPSB2aXNpYmxlOwogICAgICByZXR1cm4gdGhpcy5tb25leVdpbmRvdy52aXNpYmxlID0gdmlzaWJsZTsKICAgIH07CgogICAgU2NlbmVfTWFpbk1lbnUucHJvdG90eXBlLnByZXBhcmVEYXRhID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBzY2FsZSwKICAgICAgICBfdGhpcyA9IHRoaXM7CiAgICAgIHNjYWxlID0gV2luZG93X0Jhc2Uuc2NhbGU7CiAgICAgIHRoaXMuc3ByaXRlID0gbmV3IFNwcml0ZTsKICAgICAgdGhpcy5zcHJpdGUuYml0bWFwID0gdGhpcy5iYWNrZ3JvdW5kOwogICAgICB0aGlzLnNwcml0ZS5zcmNSZWN0ID0gbmV3IFJlY3QoMCwgMCwgR3JhcGhpY3Mud2lkdGgsIEdyYXBoaWNzLmhlaWdodCk7CiAgICAgIHRoaXMuc3ByaXRlLnogPSAtMTsKICAgICAgdGhpcy5wYXJ0eVdpbmRvdyA9IG5ldyBXaW5kb3dfUGFydHkoKTsKICAgICAgdGhpcy5wYXJ0eVdpbmRvdy5vblNlbGVjdGlvbkNoYW5nZSA9IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBfdGhpcy5vblBhcnR5TWVtYmVyQ2hhbmdlKCk7CiAgICAgIH07CiAgICAgIHRoaXMucGFydHlXaW5kb3cueiA9IDA7CiAgICAgIHRoaXMuYWN0aW9uV2luZG93ID0gbmV3IFdpbmRvd19TZWxlY3Rpb24oMCwgdGhpcy5wYXJ0eVdpbmRvdy5oZWlnaHQsIDEsIFtbbGNzKHRoaXMudm9jYWIubWVudS5zdGF0dXMpXSwgW2xjcyh0aGlzLnZvY2FiLm1lbnUuaXRlbXMpXSwgW2xjcyh0aGlzLnZvY2FiLm1lbnUuc2tpbGxzKV0sIFtsY3ModGhpcy52b2NhYi5tZW51LmVxdWlwbWVudCldLCBbbGNzKHRoaXMudm9jYWIubWVudS5zYXZlKV0sIFtsY3ModGhpcy52b2NhYi5tZW51LmVuZEdhbWUpXV0sIDE1MCAqIHNjYWxlLCAzMiAqIHNjYWxlKTsKICAgICAgdGhpcy5hY3Rpb25XaW5kb3cudmFsaWRhdGVDZWxsID0gZnVuY3Rpb24oeCwgeSwgY2VsbCkgewogICAgICAgIGlmICh5ID09PSA0KSB7CiAgICAgICAgICByZXR1cm4gR2FtZU1hbmFnZXIuc2F2ZU1lbnVBY2Nlc3M7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgfTsKICAgICAgdGhpcy5hY3Rpb25XaW5kb3cub25TZWxlY3Rpb25DaGFuZ2UgPSBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gX3RoaXMub25BY3Rpb25DaGFuZ2UoKTsKICAgICAgfTsKICAgICAgdGhpcy5hY3Rpb25XaW5kb3cub25TZWxlY3Rpb25BY2NlcHQgPSBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gX3RoaXMub25BY3Rpb24oKTsKICAgICAgfTsKICAgICAgdGhpcy5hY3Rpb25XaW5kb3cub25DYW5jZWwgPSBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gX3RoaXMub25BY3Rpb25DYW5jZWwoKTsKICAgICAgfTsKICAgICAgdGhpcy5hY3Rpb25XaW5kb3cudGV4dEFsaWdubWVudCA9IDA7CiAgICAgIHRoaXMuaXRlbXNXaW5kb3dzZXQgPSBuZXcgV2luZG93c2V0X0l0ZW1zKHRoaXMuYWN0aW9uV2luZG93LnggKyB0aGlzLmFjdGlvbldpbmRvdy53aWR0aCwgMTE0ICogc2NhbGUsIG51bGwsIEdyYXBoaWNzLndpZHRoIC0gdGhpcy5hY3Rpb25XaW5kb3cud2lkdGgpOwogICAgICB0aGlzLml0ZW1zV2luZG93c2V0LnNob3coZmFsc2UpOwogICAgICB0aGlzLml0ZW1zV2luZG93c2V0Lm9uSXRlbVNlbGVjdGlvbiA9IGZ1bmN0aW9uKGl0ZW0pIHsKICAgICAgICByZXR1cm4gX3RoaXMub25JdGVtU2VsZWN0aW9uKGl0ZW0pOwogICAgICB9OwogICAgICB0aGlzLml0ZW1zV2luZG93c2V0Lm9uQ2FuY2VsID0gZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIF90aGlzLm9uU3ViTWVudUNhbmNlbCgpOwogICAgICB9OwogICAgICB0aGlzLmVxdWlwbWVudFdpbmRvd3NldCA9IG5ldyBXaW5kb3dzZXRfRXF1aXBtZW50KHRoaXMuYWN0aW9uV2luZG93LnggKyB0aGlzLmFjdGlvbldpbmRvdy53aWR0aCwgMTE0ICogc2NhbGUpOwogICAgICB0aGlzLmVxdWlwbWVudFdpbmRvd3NldC5zaG93KGZhbHNlKTsKICAgICAgdGhpcy5lcXVpcG1lbnRXaW5kb3dzZXQub25DYW5jZWwgPSBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gX3RoaXMub25TdWJNZW51Q2FuY2VsKCk7CiAgICAgIH07CiAgICAgIHRoaXMuZXF1aXBtZW50V2luZG93c2V0Lm9uRXF1aXBtZW50Q2hhbmdlID0gZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIF90aGlzLnBhcnR5V2luZG93LnJlZHJhdygpOwogICAgICB9OwogICAgICB0aGlzLnNraWxsc1dpbmRvd3NldCA9IG5ldyBXaW5kb3dzZXRfU2tpbGxzKHRoaXMuYWN0aW9uV2luZG93LnggKyB0aGlzLmFjdGlvbldpbmRvdy53aWR0aCwgMTE0ICogc2NhbGUsIG51bGwsIEdyYXBoaWNzLndpZHRoIC0gdGhpcy5hY3Rpb25XaW5kb3cud2lkdGgpOwogICAgICB0aGlzLnNraWxsc1dpbmRvd3NldC5zaG93KGZhbHNlKTsKICAgICAgdGhpcy5za2lsbHNXaW5kb3dzZXQub25Ta2lsbFNlbGVjdGlvbiA9IGZ1bmN0aW9uKHNraWxsKSB7CiAgICAgICAgcmV0dXJuIF90aGlzLm9uU2tpbGxTZWxlY3Rpb24oc2tpbGwpOwogICAgICB9OwogICAgICB0aGlzLnNraWxsc1dpbmRvd3NldC5vbkNhbmNlbCA9IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBfdGhpcy5vblN1Yk1lbnVDYW5jZWwoKTsKICAgICAgfTsKICAgICAgdGhpcy51c2VEcm9wQWxlcnRXaW5kb3dzZXQgPSBuZXcgV2luZG93c2V0X0FsZXJ0KCJXaGF0IGRvIHlvdSB3YW50IHRvIGRvPyIsIFsiVXNlIiwgIkRyb3AiXSk7CiAgICAgIHRoaXMudXNlRHJvcEFsZXJ0V2luZG93c2V0LnNob3coZmFsc2UpOwogICAgICB0aGlzLnVzZURyb3BBbGVydFdpbmRvd3NldC5vbkFjY2VwdCA9IGZ1bmN0aW9uKHNlbmRlciwgY29kZSkgewogICAgICAgIHJldHVybiBfdGhpcy5vblVzZURyb3BBbGVydEFjY2VwdChjb2RlKTsKICAgICAgfTsKICAgICAgdGhpcy51c2VEcm9wQWxlcnRXaW5kb3dzZXQub25DYW5jZWwgPSBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gX3RoaXMub25Vc2VEcm9wQWxlcnRDYW5jZWwoKTsKICAgICAgfTsKICAgICAgdGhpcy5hbW91bnRTZWxlY3Rpb25XaW5kb3cgPSBuZXcgV2luZG93X0Ftb3VudFNlbGVjdGlvbigpOwogICAgICB0aGlzLmFtb3VudFNlbGVjdGlvbldpbmRvdy52aXNpYmxlID0gZmFsc2U7CiAgICAgIHRoaXMuc2F2ZVdpbmRvd3NldCA9IG5ldyBXaW5kb3dzZXRfU2F2ZSgxNzQgKiBzY2FsZSwgdGhpcy5wYXJ0eVdpbmRvdy5oZWlnaHQpOwogICAgICB0aGlzLnNhdmVXaW5kb3dzZXQub25GaWxlU2VsZWN0aW9uID0gZnVuY3Rpb24oc2xvdCkgewogICAgICAgIHJldHVybiBfdGhpcy5vbkZpbGVTZWxlY3Rpb24oc2xvdCk7CiAgICAgIH07CiAgICAgIHRoaXMuc2F2ZVdpbmRvd3NldC5vbkNhbmNlbCA9IGZ1bmN0aW9uKHNsb3QpIHsKICAgICAgICByZXR1cm4gX3RoaXMub25GaWxlQ2FuY2VsKHNsb3QpOwogICAgICB9OwogICAgICB0aGlzLnNhdmVXaW5kb3dzZXQuc2hvdyhmYWxzZSk7CiAgICAgIHRoaXMuc3RhdHVzV2luZG93ID0gbmV3IFdpbmRvd19TdGF0dXMoKTsKICAgICAgdGhpcy5nYW1lVGltZVdpbmRvdyA9IG5ldyBXaW5kb3dfR2FtZVRpbWUoMCwgMCk7CiAgICAgIHRoaXMuZ2FtZVRpbWVXaW5kb3cueSA9IEdyYXBoaWNzLmhlaWdodCAtIHRoaXMuZ2FtZVRpbWVXaW5kb3cuaGVpZ2h0OwogICAgICB0aGlzLmdhbWVUaW1lV2luZG93LnJlZHJhdygpOwogICAgICB0aGlzLm1vbmV5V2luZG93ID0gbmV3IFdpbmRvd19Nb25leSgwLCAwKTsKICAgICAgdGhpcy5tb25leVdpbmRvdy55ID0gdGhpcy5nYW1lVGltZVdpbmRvdy55IC0gdGhpcy5tb25leVdpbmRvdy5oZWlnaHQ7CiAgICAgIHRoaXMubW9uZXlXaW5kb3cucmVkcmF3KCk7CiAgICAgIHRoaXMuYWN0aW9uV2luZG93LnJlZHJhdygpOwogICAgICB0aGlzLnBhcnR5V2luZG93LnByZXBhcmUoKTsKICAgICAgcmV0dXJuIHRoaXMucGFydHlXaW5kb3cucmVkcmF3KCk7CiAgICB9OwoKICAgIFNjZW5lX01haW5NZW51LnByb3RvdHlwZS5wcmVwYXJlVmlzdWFsID0gZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMudXBkYXRlKCk7CiAgICAgIHJldHVybiBHcmFwaGljcy50cmFuc2l0aW9uKDIwKTsKICAgIH07CgogICAgU2NlbmVfTWFpbk1lbnUucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkgewogICAgICB0aGlzLml0ZW1zV2luZG93c2V0LnVwZGF0ZSgpOwogICAgICB0aGlzLmVxdWlwbWVudFdpbmRvd3NldC51cGRhdGUoKTsKICAgICAgdGhpcy5za2lsbHNXaW5kb3dzZXQudXBkYXRlKCk7CiAgICAgIHRoaXMuc2F2ZVdpbmRvd3NldC51cGRhdGUoKTsKICAgICAgdGhpcy5zdGF0dXNXaW5kb3cudXBkYXRlKCk7CiAgICAgIHRoaXMucGFydHlXaW5kb3cudXBkYXRlKCk7CiAgICAgIHRoaXMuYWN0aW9uV2luZG93LnVwZGF0ZSgpOwogICAgICB0aGlzLnVzZURyb3BBbGVydFdpbmRvd3NldC51cGRhdGUoKTsKICAgICAgdGhpcy5hbW91bnRTZWxlY3Rpb25XaW5kb3cudXBkYXRlKCk7CiAgICAgIHJldHVybiBTY2VuZV9NYWluTWVudS5fX3N1cGVyX18udXBkYXRlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICB9OwoKICAgIFNjZW5lX01haW5NZW51LnByb3RvdHlwZS5vblBhcnR5TWVtYmVyQ2hhbmdlID0gZnVuY3Rpb24oKSB7CiAgICAgIHN3aXRjaCAodGhpcy5hY3Rpb25XaW5kb3cuc2VsZWN0ZWRSb3cpIHsKICAgICAgICBjYXNlIDA6CiAgICAgICAgICB0aGlzLnN0YXR1c1dpbmRvdy5tZW1iZXIgPSBHYW1lTWFuYWdlci5wYXJ0eS5tZW1iZXJzW3RoaXMucGFydHlXaW5kb3cuc2VsZWN0ZWRDb2x1bW5dOwogICAgICAgICAgcmV0dXJuIHRoaXMuc3RhdHVzV2luZG93LnJlZHJhdygpOwogICAgICAgIGNhc2UgMToKICAgICAgICAgIHRoaXMuaXRlbXNXaW5kb3dzZXQubWVtYmVyID0gdGhpcy5wYXJ0eVdpbmRvdy5zZWxlY3RlZENlbGw7CiAgICAgICAgICByZXR1cm4gdGhpcy5pdGVtc1dpbmRvd3NldC5yZWRyYXcoKTsKICAgICAgICBjYXNlIDI6CiAgICAgICAgICB0aGlzLnNraWxsc1dpbmRvd3NldC5tZW1iZXIgPSBHYW1lTWFuYWdlci5wYXJ0eS5tZW1iZXJzW3RoaXMucGFydHlXaW5kb3cuc2VsZWN0ZWRDb2x1bW5dOwogICAgICAgICAgdGhpcy5za2lsbHNXaW5kb3dzZXQucmVidWlsZCgpOwogICAgICAgICAgcmV0dXJuIHRoaXMuc2tpbGxzV2luZG93c2V0LnJlZHJhdygpOwogICAgICAgIGNhc2UgMzoKICAgICAgICAgIHRoaXMuZXF1aXBtZW50V2luZG93c2V0Lm1lbWJlciA9IEdhbWVNYW5hZ2VyLnBhcnR5Lm1lbWJlcnNbdGhpcy5wYXJ0eVdpbmRvdy5zZWxlY3RlZENvbHVtbl07CiAgICAgICAgICByZXR1cm4gdGhpcy5lcXVpcG1lbnRXaW5kb3dzZXQucmVkcmF3KCk7CiAgICAgIH0KICAgIH07CgogICAgU2NlbmVfTWFpbk1lbnUucHJvdG90eXBlLm9uU3ViTWVudUNhbmNlbCA9IGZ1bmN0aW9uKCkgewogICAgICBzd2l0Y2ggKHRoaXMuYWN0aW9uV2luZG93LnNlbGVjdGVkUm93KSB7CiAgICAgICAgY2FzZSAxOgogICAgICAgICAgdGhpcy5hY3Rpb25XaW5kb3cuYWN0aXZlID0gdHJ1ZTsKICAgICAgICAgIHRoaXMucGFydHlXaW5kb3cuYWN0aXZlID0gdHJ1ZTsKICAgICAgICAgIHJldHVybiB0aGlzLml0ZW1zV2luZG93c2V0LmFjdGl2ZSA9IGZhbHNlOwogICAgICAgIGNhc2UgMjoKICAgICAgICAgIHRoaXMuYWN0aW9uV2luZG93LmFjdGl2ZSA9IHRydWU7CiAgICAgICAgICB0aGlzLnBhcnR5V2luZG93LmFjdGl2ZSA9IHRydWU7CiAgICAgICAgICByZXR1cm4gdGhpcy5za2lsbHNXaW5kb3dzZXQuYWN0aXZlID0gZmFsc2U7CiAgICAgICAgY2FzZSAzOgogICAgICAgICAgdGhpcy5hY3Rpb25XaW5kb3cuYWN0aXZlID0gdHJ1ZTsKICAgICAgICAgIHRoaXMucGFydHlXaW5kb3cuYWN0aXZlID0gdHJ1ZTsKICAgICAgICAgIHJldHVybiB0aGlzLmVxdWlwbWVudFdpbmRvd3NldC5hY3RpdmUgPSBmYWxzZTsKICAgICAgICBjYXNlIDQ6CiAgICAgICAgICB0aGlzLmFjdGlvbldpbmRvdy5hY3RpdmUgPSB0cnVlOwogICAgICAgICAgdGhpcy5wYXJ0eVdpbmRvdy5hY3RpdmUgPSB0cnVlOwogICAgICAgICAgcmV0dXJuIHRoaXMuc2F2ZVdpbmRvd3NldC5hY3RpdmUgPSBmYWxzZTsKICAgICAgfQogICAgfTsKCiAgICBTY2VuZV9NYWluTWVudS5wcm90b3R5cGUub25BY3Rpb24gPSBmdW5jdGlvbigpIHsKICAgICAgc3dpdGNoICh0aGlzLmFjdGlvbldpbmRvdy5zZWxlY3RlZFJvdykgewogICAgICAgIGNhc2UgMToKICAgICAgICAgIHRoaXMuYWN0aW9uV2luZG93LmFjdGl2ZSA9IGZhbHNlOwogICAgICAgICAgdGhpcy5wYXJ0eVdpbmRvdy5hY3RpdmUgPSBmYWxzZTsKICAgICAgICAgIHJldHVybiB0aGlzLml0ZW1zV2luZG93c2V0LmFjdGl2ZSA9IHRydWU7CiAgICAgICAgY2FzZSAyOgogICAgICAgICAgdGhpcy5hY3Rpb25XaW5kb3cuYWN0aXZlID0gZmFsc2U7CiAgICAgICAgICB0aGlzLnBhcnR5V2luZG93LmFjdGl2ZSA9IGZhbHNlOwogICAgICAgICAgcmV0dXJuIHRoaXMuc2tpbGxzV2luZG93c2V0LmFjdGl2ZSA9IHRydWU7CiAgICAgICAgY2FzZSAzOgogICAgICAgICAgdGhpcy5hY3Rpb25XaW5kb3cuYWN0aXZlID0gZmFsc2U7CiAgICAgICAgICB0aGlzLnBhcnR5V2luZG93LmFjdGl2ZSA9IGZhbHNlOwogICAgICAgICAgcmV0dXJuIHRoaXMuZXF1aXBtZW50V2luZG93c2V0LmFjdGl2ZSA9IHRydWU7CiAgICAgICAgY2FzZSA0OgogICAgICAgICAgdGhpcy5hY3Rpb25XaW5kb3cuYWN0aXZlID0gZmFsc2U7CiAgICAgICAgICB0aGlzLnBhcnR5V2luZG93LmFjdGl2ZSA9IGZhbHNlOwogICAgICAgICAgcmV0dXJuIHRoaXMuc2F2ZVdpbmRvd3NldC5hY3RpdmUgPSB0cnVlOwogICAgICAgIGNhc2UgNToKICAgICAgICAgIHJldHVybiBTY2VuZU1hbmFnZXIuc3dpdGNoVG8obmV3IFNjZW5lX0VuZEdhbWUodGhpcy5iYWNrZ3JvdW5kKSwgdHJ1ZSk7CiAgICAgIH0KICAgIH07CgogICAgU2NlbmVfTWFpbk1lbnUucHJvdG90eXBlLm9uQWN0aW9uQ2FuY2VsID0gZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiBTY2VuZU1hbmFnZXIuc3dpdGNoVG8obmV3IFNjZW5lX01hcCgpKTsKICAgIH07CgogICAgU2NlbmVfTWFpbk1lbnUucHJvdG90eXBlLm9uQWN0aW9uQ2hhbmdlID0gZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMuc3RhdHVzV2luZG93LnZpc2libGUgPSB0aGlzLmFjdGlvbldpbmRvdy5zZWxlY3RlZFJvdyA9PT0gMDsKICAgICAgaWYgKHRoaXMuc3RhdHVzV2luZG93LnZpc2libGUpIHsKICAgICAgICB0aGlzLnN0YXR1c1dpbmRvdy5yZWRyYXcoKTsKICAgICAgfQogICAgICB0aGlzLml0ZW1zV2luZG93c2V0LnNob3codGhpcy5hY3Rpb25XaW5kb3cuc2VsZWN0ZWRSb3cgPT09IDEsIGZhbHNlKTsKICAgICAgdGhpcy5lcXVpcG1lbnRXaW5kb3dzZXQubWVtYmVyID0gR2FtZU1hbmFnZXIucGFydHkubWVtYmVyc1t0aGlzLnBhcnR5V2luZG93LnNlbGVjdGVkQ29sdW1uXTsKICAgICAgdGhpcy5lcXVpcG1lbnRXaW5kb3dzZXQuc2hvdyh0aGlzLmFjdGlvbldpbmRvdy5zZWxlY3RlZFJvdyA9PT0gMywgZmFsc2UpOwogICAgICB0aGlzLnNhdmVXaW5kb3dzZXQuc2hvdyh0aGlzLmFjdGlvbldpbmRvdy5zZWxlY3RlZFJvdyA9PT0gNCAmJiBHYW1lTWFuYWdlci5zYXZlTWVudUFjY2VzcywgZmFsc2UpOwogICAgICB0aGlzLnNraWxsc1dpbmRvd3NldC5tZW1iZXIgPSBHYW1lTWFuYWdlci5wYXJ0eS5tZW1iZXJzW3RoaXMucGFydHlXaW5kb3cuc2VsZWN0ZWRDb2x1bW5dOwogICAgICB0aGlzLml0ZW1zV2luZG93c2V0Lm1lbWJlciA9IHRoaXMucGFydHlXaW5kb3cuc2VsZWN0ZWRDZWxsOwogICAgICBpZiAodGhpcy5hY3Rpb25XaW5kb3cuc2VsZWN0ZWRSb3cgPT09IDEpIHsKICAgICAgICB0aGlzLml0ZW1zV2luZG93c2V0LnJlZHJhdygpOwogICAgICB9CiAgICAgIGlmICh0aGlzLmFjdGlvbldpbmRvdy5zZWxlY3RlZFJvdyA9PT0gMikgewogICAgICAgIHRoaXMuc2tpbGxzV2luZG93c2V0LnJlYnVpbGQoKTsKICAgICAgfQogICAgICByZXR1cm4gdGhpcy5za2lsbHNXaW5kb3dzZXQuc2hvdyh0aGlzLmFjdGlvbldpbmRvdy5zZWxlY3RlZFJvdyA9PT0gMiwgZmFsc2UpOwogICAgfTsKCiAgICBTY2VuZV9NYWluTWVudS5wcm90b3R5cGUub25GaWxlU2VsZWN0aW9uID0gZnVuY3Rpb24oc2xvdCkgewogICAgICBHYW1lTWFuYWdlci5zYXZlKHNsb3QpOwogICAgICB0aGlzLnNhdmVXaW5kb3dzZXQucmVkcmF3KCk7CiAgICAgIHRoaXMuYWN0aW9uV2luZG93LmFjdGl2ZSA9IHRydWU7CiAgICAgIHRoaXMucGFydHlXaW5kb3cuYWN0aXZlID0gdHJ1ZTsKICAgICAgdGhpcy5zYXZlV2luZG93c2V0LmFjdGl2ZSA9IGZhbHNlOwogICAgICByZXR1cm4gSW5wdXQuY2xlYXIoKTsKICAgIH07CgogICAgU2NlbmVfTWFpbk1lbnUucHJvdG90eXBlLm9uRmlsZUNhbmNlbCA9IGZ1bmN0aW9uKHNsb3QpIHsKICAgICAgdGhpcy5hY3Rpb25XaW5kb3cuYWN0aXZlID0gdHJ1ZTsKICAgICAgdGhpcy5wYXJ0eVdpbmRvdy5hY3RpdmUgPSB0cnVlOwogICAgICByZXR1cm4gdGhpcy5zYXZlV2luZG93c2V0LmFjdGl2ZSA9IGZhbHNlOwogICAgfTsKCiAgICBTY2VuZV9NYWluTWVudS5wcm90b3R5cGUub25JdGVtU2VsZWN0aW9uID0gZnVuY3Rpb24oaXRlbSkgewogICAgICBpZiAoKGl0ZW0gIT0gbnVsbCkgJiYgIWl0ZW0uZW1wdHkpIHsKICAgICAgICB0aGlzLml0ZW1zV2luZG93c2V0LmFjdGl2ZSA9IGZhbHNlOwogICAgICAgIHJldHVybiB0aGlzLnVzZURyb3BBbGVydFdpbmRvd3NldC5zaG93TW9kYWwoKTsKICAgICAgfQogICAgfTsKCiAgICBTY2VuZV9NYWluTWVudS5wcm90b3R5cGUub25Ta2lsbFNlbGVjdGlvbiA9IGZ1bmN0aW9uKHNraWxsKSB7CiAgICAgIHZhciB1c2VyLAogICAgICAgIF90aGlzID0gdGhpczsKICAgICAgdXNlciA9IHRoaXMucGFydHlXaW5kb3cuc2VsZWN0ZWRDZWxsOwogICAgICB0aGlzLnNraWxsc1dpbmRvd3NldC5hY3RpdmUgPSBmYWxzZTsKICAgICAgdGhpcy5wYXJ0eVdpbmRvdy5hY3RpdmUgPSB0cnVlOwogICAgICB0aGlzLnBhcnR5V2luZG93Lm9uU2VsZWN0aW9uQWNjZXB0ID0gZnVuY3Rpb24oKSB7CiAgICAgICAgdmFyIGl0ZW07CiAgICAgICAgX3RoaXMucGFydHlXaW5kb3cucmVkcmF3KCk7CiAgICAgICAgX3RoaXMuc2tpbGxzV2luZG93c2V0LnJlZHJhdygpOwogICAgICAgIGl0ZW0gPSBfdGhpcy5za2lsbHNXaW5kb3dzZXQuc2VsZWN0ZWRTa2lsbDsKICAgICAgICBfdGhpcy51c2VJdGVtKGl0ZW0sIHVzZXIpOwogICAgICAgIF90aGlzLnBhcnR5V2luZG93LnJlZHJhdygpOwogICAgICAgIHJldHVybiBfdGhpcy5za2lsbHNXaW5kb3dzZXQucmVkcmF3KCk7CiAgICAgIH07CiAgICAgIHJldHVybiB0aGlzLnBhcnR5V2luZG93Lm9uQ2FuY2VsID0gZnVuY3Rpb24oKSB7CiAgICAgICAgX3RoaXMucGFydHlXaW5kb3cub25TZWxlY3Rpb25BY2NlcHQgPSBudWxsOwogICAgICAgIF90aGlzLnBhcnR5V2luZG93Lm9uQ2FuY2VsID0gbnVsbDsKICAgICAgICBfdGhpcy5wYXJ0eVdpbmRvdy5hY3RpdmUgPSBmYWxzZTsKICAgICAgICByZXR1cm4gX3RoaXMuc2tpbGxzV2luZG93c2V0LmFjdGl2ZSA9IHRydWU7CiAgICAgIH07CiAgICB9OwoKICAgIFNjZW5lX01haW5NZW51LnByb3RvdHlwZS51c2VJdGVtID0gZnVuY3Rpb24oaXRlbSwgdXNlcikgewogICAgICB2YXIgbWVtYmVyLCBfaSwgX2osIF9sZW4sIF9sZW4xLCBfcmVmLCBfcmVmMSwgX3Jlc3VsdHMsIF9yZXN1bHRzMTsKICAgICAgc3dpdGNoIChpdGVtLnNjb3BlKSB7CiAgICAgICAgY2FzZSAwOgogICAgICAgICAgcmV0dXJuIHVzZXIudXNlSXRlbShpdGVtLCB0aGlzLnBhcnR5V2luZG93LnNlbGVjdGVkQ2VsbCk7CiAgICAgICAgY2FzZSA3OgogICAgICAgICAgcmV0dXJuIHVzZXIudXNlSXRlbShpdGVtLCB0aGlzLnBhcnR5V2luZG93LnNlbGVjdGVkQ2VsbCk7CiAgICAgICAgY2FzZSA4OgogICAgICAgICAgX3JlZiA9IHRoaXMucGFydHlXaW5kb3cubWVtYmVyczsKICAgICAgICAgIF9yZXN1bHRzID0gW107CiAgICAgICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICAgICAgbWVtYmVyID0gX3JlZltfaV07CiAgICAgICAgICAgIGlmIChtZW1iZXIuaXNBbGl2ZSkgewogICAgICAgICAgICAgIF9yZXN1bHRzLnB1c2godXNlci51c2VJdGVtKGl0ZW0sIG1lbWJlcikpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIF9yZXN1bHRzLnB1c2godm9pZCAwKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuIF9yZXN1bHRzOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSA5OgogICAgICAgICAgaWYgKCF0aGlzLnBhcnR5V2luZG93LnNlbGVjdGVkQ2VsbC5pc0FsaXZlKSB7CiAgICAgICAgICAgIHJldHVybiB1c2VyLnVzZUl0ZW0oaXRlbSwgdGhpcy5wYXJ0eVdpbmRvdy5zZWxlY3RlZENlbGwpOwogICAgICAgICAgfQogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAxMDoKICAgICAgICAgIF9yZWYxID0gdGhpcy5wYXJ0eVdpbmRvdy5tZW1iZXJzOwogICAgICAgICAgX3Jlc3VsdHMxID0gW107CiAgICAgICAgICBmb3IgKF9qID0gMCwgX2xlbjEgPSBfcmVmMS5sZW5ndGg7IF9qIDwgX2xlbjE7IF9qKyspIHsKICAgICAgICAgICAgbWVtYmVyID0gX3JlZjFbX2pdOwogICAgICAgICAgICBpZiAoIW1lbWJlci5pc0FsaXZlKSB7CiAgICAgICAgICAgICAgX3Jlc3VsdHMxLnB1c2godXNlci51c2VJdGVtKGl0ZW0sIG1lbWJlcikpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIF9yZXN1bHRzMS5wdXNoKHZvaWQgMCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBfcmVzdWx0czE7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDExOgogICAgICAgICAgcmV0dXJuIHVzZXIudXNlSXRlbShpdGVtLCB1c2VyKTsKICAgICAgfQogICAgfTsKCiAgICBTY2VuZV9NYWluTWVudS5wcm90b3R5cGUub25Vc2VEcm9wQWxlcnRBY2NlcHQgPSBmdW5jdGlvbihjb2RlKSB7CiAgICAgIHZhciB1c2VyLAogICAgICAgIF90aGlzID0gdGhpczsKICAgICAgc3dpdGNoIChjb2RlKSB7CiAgICAgICAgY2FzZSAwOgogICAgICAgICAgdXNlciA9IHRoaXMucGFydHlXaW5kb3cuc2VsZWN0ZWRDZWxsOwogICAgICAgICAgdGhpcy5wYXJ0eVdpbmRvdy5hY3RpdmUgPSB0cnVlOwogICAgICAgICAgdGhpcy5wYXJ0eVdpbmRvdy5vblNlbGVjdGlvbkFjY2VwdCA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICB2YXIgaXRlbTsKICAgICAgICAgICAgaXRlbSA9IF90aGlzLml0ZW1zV2luZG93c2V0LnNlbGVjdGVkSXRlbS5pdGVtOwogICAgICAgICAgICBfdGhpcy51c2VJdGVtKGl0ZW0sIHVzZXIpOwogICAgICAgICAgICBfdGhpcy5wYXJ0eVdpbmRvdy5yZWRyYXcoKTsKICAgICAgICAgICAgX3RoaXMuaXRlbXNXaW5kb3dzZXQuc2VsZWN0ZWRJdGVtLmNvdW50LS07CiAgICAgICAgICAgIF90aGlzLml0ZW1zV2luZG93c2V0LnJlZHJhdygpOwogICAgICAgICAgICBpZiAoX3RoaXMuaXRlbXNXaW5kb3dzZXQuc2VsZWN0ZWRJdGVtLmNvdW50ID09PSAwKSB7CiAgICAgICAgICAgICAgX3RoaXMuaXRlbXNXaW5kb3dzZXQucmVidWlsZCgpOwogICAgICAgICAgICAgIHJldHVybiBfdGhpcy5wYXJ0eVdpbmRvdy5vbkNhbmNlbCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9OwogICAgICAgICAgdGhpcy5wYXJ0eVdpbmRvdy5vbkNhbmNlbCA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICBfdGhpcy5wYXJ0eVdpbmRvdy5vblNlbGVjdGlvbkFjY2VwdCA9IG51bGw7CiAgICAgICAgICAgIF90aGlzLnBhcnR5V2luZG93Lm9uQ2FuY2VsID0gbnVsbDsKICAgICAgICAgICAgX3RoaXMucGFydHlXaW5kb3cuYWN0aXZlID0gZmFsc2U7CiAgICAgICAgICAgIHJldHVybiBfdGhpcy5pdGVtc1dpbmRvd3NldC5hY3RpdmUgPSB0cnVlOwogICAgICAgICAgfTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgMToKICAgICAgICAgIHRoaXMuYW1vdW50U2VsZWN0aW9uV2luZG93Lm1heFZhbHVlID0gdGhpcy5pdGVtc1dpbmRvd3NldC5zZWxlY3RlZEl0ZW0uY291bnQ7CiAgICAgICAgICB0aGlzLmFtb3VudFNlbGVjdGlvbldpbmRvdy52YWx1ZSA9IDE7CiAgICAgICAgICB0aGlzLmFtb3VudFNlbGVjdGlvbldpbmRvdy5ub01vbmV5ID0gdHJ1ZTsKICAgICAgICAgIHRoaXMuYW1vdW50U2VsZWN0aW9uV2luZG93LmFjdGl2ZSA9IHRydWU7CiAgICAgICAgICB0aGlzLmFtb3VudFNlbGVjdGlvbldpbmRvdy5yZWRyYXcoKTsKICAgICAgICAgIHRoaXMuYW1vdW50U2VsZWN0aW9uV2luZG93Lm9uQWNjZXB0ID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIF90aGlzLml0ZW1zV2luZG93c2V0LnNlbGVjdGVkSXRlbS5jb3VudCAtPSBfdGhpcy5hbW91bnRTZWxlY3Rpb25XaW5kb3cuYW1vdW50OwogICAgICAgICAgICBfdGhpcy5pdGVtc1dpbmRvd3NldC5yZWJ1aWxkKCk7CiAgICAgICAgICAgIHJldHVybiBfdGhpcy5pdGVtc1dpbmRvd3NldC5hY3RpdmUgPSB0cnVlOwogICAgICAgICAgfTsKICAgICAgICAgIHRoaXMuYW1vdW50U2VsZWN0aW9uV2luZG93Lm9uQ2FuY2VsID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIHJldHVybiBfdGhpcy5pdGVtc1dpbmRvd3NldC5hY3RpdmUgPSB0cnVlOwogICAgICAgICAgfTsKICAgICAgICAgIHRoaXMuYW1vdW50U2VsZWN0aW9uV2luZG93Lm9wZW4oKTsKICAgICAgfQogICAgICByZXR1cm4gdGhpcy5pdGVtc1dpbmRvd3NldC5jbGVhckRlc2NyaXB0aW9uKCk7CiAgICB9OwoKICAgIFNjZW5lX01haW5NZW51LnByb3RvdHlwZS5vblVzZURyb3BBbGVydENhbmNlbCA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gdGhpcy5pdGVtc1dpbmRvd3NldC5hY3RpdmUgPSB0cnVlOwogICAgfTsKCiAgICByZXR1cm4gU2NlbmVfTWFpbk1lbnU7CgogIH0pKFNjZW5lKTsKCiAgd2luZG93LlNjZW5lX01haW5NZW51ID0gU2NlbmVfTWFpbk1lbnU7Cgp9KS5jYWxsKHRoaXMpOwo="},{"name":"Scene_Shop","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogU2NlbmVfU2hvcAojICAgQ3JlYXRlZCBvbjogMjAxMy0wOS0xNQojCiMgICAgIENvcHlyaWdodCAoQykgMjAxMyBBbmRy6SBSYWRvbXNraS4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KIwojIAlDbGFzczogU2NlbmVfU2hvcAojCiMgICBEZXNjcmlwdGlvbi4uLgojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKY2xhc3MgU2NlbmVfU2hvcCBleHRlbmRzIFNjZW5lCiAgICBjb25zdHJ1Y3RvcjogLT4KICAgICAgICBzdXBlcigpCiAgICAKICAgICAgICBAaXRlbXMgPSBbXQogICAgICAgIEB3ZWFwb25zID0gW10KICAgICAgICBAYXJtb3JzID0gW10KICAgIGluaXRpYWxpemU6IC0+CiAgICAgICAgQGJhY2tncm91bmQgPSBHcmFwaGljcy5zbmFwc2hvdCgpCiAgICAgICAgQGJhY2tncm91bmQuZmlsbFJlY3QoMCwgMCwgQGJhY2tncm91bmQud2lkdGgsIEBiYWNrZ3JvdW5kLmhlaWdodCwgbmV3IENvbG9yKDAsIDAsIDAsIDAuNSkpCiAgICBkaXNwb3NlOiAtPgogICAgICAgIEBzcHJpdGUuZGlzcG9zZSgpCiAgICAgICAgQGl0ZW1zV2luZG93c2V0LmRpc3Bvc2UoKQogICAgICAgIEBwYXJ0eVdpbmRvdy5kaXNwb3NlKCkKICAgICAgICBAYWN0aW9uV2luZG93LmRpc3Bvc2UoKQogICAgICAgIEBtb25leVdpbmRvdy5kaXNwb3NlKCkKICAgIAogICAgcHJlcGFyZURhdGE6IC0+ICAgCiAgICAgICAgdm9jYWIgPSBSZWNvcmRNYW5hZ2VyLnZvY2FidWxhcnkKICAgICAgICBAc3ByaXRlID0gbmV3IFNwcml0ZQogICAgICAgIEBzcHJpdGUuYml0bWFwID0gQGJhY2tncm91bmQKICAgICAgICBAc3ByaXRlLnNyY1JlY3QgPSBuZXcgUmVjdCgwLCAwLCBHcmFwaGljcy53aWR0aCwgR3JhcGhpY3MuaGVpZ2h0KQogICAgICAgIEBzcHJpdGUueiA9IC0xCiAgICAgICAgCiAgICAgICAgQGl0ZW1zV2luZG93c2V0ID0gbmV3IFdpbmRvd3NldF9CdXlJdGVtcygxNzQgKiBXaW5kb3dfQmFzZS5zY2FsZSwgMTE0ICogV2luZG93X0Jhc2Uuc2NhbGUpCiAgICAgICAgQGl0ZW1zV2luZG93c2V0Lml0ZW1zID0gQGl0ZW1zICNbeyBpdGVtOiBSZWNvcmRNYW5hZ2VyLml0ZW1zWzBdIH1dCiAgICAgICAgQGl0ZW1zV2luZG93c2V0LndlYXBvbnMgPSBAd2VhcG9ucyAjW3sgaXRlbTogUmVjb3JkTWFuYWdlci53ZWFwb25zWzBdIH0sIHsgaXRlbTogUmVjb3JkTWFuYWdlci53ZWFwb25zWzJdLCBwcmljZTogNTAgfSBdCiAgICAgICAgQGl0ZW1zV2luZG93c2V0LmFybW9ycyA9IEBhcm1vcnMKICAgICAgICBAaXRlbXNXaW5kb3dzZXQuc2hvdyhubykKICAgICAgICBAaXRlbXNXaW5kb3dzZXQub25CdXkgPSAoc2VuZGVyLCBpdGVtLCBhbW91bnQsIHZhbHVlKSA9PiBAb25CdXkoc2VuZGVyLCBpdGVtLCBhbW91bnQsIHZhbHVlKQogICAgICAgIEBpdGVtc1dpbmRvd3NldC5vblNlbGwgPSAoc2VuZGVyLCBpdGVtLCBhbW91bnQsIHZhbHVlKSA9PiBAb25TZWxsKHNlbmRlciwgaXRlbSwgYW1vdW50LCB2YWx1ZSkKICAgICAgICBAaXRlbXNXaW5kb3dzZXQub25DYW5jZWwgPSAoc2VuZGVyKSA9PiBAb25DYW5jZWwoc2VuZGVyKQogICAgICAgIAogICAgICAgIEBwYXJ0eVdpbmRvdyA9IG5ldyBXaW5kb3dfUGFydHkoKQogICAgICAgIEBwYXJ0eVdpbmRvdy5vblNlbGVjdGlvbkNoYW5nZSA9ID0+IEBvblBhcnR5TWVtYmVyQ2hhbmdlKCkKICAgICAgICBAcGFydHlXaW5kb3cueiA9IDAKCiAgICAgICAgQGFjdGlvbldpbmRvdyA9IG5ldyBXaW5kb3dfU2VsZWN0aW9uKDAsIEBwYXJ0eVdpbmRvdy5oZWlnaHQsIDEsIFtbbGNzKHZvY2FiLnNob3BNZW51LmJ1eSldICwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtsY3Modm9jYWIuc2hvcE1lbnUuc2VsbCldICwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtsY3Modm9jYWIuc2hvcE1lbnUubGVhdmUpXV0sIDE1MCpXaW5kb3dfQmFzZS5zY2FsZSwgMzIqV2luZG93X0Jhc2Uuc2NhbGUpCiAgICAgICAgQGFjdGlvbldpbmRvdy5vblNlbGVjdGlvbkNoYW5nZSA9ID0+IEBvbkFjdGlvbkNoYW5nZSgpCiAgICAgICAgQGFjdGlvbldpbmRvdy5vblNlbGVjdGlvbkFjY2VwdCA9ID0+IEBvbkFjdGlvbkFjY2VwdCgpCiAgICAgICAgQGFjdGlvbldpbmRvdy50ZXh0QWxpZ25tZW50ID0gMAoKICAgICAgICBAbW9uZXlXaW5kb3cgPSBuZXcgV2luZG93X01vbmV5KDAsIDApCiAgICAgICAgQG1vbmV5V2luZG93LnkgPSBHcmFwaGljcy5oZWlnaHQgLSBAbW9uZXlXaW5kb3cuaGVpZ2h0CiAgICAgICAgQG1vbmV5V2luZG93LnJlZHJhdygpCiAgICAgICAgQHBhcnR5V2luZG93LnByZXBhcmUoKQogICAgCiAgICBwcmVwYXJlVmlzdWFsOiAtPgogICAgICAgIEBwYXJ0eVdpbmRvdy5yZWRyYXcoKQogICAgICAgIEBhY3Rpb25XaW5kb3cucmVkcmF3KCkKICAgICAgICAKICAgIHVwZGF0ZTogLT4KICAgICAgICBAaXRlbXNXaW5kb3dzZXQudXBkYXRlKCkKICAgICAgICBAcGFydHlXaW5kb3cudXBkYXRlKCkKICAgICAgICBAYWN0aW9uV2luZG93LnVwZGF0ZSgpCiAgICAgICAgCiAgICAgICAgQGl0ZW1zV2luZG93c2V0Lm1lbWJlciA9IEdhbWVNYW5hZ2VyLnBhcnR5Lm1lbWJlcnNbQHBhcnR5V2luZG93LnNlbGVjdGVkQ29sdW1uXQogICAgICAgIHN1YndpbmRvd0FjdGl2ZSA9IEBpdGVtc1dpbmRvd3NldC5hY3RpdmUKICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICBpZiBJbnB1dC50cmlnZ2VyKElucHV0LkIpIGFuZCBAYWN0aW9uV2luZG93LmFjdGl2ZQogICAgICAgICAgICBTY2VuZU1hbmFnZXIuc3dpdGNoVG8obmV3IFNjZW5lX01hcCgpKQogICAgICAgICAgICAKICAgICAgICBzdXBlcgogICAgCiAgICBvblBhcnR5TWVtYmVyQ2hhbmdlOiAtPgogICAgICAgICAgICAgICAgCiAgICBvbkFjdGlvbkNoYW5nZTogLT4KICAgICAgICAKICAgICAgICBpZiBAYWN0aW9uV2luZG93LnNlbGVjdGVkUm93ID09IDAKICAgICAgICAgICAgQGl0ZW1zV2luZG93c2V0Lml0ZW1zID0gQGl0ZW1zICNbeyBpdGVtOiBSZWNvcmRNYW5hZ2VyLml0ZW1zWzBdIH1dCiAgICAgICAgICAgIEBpdGVtc1dpbmRvd3NldC53ZWFwb25zID0gQHdlYXBvbnMgI1t7IGl0ZW06IFJlY29yZE1hbmFnZXIud2VhcG9uc1swXSB9LCB7IGl0ZW06IFJlY29yZE1hbmFnZXIud2VhcG9uc1sxXSwgcHJpY2U6IDUwIH0sIHsgaXRlbTogUmVjb3JkTWFuYWdlci53ZWFwb25zWzJdLCBwcmljZTogNTAgfV0KICAgICAgICAgICAgQGl0ZW1zV2luZG93c2V0LmFybW9ycyA9IEBhcm1vcnMKICAgICAgICAgICAgQGl0ZW1zV2luZG93c2V0Lm1vZGUgPSBAYWN0aW9uV2luZG93LnNlbGVjdGVkUm93ICAgICAgICAKICAgICAgICAgICAgQGl0ZW1zV2luZG93c2V0LnNob3coeWVzLCBubykKICAgICAgICAgICAgCiAgICAgICAgICAgIEBpdGVtc1dpbmRvd3NldC5yZWRyYXcoKQogICAgICAgIGVsc2UgaWYgQGFjdGlvbldpbmRvdy5zZWxlY3RlZFJvdyA9PSAxCiAgICAgICAgICAgIEBpdGVtc1dpbmRvd3NldC5pdGVtcyA9IEdhbWVNYW5hZ2VyLmludmVudG9yeS5pdGVtcwogICAgICAgICAgICBAaXRlbXNXaW5kb3dzZXQud2VhcG9ucyA9IEdhbWVNYW5hZ2VyLmludmVudG9yeS53ZWFwb25zCiAgICAgICAgICAgIEBpdGVtc1dpbmRvd3NldC5hcm1vcnMgPSBHYW1lTWFuYWdlci5pbnZlbnRvcnkuYXJtb3JzCiAgICAgICAgICAgIEBpdGVtc1dpbmRvd3NldC5tb2RlID0gQGFjdGlvbldpbmRvdy5zZWxlY3RlZFJvdyAgICAgICAgCiAgICAgICAgICAgIEBpdGVtc1dpbmRvd3NldC5zaG93KHllcywgbm8pCiAgICAgICAgICAgIAogICAgICAgICAgICBAaXRlbXNXaW5kb3dzZXQucmVkcmF3KCkKICAgICAgICBlbHNlCiAgICAgICAgICAgIEBpdGVtc1dpbmRvd3NldC5tb2RlID0gQGFjdGlvbldpbmRvdy5zZWxlY3RlZFJvdyAgCiAgICAgICAgICAgIEBpdGVtc1dpbmRvd3NldC5zaG93KG5vLCBubykKICAgICAgICAgICAgQGl0ZW1zV2luZG93c2V0Lml0ZW1XaW5kb3cudmlzaWJsZSA9IG5vCiAgICAgICAgCiAgICBvbkFjdGlvbkFjY2VwdDogLT4KICAgICAgICBpZiBAYWN0aW9uV2luZG93LnNlbGVjdGVkUm93ID09IDIKICAgICAgICAgICAgU2NlbmVNYW5hZ2VyLnN3aXRjaFRvKG5ldyBTY2VuZV9NYXAoKSkKICAgICAgICBlbHNlCiAgICAgICAgICAgIEBhY3Rpb25XaW5kb3cuYWN0aXZlID0gbm8KICAgICAgICAgICAgQHBhcnR5V2luZG93LmFjdGl2ZSA9IG5vCiAgICAgICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgICAgIAogICAgICAgICAgICBAaXRlbXNXaW5kb3dzZXQubW9kZSA9IEBhY3Rpb25XaW5kb3cuc2VsZWN0ZWRSb3cKICAgICAgICAgICAgQGl0ZW1zV2luZG93c2V0LmFjdGl2YXRlKCkKICAgICAgICAgICAgICAgCiAgICBvbkNhbmNlbDogLT4KICAgICAgICBAYWN0aW9uV2luZG93LmFjdGl2ZSA9IHllcwogICAgICAgIEBwYXJ0eVdpbmRvdy5hY3RpdmUgPSB5ZXMKICAgICAgICBJbnB1dC5jbGVhcigpCiAgICAgICAgCiAgICBvbkJ1eTogKHNlbmRlciwgaXRlbSwgYW1vdW50LCB2YWx1ZSkgLT4KICAgICAgICBHYW1lTWFuYWdlci5tb25leSAtPSB2YWx1ZSAqIGFtb3VudAogICAgICAgIEdhbWVNYW5hZ2VyLmludmVudG9yeS5hZGRJdGVtKGl0ZW0sIGFtb3VudCkKICAgICAgICBAbW9uZXlXaW5kb3cucmVkcmF3KCkKICAgICAgICAKICAgIG9uU2VsbDogKHNlbmRlciwgaXRlbSwgYW1vdW50LCB2YWx1ZSkgLT4KICAgICAgICBHYW1lTWFuYWdlci5tb25leSArPSB2YWx1ZSAqIGFtb3VudAogICAgICAgIEdhbWVNYW5hZ2VyLmludmVudG9yeS5yZW1vdmVJdGVtKGl0ZW0sIGFtb3VudCkKICAgICAgICBAbW9uZXlXaW5kb3cucmVkcmF3KCkKCgp3aW5kb3cuU2NlbmVfU2hvcCA9IFNjZW5lX1Nob3A=","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBTY2VuZV9TaG9wLAogICAgX19oYXNQcm9wID0ge30uaGFzT3duUHJvcGVydHksCiAgICBfX2V4dGVuZHMgPSBmdW5jdGlvbihjaGlsZCwgcGFyZW50KSB7IGZvciAodmFyIGtleSBpbiBwYXJlbnQpIHsgaWYgKF9faGFzUHJvcC5jYWxsKHBhcmVudCwga2V5KSkgY2hpbGRba2V5XSA9IHBhcmVudFtrZXldOyB9IGZ1bmN0aW9uIGN0b3IoKSB7IHRoaXMuY29uc3RydWN0b3IgPSBjaGlsZDsgfSBjdG9yLnByb3RvdHlwZSA9IHBhcmVudC5wcm90b3R5cGU7IGNoaWxkLnByb3RvdHlwZSA9IG5ldyBjdG9yKCk7IGNoaWxkLl9fc3VwZXJfXyA9IHBhcmVudC5wcm90b3R5cGU7IHJldHVybiBjaGlsZDsgfTsKCiAgU2NlbmVfU2hvcCA9IChmdW5jdGlvbihfc3VwZXIpIHsKICAgIF9fZXh0ZW5kcyhTY2VuZV9TaG9wLCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFNjZW5lX1Nob3AoKSB7CiAgICAgIFNjZW5lX1Nob3AuX19zdXBlcl9fLmNvbnN0cnVjdG9yLmNhbGwodGhpcyk7CiAgICAgIHRoaXMuaXRlbXMgPSBbXTsKICAgICAgdGhpcy53ZWFwb25zID0gW107CiAgICAgIHRoaXMuYXJtb3JzID0gW107CiAgICB9CgogICAgU2NlbmVfU2hvcC5wcm90b3R5cGUuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uKCkgewogICAgICB0aGlzLmJhY2tncm91bmQgPSBHcmFwaGljcy5zbmFwc2hvdCgpOwogICAgICByZXR1cm4gdGhpcy5iYWNrZ3JvdW5kLmZpbGxSZWN0KDAsIDAsIHRoaXMuYmFja2dyb3VuZC53aWR0aCwgdGhpcy5iYWNrZ3JvdW5kLmhlaWdodCwgbmV3IENvbG9yKDAsIDAsIDAsIDAuNSkpOwogICAgfTsKCiAgICBTY2VuZV9TaG9wLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMuc3ByaXRlLmRpc3Bvc2UoKTsKICAgICAgdGhpcy5pdGVtc1dpbmRvd3NldC5kaXNwb3NlKCk7CiAgICAgIHRoaXMucGFydHlXaW5kb3cuZGlzcG9zZSgpOwogICAgICB0aGlzLmFjdGlvbldpbmRvdy5kaXNwb3NlKCk7CiAgICAgIHJldHVybiB0aGlzLm1vbmV5V2luZG93LmRpc3Bvc2UoKTsKICAgIH07CgogICAgU2NlbmVfU2hvcC5wcm90b3R5cGUucHJlcGFyZURhdGEgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIHZvY2FiLAogICAgICAgIF90aGlzID0gdGhpczsKICAgICAgdm9jYWIgPSBSZWNvcmRNYW5hZ2VyLnZvY2FidWxhcnk7CiAgICAgIHRoaXMuc3ByaXRlID0gbmV3IFNwcml0ZTsKICAgICAgdGhpcy5zcHJpdGUuYml0bWFwID0gdGhpcy5iYWNrZ3JvdW5kOwogICAgICB0aGlzLnNwcml0ZS5zcmNSZWN0ID0gbmV3IFJlY3QoMCwgMCwgR3JhcGhpY3Mud2lkdGgsIEdyYXBoaWNzLmhlaWdodCk7CiAgICAgIHRoaXMuc3ByaXRlLnogPSAtMTsKICAgICAgdGhpcy5pdGVtc1dpbmRvd3NldCA9IG5ldyBXaW5kb3dzZXRfQnV5SXRlbXMoMTc0ICogV2luZG93X0Jhc2Uuc2NhbGUsIDExNCAqIFdpbmRvd19CYXNlLnNjYWxlKTsKICAgICAgdGhpcy5pdGVtc1dpbmRvd3NldC5pdGVtcyA9IHRoaXMuaXRlbXM7CiAgICAgIHRoaXMuaXRlbXNXaW5kb3dzZXQud2VhcG9ucyA9IHRoaXMud2VhcG9uczsKICAgICAgdGhpcy5pdGVtc1dpbmRvd3NldC5hcm1vcnMgPSB0aGlzLmFybW9yczsKICAgICAgdGhpcy5pdGVtc1dpbmRvd3NldC5zaG93KGZhbHNlKTsKICAgICAgdGhpcy5pdGVtc1dpbmRvd3NldC5vbkJ1eSA9IGZ1bmN0aW9uKHNlbmRlciwgaXRlbSwgYW1vdW50LCB2YWx1ZSkgewogICAgICAgIHJldHVybiBfdGhpcy5vbkJ1eShzZW5kZXIsIGl0ZW0sIGFtb3VudCwgdmFsdWUpOwogICAgICB9OwogICAgICB0aGlzLml0ZW1zV2luZG93c2V0Lm9uU2VsbCA9IGZ1bmN0aW9uKHNlbmRlciwgaXRlbSwgYW1vdW50LCB2YWx1ZSkgewogICAgICAgIHJldHVybiBfdGhpcy5vblNlbGwoc2VuZGVyLCBpdGVtLCBhbW91bnQsIHZhbHVlKTsKICAgICAgfTsKICAgICAgdGhpcy5pdGVtc1dpbmRvd3NldC5vbkNhbmNlbCA9IGZ1bmN0aW9uKHNlbmRlcikgewogICAgICAgIHJldHVybiBfdGhpcy5vbkNhbmNlbChzZW5kZXIpOwogICAgICB9OwogICAgICB0aGlzLnBhcnR5V2luZG93ID0gbmV3IFdpbmRvd19QYXJ0eSgpOwogICAgICB0aGlzLnBhcnR5V2luZG93Lm9uU2VsZWN0aW9uQ2hhbmdlID0gZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIF90aGlzLm9uUGFydHlNZW1iZXJDaGFuZ2UoKTsKICAgICAgfTsKICAgICAgdGhpcy5wYXJ0eVdpbmRvdy56ID0gMDsKICAgICAgdGhpcy5hY3Rpb25XaW5kb3cgPSBuZXcgV2luZG93X1NlbGVjdGlvbigwLCB0aGlzLnBhcnR5V2luZG93LmhlaWdodCwgMSwgW1tsY3Modm9jYWIuc2hvcE1lbnUuYnV5KV0sIFtsY3Modm9jYWIuc2hvcE1lbnUuc2VsbCldLCBbbGNzKHZvY2FiLnNob3BNZW51LmxlYXZlKV1dLCAxNTAgKiBXaW5kb3dfQmFzZS5zY2FsZSwgMzIgKiBXaW5kb3dfQmFzZS5zY2FsZSk7CiAgICAgIHRoaXMuYWN0aW9uV2luZG93Lm9uU2VsZWN0aW9uQ2hhbmdlID0gZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIF90aGlzLm9uQWN0aW9uQ2hhbmdlKCk7CiAgICAgIH07CiAgICAgIHRoaXMuYWN0aW9uV2luZG93Lm9uU2VsZWN0aW9uQWNjZXB0ID0gZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIF90aGlzLm9uQWN0aW9uQWNjZXB0KCk7CiAgICAgIH07CiAgICAgIHRoaXMuYWN0aW9uV2luZG93LnRleHRBbGlnbm1lbnQgPSAwOwogICAgICB0aGlzLm1vbmV5V2luZG93ID0gbmV3IFdpbmRvd19Nb25leSgwLCAwKTsKICAgICAgdGhpcy5tb25leVdpbmRvdy55ID0gR3JhcGhpY3MuaGVpZ2h0IC0gdGhpcy5tb25leVdpbmRvdy5oZWlnaHQ7CiAgICAgIHRoaXMubW9uZXlXaW5kb3cucmVkcmF3KCk7CiAgICAgIHJldHVybiB0aGlzLnBhcnR5V2luZG93LnByZXBhcmUoKTsKICAgIH07CgogICAgU2NlbmVfU2hvcC5wcm90b3R5cGUucHJlcGFyZVZpc3VhbCA9IGZ1bmN0aW9uKCkgewogICAgICB0aGlzLnBhcnR5V2luZG93LnJlZHJhdygpOwogICAgICByZXR1cm4gdGhpcy5hY3Rpb25XaW5kb3cucmVkcmF3KCk7CiAgICB9OwoKICAgIFNjZW5lX1Nob3AucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgc3Vid2luZG93QWN0aXZlOwogICAgICB0aGlzLml0ZW1zV2luZG93c2V0LnVwZGF0ZSgpOwogICAgICB0aGlzLnBhcnR5V2luZG93LnVwZGF0ZSgpOwogICAgICB0aGlzLmFjdGlvbldpbmRvdy51cGRhdGUoKTsKICAgICAgdGhpcy5pdGVtc1dpbmRvd3NldC5tZW1iZXIgPSBHYW1lTWFuYWdlci5wYXJ0eS5tZW1iZXJzW3RoaXMucGFydHlXaW5kb3cuc2VsZWN0ZWRDb2x1bW5dOwogICAgICBzdWJ3aW5kb3dBY3RpdmUgPSB0aGlzLml0ZW1zV2luZG93c2V0LmFjdGl2ZTsKICAgICAgaWYgKElucHV0LnRyaWdnZXIoSW5wdXQuQikgJiYgdGhpcy5hY3Rpb25XaW5kb3cuYWN0aXZlKSB7CiAgICAgICAgU2NlbmVNYW5hZ2VyLnN3aXRjaFRvKG5ldyBTY2VuZV9NYXAoKSk7CiAgICAgIH0KICAgICAgcmV0dXJuIFNjZW5lX1Nob3AuX19zdXBlcl9fLnVwZGF0ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgfTsKCiAgICBTY2VuZV9TaG9wLnByb3RvdHlwZS5vblBhcnR5TWVtYmVyQ2hhbmdlID0gZnVuY3Rpb24oKSB7fTsKCiAgICBTY2VuZV9TaG9wLnByb3RvdHlwZS5vbkFjdGlvbkNoYW5nZSA9IGZ1bmN0aW9uKCkgewogICAgICBpZiAodGhpcy5hY3Rpb25XaW5kb3cuc2VsZWN0ZWRSb3cgPT09IDApIHsKICAgICAgICB0aGlzLml0ZW1zV2luZG93c2V0Lml0ZW1zID0gdGhpcy5pdGVtczsKICAgICAgICB0aGlzLml0ZW1zV2luZG93c2V0LndlYXBvbnMgPSB0aGlzLndlYXBvbnM7CiAgICAgICAgdGhpcy5pdGVtc1dpbmRvd3NldC5hcm1vcnMgPSB0aGlzLmFybW9yczsKICAgICAgICB0aGlzLml0ZW1zV2luZG93c2V0Lm1vZGUgPSB0aGlzLmFjdGlvbldpbmRvdy5zZWxlY3RlZFJvdzsKICAgICAgICB0aGlzLml0ZW1zV2luZG93c2V0LnNob3codHJ1ZSwgZmFsc2UpOwogICAgICAgIHJldHVybiB0aGlzLml0ZW1zV2luZG93c2V0LnJlZHJhdygpOwogICAgICB9IGVsc2UgaWYgKHRoaXMuYWN0aW9uV2luZG93LnNlbGVjdGVkUm93ID09PSAxKSB7CiAgICAgICAgdGhpcy5pdGVtc1dpbmRvd3NldC5pdGVtcyA9IEdhbWVNYW5hZ2VyLmludmVudG9yeS5pdGVtczsKICAgICAgICB0aGlzLml0ZW1zV2luZG93c2V0LndlYXBvbnMgPSBHYW1lTWFuYWdlci5pbnZlbnRvcnkud2VhcG9uczsKICAgICAgICB0aGlzLml0ZW1zV2luZG93c2V0LmFybW9ycyA9IEdhbWVNYW5hZ2VyLmludmVudG9yeS5hcm1vcnM7CiAgICAgICAgdGhpcy5pdGVtc1dpbmRvd3NldC5tb2RlID0gdGhpcy5hY3Rpb25XaW5kb3cuc2VsZWN0ZWRSb3c7CiAgICAgICAgdGhpcy5pdGVtc1dpbmRvd3NldC5zaG93KHRydWUsIGZhbHNlKTsKICAgICAgICByZXR1cm4gdGhpcy5pdGVtc1dpbmRvd3NldC5yZWRyYXcoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLml0ZW1zV2luZG93c2V0Lm1vZGUgPSB0aGlzLmFjdGlvbldpbmRvdy5zZWxlY3RlZFJvdzsKICAgICAgICB0aGlzLml0ZW1zV2luZG93c2V0LnNob3coZmFsc2UsIGZhbHNlKTsKICAgICAgICByZXR1cm4gdGhpcy5pdGVtc1dpbmRvd3NldC5pdGVtV2luZG93LnZpc2libGUgPSBmYWxzZTsKICAgICAgfQogICAgfTsKCiAgICBTY2VuZV9TaG9wLnByb3RvdHlwZS5vbkFjdGlvbkFjY2VwdCA9IGZ1bmN0aW9uKCkgewogICAgICBpZiAodGhpcy5hY3Rpb25XaW5kb3cuc2VsZWN0ZWRSb3cgPT09IDIpIHsKICAgICAgICByZXR1cm4gU2NlbmVNYW5hZ2VyLnN3aXRjaFRvKG5ldyBTY2VuZV9NYXAoKSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5hY3Rpb25XaW5kb3cuYWN0aXZlID0gZmFsc2U7CiAgICAgICAgdGhpcy5wYXJ0eVdpbmRvdy5hY3RpdmUgPSBmYWxzZTsKICAgICAgICB0aGlzLml0ZW1zV2luZG93c2V0Lm1vZGUgPSB0aGlzLmFjdGlvbldpbmRvdy5zZWxlY3RlZFJvdzsKICAgICAgICByZXR1cm4gdGhpcy5pdGVtc1dpbmRvd3NldC5hY3RpdmF0ZSgpOwogICAgICB9CiAgICB9OwoKICAgIFNjZW5lX1Nob3AucHJvdG90eXBlLm9uQ2FuY2VsID0gZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMuYWN0aW9uV2luZG93LmFjdGl2ZSA9IHRydWU7CiAgICAgIHRoaXMucGFydHlXaW5kb3cuYWN0aXZlID0gdHJ1ZTsKICAgICAgcmV0dXJuIElucHV0LmNsZWFyKCk7CiAgICB9OwoKICAgIFNjZW5lX1Nob3AucHJvdG90eXBlLm9uQnV5ID0gZnVuY3Rpb24oc2VuZGVyLCBpdGVtLCBhbW91bnQsIHZhbHVlKSB7CiAgICAgIEdhbWVNYW5hZ2VyLm1vbmV5IC09IHZhbHVlICogYW1vdW50OwogICAgICBHYW1lTWFuYWdlci5pbnZlbnRvcnkuYWRkSXRlbShpdGVtLCBhbW91bnQpOwogICAgICByZXR1cm4gdGhpcy5tb25leVdpbmRvdy5yZWRyYXcoKTsKICAgIH07CgogICAgU2NlbmVfU2hvcC5wcm90b3R5cGUub25TZWxsID0gZnVuY3Rpb24oc2VuZGVyLCBpdGVtLCBhbW91bnQsIHZhbHVlKSB7CiAgICAgIEdhbWVNYW5hZ2VyLm1vbmV5ICs9IHZhbHVlICogYW1vdW50OwogICAgICBHYW1lTWFuYWdlci5pbnZlbnRvcnkucmVtb3ZlSXRlbShpdGVtLCBhbW91bnQpOwogICAgICByZXR1cm4gdGhpcy5tb25leVdpbmRvdy5yZWRyYXcoKTsKICAgIH07CgogICAgcmV0dXJuIFNjZW5lX1Nob3A7CgogIH0pKFNjZW5lKTsKCiAgd2luZG93LlNjZW5lX1Nob3AgPSBTY2VuZV9TaG9wOwoKfSkuY2FsbCh0aGlzKTsK"},{"name":"Scene_Settings","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogU2NlbmVfU2V0dGluZ3MKIyAgIAojCiMgCUNvcHlyaWdodCAoQykgMjAxNCBBbmRy6SBSYWRvbXNraS4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KIwojIAlDbGFzczogU2NlbmVfU2V0dGluZ3MKIwojICAgRGVzY3JpcHRpb24uLi4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCmNsYXNzIFNjZW5lX1NldHRpbmdzIGV4dGVuZHMgU2NlbmUKICAgIGNvbnN0cnVjdG9yOiAoKSAtPgogICAgICAgIHN1cGVyKCkKICAKICAgIGluaXRpYWxpemU6IC0+CiAgICAgICAgQGJpdG1hcCA9IFJlc291cmNlTWFuYWdlci5nZXRCaXRtYXAoIkdyYXBoaWNzL1BpY3R1cmVzLyN7UmVjb3JkTWFuYWdlci5zeXN0ZW0udGl0bGVHcmFwaGljLm5hbWV9IikKICAgIGRpc3Bvc2U6IC0+CiAgICAgICAgQHdpbmRvdy5kaXNwb3NlKCkKICAgICAgICBAdmFsdWVXaW5kb3cuZGlzcG9zZSgpCiAgICAgICAgQGluZm9XaW5kb3cuZGlzcG9zZSgpCiAgICAgICAgCiAgICAgICAgaWYgQHNwcml0ZT8KICAgICAgICAgICAgQHNwcml0ZS5kaXNwb3NlKCkKICAgIHByZXBhcmVEYXRhOiAtPgoKICAgIHByZXBhcmVWaXN1YWw6IC0+CiAgICAgICAgaWYgQGJpdG1hcD8KICAgICAgICAgICAgQHNwcml0ZSA9IG5ldyBTcHJpdGUoKQogICAgICAgICAgICBAc3ByaXRlLmJpdG1hcCA9IEBiaXRtYXAKICAgICAgICAgICAgQHNwcml0ZS5zcmNSZWN0ID0gbmV3IFJlY3QoMCwgMCwgR3JhcGhpY3Mud2lkdGgsIEdyYXBoaWNzLmhlaWdodCkKICAgICAgICAgICAgQHNwcml0ZS56ID0gLTEwMDAKICAgICAgICBzID0gV2luZG93X0Jhc2Uuc2NhbGUKICAgICAgICB2b2NhYiA9IFJlY29yZE1hbmFnZXIudm9jYWJ1bGFyeQogICAgICAgIEB3aW5kb3cgPSBuZXcgV2luZG93X1NlbGVjdGlvbigyMCpzLCAyMCpzLCAxLCBbWyJHcmFwaGljcyBSZW5kZXJlciJdICxbIlNjcmVlbiBGaWx0ZXIiXSwgWyJCYWNrIl1dLCAzMDAqcykKICAgICAgICBAd2luZG93LnggPSAyMCpzCiAgICAgICAgQHdpbmRvdy55ID0gODAqcwogICAgICAgIEB3aW5kb3cub25TZWxlY3Rpb25BY2NlcHQgPSA9PiBAZXhlY3V0ZVNlbGVjdGVkQ29tbWFuZCgpCiAgICAgICAgQHdpbmRvdy5vblNlbGVjdGlvbkNoYW5nZSA9ID0+IEBvblNlbGVjdGlvbkNoYW5nZSgpCiAgICAgICAgQHdpbmRvdy5yZWRyYXcoKQogICAgICAgIAogICAgICAgIEB2YWx1ZVdpbmRvdyA9IG5ldyBXaW5kb3dfVGV4dChAd2luZG93LnggKyBAd2luZG93LndpZHRoLCBAd2luZG93LnksIDI3MipzLCBAd2luZG93LmhlaWdodCkKCiAgICAgICAgQGluZm9XaW5kb3cgPSBuZXcgV2luZG93X1RleHQoQHdpbmRvdy54LCBAd2luZG93LnkgLSA1MCpzLCBAd2luZG93LndpZHRoICsgQHZhbHVlV2luZG93LndpZHRoLCA1MCpzKQogICAgICAgIEBpbmZvV2luZG93LnRleHQgPSAiQ2hhbmdlIGEgc2V0dGluZyB1c2luZyBsZWZ0IG9yIHJpZ2h0IGJ1dHRvbi4iCiAgICAgICAgQGluZm9XaW5kb3cucmVkcmF3KCkKICAgICAgICAKICAgICAgICBAc2V0dGluZ3MgPSBHYW1lU3RvcmFnZS5nZXRPYmplY3QoInNldHRpbmdzIikgfHwgWzAsIDBdCiAgICAgICAgQHJlbmRlcmVyU2V0dGluZ3MgPSBbIk9wZW5HTCBSZW5kZXJlciIsICJDYW52YXMgUmVuZGVyZXIiXQogICAgICAgIEBmaWx0ZXJTZXR0aW5ncyA9IFsiTm8gRmlsdGVyIiwgIlNtb290aCBGaWx0ZXIiXQogICAgdXBkYXRlOiAtPiAgICAgICAgICAgIAogICAgICAgIEB3aW5kb3cudXBkYXRlKCkKICAgICAgICAKICAgICAgICBpZiBJbnB1dC50cmlnZ2VyKElucHV0LkxFRlQpCiAgICAgICAgICAgIEBzZXR0aW5nc1tAd2luZG93LnNlbGVjdGVkUm93XSA9IEBzZXR0aW5nc1tAd2luZG93LnNlbGVjdGVkUm93XSAtIDEKICAgICAgICAgICAgQHNldHRpbmdzW0B3aW5kb3cuc2VsZWN0ZWRSb3ddID0gTWF0aC5tYXgoTWF0aC5taW4oQHNldHRpbmdzW0B3aW5kb3cuc2VsZWN0ZWRSb3ddLCBAc2V0dGluZ3MubGVuZ3RoLTEpLCAwKQogICAgICAgICAgICBAb25TZWxlY3Rpb25DaGFuZ2UoKQogICAgICAgIGlmIElucHV0LnRyaWdnZXIoSW5wdXQuUklHSFQpCiAgICAgICAgICAgIEBzZXR0aW5nc1tAd2luZG93LnNlbGVjdGVkUm93XSA9IEBzZXR0aW5nc1tAd2luZG93LnNlbGVjdGVkUm93XSArIDEKICAgICAgICAgICAgQHNldHRpbmdzW0B3aW5kb3cuc2VsZWN0ZWRSb3ddID0gTWF0aC5tYXgoTWF0aC5taW4oQHNldHRpbmdzW0B3aW5kb3cuc2VsZWN0ZWRSb3ddLCBAc2V0dGluZ3MubGVuZ3RoLTEpLCAwKQogICAgICAgICAgICBAb25TZWxlY3Rpb25DaGFuZ2UoKQogICAgICAgIAogICAgICAgIAogICAgICAgIHN1cGVyKCkKICAgICAgICAKICAgICAgICAKICAgIG9uU2VsZWN0aW9uQ2hhbmdlOiAtPgogICAgICAgIHN3aXRjaCBAd2luZG93LnNlbGVjdGVkUm93CiAgICAgICAgICAgIHdoZW4gMAogICAgICAgICAgICAgICAgQHZhbHVlV2luZG93LnRleHQgPSBAcmVuZGVyZXJTZXR0aW5nc1tAc2V0dGluZ3NbQHdpbmRvdy5zZWxlY3RlZFJvd11dCiAgICAgICAgICAgIHdoZW4gMQogICAgICAgICAgICAgICAgQHZhbHVlV2luZG93LnRleHQgPSBAZmlsdGVyU2V0dGluZ3NbQHNldHRpbmdzW0B3aW5kb3cuc2VsZWN0ZWRSb3ddXQogICAgICAgICAgICB3aGVuIDIKICAgICAgICAgICAgICAgIEB2YWx1ZVdpbmRvdy50ZXh0ID0gIiIKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAKICAgICAgICBAdmFsdWVXaW5kb3cucmVkcmF3KCkKICAgICAgICAKICAgIGV4ZWN1dGVTZWxlY3RlZENvbW1hbmQ6IC0+CiAgICAgICAgc3dpdGNoIEB3aW5kb3cuc2VsZWN0ZWRSb3cKICAgICAgICAgICAgd2hlbiAyCiAgICAgICAgICAgICAgICBHYW1lU3RvcmFnZS5zZXRPYmplY3QoInNldHRpbmdzIiwgQHNldHRpbmdzKQogICAgICAgICAgICAgICAgU2NlbmVNYW5hZ2VyLnN3aXRjaFRvKG5ldyBTY2VuZV9UaXRsZSgpKQogICAgICAgIAogICAgICAgIAogICAgCndpbmRvdy5TY2VuZV9TZXR0aW5ncyA9IFNjZW5lX1NldHRpbmdz","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBTY2VuZV9TZXR0aW5ncywKICAgIF9faGFzUHJvcCA9IHt9Lmhhc093blByb3BlcnR5LAogICAgX19leHRlbmRzID0gZnVuY3Rpb24oY2hpbGQsIHBhcmVudCkgeyBmb3IgKHZhciBrZXkgaW4gcGFyZW50KSB7IGlmIChfX2hhc1Byb3AuY2FsbChwYXJlbnQsIGtleSkpIGNoaWxkW2tleV0gPSBwYXJlbnRba2V5XTsgfSBmdW5jdGlvbiBjdG9yKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gY2hpbGQ7IH0gY3Rvci5wcm90b3R5cGUgPSBwYXJlbnQucHJvdG90eXBlOyBjaGlsZC5wcm90b3R5cGUgPSBuZXcgY3RvcigpOyBjaGlsZC5fX3N1cGVyX18gPSBwYXJlbnQucHJvdG90eXBlOyByZXR1cm4gY2hpbGQ7IH07CgogIFNjZW5lX1NldHRpbmdzID0gKGZ1bmN0aW9uKF9zdXBlcikgewogICAgX19leHRlbmRzKFNjZW5lX1NldHRpbmdzLCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFNjZW5lX1NldHRpbmdzKCkgewogICAgICBTY2VuZV9TZXR0aW5ncy5fX3N1cGVyX18uY29uc3RydWN0b3IuY2FsbCh0aGlzKTsKICAgIH0KCiAgICBTY2VuZV9TZXR0aW5ncy5wcm90b3R5cGUuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gdGhpcy5iaXRtYXAgPSBSZXNvdXJjZU1hbmFnZXIuZ2V0Qml0bWFwKCJHcmFwaGljcy9QaWN0dXJlcy8iICsgUmVjb3JkTWFuYWdlci5zeXN0ZW0udGl0bGVHcmFwaGljLm5hbWUpOwogICAgfTsKCiAgICBTY2VuZV9TZXR0aW5ncy5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uKCkgewogICAgICB0aGlzLndpbmRvdy5kaXNwb3NlKCk7CiAgICAgIHRoaXMudmFsdWVXaW5kb3cuZGlzcG9zZSgpOwogICAgICB0aGlzLmluZm9XaW5kb3cuZGlzcG9zZSgpOwogICAgICBpZiAodGhpcy5zcHJpdGUgIT0gbnVsbCkgewogICAgICAgIHJldHVybiB0aGlzLnNwcml0ZS5kaXNwb3NlKCk7CiAgICAgIH0KICAgIH07CgogICAgU2NlbmVfU2V0dGluZ3MucHJvdG90eXBlLnByZXBhcmVEYXRhID0gZnVuY3Rpb24oKSB7fTsKCiAgICBTY2VuZV9TZXR0aW5ncy5wcm90b3R5cGUucHJlcGFyZVZpc3VhbCA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgcywgdm9jYWIsCiAgICAgICAgX3RoaXMgPSB0aGlzOwogICAgICBpZiAodGhpcy5iaXRtYXAgIT0gbnVsbCkgewogICAgICAgIHRoaXMuc3ByaXRlID0gbmV3IFNwcml0ZSgpOwogICAgICAgIHRoaXMuc3ByaXRlLmJpdG1hcCA9IHRoaXMuYml0bWFwOwogICAgICAgIHRoaXMuc3ByaXRlLnNyY1JlY3QgPSBuZXcgUmVjdCgwLCAwLCBHcmFwaGljcy53aWR0aCwgR3JhcGhpY3MuaGVpZ2h0KTsKICAgICAgICB0aGlzLnNwcml0ZS56ID0gLTEwMDA7CiAgICAgIH0KICAgICAgcyA9IFdpbmRvd19CYXNlLnNjYWxlOwogICAgICB2b2NhYiA9IFJlY29yZE1hbmFnZXIudm9jYWJ1bGFyeTsKICAgICAgdGhpcy53aW5kb3cgPSBuZXcgV2luZG93X1NlbGVjdGlvbigyMCAqIHMsIDIwICogcywgMSwgW1siR3JhcGhpY3MgUmVuZGVyZXIiXSwgWyJTY3JlZW4gRmlsdGVyIl0sIFsiQmFjayJdXSwgMzAwICogcyk7CiAgICAgIHRoaXMud2luZG93LnggPSAyMCAqIHM7CiAgICAgIHRoaXMud2luZG93LnkgPSA4MCAqIHM7CiAgICAgIHRoaXMud2luZG93Lm9uU2VsZWN0aW9uQWNjZXB0ID0gZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIF90aGlzLmV4ZWN1dGVTZWxlY3RlZENvbW1hbmQoKTsKICAgICAgfTsKICAgICAgdGhpcy53aW5kb3cub25TZWxlY3Rpb25DaGFuZ2UgPSBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gX3RoaXMub25TZWxlY3Rpb25DaGFuZ2UoKTsKICAgICAgfTsKICAgICAgdGhpcy53aW5kb3cucmVkcmF3KCk7CiAgICAgIHRoaXMudmFsdWVXaW5kb3cgPSBuZXcgV2luZG93X1RleHQodGhpcy53aW5kb3cueCArIHRoaXMud2luZG93LndpZHRoLCB0aGlzLndpbmRvdy55LCAyNzIgKiBzLCB0aGlzLndpbmRvdy5oZWlnaHQpOwogICAgICB0aGlzLmluZm9XaW5kb3cgPSBuZXcgV2luZG93X1RleHQodGhpcy53aW5kb3cueCwgdGhpcy53aW5kb3cueSAtIDUwICogcywgdGhpcy53aW5kb3cud2lkdGggKyB0aGlzLnZhbHVlV2luZG93LndpZHRoLCA1MCAqIHMpOwogICAgICB0aGlzLmluZm9XaW5kb3cudGV4dCA9ICJDaGFuZ2UgYSBzZXR0aW5nIHVzaW5nIGxlZnQgb3IgcmlnaHQgYnV0dG9uLiI7CiAgICAgIHRoaXMuaW5mb1dpbmRvdy5yZWRyYXcoKTsKICAgICAgdGhpcy5zZXR0aW5ncyA9IEdhbWVTdG9yYWdlLmdldE9iamVjdCgic2V0dGluZ3MiKSB8fCBbMCwgMF07CiAgICAgIHRoaXMucmVuZGVyZXJTZXR0aW5ncyA9IFsiT3BlbkdMIFJlbmRlcmVyIiwgIkNhbnZhcyBSZW5kZXJlciJdOwogICAgICByZXR1cm4gdGhpcy5maWx0ZXJTZXR0aW5ncyA9IFsiTm8gRmlsdGVyIiwgIlNtb290aCBGaWx0ZXIiXTsKICAgIH07CgogICAgU2NlbmVfU2V0dGluZ3MucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkgewogICAgICB0aGlzLndpbmRvdy51cGRhdGUoKTsKICAgICAgaWYgKElucHV0LnRyaWdnZXIoSW5wdXQuTEVGVCkpIHsKICAgICAgICB0aGlzLnNldHRpbmdzW3RoaXMud2luZG93LnNlbGVjdGVkUm93XSA9IHRoaXMuc2V0dGluZ3NbdGhpcy53aW5kb3cuc2VsZWN0ZWRSb3ddIC0gMTsKICAgICAgICB0aGlzLnNldHRpbmdzW3RoaXMud2luZG93LnNlbGVjdGVkUm93XSA9IE1hdGgubWF4KE1hdGgubWluKHRoaXMuc2V0dGluZ3NbdGhpcy53aW5kb3cuc2VsZWN0ZWRSb3ddLCB0aGlzLnNldHRpbmdzLmxlbmd0aCAtIDEpLCAwKTsKICAgICAgICB0aGlzLm9uU2VsZWN0aW9uQ2hhbmdlKCk7CiAgICAgIH0KICAgICAgaWYgKElucHV0LnRyaWdnZXIoSW5wdXQuUklHSFQpKSB7CiAgICAgICAgdGhpcy5zZXR0aW5nc1t0aGlzLndpbmRvdy5zZWxlY3RlZFJvd10gPSB0aGlzLnNldHRpbmdzW3RoaXMud2luZG93LnNlbGVjdGVkUm93XSArIDE7CiAgICAgICAgdGhpcy5zZXR0aW5nc1t0aGlzLndpbmRvdy5zZWxlY3RlZFJvd10gPSBNYXRoLm1heChNYXRoLm1pbih0aGlzLnNldHRpbmdzW3RoaXMud2luZG93LnNlbGVjdGVkUm93XSwgdGhpcy5zZXR0aW5ncy5sZW5ndGggLSAxKSwgMCk7CiAgICAgICAgdGhpcy5vblNlbGVjdGlvbkNoYW5nZSgpOwogICAgICB9CiAgICAgIHJldHVybiBTY2VuZV9TZXR0aW5ncy5fX3N1cGVyX18udXBkYXRlLmNhbGwodGhpcyk7CiAgICB9OwoKICAgIFNjZW5lX1NldHRpbmdzLnByb3RvdHlwZS5vblNlbGVjdGlvbkNoYW5nZSA9IGZ1bmN0aW9uKCkgewogICAgICBzd2l0Y2ggKHRoaXMud2luZG93LnNlbGVjdGVkUm93KSB7CiAgICAgICAgY2FzZSAwOgogICAgICAgICAgdGhpcy52YWx1ZVdpbmRvdy50ZXh0ID0gdGhpcy5yZW5kZXJlclNldHRpbmdzW3RoaXMuc2V0dGluZ3NbdGhpcy53aW5kb3cuc2VsZWN0ZWRSb3ddXTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgMToKICAgICAgICAgIHRoaXMudmFsdWVXaW5kb3cudGV4dCA9IHRoaXMuZmlsdGVyU2V0dGluZ3NbdGhpcy5zZXR0aW5nc1t0aGlzLndpbmRvdy5zZWxlY3RlZFJvd11dOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAyOgogICAgICAgICAgdGhpcy52YWx1ZVdpbmRvdy50ZXh0ID0gIiI7CiAgICAgIH0KICAgICAgcmV0dXJuIHRoaXMudmFsdWVXaW5kb3cucmVkcmF3KCk7CiAgICB9OwoKICAgIFNjZW5lX1NldHRpbmdzLnByb3RvdHlwZS5leGVjdXRlU2VsZWN0ZWRDb21tYW5kID0gZnVuY3Rpb24oKSB7CiAgICAgIHN3aXRjaCAodGhpcy53aW5kb3cuc2VsZWN0ZWRSb3cpIHsKICAgICAgICBjYXNlIDI6CiAgICAgICAgICBHYW1lU3RvcmFnZS5zZXRPYmplY3QoInNldHRpbmdzIiwgdGhpcy5zZXR0aW5ncyk7CiAgICAgICAgICByZXR1cm4gU2NlbmVNYW5hZ2VyLnN3aXRjaFRvKG5ldyBTY2VuZV9UaXRsZSgpKTsKICAgICAgfQogICAgfTsKCiAgICByZXR1cm4gU2NlbmVfU2V0dGluZ3M7CgogIH0pKFNjZW5lKTsKCiAgd2luZG93LlNjZW5lX1NldHRpbmdzID0gU2NlbmVfU2V0dGluZ3M7Cgp9KS5jYWxsKHRoaXMpOwo="},{"name":"Scene_LoadGame","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogU2NlbmVfTG9hZEdhbWUKIyAgIENyZWF0ZWQgb246IDIwMTMtMDktMjcKIwojIAlDb3B5cmlnaHQgKEMpIDIwMTMgQW5kcukgUmFkb21za2kuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAJQ2xhc3M6IFNjZW5lX1RpdGxlCiMKIyAgIERlc2NyaXB0aW9uLi4uCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpjbGFzcyBTY2VuZV9Mb2FkR2FtZSBleHRlbmRzIFNjZW5lCiAgICBjb25zdHJ1Y3RvcjogLT4KICAgICAgICBzdXBlcigpCiAgICAKICAgIGluaXRpYWxpemU6IC0+CiAgICAgICAgQGJpdG1hcCA9IFJlc291cmNlTWFuYWdlci5nZXRCaXRtYXAoIkdyYXBoaWNzL1BpY3R1cmVzLyN7UmVjb3JkTWFuYWdlci5zeXN0ZW0udGl0bGVHcmFwaGljLm5hbWV9IikKICAgICAgICAKICAgIGRpc3Bvc2U6IC0+CiAgICAgICAgQHNwcml0ZS5kaXNwb3NlKCkKICAgICAgICBAc2F2ZUdhbWVzV2luZG93c2V0LmRpc3Bvc2UoKQogICAgICAgIAogICAgcHJlcGFyZURhdGE6IC0+CiAgICAgICAgc2F2ZUdhbWUgPSBHYW1lTWFuYWdlci5nZXRTYXZlR2FtZSgwKQogICAgICAgIGlmIHNhdmVHYW1lPwogICAgICAgICAgICBmb3IgbWVtYmVyIGluIHNhdmVHYW1lLnBhcnR5Lm1lbWJlcnMKICAgICAgICAgICAgICAgIGlmIFJlY29yZE1hbmFnZXIuYWN0b3JzW21lbWJlci5hY3RvcklkXT8KICAgICAgICAgICAgICAgICAgICBtZW1iZXIuY2hhcmFjdGVyR3JhcGhpYyA9IFJlY29yZE1hbmFnZXIuYWN0b3JzW21lbWJlci5hY3RvcklkXS5jaGFyYWN0ZXJHcmFwaGljCiAgICAgICAgICAgICAgICAgICAgUmVzb3VyY2VNYW5hZ2VyLmdldEJpdG1hcCgiR3JhcGhpY3MvQ2hhcmFjdGVycy8je21lbWJlci5jaGFyYWN0ZXJHcmFwaGljLm5hbWV9IikKICAgICAgICAgICAgICAgIAogICAgICAgIHNhdmVHYW1lID0gR2FtZU1hbmFnZXIuZ2V0U2F2ZUdhbWUoMSkKICAgICAgICBpZiBzYXZlR2FtZT8KICAgICAgICAgICAgZm9yIG1lbWJlciBpbiBzYXZlR2FtZS5wYXJ0eS5tZW1iZXJzCiAgICAgICAgICAgICAgICBpZiBSZWNvcmRNYW5hZ2VyLmFjdG9yc1ttZW1iZXIuYWN0b3JJZF0/CiAgICAgICAgICAgICAgICAgICAgbWVtYmVyLmNoYXJhY3RlckdyYXBoaWMgPSBSZWNvcmRNYW5hZ2VyLmFjdG9yc1ttZW1iZXIuYWN0b3JJZF0uY2hhcmFjdGVyR3JhcGhpYwogICAgICAgICAgICAgICAgICAgIFJlc291cmNlTWFuYWdlci5nZXRCaXRtYXAoIkdyYXBoaWNzL0NoYXJhY3RlcnMvI3ttZW1iZXIuY2hhcmFjdGVyR3JhcGhpYy5uYW1lfSIpCiAgICAgICAgICAgICAgICAKICAgICAgICBzYXZlR2FtZSA9IEdhbWVNYW5hZ2VyLmdldFNhdmVHYW1lKDIpCiAgICAgICAgaWYgc2F2ZUdhbWU/CiAgICAgICAgICAgIGZvciBtZW1iZXIgaW4gc2F2ZUdhbWUucGFydHkubWVtYmVycwogICAgICAgICAgICAgICAgaWYgUmVjb3JkTWFuYWdlci5hY3RvcnNbbWVtYmVyLmFjdG9ySWRdPwogICAgICAgICAgICAgICAgICAgIG1lbWJlci5jaGFyYWN0ZXJHcmFwaGljID0gUmVjb3JkTWFuYWdlci5hY3RvcnNbbWVtYmVyLmFjdG9ySWRdLmNoYXJhY3RlckdyYXBoaWMKICAgICAgICAgICAgICAgICAgICBSZXNvdXJjZU1hbmFnZXIuZ2V0Qml0bWFwKCJHcmFwaGljcy9DaGFyYWN0ZXJzLyN7bWVtYmVyLmNoYXJhY3RlckdyYXBoaWMubmFtZX0iKQogICAgcHJlcGFyZVZpc3VhbDogLT4KICAgICAgICBzY2FsZSA9IGlmIEdyYXBoaWNzLndpZHRoID09IDMyMCB0aGVuIDAuNSBlbHNlIDEuMAogICAgICAgIEBzcHJpdGUgPSBuZXcgU3ByaXRlCiAgICAgICAgQHNwcml0ZS5iaXRtYXAgPSBAYml0bWFwCiAgICAgICAgQHNwcml0ZS5zcmNSZWN0ID0gbmV3IFJlY3QoMCwgMCwgR3JhcGhpY3Mud2lkdGgsIEdyYXBoaWNzLmhlaWdodCkKICAgICAgICAKICAgICAgICBAc2F2ZUdhbWVzV2luZG93c2V0ID0gbmV3IFdpbmRvd3NldF9TYXZlKE1hdGguZmxvb3IoKEdyYXBoaWNzLndpZHRoIC0gNDE2ICogc2NhbGUpIC8gMiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXRoLmZsb29yKChHcmFwaGljcy5oZWlnaHQgLSAzNjAgKiBzY2FsZSkgLyAyKSkKICAgICAgICBAc2F2ZUdhbWVzV2luZG93c2V0Lm9uRmlsZVNlbGVjdGlvbiA9IChzbG90KSA9PiBAb25GaWxlU2VsZWN0aW9uKHNsb3QpCiAgICAgICAgQHNhdmVHYW1lc1dpbmRvd3NldC5vbkNhbmNlbCA9ID0+IEBvbkNhbmNlbCgpCiAgICAgICAgQHNhdmVHYW1lc1dpbmRvd3NldC5hY3RpdmUgPSB5ZXMKICAgICAgICBAc2F2ZUdhbWVzV2luZG93c2V0LmRlc2NyaXB0aW9uV2luZG93LnRleHQgPSBsY3MoUmVjb3JkTWFuYWdlci52b2NhYnVsYXJ5LnNhdmVHYW1lTWVudS5wbGVhc2VTZWxlY3RMb2FkKQogICAgICAgIEBzYXZlR2FtZXNXaW5kb3dzZXQucmVkcmF3KCkKICAgIAogICAgdXBkYXRlOiAtPgogICAgICAgIEBzYXZlR2FtZXNXaW5kb3dzZXQudXBkYXRlKCkKICAgICAgICAKICAgICAgICBzdXBlcigpCiAgICAgICAgCiAgICBvbkZpbGVTZWxlY3Rpb246IChzbG90KSAtPgogICAgICAgIHNhdmVHYW1lID0gR2FtZU1hbmFnZXIuZ2V0U2F2ZUdhbWUoc2xvdCkKICAgICAgICAKICAgICAgICBpZiBzYXZlR2FtZT8KICAgICAgICAgICAgR2FtZU1hbmFnZXIubG9hZChzbG90KQogICAgICAgICAgICBTY2VuZU1hbmFnZXIuc3dpdGNoVG8obmV3IFNjZW5lX01hcCgpKQogICAgICAgIAogICAgb25DYW5jZWw6IC0+CiAgICAgICAgU2NlbmVNYW5hZ2VyLnN3aXRjaFRvKG5ldyBTY2VuZV9UaXRsZSgpKQogICAgICAgIAogICAgICAgIAogICAgCiAgCgp3aW5kb3cuU2NlbmVfTG9hZEdhbWUgPSBTY2VuZV9Mb2FkR2FtZQ==","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBTY2VuZV9Mb2FkR2FtZSwKICAgIF9faGFzUHJvcCA9IHt9Lmhhc093blByb3BlcnR5LAogICAgX19leHRlbmRzID0gZnVuY3Rpb24oY2hpbGQsIHBhcmVudCkgeyBmb3IgKHZhciBrZXkgaW4gcGFyZW50KSB7IGlmIChfX2hhc1Byb3AuY2FsbChwYXJlbnQsIGtleSkpIGNoaWxkW2tleV0gPSBwYXJlbnRba2V5XTsgfSBmdW5jdGlvbiBjdG9yKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gY2hpbGQ7IH0gY3Rvci5wcm90b3R5cGUgPSBwYXJlbnQucHJvdG90eXBlOyBjaGlsZC5wcm90b3R5cGUgPSBuZXcgY3RvcigpOyBjaGlsZC5fX3N1cGVyX18gPSBwYXJlbnQucHJvdG90eXBlOyByZXR1cm4gY2hpbGQ7IH07CgogIFNjZW5lX0xvYWRHYW1lID0gKGZ1bmN0aW9uKF9zdXBlcikgewogICAgX19leHRlbmRzKFNjZW5lX0xvYWRHYW1lLCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFNjZW5lX0xvYWRHYW1lKCkgewogICAgICBTY2VuZV9Mb2FkR2FtZS5fX3N1cGVyX18uY29uc3RydWN0b3IuY2FsbCh0aGlzKTsKICAgIH0KCiAgICBTY2VuZV9Mb2FkR2FtZS5wcm90b3R5cGUuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gdGhpcy5iaXRtYXAgPSBSZXNvdXJjZU1hbmFnZXIuZ2V0Qml0bWFwKCJHcmFwaGljcy9QaWN0dXJlcy8iICsgUmVjb3JkTWFuYWdlci5zeXN0ZW0udGl0bGVHcmFwaGljLm5hbWUpOwogICAgfTsKCiAgICBTY2VuZV9Mb2FkR2FtZS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uKCkgewogICAgICB0aGlzLnNwcml0ZS5kaXNwb3NlKCk7CiAgICAgIHJldHVybiB0aGlzLnNhdmVHYW1lc1dpbmRvd3NldC5kaXNwb3NlKCk7CiAgICB9OwoKICAgIFNjZW5lX0xvYWRHYW1lLnByb3RvdHlwZS5wcmVwYXJlRGF0YSA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgbWVtYmVyLCBzYXZlR2FtZSwgX2ksIF9qLCBfaywgX2xlbiwgX2xlbjEsIF9sZW4yLCBfcmVmLCBfcmVmMSwgX3JlZjIsIF9yZXN1bHRzOwogICAgICBzYXZlR2FtZSA9IEdhbWVNYW5hZ2VyLmdldFNhdmVHYW1lKDApOwogICAgICBpZiAoc2F2ZUdhbWUgIT0gbnVsbCkgewogICAgICAgIF9yZWYgPSBzYXZlR2FtZS5wYXJ0eS5tZW1iZXJzOwogICAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gX3JlZi5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykgewogICAgICAgICAgbWVtYmVyID0gX3JlZltfaV07CiAgICAgICAgICBpZiAoUmVjb3JkTWFuYWdlci5hY3RvcnNbbWVtYmVyLmFjdG9ySWRdICE9IG51bGwpIHsKICAgICAgICAgICAgbWVtYmVyLmNoYXJhY3RlckdyYXBoaWMgPSBSZWNvcmRNYW5hZ2VyLmFjdG9yc1ttZW1iZXIuYWN0b3JJZF0uY2hhcmFjdGVyR3JhcGhpYzsKICAgICAgICAgICAgUmVzb3VyY2VNYW5hZ2VyLmdldEJpdG1hcCgiR3JhcGhpY3MvQ2hhcmFjdGVycy8iICsgbWVtYmVyLmNoYXJhY3RlckdyYXBoaWMubmFtZSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICAgIHNhdmVHYW1lID0gR2FtZU1hbmFnZXIuZ2V0U2F2ZUdhbWUoMSk7CiAgICAgIGlmIChzYXZlR2FtZSAhPSBudWxsKSB7CiAgICAgICAgX3JlZjEgPSBzYXZlR2FtZS5wYXJ0eS5tZW1iZXJzOwogICAgICAgIGZvciAoX2ogPSAwLCBfbGVuMSA9IF9yZWYxLmxlbmd0aDsgX2ogPCBfbGVuMTsgX2orKykgewogICAgICAgICAgbWVtYmVyID0gX3JlZjFbX2pdOwogICAgICAgICAgaWYgKFJlY29yZE1hbmFnZXIuYWN0b3JzW21lbWJlci5hY3RvcklkXSAhPSBudWxsKSB7CiAgICAgICAgICAgIG1lbWJlci5jaGFyYWN0ZXJHcmFwaGljID0gUmVjb3JkTWFuYWdlci5hY3RvcnNbbWVtYmVyLmFjdG9ySWRdLmNoYXJhY3RlckdyYXBoaWM7CiAgICAgICAgICAgIFJlc291cmNlTWFuYWdlci5nZXRCaXRtYXAoIkdyYXBoaWNzL0NoYXJhY3RlcnMvIiArIG1lbWJlci5jaGFyYWN0ZXJHcmFwaGljLm5hbWUpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICBzYXZlR2FtZSA9IEdhbWVNYW5hZ2VyLmdldFNhdmVHYW1lKDIpOwogICAgICBpZiAoc2F2ZUdhbWUgIT0gbnVsbCkgewogICAgICAgIF9yZWYyID0gc2F2ZUdhbWUucGFydHkubWVtYmVyczsKICAgICAgICBfcmVzdWx0cyA9IFtdOwogICAgICAgIGZvciAoX2sgPSAwLCBfbGVuMiA9IF9yZWYyLmxlbmd0aDsgX2sgPCBfbGVuMjsgX2srKykgewogICAgICAgICAgbWVtYmVyID0gX3JlZjJbX2tdOwogICAgICAgICAgaWYgKFJlY29yZE1hbmFnZXIuYWN0b3JzW21lbWJlci5hY3RvcklkXSAhPSBudWxsKSB7CiAgICAgICAgICAgIG1lbWJlci5jaGFyYWN0ZXJHcmFwaGljID0gUmVjb3JkTWFuYWdlci5hY3RvcnNbbWVtYmVyLmFjdG9ySWRdLmNoYXJhY3RlckdyYXBoaWM7CiAgICAgICAgICAgIF9yZXN1bHRzLnB1c2goUmVzb3VyY2VNYW5hZ2VyLmdldEJpdG1hcCgiR3JhcGhpY3MvQ2hhcmFjdGVycy8iICsgbWVtYmVyLmNoYXJhY3RlckdyYXBoaWMubmFtZSkpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgX3Jlc3VsdHMucHVzaCh2b2lkIDApOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gX3Jlc3VsdHM7CiAgICAgIH0KICAgIH07CgogICAgU2NlbmVfTG9hZEdhbWUucHJvdG90eXBlLnByZXBhcmVWaXN1YWwgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIHNjYWxlLAogICAgICAgIF90aGlzID0gdGhpczsKICAgICAgc2NhbGUgPSBHcmFwaGljcy53aWR0aCA9PT0gMzIwID8gMC41IDogMS4wOwogICAgICB0aGlzLnNwcml0ZSA9IG5ldyBTcHJpdGU7CiAgICAgIHRoaXMuc3ByaXRlLmJpdG1hcCA9IHRoaXMuYml0bWFwOwogICAgICB0aGlzLnNwcml0ZS5zcmNSZWN0ID0gbmV3IFJlY3QoMCwgMCwgR3JhcGhpY3Mud2lkdGgsIEdyYXBoaWNzLmhlaWdodCk7CiAgICAgIHRoaXMuc2F2ZUdhbWVzV2luZG93c2V0ID0gbmV3IFdpbmRvd3NldF9TYXZlKE1hdGguZmxvb3IoKEdyYXBoaWNzLndpZHRoIC0gNDE2ICogc2NhbGUpIC8gMiksIE1hdGguZmxvb3IoKEdyYXBoaWNzLmhlaWdodCAtIDM2MCAqIHNjYWxlKSAvIDIpKTsKICAgICAgdGhpcy5zYXZlR2FtZXNXaW5kb3dzZXQub25GaWxlU2VsZWN0aW9uID0gZnVuY3Rpb24oc2xvdCkgewogICAgICAgIHJldHVybiBfdGhpcy5vbkZpbGVTZWxlY3Rpb24oc2xvdCk7CiAgICAgIH07CiAgICAgIHRoaXMuc2F2ZUdhbWVzV2luZG93c2V0Lm9uQ2FuY2VsID0gZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIF90aGlzLm9uQ2FuY2VsKCk7CiAgICAgIH07CiAgICAgIHRoaXMuc2F2ZUdhbWVzV2luZG93c2V0LmFjdGl2ZSA9IHRydWU7CiAgICAgIHRoaXMuc2F2ZUdhbWVzV2luZG93c2V0LmRlc2NyaXB0aW9uV2luZG93LnRleHQgPSBsY3MoUmVjb3JkTWFuYWdlci52b2NhYnVsYXJ5LnNhdmVHYW1lTWVudS5wbGVhc2VTZWxlY3RMb2FkKTsKICAgICAgcmV0dXJuIHRoaXMuc2F2ZUdhbWVzV2luZG93c2V0LnJlZHJhdygpOwogICAgfTsKCiAgICBTY2VuZV9Mb2FkR2FtZS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMuc2F2ZUdhbWVzV2luZG93c2V0LnVwZGF0ZSgpOwogICAgICByZXR1cm4gU2NlbmVfTG9hZEdhbWUuX19zdXBlcl9fLnVwZGF0ZS5jYWxsKHRoaXMpOwogICAgfTsKCiAgICBTY2VuZV9Mb2FkR2FtZS5wcm90b3R5cGUub25GaWxlU2VsZWN0aW9uID0gZnVuY3Rpb24oc2xvdCkgewogICAgICB2YXIgc2F2ZUdhbWU7CiAgICAgIHNhdmVHYW1lID0gR2FtZU1hbmFnZXIuZ2V0U2F2ZUdhbWUoc2xvdCk7CiAgICAgIGlmIChzYXZlR2FtZSAhPSBudWxsKSB7CiAgICAgICAgR2FtZU1hbmFnZXIubG9hZChzbG90KTsKICAgICAgICByZXR1cm4gU2NlbmVNYW5hZ2VyLnN3aXRjaFRvKG5ldyBTY2VuZV9NYXAoKSk7CiAgICAgIH0KICAgIH07CgogICAgU2NlbmVfTG9hZEdhbWUucHJvdG90eXBlLm9uQ2FuY2VsID0gZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiBTY2VuZU1hbmFnZXIuc3dpdGNoVG8obmV3IFNjZW5lX1RpdGxlKCkpOwogICAgfTsKCiAgICByZXR1cm4gU2NlbmVfTG9hZEdhbWU7CgogIH0pKFNjZW5lKTsKCiAgd2luZG93LlNjZW5lX0xvYWRHYW1lID0gU2NlbmVfTG9hZEdhbWU7Cgp9KS5jYWxsKHRoaXMpOwo="},{"name":"Scene_EndGame","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogU2NlbmVfRW5kR2FtZQojICAgCiMKIyAJQ29weXJpZ2h0IChDKSAyMDE0IEFuZHLpIFJhZG9tc2tpLiBBbGwgcmlnaHRzIHJlc2VydmVkLgojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQojCiMgCUNsYXNzOiBTY2VuZV9FbmRHYW1lCiMKIyAgIERlc2NyaXB0aW9uLi4uCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpjbGFzcyBTY2VuZV9FbmRHYW1lIGV4dGVuZHMgU2NlbmUKICAgIGNvbnN0cnVjdG9yOiAoYmFja2dyb3VuZCkgLT4KICAgICAgICBzdXBlcigpCiAgICAgICAgQGJhY2tncm91bmQgPSBiYWNrZ3JvdW5kCiAgICAKICAgIGluaXRpYWxpemU6IC0+CgogICAgZGlzcG9zZTogLT4KICAgICAgICBAd2luZG93LmRpc3Bvc2UoKQogICAgICAgIGlmIEBzcHJpdGU/CiAgICAgICAgICAgIEBzcHJpdGUuZGlzcG9zZSgpCiAgICBwcmVwYXJlRGF0YTogLT4KCiAgICBwcmVwYXJlVmlzdWFsOiAtPgogICAgICAgIGlmIEBiYWNrZ3JvdW5kPwogICAgICAgICAgICBAc3ByaXRlID0gbmV3IFNwcml0ZSgpCiAgICAgICAgICAgIEBzcHJpdGUuYml0bWFwID0gQGJhY2tncm91bmQKICAgICAgICAgICAgQHNwcml0ZS5zcmNSZWN0ID0gbmV3IFJlY3QoMCwgMCwgR3JhcGhpY3Mud2lkdGgsIEdyYXBoaWNzLmhlaWdodCkKICAgICAgICAgICAgQHNwcml0ZS56ID0gLTEwMDAKICAgICAgICAKICAgICAgICB2b2NhYiA9IFJlY29yZE1hbmFnZXIudm9jYWJ1bGFyeQogICAgICAgIEB3aW5kb3cgPSBuZXcgV2luZG93X1NlbGVjdGlvbigxMCwgMTAsIDEsIFtbbGNzKHZvY2FiLmVuZFNjcmVlbi5yZXR1cm5Ub1RpdGxlKV0gLFtsY3Modm9jYWIuZW5kU2NyZWVuLnF1aXQpXSAsW2xjcyh2b2NhYi5lbmRTY3JlZW4uY2FuY2VsKV1dKQogICAgICAgIEB3aW5kb3cueCA9IChHcmFwaGljcy53aWR0aCAtIEB3aW5kb3cud2lkdGgpIC8gMgogICAgICAgIEB3aW5kb3cueSA9IChHcmFwaGljcy5oZWlnaHQgLSBAd2luZG93LmhlaWdodCkgLyAyCiAgICAgICAgQHdpbmRvdy5vblNlbGVjdGlvbkFjY2VwdCA9ID0+IEBleGVjdXRlU2VsZWN0ZWRDb21tYW5kKCkKICAgICAgICBAd2luZG93LnJlZHJhdygpCiAgICAgICAgCiAgICB1cGRhdGU6IC0+ICAgICAgICAgICAgCiAgICAgICAgQHdpbmRvdy51cGRhdGUoKQogICAgICAgIHN1cGVyKCkKICAgICAgICAKICAgICAgICAKICAgIGV4ZWN1dGVTZWxlY3RlZENvbW1hbmQ6IC0+CiAgICAgICAgc3dpdGNoIEB3aW5kb3cuc2VsZWN0ZWRSb3cKICAgICAgICAgICAgd2hlbiAwCiAgICAgICAgICAgICAgICBBdWRpb01hbmFnZXIuc3RvcE11c2ljKCkKICAgICAgICAgICAgICAgIEF1ZGlvTWFuYWdlci5zdG9wQmFja2dyb3VuZFNvdW5kKCkKICAgICAgICAgICAgICAgIFNjZW5lTWFuYWdlci5zd2l0Y2hUbyhuZXcgU2NlbmVfVGl0bGUoKSkKICAgICAgICAgICAgd2hlbiAxCiAgICAgICAgICAgICAgICBTY2VuZU1hbmFnZXIuc3dpdGNoVG8obnVsbCkKICAgICAgICAgICAgICAgIEdhbWVNYW5hZ2VyLmV4aXQoKQogICAgICAgICAgICB3aGVuIDIKICAgICAgICAgICAgICAgIFNjZW5lTWFuYWdlci5yZXR1cm5Ub1ByZXZpb3VzKCkKICAgICAgICAKICAgICAgICAKICAgIAogIAoKd2luZG93LlNjZW5lX0VuZEdhbWUgPSBTY2VuZV9FbmRHYW1l","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBTY2VuZV9FbmRHYW1lLAogICAgX19oYXNQcm9wID0ge30uaGFzT3duUHJvcGVydHksCiAgICBfX2V4dGVuZHMgPSBmdW5jdGlvbihjaGlsZCwgcGFyZW50KSB7IGZvciAodmFyIGtleSBpbiBwYXJlbnQpIHsgaWYgKF9faGFzUHJvcC5jYWxsKHBhcmVudCwga2V5KSkgY2hpbGRba2V5XSA9IHBhcmVudFtrZXldOyB9IGZ1bmN0aW9uIGN0b3IoKSB7IHRoaXMuY29uc3RydWN0b3IgPSBjaGlsZDsgfSBjdG9yLnByb3RvdHlwZSA9IHBhcmVudC5wcm90b3R5cGU7IGNoaWxkLnByb3RvdHlwZSA9IG5ldyBjdG9yKCk7IGNoaWxkLl9fc3VwZXJfXyA9IHBhcmVudC5wcm90b3R5cGU7IHJldHVybiBjaGlsZDsgfTsKCiAgU2NlbmVfRW5kR2FtZSA9IChmdW5jdGlvbihfc3VwZXIpIHsKICAgIF9fZXh0ZW5kcyhTY2VuZV9FbmRHYW1lLCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFNjZW5lX0VuZEdhbWUoYmFja2dyb3VuZCkgewogICAgICBTY2VuZV9FbmRHYW1lLl9fc3VwZXJfXy5jb25zdHJ1Y3Rvci5jYWxsKHRoaXMpOwogICAgICB0aGlzLmJhY2tncm91bmQgPSBiYWNrZ3JvdW5kOwogICAgfQoKICAgIFNjZW5lX0VuZEdhbWUucHJvdG90eXBlLmluaXRpYWxpemUgPSBmdW5jdGlvbigpIHt9OwoKICAgIFNjZW5lX0VuZEdhbWUucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbigpIHsKICAgICAgdGhpcy53aW5kb3cuZGlzcG9zZSgpOwogICAgICBpZiAodGhpcy5zcHJpdGUgIT0gbnVsbCkgewogICAgICAgIHJldHVybiB0aGlzLnNwcml0ZS5kaXNwb3NlKCk7CiAgICAgIH0KICAgIH07CgogICAgU2NlbmVfRW5kR2FtZS5wcm90b3R5cGUucHJlcGFyZURhdGEgPSBmdW5jdGlvbigpIHt9OwoKICAgIFNjZW5lX0VuZEdhbWUucHJvdG90eXBlLnByZXBhcmVWaXN1YWwgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIHZvY2FiLAogICAgICAgIF90aGlzID0gdGhpczsKICAgICAgaWYgKHRoaXMuYmFja2dyb3VuZCAhPSBudWxsKSB7CiAgICAgICAgdGhpcy5zcHJpdGUgPSBuZXcgU3ByaXRlKCk7CiAgICAgICAgdGhpcy5zcHJpdGUuYml0bWFwID0gdGhpcy5iYWNrZ3JvdW5kOwogICAgICAgIHRoaXMuc3ByaXRlLnNyY1JlY3QgPSBuZXcgUmVjdCgwLCAwLCBHcmFwaGljcy53aWR0aCwgR3JhcGhpY3MuaGVpZ2h0KTsKICAgICAgICB0aGlzLnNwcml0ZS56ID0gLTEwMDA7CiAgICAgIH0KICAgICAgdm9jYWIgPSBSZWNvcmRNYW5hZ2VyLnZvY2FidWxhcnk7CiAgICAgIHRoaXMud2luZG93ID0gbmV3IFdpbmRvd19TZWxlY3Rpb24oMTAsIDEwLCAxLCBbW2xjcyh2b2NhYi5lbmRTY3JlZW4ucmV0dXJuVG9UaXRsZSldLCBbbGNzKHZvY2FiLmVuZFNjcmVlbi5xdWl0KV0sIFtsY3Modm9jYWIuZW5kU2NyZWVuLmNhbmNlbCldXSk7CiAgICAgIHRoaXMud2luZG93LnggPSAoR3JhcGhpY3Mud2lkdGggLSB0aGlzLndpbmRvdy53aWR0aCkgLyAyOwogICAgICB0aGlzLndpbmRvdy55ID0gKEdyYXBoaWNzLmhlaWdodCAtIHRoaXMud2luZG93LmhlaWdodCkgLyAyOwogICAgICB0aGlzLndpbmRvdy5vblNlbGVjdGlvbkFjY2VwdCA9IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiBfdGhpcy5leGVjdXRlU2VsZWN0ZWRDb21tYW5kKCk7CiAgICAgIH07CiAgICAgIHJldHVybiB0aGlzLndpbmRvdy5yZWRyYXcoKTsKICAgIH07CgogICAgU2NlbmVfRW5kR2FtZS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMud2luZG93LnVwZGF0ZSgpOwogICAgICByZXR1cm4gU2NlbmVfRW5kR2FtZS5fX3N1cGVyX18udXBkYXRlLmNhbGwodGhpcyk7CiAgICB9OwoKICAgIFNjZW5lX0VuZEdhbWUucHJvdG90eXBlLmV4ZWN1dGVTZWxlY3RlZENvbW1hbmQgPSBmdW5jdGlvbigpIHsKICAgICAgc3dpdGNoICh0aGlzLndpbmRvdy5zZWxlY3RlZFJvdykgewogICAgICAgIGNhc2UgMDoKICAgICAgICAgIEF1ZGlvTWFuYWdlci5zdG9wTXVzaWMoKTsKICAgICAgICAgIEF1ZGlvTWFuYWdlci5zdG9wQmFja2dyb3VuZFNvdW5kKCk7CiAgICAgICAgICByZXR1cm4gU2NlbmVNYW5hZ2VyLnN3aXRjaFRvKG5ldyBTY2VuZV9UaXRsZSgpKTsKICAgICAgICBjYXNlIDE6CiAgICAgICAgICBTY2VuZU1hbmFnZXIuc3dpdGNoVG8obnVsbCk7CiAgICAgICAgICByZXR1cm4gR2FtZU1hbmFnZXIuZXhpdCgpOwogICAgICAgIGNhc2UgMjoKICAgICAgICAgIHJldHVybiBTY2VuZU1hbmFnZXIucmV0dXJuVG9QcmV2aW91cygpOwogICAgICB9CiAgICB9OwoKICAgIHJldHVybiBTY2VuZV9FbmRHYW1lOwoKICB9KShTY2VuZSk7CgogIHdpbmRvdy5TY2VuZV9FbmRHYW1lID0gU2NlbmVfRW5kR2FtZTsKCn0pLmNhbGwodGhpcyk7Cg=="},{"name":"Scene_Title","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogU2NlbmVfVGl0bGUKIyAJQ3JlYXRlZCBvbjogMjAxMy0wNS0xOQojCiMgCUNvcHlyaWdodCAoQykgMjAxMyBBbmRy6SBSYWRvbXNraS4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KIwojIAlDbGFzczogU2NlbmVfVGl0bGUKIwojICAgRGVzY3JpcHRpb24uLi4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCmNsYXNzIFNjZW5lX1RpdGxlIGV4dGVuZHMgU2NlbmUKICAgIGNvbnN0cnVjdG9yOiAtPgogICAgICAgIHN1cGVyKCkKICAgIAogICAgaW5pdGlhbGl6ZTogLT4KICAgICAgICBEYXRhTWFuYWdlci5nZXREb2N1bWVudHNCeVR5cGUoImdsb2JhbF9tYXBfZXZlbnQiKQogICAgICAgIExhbmd1YWdlTWFuYWdlci5sb2FkKCkKICAgIAogICAgZGlzcG9zZTogLT4KICAgICAgICBAd2luZG93LmRpc3Bvc2UoKQogICAgICAgIEBzcHJpdGUuZGlzcG9zZSgpCiAgICAgICAgCiAgICBwcmVwYXJlRGF0YTogLT4KICAgICAgICBpZiBHYW1lTWFuYWdlci5tYXA/CiAgICAgICAgICAgIEdhbWVNYW5hZ2VyLnJlc2V0KCkKICAgICAgICAgICAgCiAgICAgICAgQHRpdGxlTXVzaWMgPSBSZWNvcmRNYW5hZ2VyLnN5c3RlbS50aXRsZU11c2ljCiAgICAgICAgQG1lbnVTZWxlY3RTb3VuZCA9IFJlY29yZE1hbmFnZXIuc3lzdGVtLm1lbnVTZWxlY3RTb3VuZAogICAgICAgIEBtZW51Q3Vyc29yU291bmQgPSBSZWNvcmRNYW5hZ2VyLnN5c3RlbS5tZW51Q3Vyc29yU291bmQKICAgICAgICAKICAgICAgICBBdWRpb01hbmFnZXIubG9hZE11c2ljKEB0aXRsZU11c2ljKQogICAgICAgIEF1ZGlvTWFuYWdlci5sb2FkU291bmQoQG1lbnVTZWxlY3RTb3VuZCkKICAgICAgICBBdWRpb01hbmFnZXIubG9hZFNvdW5kKEBtZW51Q3Vyc29yU291bmQpCiAgICAgICAgCiAgICAgICAgaWYgbm90IExhbmd1YWdlTWFuYWdlci5wcm9maWxlLmJ1bmRsZXM/CiAgICAgICAgICAgIEdhbWVNYW5hZ2VyLmluaXRpYWxpemUoKQogICAgICAgICAgICBHYW1lTWFuYWdlci50cm9vcCA9IFJlY29yZE1hbmFnZXIudHJvb3BzWzJdCiAgICAgICAgICAgIExhbmd1YWdlTWFuYWdlci5sb2FkQnVuZGxlcygpCiAgICAgICAgZWxzZQogICAgICAgICAgICBMYW5ndWFnZU1hbmFnZXIucHJlcGFyZSgpCiAgICAgICAgQGJpdG1hcCA9IFJlc291cmNlTWFuYWdlci5nZXRCaXRtYXAoIkdyYXBoaWNzL1BpY3R1cmVzLyN7UmVjb3JkTWFuYWdlci5zeXN0ZW0udGl0bGVHcmFwaGljLm5hbWV9IikKICAgIHByZXBhcmVWaXN1YWw6IC0+CiAgICAgICAgc2NhbGUgPSBXaW5kb3dfQmFzZS5zY2FsZQogICAgICAgIHZvY2FiID0gUmVjb3JkTWFuYWdlci52b2NhYnVsYXJ5CiAgICAgICAgQHdpbmRvdyA9IG5ldyBXaW5kb3dfU2VsZWN0aW9uKDEwLCAxMCwgMSwgW1tsY3Modm9jYWIudGl0bGVTY3JlZW4ubmV3R2FtZSldICxbbGNzKHZvY2FiLnRpdGxlU2NyZWVuLmNvbnRpbnVlKV0gLCBbIlNldHRpbmdzIl0sIFtsY3Modm9jYWIudGl0bGVTY3JlZW4uZW5kR2FtZSldXSwgMjAwKnNjYWxlLCAzMipzY2FsZSkKICAgICAgICBAd2luZG93LnggPSAoR3JhcGhpY3Mud2lkdGggLSBAd2luZG93LndpZHRoKSAvIDIKICAgICAgICBAd2luZG93LnkgPSBHcmFwaGljcy5oZWlnaHQgLSBAd2luZG93LmhlaWdodCAtIEdyYXBoaWNzLmhlaWdodCAvIDgKICAgICAgICBAd2luZG93Lm9uU2VsZWN0aW9uQWNjZXB0ID0gPT4gQGV4ZWN1dGVTZWxlY3RlZENvbW1hbmQoKQogICAgICAgIEB3aW5kb3cudmFsaWRhdGVDZWxsID0gKHgsIHkpID0+IGlmIHkgPT0gMSB0aGVuIEdhbWVNYW5hZ2VyLmhhc1NhdmVHYW1lcygpIGVsc2UgeWVzCiAgICAgICAgICAgIAogICAgICAgIEB3aW5kb3cucmVkcmF3KCkKICAgICAgICAKICAgICAgICAKICAgICAgICBAc3ByaXRlID0gbmV3IFNwcml0ZQogICAgICAgIEBzcHJpdGUuYml0bWFwID0gQGJpdG1hcAogICAgICAgIEBzcHJpdGUuc3JjUmVjdCA9IG5ldyBSZWN0KDAsIDAsIEdyYXBoaWNzLndpZHRoLCBHcmFwaGljcy5oZWlnaHQpCiAgICAgICAgQHNwcml0ZS56ID0gLTEwMDAKICAgICAgICAKICAgICAgICBBdWRpb01hbmFnZXIuY2hhbmdlTXVzaWMoQHRpdGxlTXVzaWMsIDMwKQogICAgICAgIAogICAgdXBkYXRlOiAtPiAgICAgICAgICAgIAogICAgICAgIEBzcHJpdGUudXBkYXRlKCkKICAgICAgICBAd2luZG93LnVwZGF0ZSgpCiAgICAgICAgR3JhcGhpY3Mudmlld3BvcnQudXBkYXRlKCkKICAgIAogICAgICAgIAogICAgICAgIHN1cGVyKCkKICAgICAgICAKICAgICAgICAKICAgIGV4ZWN1dGVTZWxlY3RlZENvbW1hbmQ6IC0+CiAgICAgICAgc3dpdGNoIEB3aW5kb3cuc2VsZWN0ZWRSb3cKICAgICAgICAgICAgd2hlbiAwCiAgICAgICAgICAgICAgICBTY2VuZU1hbmFnZXIuc3dpdGNoVG8obmV3IFNjZW5lX01hcCgpKQogICAgICAgICAgICB3aGVuIDEKICAgICAgICAgICAgICAgIFNjZW5lTWFuYWdlci5zd2l0Y2hUbyhuZXcgU2NlbmVfTG9hZEdhbWUoKSkKICAgICAgICAgICAgd2hlbiAyCiAgICAgICAgICAgICAgICBTY2VuZU1hbmFnZXIuc3dpdGNoVG8obmV3IFNjZW5lX1NldHRpbmdzKCkpCiAgICAgICAgICAgIHdoZW4gMwogICAgICAgICAgICAgICAgR2FtZU1hbmFnZXIuZXhpdCgpCiAgICAgICAgCiAgICAgICAgCiAgICAKICAKCndpbmRvdy5TY2VuZV9UaXRsZSA9IFNjZW5lX1RpdGxl","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBTY2VuZV9UaXRsZSwKICAgIF9faGFzUHJvcCA9IHt9Lmhhc093blByb3BlcnR5LAogICAgX19leHRlbmRzID0gZnVuY3Rpb24oY2hpbGQsIHBhcmVudCkgeyBmb3IgKHZhciBrZXkgaW4gcGFyZW50KSB7IGlmIChfX2hhc1Byb3AuY2FsbChwYXJlbnQsIGtleSkpIGNoaWxkW2tleV0gPSBwYXJlbnRba2V5XTsgfSBmdW5jdGlvbiBjdG9yKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gY2hpbGQ7IH0gY3Rvci5wcm90b3R5cGUgPSBwYXJlbnQucHJvdG90eXBlOyBjaGlsZC5wcm90b3R5cGUgPSBuZXcgY3RvcigpOyBjaGlsZC5fX3N1cGVyX18gPSBwYXJlbnQucHJvdG90eXBlOyByZXR1cm4gY2hpbGQ7IH07CgogIFNjZW5lX1RpdGxlID0gKGZ1bmN0aW9uKF9zdXBlcikgewogICAgX19leHRlbmRzKFNjZW5lX1RpdGxlLCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFNjZW5lX1RpdGxlKCkgewogICAgICBTY2VuZV9UaXRsZS5fX3N1cGVyX18uY29uc3RydWN0b3IuY2FsbCh0aGlzKTsKICAgIH0KCiAgICBTY2VuZV9UaXRsZS5wcm90b3R5cGUuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uKCkgewogICAgICBEYXRhTWFuYWdlci5nZXREb2N1bWVudHNCeVR5cGUoImdsb2JhbF9tYXBfZXZlbnQiKTsKICAgICAgcmV0dXJuIExhbmd1YWdlTWFuYWdlci5sb2FkKCk7CiAgICB9OwoKICAgIFNjZW5lX1RpdGxlLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMud2luZG93LmRpc3Bvc2UoKTsKICAgICAgcmV0dXJuIHRoaXMuc3ByaXRlLmRpc3Bvc2UoKTsKICAgIH07CgogICAgU2NlbmVfVGl0bGUucHJvdG90eXBlLnByZXBhcmVEYXRhID0gZnVuY3Rpb24oKSB7CiAgICAgIGlmIChHYW1lTWFuYWdlci5tYXAgIT0gbnVsbCkgewogICAgICAgIEdhbWVNYW5hZ2VyLnJlc2V0KCk7CiAgICAgIH0KICAgICAgdGhpcy50aXRsZU11c2ljID0gUmVjb3JkTWFuYWdlci5zeXN0ZW0udGl0bGVNdXNpYzsKICAgICAgdGhpcy5tZW51U2VsZWN0U291bmQgPSBSZWNvcmRNYW5hZ2VyLnN5c3RlbS5tZW51U2VsZWN0U291bmQ7CiAgICAgIHRoaXMubWVudUN1cnNvclNvdW5kID0gUmVjb3JkTWFuYWdlci5zeXN0ZW0ubWVudUN1cnNvclNvdW5kOwogICAgICBBdWRpb01hbmFnZXIubG9hZE11c2ljKHRoaXMudGl0bGVNdXNpYyk7CiAgICAgIEF1ZGlvTWFuYWdlci5sb2FkU291bmQodGhpcy5tZW51U2VsZWN0U291bmQpOwogICAgICBBdWRpb01hbmFnZXIubG9hZFNvdW5kKHRoaXMubWVudUN1cnNvclNvdW5kKTsKICAgICAgaWYgKExhbmd1YWdlTWFuYWdlci5wcm9maWxlLmJ1bmRsZXMgPT0gbnVsbCkgewogICAgICAgIEdhbWVNYW5hZ2VyLmluaXRpYWxpemUoKTsKICAgICAgICBHYW1lTWFuYWdlci50cm9vcCA9IFJlY29yZE1hbmFnZXIudHJvb3BzWzJdOwogICAgICAgIExhbmd1YWdlTWFuYWdlci5sb2FkQnVuZGxlcygpOwogICAgICB9IGVsc2UgewogICAgICAgIExhbmd1YWdlTWFuYWdlci5wcmVwYXJlKCk7CiAgICAgIH0KICAgICAgcmV0dXJuIHRoaXMuYml0bWFwID0gUmVzb3VyY2VNYW5hZ2VyLmdldEJpdG1hcCgiR3JhcGhpY3MvUGljdHVyZXMvIiArIFJlY29yZE1hbmFnZXIuc3lzdGVtLnRpdGxlR3JhcGhpYy5uYW1lKTsKICAgIH07CgogICAgU2NlbmVfVGl0bGUucHJvdG90eXBlLnByZXBhcmVWaXN1YWwgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIHNjYWxlLCB2b2NhYiwKICAgICAgICBfdGhpcyA9IHRoaXM7CiAgICAgIHNjYWxlID0gV2luZG93X0Jhc2Uuc2NhbGU7CiAgICAgIHZvY2FiID0gUmVjb3JkTWFuYWdlci52b2NhYnVsYXJ5OwogICAgICB0aGlzLndpbmRvdyA9IG5ldyBXaW5kb3dfU2VsZWN0aW9uKDEwLCAxMCwgMSwgW1tsY3Modm9jYWIudGl0bGVTY3JlZW4ubmV3R2FtZSldLCBbbGNzKHZvY2FiLnRpdGxlU2NyZWVuWyJjb250aW51ZSJdKV0sIFsiU2V0dGluZ3MiXSwgW2xjcyh2b2NhYi50aXRsZVNjcmVlbi5lbmRHYW1lKV1dLCAyMDAgKiBzY2FsZSwgMzIgKiBzY2FsZSk7CiAgICAgIHRoaXMud2luZG93LnggPSAoR3JhcGhpY3Mud2lkdGggLSB0aGlzLndpbmRvdy53aWR0aCkgLyAyOwogICAgICB0aGlzLndpbmRvdy55ID0gR3JhcGhpY3MuaGVpZ2h0IC0gdGhpcy53aW5kb3cuaGVpZ2h0IC0gR3JhcGhpY3MuaGVpZ2h0IC8gODsKICAgICAgdGhpcy53aW5kb3cub25TZWxlY3Rpb25BY2NlcHQgPSBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gX3RoaXMuZXhlY3V0ZVNlbGVjdGVkQ29tbWFuZCgpOwogICAgICB9OwogICAgICB0aGlzLndpbmRvdy52YWxpZGF0ZUNlbGwgPSBmdW5jdGlvbih4LCB5KSB7CiAgICAgICAgaWYgKHkgPT09IDEpIHsKICAgICAgICAgIHJldHVybiBHYW1lTWFuYWdlci5oYXNTYXZlR2FtZXMoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICB9OwogICAgICB0aGlzLndpbmRvdy5yZWRyYXcoKTsKICAgICAgdGhpcy5zcHJpdGUgPSBuZXcgU3ByaXRlOwogICAgICB0aGlzLnNwcml0ZS5iaXRtYXAgPSB0aGlzLmJpdG1hcDsKICAgICAgdGhpcy5zcHJpdGUuc3JjUmVjdCA9IG5ldyBSZWN0KDAsIDAsIEdyYXBoaWNzLndpZHRoLCBHcmFwaGljcy5oZWlnaHQpOwogICAgICB0aGlzLnNwcml0ZS56ID0gLTEwMDA7CiAgICAgIHJldHVybiBBdWRpb01hbmFnZXIuY2hhbmdlTXVzaWModGhpcy50aXRsZU11c2ljLCAzMCk7CiAgICB9OwoKICAgIFNjZW5lX1RpdGxlLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpIHsKICAgICAgdGhpcy5zcHJpdGUudXBkYXRlKCk7CiAgICAgIHRoaXMud2luZG93LnVwZGF0ZSgpOwogICAgICBHcmFwaGljcy52aWV3cG9ydC51cGRhdGUoKTsKICAgICAgcmV0dXJuIFNjZW5lX1RpdGxlLl9fc3VwZXJfXy51cGRhdGUuY2FsbCh0aGlzKTsKICAgIH07CgogICAgU2NlbmVfVGl0bGUucHJvdG90eXBlLmV4ZWN1dGVTZWxlY3RlZENvbW1hbmQgPSBmdW5jdGlvbigpIHsKICAgICAgc3dpdGNoICh0aGlzLndpbmRvdy5zZWxlY3RlZFJvdykgewogICAgICAgIGNhc2UgMDoKICAgICAgICAgIHJldHVybiBTY2VuZU1hbmFnZXIuc3dpdGNoVG8obmV3IFNjZW5lX01hcCgpKTsKICAgICAgICBjYXNlIDE6CiAgICAgICAgICByZXR1cm4gU2NlbmVNYW5hZ2VyLnN3aXRjaFRvKG5ldyBTY2VuZV9Mb2FkR2FtZSgpKTsKICAgICAgICBjYXNlIDI6CiAgICAgICAgICByZXR1cm4gU2NlbmVNYW5hZ2VyLnN3aXRjaFRvKG5ldyBTY2VuZV9TZXR0aW5ncygpKTsKICAgICAgICBjYXNlIDM6CiAgICAgICAgICByZXR1cm4gR2FtZU1hbmFnZXIuZXhpdCgpOwogICAgICB9CiAgICB9OwoKICAgIHJldHVybiBTY2VuZV9UaXRsZTsKCiAgfSkoU2NlbmUpOwoKICB3aW5kb3cuU2NlbmVfVGl0bGUgPSBTY2VuZV9UaXRsZTsKCn0pLmNhbGwodGhpcyk7Cg=="},{"name":"Scene_LanguageSelection","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogU2NlbmVfTGFuZ3VhZ2VTZWxlY3Rpb24KIyAgIENyZWF0ZWQgb246IDIwMTMtMTEtMDkKIwojIAlDb3B5cmlnaHQgKEMpIDIwMTMgQW5kcukgUmFkb21za2kuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAJQ2xhc3M6IFNjZW5lX0xhbmd1YWdlU2VsZWN0aW9uCiMKIyAgIERlc2NyaXB0aW9uLi4uCiMKIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpjbGFzcyBTY2VuZV9MYW5ndWFnZVNlbGVjdGlvbiBleHRlbmRzIFNjZW5lCiAgICBjb25zdHJ1Y3RvcjogLT4KICAgICAgICBzdXBlcigpCiAgICAKICAgIGluaXRpYWxpemU6IC0+CiAgICAgICAgQGxhbmd1YWdlc0xvYWRlZCA9IG5vCiAgICAgICAgCiAgICAgICAgaWYgbm90ICRQQVJBTVMudGVzdD8KICAgICAgICAgICAgRGF0YU1hbmFnZXIuZ2V0RG9jdW1lbnQoIlJFU09VUkNFUyIpCiAgICAgICAgICAgIAogICAgICAgIERhdGFNYW5hZ2VyLmdldERvY3VtZW50KCJTVU1NQVJJRVMiKQogICAgICAgICAgICAKICAgICAgICBpZiBub3QgJFBBUkFNUy5iYXR0bGVUZXN0CiAgICAgICAgICAgIEdyYXBoaWNzLmZyZWV6ZSgpCiAgICBkaXNwb3NlOiAtPgogICAgICAgIGlmIG5vdCAkUEFSQU1TLmJhdHRsZVRlc3Q/CiAgICAgICAgICAgIEBpbmZvV2luZG93LmRpc3Bvc2UoKQogICAgICAgICAgICBAd2luZG93LmRpc3Bvc2UoKQogICAgICAgICAgICBAc3ByaXRlLmRpc3Bvc2UoKQogICAgICAgIAogICAgcHJlcGFyZURhdGE6IC0+CiAgICAgICAgUmVjb3JkTWFuYWdlci5sb2FkKCkKICAgICAgICBAYml0bWFwID0gbnVsbCNSZXNvdXJjZU1hbmFnZXIuZ2V0Qml0bWFwKCJHcmFwaGljcy9Lb3J0ZVhfVGl0bGUiKQogICAgICAgIAogICAgICAgIGlmIEBsYW5ndWFnZXNMb2FkZWQKICAgICAgICAgICAgUmVzb3VyY2VNYW5hZ2VyLmxvYWRGb250cygpCiAgICAgICAgICAgIFJlY29yZE1hbmFnZXIucHJlcGFyZSgpCiAgICAgICAgICAgIExhbmd1YWdlTWFuYWdlci5pbml0aWFsaXplKCkKICAgICAgICAgICAgR2FtZU1hbmFnZXIud2luZG93U2tpbiA9IFJlc291cmNlTWFuYWdlci5nZXRCaXRtYXAoIkdyYXBoaWNzLyN7UmVjb3JkTWFuYWdlci5zeXN0ZW0ud2luZG93U2tpbkdyYXBoaWMubmFtZX0iKQogICAgICAgICAgICBHYW1lTWFuYWdlci53aW5kb3dTa2luVG9uZSA9IG5ldyBUb25lKDAsIDUwLCAxMDAsIDApCiAgICAgICAgZWxzZQogICAgICAgICAgICBEYXRhTWFuYWdlci5nZXREb2N1bWVudHNCeVR5cGUoImxhbmd1YWdlX3Byb2ZpbGUiKQogICAgICAgICAgICBEYXRhTWFuYWdlci5nZXREb2N1bWVudHNCeVR5cGUoImdsb2JhbF9tYXBfZXZlbnQiKQogICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgIGlmIEBsYW5ndWFnZXNMb2FkZWQKICAgICAgICAgICAgZm9yIGxhbmd1YWdlIGluIExhbmd1YWdlTWFuYWdlci5sYW5ndWFnZXMKICAgICAgICAgICAgICAgIGlmIGxhbmd1YWdlLmljb24/IGFuZCBsYW5ndWFnZS5pY29uLm5hbWU/IGFuZCBsYW5ndWFnZS5pY29uLm5hbWUubGVuZ3RoID4gMAogICAgICAgICAgICAgICAgICAgIFJlc291cmNlTWFuYWdlci5nZXRCaXRtYXAoIkdyYXBoaWNzL0ljb25zLyN7bGFuZ3VhZ2UuaWNvbi5uYW1lfSIpCiAgICAgICAgICAgIEZvbnRzLmluaXRpYWxpemUoKQogICAgICAgIEBsYW5ndWFnZXNMb2FkZWQgPSB5ZXMKICAgICAgICAKICAgIHByZXBhcmVWaXN1YWw6IC0+CiAgICAgIyAgIEBzcHJpdGUuYml0bWFwID0gQGJpdG1hcAogICAgICMgICBAc3ByaXRlLnNyY1JlY3QgPSBuZXcgUmVjdCgwLCAwLCBAYml0bWFwLndpZHRoLCBAYml0bWFwLmhlaWdodCkKICAgICAgICAKICAgICAgICAKICAgICAgICBpZiAkUEFSQU1TLmJhdHRsZVRlc3Q/CiAgICAgICAgICAgIExhbmd1YWdlTWFuYWdlci5zZWxlY3RMYW5ndWFnZShMYW5ndWFnZU1hbmFnZXIubGFuZ3VhZ2VzWzBdKQogICAgICAgICAgICBTY2VuZU1hbmFnZXIuc3dpdGNoVG8obmV3IFNjZW5lX0JhdHRsZVRlc3QoKSkKICAgICAgICBlbHNlCiAgICAgICAgICAgIEB3aW5kb3cgPSBuZXcgV2luZG93X0xhbmd1YWdlKDAsIDAsIExhbmd1YWdlTWFuYWdlci5sYW5ndWFnZXMpCiAgICAgICAgICAgIGhlaWdodCA9IEB3aW5kb3cuaGVpZ2h0ICsgNDQgKiBXaW5kb3dfQmFzZS5zY2FsZQogICAgICAgICAgICBAd2luZG93LnggPSAoR3JhcGhpY3Mud2lkdGggLSBAd2luZG93LndpZHRoKSAvIDIKICAgICAgICAgICAgQHdpbmRvdy55ID0gKEdyYXBoaWNzLmhlaWdodCAtIGhlaWdodCkgLyAyICsgNDQgKiBXaW5kb3dfQmFzZS5zY2FsZQogICAgICAgICAgICBAd2luZG93Lm9uU2VsZWN0aW9uQ2hhbmdlID0gKHNlbmRlciwgY2VsbCkgPT4gQG9uU2VsZWN0aW9uQ2hhbmdlKGNlbGwpCiAgICAgICAgICAgIEB3aW5kb3cub25TZWxlY3Rpb25BY2NlcHQgPSAoc2VuZGVyLCBjZWxsKSA9PiBAb25TZWxlY3Rpb25BY2NlcHQoY2VsbCkKICAgICAgICAgICAgCiAgICAgICAgICAgIEBpbmZvV2luZG93ID0gbmV3IFdpbmRvd19UZXh0KEB3aW5kb3cueCwgQHdpbmRvdy55IC0gNDQgKiBXaW5kb3dfQmFzZS5zY2FsZSwgQHdpbmRvdy53aWR0aCwgNDQgKiBXaW5kb3dfQmFzZS5zY2FsZSkKICAgICAgICAgICAgQGluZm9XaW5kb3cudGV4dCA9ICJQbGVhc2Ugc2VsZWN0IHlvdXIgbGFuZ3VhZ2UiCiAgICAgICAgICAgIEBpbmZvV2luZG93LnJlZHJhdygpCiAgICAgICAgICAgIEB3aW5kb3cucmVkcmF3KCkKICAgICAgICAgICAgQHNwcml0ZSA9IG5ldyBTcHJpdGUKICAgICAgICAgICAgQHNwcml0ZS5iaXRtYXAgPSBAYml0bWFwCiAgICAgICAgICAgIEBzcHJpdGUuc3JjUmVjdCA9IG5ldyBSZWN0KDAsIDAsIDY0MCwgNDgwKQogICAgICAgICAgICBAc3ByaXRlLnogPSAtMTAwMAogICAgICAgICAgICBHcmFwaGljcy50cmFuc2l0aW9uKDIwKQogICAgICAgICAgICAKICAgIHVwZGF0ZTogLT4KICAgICAgICAKICAgICAgICBpZiBub3QgJFBBUkFNUy5iYXR0bGVUZXN0PwogICAgICAgICAgICBAc3ByaXRlLnVwZGF0ZSgpCiAgICAgICAgICAgIEB3aW5kb3cudXBkYXRlKCkKICAgICAgICAgICAgR3JhcGhpY3Mudmlld3BvcnQudXBkYXRlKCkKICAgICAgICAKICAgICAgICAKICAgICAgICBzdXBlcigpCiAgICAgICAgCiAgICBvblNlbGVjdGlvbkNoYW5nZTogKGNlbGwpIC0+CiAgICBvblNlbGVjdGlvbkFjY2VwdDogKGNlbGwpIC0+CiAgICAgICAgTGFuZ3VhZ2VNYW5hZ2VyLnNlbGVjdExhbmd1YWdlKGNlbGwpCiAgICAgICAgU2NlbmVNYW5hZ2VyLnN3aXRjaFRvKG5ldyBTY2VuZV9UaXRsZSgpKQogICAgICAgIAogICAgCiAgCgp3aW5kb3cuU2NlbmVfTGFuZ3VhZ2VTZWxlY3Rpb24gPSBTY2VuZV9MYW5ndWFnZVNlbGVjdGlvbg==","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBTY2VuZV9MYW5ndWFnZVNlbGVjdGlvbiwKICAgIF9faGFzUHJvcCA9IHt9Lmhhc093blByb3BlcnR5LAogICAgX19leHRlbmRzID0gZnVuY3Rpb24oY2hpbGQsIHBhcmVudCkgeyBmb3IgKHZhciBrZXkgaW4gcGFyZW50KSB7IGlmIChfX2hhc1Byb3AuY2FsbChwYXJlbnQsIGtleSkpIGNoaWxkW2tleV0gPSBwYXJlbnRba2V5XTsgfSBmdW5jdGlvbiBjdG9yKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gY2hpbGQ7IH0gY3Rvci5wcm90b3R5cGUgPSBwYXJlbnQucHJvdG90eXBlOyBjaGlsZC5wcm90b3R5cGUgPSBuZXcgY3RvcigpOyBjaGlsZC5fX3N1cGVyX18gPSBwYXJlbnQucHJvdG90eXBlOyByZXR1cm4gY2hpbGQ7IH07CgogIFNjZW5lX0xhbmd1YWdlU2VsZWN0aW9uID0gKGZ1bmN0aW9uKF9zdXBlcikgewogICAgX19leHRlbmRzKFNjZW5lX0xhbmd1YWdlU2VsZWN0aW9uLCBfc3VwZXIpOwoKICAgIGZ1bmN0aW9uIFNjZW5lX0xhbmd1YWdlU2VsZWN0aW9uKCkgewogICAgICBTY2VuZV9MYW5ndWFnZVNlbGVjdGlvbi5fX3N1cGVyX18uY29uc3RydWN0b3IuY2FsbCh0aGlzKTsKICAgIH0KCiAgICBTY2VuZV9MYW5ndWFnZVNlbGVjdGlvbi5wcm90b3R5cGUuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uKCkgewogICAgICB0aGlzLmxhbmd1YWdlc0xvYWRlZCA9IGZhbHNlOwogICAgICBpZiAoJFBBUkFNUy50ZXN0ID09IG51bGwpIHsKICAgICAgICBEYXRhTWFuYWdlci5nZXREb2N1bWVudCgiUkVTT1VSQ0VTIik7CiAgICAgIH0KICAgICAgRGF0YU1hbmFnZXIuZ2V0RG9jdW1lbnQoIlNVTU1BUklFUyIpOwogICAgICBpZiAoISRQQVJBTVMuYmF0dGxlVGVzdCkgewogICAgICAgIHJldHVybiBHcmFwaGljcy5mcmVlemUoKTsKICAgICAgfQogICAgfTsKCiAgICBTY2VuZV9MYW5ndWFnZVNlbGVjdGlvbi5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uKCkgewogICAgICBpZiAoJFBBUkFNUy5iYXR0bGVUZXN0ID09IG51bGwpIHsKICAgICAgICB0aGlzLmluZm9XaW5kb3cuZGlzcG9zZSgpOwogICAgICAgIHRoaXMud2luZG93LmRpc3Bvc2UoKTsKICAgICAgICByZXR1cm4gdGhpcy5zcHJpdGUuZGlzcG9zZSgpOwogICAgICB9CiAgICB9OwoKICAgIFNjZW5lX0xhbmd1YWdlU2VsZWN0aW9uLnByb3RvdHlwZS5wcmVwYXJlRGF0YSA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgbGFuZ3VhZ2UsIF9pLCBfbGVuLCBfcmVmOwogICAgICBSZWNvcmRNYW5hZ2VyLmxvYWQoKTsKICAgICAgdGhpcy5iaXRtYXAgPSBudWxsOwogICAgICBpZiAodGhpcy5sYW5ndWFnZXNMb2FkZWQpIHsKICAgICAgICBSZXNvdXJjZU1hbmFnZXIubG9hZEZvbnRzKCk7CiAgICAgICAgUmVjb3JkTWFuYWdlci5wcmVwYXJlKCk7CiAgICAgICAgTGFuZ3VhZ2VNYW5hZ2VyLmluaXRpYWxpemUoKTsKICAgICAgICBHYW1lTWFuYWdlci53aW5kb3dTa2luID0gUmVzb3VyY2VNYW5hZ2VyLmdldEJpdG1hcCgiR3JhcGhpY3MvIiArIFJlY29yZE1hbmFnZXIuc3lzdGVtLndpbmRvd1NraW5HcmFwaGljLm5hbWUpOwogICAgICAgIEdhbWVNYW5hZ2VyLndpbmRvd1NraW5Ub25lID0gbmV3IFRvbmUoMCwgNTAsIDEwMCwgMCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgRGF0YU1hbmFnZXIuZ2V0RG9jdW1lbnRzQnlUeXBlKCJsYW5ndWFnZV9wcm9maWxlIik7CiAgICAgICAgRGF0YU1hbmFnZXIuZ2V0RG9jdW1lbnRzQnlUeXBlKCJnbG9iYWxfbWFwX2V2ZW50Iik7CiAgICAgIH0KICAgICAgaWYgKHRoaXMubGFuZ3VhZ2VzTG9hZGVkKSB7CiAgICAgICAgX3JlZiA9IExhbmd1YWdlTWFuYWdlci5sYW5ndWFnZXM7CiAgICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBfcmVmLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7CiAgICAgICAgICBsYW5ndWFnZSA9IF9yZWZbX2ldOwogICAgICAgICAgaWYgKChsYW5ndWFnZS5pY29uICE9IG51bGwpICYmIChsYW5ndWFnZS5pY29uLm5hbWUgIT0gbnVsbCkgJiYgbGFuZ3VhZ2UuaWNvbi5uYW1lLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgUmVzb3VyY2VNYW5hZ2VyLmdldEJpdG1hcCgiR3JhcGhpY3MvSWNvbnMvIiArIGxhbmd1YWdlLmljb24ubmFtZSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIEZvbnRzLmluaXRpYWxpemUoKTsKICAgICAgfQogICAgICByZXR1cm4gdGhpcy5sYW5ndWFnZXNMb2FkZWQgPSB0cnVlOwogICAgfTsKCiAgICBTY2VuZV9MYW5ndWFnZVNlbGVjdGlvbi5wcm90b3R5cGUucHJlcGFyZVZpc3VhbCA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgaGVpZ2h0LAogICAgICAgIF90aGlzID0gdGhpczsKICAgICAgaWYgKCRQQVJBTVMuYmF0dGxlVGVzdCAhPSBudWxsKSB7CiAgICAgICAgTGFuZ3VhZ2VNYW5hZ2VyLnNlbGVjdExhbmd1YWdlKExhbmd1YWdlTWFuYWdlci5sYW5ndWFnZXNbMF0pOwogICAgICAgIHJldHVybiBTY2VuZU1hbmFnZXIuc3dpdGNoVG8obmV3IFNjZW5lX0JhdHRsZVRlc3QoKSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy53aW5kb3cgPSBuZXcgV2luZG93X0xhbmd1YWdlKDAsIDAsIExhbmd1YWdlTWFuYWdlci5sYW5ndWFnZXMpOwogICAgICAgIGhlaWdodCA9IHRoaXMud2luZG93LmhlaWdodCArIDQ0ICogV2luZG93X0Jhc2Uuc2NhbGU7CiAgICAgICAgdGhpcy53aW5kb3cueCA9IChHcmFwaGljcy53aWR0aCAtIHRoaXMud2luZG93LndpZHRoKSAvIDI7CiAgICAgICAgdGhpcy53aW5kb3cueSA9IChHcmFwaGljcy5oZWlnaHQgLSBoZWlnaHQpIC8gMiArIDQ0ICogV2luZG93X0Jhc2Uuc2NhbGU7CiAgICAgICAgdGhpcy53aW5kb3cub25TZWxlY3Rpb25DaGFuZ2UgPSBmdW5jdGlvbihzZW5kZXIsIGNlbGwpIHsKICAgICAgICAgIHJldHVybiBfdGhpcy5vblNlbGVjdGlvbkNoYW5nZShjZWxsKTsKICAgICAgICB9OwogICAgICAgIHRoaXMud2luZG93Lm9uU2VsZWN0aW9uQWNjZXB0ID0gZnVuY3Rpb24oc2VuZGVyLCBjZWxsKSB7CiAgICAgICAgICByZXR1cm4gX3RoaXMub25TZWxlY3Rpb25BY2NlcHQoY2VsbCk7CiAgICAgICAgfTsKICAgICAgICB0aGlzLmluZm9XaW5kb3cgPSBuZXcgV2luZG93X1RleHQodGhpcy53aW5kb3cueCwgdGhpcy53aW5kb3cueSAtIDQ0ICogV2luZG93X0Jhc2Uuc2NhbGUsIHRoaXMud2luZG93LndpZHRoLCA0NCAqIFdpbmRvd19CYXNlLnNjYWxlKTsKICAgICAgICB0aGlzLmluZm9XaW5kb3cudGV4dCA9ICJQbGVhc2Ugc2VsZWN0IHlvdXIgbGFuZ3VhZ2UiOwogICAgICAgIHRoaXMuaW5mb1dpbmRvdy5yZWRyYXcoKTsKICAgICAgICB0aGlzLndpbmRvdy5yZWRyYXcoKTsKICAgICAgICB0aGlzLnNwcml0ZSA9IG5ldyBTcHJpdGU7CiAgICAgICAgdGhpcy5zcHJpdGUuYml0bWFwID0gdGhpcy5iaXRtYXA7CiAgICAgICAgdGhpcy5zcHJpdGUuc3JjUmVjdCA9IG5ldyBSZWN0KDAsIDAsIDY0MCwgNDgwKTsKICAgICAgICB0aGlzLnNwcml0ZS56ID0gLTEwMDA7CiAgICAgICAgcmV0dXJuIEdyYXBoaWNzLnRyYW5zaXRpb24oMjApOwogICAgICB9CiAgICB9OwoKICAgIFNjZW5lX0xhbmd1YWdlU2VsZWN0aW9uLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpIHsKICAgICAgaWYgKCRQQVJBTVMuYmF0dGxlVGVzdCA9PSBudWxsKSB7CiAgICAgICAgdGhpcy5zcHJpdGUudXBkYXRlKCk7CiAgICAgICAgdGhpcy53aW5kb3cudXBkYXRlKCk7CiAgICAgICAgR3JhcGhpY3Mudmlld3BvcnQudXBkYXRlKCk7CiAgICAgIH0KICAgICAgcmV0dXJuIFNjZW5lX0xhbmd1YWdlU2VsZWN0aW9uLl9fc3VwZXJfXy51cGRhdGUuY2FsbCh0aGlzKTsKICAgIH07CgogICAgU2NlbmVfTGFuZ3VhZ2VTZWxlY3Rpb24ucHJvdG90eXBlLm9uU2VsZWN0aW9uQ2hhbmdlID0gZnVuY3Rpb24oY2VsbCkge307CgogICAgU2NlbmVfTGFuZ3VhZ2VTZWxlY3Rpb24ucHJvdG90eXBlLm9uU2VsZWN0aW9uQWNjZXB0ID0gZnVuY3Rpb24oY2VsbCkgewogICAgICBMYW5ndWFnZU1hbmFnZXIuc2VsZWN0TGFuZ3VhZ2UoY2VsbCk7CiAgICAgIHJldHVybiBTY2VuZU1hbmFnZXIuc3dpdGNoVG8obmV3IFNjZW5lX1RpdGxlKCkpOwogICAgfTsKCiAgICByZXR1cm4gU2NlbmVfTGFuZ3VhZ2VTZWxlY3Rpb247CgogIH0pKFNjZW5lKTsKCiAgd2luZG93LlNjZW5lX0xhbmd1YWdlU2VsZWN0aW9uID0gU2NlbmVfTGFuZ3VhZ2VTZWxlY3Rpb247Cgp9KS5jYWxsKHRoaXMpOwo="},{"name":"CommandInterpreter","content":"IyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiMKIyAgIFNjcmlwdDogQ29tbWFuZEludGVycHJldGVyCiMgICBDcmVhdGVkIG9uOiAyMDEzLTA5LTA3CiMKIyAJQ29weXJpZ2h0IChDKSAyMDEzIEFuZHLpIFJhZG9tc2tpLiBBbGwgcmlnaHRzIHJlc2VydmVkLgojCiMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQojCiMgCUNsYXNzOiBDb21tYW5kSW50ZXJwcmV0ZXIKIwojICAgRGVzY3JpcHRpb24uLi4KIwojID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCmNsYXNzIENvbW1hbmRJbnRlcnByZXRlcgogICAgY29uc3RydWN0b3I6IChjb21tYW5kcykgLT4KICAgICAgICBAY29tbWFuZHMgPSBjb21tYW5kcwogICAgICAgIEBjb21tYW5kID0gbnVsbAogICAgICAgIEB3YWl0Q291bnRlciA9IDAKICAgICAgICBAd2FpdEZvckFjdGlvbktleSA9IG5vCiAgICAgICAgQHBvaW50ZXIgPSAwCiAgICAgICAgQGNvbmRpdGlvbnMgPSBbXQogICAgICAgIEBpc1J1bm5pbmcgPSBubwogICAgICAgIEBtZXNzYWdlV2luZG93ID0gR2FtZU1hbmFnZXIubWVzc2FnZVdpbmRvdwogICAgICAgIEBsYWJlbHMgPSB7fQogICAgICAgIEBpc1dhaXRpbmcgPSBubwogICAgICAgIEBpc1dhaXRpbmdGb3JNZXNzYWdlID0gbm8KICAgICAgICBAY2hvaWNlID0gbnVsbAogICAgICAgIEByZXBlYXQgPSBubwogICAgICAgIEBwYXJlbnRPYmplY3QgPSBudWxsCiAgICAgICAgQHN1YkludGVycHJldGVyID0gbnVsbAogICAgICAgIEB0ZW1wTnVtYmVycyA9IG51bGwKICAgICAgICBAdGVtcFN0cmluZ3MgPSBudWxsCiAgICAgICAgQHRlbXBCb29sZWFucyA9IG51bGwKICAgICAgICBAY29udGV4dCA9IHRoaXMKICAgIHN0YXJ0OiAtPgogICAgICAgIEBwb2ludGVyID0gMAogICAgICAgIEBpc1J1bm5pbmcgPSB5ZXMKICAgICAgICAKICAgIHN0b3A6IC0+CiAgICAgICAgQGlzUnVubmluZyA9IG5vCiAgICAgICAgCiAgICB1cGRhdGU6IC0+CiAgICAgICAgaWYgQHN1YkludGVycHJldGVyPwogICAgICAgICAgICBAc3ViSW50ZXJwcmV0ZXIudXBkYXRlKCkKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIAogICAgICAgIEdhbWVNYW5hZ2VyLnZhcmlhYmxlU3RvcmUudGVtcE51bWJlcnMgPSBAdGVtcE51bWJlcnMKICAgICAgICBHYW1lTWFuYWdlci52YXJpYWJsZVN0b3JlLnRlbXBTdHJpbmdzID0gQHRlbXBTdHJpbmdzCiAgICAgICAgR2FtZU1hbmFnZXIudmFyaWFibGVTdG9yZS50ZW1wQm9vbGVhbnMgPSBAdGVtcEJvb2xlYW5zCiAgICAgICAgICAgIAogICAgICAgIGlmIG5vdCBAY29tbWFuZHM/IG9yIEBwb2ludGVyID49IEBjb21tYW5kcy5sZW5ndGgKICAgICAgICAgICAgaWYgQHJlcGVhdAogICAgICAgICAgICAgICAgQHN0YXJ0KCkKICAgICAgICAgICAgZWxzZSBpZiBAaXNSdW5uaW5nCiAgICAgICAgICAgICAgICBAaXNSdW5uaW5nID0gbm8KICAgICAgICAgICAgICAgIGlmIEBvbkZpbmlzaD8gdGhlbiBAb25GaW5pc2godGhpcykKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgCiAgICAgICAgaWYgbm90IEBpc1J1bm5pbmcgdGhlbiByZXR1cm4KICAgICAgICAgCiAgICAgICAgaWYgQHdhaXRDb3VudGVyID4gMAogICAgICAgICAgICBAd2FpdENvdW50ZXItLQogICAgICAgICAgICBAaXNXYWl0aW5nID0gQHdhaXRDb3VudGVyID4gMAogICAgICAgICAgICByZXR1cm4gICAgICAKICAgICAgICAgICAgCiAgICAgICAgaWYgQGlzV2FpdGluZ0Zvck1lc3NhZ2UKICAgICAgICAgICAgQGlzV2FpdGluZyA9IHllcwogICAgICAgICAgICBpZiBub3QgQGlzUHJvY2Vzc2luZ01lc3NhZ2VJbk90aGVyQ29udGV4dCgpCiAgICAgICAgICAgICAgICBAaXNXYWl0aW5nID0gbm8KICAgICAgICAgICAgICAgIEBpc1dhaXRpbmdGb3JNZXNzYWdlID0gbm8KICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgCiAgICAgICAgIyMjCiAgICAgICAgaWYgQHdhaXRGb3JBY3Rpb25LZXkgYW5kIG5vdCBAbWVzc2FnZVdpbmRvdy5pc1J1bm5pbmcgYW5kIChJbnB1dC50cmlnZ2VyKElucHV0LkMpIG9yIElucHV0LnRyaWdnZXIoSW5wdXQuQikpCiAgICAgICAgICAgIElucHV0LmNsZWFyKCkKICAgICAgICAgICAgQHdhaXRGb3JBY3Rpb25LZXkgPSBubwogICAgICAgICAgICBAaXNXYWl0aW5nID0gbm8KICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIEBwb2ludGVyID49IEBjb21tYW5kcy5sZW5ndGggb3IgKEBjb21tYW5kc1tAcG9pbnRlcl0uaWQgIT0gImdzLlNob3dNZXNzYWdlIiBhbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQGNvbW1hbmRzW0Bwb2ludGVyXS5pZCAhPSAiZ3MuSW5wdXROdW1iZXIiIGFuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBAY29tbWFuZHNbQHBvaW50ZXJdLmlkICE9ICJncy5TaG93Q2hvaWNlcyIpCiAgICAgICAgICAgICAgICBAbWVzc2FnZVdpbmRvdy5jbG9zZSgpCiAgICAgICAgIyMjCiAgICAgICAgaWYgQHdhaXRGb3JBY3Rpb25LZXkgb3IgQG1lc3NhZ2VXaW5kb3cuaXNDbG9zaW5nCiAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICAKICAgICAgICB3aGlsZSBub3QgQGlzV2FpdGluZyBhbmQgQHBvaW50ZXIgPCBAY29tbWFuZHMubGVuZ3RoCiAgICAgICAgICAgIEBleGVjdXRlQ29tbWFuZChAcG9pbnRlcikKICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgIGV4ZWN1dGVDb21tYW5kOiAoaW5kZXgpIC0+CiAgICAgICAgQGNvbW1hbmQgPSBAY29tbWFuZHNbaW5kZXhdCgogICAgICAgIGlmIEBjb21tYW5kLmV4ZWN1dGU/CiAgICAgICAgICAgIEBjb21tYW5kLmludGVycHJldGVyID0gdGhpcwogICAgICAgICAgICBAY29tbWFuZC5leGVjdXRlKCkKICAgICAgICBlbHNlCiAgICAgICAgICAgIHN3aXRjaCBAY29tbWFuZC5ub2RlSWQKICAgICAgICAgICAgICAgIHdoZW4gImdzLldhaXRDb21tYW5kIiB0aGVuIEBjb21tYW5kLmV4ZWN1dGUgPSBAY29tbWFuZFdhaXQKICAgICAgICAgICAgICAgIHdoZW4gImdzLkxvb3BDb21tYW5kIiB0aGVuIEBjb21tYW5kLmV4ZWN1dGUgPSBAY29tbWFuZExvb3AKICAgICAgICAgICAgICAgIHdoZW4gImdzLkxvb3BFbmRDb21tYW5kIiB0aGVuIEBjb21tYW5kLmV4ZWN1dGUgPSBAY29tbWFuZExvb3BFbmQKICAgICAgICAgICAgICAgIHdoZW4gImdzLkJyZWFrTG9vcENvbW1hbmQiIHRoZW4gQGNvbW1hbmQuZXhlY3V0ZSA9IEBjb21tYW5kQnJlYWtMb29wCiAgICAgICAgICAgICAgICB3aGVuICJncy5Db21tZW50IiAKICAgICAgICAgICAgICAgICAgICBAY29tbWFuZHMucmVtb3ZlKEBjb21tYW5kKQogICAgICAgICAgICAgICAgICAgIEBwb2ludGVyLS0KICAgICAgICAgICAgICAgIHdoZW4gImdzLkVtcHR5Q29tbWFuZCIKICAgICAgICAgICAgICAgICAgICBAY29tbWFuZHMucmVtb3ZlKEBjb21tYW5kKQogICAgICAgICAgICAgICAgICAgIEBwb2ludGVyLS0KICAgICAgICAgICAgICAgIHdoZW4gImdzLk1vdmVFdmVudCIgdGhlbiBAY29tbWFuZC5leGVjdXRlID0gQGNvbW1hbmRNb3ZlRXZlbnQKICAgICAgICAgICAgICAgIHdoZW4gImdzLkNoYW5nZU1hcCIgdGhlbiBAY29tbWFuZC5leGVjdXRlID0gQGNvbW1hbmRDaGFuZ2VNYXAKICAgICAgICAgICAgICAgIHdoZW4gImdzLkNoYW5nZU51bWJlclZhcmlhYmxlcyIgdGhlbiBAY29tbWFuZC5leGVjdXRlID0gQGNvbW1hbmRDaGFuZ2VOdW1iZXJWYXJpYWJsZXMKICAgICAgICAgICAgICAgIHdoZW4gImdzLkNoYW5nZUJvb2xlYW5WYXJpYWJsZXMiIHRoZW4gQGNvbW1hbmQuZXhlY3V0ZSA9IEBjb21tYW5kQ2hhbmdlQm9vbGVhblZhcmlhYmxlcwogICAgICAgICAgICAgICAgd2hlbiAiZ3MuQ2hhbmdlU3RyaW5nVmFyaWFibGVzIiB0aGVuIEBjb21tYW5kLmV4ZWN1dGUgPSBAY29tbWFuZENoYW5nZVN0cmluZ1ZhcmlhYmxlcwogICAgICAgICAgICAgICAgd2hlbiAiZ3MuQ29uZGl0aW9uIiB0aGVuIEBjb21tYW5kLmV4ZWN1dGUgPSBAY29tbWFuZENvbmRpdGlvbgogICAgICAgICAgICAgICAgd2hlbiAiZ3MuRWxzZUNhc2UiIHRoZW4gQGNvbW1hbmQuZXhlY3V0ZSA9IEBjb21tYW5kQ29uZGl0aW9uRWxzZUNhc2UKICAgICAgICAgICAgICAgIHdoZW4gImdzLkVuZENvbmRpdGlvbiIgdGhlbiBAY29tbWFuZC5leGVjdXRlID0gQGNvbW1hbmRDb25kaXRpb25FbmQKICAgICAgICAgICAgICAgIHdoZW4gImdzLkxhYmVsIiB0aGVuIEBjb21tYW5kLmV4ZWN1dGUgPSBAY29tbWFuZExhYmVsCiAgICAgICAgICAgICAgICB3aGVuICJncy5KdW1wVG9MYWJlbCIgdGhlbiBAY29tbWFuZC5leGVjdXRlID0gQGNvbW1hbmRKdW1wVG9MYWJlbAogICAgICAgICAgICAgICAgd2hlbiAiZ3MuU2hvd01lc3NhZ2UiIHRoZW4gQGNvbW1hbmQuZXhlY3V0ZSA9IEBjb21tYW5kU2hvd01lc3NhZ2UKICAgICAgICAgICAgICAgIHdoZW4gImdzLlNob3dCdWJibGVNZXNzYWdlIiB0aGVuIEBjb21tYW5kLmV4ZWN1dGUgPSBAY29tbWFuZFNob3dCdWJibGVNZXNzYWdlCiAgICAgICAgICAgICAgICB3aGVuICJncy5DaGFuZ2VJdGVtcyIgdGhlbiBAY29tbWFuZC5leGVjdXRlID0gQGNvbW1hbmRDaGFuZ2VJdGVtcwogICAgICAgICAgICAgICAgd2hlbiAiZ3MuQ2hhbmdlV2VhcG9ucyIgdGhlbiBAY29tbWFuZC5leGVjdXRlID0gQGNvbW1hbmRDaGFuZ2VXZWFwb25zCiAgICAgICAgICAgICAgICB3aGVuICJncy5DaGFuZ2VBcm1vcnMiIHRoZW4gQGNvbW1hbmQuZXhlY3V0ZSA9IEBjb21tYW5kQ2hhbmdlQXJtb3JzCiAgICAgICAgICAgICAgICB3aGVuICJncy5DaGFuZ2VNb25leSIgdGhlbiBAY29tbWFuZC5leGVjdXRlID0gQGNvbW1hbmRDaGFuZ2VNb25leQogICAgICAgICAgICAgICAgd2hlbiAiZ3MuQ2hhbmdlV2VhdGhlciIgdGhlbiBAY29tbWFuZC5leGVjdXRlID0gQGNvbW1hbmRDaGFuZ2VXZWF0aGVyCiAgICAgICAgICAgICAgICB3aGVuICJncy5TaGFrZVNjcmVlbiIgdGhlbiBAY29tbWFuZC5leGVjdXRlID0gQGNvbW1hbmRTaGFrZVNjcmVlbgogICAgICAgICAgICAgICAgd2hlbiAiZ3MuVGludFNjcmVlbiIgdGhlbiBAY29tbWFuZC5leGVjdXRlID0gQGNvbW1hbmRUaW50U2NyZWVuCiAgICAgICAgICAgICAgICB3aGVuICJncy5GbGFzaFNjcmVlbiIgdGhlbiBAY29tbWFuZC5leGVjdXRlID0gQGNvbW1hbmRGbGFzaFNjcmVlbgogICAgICAgICAgICAgICAgd2hlbiAiZ3MuU2hvd1BpY3R1cmUiIHRoZW4gQGNvbW1hbmQuZXhlY3V0ZSA9IEBjb21tYW5kU2hvd1BpY3R1cmUKICAgICAgICAgICAgICAgIHdoZW4gImdzLk1vdmVQaWN0dXJlIiB0aGVuIEBjb21tYW5kLmV4ZWN1dGUgPSBAY29tbWFuZE1vdmVQaWN0dXJlCiAgICAgICAgICAgICAgICB3aGVuICJncy5UaW50UGljdHVyZSIgdGhlbiBAY29tbWFuZC5leGVjdXRlID0gQGNvbW1hbmRUaW50UGljdHVyZQogICAgICAgICAgICAgICAgd2hlbiAiZ3MuUm90YXRlUGljdHVyZSIgdGhlbiBAY29tbWFuZC5leGVjdXRlID0gQGNvbW1hbmRSb3RhdGVQaWN0dXJlCiAgICAgICAgICAgICAgICB3aGVuICJncy5FcmFzZVBpY3R1cmUiIHRoZW4gQGNvbW1hbmQuZXhlY3V0ZSA9IEBjb21tYW5kRXJhc2VQaWN0dXJlCiAgICAgICAgICAgICAgICB3aGVuICJncy5JbnB1dE51bWJlciIgdGhlbiBAY29tbWFuZC5leGVjdXRlID0gQGNvbW1hbmRJbnB1dE51bWJlcgogICAgICAgICAgICAgICAgd2hlbiAiZ3MuU2hvd0Nob2ljZXMiIHRoZW4gQGNvbW1hbmQuZXhlY3V0ZSA9IEBjb21tYW5kU2hvd0Nob2ljZXMKICAgICAgICAgICAgICAgIHdoZW4gImdzLkNob2ljZTEiIHRoZW4gQGNvbW1hbmQuZXhlY3V0ZSA9IEBjb21tYW5kQ2hvaWNlCiAgICAgICAgICAgICAgICB3aGVuICJncy5DaG9pY2UyIiB0aGVuIEBjb21tYW5kLmV4ZWN1dGUgPSBAY29tbWFuZENob2ljZQogICAgICAgICAgICAgICAgd2hlbiAiZ3MuQ2hvaWNlMyIgdGhlbiBAY29tbWFuZC5leGVjdXRlID0gQGNvbW1hbmRDaG9pY2UKICAgICAgICAgICAgICAgIHdoZW4gImdzLkNob2ljZTQiIHRoZW4gQGNvbW1hbmQuZXhlY3V0ZSA9IEBjb21tYW5kQ2hvaWNlCiAgICAgICAgICAgICAgICB3aGVuICJncy5DaG9pY2VDYW5jZWwiIHRoZW4gQGNvbW1hbmQuZXhlY3V0ZSA9IEBjb21tYW5kQ2hvaWNlCiAgICAgICAgICAgICAgICB3aGVuICJncy5PcGVuTWVudSIgdGhlbiBAY29tbWFuZC5leGVjdXRlID0gQGNvbW1hbmRPcGVuTWVudQogICAgICAgICAgICAgICAgd2hlbiAiZ3MuT3BlblNhdmVNZW51IiB0aGVuIEBjb21tYW5kLmV4ZWN1dGUgPSBAY29tbWFuZE9wZW5TYXZlTWVudQogICAgICAgICAgICAgICAgd2hlbiAiZ3MuUmV0dXJuVG9UaXRsZSIgdGhlbiBAY29tbWFuZC5leGVjdXRlID0gQGNvbW1hbmRSZXR1cm5Ub1RpdGxlCiAgICAgICAgICAgICAgICB3aGVuICJncy5HYW1lT3ZlciIgdGhlbiBAY29tbWFuZC5leGVjdXRlID0gQGNvbW1hbmRHYW1lT3ZlcgogICAgICAgICAgICAgICAgd2hlbiAiZ3MuT3BlblNob3AiIHRoZW4gQGNvbW1hbmQuZXhlY3V0ZSA9IEBjb21tYW5kT3BlblNob3AKICAgICAgICAgICAgICAgIHdoZW4gImdzLkNoYW5nZVdpbmRvd1NraW4iIHRoZW4gQGNvbW1hbmQuZXhlY3V0ZSA9IEBjb21tYW5kQ2hhbmdlV2luZG93U2tpbgogICAgICAgICAgICAgICAgd2hlbiAiZ3MuQ2hhbmdlQWN0b3JHcmFwaGljIiB0aGVuIEBjb21tYW5kLmV4ZWN1dGUgPSBAY29tbWFuZENoYW5nZUFjdG9yR3JhcGhpYwogICAgICAgICAgICAgICAgd2hlbiAiZ3MuQ2hhbmdlUGFydHkiIHRoZW4gQGNvbW1hbmQuZXhlY3V0ZSA9IEBjb21tYW5kQ2hhbmdlUGFydHkKICAgICAgICAgICAgICAgIHdoZW4gImdzLkNoYW5nZU1lbnVBY2Nlc3MiIHRoZW4gQGNvbW1hbmQuZXhlY3V0ZSA9IEBjb21tYW5kQ2hhbmdlTWVudUFjY2VzcwogICAgICAgICAgICAgICAgd2hlbiAiZ3MuQ2hhbmdlU2F2ZU1lbnVBY2Nlc3MiIHRoZW4gQGNvbW1hbmQuZXhlY3V0ZSA9IEBjb21tYW5kQ2hhbmdlU2F2ZU1lbnVBY2Nlc3MKICAgICAgICAgICAgICAgIHdoZW4gImdzLkNoYW5nZUFjdG9yTHAiIHRoZW4gQGNvbW1hbmQuZXhlY3V0ZSA9IEBjb21tYW5kQ2hhbmdlQWN0b3JMcAogICAgICAgICAgICAgICAgd2hlbiAiZ3MuQ2hhbmdlQWN0b3JNcCIgdGhlbiBAY29tbWFuZC5leGVjdXRlID0gQGNvbW1hbmRDaGFuZ2VBY3Rvck1wCiAgICAgICAgICAgICAgICB3aGVuICJncy5DaGFuZ2VBY3RvckV4cCIgdGhlbiBAY29tbWFuZC5leGVjdXRlID0gQGNvbW1hbmRDaGFuZ2VBY3RvckV4cAogICAgICAgICAgICAgICAgd2hlbiAiZ3MuQ2hhbmdlQWN0b3JDbGFzcyIgdGhlbiBAY29tbWFuZC5leGVjdXRlID0gQGNvbW1hbmRDaGFuZ2VBY3RvckNsYXNzCiAgICAgICAgICAgICAgICB3aGVuICJncy5DaGFuZ2VBY3Rvck5hbWUiIHRoZW4gQGNvbW1hbmQuZXhlY3V0ZSA9IEBjb21tYW5kQ2hhbmdlQWN0b3JOYW1lCiAgICAgICAgICAgICAgICB3aGVuICJncy5DaGFuZ2VBY3RvckxldmVsIiB0aGVuIEBjb21tYW5kLmV4ZWN1dGUgPSBAY29tbWFuZENoYW5nZUFjdG9yTGV2ZWwKICAgICAgICAgICAgICAgIHdoZW4gImdzLkNoYW5nZUFjdG9yU3RhdGUiIHRoZW4gQGNvbW1hbmQuZXhlY3V0ZSA9IEBjb21tYW5kQ2hhbmdlQWN0b3JTdGF0ZQogICAgICAgICAgICAgICAgd2hlbiAiZ3MuQ2hhbmdlQWN0b3JTa2lsbHMiIHRoZW4gQGNvbW1hbmQuZXhlY3V0ZSA9IEBjb21tYW5kQ2hhbmdlQWN0b3JTa2lsbHMKICAgICAgICAgICAgICAgIHdoZW4gImdzLkNoYW5nZUFjdG9yRXF1aXBtZW50IiB0aGVuIEBjb21tYW5kLmV4ZWN1dGUgPSBAY29tbWFuZENoYW5nZUFjdG9yRXF1aXBtZW50CiAgICAgICAgICAgICAgICB3aGVuICJncy5DaGFuZ2VBY3RvclBhcmFtZXRlcnMiIHRoZW4gQGNvbW1hbmQuZXhlY3V0ZSA9IEBjb21tYW5kQ2hhbmdlQWN0b3JQYXJhbWV0ZXJzCiAgICAgICAgICAgICAgICB3aGVuICJncy5QbGF5TXVzaWMiIHRoZW4gQGNvbW1hbmQuZXhlY3V0ZSA9IEBjb21tYW5kUGxheU11c2ljCiAgICAgICAgICAgICAgICB3aGVuICJncy5TdG9wTXVzaWMiIHRoZW4gQGNvbW1hbmQuZXhlY3V0ZSA9IEBjb21tYW5kU3RvcE11c2ljCiAgICAgICAgICAgICAgICB3aGVuICJncy5QbGF5U291bmQiIHRoZW4gQGNvbW1hbmQuZXhlY3V0ZSA9IEBjb21tYW5kUGxheVNvdW5kCiAgICAgICAgICAgICAgICB3aGVuICJncy5QbGF5QmFja2dyb3VuZFNvdW5kIiB0aGVuIEBjb21tYW5kLmV4ZWN1dGUgPSBAY29tbWFuZFBsYXlCYWNrZ3JvdW5kU291bmQKICAgICAgICAgICAgICAgIHdoZW4gImdzLlN0b3BCYWNrZ3JvdW5kU291bmQiIHRoZW4gQGNvbW1hbmQuZXhlY3V0ZSA9IEBjb21tYW5kU3RvcEJhY2tncm91bmRTb3VuZAogICAgICAgICAgICAgICAgd2hlbiAiZ3MuUGF1c2VNdXNpYyIgdGhlbiBAY29tbWFuZC5leGVjdXRlID0gQGNvbW1hbmRQYXVzZU11c2ljCiAgICAgICAgICAgICAgICB3aGVuICJncy5QYXVzZUJhY2tncm91bmRTb3VuZCIgdGhlbiBAY29tbWFuZC5leGVjdXRlID0gQGNvbW1hbmRQYXVzZUJhY2tncm91bmRTb3VuZAogICAgICAgICAgICAgICAgd2hlbiAiZ3MuUmVzdW1lTXVzaWMiIHRoZW4gQGNvbW1hbmQuZXhlY3V0ZSA9IEBjb21tYW5kUmVzdW1lTXVzaWMKICAgICAgICAgICAgICAgIHdoZW4gImdzLlJlc3VtZUJhY2tncm91bmRTb3VuZCIgdGhlbiBAY29tbWFuZC5leGVjdXRlID0gQGNvbW1hbmRSZXN1bWVCYWNrZ3JvdW5kU291bmQKICAgICAgICAgICAgICAgIHdoZW4gImdzLkNoYW5nZU1hcEVuY291bnRlciIgdGhlbiBAY29tbWFuZC5leGVjdXRlID0gQGNvbW1hbmRDaGFuZ2VNYXBFbmNvdW50ZXIKICAgICAgICAgICAgICAgIHdoZW4gImdzLkNoYW5nZU1hcFRpbGVzZXQiIHRoZW4gQGNvbW1hbmQuZXhlY3V0ZSA9IEBjb21tYW5kQ2hhbmdlTWFwVGlsZXNldAogICAgICAgICAgICAgICAgd2hlbiAiZ3MuQ2hhbmdlTWFwVGlsZXMiIHRoZW4gQGNvbW1hbmQuZXhlY3V0ZSA9IEBjb21tYW5kQ2hhbmdlTWFwVGlsZXMKICAgICAgICAgICAgICAgIHdoZW4gImdzLkNoYW5nZU1hcFBhcmFsbGF4QmFja2dyb3VuZCIgdGhlbiBAY29tbWFuZC5leGVjdXRlID0gQGNvbW1hbmRDaGFuZ2VNYXBQYXJhbGxheEJhY2tncm91bmQKICAgICAgICAgICAgICAgIHdoZW4gImdzLkdldE1hcExvY2F0aW9uSW5mbyIgdGhlbiBAY29tbWFuZC5leGVjdXRlID0gQGNvbW1hbmRHZXRNYXBMb2NhdGlvbkluZm8KICAgICAgICAgICAgICAgIHdoZW4gImdzLlN0YXJ0QmF0dGxlIiB0aGVuIEBjb21tYW5kLmV4ZWN1dGUgPSBAY29tbWFuZFN0YXJ0QmF0dGxlCiAgICAgICAgICAgICAgICB3aGVuICJncy5DaGFuZ2VFbmVteUxwIiB0aGVuIEBjb21tYW5kLmV4ZWN1dGUgPSBAY29tbWFuZENoYW5nZUVuZW15THAKICAgICAgICAgICAgICAgIHdoZW4gImdzLkNoYW5nZUVuZW15TXAiIHRoZW4gQGNvbW1hbmQuZXhlY3V0ZSA9IEBjb21tYW5kQ2hhbmdlRW5lbXlNcAogICAgICAgICAgICAgICAgd2hlbiAiZ3MuQ2hhbmdlRW5lbXlTdGF0ZSIgdGhlbiBAY29tbWFuZC5leGVjdXRlID0gQGNvbW1hbmRDaGFuZ2VFbmVteVN0YXRlCiAgICAgICAgICAgICAgICB3aGVuICJncy5TaG93RW5lbXkiIHRoZW4gQGNvbW1hbmQuZXhlY3V0ZSA9IEBjb21tYW5kU2hvd0VuZW15CiAgICAgICAgICAgICAgICB3aGVuICJncy5UcmFuc2Zvcm1FbmVteSIgdGhlbiBAY29tbWFuZC5leGVjdXRlID0gQGNvbW1hbmRUcmFuc2Zvcm1FbmVteQogICAgICAgICAgICAgICAgd2hlbiAiZ3MuU2hvd0JhdHRsZUFuaW1hdGlvbiIgdGhlbiBAY29tbWFuZC5leGVjdXRlID0gQGNvbW1hbmRTaG93QmF0dGxlQW5pbWF0aW9uCiAgICAgICAgICAgICAgICB3aGVuICJncy5BYm9ydEJhdHRsZSIgdGhlbiBAY29tbWFuZC5leGVjdXRlID0gQGNvbW1hbmRBYm9ydEJhdHRsZQogICAgICAgICAgICAgICAgd2hlbiAiZ3MuU2Nyb2xsTWFwIiB0aGVuIEBjb21tYW5kLmV4ZWN1dGUgPSBAY29tbWFuZFNjcm9sbE1hcAogICAgICAgICAgICAgICAgd2hlbiAiZ3MuU2V0RXZlbnRMb2NhdGlvbiIgdGhlbiBAY29tbWFuZC5leGVjdXRlID0gQGNvbW1hbmRTZXRFdmVudExvY2F0aW9uCiAgICAgICAgICAgICAgICB3aGVuICJncy5TZXRHbG9iYWxFdmVudExvY2F0aW9uIiB0aGVuIEBjb21tYW5kLmV4ZWN1dGUgPSBAY29tbWFuZFNldEdsb2JhbEV2ZW50TG9jYXRpb24KICAgICAgICAgICAgICAgIHdoZW4gImdzLkNyZWF0ZUV2ZW50IiB0aGVuIEBjb21tYW5kLmV4ZWN1dGUgPSBAY29tbWFuZENyZWF0ZUV2ZW50CiAgICAgICAgICAgICAgICB3aGVuICJncy5FcmFzZUV2ZW50IiB0aGVuIEBjb21tYW5kLmV4ZWN1dGUgPSBAY29tbWFuZEVyYXNlRXZlbnQKICAgICAgICAgICAgICAgIHdoZW4gImdzLkVuZEV2ZW50IiB0aGVuIEBjb21tYW5kLmV4ZWN1dGUgPSBAY29tbWFuZEVuZEV2ZW50CiAgICAgICAgICAgICAgICB3aGVuICJncy5DYWxsQ29tbW9uRXZlbnQiIHRoZW4gQGNvbW1hbmQuZXhlY3V0ZSA9IEBjb21tYW5kQ2FsbENvbW1vbkV2ZW50CiAgICAgICAgICAgICAgICB3aGVuICJncy5DaGFuZ2VUaW1lciIgdGhlbiBAY29tbWFuZC5leGVjdXRlID0gQGNvbW1hbmRDaGFuZ2VUaW1lcgogICAgICAgICAgICAgICAgd2hlbiAiZ3MuU2hvd0FuaW1hdGlvbiIgdGhlbiBAY29tbWFuZC5leGVjdXRlID0gQGNvbW1hbmRTaG93QW5pbWF0aW9uTWFwRXZlbnQKICAgICAgICAgICAgICAgIHdoZW4gImdzLlNob3dUZXh0IiB0aGVuIEBjb21tYW5kLmV4ZWN1dGUgPSBAY29tbWFuZFNob3dUZXh0CiAgICAgICAgICAgICAgICB3aGVuICJncy5Nb3ZlVGV4dCIgdGhlbiBAY29tbWFuZC5leGVjdXRlID0gQGNvbW1hbmRNb3ZlVGV4dAogICAgICAgICAgICAgICAgd2hlbiAiZ3MuUm90YXRlVGV4dCIgdGhlbiBAY29tbWFuZC5leGVjdXRlID0gQGNvbW1hbmRSb3RhdGVUZXh0CiAgICAgICAgICAgICAgICB3aGVuICJncy5Db2xvclRleHQiIHRoZW4gQGNvbW1hbmQuZXhlY3V0ZSA9IEBjb21tYW5kQ29sb3JUZXh0CiAgICAgICAgICAgICAgICB3aGVuICJncy5FcmFzZVRleHQiIHRoZW4gQGNvbW1hbmQuZXhlY3V0ZSA9IEBjb21tYW5kRXJhc2VUZXh0ICAgCiAgICAgICAgICAgICAgICB3aGVuICJncy5DaGFuZ2VUZXh0U2V0dGluZ3MiIHRoZW4gQGNvbW1hbmQuZXhlY3V0ZSA9IEBjb21tYW5kQ2hhbmdlVGV4dFNldHRpbmdzCiAgICAgICAgICAgICAgICB3aGVuICJncy5JbnB1dFRleHQiIHRoZW4gQGNvbW1hbmQuZXhlY3V0ZSA9IEBjb21tYW5kSW5wdXRUZXh0CiAgICAgICAgICAgICAgICB3aGVuICJncy5JbnB1dE5hbWUiIHRoZW4gQGNvbW1hbmQuZXhlY3V0ZSA9IEBjb21tYW5kSW5wdXROYW1lCiAgICAgICAgICAgICAgICB3aGVuICJncy5DaGFuZ2VQbGF5ZXIiIHRoZW4gQGNvbW1hbmQuZXhlY3V0ZSA9IEBjb21tYW5kQ2hhbmdlUGxheWVyCiAgICAgICAgICAgICAgICB3aGVuICJncy5DaGFuZ2VHbG9iYWxFdmVudFZpc2liaWxpdHkiIHRoZW4gQGNvbW1hbmQuZXhlY3V0ZSA9IEBjb21tYW5kQ2hhbmdlR2xvYmFsRXZlbnRWaXNpYmlsaXR5CiAgICAgICAgICAgICAgICB3aGVuICJncy5TY3JpcHQiIHRoZW4gQGNvbW1hbmQuZXhlY3V0ZSA9IEBjb21tYW5kU2NyaXB0CiAgICAgICAgICAgICAgICB3aGVuICJncy5Gb3JjZUFjdGlvbiIgdGhlbiBAY29tbWFuZC5leGVjdXRlID0gQGNvbW1hbmRGb3JjZUFjdGlvbgogICAgICAgICAgICAgICAgd2hlbiAiZ3MuQ2hhbmdlQmF0dGxlTXVzaWMiIHRoZW4gQGNvbW1hbmQuZXhlY3V0ZSA9IEBjb21tYW5kQ2hhbmdlQmF0dGxlTXVzaWMKICAgICAgICAgICAgICAgIHdoZW4gImdzLkNoYW5nZUJhdHRsZVRlcnJhaW4iIHRoZW4gQGNvbW1hbmQuZXhlY3V0ZSA9IEBjb21tYW5kQ2hhbmdlQmF0dGxlVGVycmFpbgogICAgICAgICAgICAgICAgd2hlbiAiZ3MuTW92ZUdsb2JhbEV2ZW50IiB0aGVuIEBjb21tYW5kLmV4ZWN1dGUgPSBAY29tbWFuZE1vdmVHbG9iYWxFdmVudAogICAgICAgICAgICAgICAgd2hlbiAiZ3MuRXJhc2VHbG9iYWxFdmVudCIgdGhlbiBAY29tbWFuZC5leGVjdXRlID0gQGNvbW1hbmRFcmFzZUdsb2JhbEV2ZW50CiAgICAgICAgICAgICAgICB3aGVuICJncy5FbmRHbG9iYWxFdmVudCIgdGhlbiBAY29tbWFuZC5leGVjdXRlID0gQGNvbW1hbmRFbmRHbG9iYWxFdmVudAogICAgICAgICAgICAgICAgd2hlbiAiZ3MuU2hvd0FuaW1hdGlvbkdsb2JhbEV2ZW50IiB0aGVuIEBjb21tYW5kLmV4ZWN1dGUgPSBAY29tbWFuZFNob3dBbmltYXRpb25HbG9iYWxFdmVudAogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgaWYgQGNvbW1hbmQuZXhlY3V0ZT8KICAgICAgICAgICAgICAgIEBjb21tYW5kLmludGVycHJldGVyID0gdGhpcwogICAgICAgICAgICAgICAgQGNvbW1hbmQuZXhlY3V0ZSgpCiAgICAgICAgQHBvaW50ZXIrKwogICAgCiAgICBza2lwOiAoaW5kZW50LCBiYWNrd2FyZCkgLT4KICAgICAgICBpZiBiYWNrd2FyZAogICAgICAgICAgICBAcG9pbnRlci0tCiAgICAgICAgICAgIHdoaWxlIEBwb2ludGVyID4gMCBhbmQgQGNvbW1hbmRzW0Bwb2ludGVyXS5pbmRlbnQgIT0gaW5kZW50CiAgICAgICAgICAgICAgICBAcG9pbnRlci0tCiAgICAgICAgZWxzZQogICAgICAgICAgICBAcG9pbnRlcisrCiAgICAgICAgICAgIHdoaWxlIEBwb2ludGVyIDwgQGNvbW1hbmQubGVuZ3RoIGFuZCBAY29tbWFuZHNbQHBvaW50ZXJdLmluZGVudCAhPSBpbmRlbnQKICAgICAgICAgICAgICAgIEBwb2ludGVyKysKICAgICAgICAgICAgICAgIAogICAgZ29Ub05leHROb2RlOiAobm9kZUlkLCBpbmRlbnQpIC0+CiAgICAgICAgQHNraXAoaW5kZW50KQogICAgICAgIHdoaWxlIEBwb2ludGVyIDwgQGNvbW1hbmRzLmxlbmd0aCBhbmQgQGNvbW1hbmRzW0Bwb2ludGVyXS5ub2RlSWQgIT0gbm9kZUlkCiAgICAgICAgICAgIEBza2lwKGluZGVudCkKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgICAgICAKICAgIG51bWJlclZhbHVlQXRJbmRleDogKHNjb3BlLCBpbmRleCkgLT4gR2FtZU1hbmFnZXIudmFyaWFibGVTdG9yZS5udW1iZXJWYWx1ZUF0SW5kZXgoc2NvcGUsIGluZGV4KQogICAgbnVtYmVyVmFsdWVPZjogKG9iamVjdCkgLT4gR2FtZU1hbmFnZXIudmFyaWFibGVTdG9yZS5udW1iZXJWYWx1ZU9mKG9iamVjdCkKICAgICAgICAKICAgIHNldE51bWJlclZhbHVlQXRJbmRleDogKHNjb3BlLCBpbmRleCwgdmFsdWUpIC0+IEdhbWVNYW5hZ2VyLnZhcmlhYmxlU3RvcmUuc2V0TnVtYmVyVmFsdWVBdEluZGV4KHNjb3BlLCBpbmRleCwgdmFsdWUpCiAgICBzZXROdW1iZXJWYWx1ZVRvOiAodmFyaWFibGUsIHZhbHVlKSAtPiBHYW1lTWFuYWdlci52YXJpYWJsZVN0b3JlLnNldE51bWJlclZhbHVlVG8odmFyaWFibGUsIHZhbHVlKQoKICAgIHNldEJvb2xlYW5WYWx1ZVRvOiAodmFyaWFibGUsIHZhbHVlKSAtPiBHYW1lTWFuYWdlci52YXJpYWJsZVN0b3JlLnNldEJvb2xlYW5WYWx1ZVRvKHZhcmlhYmxlLCB2YWx1ZSkKICAgIHNldFN0cmluZ1ZhbHVlVG86ICh2YXJpYWJsZSwgdmFsdWUpIC0+IEdhbWVNYW5hZ2VyLnZhcmlhYmxlU3RvcmUuc2V0U3RyaW5nVmFsdWVUbyh2YXJpYWJsZSwgdmFsdWUpCiAgICAgICAgICAgIAogICAgc3RyaW5nVmFsdWVPZjogKG9iamVjdCkgLT4gR2FtZU1hbmFnZXIudmFyaWFibGVTdG9yZS5zdHJpbmdWYWx1ZU9mKG9iamVjdCkKICAgICAgICAKICAgIGJvb2xlYW5WYWx1ZU9mOiAob2JqZWN0KSAtPiBHYW1lTWFuYWdlci52YXJpYWJsZVN0b3JlLmJvb2xlYW5WYWx1ZU9mKG9iamVjdCkKICAgIAogICAgY29tcGFyZTogKGEsIGIsIG9wZXJhdGlvbikgLT4KICAgICAgICBzd2l0Y2ggb3BlcmF0aW9uCiAgICAgICAgICAgIHdoZW4gMCB0aGVuIHJldHVybiBhID09IGIKICAgICAgICAgICAgd2hlbiAxIHRoZW4gcmV0dXJuIGEgIT0gYgogICAgICAgICAgICB3aGVuIDIgdGhlbiByZXR1cm4gYSA+IGIKICAgICAgICAgICAgd2hlbiAzIHRoZW4gcmV0dXJuIGEgPj0gYgogICAgICAgICAgICB3aGVuIDQgdGhlbiByZXR1cm4gYSA8IGIKICAgICAgICAgICAgd2hlbiA1IHRoZW4gcmV0dXJuIGEgPD0gYgogICAgICAgICAgICAKICAgIGV2ZW50QnlJZDogKGlkKSAtPgogICAgICAgIGV2ZW50ID0gbnVsbAogICAgICAgICMgSWYgdGhpcyBldmVudAogICAgICAgIGlmIGlkID09IC0xCiAgICAgICAgICAgIGV2ZW50ID0gR2FtZU1hbmFnZXIubWFwLmN1cnJlbnRFdmVudAogICAgICAgICMgSWYgY3VycmVudCBwbGF5ZXIKICAgICAgICBlbHNlIGlmIGlkID09IC0yCiAgICAgICAgICAgIGV2ZW50ID0gR2FtZU1hbmFnZXIucGxheWVyCiAgICAgICAgIyBJZiBvdGhlciBldmVudAogICAgICAgIGVsc2UKICAgICAgICAgICAgZXZlbnQgPSBHYW1lTWFuYWdlci5tYXAuZXZlbnRzQnlJZFtpZF0KICAgICAgICAKICAgICAgICByZXR1cm4gZXZlbnQKICAgIAogICAgZ2xvYmFsRXZlbnRCeUlkOiAoaWQpIC0+CiAgICAgICAgZXZlbnQgPSBudWxsCiAgICAgICAgIyBJZiB0aGlzIGV2ZW50CiAgICAgICAjIGlmIGlkID09IC0xCiAgICAgICAgIyAgICBldmVudCA9IEdhbWVNYW5hZ2VyLmdsb2JhbEV2ZW50c1sKICAgICAgICAjIElmIGN1cnJlbnQgcGxheWVyCiAgICAgICAjIGVsc2UgaWYgaWQgPT0gLTIKICAgICAgICMgICAgIGV2ZW50ID0gR2FtZU1hbmFnZXIucGxheWVyCiAgICAgICAgIyBJZiBvdGhlciBldmVudAogICAgICAgICNlbHNlCgogICAgICAgIGV2ZW50ID0gR2FtZU1hbmFnZXIuZ2xvYmFsRXZlbnRzQnlJZFtpZF0KICAgICAgICAKICAgICAgICByZXR1cm4gZXZlbnQKICAgICAgICAKICAgIG51bWJlclZhbHVlT2ZHYW1lRGF0YTooZ2FtZURhdGEpIC0+CiAgICAgICAgdmFsdWUgPSAwCiAgICAgICAgCiAgICAgICAgc3dpdGNoIGdhbWVEYXRhLmNvZGUKICAgICAgICAgICAgd2hlbiAwICMgQWN0b3IgUGFyYW1ldGVyCiAgICAgICAgICAgICAgICBtZW1iZXIgPSBHYW1lTWFuYWdlci5wYXJ0eS5tZW1iZXJXaXRoSWQoQG51bWJlclZhbHVlT2YoZ2FtZURhdGEudmFsdWUxKSkKICAgICAgICAgICAgICAgIGlmIG1lbWJlcj8KICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggZ2FtZURhdGEudmFsdWUxCiAgICAgICAgICAgICAgICAgICAgICAgIHdoZW4gMCB0aGVuIHZhbHVlID0gbWVtYmVyLmxwCiAgICAgICAgICAgICAgICAgICAgICAgIHdoZW4gMSB0aGVuIHZhbHVlID0gbWVtYmVyLm1wCiAgICAgICAgICAgICAgICAgICAgICAgIHdoZW4gMiB0aGVuIHZhbHVlID0gbWVtYmVyLmxldmVsCiAgICAgICAgICAgICAgICAgICAgICAgIHdoZW4gMyB0aGVuIHZhbHVlID0gbWVtYmVyLmV4cAogICAgICAgICAgICAgICAgICAgICAgICB3aGVuIDQgdGhlbiB2YWx1ZSA9IDAKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB2YWx1ZSA9IG1lbWJlci5wYXJhbWV0ZXIoZ2FtZURhdGEudmFsdWUxIC0gNSkKICAgICAgICAgICAgd2hlbiAxICMgUGFydHkKICAgICAgICAgICAgICAgIHN3aXRjaCBnYW1lRGF0YS52YWx1ZTEKICAgICAgICAgICAgICAgICAgICAjIE1lbWJlcnMKICAgICAgICAgICAgICAgICAgICB3aGVuIDAgdGhlbiB2YWx1ZSA9IEdhbWVNYW5hZ2VyLnBhcnR5Lm1lbWJlcnMubGVuZ3RoCiAgICAgICAgICAgICAgICAgICAgIyBMZXZlbAogICAgICAgICAgICAgICAgICAgIHdoZW4gMSB0aGVuIHZhbHVlID0gR2FtZU1hbmFnZXIucGFydHkubGV2ZWwoKQogICAgICAgICAgICB3aGVuIDIgIyBQYXJ0eSBNZW1iZXIKICAgICAgICAgICAgICAgIG1lbWJlciA9IEdhbWVNYW5hZ2VyLnBhcnR5Lm1lbWJlcnNbQG51bWJlclZhbHVlT2YoZ2FtZURhdGEudmFsdWUxKV0KICAgICAgICAgICAgICAgIGlmIG1lbWJlcj8KICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggZ2FtZURhdGEudmFsdWUyCiAgICAgICAgICAgICAgICAgICAgICAgIHdoZW4gMCB0aGVuIHZhbHVlID0gbWVtYmVyLmxwCiAgICAgICAgICAgICAgICAgICAgICAgIHdoZW4gMSB0aGVuIHZhbHVlID0gbWVtYmVyLm1wCiAgICAgICAgICAgICAgICAgICAgICAgIHdoZW4gMiB0aGVuIHZhbHVlID0gbWVtYmVyLmxldmVsCiAgICAgICAgICAgICAgICAgICAgICAgIHdoZW4gMyB0aGVuIHZhbHVlID0gbWVtYmVyLmV4cAogICAgICAgICAgICAgICAgICAgICAgICB3aGVuIDQgdGhlbiB2YWx1ZSA9IDAKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB2YWx1ZSA9IG1lbWJlci5wYXJhbWV0ZXIoZ2FtZURhdGEudmFsdWUyIC0gNSkKICAgICAgICAgICAgd2hlbiAzICMgRW5lbXkKICAgICAgICAgICAgICAgIGlmIFNjZW5lTWFuYWdlci5zY2VuZSBpbnN0YW5jZW9mIFNjZW5lX0JhdHRsZQogICAgICAgICAgICAgICAgICAgIGVuZW15ID0gU2NlbmVNYW5hZ2VyLnNjZW5lLmVuZW1pZXNbQG51bWJlclZhbHVlT2YoZ2FtZURhdGEudmFsdWUxKV0KICAgICAgICAgICAgICAgICAgICBpZiBlbmVteT8KICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIGdhbWVEYXRhLnZhbHVlMgogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hlbiAwIHRoZW4gdmFsdWUgPSBlbmVteS5scAogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hlbiAxIHRoZW4gdmFsdWUgPSBlbmVteS5tcAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB2YWx1ZSA9IGVuZW15LnBhcmFtZXRlcihnYW1lRGF0YS52YWx1ZTIgLSAyKQogICAgICAgICAgICB3aGVuIDQgIyBJdGVtCiAgICAgICAgICAgICAgICBpdGVtID0gUmVjb3JkTWFuYWdlci5pdGVtc1tAbnVtYmVyVmFsdWVPZihnYW1lRGF0YS52YWx1ZTEpXQogICAgICAgICAgICAgICAgaWYgaXRlbT8KICAgICAgICAgICAgICAgICAgICBpbnZJdGVtID0gR2FtZU1hbmFnZXIuaW52ZW50b3J5Lml0ZW1zW2l0ZW0uaW5kZXhdCiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIGdhbWVEYXRhLnZhbHVlMgogICAgICAgICAgICAgICAgICAgICAgICB3aGVuIDAgIyBDb3VudAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBpZiBpbnZJdGVtPyB0aGVuIGludkl0ZW0uY291bnQgZWxzZSAwCiAgICAgICAgICAgICAgICAgICAgICAgIHdoZW4gMSAjIFByaWNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IGl0ZW0ucHJpY2UKICAgICAgICAgICAgd2hlbiA1ICMgV2VhcG9uCiAgICAgICAgICAgICAgICBpdGVtID0gUmVjb3JkTWFuYWdlci53ZWFwb25zW0BudW1iZXJWYWx1ZU9mKGdhbWVEYXRhLnZhbHVlMSldCiAgICAgICAgICAgICAgICBpZiBpdGVtPwogICAgICAgICAgICAgICAgICAgIGludkl0ZW0gPSBHYW1lTWFuYWdlci5pbnZlbnRvcnkud2VhcG9uc1tpdGVtLmluZGV4XQogICAgICAgICAgICAgICAgICAgIHN3aXRjaCBnYW1lRGF0YS52YWx1ZTIKICAgICAgICAgICAgICAgICAgICAgICAgd2hlbiAwICMgQ291bnQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gaWYgaW52SXRlbT8gdGhlbiBpbnZJdGVtLmNvdW50IGVsc2UgMAogICAgICAgICAgICAgICAgICAgICAgICB3aGVuIDEgIyBQcmljZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBpdGVtLnByaWNlCiAgICAgICAgICAgIHdoZW4gNiAjIEFybW9yCiAgICAgICAgICAgICAgICBpdGVtID0gUmVjb3JkTWFuYWdlci5hcm1vcnNbQG51bWJlclZhbHVlT2YoZ2FtZURhdGEudmFsdWUxKV0KICAgICAgICAgICAgICAgIGlmIGl0ZW0/CiAgICAgICAgICAgICAgICAgICAgaW52SXRlbSA9IEdhbWVNYW5hZ2VyLmludmVudG9yeS5hcm1vcnNbaXRlbS5pbmRleF0KICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggZ2FtZURhdGEudmFsdWUyCiAgICAgICAgICAgICAgICAgICAgICAgIHdoZW4gMCAjIENvdW50CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IGlmIGludkl0ZW0/IHRoZW4gaW52SXRlbS5jb3VudCBlbHNlIDAKICAgICAgICAgICAgICAgICAgICAgICAgd2hlbiAxICMgUHJpY2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gaXRlbS5wcmljZQogICAgICAgICAgICB3aGVuIDcgIyBNYXAKICAgICAgICAgICAgICAgIGlmIFNjZW5lTWFuYWdlci5zY2VuZSBpbnN0YW5jZW9mIFNjZW5lX01hcAogICAgICAgICAgICAgICAgICAgIHN3aXRjaCBnYW1lRGF0YS52YWx1ZTEKICAgICAgICAgICAgICAgICAgICAgICAgd2hlbiAwICMgSUQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gMAogICAgICAgICAgICAgICAgICAgICAgICB3aGVuIDEgIyBXaWR0aAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBHYW1lTWFuYWdlci5tYXAud2lkdGgKICAgICAgICAgICAgICAgICAgICAgICAgd2hlbiAyICMgSGVpZ2h0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IEdhbWVNYW5hZ2VyLm1hcC5oZWlnaHQKICAgICAgICAgICAgICAgICAgICAgICAgd2hlbiAzICMgTGF5ZXJzCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IEdhbWVNYW5hZ2VyLm1hcC5kZXB0aAogICAgICAgICAgICB3aGVuIDggIyBFdmVudAogICAgICAgICAgICAgICAgZXZlbnQgPSBAZXZlbnRCeUlkKEBudW1iZXJWYWx1ZU9mKGdhbWVEYXRhLnZhbHVlMSkpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGlmIGV2ZW50PwogICAgICAgICAgICAgICAgICAgIHN3aXRjaCBnYW1lRGF0YS52YWx1ZTIKICAgICAgICAgICAgICAgICAgICAgICAgd2hlbiAwICMgSUQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gZXZlbnQuaWQKICAgICAgICAgICAgICAgICAgICAgICAgd2hlbiAxICMgWAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBldmVudC50eCgpCiAgICAgICAgICAgICAgICAgICAgICAgIHdoZW4gMiAjIFkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gZXZlbnQudHkoKQogICAgICAgICAgICAgICAgICAgICAgICB3aGVuIDMgIyBEaXJlY3Rpb24KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gZXZlbnQuZGlyZWN0aW9uCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgd2hlbiA5ICMgR2xvYmFsIEV2ZW50CiAgICAgICAgICAgICAgICBldmVudCA9IEBnbG9iYWxFdmVudEJ5SWQoQG51bWJlclZhbHVlT2YoZ2FtZURhdGEudmFsdWUxKSkKCiAgICAgICAgICAgICAgICBpZiBldmVudD8KICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggZ2FtZURhdGEudmFsdWUyCiAgICAgICAgICAgICAgICAgICAgICAgIHdoZW4gMCAjIElECiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IGV2ZW50LmlkCiAgICAgICAgICAgICAgICAgICAgICAgIHdoZW4gMSAjIFgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gZXZlbnQudHgoKQogICAgICAgICAgICAgICAgICAgICAgICB3aGVuIDIgIyBZCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IGV2ZW50LnR5KCkKICAgICAgICAgICAgICAgICAgICAgICAgd2hlbiAzICMgRGlyZWN0aW9uCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IGV2ZW50LmRpcmVjdGlvbgogICAgICAgICAgICB3aGVuIDEwICMgVGltZXIKICAgICAgICAgICAgICAgIHRpbWVyID0gR2FtZU1hbmFnZXIudGltZXIKICAgICAgICAgICAgICAgIHZhbHVlID0gdGltZXIubWludXRlcyAqIDYwICsgdGltZXIuc2Vjb25kcwogICAgICAgICAgICB3aGVuIDExICMgVGltZQogICAgICAgICAgICAgICAgZGF0ZSA9IG5ldyBEYXRlKCkKICAgICAgICAgICAgICAgIHN3aXRjaCBnYW1lRGF0YS52YWx1ZTEKICAgICAgICAgICAgICAgICAgICB3aGVuIDAgIyBZZWFyCiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gZGF0ZS5nZXRGdWxsWWVhcigpCiAgICAgICAgICAgICAgICAgICAgd2hlbiAxICMgTW9udGgKICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBkYXRlLmdldE1vbnRoKCkKICAgICAgICAgICAgICAgICAgICB3aGVuIDIgIyBXZWVrCiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gMAogICAgICAgICAgICAgICAgICAgIHdoZW4gMyAjIERheQogICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IGRhdGUuZ2V0RGF5KCkKICAgICAgICAgICAgICAgICAgICB3aGVuIDQgIyBEYXkgb2YgWWVhcgogICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IDAKICAgICAgICAgICAgICAgICAgICB3aGVuIDUgIyBIb3VyCiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gZGF0ZS5nZXRIb3VycygpCiAgICAgICAgICAgICAgICAgICAgd2hlbiA2ICMgTWludXRlCiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gZGF0ZS5nZXRNaW51dGVzKCkKICAgICAgICAgICAgICAgICAgICB3aGVuIDcgIyBTZWNvbmQKICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBkYXRlLmdldFNlY29uZHMoKQogICAgICAgICAgICAgICAgICAgIHdoZW4gOCAjIE1pbGxpc2Vjb25kCiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gZGF0ZS5nZXRNaWxsaXNlY29uZHMoKQogICAgICAgICAgICB3aGVuIDEyICMgSW5wdXQKICAgICAgICAgICAgICAgIHN3aXRjaCBnYW1lRGF0YS52YWx1ZTEKICAgICAgICAgICAgICAgICAgICB3aGVuIDAgdGhlbiB2YWx1ZSA9IElucHV0LmtleXNbSW5wdXQuRE9XTl0KICAgICAgICAgICAgICAgICAgICB3aGVuIDEgdGhlbiB2YWx1ZSA9IElucHV0LmtleXNbSW5wdXQuTEVGVF0KICAgICAgICAgICAgICAgICAgICB3aGVuIDIgdGhlbiB2YWx1ZSA9IElucHV0LmtleXNbSW5wdXQuVVBdCiAgICAgICAgICAgICAgICAgICAgd2hlbiAzIHRoZW4gdmFsdWUgPSBJbnB1dC5rZXlzW0lucHV0LlJJR0hUXQogICAgICAgICAgICAgICAgICAgIHdoZW4gNCB0aGVuIHZhbHVlID0gSW5wdXQua2V5c1tJbnB1dC5BXQogICAgICAgICAgICAgICAgICAgIHdoZW4gNSB0aGVuIHZhbHVlID0gSW5wdXQua2V5c1tJbnB1dC5CXQogICAgICAgICAgICAgICAgICAgIHdoZW4gNiB0aGVuIHZhbHVlID0gSW5wdXQua2V5c1tJbnB1dC5YXQogICAgICAgICAgICAgICAgICAgIHdoZW4gNyB0aGVuIHZhbHVlID0gSW5wdXQua2V5c1tJbnB1dC5ZXQogICAgICAgICAgICAgICAgICAgIHdoZW4gOCB0aGVuIHZhbHVlID0gSW5wdXQua2V5c1tJbnB1dC5TVEFSVF0KICAgICAgICAgICAgICAgICAgICB3aGVuIDkgdGhlbiB2YWx1ZSA9IElucHV0LmtleXNbSW5wdXQuU0VMRUNUXQogICAgICAgICAgICB3aGVuIDEzICMgTW91c2UKICAgICAgICAgICAgICAgIHN3aXRjaCBnYW1lRGF0YS52YWx1ZTEKICAgICAgICAgICAgICAgICAgICB3aGVuIDAgdGhlbiB2YWx1ZSA9IElucHV0Lk1vdXNlLmJ1dHRvbnNbSW5wdXQuTW91c2UuTEVGVF0KICAgICAgICAgICAgICAgICAgICB3aGVuIDEgdGhlbiB2YWx1ZSA9IElucHV0Lk1vdXNlLmJ1dHRvbnNbSW5wdXQuTW91c2UuTUlERExFXQogICAgICAgICAgICAgICAgICAgIHdoZW4gMiB0aGVuIHZhbHVlID0gSW5wdXQuTW91c2UuYnV0dG9uc1tJbnB1dC5Nb3VzZS5SSUdIVF0KICAgICAgICAgICAgICAgICAgICB3aGVuIDMgdGhlbiB2YWx1ZSA9IElucHV0Lk1vdXNlLndoZWVsCiAgICAgICAgICAgICAgICAgICAgd2hlbiA0IHRoZW4gdmFsdWUgPSBJbnB1dC5Nb3VzZS54CiAgICAgICAgICAgICAgICAgICAgd2hlbiA1IHRoZW4gdmFsdWUgPSBJbnB1dC5Nb3VzZS55CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgcmV0dXJuIHZhbHVlCiAgICAgICAgICAgIAogICAgIyBXYWl0IENvbW1hbmQKICAgIGNvbW1hbmRXYWl0OiAtPgogICAgICAgIEBpbnRlcnByZXRlci53YWl0Q291bnRlciA9IEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMudGltZSkgCiAgICAgICAgQGludGVycHJldGVyLmlzV2FpdGluZyA9IHllcwogICAgICAgIAogICAgIyBMb29wIENvbW1hbmQKICAgIGNvbW1hbmRMb29wOiAtPgogICAgIyBMb29wIEVuZCBDb21tYW5kCiAgICBjb21tYW5kTG9vcEVuZDogLT4KICAgICAgICBAaW50ZXJwcmV0ZXIuc2tpcChAaW5kZW50LCB5ZXMpICAgCiAgICAjIEJyZWFrIExvb3AgQ29tbWFuZAogICAgY29tbWFuZEJyZWFrTG9vcDogLT4KICAgICAgICBAaW50ZXJwcmV0ZXIuc2tpcChAY29tbWFuZC5pbmRlbnQtMSkKICAgICAgICAKICAgICMgTW92ZSBFdmVudAogICAgY29tbWFuZE1vdmVFdmVudDogLT4KICAgICAgICBpZCA9IEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMuZXZlbnQpCiAgICAgICAgZXZlbnQgPSBudWxsCiAgICAgICAgIyBJZiB0aGlzIGV2ZW50CiAgICAgICAgaWYgaWQgPT0gLTEKICAgICAgICAgICAgZXZlbnQgPSBHYW1lTWFuYWdlci5tYXAuY3VycmVudEV2ZW50CiAgICAgICAgIyBJZiBjdXJyZW50IHBsYXllcgogICAgICAgIGVsc2UgaWYgaWQgPT0gLTIKICAgICAgICAgICAgZXZlbnQgPSBHYW1lTWFuYWdlci5wbGF5ZXIKICAgICAgICAjIElmIG90aGVyIGV2ZW50CiAgICAgICAgZWxzZQogICAgICAgICAgICBldmVudCA9IEdhbWVNYW5hZ2VyLm1hcC5ldmVudHNCeUlkW2lkXQogICAgICAgICAgICAKICAgICAgICBpZiBldmVudD8KICAgICAgICAgICAgZXZlbnQubW92ZVJvdXRlKEBwYXJhbXMpCiAgICAgICAgICAgIGlmIEBwYXJhbXMud2FpdEZvckNvbXBsZXRpb24KICAgICAgICAgICAgICAgIGV2ZW50Lm9uUm91dGVGaW5pc2ggPSA9PiAKICAgICAgICAgICAgICAgICAgICBAaW50ZXJwcmV0ZXIuaXNXYWl0aW5nID0gbm8KICAgICAgICAgICAgICAgICAgICBldmVudC5vblJvdXRlRmluaXNoID0gbnVsbAogICAgICAgICAgICAgICAgICAgIGV2ZW50Lm1vdmVSb3V0ZShldmVudC5hdXRvTW92ZW1lbnRSb3V0ZSkKICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBAaW50ZXJwcmV0ZXIuaXNXYWl0aW5nID0geWVzCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIGV2ZW50Lm9uUm91dGVGaW5pc2ggPSA9PiAKICAgICAgICAgICAgICAgICAgICBldmVudC5vblJvdXRlRmluaXNoID0gbnVsbAogICAgICAgICAgICAgICAgICAgIGV2ZW50Lm1vdmVSb3V0ZShldmVudC5hdXRvTW92ZW1lbnRSb3V0ZSkKICAgIAogICAgIyBDaGFuZ2UgTWFwCiAgICBjb21tYW5kQ2hhbmdlTWFwOiAtPgogICAgICAgIHN3aXRjaCBAcGFyYW1zLmxvY2F0aW9uVHlwZQogICAgICAgICAgICB3aGVuIDAKICAgICAgICAgICAgICAgIG1hcCA9IEBwYXJhbXMuZGlyZWN0TWFwLm1hcAogICAgICAgICAgICAgICAgbG9jYXRpb24gPSBAcGFyYW1zLmRpcmVjdE1hcC5sb2NhdGlvbgogICAgICAgICAgICB3aGVuIDEKICAgICAgICAgICAgICAgIG1hcCA9IHVpZDogQGludGVycHJldGVyLnN0cmluZ1ZhbHVlT2YoQHBhcmFtcy5tYXAudWlkKQogICAgICAgICAgICAgICAgbG9jYXRpb24gPSB4OiBAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLmxvY2F0aW9uLngpLCB5OiBAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLmxvY2F0aW9uLnkpCiAgICAgICAgICAgIAogICAgICAgIGlmIG1hcC51aWQgPT0gR2FtZU1hbmFnZXIuY3VycmVudE1hcElkCiAgICAgICAgICAgIEBpbnRlcnByZXRlci5zZXRFdmVudExvY2F0aW9uKEdhbWVNYW5hZ2VyLnBsYXllciwge3g6IGxvY2F0aW9uLngsIHk6IGxvY2F0aW9uLnksIGNoYW5nZURpcmVjdGlvbjogbm99KQogICAgICAgIGVsc2UgaWYgbWFwLnVpZCAhPSAiIiBhbmQgbWFwLnVpZCAhPSBHYW1lTWFuYWdlci5jdXJyZW50TWFwSWQKICAgICAgICAgICAgR2FtZU1hbmFnZXIucGxheWVyLmV2ZW50LnggPSBsb2NhdGlvbi54CiAgICAgICAgICAgIEdhbWVNYW5hZ2VyLnBsYXllci5ldmVudC55ID0gbG9jYXRpb24ueQogICAgICAgICAgICBHYW1lTWFuYWdlci5wbGF5ZXIubWFwVWlkID0gbWFwLnVpZAogICAgICAgICAgICBHYW1lTWFuYWdlci5wbGF5ZXIubWFwSWQgPSBtYXAudWlkICMgT0xEIE5BTUUKICAgICAgICAgICAgR2FtZU1hbmFnZXIucGxheWVyLmlzUGxheWVyID0geWVzCiAgICAgICAgICAgIEdhbWVNYW5hZ2VyLnBsYXllci5pc01vdmluZyA9IG5vCiAgICAgICAgICAgIEdhbWVNYW5hZ2VyLmN1cnJlbnRNYXBJZCA9IG1hcC51aWQKICAgICAgICAgICAgCiAgICAgICAgICAgIElucHV0LmNsZWFyKCkKICAgICAgICAgICAgU2NlbmVNYW5hZ2VyLnN3aXRjaFRvKG5ldyBTY2VuZV9NYXAoKSkKICAgICAgICAKICAgIAogICAgIyBDaGFuZ2UgTnVtYmVyIFZhcmlhYmxlcwogICAgY29tbWFuZENoYW5nZU51bWJlclZhcmlhYmxlczogLT4KICAgICAgICBzb3VyY2UgPSAwCiAgICAgICAgCiAgICAgICAgc3dpdGNoIEBwYXJhbXMuc291cmNlCiAgICAgICAgICAgIHdoZW4gMCAjIENvbnN0YW50IFZhbHVlIC8gVmFyaWFibGUgVmFsdWUKICAgICAgICAgICAgICAgIHNvdXJjZSA9IEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMuc291cmNlVmFsdWUxKQogICAgICAgICAgICB3aGVuIDEgIyBSYW5kb20KICAgICAgICAgICAgICAgIHN0YXJ0ID0gQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy5zb3VyY2VWYWx1ZTEpCiAgICAgICAgICAgICAgICBlbmQgPSBAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLnNvdXJjZVZhbHVlMikKICAgICAgICAgICAgICAgIGRpZmYgPSBlbmQgLSBzdGFydAogICAgICAgICAgICAgICAgc291cmNlID0gTWF0aC5mbG9vcihzdGFydCArIE1hdGgucmFuZG9tKCkgKiAoZGlmZisxKSkKICAgICAgICAgICAgd2hlbiAyICMgUG9pbnRlcgogICAgICAgICAgICAgICAgc291cmNlID0gQGludGVycHJldGVyLm51bWJlclZhbHVlQXRJbmRleChAcGFyYW1zLnNvdXJjZVZhbHVlMSwgQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy5zb3VyY2VWYWx1ZTIpLTEpCiAgICAgICAgICAgIHdoZW4gMyAjIEdhbWUgRGF0YQogICAgICAgICAgICAgICAgc291cmNlID0gQGludGVycHJldGVyLm51bWJlclZhbHVlT2ZHYW1lRGF0YShAcGFyYW1zLnNvdXJjZVZhbHVlMSkKICAgICAgICAgICAgCiAgICAgICAgc3dpdGNoIEBwYXJhbXMudGFyZ2V0CiAgICAgICAgICAgIHdoZW4gMCAjIFZhcmlhYmxlCiAgICAgICAgICAgICAgICBzd2l0Y2ggQHBhcmFtcy5vcGVyYXRpb24KICAgICAgICAgICAgICAgICAgICB3aGVuIDAgIyBTZXQKICAgICAgICAgICAgICAgICAgICAgICAgQGludGVycHJldGVyLnNldE51bWJlclZhbHVlVG8oQHBhcmFtcy50YXJnZXRWYWx1ZTEsIHNvdXJjZSkKICAgICAgICAgICAgICAgICAgICB3aGVuIDEgIyBBZGQKICAgICAgICAgICAgICAgICAgICAgICAgQGludGVycHJldGVyLnNldE51bWJlclZhbHVlVG8oQHBhcmFtcy50YXJnZXRWYWx1ZTEsIEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMudGFyZ2V0VmFsdWUxKSArIHNvdXJjZSkKICAgICAgICAgICAgICAgICAgICB3aGVuIDIgIyBTdWIKICAgICAgICAgICAgICAgICAgICAgICAgQGludGVycHJldGVyLnNldE51bWJlclZhbHVlVG8oQHBhcmFtcy50YXJnZXRWYWx1ZTEsIEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMudGFyZ2V0VmFsdWUxKSAtIHNvdXJjZSkKICAgICAgICAgICAgICAgICAgICB3aGVuIDMgIyBNdWwKICAgICAgICAgICAgICAgICAgICAgICAgQGludGVycHJldGVyLnNldE51bWJlclZhbHVlVG8oQHBhcmFtcy50YXJnZXRWYWx1ZTEsIEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMudGFyZ2V0VmFsdWUxKSAqIHNvdXJjZSkKICAgICAgICAgICAgICAgICAgICB3aGVuIDQgIyBEaXYKICAgICAgICAgICAgICAgICAgICAgICAgQGludGVycHJldGVyLnNldE51bWJlclZhbHVlVG8oQHBhcmFtcy50YXJnZXRWYWx1ZTEsIEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMudGFyZ2V0VmFsdWUxKSAvIHNvdXJjZSkKICAgICAgICAgICAgICAgICAgICB3aGVuIDUgIyBNb2QKICAgICAgICAgICAgICAgICAgICAgICAgQGludGVycHJldGVyLnNldE51bWJlclZhbHVlVG8oQHBhcmFtcy50YXJnZXRWYWx1ZTEsIEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMudGFyZ2V0VmFsdWUxKSAlIHNvdXJjZSkKICAgICAgICAgICAgd2hlbiAxICMgUmFuZ2UKICAgICAgICAgICAgICAgIHNjb3BlID0gQHBhcmFtcy50YXJnZXRWYWx1ZTEKICAgICAgICAgICAgICAgIHN0YXJ0ID0gQHBhcmFtcy50YXJnZXRWYWx1ZTItMQogICAgICAgICAgICAgICAgZW5kID0gQHBhcmFtcy50YXJnZXRWYWx1ZTMtMQogICAgICAgICAgICAgICAgZm9yIGkgaW4gW3N0YXJ0Li5lbmRdCiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIEBwYXJhbXMub3BlcmF0aW9uCiAgICAgICAgICAgICAgICAgICAgICAgIHdoZW4gMCAjIFNldAogICAgICAgICAgICAgICAgICAgICAgICAgICAgQGludGVycHJldGVyLnNldE51bWJlclZhbHVlQXRJbmRleChzY29wZSwgaSwgc291cmNlKQogICAgICAgICAgICAgICAgICAgICAgICB3aGVuIDEgIyBBZGQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBpbnRlcnByZXRlci5zZXROdW1iZXJWYWx1ZUF0SW5kZXgoc2NvcGUsIGksIEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZUF0SW5kZXgoc2NvcGUsIGkpICsgc291cmNlKQogICAgICAgICAgICAgICAgICAgICAgICB3aGVuIDIgIyBTdWIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBpbnRlcnByZXRlci5zZXROdW1iZXJWYWx1ZUF0SW5kZXgoc2NvcGUsIGksIEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZUF0SW5kZXgoc2NvcGUsIGkpIC0gc291cmNlKQogICAgICAgICAgICAgICAgICAgICAgICB3aGVuIDMgIyBNdWwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBpbnRlcnByZXRlci5zZXROdW1iZXJWYWx1ZUF0SW5kZXgoc2NvcGUsIGksIEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZUF0SW5kZXgoc2NvcGUsIGkpICogc291cmNlKQogICAgICAgICAgICAgICAgICAgICAgICB3aGVuIDQgIyBEaXYKICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBpbnRlcnByZXRlci5zZXROdW1iZXJWYWx1ZUF0SW5kZXgoc2NvcGUsIGksIEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZUF0SW5kZXgoc2NvcGUsIGkpIC8gc291cmNlKQogICAgICAgICAgICAgICAgICAgICAgICB3aGVuIDUgIyBNb2QKICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBpbnRlcnByZXRlci5zZXROdW1iZXJWYWx1ZUF0SW5kZXgoc2NvcGUsIGksIEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZUF0SW5kZXgoc2NvcGUsIGkpICUgc291cmNlKQogICAgICAgICAgICB3aGVuIDIgIyBSZWZlcmVuY2UKICAgICAgICAgICAgICAgIGluZGV4ID0gQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy50YXJnZXRWYWx1ZTIpIC0gMQogICAgICAgICAgICAgICAgc3dpdGNoIEBwYXJhbXMub3BlcmF0aW9uCiAgICAgICAgICAgICAgICAgICAgd2hlbiAwICMgU2V0CiAgICAgICAgICAgICAgICAgICAgICAgIEBpbnRlcnByZXRlci5zZXROdW1iZXJWYWx1ZUF0SW5kZXgoQHBhcmFtcy50YXJnZXRWYWx1ZTEsIGluZGV4LCBzb3VyY2UpCiAgICAgICAgICAgICAgICAgICAgd2hlbiAxICMgQWRkCiAgICAgICAgICAgICAgICAgICAgICAgIEBpbnRlcnByZXRlci5zZXROdW1iZXJWYWx1ZUF0SW5kZXgoQHBhcmFtcy50YXJnZXRWYWx1ZTEsIGluZGV4LCBAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVBdEluZGV4KEBwYXJhbXMudGFyZ2V0VmFsdWUxLCBpbmRleCkgKyBzb3VyY2UpCiAgICAgICAgICAgICAgICAgICAgd2hlbiAyICMgU3ViCiAgICAgICAgICAgICAgICAgICAgICAgIEBpbnRlcnByZXRlci5zZXROdW1iZXJWYWx1ZUF0SW5kZXgoQHBhcmFtcy50YXJnZXRWYWx1ZTEsIGluZGV4LCBAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVBdEluZGV4KEBwYXJhbXMudGFyZ2V0VmFsdWUxLCBpbmRleCkgLSBzb3VyY2UpCiAgICAgICAgICAgICAgICAgICAgd2hlbiAzICMgTXVsCiAgICAgICAgICAgICAgICAgICAgICAgIEBpbnRlcnByZXRlci5zZXROdW1iZXJWYWx1ZUF0SW5kZXgoQHBhcmFtcy50YXJnZXRWYWx1ZTEsIGluZGV4LCBAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVBdEluZGV4KEBwYXJhbXMudGFyZ2V0VmFsdWUxLCBpbmRleCkgKiBzb3VyY2UpCiAgICAgICAgICAgICAgICAgICAgd2hlbiA0ICMgRGl2CiAgICAgICAgICAgICAgICAgICAgICAgIEBpbnRlcnByZXRlci5zZXROdW1iZXJWYWx1ZUF0SW5kZXgoQHBhcmFtcy50YXJnZXRWYWx1ZTEsIGluZGV4LCBAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVBdEluZGV4KEBwYXJhbXMudGFyZ2V0VmFsdWUxLCBpbmRleCkgLyBzb3VyY2UpCiAgICAgICAgICAgICAgICAgICAgd2hlbiA1ICMgTW9kCiAgICAgICAgICAgICAgICAgICAgICAgIEBpbnRlcnByZXRlci5zZXROdW1iZXJWYWx1ZUF0SW5kZXgoQHBhcmFtcy50YXJnZXRWYWx1ZTEsIGluZGV4LCBAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVBdEluZGV4KEBwYXJhbXMudGFyZ2V0VmFsdWUxLCBpbmRleCkgJSBzb3VyY2UpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICByZXR1cm4gbnVsbAogICAgCiAgICAjIENoYW5nZSBCb29sZWFuIFZhcmlhYmxlcwogICAgY29tbWFuZENoYW5nZUJvb2xlYW5WYXJpYWJsZXM6IC0+CiAgICAgICAgc291cmNlID0gQGludGVycHJldGVyLmJvb2xlYW5WYWx1ZU9mKEBwYXJhbXMudmFsdWUpCiAgIAogICAgICAgIHN3aXRjaCBAcGFyYW1zLnRhcmdldAogICAgICAgICAgICB3aGVuIDAgIyBWYXJpYWJsZQogICAgICAgICAgICAgICAgQGludGVycHJldGVyLnNldEJvb2xlYW5WYWx1ZVRvKEBwYXJhbXMudGFyZ2V0VmFyaWFibGUsIHNvdXJjZSkKICAgICAgICAgICAgd2hlbiAxICMgUmFuZ2UKICAgICAgICAgICAgICAgIHZhcmlhYmxlID0geyBpbmRleDogMCwgc2NvcGU6IEBwYXJhbXMudGFyZ2V0UmFuZ2VTY29wZSB9CiAgICAgICAgICAgICAgICBmb3IgaSBpbiBbQHBhcmFtcy5yYW5nZVN0YXJ0Li5AcGFyYW1zLnJhbmdlRW5kXQogICAgICAgICAgICAgICAgICAgIHZhcmlhYmxlLmluZGV4ID0gaQogICAgICAgICAgICAgICAgICAgIEBpbnRlcnByZXRlci5zZXRCb29sZWFuVmFsdWVUbyh2YXJpYWJsZSwgc291cmNlKQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgIHJldHVybiBudWxsCiAgICAgICAgCiAgICAjIENoYW5nZSBTdHJpbmcgVmFyaWFibGVzCiAgICBjb21tYW5kQ2hhbmdlU3RyaW5nVmFyaWFibGVzOiAtPgogICAgICAgIHNvdXJjZSA9ICIiCiAgICAgICAgCiAgICAgICAgc3dpdGNoIEBwYXJhbXMudmFsdWVUeXBlCiAgICAgICAgICAgIHdoZW4gMCAjIENvbnN0YW50IFRleHQKICAgICAgICAgICAgICAgIHNvdXJjZSA9IEBwYXJhbXMudGV4dFZhbHVlCiAgICAgICAgICAgIAogICAgICAgIHN3aXRjaCBAcGFyYW1zLnRhcmdldAogICAgICAgICAgICB3aGVuIDAgIyBWYXJpYWJsZQogICAgICAgICAgICAgICAgc3dpdGNoIEBwYXJhbXMub3BlcmF0aW9uCiAgICAgICAgICAgICAgICAgICAgd2hlbiAwICMgU2V0CiAgICAgICAgICAgICAgICAgICAgICAgIEBpbnRlcnByZXRlci5zZXRTdHJpbmdWYWx1ZVRvKEBwYXJhbXMudGFyZ2V0VmFyaWFibGUsIHNvdXJjZSkKICAgICAgICAgICAgICAgICAgICB3aGVuIDEgIyBBZGQKICAgICAgICAgICAgICAgICAgICAgICAgQGludGVycHJldGVyLnNldFN0cmluZ1ZhbHVlVG8oQHBhcmFtcy50YXJnZXRWYXJpYWJsZSwgQGludGVycHJldGVyLnN0cmluZ1ZhbHVlT2YoQHBhcmFtcy50YXJnZXRWYXJpYWJsZSkgKyBzb3VyY2UpCgogICAgICAgICAgICB3aGVuIDEgIyBSYW5nZQogICAgICAgICAgICAgICAgdmFyaWFibGUgPSB7IGluZGV4OiAwLCBzY29wZTogQHBhcmFtcy50YXJnZXRSYW5nZVNjb3BlIH0KICAgICAgICAgICAgICAgIGZvciBpIGluIFtAcGFyYW1zLnJhbmdlU3RhcnQuLkBwYXJhbXMucmFuZ2VFbmRdCiAgICAgICAgICAgICAgICAgICAgdmFyaWFibGUuaW5kZXggPSBpCiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIEBwYXJhbXMub3BlcmF0aW9uCiAgICAgICAgICAgICAgICAgICAgICAgIHdoZW4gMCAjIFNldAogICAgICAgICAgICAgICAgICAgICAgICAgICAgQGludGVycHJldGVyLnNldFN0cmluZ1ZhbHVlVG8odmFyaWFibGUsIHNvdXJjZSkKICAgICAgICAgICAgICAgICAgICAgICAgd2hlbiAxICMgQWRkCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBAaW50ZXJwcmV0ZXIuc2V0U3RyaW5nVmFsdWVUbyh2YXJpYWJsZSwgQGludGVycHJldGVyLnN0cmluZ1ZhbHVlT2YodmFyaWFibGUpICsgc291cmNlKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgcmV0dXJuIG51bGwKICAgICAgICAKICAgICMgQ29uZGl0aW9uCiAgICBjb21tYW5kQ29uZGl0aW9uOiAtPgogICAgICAgIG9wZXJhbmRBID0gMAogICAgICAgIG9wZXJhbmRCID0gMAogICAgICAgIHJlc3VsdCA9IG5vCiAgICAgICAgCiAgICAgICAgc3dpdGNoIEBwYXJhbXMuY29kZQogICAgICAgICAgICB3aGVuIDAgIyBBY3RvciBpcyBpbiBQYXJ0eQogICAgICAgICAgICAgICAgcmVzdWx0ID0gR2FtZU1hbmFnZXIucGFydHkuaXNNZW1iZXIoUmVjb3JkTWFuYWdlci5hY3RvcnNbQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy52YWx1ZTEpXSkKICAgICAgICAgICAgd2hlbiAxICMgQWN0b3IgaGFzIFNraWxsCiAgICAgICAgICAgICAgICBtZW1iZXIgPSBHYW1lTWFuYWdlci5wYXJ0eS5tZW1iZXJXaXRoSWQoQGludGVycHJldGVyLm51bWJlclZhbHVlKEBwYXJhbXMudmFsdWUxKSkKICAgICAgICAgICAgICAgIGlmIG1lbWJlcj8KICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBtZW1iZXIuaGFzU2tpbGwoUmVjb3JkTWFuYWdlci5za2lsbHNbQGludGVycHJldGVyLm51bWJlclZhbHVlKEBwYXJhbXMudmFsdWUyKV0pCiAgICAgICAgICAgIHdoZW4gMiAjIEFjdG9yIGhhcyBXZWFwb24KICAgICAgICAgICAgICAgIG1lbWJlciA9IEdhbWVNYW5hZ2VyLnBhcnR5Lm1lbWJlcldpdGhJZChAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWUoQHBhcmFtcy52YWx1ZTEpKQogICAgICAgICAgICAgICAgaWYgbWVtYmVyPwogICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IG1lbWJlci5oYXNXZWFwb24oUmVjb3JkTWFuYWdlci53ZWFwb25zW0BpbnRlcnByZXRlci5udW1iZXJWYWx1ZShAcGFyYW1zLnZhbHVlMildKQogICAgICAgICAgICB3aGVuIDMgIyBBY3RvciBoYXMgQXJtb3IKICAgICAgICAgICAgICAgIG1lbWJlciA9IEdhbWVNYW5hZ2VyLnBhcnR5Lm1lbWJlcldpdGhJZChAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWUoQHBhcmFtcy52YWx1ZTEpKQogICAgICAgICAgICAgICAgaWYgbWVtYmVyPwogICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IG1lbWJlci5oYXNBcm1vcihSZWNvcmRNYW5hZ2VyLmFybW9yc1tAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWUoQHBhcmFtcy52YWx1ZTIpXSkKICAgICAgICAgICAgd2hlbiA0ICMgQWN0b3IgaGFzIENsYXNzCiAgICAgICAgICAgICAgICBtZW1iZXIgPSBHYW1lTWFuYWdlci5wYXJ0eS5tZW1iZXJXaXRoSWQoQGludGVycHJldGVyLm51bWJlclZhbHVlKEBwYXJhbXMudmFsdWUxKSkKICAgICAgICAgICAgICAgIGlmIG1lbWJlcj8KICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBtZW1iZXIuaGFzQ2xhc3MoUmVjb3JkTWFuYWdlci5jbGFzc2VzW0BpbnRlcnByZXRlci5udW1iZXJWYWx1ZShAcGFyYW1zLnZhbHVlMildKQogICAgICAgICAgICB3aGVuIDUgIyBBY3RvciBoYXMgU3RhdGUKICAgICAgICAgICAgICAgIG1lbWJlciA9IEdhbWVNYW5hZ2VyLnBhcnR5Lm1lbWJlcldpdGhJZChAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWUoQHBhcmFtcy52YWx1ZTEpKQogICAgICAgICAgICAgICAgaWYgbWVtYmVyPwogICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IG1lbWJlci5oYXNTdGF0ZShSZWNvcmRNYW5hZ2VyLnN0YXRlc1tAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWUoQHBhcmFtcy52YWx1ZTIpXSkKICAgICAgICAgICAgd2hlbiA2ICMgSXRlbSBpcyBpbiBJbnZlbnRvcnkKICAgICAgICAgICAgICAgIGl0ZW0gPSBHYW1lTWFuYWdlci5pbnZlbnRvcnkuaXRlbXNbQGludGVycHJldGVyLm51bWJlclZhbHVlKEBwYXJhbXMudmFsdWUxKV0KICAgICAgICAgICAgICAgIHJlc3VsdCA9IGl0ZW0gYW5kIGl0ZW0uY291bnQgPiAwCiAgICAgICAgICAgIHdoZW4gNyAjIFdlYXBvbiBpcyBpbiBJbnZlbnRvcnkKICAgICAgICAgICAgICAgIGl0ZW0gPSBHYW1lTWFuYWdlci5pbnZlbnRvcnkud2VhcG9uc1tAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWUoQHBhcmFtcy52YWx1ZTEpXQogICAgICAgICAgICAgICAgcmVzdWx0ID0gaXRlbSBhbmQgaXRlbS5jb3VudCA+IDAKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaWYgbm90IHJlc3VsdCBhbmQgQHBhcmFtcy52YWx1ZTIKICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBHYW1lTWFuYWdlci5wYXJ0eS5oYXNXZWFwb24oaXRlbSkKICAgICAgICAgICAgd2hlbiA4ICMgQXJtb3IgaXMgaW4gSW52ZW50b3J5CiAgICAgICAgICAgICAgICBpdGVtID0gR2FtZU1hbmFnZXIuaW52ZW50b3J5LmFybW9yc1tAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWUoQHBhcmFtcy52YWx1ZTEpXQogICAgICAgICAgICAgICAgcmVzdWx0ID0gaXRlbSBhbmQgaXRlbS5jb3VudCA+IDAKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaWYgbm90IHJlc3VsdCBhbmQgQHBhcmFtcy52YWx1ZTIKICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBHYW1lTWFuYWdlci5wYXJ0eS5oYXNBcm1vcihpdGVtKQogICAgICAgICAgICB3aGVuIDkgIyBBY3RvciBQYXJhbWV0ZXIKICAgICAgICAgICAgICAgIG1lbWJlciA9IEdhbWVNYW5hZ2VyLnBhcnR5Lm1lbWJlcldpdGhJZChAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWUoQHBhcmFtcy52YWx1ZTEpKQogICAgICAgICAgICAgICAgaWYgbWVtYmVyPwogICAgICAgICAgICAgICAgICAgIHN3aXRjaCBAcGFyYW1zLnZhbHVlMgogICAgICAgICAgICAgICAgICAgICAgICB3aGVuIDAgdGhlbiByZXN1bHQgPSBAaW50ZXJwcmV0ZXIuY29tcGFyZShtZW1iZXIubGV2ZWwsIEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMudmFsdWU0KSwgQHBhcmFtcy52YWx1ZTMpCiAgICAgICAgICAgICAgICAgICAgICAgIHdoZW4gMSB0aGVuIHJlc3VsdCA9IEBpbnRlcnByZXRlci5jb21wYXJlKG1lbWJlci5scCwgQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy52YWx1ZTQpLCBAcGFyYW1zLnZhbHVlMykKICAgICAgICAgICAgICAgICAgICAgICAgd2hlbiAyIHRoZW4gcmVzdWx0ID0gQGludGVycHJldGVyLmNvbXBhcmUobWVtYmVyLm1wLCBAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLnZhbHVlNCksIEBwYXJhbXMudmFsdWUzKQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHJlc3VsdCA9IEBpbnRlcnByZXRlci5jb21wYXJlKG1lbWJlci5wYXJhbWV0ZXIoQHBhcmFtcy52YWx1ZTIgLSAzKSwgQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy52YWx1ZTQpLCBAcGFyYW1zLnZhbHVlMykKICAgICAgICAgICAgd2hlbiAxMCAjIEVuZW15IFBhcmFtZXRlcgogICAgICAgICAgICAgICAgaWYgU2NlbmVNYW5hZ2VyLnNjZW5lIGluc3RhbmNlb2YgU2NlbmVfQmF0dGxlCiAgICAgICAgICAgICAgICAgICAgZW5lbXkgPSBTY2VuZU1hbmFnZXIuc2NlbmUuZW5lbWllc1tAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWUoQHBhcmFtcy52YWx1ZTEpXQogICAgICAgICAgICAgICAgICAgIGlmIGVuZW15PwogICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggQHBhcmFtcy52YWx1ZTIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoZW4gMCB0aGVuIHJlc3VsdCA9IEBpbnRlcnByZXRlci5jb21wYXJlKGVuZW15LmxwLCBAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLnZhbHVlNCksIEBwYXJhbXMudmFsdWUzKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hlbiAxIHRoZW4gcmVzdWx0ID0gQGludGVycHJldGVyLmNvbXBhcmUoZW5lbXkubXAsIEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMudmFsdWU0KSwgQHBhcmFtcy52YWx1ZTMpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHJlc3VsdCA9IEBpbnRlcnByZXRlci5jb21wYXJlKGVuZW15LnBhcmFtZXRlcihAcGFyYW1zLnZhbHVlMiAtIDMpLCBAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLnZhbHVlNCksIEBwYXJhbXMudmFsdWUzKSAgICAgICAgCiAgICAgICAgICAgIHdoZW4gMTEgIyBTd2l0Y2gKICAgICAgICAgICAgICAgIHJlc3VsdCA9IEBpbnRlcnByZXRlci5ib29sZWFuVmFsdWVPZihAcGFyYW1zLnZhbHVlMSkgPT0gKEBwYXJhbXMudmFsdWUyID09IDEpCiAgICAgICAgICAgIHdoZW4gMTIgIyBOdW1iZXIgVmFyaWFibGUKICAgICAgICAgICAgICAgIHJlc3VsdCA9IEBpbnRlcnByZXRlci5jb21wYXJlKEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMudmFsdWUxKSwgQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy52YWx1ZTMpLCBAcGFyYW1zLnZhbHVlMikKICAgICAgICAgICAgd2hlbiAxMyAjIFRleHQgVmFyaWFibGUKICAgICAgICAgICAgICAgIHRleHQxID0gQGludGVycHJldGVyLnN0cmluZ1ZhbHVlT2YoQHBhcmFtcy52YWx1ZTEpCiAgICAgICAgICAgICAgICB0ZXh0MiA9IEBpbnRlcnByZXRlci5zdHJpbmdWYWx1ZU9mKEBwYXJhbXMudmFsdWUzKQogICAgICAgICAgICAgICAgc3dpdGNoIEBwYXJhbXMudmFsdWUyCiAgICAgICAgICAgICAgICAgICAgd2hlbiAwIHRoZW4gcmVzdWx0ID0gdGV4dDEgPT0gdGV4dDIKICAgICAgICAgICAgICAgICAgICB3aGVuIDEgdGhlbiByZXN1bHQgPSB0ZXh0MSAhPSB0ZXh0MgogICAgICAgICAgICAgICAgICAgIHdoZW4gMiB0aGVuIHJlc3VsdCA9IHRleHQxLmxlbmd0aCA+IHRleHQyLmxlbmd0aAogICAgICAgICAgICAgICAgICAgIHdoZW4gMyB0aGVuIHJlc3VsdCA9IHRleHQxLmxlbmd0aCA+PSB0ZXh0Mi5sZW5ndGgKICAgICAgICAgICAgICAgICAgICB3aGVuIDQgdGhlbiByZXN1bHQgPSB0ZXh0MS5sZW5ndGggPCB0ZXh0Mi5sZW5ndGgKICAgICAgICAgICAgICAgICAgICB3aGVuIDUgdGhlbiByZXN1bHQgPSB0ZXh0MS5sZW5ndGggPD0gdGV4dDIubGVuZ3RoCiAgICAgICAgICAgIHdoZW4gMTQgIyBNb25leQogICAgICAgICAgICAgICAgcmVzdWx0ID0gQGludGVycHJldGVyLmNvbXBhcmUoR2FtZU1hbmFnZXIubW9uZXksIEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMudmFsdWUzKSwgQHBhcmFtcy52YWx1ZTIpCiAgICAgICAgICAgIHdoZW4gMTUgIyBUaW1lcgogICAgICAgICAgICAgICAgcmVzdWx0ID0gQGludGVycHJldGVyLmNvbXBhcmUoR2FtZU1hbmFnZXIudGltZXIubWludXRlcywgQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy52YWx1ZTIpLCBAcGFyYW1zLnZhbHVlMSkKICAgICAgICAgICAgICAgIGlmIHJlc3VsdAogICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IEBpbnRlcnByZXRlci5jb21wYXJlKEdhbWVNYW5hZ2VyLnRpbWVyLnNlY29uZHMsIEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMudmFsdWUzKSwgQHBhcmFtcy52YWx1ZTEpCiAgICAgICAgICAgIHdoZW4gMTYgIyBHYW1lIFRpbWUKICAgICAgICAgICAgICAgIHJlc3VsdCA9IEBpbnRlcnByZXRlci5jb21wYXJlKEdhbWVNYW5hZ2VyLmdhbWVUaW1lLmhvdXJzLCBAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLnZhbHVlMiksIEBwYXJhbXMudmFsdWUxKQogICAgICAgICAgICAgICAgaWYgcmVzdWx0CiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gQGludGVycHJldGVyLmNvbXBhcmUoR2FtZU1hbmFnZXIuZ2FtZVRpbWUubWludXRlcywgQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy52YWx1ZTMpLCBAcGFyYW1zLnZhbHVlMSkKICAgICAgICAgICAgd2hlbiAxNyAjIFRpbWUKICAgICAgICAgICAgICAgIGRhdGUgPSBuZXcgRGF0ZSgpCiAgICAgICAgICAgICAgICBzd2l0Y2ggQHBhcmFtcy52YWx1ZTEKICAgICAgICAgICAgICAgICAgICB3aGVuIDAgdGhlbiByZXN1bHQgPSBAaW50ZXJwcmV0ZXIuY29tcGFyZShkYXRlLmdldEZ1bGxZZWFyKCksIEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMudmFsdWUzKSwgQHBhcmFtcy52YWx1ZTIpCiAgICAgICAgICAgICAgICAgICAgd2hlbiAxIHRoZW4gcmVzdWx0ID0gQGludGVycHJldGVyLmNvbXBhcmUoZGF0ZS5nZXRNb250aCgpLCBAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLnZhbHVlMyksIEBwYXJhbXMudmFsdWUyKQogICAgICAgICAgICAgICAgICAgIHdoZW4gMiB0aGVuIHJlc3VsdCA9IEBpbnRlcnByZXRlci5jb21wYXJlKGRhdGUuZ2V0V2VlaygpLCBAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLnZhbHVlMyksIEBwYXJhbXMudmFsdWUyKQogICAgICAgICAgICAgICAgICAgIHdoZW4gMyB0aGVuIHJlc3VsdCA9IEBpbnRlcnByZXRlci5jb21wYXJlKGRhdGUuZ2V0RGF5KCksIEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMudmFsdWUzKSwgQHBhcmFtcy52YWx1ZTIpCiAgICAgICAgICAgICAgICAgICAgd2hlbiA0IHRoZW4gcmVzdWx0ID0gQGludGVycHJldGVyLmNvbXBhcmUoZGF0ZS5nZXREYXlPZlllYXIoKSwgQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy52YWx1ZTMpLCBAcGFyYW1zLnZhbHVlMikKICAgICAgICAgICAgICAgICAgICB3aGVuIDUgdGhlbiByZXN1bHQgPSBAaW50ZXJwcmV0ZXIuY29tcGFyZShkYXRlLmdldEhvdXJzKCksIEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMudmFsdWUzKSwgQHBhcmFtcy52YWx1ZTIpCiAgICAgICAgICAgICAgICAgICAgd2hlbiA2IHRoZW4gcmVzdWx0ID0gQGludGVycHJldGVyLmNvbXBhcmUoZGF0ZS5nZXRNaW51dGVzKCksIEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMudmFsdWUzKSwgQHBhcmFtcy52YWx1ZTIpCiAgICAgICAgICAgICAgICAgICAgd2hlbiA3IHRoZW4gcmVzdWx0ID0gQGludGVycHJldGVyLmNvbXBhcmUoZGF0ZS5nZXRTZWNvbmRzKCksIEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMudmFsdWUzKSwgQHBhcmFtcy52YWx1ZTIpCiAgICAgICAgICAgICAgICAgICAgd2hlbiA4IHRoZW4gcmVzdWx0ID0gQGludGVycHJldGVyLmNvbXBhcmUoZGF0ZS5nZXRNaWxsaXNlY29uZHMoKSwgQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy52YWx1ZTMpLCBAcGFyYW1zLnZhbHVlMikKICAgICAgICAgICAgd2hlbiAxOCAjIElucHV0CiAgICAgICAgICAgICAgICBzd2l0Y2ggQHBhcmFtcy52YWx1ZTEKICAgICAgICAgICAgICAgICAgICB3aGVuIDAgdGhlbiByZXN1bHQgPSBJbnB1dC5rZXlzW0lucHV0LkRPV05dID09IChAcGFyYW1zLnZhbHVlMisxKQogICAgICAgICAgICAgICAgICAgIHdoZW4gMSB0aGVuIHJlc3VsdCA9IElucHV0LmtleXNbSW5wdXQuTEVGVF0gPT0gKEBwYXJhbXMudmFsdWUyKzEpCiAgICAgICAgICAgICAgICAgICAgd2hlbiAyIHRoZW4gcmVzdWx0ID0gSW5wdXQua2V5c1tJbnB1dC5VUF0gPT0gKEBwYXJhbXMudmFsdWUyKzEpCiAgICAgICAgICAgICAgICAgICAgd2hlbiAzIHRoZW4gcmVzdWx0ID0gSW5wdXQua2V5c1tJbnB1dC5SSUdIVF0gPT0gKEBwYXJhbXMudmFsdWUyKzEpCiAgICAgICAgICAgICAgICAgICAgd2hlbiA0IHRoZW4gcmVzdWx0ID0gSW5wdXQua2V5c1tJbnB1dC5BXSA9PSAoQHBhcmFtcy52YWx1ZTIrMSkKICAgICAgICAgICAgICAgICAgICB3aGVuIDUgdGhlbiByZXN1bHQgPSBJbnB1dC5rZXlzW0lucHV0LkJdID09IChAcGFyYW1zLnZhbHVlMisxKQogICAgICAgICAgICAgICAgICAgIHdoZW4gNiB0aGVuIHJlc3VsdCA9IElucHV0LmtleXNbSW5wdXQuWF0gPT0gKEBwYXJhbXMudmFsdWUyKzEpCiAgICAgICAgICAgICAgICAgICAgd2hlbiA3IHRoZW4gcmVzdWx0ID0gSW5wdXQua2V5c1tJbnB1dC5ZXSA9PSAoQHBhcmFtcy52YWx1ZTIrMSkKICAgICAgICAgICAgICAgICAgICB3aGVuIDggdGhlbiByZXN1bHQgPSBJbnB1dC5rZXlzW0lucHV0LlNUQVJUXSA9PSAoQHBhcmFtcy52YWx1ZTIrMSkKICAgICAgICAgICAgICAgICAgICB3aGVuIDkgdGhlbiByZXN1bHQgPSBJbnB1dC5rZXlzW0lucHV0LlNFTEVDVF0gPT0gKEBwYXJhbXMudmFsdWUyKzEpCiAgICAgICAgICAgIHdoZW4gMTkgIyBTY3JpcHQKICAgICAgICAgICAgICAgIHRyeQogICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IGV2YWwoQHBhcmFtcy52YWx1ZTEpCiAgICAgICAgICAgICAgICBjYXRjaCBleAogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJFUlJPUiBXSElMRSBFVkFMVUFUSU5HIFNDUklQVCBJTiBDT05ESVRJT04iKQogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGV4KQogICAgICAgICAgICB3aGVuIDIwICMgRXZlbnQKICAgICAgICAgICAgICAgIGV2ZW50ID0gQGludGVycHJldGVyLmV2ZW50QnlJZChAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLnZhbHVlMSkpCiAgICAgICAgICAgICAgICBpZiBldmVudD8KICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBpZiBAcGFyYW1zLnZhbHVlMiA9PSAwIHRoZW4gZXZlbnQuY2FuTW92ZShAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLnZhbHVlMykpIGVsc2UgIWV2ZW50LmNhbk1vdmUoQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy52YWx1ZTMpKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgaWYgbm90IHJlc3VsdCB0aGVuIEBpbnRlcnByZXRlci5za2lwKEBpbmRlbnQpCiAgICAgICAgCiAgICAgICAgQGludGVycHJldGVyLmNvbmRpdGlvbnMucHVzaChyZXN1bHQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgcmV0dXJuIG51bGwKICAgICAgICAKICAgIGNvbW1hbmRDb25kaXRpb25FbHNlQ2FzZTogLT4KICAgICAgICBpZiBAaW50ZXJwcmV0ZXIuY29uZGl0aW9uc1tAaW50ZXJwcmV0ZXIuY29uZGl0aW9ucy5sZW5ndGgtMV0KICAgICAgICAgICAgQGludGVycHJldGVyLnNraXAoQGluZGVudCkKICAgICAgICAKICAgIGNvbW1hbmRDb25kaXRpb25FbmQ6IC0+CiAgICAgICAgQGludGVycHJldGVyLmNvbmRpdGlvbnMucG9wKCkKICAgICAgICAKICAgIGNvbW1hbmRMYWJlbDogLT4KICAgICAgICBAaW50ZXJwcmV0ZXIubGFiZWxzW0BwYXJhbXMubmFtZV0gPSBAaW50ZXJwcmV0ZXIucG9pbnRlcgogICAgICAgIAogICAgY29tbWFuZEp1bXBUb0xhYmVsOiAtPgogICAgICAgIGxhYmVsID0gQGludGVycHJldGVyLmxhYmVsc1tAcGFyYW1zLm5hbWVdCiAgICAgICAgaWYgbGFiZWw/CiAgICAgICAgICAgIEBpbnRlcnByZXRlci5wb2ludGVyID0gbGFiZWwKICAgICAgICBlbHNlCiAgICAgICAgICAgIGZvciBpIGluIFtAaW50ZXJwcmV0ZXIucG9pbnRlci4uLkBpbnRlcnByZXRlci5jb21tYW5kcy5sZW5ndGhdCiAgICAgICAgICAgICAgICBpZiBAaW50ZXJwcmV0ZXIuY29tbWFuZHNbaV0ubm9kZUlkID09ICJncy5MYWJlbCIgYW5kIEBpbnRlcnByZXRlci5jb21tYW5kc1tpXS5wYXJhbXMubmFtZSA9PSBAcGFyYW1zLm5hbWUKICAgICAgICAgICAgICAgICAgICBAaW50ZXJwcmV0ZXIucG9pbnRlciA9IGkKICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgICAgIAogICAgaXNNZXNzYWdlQ29tbWFuZDogKHBvaW50ZXIsIGNvbW1hbmRzKSAtPgogICAgICAgIHJlc3VsdCA9IHllcwogICAgICAgIGlmIHBvaW50ZXIgPj0gY29tbWFuZHMubGVuZ3RoIG9yIChjb21tYW5kc1twb2ludGVyXS5pZCAhPSAiZ3MuU2hvd01lc3NhZ2UiIGFuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21tYW5kc1twb2ludGVyXS5pZCAhPSAiZ3MuSW5wdXROdW1iZXIiIGFuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21tYW5kc1twb2ludGVyXS5ub2RlSWQgIT0gImdzLlNob3dDaG9pY2VzIiBhbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tbWFuZHNbcG9pbnRlcl0uaWQgIT0gImdzLklucHV0VGV4dCIgYW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbW1hbmRzW3BvaW50ZXJdLmlkICE9ICJncy5JbnB1dE5hbWUiKQogICAgICAgICAgICAgICAgcmVzdWx0ID0gbm8KICAgICAgICByZXR1cm4gcmVzdWx0CiAgICAgICAgCiAgICBpc1Byb2Nlc3NpbmdNZXNzYWdlSW5PdGhlckNvbnRleHQ6IC0+CiAgICAgICAgcmVzdWx0ID0gbm8KICAgICAgICBnbSA9IEdhbWVNYW5hZ2VyCiAgICAgICAgCiAgICAgICAgcmVzdWx0ID0gKGdtLm1lc3NhZ2VXaW5kb3cudmlzaWJsZSBhbmQgZ20ubWVzc2FnZVdpbmRvdy5leGVjdXRpb25Db250ZXh0ICE9IEBjb250ZXh0KSBvcgogICAgICAgICAgICAgICAgIChnbS5pbnB1dE51bWJlcldpbmRvdz8gYW5kIGdtLmlucHV0TnVtYmVyV2luZG93LnZpc2libGUgYW5kIGdtLmlucHV0TnVtYmVyV2luZG93LmV4ZWN1dGlvbkNvbnRleHQgIT0gQGNvbnRleHQpIG9yCiAgICAgICAgICAgICAgICAgKGdtLmlucHV0VGV4dFdpbmRvd3NldD8gYW5kIGdtLmlucHV0VGV4dFdpbmRvd3NldC5hY3RpdmUgYW5kIGdtLmlucHV0VGV4dFdpbmRvd3NldC5leGVjdXRpb25Db250ZXh0ICE9IEBjb250ZXh0KSBvcgogICAgICAgICAgICAgICAgIChnbS5jaG9pY2VXaW5kb3c/IGFuZCBnbS5jaG9pY2VXaW5kb3cudmlzaWJsZSBhbmQgZ20uY2hvaWNlV2luZG93LmV4ZWN1dGlvbkNvbnRleHQgIT0gQGNvbnRleHQpCiAgICAgICAgCiAgICAgICAgcmV0dXJuIHJlc3VsdAogICAgICAgIAogICAgd2FpdEZvck1lc3NhZ2U6IC0+CiAgICAgICAgQGlzV2FpdGluZ0Zvck1lc3NhZ2UgPSB5ZXMKICAgICAgICBAaXNXYWl0aW5nID0geWVzCiAgICAgICAgQHBvaW50ZXItLQogICAgICAgIAogICAgY29tbWFuZFNob3dNZXNzYWdlOiAtPgogICAgICAgIEdhbWVNYW5hZ2VyLm1hcC5jdXJyZW50RXZlbnQuaXNMb2NrZWQgPSB5ZXMgICAKICAgICAgICBtZXNzYWdlV2luZG93ID0gR2FtZU1hbmFnZXIubWVzc2FnZVdpbmRvdwogICAgICAgIAogICAgICAgIGlmIEBpbnRlcnByZXRlci5pc1Byb2Nlc3NpbmdNZXNzYWdlSW5PdGhlckNvbnRleHQoKQogICAgICAgICAgICBAaW50ZXJwcmV0ZXIud2FpdEZvck1lc3NhZ2UoKQogICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgCiAgICAgICAgbWVzc2FnZVdpbmRvdy5leGVjdXRpb25Db250ZXh0ID0gQGludGVycHJldGVyLmNvbnRleHQKICAgICAgICBtZXNzYWdlV2luZG93LnJlc2l6ZSgpCiAgICAgICAgbWVzc2FnZVdpbmRvdy5tZXNzYWdlID0gbGNzbShAcGFyYW1zLm1lc3NhZ2UpCiAgICAgICAgbWVzc2FnZVdpbmRvdy5mYWNlR3JhcGhpYyA9IEBwYXJhbXMuZmFjZUdyYXBoaWMKICAgICAgICBtZXNzYWdlV2luZG93LmZhY2VQYXR0ZXJuID0gQHBhcmFtcy5mYWNlUGF0dGVybgogICAgICAgIG1lc3NhZ2VXaW5kb3cucG9zaXRpb24gPSBAcGFyYW1zLnBvc2l0aW9uCiAgICAgICAgbWVzc2FnZVdpbmRvdy5uYW1lID0gQHBhcmFtcy5uYW1lIHx8ICIiCiAgICAgICAgbWVzc2FnZVdpbmRvdy5vcGFjaXR5ID0gaWYgQHBhcmFtcy5oaWRlV2luZG93IHRoZW4gMCBlbHNlIDI1NQogICAgICAgIG1lc3NhZ2VXaW5kb3cuc2Nyb2xsV2l0aE1hcCA9IG5vCiAgICAgICAgbWVzc2FnZVdpbmRvdy5zZXRWaWV3cG9ydChudWxsKQogICAgICAgIG1lc3NhZ2VXaW5kb3cub3BlbigpCiAgICAgICAgbWVzc2FnZVdpbmRvdy5zdGFydCgpCiAgICAgICAgbWVzc2FnZVdpbmRvdy5ldmVudCA9IEdhbWVNYW5hZ2VyLm1hcC5jdXJyZW50RXZlbnQKICAgICAgICBtZXNzYWdlV2luZG93Lm9uRmluaXNoID0gPT4KICAgICAgICAgICAgQGludGVycHJldGVyLmlzV2FpdGluZyA9IG5vCiAgICAgICAgICAgIHBvaW50ZXIgPSBAaW50ZXJwcmV0ZXIucG9pbnRlcgogICAgICAgICAgICBjb21tYW5kcyA9IEBpbnRlcnByZXRlci5jb21tYW5kcwogICAgICAgICAgICBpZiBub3QgQGludGVycHJldGVyLmlzTWVzc2FnZUNvbW1hbmQocG9pbnRlciwgY29tbWFuZHMpCiAgICAgICAgICAgICAgICBHYW1lTWFuYWdlci5tZXNzYWdlV2luZG93LmNsb3NlKCkKICAgICAgICAgICAgICAgIEdhbWVNYW5hZ2VyLm1lc3NhZ2VXaW5kb3cuZXZlbnQuaXNMb2NrZWQgPSBubwogICAgICAgIAogICAgICAgIEBpbnRlcnByZXRlci5pc1dhaXRpbmcgPSB5ZXMKICAgICAgICAKICAgIGNvbW1hbmRTaG93QnViYmxlTWVzc2FnZTogLT4KICAgICAgICBtZXNzYWdlV2luZG93ID0gR2FtZU1hbmFnZXIubWVzc2FnZVdpbmRvdwogICAgICAgIGlmIEBpbnRlcnByZXRlci5pc1Byb2Nlc3NpbmdNZXNzYWdlSW5PdGhlckNvbnRleHQoKQogICAgICAgICAgICBAaW50ZXJwcmV0ZXIud2FpdEZvck1lc3NhZ2UoKQogICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgCiAgICAgICAgcyA9IFdpbmRvd19CYXNlLnNjYWxlCiAgICAgICAgbWFwID0gU2NlbmVNYW5hZ2VyLnNjZW5lLm1hcAogICAgICAgIGV2ZW50ID0gQGludGVycHJldGVyLmV2ZW50QnlJZChAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLmV2ZW50SWQpKQogICAgICAgIGV2ZW50LmlzTG9ja2VkID0geWVzCiAgICAgICAgZXZlbnRTcHJpdGUgPSBtYXAuZXZlbnRzQnlJZFtldmVudC5pZF0KICAgICAgICBleCA9IGV2ZW50U3ByaXRlLngKICAgICAgICBleSA9IGV2ZW50U3ByaXRlLnkKICAgICAgICB0ZXh0ID0gbnVsbAogICAgICAgIGxpbmVzID0gbnVsbAogICAgICAgIHNpemUgPSBudWxsCiAgICAgICAgbWF4U2l6ZSA9IDAKICAgICAgICBtZXNzYWdlV2luZG93LmV4ZWN1dGlvbkNvbnRleHQgPSBAaW50ZXJwcmV0ZXIuY29udGV4dAogICAgICAgIG1lc3NhZ2VXaW5kb3cubWVzc2FnZSA9IGxjc20oQHBhcmFtcy5tZXNzYWdlKQogICAgICAgIHRleHQgPSBtZXNzYWdlV2luZG93LnJlc29sdmVQbGFjZWhvbGRlcnMobWVzc2FnZVdpbmRvdy5tZXNzYWdlKQogICAgICAgIGxpbmVzID0gdGV4dC5zcGxpdCgnXG4nKQogICAgICAgIGxvbmdlc3RMaW5lID0gIiIKICAgICAgICBtZXNzYWdlV2luZG93LmNvbnRlbnRzLmZvbnQgPSBtZXNzYWdlV2luZG93Lm1lc3NhZ2VGb250ICAKICAgICAgICBmb3IgbGluZSBpbiBsaW5lcwogICAgICAgICAgICBzaXplID0gbWVzc2FnZVdpbmRvdy5jb250ZW50cy50ZXh0U2l6ZShsaW5lKQogICAgICAgICAgICBpZiBzaXplLndpZHRoID4gbWF4U2l6ZQogICAgICAgICAgICAgICAgbG9uZ2VzdExpbmUgPSBsaW5lCiAgICAgICAgZm9yIGkgaW4gWzAuLi5sb25nZXN0TGluZS5sZW5ndGhdCiAgICAgICAgICAgIHNpemUgPSBtZXNzYWdlV2luZG93LmNvbnRlbnRzLnRleHRTaXplKGxvbmdlc3RMaW5lLmNoYXJBdChpKSkKICAgICAgICAgICAgbWF4U2l6ZSArPSBzaXplLndpZHRoCiAgICAgICAgICAgIAogICAgICAgIG1lc3NhZ2VXaW5kb3cud2lkdGggPSBNYXRoLmZsb29yKG1heFNpemUgKyAyNCpzKQogICAgICAgIG1lc3NhZ2VXaW5kb3cuaGVpZ2h0ID0gTWF0aC5mbG9vcihsaW5lcy5sZW5ndGggKiAoc2l6ZS5oZWlnaHQrMTAqcykgKyAyMipzKQogICAgICAgIG1lc3NhZ2VXaW5kb3cuY29udGVudHMgPSBuZXcgQml0bWFwKE1hdGguZmxvb3IobWF4U2l6ZSksIE1hdGguZmxvb3IobGluZXMubGVuZ3RoICogKHNpemUuaGVpZ2h0KzEwKnMpKSkKICAgICAgICBtZXNzYWdlV2luZG93LmNvbnRlbnRzLmZvbnQgPSBtZXNzYWdlV2luZG93Lm1lc3NhZ2VGb250ICAgIAogICAgICAgIAogICAgICAgIG1lc3NhZ2VXaW5kb3cuZmFjZUdyYXBoaWMgPSBudWxsCiAgICAgICAgbWVzc2FnZVdpbmRvdy5mYWNlUGF0dGVybiA9IDAKICAgICAgICBtZXNzYWdlV2luZG93LnBvc2l0aW9uID0gMAogICAgICAgIG1lc3NhZ2VXaW5kb3cubmFtZSA9IEBwYXJhbXMubmFtZSB8fCAiIgogICAgICAgIG1lc3NhZ2VXaW5kb3cub3BhY2l0eSA9IGlmIEBwYXJhbXMuaGlkZVdpbmRvdyB0aGVuIDAgZWxzZSAyNTUKICAgICAgICBtZXNzYWdlV2luZG93Lm9wZW4oKQogICAgICAgIG1lc3NhZ2VXaW5kb3cuc3RhcnQoKQogICAgICAgIG1lc3NhZ2VXaW5kb3cuZXZlbnQgPSBldmVudAogICAgICAgIG1lc3NhZ2VXaW5kb3cuc2Nyb2xsV2l0aE1hcCA9IHllcwogICAgICAgIAogICAgICAgIG1lc3NhZ2VXaW5kb3cueCA9IE1hdGguZmxvb3IoTWF0aC5tYXgoZXggLSAobWVzc2FnZVdpbmRvdy53aWR0aCAtIGV2ZW50U3ByaXRlLnNyY1JlY3Qud2lkdGgpIC8gMiwgMCkpCiAgICAgICAgbWVzc2FnZVdpbmRvdy55ID0gTWF0aC5mbG9vcihNYXRoLm1heChleSAtIG1lc3NhZ2VXaW5kb3cuaGVpZ2h0IC0gNSpzLCAwKSkKICAgICAgICAjbWVzc2FnZVdpbmRvdy54ID0gTWF0aC5mbG9vcihleCAtIChtZXNzYWdlV2luZG93LndpZHRoIC0gZXZlbnRTcHJpdGUuc3JjUmVjdC53aWR0aCkgLyAyKQogICAgICAgICNtZXNzYWdlV2luZG93LnkgPSBNYXRoLmZsb29yKGV5IC0gbWVzc2FnZVdpbmRvdy5oZWlnaHQgLSA1KnMpCiAgICAgICAgCiAgICAgICAgbWVzc2FnZVdpbmRvdy5vbkZpbmlzaCA9ID0+CiAgICAgICAgICAgIEBpbnRlcnByZXRlci5pc1dhaXRpbmcgPSBubwogICAgICAgICAgICBwb2ludGVyID0gQGludGVycHJldGVyLnBvaW50ZXIKICAgICAgICAgICAgY29tbWFuZHMgPSBAaW50ZXJwcmV0ZXIuY29tbWFuZHMKICAgICAgICAgICAgaWYgbm90IEBpbnRlcnByZXRlci5pc01lc3NhZ2VDb21tYW5kKHBvaW50ZXIsIGNvbW1hbmRzKQogICAgICAgICAgICAgICAgR2FtZU1hbmFnZXIubWVzc2FnZVdpbmRvdy5jbG9zZSgpCiAgICAgICAgICAgICAgICBHYW1lTWFuYWdlci5tZXNzYWdlV2luZG93LmV2ZW50LmlzTG9ja2VkID0gbm8KICAgICAgICAKICAgICAgICBAaW50ZXJwcmV0ZXIuaXNXYWl0aW5nID0geWVzCiAgICAgCiAgICBfY29tbWFuZENoYW5nZUl0ZW1zOiAoaXRlbXMsIHJlY29yZHMsIHBhcmFtcykgLT4KICAgICAgICB2YWx1ZSA9IEBudW1iZXJWYWx1ZU9mKHBhcmFtcy52YWx1ZSkKICAgICAgICBpdGVtSWQgPSBAbnVtYmVyVmFsdWVPZihwYXJhbXMuaXRlbUlkKQogICAgICAgIAogICAgICAgIGlmIG5vdCBpdGVtc1tpdGVtSWRdPyAKICAgICAgICAgICAgaXRlbXNbaXRlbUlkXSA9IHsgaXRlbTogcmVjb3Jkc1tpdGVtSWRdLCBjb3VudDogMCB9CiAgICAgICAgCiAgICAgICAgc3dpdGNoIHBhcmFtcy5vcGVyYXRpb24KICAgICAgICAgICAgd2hlbiAwICMgU2V0IHRvCiAgICAgICAgICAgICAgICBpdGVtc1tpdGVtSWRdLmNvdW50ID0gdmFsdWUKICAgICAgICAgICAgd2hlbiAxICMgSW5jcmVhc2UgYnkKICAgICAgICAgICAgICAgIGl0ZW1zW2l0ZW1JZF0uY291bnQgKz0gdmFsdWUKICAgICAgICAgICAgd2hlbiAyICMgRGVjcmVhc2UgYnkKICAgICAgICAgICAgICAgIGl0ZW1zW2l0ZW1JZF0uY291bnQgLT0gdmFsdWUKICAgICAgICAgICAgICAgIAogICAgY29tbWFuZENoYW5nZUl0ZW1zOiAtPiAKICAgICAgICBAaW50ZXJwcmV0ZXIuX2NvbW1hbmRDaGFuZ2VJdGVtcyhHYW1lTWFuYWdlci5pbnZlbnRvcnkuaXRlbXMsIFJlY29yZE1hbmFnZXIuaXRlbXMsIEBwYXJhbXMpCiAgICAKICAgIGNvbW1hbmRDaGFuZ2VXZWFwb25zOiAtPiAKICAgICAgICBAaW50ZXJwcmV0ZXIuX2NvbW1hbmRDaGFuZ2VJdGVtcyhHYW1lTWFuYWdlci5pbnZlbnRvcnkud2VhcG9ucywgUmVjb3JkTWFuYWdlci53ZWFwb25zLCBAcGFyYW1zKQogICAgICAgIAogICAgY29tbWFuZENoYW5nZUFybW9yczogLT4gCiAgICAgICAgQGludGVycHJldGVyLl9jb21tYW5kQ2hhbmdlSXRlbXMoR2FtZU1hbmFnZXIuaW52ZW50b3J5LmFybW9ycywgUmVjb3JkTWFuYWdlci5hcm1vcnMsIEBwYXJhbXMpCiAgICAgICAgCiAgICBjb21tYW5kQ2hhbmdlTW9uZXk6IC0+CiAgICAgICAgdmFsdWUgPSAwCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgc3dpdGNoIEBwYXJhbXMub3BlcmF0aW9uCiAgICAgICAgICAgIHdoZW4gMAogICAgICAgICAgICAgICAgdmFsdWUgPSBAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLnZhbHVlKQogICAgICAgICAgICAgICAgR2FtZU1hbmFnZXIubW9uZXkgPSB2YWx1ZQogICAgICAgICAgICB3aGVuIDEKICAgICAgICAgICAgICAgIHZhbHVlID0gQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy5pbmNyZW1lbnQpCiAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBHYW1lTWFuYWdlci5tb25leSArPSB2YWx1ZQogICAgICAgICAgICB3aGVuIDIKICAgICAgICAgICAgICAgIHZhbHVlID0gQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy5kZWNyZW1lbnQpCiAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBHYW1lTWFuYWdlci5tb25leSAtPSB2YWx1ZQogICAgICAgICAgICAgICAgCiAgICBjb21tYW5kQ2hhbmdlV2VhdGhlcjogLT4KICAgICAgICB3ZWF0aGVyID0gR2FtZU1hbmFnZXIud2VhdGhlcgogICAgICAgIHBvd2VyID0gQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy5wb3dlcikKICAgICAgICBkdXJhdGlvbiA9IEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMuZHVyYXRpb24pCiAgICAgICAgaWYgQHBhcmFtcy50eXBlID09IDAKICAgICAgICAgICAgcG93ZXIgPSAwCiAgICAgICAgZWxzZQogICAgICAgICAgICB3ZWF0aGVyLnR5cGUgPSBAcGFyYW1zLnR5cGUgLSAxCiAgICAgICAgCiAgICAgICAgICAgIGlmIHdlYXRoZXIucG93ZXIgPT0gMAogICAgICAgICAgICAgICAgd2VhdGhlci5jdXJyZW50UG93ZXIgPSAxCiAgICAgICAgCiAgICAgICAgaWYgZHVyYXRpb24gPiAwCiAgICAgICAgICAgIHdlYXRoZXIucG93ZXJJbmNyZW1lbnQgPSBNYXRoLmFicyhwb3dlciAtIHdlYXRoZXIucG93ZXIpIC8gZHVyYXRpb24KICAgICAgICBlbHNlCiAgICAgICAgICAgIHdlYXRoZXIuY3VycmVudFBvd2VyID0gcG93ZXIKICAgICAgICAgICAgICAgIAogICAgICAgIHdlYXRoZXIucG93ZXIgPSBwb3dlcgogICAgICAgIHdlYXRoZXIucmVmcmVzaCgpCiAgICAgICAgICAgIAogICAgY29tbWFuZFNoYWtlU2NyZWVuOiAtPgogICAgICAgIGlmIEBwYXJhbXMuc3RhdHVzID09IDEKICAgICAgICAgICAgR2FtZU1hbmFnZXIuc2NyZWVuLnN0b3BTaGFrZSgpCiAgICAgICAgZWxzZQogICAgICAgICAgICBwb3dlciA9IEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMucG93ZXIpCiAgICAgICAgICAgIHNwZWVkID0gQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy5zcGVlZCkKICAgICAgICAgICAgCiAgICAgICAgICAgIGR1cmF0aW9uID0gQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy5kdXJhdGlvbikKICAgICAgICAgICAgZHVyYXRpb24gPSBpZiBkdXJhdGlvbiA9PSAwIHRoZW4gLTEgZWxzZSBkdXJhdGlvbgogICAgICAgICAgICBHYW1lTWFuYWdlci5zY3JlZW4uc3RhcnRTaGFrZShwb3dlciwgc3BlZWQsIGR1cmF0aW9uKQogICAgICAgICAgICAKICAgICAgICAgICAgaWYgbm90IChkdXJhdGlvbiA9PSAtMSkgYW5kIEBwYXJhbXMud2FpdEZvckNvbXBsZXRpb24KICAgICAgICAgICAgICAgIEBpbnRlcnByZXRlci5pc1dhaXRpbmcgPSB5ZXMKICAgICAgICAgICAgICAgIEBpbnRlcnByZXRlci53YWl0Q291bnRlciA9IGR1cmF0aW9uCiAgICAgICAgICAgICAgICAKICAgIGNvbW1hbmRUaW50U2NyZWVuOiAtPgogICAgICAgIGR1cmF0aW9uID0gQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy5kdXJhdGlvbikKICAgICAgICBHYW1lTWFuYWdlci5zY3JlZW4udGludChAcGFyYW1zLnRvbmUsIGR1cmF0aW9uKQogICAgICAgIAogICAgICAgIGlmIEBwYXJhbXMud2FpdEZvckNvbXBsZXRpb24gYW5kIG5vdCBkdXJhdGlvbiA9PSAwCiAgICAgICAgICAgIEBpbnRlcnByZXRlci5pc1dhaXRpbmcgPSB5ZXMKICAgICAgICAgICAgQGludGVycHJldGVyLndhaXRDb3VudGVyID0gZHVyYXRpb24KICAgICAgICAgICAgCiAgICBjb21tYW5kRmxhc2hTY3JlZW46IC0+CiAgICAgICAgZHVyYXRpb24gPSBAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLmR1cmF0aW9uKQogICAgICAgIEdyYXBoaWNzLnZpZXdwb3J0LmZsYXNoKG5ldyBDb2xvcihAcGFyYW1zLmNvbG9yKSwgZHVyYXRpb24pCiAgICAgICAgCiAgICAgICAgaWYgQHBhcmFtcy53YWl0Rm9yQ29tcGxldGlvbiBhbmQgbm90IGR1cmF0aW9uID09IDAKICAgICAgICAgICAgQGludGVycHJldGVyLmlzV2FpdGluZyA9IHllcwogICAgICAgICAgICBAaW50ZXJwcmV0ZXIud2FpdENvdW50ZXIgPSBkdXJhdGlvbgogICAgICAgICAgICAKICAgIGNvbW1hbmRTaG93UGljdHVyZTogLT4KICAgICAgICBudW1iZXIgPSBAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLm51bWJlcikKICAgICAgICBwaWN0dXJlcyA9IEdhbWVNYW5hZ2VyLnBpY3R1cmVzCiAgICAgICAgaWYgbm90IHBpY3R1cmVzW251bWJlcl0/IHRoZW4gcGljdHVyZXNbbnVtYmVyXSA9IG5ldyBTcHJpdGVfUGljdHVyZShuZXcgTG9naWNfUGljdHVyZSgpKQogICAgICAgIAogICAgICAgIHggPSBAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLngpCiAgICAgICAgeSA9IEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMueSkKICAgICAgICAKICAgICAgICBwaWN0dXJlID0gcGljdHVyZXNbbnVtYmVyXQogICAgICAgIHBpY3R1cmUuYml0bWFwID0gUmVzb3VyY2VNYW5hZ2VyLmdldEJpdG1hcCgiR3JhcGhpY3MvUGljdHVyZXMvI3tAcGFyYW1zLmdyYXBoaWMubmFtZX0iKQogICAgICAgIHBpY3R1cmUuc3JjUmVjdCA9IG5ldyBSZWN0KDAsIDAsIHBpY3R1cmUuYml0bWFwLndpZHRoLCBwaWN0dXJlLmJpdG1hcC5oZWlnaHQpCiAgICAgICAgcGljdHVyZS52aXNpYmxlID0geWVzCiAgICAgICAgcGljdHVyZS5sb2dpYy56b29tWCA9IEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMuc2NhbGVYKSAvIDEwMAogICAgICAgIHBpY3R1cmUubG9naWMuem9vbVkgPSBAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLnNjYWxlWSkgLyAxMDAKICAgICAgICB4ID0gaWYgQHBhcmFtcy5vcmlnaW4gPT0gMCB0aGVuIHggZWxzZSAoeCAtIChwaWN0dXJlLmJpdG1hcC53aWR0aCpwaWN0dXJlLmxvZ2ljLnpvb21YKSAgLyAyKQogICAgICAgIHkgPSBpZiBAcGFyYW1zLm9yaWdpbiA9PSAwIHRoZW4geSBlbHNlICh5IC0gKHBpY3R1cmUuYml0bWFwLmhlaWdodCpwaWN0dXJlLmxvZ2ljLnpvb21ZKSAvIDIpCiAgICAgICAgeCA9IGlmIEBwYXJhbXMuc2NyZWVuT3JpZ2luID09IDAgdGhlbiB4IGVsc2UgKHggKyAoR3JhcGhpY3Mud2lkdGgpICAvIDIpCiAgICAgICAgeSA9IGlmIEBwYXJhbXMuc2NyZWVuT3JpZ2luID09IDAgdGhlbiB5IGVsc2UgKHkgKyAoR3JhcGhpY3MuaGVpZ2h0KSAvIDIpCiAgICAgICAgcGljdHVyZS5sb2dpYy54ID0geAogICAgICAgIHBpY3R1cmUubG9naWMueSA9IHkKICAgICAgICBwaWN0dXJlLmxvZ2ljLmFuZ2xlID0gTWF0aC5kZWdyZWVzVG9SYWRpYW5zKEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMuYW5nbGUpKQogICAgICAgIHBpY3R1cmUubG9naWMub3BhY2l0eSA9IEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMub3BhY2l0eSkKICAgICAgICBwaWN0dXJlLmJsZW5kaW5nTW9kZSA9IEBwYXJhbXMuYmxlbmRpbmcKICAgICAgICBwaWN0dXJlLnogPSAyMDAKICAgICAgICAKICAgIGNvbW1hbmRNb3ZlUGljdHVyZTogLT4KICAgICAgICBudW1iZXIgPSBAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLm51bWJlcikKICAgICAgICBwaWN0dXJlID0gR2FtZU1hbmFnZXIucGljdHVyZXNbbnVtYmVyXQogICAgICAgIGlmIG5vdCBwaWN0dXJlPyB0aGVuIHJldHVybgogICAgICAgIAogICAgICAgIHpvb21YID0gcGljdHVyZS5sb2dpYy56b29tWAogICAgICAgIHpvb21ZID0gcGljdHVyZS5sb2dpYy56b29tWQogICAgICAgIHggPSBAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLngpCiAgICAgICAgeSA9IEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMueSkKICAgICAgICB4ID0gaWYgQHBhcmFtcy5vcmlnaW4gPT0gMCB0aGVuIHggZWxzZSAoeCAtIHBpY3R1cmUuYml0bWFwLndpZHRoKnpvb21YIC8gMikKICAgICAgICB5ID0gaWYgQHBhcmFtcy5vcmlnaW4gPT0gMCB0aGVuIHkgZWxzZSAoeSAtIHBpY3R1cmUuYml0bWFwLmhlaWdodCp6b29tWSAvIDIpCiAgICAgICAgeCA9IGlmIEBwYXJhbXMuc2NyZWVuT3JpZ2luID09IDAgdGhlbiB4IGVsc2UgKHggKyBHcmFwaGljcy53aWR0aCAvIDIpCiAgICAgICAgeSA9IGlmIEBwYXJhbXMuc2NyZWVuT3JpZ2luID09IDAgdGhlbiB5IGVsc2UgKHkgKyBHcmFwaGljcy5oZWlnaHQgLyAyKQogICAgICAgIAogICAgICAgIGR1cmF0aW9uID0gQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy5kdXJhdGlvbikKICAgICAgICBwaWN0dXJlLmxvZ2ljLm1vdmVUbyh4LCB5LCBkdXJhdGlvbikKICAgICAgICBwaWN0dXJlLmxvZ2ljLnpvb21UbyhAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLnNjYWxlWCkgLyAxMDAsIAogICAgICAgICAgICAgICAgICAgICAgIEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMuc2NhbGVZKSAvIDEwMCwgCiAgICAgICAgICAgICAgICAgICAgICAgZHVyYXRpb24pCiAgICAgICAgcGljdHVyZS5sb2dpYy5ibGVuZFRvKEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMub3BhY2l0eSksIAogICAgICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbikKICAgICAgICBwaWN0dXJlLmJsZW5kaW5nTW9kZSA9IEBwYXJhbXMuYmxlbmRpbmcKICAgICAgICAKICAgICAgICBpZiBAcGFyYW1zLndhaXRGb3JDb21wbGV0aW9uIGFuZCBub3QgKGR1cmF0aW9uID09IDApCiAgICAgICAgCiAgICAgICAgICAgIEBpbnRlcnByZXRlci5pc1dhaXRpbmcgPSB5ZXMKICAgICAgICAgICAgQGludGVycHJldGVyLndhaXRDb3VudGVyID0gZHVyYXRpb24KICAgICAgICAgICAgCiAgICBjb21tYW5kVGludFBpY3R1cmU6IC0+CiAgICAgICAgbnVtYmVyID0gQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy5udW1iZXIpCiAgICAgICAgcGljdHVyZSA9IEdhbWVNYW5hZ2VyLnBpY3R1cmVzW251bWJlcl0KICAgICAgICBpZiBub3QgcGljdHVyZT8gdGhlbiByZXR1cm4KICAgICAgICAKICAgICAgICBkdXJhdGlvbiA9IEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMuZHVyYXRpb24pCiAgICAgICAgcGljdHVyZS5sb2dpYy50aW50VG8oQHBhcmFtcy50b25lLCBkdXJhdGlvbikKICAgICAgICAKICAgICAgICBpZiBAcGFyYW1zLndhaXRGb3JDb21wbGV0aW9uIGFuZCBub3QgKGR1cmF0aW9uID09IDApCiAgICAgICAgICAgIEBpbnRlcnByZXRlci5pc1dhaXRpbmcgPSB5ZXMKICAgICAgICAgICAgQGludGVycHJldGVyLndhaXRDb3VudGVyID0gZHVyYXRpb24KICAgICAgICAgICAgCiAgICBjb21tYW5kUm90YXRlUGljdHVyZTogLT4KICAgICAgICBudW1iZXIgPSBAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLm51bWJlcikKICAgICAgICBwaWN0dXJlID0gR2FtZU1hbmFnZXIucGljdHVyZXNbbnVtYmVyXQogICAgICAgIGlmIG5vdCBwaWN0dXJlPyB0aGVuIHJldHVybgogICAgICAgIAogICAgICAgIGR1cmF0aW9uID0gQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy5kdXJhdGlvbikKICAgICAgICBkdXJhdGlvbiA9IGlmIGR1cmF0aW9uID09IDAgdGhlbiAtMSBlbHNlIGR1cmF0aW9uCiAgICAgICAgcGljdHVyZS5sb2dpYy5yb3RhdGUoQHBhcmFtcy5kaXJlY3Rpb24sIEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMuc3BlZWQpIC8gMTAwLCBkdXJhdGlvbikKICAgICAgICAKICAgICAgICBpZiBAcGFyYW1zLndhaXRGb3JDb21wbGV0aW9uIGFuZCBub3QgKGR1cmF0aW9uID09IDApCiAgICAgICAgICAgIEBpbnRlcnByZXRlci5pc1dhaXRpbmcgPSB5ZXMKICAgICAgICAgICAgQGludGVycHJldGVyLndhaXRDb3VudGVyID0gZHVyYXRpb24gICAKICAgICAgICAgICAgCiAgICBjb21tYW5kRXJhc2VQaWN0dXJlOiAtPgogICAgICAgIG51bWJlciA9IEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMubnVtYmVyKQogICAgICAgIHBpY3R1cmUgPSBHYW1lTWFuYWdlci5waWN0dXJlc1tudW1iZXJdCiAgICAgICAgCiAgICAgICAgaWYgcGljdHVyZT8gdGhlbiBwaWN0dXJlLmRpc3Bvc2UoKQogICAgICAgIEdhbWVNYW5hZ2VyLnBpY3R1cmVzW251bWJlcl0gPSBudWxsCiAgICAgICAgICAgIAogICAgY29tbWFuZElucHV0TnVtYmVyOiAtPgogICAgICAgIEBpbnRlcnByZXRlci5pc1dhaXRpbmcgPSB5ZXMKICAgICAgICBpZiBAaW50ZXJwcmV0ZXIuaXNQcm9jZXNzaW5nTWVzc2FnZUluT3RoZXJDb250ZXh0KCkKICAgICAgICAgICAgQGludGVycHJldGVyLndhaXRGb3JNZXNzYWdlKCkKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgCiAgICAgICAgICAgCiAgICAgICAgaWYgR2FtZU1hbmFnZXIuaW5wdXROdW1iZXJXaW5kb3c/IAogICAgICAgICAgICBHYW1lTWFuYWdlci5pbnB1dE51bWJlcldpbmRvdy5kaXNwb3NlKCkKICAgICAgICAgICAgCiAgICAgICAgR2FtZU1hbmFnZXIuaW5wdXROdW1iZXJXaW5kb3cgPSBuZXcgV2luZG93X0lucHV0TnVtYmVyKEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMuZGlnaXRzKSkKICAgICAgICBHYW1lTWFuYWdlci5pbnB1dE51bWJlcldpbmRvdy5ldmVudCA9IEdhbWVNYW5hZ2VyLm1hcC5jdXJyZW50RXZlbnQKICAgICAgICBHYW1lTWFuYWdlci5pbnB1dE51bWJlcldpbmRvdy5ldmVudC5pc0xvY2tlZCA9IHllcwogICAgICAgIEdhbWVNYW5hZ2VyLmlucHV0TnVtYmVyV2luZG93LmlzQ2FuY2VsYWJsZSA9IG5vCiAgICAgICAgR2FtZU1hbmFnZXIuaW5wdXROdW1iZXJXaW5kb3cuZXhlY3V0aW9uQ29udGV4dCA9IEBpbnRlcnByZXRlci5jb250ZXh0CiAgICAgICAgR2FtZU1hbmFnZXIuaW5wdXROdW1iZXJXaW5kb3cub25BY2NlcHQgPSAobnVtYmVyKSA9PiAKICAgICAgICAgICAgQGludGVycHJldGVyLnNldE51bWJlclZhbHVlVG8oQHBhcmFtcy52YXJpYWJsZSwgbnVtYmVyKQogICAgICAgICAgICBAaW50ZXJwcmV0ZXIuaXNXYWl0aW5nID0gbm8KICAgICAgICAgICAgaWYgbm90IEBpbnRlcnByZXRlci5pc01lc3NhZ2VDb21tYW5kKEBpbnRlcnByZXRlci5wb2ludGVyLCBAaW50ZXJwcmV0ZXIuY29tbWFuZHMpCiAgICAgICAgICAgICAgICBHYW1lTWFuYWdlci5tZXNzYWdlV2luZG93LmNsb3NlKCkKICAgICAgICAgICAgICAgIEdhbWVNYW5hZ2VyLmlucHV0TnVtYmVyV2luZG93LmV2ZW50LmlzTG9ja2VkID0gbm8KICAgICAgICAgICAgCiAgICAgICAgR2FtZU1hbmFnZXIuaW5wdXROdW1iZXJXaW5kb3cub3BlbigpCiAgICAgICAgCiAgICBjb21tYW5kU2hvd0Nob2ljZXM6IC0+IAogICAgICAgIGlmIEBpbnRlcnByZXRlci5pc1Byb2Nlc3NpbmdNZXNzYWdlSW5PdGhlckNvbnRleHQoKQogICAgICAgICAgICBAaW50ZXJwcmV0ZXIud2FpdEZvck1lc3NhZ2UoKQogICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgCiAgICAgICAgaWYgR2FtZU1hbmFnZXIuY2hvaWNlV2luZG93PwogICAgICAgICAgICBHYW1lTWFuYWdlci5jaG9pY2VXaW5kb3cuZGlzcG9zZSgpCiAgICAgICAgY29uc29sZS5sb2coQHBhcmFtcykKICAgICAgICBjaG9pY2VzID0gW10KICAgICAgICBpZiBAcGFyYW1zLmNob2ljZVNlbGVjdGVkMSB0aGVuIGNob2ljZXMucHVzaCh7IHRleHQ6IEBpbnRlcnByZXRlci5zdHJpbmdWYWx1ZU9mKEBwYXJhbXMuY2hvaWNlMSksIGluZGV4OiAwIH0pCiAgICAgICAgaWYgQHBhcmFtcy5jaG9pY2VTZWxlY3RlZDIgdGhlbiBjaG9pY2VzLnB1c2goeyB0ZXh0OiBAaW50ZXJwcmV0ZXIuc3RyaW5nVmFsdWVPZihAcGFyYW1zLmNob2ljZTIpLCBpbmRleDogMSB9KQogICAgICAgIGlmIEBwYXJhbXMuY2hvaWNlU2VsZWN0ZWQzIHRoZW4gY2hvaWNlcy5wdXNoKHsgdGV4dDogQGludGVycHJldGVyLnN0cmluZ1ZhbHVlT2YoQHBhcmFtcy5jaG9pY2UzKSwgaW5kZXg6IDIgfSkKICAgICAgICBpZiBAcGFyYW1zLmNob2ljZVNlbGVjdGVkNCB0aGVuIGNob2ljZXMucHVzaCh7IHRleHQ6IEBpbnRlcnByZXRlci5zdHJpbmdWYWx1ZU9mKEBwYXJhbXMuY2hvaWNlNCksIGluZGV4OiAzIH0pCiAgICAgICAgCiAgICAgICAgaWYgY2hvaWNlcy5sZW5ndGggPiAwCiAgICAgICAgICAgIEBpbnRlcnByZXRlci5pc1dhaXRpbmcgPSB5ZXMKICAgICAgICAgICAgI0BpbnRlcnByZXRlci53YWl0Rm9yQWN0aW9uS2V5ID0geWVzCiAgICAgICAgICAgIEdhbWVNYW5hZ2VyLnBsYXllci5pc1BsYXllciA9IG5vCiAgICAgICAgICAgIAogICAgICAgICAgICBHYW1lTWFuYWdlci5jaG9pY2VXaW5kb3cgPSBuZXcgV2luZG93X0Nob2ljZShjaG9pY2VzKQogICAgICAgICAgICBHYW1lTWFuYWdlci5jaG9pY2VXaW5kb3cuZXZlbnQgPSBHYW1lTWFuYWdlci5tYXAuY3VycmVudEV2ZW50CiAgICAgICAgICAgIEdhbWVNYW5hZ2VyLmNob2ljZVdpbmRvdy5ldmVudC5pc0xvY2tlZCA9IHllcwogICAgICAgICAgICBHYW1lTWFuYWdlci5jaG9pY2VXaW5kb3cuZXhlY3V0aW9uQ29udGV4dCA9IEBpbnRlcnByZXRlci5jb250ZXh0CiAgICAgICAgICAgIEdhbWVNYW5hZ2VyLmNob2ljZVdpbmRvdy5vblNlbGVjdGlvbkFjY2VwdCA9IChzZW5kZXIsIGNob2ljZSkgPT4KICAgICAgICAgICAgICAgIEBpbnRlcnByZXRlci5jaG9pY2UgPSAiZ3MuQ2hvaWNlIiArIChjaG9pY2UuaW5kZXgrMSkKICAgICAgICAgICAgICAgIEBpbnRlcnByZXRlci5pc1dhaXRpbmcgPSBubwogICAgICAgICAgICAgICAgR2FtZU1hbmFnZXIucGxheWVyLmlzUGxheWVyID0geWVzCiAgICAgICAgICAgICAgICBpZiBub3QgQGludGVycHJldGVyLmlzTWVzc2FnZUNvbW1hbmQoQGludGVycHJldGVyLnBvaW50ZXIsIEBpbnRlcnByZXRlci5jb21tYW5kcykKICAgICAgICAgICAgICAgICAgICBHYW1lTWFuYWdlci5jaG9pY2VXaW5kb3cuZXZlbnQuaXNMb2NrZWQgPSBubwogICAgICAgICAgICAgICAgICAgIEdhbWVNYW5hZ2VyLm1lc3NhZ2VXaW5kb3cuY2xvc2UoKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBHYW1lTWFuYWdlci5jaG9pY2VXaW5kb3cuY2xvc2UoKQogICAgICAgICAgICBpZiBAcGFyYW1zLmNhbmNlbENhc2UgPiAwCiAgICAgICAgICAgICAgICBHYW1lTWFuYWdlci5jaG9pY2VXaW5kb3cub25DYW5jZWwgPSAoc2VuZGVyKSA9PgogICAgICAgICAgICAgICAgICAgIGlmIEBwYXJhbXMuY2FuY2VsQ2FzZSA9PSAxCiAgICAgICAgICAgICAgICAgICAgICAgIEBpbnRlcnByZXRlci5jaG9pY2UgPSAiZ3MuQ2hvaWNlQ2FuY2VsIgogICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgQGludGVycHJldGVyLmNob2ljZSA9ICJncy5DaG9pY2UiICsgKEBwYXJhbXMuY2FuY2VsQ2FzZS0xKQogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBAaW50ZXJwcmV0ZXIuaXNXYWl0aW5nID0gbm8KICAgICAgICAgICAgICAgICAgICBHYW1lTWFuYWdlci5wbGF5ZXIuaXNQbGF5ZXIgPSB5ZXMKICAgICAgICAgICAgICAgICAgICBpZiBub3QgQGludGVycHJldGVyLmlzTWVzc2FnZUNvbW1hbmQoQGludGVycHJldGVyLnBvaW50ZXIsIEBpbnRlcnByZXRlci5jb21tYW5kcykKICAgICAgICAgICAgICAgICAgICAgICAgR2FtZU1hbmFnZXIuY2hvaWNlV2luZG93LmV2ZW50LmlzTG9ja2VkID0gbm8KICAgICAgICAgICAgICAgICAgICAgICAgR2FtZU1hbmFnZXIubWVzc2FnZVdpbmRvdy5jbG9zZSgpCiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIEdhbWVNYW5hZ2VyLmNob2ljZVdpbmRvdy5jbG9zZSgpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgR2FtZU1hbmFnZXIuY2hvaWNlV2luZG93Lm9wZW4oKQogICAgICAgICAgICAKICAgIGNvbW1hbmRDaG9pY2U6IC0+CiAgICAgICAgaWYgQGludGVycHJldGVyLmNob2ljZSAhPSBAbm9kZUlkCiAgICAgICAgICAgIEBpbnRlcnByZXRlci5za2lwKEBpbmRlbnQpCiAgICAgICAgICAgIEBpbnRlcnByZXRlci5wb2ludGVyLS0KICAgICAgICAgICAgCiAgICBjb21tYW5kT3Blbk1lbnU6IC0+CiAgICAgICAgU2NlbmVNYW5hZ2VyLnN3aXRjaFRvKG5ldyBTY2VuZV9NYWluTWVudSgpKQogICAgY29tbWFuZE9wZW5TYXZlTWVudTogLT4KICAgICAgICAjIFRPRE86IEp1c3Qgc3dpdGNoIFNjZW5lX0xvYWRHYW1lIChjaGFuZ2UgdGhlIG5hbWUpCiAgICAgICAgCiAgICBjb21tYW5kUmV0dXJuVG9UaXRsZTogLT4KICAgICAgICBTY2VuZU1hbmFnZXIuc3dpdGNoVG8obmV3IFNjZW5lX1RpdGxlKCkpCiAgICAgICAgCiAgICBjb21tYW5kR2FtZU92ZXI6IC0+CiAgICAgICAgU2NlbmVNYW5hZ2VyLnN3aXRjaFRvKG5ldyBTY2VuZV9HYW1lT3ZlcigpKQogICAgICAgIAogICAgY29tbWFuZE9wZW5TaG9wOiAtPgogICAgICAgIHNob3AgPSBuZXcgU2NlbmVfU2hvcCgpCiAgICAgICAgaXRlbXMgPSBbXQogICAgICAgIHdlYXBvbnMgPSBbXQogICAgICAgIGFybW9ycyA9IFtdCiAgICAgICAgcmVjb3JkID0gbnVsbAogICAgICAgIAogICAgICAgIGZvciBpdGVtIGluIEBwYXJhbXMuaXRlbXMKICAgICAgICAgICAgc3dpdGNoIGl0ZW0udHlwZQogICAgICAgICAgICAgICAgd2hlbiAwCiAgICAgICAgICAgICAgICAgICAgcmVjb3JkID0gUmVjb3JkTWFuYWdlci5pdGVtc1tpdGVtLml0ZW1JZF0KICAgICAgICAgICAgICAgICAgICBpdGVtcy5wdXNoKHsgaXRlbTogcmVjb3JkLCBwcmljZTogaWYgaXRlbS5wcmljZVR5cGUgPT0gMCB0aGVuIHJlY29yZC5wcmljZSBlbHNlIGl0ZW0ucHJpY2UgfSkKICAgICAgICAgICAgICAgIHdoZW4gMQogICAgICAgICAgICAgICAgICAgIHJlY29yZCA9IFJlY29yZE1hbmFnZXIud2VhcG9uc1tpdGVtLndlYXBvbklkXQogICAgICAgICAgICAgICAgICAgIHdlYXBvbnMucHVzaCh7IGl0ZW06IHJlY29yZCwgcHJpY2U6IGlmIGl0ZW0ucHJpY2VUeXBlID09IDAgdGhlbiByZWNvcmQucHJpY2UgZWxzZSBpdGVtLnByaWNlIH0pCiAgICAgICAgICAgICAgICB3aGVuIDIKICAgICAgICAgICAgICAgICAgICByZWNvcmQgPSBSZWNvcmRNYW5hZ2VyLmFybW9yc1tpdGVtLmFybW9ySWRdCiAgICAgICAgICAgICAgICAgICAgYXJtb3JzLnB1c2goeyBpdGVtOiByZWNvcmQsIHByaWNlOiBpZiBpdGVtLnByaWNlVHlwZSA9PSAwIHRoZW4gcmVjb3JkLnByaWNlIGVsc2UgaXRlbS5wcmljZSB9KQogICAgICAgICAKICAgICAgICBzaG9wLml0ZW1zID0gaXRlbXMKICAgICAgICBzaG9wLndlYXBvbnMgPSB3ZWFwb25zCiAgICAgICAgc2hvcC5hcm1vcnMgPSBhcm1vcnMKICAgICAgICBzaG9wLm1vZGUgPSBAcGFyYW1zLm1vZGUKICAgICAgICAKICAgICAgICBTY2VuZU1hbmFnZXIuc3dpdGNoVG8oc2hvcCkKICAgICAgICAKICAgIGNvbW1hbmRDaGFuZ2VXaW5kb3dTa2luOiAtPgogICAgICAgIEdhbWVNYW5hZ2VyLndpbmRvd1NraW4gPSBSZXNvdXJjZU1hbmFnZXIuZ2V0Qml0bWFwKCJHcmFwaGljcy8je0BwYXJhbXMuZ3JhcGhpYy5uYW1lfSIpCiAgICAgICAgR2FtZU1hbmFnZXIud2luZG93U2tpblRvbmUuc2V0KEBwYXJhbXMudG9uZSkKICAgICAgICAKICAgIGNvbW1hbmRDaGFuZ2VBY3RvckdyYXBoaWM6IC0+CiAgICAgICAgYWN0b3IgPSBSZWNvcmRNYW5hZ2VyLmFjdG9yc1tAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLmFjdG9ySWQpXQogICAgICAgIG1lbWJlciA9IG51bGwKCiAgICAgICAgaWYgYWN0b3I/CiAgICAgICAgICAgIG1lbWJlciA9IEdhbWVNYW5hZ2VyLnBhcnR5Lm1lbWJlckJ5SWQoYWN0b3IuaW5kZXgpCiAgICAgICAgICAgIGlmIEBwYXJhbXMuY2hhbmdlQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICBhY3Rvci5jaGFyYWN0ZXJHcmFwaGljID0gQHBhcmFtcy5jaGFyYWN0ZXJHcmFwaGljCiAgICAgICAgICAgICAgICBhY3Rvci5jaGFyYWN0ZXJQYXR0ZXJuID0gQHBhcmFtcy5jaGFyYWN0ZXJQYXR0ZXJuCiAgICAgICAgICAgIGlmIEBwYXJhbXMuY2hhbmdlRmFjZQogICAgICAgICAgICAgICAgYWN0b3IuZmFjZUdyYXBoaWMgPSBAcGFyYW1zLmZhY2VHcmFwaGljCiAgICAgICAgICAgICAgICBhY3Rvci5mYWNlUGF0dGVybiA9IEBwYXJhbXMuZmFjZVBhdHRlcm4KICAgICAgICBpZiBtZW1iZXI/CiAgICAgICAgICAgIGlmIEBwYXJhbXMuY2hhbmdlQ2hhcmFjdGVyCiAgICAgICAgICAgICAgICBtZW1iZXIuY2hhcmFjdGVyR3JhcGhpYyA9IEBwYXJhbXMuY2hhcmFjdGVyR3JhcGhpYwogICAgICAgICAgICAgICAgbWVtYmVyLmNoYXJhY3RlclBhdHRlcm4gPSBAcGFyYW1zLmNoYXJhY3RlclBhdHRlcm4KICAgICAgICAgICAgaWYgQHBhcmFtcy5jaGFuZ2VGYWNlCiAgICAgICAgICAgICAgICBtZW1iZXIuZmFjZUdyYXBoaWMgPSBAcGFyYW1zLmZhY2VHcmFwaGljCiAgICAgICAgICAgICAgICBtZW1iZXIuZmFjZVBhdHRlcm4gPSBAcGFyYW1zLmZhY2VQYXR0ZXJuCiAgICAgICAgCiAgICBjb21tYW5kQ2hhbmdlUGFydHk6IC0+CiAgICAgICAgYWN0b3IgPSBSZWNvcmRNYW5hZ2VyLmFjdG9yc1tAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLmFjdG9ySWQpXQogICAgICAgIAogICAgICAgIGlmIGFjdG9yPwogICAgICAgICAgICBzd2l0Y2ggQHBhcmFtcy5vcGVyYXRpb24KICAgICAgICAgICAgICAgIHdoZW4gMCAjIEFkZAogICAgICAgICAgICAgICAgICAgIEdhbWVNYW5hZ2VyLnBhcnR5LmFkZChhY3RvcikKICAgICAgICAgICAgICAgIHdoZW4gMSAjIFJlbW92ZQogICAgICAgICAgICAgICAgICAgIEdhbWVNYW5hZ2VyLnBhcnR5LnJlbW92ZShhY3RvcikKICAgICAgICAgICAgICAgICAgICAKICAgIGNvbW1hbmRDaGFuZ2VNZW51QWNjZXNzOiAtPgogICAgICAgIEdhbWVNYW5hZ2VyLm1lbnVBY2Nlc3MgPSBAcGFyYW1zLmFjY2VzcwogICAgICAgIAogICAgY29tbWFuZENoYW5nZVNhdmVNZW51QWNjZXNzOiAtPgogICAgICAgIEdhbWVNYW5hZ2VyLnNhdmVNZW51QWNjZXNzID0gQHBhcmFtcy5hY2Nlc3MgPT0gMAogICAgICAgIAogICAgY2hhbmdlQWN0b3JQcm9wZXJ0eTogKHByb3BlcnR5LCBwYXJhbXMpIC0+CiAgICAgICAgYWN0b3IgPSBSZWNvcmRNYW5hZ2VyLmFjdG9yc1tAbnVtYmVyVmFsdWVPZihwYXJhbXMuYWN0b3JJZCldCiAgICAgICAgCiAgICAgICAgaWYgYWN0b3I/CiAgICAgICAgICAgIG1lbWJlciA9IEdhbWVNYW5hZ2VyLnBhcnR5Lm1lbWJlckJ5SWQoYWN0b3IuaW5kZXgpCiAgICAgICAgICAgIGlmIG1lbWJlcj8KICAgICAgICAgICAgICAgIHN3aXRjaCBwYXJhbXMub3BlcmF0aW9uCiAgICAgICAgICAgICAgICAgICAgd2hlbiAwICMgU2V0CiAgICAgICAgICAgICAgICAgICAgICAgIG1lbWJlcltwcm9wZXJ0eV0gPSBAbnVtYmVyVmFsdWVPZihwYXJhbXMudmFsdWUpCiAgICAgICAgICAgICAgICAgICAgd2hlbiAxICMgSW5jcmVhc2UKICAgICAgICAgICAgICAgICAgICAgICAgbWVtYmVyWyJjaGFuZ2UiICsgcHJvcGVydHkuY2FwaXRhbGl6ZSgpXShAbnVtYmVyVmFsdWVPZihwYXJhbXMudmFsdWUpKQogICAgICAgICAgICAgICAgICAgIHdoZW4gMiAjIERlY3JlYXNlCiAgICAgICAgICAgICAgICAgICAgICAgIG1lbWJlclsiY2hhbmdlIiArIHByb3BlcnR5LmNhcGl0YWxpemUoKV0oLShAbnVtYmVyVmFsdWVPZihwYXJhbXMudmFsdWUpKSkKICAgICAgICAgICAgICAgIGlmIHBhcmFtcy5hdm9pZERlYXRoIGFuZCBtZW1iZXIubHAgPT0gMAogICAgICAgICAgICAgICAgICAgIG1lbWJlci5scCA9IDEKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIG1lbWJlci5sZXZlbFVwKG1lbWJlci5sZXZlbCkgICAgICAgIAogICAgICAgICAgICAgICAgbWVtYmVyLnJlZnJlc2goKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBpZiBub3QgR2FtZU1hbmFnZXIucGFydHkuaXNBbGl2ZSgpCiAgICAgICAgICAgICAgICAgICAgU2NlbmVNYW5hZ2VyLnN3aXRjaFRvKG5ldyBTY2VuZV9HYW1lT3ZlcigpKQogICAgICAgICAgICAgICAgCiAgICBjb21tYW5kQ2hhbmdlQWN0b3JMcDogLT4gQGludGVycHJldGVyLmNoYW5nZUFjdG9yUHJvcGVydHkoImxwIiwgQHBhcmFtcykKICAgIGNvbW1hbmRDaGFuZ2VBY3Rvck1wOiAtPiBAaW50ZXJwcmV0ZXIuY2hhbmdlQWN0b3JQcm9wZXJ0eSgibXAiLCBAcGFyYW1zKQogICAgY29tbWFuZENoYW5nZUFjdG9yRXhwOiAtPiBAaW50ZXJwcmV0ZXIuY2hhbmdlQWN0b3JQcm9wZXJ0eSgiZXhwIiwgQHBhcmFtcykKICAgIAogICAgY29tbWFuZENoYW5nZUFjdG9yQ2xhc3M6IC0+CiAgICAgICAgYWN0b3IgPSBSZWNvcmRNYW5hZ2VyLmFjdG9yc1tAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLmFjdG9ySWQpXQogICAgICAgIGNsYXp6ID0gUmVjb3JkTWFuYWdlci5jbGFzc2VzW0BpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMuY2xhc3NJZCldCiAgICAgICAgCiAgICAgICAgaWYgYWN0b3I/IGFuZCBjbGF6ej8KICAgICAgICAgICAgYWN0b3IuY2xhc3MgPSBjbGF6egogICAgICAgICAgICBtZW1iZXIgPSBHYW1lTWFuYWdlci5wYXJ0eS5tZW1iZXJCeUlkKGFjdG9yLmluZGV4KQogICAgICAgICAgICBpZiBtZW1iZXI/IAogICAgICAgICAgICAgICAgbWVtYmVyLmNsYXNzID0gY2xhenoKICAgICAgICAgICAgICAgIG1lbWJlci5yZWZyZXNoKCkKICAgICAgICAgICAgCiAgICBjb21tYW5kQ2hhbmdlQWN0b3JOYW1lOiAtPgogICAgICAgIGFjdG9yID0gUmVjb3JkTWFuYWdlci5hY3RvcnNbQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy5hY3RvcklkKV0gIAogICAgICAgIAogICAgICAgIGlmIGFjdG9yPyAKICAgICAgICAgICAgYWN0b3IubmFtZSA9IEBpbnRlcnByZXRlci5zdHJpbmdWYWx1ZU9mKEBwYXJhbXMubmFtZSkKICAgICAgICAgICAgbWVtYmVyID0gR2FtZU1hbmFnZXIucGFydHkubWVtYmVyQnlJZChhY3Rvci5pbmRleCkKICAgICAgICAgICAgaWYgbWVtYmVyPyB0aGVuIG1lbWJlci5uYW1lID0gYWN0b3IubmFtZQogICAgICAgICAgICAKICAgIGNvbW1hbmRDaGFuZ2VBY3RvckxldmVsOiAtPiBAaW50ZXJwcmV0ZXIuY2hhbmdlQWN0b3JQcm9wZXJ0eSgibGV2ZWwiLCBAcGFyYW1zKSAgCiAgICAKICAgIGNvbW1hbmRDaGFuZ2VBY3RvclN0YXRlOiAtPgogICAgICAgIGFjdG9yID0gUmVjb3JkTWFuYWdlci5hY3RvcnNbQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy5hY3RvcklkKV0gIAogICAgICAgIHN0YXRlID0gUmVjb3JkTWFuYWdlci5zdGF0ZXNbQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy5zdGF0ZUlkKV0gIAogICAgICAgIAogICAgICAgIGlmIGFjdG9yPyBhbmQgc3RhdGU/ICAKICAgICAgICAgICAgbWVtYmVyID0gR2FtZU1hbmFnZXIucGFydHkubWVtYmVyQnlJZChhY3Rvci5pbmRleCkKICAgICAgICAgICAgaWYgbWVtYmVyPwogICAgICAgICAgICAgICAgc3dpdGNoIHAub3BlcmF0aW9uCiAgICAgICAgICAgICAgICAgICAgd2hlbiAwICMgQWRkCiAgICAgICAgICAgICAgICAgICAgICAgIG1lbWJlci5hZGRTdGF0ZShzdGF0ZSkKICAgICAgICAgICAgICAgICAgICB3aGVuIDEgIyBSZW1vdmUKICAgICAgICAgICAgICAgICAgICAgICAgbWVtYmVyLnJlbW92ZVN0YXRlKHN0YXRlKQogICAgICAgICAgICAgICAgICAgICAgICAKICAgIGNvbW1hbmRDaGFuZ2VBY3RvclNraWxsczogLT4KICAgICAgICBhY3RvciA9IFJlY29yZE1hbmFnZXIuYWN0b3JzW0BpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMuYWN0b3JJZCldICAKICAgICAgICBza2lsbCA9IFJlY29yZE1hbmFnZXIuc2tpbGxzW0BpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMuc2tpbGxJZCldICAKICAgICAgICAKICAgICAgICBpZiBhY3Rvcj8gYW5kIHNraWxsPyAgCiAgICAgICAgICAgIG1lbWJlciA9IEdhbWVNYW5hZ2VyLnBhcnR5Lm1lbWJlckJ5SWQoYWN0b3IuaW5kZXgpCiAgICAgICAgICAgIGlmIG1lbWJlcj8KICAgICAgICAgICAgICAgIHN3aXRjaCBAcGFyYW1zLm9wZXJhdGlvbgogICAgICAgICAgICAgICAgICAgIHdoZW4gMCAjIEFkZAogICAgICAgICAgICAgICAgICAgICAgICBtZW1iZXIuYWRkU2tpbGwoc2tpbGwpCiAgICAgICAgICAgICAgICAgICAgd2hlbiAxICMgUmVtb3ZlCiAgICAgICAgICAgICAgICAgICAgICAgIG1lbWJlci5yZW1vdmVTa2lsbChza2lsbCkKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICBjb21tYW5kQ2hhbmdlQWN0b3JFcXVpcG1lbnQ6IC0+CiAgICAgICAgYWN0b3IgPSBSZWNvcmRNYW5hZ2VyLmFjdG9yc1tAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLmFjdG9ySWQpXSAgICAgCiAgICAgICAgCiAgICAgICAgaWYgYWN0b3I/ICAKICAgICAgICAgICAgbWVtYmVyID0gR2FtZU1hbmFnZXIucGFydHkubWVtYmVyQnlJZChhY3Rvci5pbmRleCkKICAgICAgICAgICAgaWYgbWVtYmVyPwogICAgICAgICAgICAgICAgc3dpdGNoIEBwYXJhbXMuZXF1aXBUeXBlCiAgICAgICAgICAgICAgICAgICAgd2hlbiAwICMgV2VhcG9uCiAgICAgICAgICAgICAgICAgICAgICAgIGlkID0gQHBhcmFtcy53ZWFwb25JZAogICAgICAgICAgICAgICAgICAgICAgICBpZiBpZD8gdGhlbiBpZCA9IEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMud2VhcG9uSWQpCiAgICAgICAgICAgICAgICAgICAgICAgIG1lbWJlci53ZWFwb24gPSBSZWNvcmRNYW5hZ2VyLndlYXBvbnNbaWRdCiAgICAgICAgICAgICAgICAgICAgd2hlbiAxICMgU2hpZWxkCiAgICAgICAgICAgICAgICAgICAgICAgIGlkID0gQHBhcmFtcy5zaGllbGRJZAogICAgICAgICAgICAgICAgICAgICAgICBpZiBpZD8gdGhlbiBpZCA9IEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMuc2hpZWxkSWQpCiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICBtZW1iZXIuc2hpZWxkID0gUmVjb3JkTWFuYWdlci5hcm1vcnNbaWRdCiAgICAgICAgICAgICAgICAgICAgd2hlbiAyICMgSGVhZCBBcm1vcgogICAgICAgICAgICAgICAgICAgICAgICBpZCA9IEBwYXJhbXMuaGVhZEFybW9ySWQKICAgICAgICAgICAgICAgICAgICAgICAgaWYgaWQ/IHRoZW4gaWQgPSBAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLmhlYWRBcm1vcklkKQogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgbWVtYmVyLmhlYWQgPSBSZWNvcmRNYW5hZ2VyLmFybW9yc1tpZF0KICAgICAgICAgICAgICAgICAgICB3aGVuIDMgIyBCb2R5IEFybW9yCiAgICAgICAgICAgICAgICAgICAgICAgIGlkID0gQHBhcmFtcy5ib2R5QXJtb3JJZAogICAgICAgICAgICAgICAgICAgICAgICBpZiBpZD8gdGhlbiBpZCA9IEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMuYm9keUFybW9ySWQpCiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICBtZW1iZXIuYm9keSA9IFJlY29yZE1hbmFnZXIuYXJtb3JzW2lkXQogICAgICAgICAgICAgICAgICAgIHdoZW4gNCAjIEFjY2Vzc29yeQogICAgICAgICAgICAgICAgICAgICAgICBpZCA9IEBwYXJhbXMuYWNjZXNzb3J5SWQKICAgICAgICAgICAgICAgICAgICAgICAgaWYgaWQ/IHRoZW4gaWQgPSBAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLmFjY2Vzc29yeUlkKQogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgbWVtYmVyLmFjY2Vzc29yeSA9IFJlY29yZE1hbmFnZXIuYXJtb3JzW2lkXQogICAgICAgICAgICAgICAgbWVtYmVyLnJlZnJlc2goKSAgIAogICAgICAgICAgICAgICAgCiAgICBjb21tYW5kQ2hhbmdlQWN0b3JQYXJhbWV0ZXJzOiAtPgogICAgICAgIGFjdG9yID0gUmVjb3JkTWFuYWdlci5hY3RvcnNbQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy5hY3RvcklkKV0gICAgIAogICAgICAgIHBhcmFtID0gTWF0aC5taW4oTWF0aC5tYXgoQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy5wYXJhbWV0ZXIpLCAwKSwgNykKICAgICAgICBpZiBhY3Rvcj8gIAogICAgICAgICAgICBtZW1iZXIgPSBHYW1lTWFuYWdlci5wYXJ0eS5tZW1iZXJCeUlkKGFjdG9yLmluZGV4KQogICAgICAgICAgICBpZiBtZW1iZXI/IAogICAgICAgICAgICAgICAgc3dpdGNoIHAub3BlcmF0aW9uCiAgICAgICAgICAgICAgICAgICAgd2hlbiAwIHRoZW4gbWVtYmVyLnNldEJhc2VQYXJhbWV0ZXIocGFyYW0sIEBwYXJhbXMudmFsdWUpCiAgICAgICAgICAgICAgICAgICAgCiAgICBjb21tYW5kUGxheU11c2ljOiAtPgogICAgICAgIEF1ZGlvTWFuYWdlci5wbGF5TXVzaWMoQHBhcmFtcy5tdXNpYy5uYW1lLCBAcGFyYW1zLm11c2ljLnZvbHVtZSwgQHBhcmFtcy5tdXNpYy5wbGF5YmFja1JhdGUsIEBwYXJhbXMuZmFkZUluRHVyYXRpb24pCiAgICAKICAgIGNvbW1hbmRTdG9wTXVzaWM6IC0+IAogICAgICAgIEF1ZGlvTWFuYWdlci5zdG9wTXVzaWMoQHBhcmFtcy5mYWRlT3V0RHVyYXRpb24pCiAgICAKICAgIGNvbW1hbmRQYXVzZU11c2ljOiAtPgogICAgICAgIEF1ZGlvTWFuYWdlci5zdG9wTXVzaWMoQHBhcmFtcy5mYWRlT3V0RHVyYXRpb24pCiAgICAKICAgIGNvbW1hbmRSZXN1bWVNdXNpYzogLT4gCiAgICAgICAgQXVkaW9NYW5hZ2VyLnJlc3VtZU11c2ljKEBwYXJhbXMuZmFkZUluRHVyYXRpb24pCiAgICAgICAgCiAgICBjb21tYW5kUGxheVNvdW5kOiAtPgogICAgICAgIEF1ZGlvTWFuYWdlci5wbGF5U291bmQoQHBhcmFtcy5zb3VuZC5uYW1lLCBAcGFyYW1zLnNvdW5kLnZvbHVtZSwgQHBhcmFtcy5zb3VuZC5wbGF5YmFja1JhdGUsIEBwYXJhbXMubXVzaWNFZmZlY3QpCiAgICAKICAgIGNvbW1hbmRQbGF5QmFja2dyb3VuZFNvdW5kOiAtPgogICAgICAgIEF1ZGlvTWFuYWdlci5wbGF5QmFja2dyb3VuZFNvdW5kKEBwYXJhbXMubXVzaWMubmFtZSwgQHBhcmFtcy5tdXNpYy52b2x1bWUsIEBwYXJhbXMubXVzaWMucGxheWJhY2tSYXRlLCBAcGFyYW1zLmZhZGVJbkR1cmF0aW9uKQogICAgCiAgICBjb21tYW5kU3RvcEJhY2tncm91bmRTb3VuZDogLT4gCiAgICAgICAgQXVkaW9NYW5hZ2VyLnN0b3BCYWNrZ3JvdW5kU291bmQoQHBhcmFtcy5mYWRlT3V0RHVyYXRpb24pCiAgICAgICAgCiAgICBjb21tYW5kUGF1c2VCYWNrZ3JvdW5kU291bmQ6IC0+IAogICAgICAgIEF1ZGlvTWFuYWdlci5wYXVzZUJhY2tncm91bmRTb3VuZCgpCiAgICAgICAgCiAgICBjb21tYW5kUmVzdW1lQmFja2dyb3VuZFNvdW5kOiAtPiAKICAgICAgICBBdWRpb01hbmFnZXIucmVzdW1lQmFja2dyb3VuZFNvdW5kKCkKICAgICAgICAKICAgIGNvbW1hbmRDaGFuZ2VNYXBFbmNvdW50ZXI6IC0+IEdhbWVNYW5hZ2VyLm1hcEVuY291bnRlciA9IEBwYXJhbXMuYWNjZXNzID09IDAKICAgIGNvbW1hbmRDaGFuZ2VNYXBUaWxlc2V0OiAtPgogICAgICAgIGlmIEdhbWVNYW5hZ2VyLm1hcD8KICAgICAgICAgICAgdGlsZXNldCA9IFJlY29yZE1hbmFnZXIudGlsZXNldHNbQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy50aWxlc2V0SWQpXQogICAgICAgICAgICBpZiB0aWxlc2V0PwogICAgICAgICAgICAgICAgR2FtZU1hbmFnZXIubWFwLnRpbGVzZXQgPSBSZWNvcmRNYW5hZ2VyLnRpbGVzZXRzW0BpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMudGlsZXNldElkKV0KICAgICAgICAgICAgICAgIEdhbWVNYW5hZ2VyLm1hcC5hdXRvdGlsZXMgPSBHYW1lTWFuYWdlci5tYXAudGlsZXNldC5hdXRvdGlsZUdyYXBoaWNzCiAgICBjb21tYW5kQ2hhbmdlTWFwVGlsZXM6IC0+CiAgICAgICAgbWFwID0gR2FtZU1hbmFnZXIubWFwCiAgICAgICAgaWYgbWFwPwogICAgICAgICAgICB0aWxlc2V0ID0gbWFwLnRpbGVzZXQKICAgICAgICAgICAgdGlsZSA9IEBwYXJhbXMuc291cmNlVGlsZSArIDM4NAogICAgICAgICAgICBsYXllciA9IEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMubGF5ZXIpCiAgICAgICAgICAgIHN3aXRjaCBAcGFyYW1zLnR5cGUKICAgICAgICAgICAgICAgIHdoZW4gMCAjIEJ5IFRpbGUKICAgICAgICAgICAgICAgICAgICBtYXAuc2V0VGlsZShAcGFyYW1zLnRhcmdldFRpbGUgKyAzODQsIEBwYXJhbXMuc291cmNlVGlsZSArIDM4NCwgbGF5ZXIpCiAgICAgICAgICAgICAgICB3aGVuIDEgIyBEaXJlY3QgTG9jYXRpb24KICAgICAgICAgICAgICAgICAgICBtYXAuc2V0VGlsZShAcGFyYW1zLmRpcmVjdExvY2F0aW9uLmxvY2F0aW9uLngsIEBwYXJhbXMuZGlyZWN0TG9jYXRpb24ubG9jYXRpb24ueSwgbGF5ZXIsIHRpbGUpCiAgICAgICAgICAgICAgICB3aGVuIDIgIyBDYWxjdWxhdGVkIExvY2F0aW9uCiAgICAgICAgICAgICAgICAgICAgbWFwLnNldFRpbGUoQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy5sb2NhdGlvbi54KSwgQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy5sb2NhdGlvbi55KSwgbGF5ZXIsIHRpbGUpICAgICAgICAgICAgCiAgICAgICAgICAgIAogICAgY29tbWFuZENoYW5nZU1hcFBhcmFsbGF4QmFja2dyb3VuZDogLT4KICAgICAgICBtYXAgPSBHYW1lTWFuYWdlci5tYXAKCiAgICAgICAgaWYgbWFwPwogICAgICAgICAgICBtYXAucGFyYWxsYXhCYWNrZ3JvdW5kID0gQHBhcmFtcy5ncmFwaGljCiAgICAgICAgICAgIG1hcC5sb29wUGFyYWxsYXhWZXJ0aWNhbCA9IEBwYXJhbXMubG9vcFBhcmFsbGF4VmVydGljYWwKICAgICAgICAgICAgbWFwLmxvb3BQYXJhbGxheEhvcml6b250YWwgPSBAcGFyYW1zLmxvb3BQYXJhbGxheEhvcml6b250YWwKICAgICAgICAgICAgbWFwLnZlcnRpY2FsUGFyYWxsYXhTY3JvbGwgPSBAcGFyYW1zLnZlcnRpY2FsUGFyYWxsYXhTY3JvbGwKICAgICAgICAgICAgbWFwLmhvcml6b250YWxQYXJhbGxheFNjcm9sbCA9IEBwYXJhbXMuaG9yaXpvbnRhbFBhcmFsbGF4U2Nyb2xsCiAgICAgICAgICAgIAogICAgICAgICAgICAKICAgIGNvbW1hbmRHZXRNYXBMb2NhdGlvbkluZm86IC0+CiAgICAgICAgbWFwID0gR2FtZU1hbmFnZXIubWFwCiAgICAgICAgaW5mbyA9IG51bGwKICAgICAgICBpZiBtYXA/CiAgICAgICAgICAgIHR5cGUgPSBAcGFyYW1zLmxvY2F0aW9uVHlwZQogICAgICAgICAgICAKICAgICAgICAgICAgc3dpdGNoIHR5cGUKICAgICAgICAgICAgICAgIHdoZW4gMCAjIERpcmVjdCBMb2NhdGlvbgogICAgICAgICAgICAgICAgICAgIHggPSBAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLmRpcmVjdExvY2F0aW9uLmxvY2F0aW9uLngpCiAgICAgICAgICAgICAgICAgICAgeSA9IEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMuZGlyZWN0TG9jYXRpb24ubG9jYXRpb24ueSkKICAgICAgICAgICAgICAgIHdoZW4gMSAjIENhbGN1bGF0ZWQgTG9jYXRpb24KICAgICAgICAgICAgICAgICAgICB4ID0gQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy5sb2NhdGlvbi54KQogICAgICAgICAgICAgICAgICAgIHkgPSBAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLmxvY2F0aW9uLnkpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgIGluZm8gPSBtYXAubG9jYXRpb25EYXRhKHgsIHksIEBwYXJhbXMubG9jYXRpb25JbmZvKQogICAgICAgICAgICBAaW50ZXJwcmV0ZXIuc2V0TnVtYmVyVmFsdWVUbyhAcGFyYW1zLnZhcmlhYmxlLCBpbmZvKQogICAgICAgICAgICAKICAgICAgICAgICAgCiAgICBjb21tYW5kU3RhcnRCYXR0bGU6IC0+CiAgICAgICAgR2FtZU1hbmFnZXIudHJvb3AgPSBSZWNvcmRNYW5hZ2VyLnRyb29wc1tAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLnRyb29wSWQpXQogICAgICAgIHNjZW5lID0gbmV3IFNjZW5lX0JhdHRsZSgpCiAgICAgICAgc2NlbmUubm9Fc2NhcGUgPSBAcGFyYW1zLm5vRXNjYXBlCiAgICAgICAgc2NlbmUuY29udGludWVPbkxvc2UgPSBAcGFyYW1zLmNvbnRpbnVlT25Mb3NlCiAgICAgICAgU2NlbmVNYW5hZ2VyLnN3aXRjaFRvKHNjZW5lKQogICAgICAgIAogICAgCiAgICBjaGFuZ2VFbmVteVByb3BlcnR5OiAocHJvcGVydHksIHBhcmFtcykgLT4KICAgICAgICBpZiBHYW1lTWFuYWdlci5pbkJhdHRsZQogICAgICAgICAgICBzY2VuZSA9IFNjZW5lTWFuYWdlci5zY2VuZQogICAgICAgICAgICBpbmRleCA9IEBudW1iZXJWYWx1ZU9mKHBhcmFtcy5lbmVteUlkKQogICAgICAgICAgICAKICAgICAgICAgICAgaWYgaW5kZXggPj0gMCBhbmQgaW5kZXggPCBzY2VuZS5lbmVtaWVzLmxlbmd0aAogICAgICAgICAgICAgICAgc3dpdGNoIHBhcmFtcy5vcGVyYXRpb24KICAgICAgICAgICAgICAgICAgICB3aGVuIDAgIyBTZXQKICAgICAgICAgICAgICAgICAgICAgICAgc2NlbmUuZW5lbWllc1tpbmRleF1bcHJvcGVydHldID0gQG51bWJlclZhbHVlT2YocGFyYW1zLnZhbHVlKQogICAgICAgICAgICAgICAgICAgIHdoZW4gMSAjIEluY3JlYXNlCiAgICAgICAgICAgICAgICAgICAgICAgIHNjZW5lLmVuZW1pZXNbaW5kZXhdWyJjaGFuZ2UiICsgcHJvcGVydHkuY2FwaXRhbGl6ZSgpXShAbnVtYmVyVmFsdWVPZihwYXJhbXMudmFsdWUpKQogICAgICAgICAgICAgICAgICAgIHdoZW4gMiAjIERlY3JlYXNlCiAgICAgICAgICAgICAgICAgICAgICAgIHNjZW5lLmVuZW1pZXNbaW5kZXhdWyJjaGFuZ2UiICsgcHJvcGVydHkuY2FwaXRhbGl6ZSgpXSgtKEBudW1iZXJWYWx1ZU9mKHBhcmFtcy52YWx1ZSkpKQogICAgICAgICAgICAgICAKICAgICAgICAgICAgCiAgICBjb21tYW5kQ2hhbmdlRW5lbXlMcDogLT4gQGludGVycHJldGVyLmNoYW5nZUVuZW15UHJvcGVydHkoImxwIiwgQHBhcmFtcykKICAgIGNvbW1hbmRDaGFuZ2VFbmVteU1wOiAtPiBAaW50ZXJwcmV0ZXIuY2hhbmdlRW5lbXlQcm9wZXJ0eSgibXAiLCBAcGFyYW1zKQogICAgY29tbWFuZENoYW5nZUVuZW15U3RhdGU6IC0+CiAgICAgICAgaWYgR2FtZU1hbmFnZXIuaW5CYXR0bGUKICAgICAgICAgICAgc2NlbmUgPSBTY2VuZU1hbmFnZXIuc2NlbmUKICAgICAgICAgICAgaW5kZXggPSBAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLmVuZW15SWQpCiAgICAgICAgICAgIAogICAgICAgICAgICBpZiBpbmRleCA+PSAwIGFuZCBpbmRleCA8IHNjZW5lLmVuZW1pZXMubGVuZ3RoCiAgICAgICAgICAgICAgICBlbmVteSA9IHNjZW5lLmVuZW1pZXNbaW5kZXhdICAKICAgICAgICAgICAgICAgIHN0YXRlID0gUmVjb3JkTWFuYWdlci5zdGF0ZXNbQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy5zdGF0ZUlkKV0gIAogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBpZiBlbmVteT8gYW5kIHN0YXRlPyAgCiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIHAub3BlcmF0aW9uCiAgICAgICAgICAgICAgICAgICAgICAgIHdoZW4gMCAjIEFkZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5lbXkuYWRkU3RhdGUoc3RhdGUpCiAgICAgICAgICAgICAgICAgICAgICAgIHdoZW4gMSAjIFJlbW92ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5lbXkucmVtb3ZlU3RhdGUoc3RhdGUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgIGNvbW1hbmRTaG93RW5lbXk6IC0+CiAgICAgICAgaWYgR2FtZU1hbmFnZXIuaW5CYXR0bGUKICAgICAgICAgICAgc2NlbmUgPSBTY2VuZU1hbmFnZXIuc2NlbmUKICAgICAgICAgICAgaW5kZXggPSBAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLmVuZW15SWQpCiAgICAgICAgICAgIAogICAgICAgICAgICBpZiBpbmRleCA+PSAwIGFuZCBpbmRleCA8IHNjZW5lLmVuZW1pZXMubGVuZ3RoCiAgICAgICAgICAgICAgICBlbmVteSA9IHNjZW5lLmVuZW1pZXNbaW5kZXhdCiAgICAgICAgICAgICAgICBpZiBlbmVteS5hY3Rvci5pc0FsaXZlIGFuZCBlbmVteS5pc0hpZGRlbgogICAgICAgICAgICAgICAgICAgIGVuZW15LmlzSGlkZGVuID0gbm8KICAgICAgICAgICAgICAgIAogICAgICAgIAogICAgY29tbWFuZFRyYW5zZm9ybUVuZW15OiAtPgogICAgICAgIHNjZW5lID0gU2NlbmVNYW5hZ2VyLnNjZW5lCiAgICAgICAgaWYgc2NlbmUgaW5zdGFuY2VvZiBTY2VuZV9CYXR0bGUKICAgICAgICAgICAgaW5kZXggPSBAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLmVuZW15SWQpCiAgICAgICAgICAgIHRhcmdldCA9IFJlY29yZE1hbmFnZXIuZW5lbWllc1tAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLnRhcmdldElkKV0KICAgICAgICAgICAgc2NlbmUudHJhbnNmb3JtRW5lbXkoaW5kZXgsIHRhcmdldCkKCiAgICAgICAgICAgICAgICAKICAgIAogICAgICAgIAogICAgY29tbWFuZEFib3J0QmF0dGxlOiAtPiAKICAgICAgICBTY2VuZU1hbmFnZXIuc3dpdGNoVG8obmV3IFNjZW5lX01hcCgpKQogICAgICAgIAogICAgY29tbWFuZFNjcm9sbE1hcDogLT4KICAgICAgICBzdGVwc1ggPSBAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLnN0ZXBzWCkKICAgICAgICBzdGVwc1kgPSBAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLnN0ZXBzWSkKICAgICAgICBkdXJhdGlvbiA9IEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMuZHVyYXRpb24pCiAgICAgICAgCiAgICAgICAgR2FtZU1hbmFnZXIuc2NyZWVuLnNjcm9sbChzdGVwc1gsIHN0ZXBzWSwgZHVyYXRpb24pCiAgICAgICAgCiAgICBzZXRFdmVudExvY2F0aW9uOiAoZXZlbnQsIHBhcmFtcykgLT4KICAgICAgICBpZiBldmVudD8KICAgICAgICAgICAgeCA9IEBudW1iZXJWYWx1ZU9mKHBhcmFtcy54KQogICAgICAgICAgICB5ID0gQG51bWJlclZhbHVlT2YocGFyYW1zLnkpCiAgICAgICAgICAgIGV2ZW50LnNldFRpbGVMb2NhdGlvbih4LCB5KQogICAgICAgICAgICBpZiBwYXJhbXMuY2hhbmdlRGlyZWN0aW9uCiAgICAgICAgICAgICAgICBldmVudC5kaXJlY3Rpb24gPSBAbnVtYmVyVmFsdWVPZihwYXJhbXMuZGlyZWN0aW9uKQogICAgICAgICAgICBpZiBldmVudCA9PSBHYW1lTWFuYWdlci5wbGF5ZXIKICAgICAgICAgICAgICAgIEdhbWVNYW5hZ2VyLnNjcmVlbi5jZW50ZXJPbihldmVudC54LCBldmVudC55KQogICAgICAgICAgICAgICAgCiAgICBjb21tYW5kU2V0RXZlbnRMb2NhdGlvbjogLT4KICAgICAgICBldmVudElkID0gQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy5ldmVudElkKQogICAgICAgIGV2ZW50ID0gQGludGVycHJldGVyLmV2ZW50QnlJZChldmVudElkKQogICAgICAgIEBpbnRlcnByZXRlci5zZXRFdmVudExvY2F0aW9uKGV2ZW50LCBAcGFyYW1zKQogICAgICAgIAogICAgY29tbWFuZFNldEdsb2JhbEV2ZW50TG9jYXRpb246IC0+CiAgICAgICAgZXZlbnRJZCA9IEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMuZXZlbnRJZCkKICAgICAgICBldmVudCA9IEBpbnRlcnByZXRlci5nbG9iYWxFdmVudEJ5SWQoZXZlbnRJZCkKICAgICAgICBAaW50ZXJwcmV0ZXIuc2V0RXZlbnRMb2NhdGlvbihldmVudCwgQHBhcmFtcykKICAgICAgICAKICAgIGNvbW1hbmRDcmVhdGVFdmVudDogLT4KICAgICAgICB4ID0gaWYgQHBhcmFtcy5sb2NhdGlvblR5cGUgPT0gMCB0aGVuIEBwYXJhbXMuZGlyZWN0TG9jYXRpb24ubG9jYXRpb24ueCBlbHNlIEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMubG9jYXRpb24ueCkKICAgICAgICB5ID0gaWYgQHBhcmFtcy5sb2NhdGlvblR5cGUgPT0gMCB0aGVuIEBwYXJhbXMuZGlyZWN0TG9jYXRpb24ubG9jYXRpb24ueSBlbHNlIEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMubG9jYXRpb24ueSkKICAgICAgICB1aWQgPSBpZiBAcGFyYW1zLmxvY2F0aW9uVHlwZSA9PSAwIHRoZW4gQHBhcmFtcy5kaXJlY3RMb2NhdGlvbi5tYXAudWlkIGVsc2UgQGludGVycHJldGVyLnN0cmluZ1ZhbHVlT2YoQHBhcmFtcy5tYXAudWlkKQogICAgICAgIHRlbXBsYXRlSWQgPSBAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLmV2ZW50VGVtcGxhdGVJZCkKICAgICAgICBwYXJhbWV0ZXJzID0gQHBhcmFtcy5wYXJhbWV0ZXJzCiAgICAgICAgcGVybWFuZW50bHkgPSBAcGFyYW1zLnBlcm1hbmVudGx5CiAgICAgICAgaWYgdWlkID09ICIiIHRoZW4gdWlkID0gR2FtZU1hbmFnZXIubWFwLmlkCiAgIAogICAgICAgIAogICAgICAgIGRhdGEgPSBHYW1lTWFuYWdlci5hZGRFdmVudENyZWF0aW9uKHVpZCwgeCwgeSwgdGVtcGxhdGVJZCwgcGFyYW1ldGVycywgcGVybWFuZW50bHkpCiAgICAgICAgCiAgICAgICAgaWYgR2FtZU1hbmFnZXIubWFwLmlkID09IHVpZAogICAgICAgICAgICBHYW1lTWFuYWdlci5tYXAuYWRkRXZlbnRGcm9tRGF0YSh7IGlkOiBkYXRhLmlkLCB4OiB4LCB5OiB5LCB0ZW1wbGF0ZUlkOiB0ZW1wbGF0ZUlkLCBwYXJhbWV0ZXJzOiBwYXJhbWV0ZXJzIH0pCiAgICBjb21tYW5kRXJhc2VFdmVudDogLT4KICAgICAgICBldmVudElkID0gQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy5ldmVudElkKQogICAgICAgIGV2ZW50ID0gbnVsbAogICAgICAgIAogICAgICAgICMgSWYgdGhpcyBldmVudAogICAgICAgIGlmIGV2ZW50SWQgPT0gLTEKICAgICAgICAgICAgZXZlbnQgPSBHYW1lTWFuYWdlci5tYXAuY3VycmVudEV2ZW50CiAgICAgICAgZWxzZQogICAgICAgICAgICBldmVudCA9IEdhbWVNYW5hZ2VyLm1hcC5ldmVudHNCeUlkW2V2ZW50SWRdIAogICAgICAgICAgICAKICAgICAgICBpZiBldmVudD8gdGhlbiBldmVudC5lcmFzZSgpCiAgICAgICAgCiAgICAgICAgaWYgQHBhcmFtcy5wZXJtYW5lbnRseQogICAgICAgICAgICBHYW1lTWFuYWdlci5hZGRFdmVudERlbGV0aW9uKEdhbWVNYW5hZ2VyLm1hcC5pZCwgZXZlbnQuaWQpCiAgICAgICAgCiAgICBjb21tYW5kTW92ZUdsb2JhbEV2ZW50OiAtPgogICAgICAgIGlkID0gQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy5ldmVudCkKICAgICAgICBldmVudCA9IEBpbnRlcnByZXRlci5nbG9iYWxFdmVudEJ5SWQoaWQpCiAgICAgICAgICAgIAogICAgICAgIGlmIGV2ZW50PwogICAgICAgICAgICBldmVudC5tb3ZlUm91dGUoQHBhcmFtcykKICAgICAgICAgICAgaWYgQHBhcmFtcy53YWl0Rm9yQ29tcGxldGlvbgogICAgICAgICAgICAgICAgZXZlbnQub25Sb3V0ZUZpbmlzaCA9ID0+IAogICAgICAgICAgICAgICAgICAgIEBpbnRlcnByZXRlci5pc1dhaXRpbmcgPSBubwogICAgICAgICAgICAgICAgICAgIGV2ZW50Lm9uUm91dGVGaW5pc2ggPSBudWxsCiAgICAgICAgICAgICAgICAgICAgZXZlbnQubW92ZVJvdXRlKGV2ZW50LmF1dG9Nb3ZlbWVudFJvdXRlKQogICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIEBpbnRlcnByZXRlci5pc1dhaXRpbmcgPSB5ZXMKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgZXZlbnQub25Sb3V0ZUZpbmlzaCA9ID0+IAogICAgICAgICAgICAgICAgICAgIGV2ZW50Lm9uUm91dGVGaW5pc2ggPSBudWxsCiAgICAgICAgICAgICAgICAgICAgZXZlbnQubW92ZVJvdXRlKGV2ZW50LmF1dG9Nb3ZlbWVudFJvdXRlKQogICAgICAgICAgICAgICAgICAgIAogICAgY29tbWFuZEVyYXNlR2xvYmFsRXZlbnQ6IC0+CiAgICAgICAgZXZlbnRJZCA9IEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMuZXZlbnRJZCkKICAgICAgICBldmVudCA9IEBpbnRlcnByZXRlci5nbG9iYWxFdmVudEJ5SWQoZXZlbnRJZCkKICAgICAgICAKICAgICAgICBpZiBldmVudD8gdGhlbiBldmVudC5lcmFzZSgpCiAgICAKICAgIGNvbW1hbmRFbmRHbG9iYWxFdmVudDogLT4KICAgICAgICBldmVudElkID0gQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy5ldmVudElkKQogICAgICAgIGV2ZW50ID0gQGludGVycHJldGVyLmdsb2JhbEV2ZW50QnlJZChldmVudElkKQogICAgICAgIAogICAgICAgIGlmIGV2ZW50PyB0aGVuIGV2ZW50LnN0b3AoKQogICAgICAgIAogICAgY29tbWFuZEVuZEV2ZW50OiAtPgogICAgICAgIGV2ZW50SWQgPSBAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLmV2ZW50SWQpCiAgICAgICAgZXZlbnQgPSBudWxsCiAgICAgICAgCiAgICAgICAgIyBJZiB0aGlzIGV2ZW50CiAgICAgICAgaWYgZXZlbnRJZCA9PSAtMQogICAgICAgICAgICBldmVudCA9IEdhbWVNYW5hZ2VyLm1hcC5jdXJyZW50RXZlbnQKICAgICAgICBlbHNlCiAgICAgICAgICAgIGV2ZW50ID0gR2FtZU1hbmFnZXIubWFwLmV2ZW50c0J5SWRbZXZlbnRJZF0gCiAgICAgICAgICAgIAogICAgICAgIGlmIGV2ZW50PyB0aGVuIGV2ZW50LnN0b3AoKQogICAgICAgIAogICAgY29tbWFuZENhbGxDb21tb25FdmVudDogLT4KICAgICAgICBldmVudElkID0gQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy5ldmVudElkKQogICAgICAgIGNvbW1vbkV2ZW50ID0gR2FtZU1hbmFnZXIuY29tbW9uRXZlbnRzW2V2ZW50SWRdCiAgICAgICAgCiAgICAgICAgaWYgY29tbW9uRXZlbnQ/CiAgICAgICAgICAgIEBpbnRlcnByZXRlci5zdWJJbnRlcnByZXRlciA9IGNvbW1vbkV2ZW50LmNhbGwoQHBhcmFtcy5wYXJhbWV0ZXJzIHx8IFtdKQogICAgICAgICAgICBAaW50ZXJwcmV0ZXIuY29udGV4dCA9IHRoaXMKICAgICAgICAgICAgQGludGVycHJldGVyLnN1YkludGVycHJldGVyLm9uRmluaXNoID0gPT4gCiAgICAgICAgICAgICAgICBAaW50ZXJwcmV0ZXIuc3ViSW50ZXJwcmV0ZXIub25GaW5pc2ggPSBudWxsCiAgICAgICAgICAgICAgICBAaW50ZXJwcmV0ZXIuc3ViSW50ZXJwcmV0ZXIgPSBudWxsCiAgICAgICAgICAgICAgICBAaW50ZXJwcmV0ZXIuaXNXYWl0aW5nID0gbm8KCiAgICAgICAgICAgIEBpbnRlcnByZXRlci5pc1dhaXRpbmcgPSB5ZXMKICAgICAgICAgICAgQGludGVycHJldGVyLnN1YkludGVycHJldGVyLnN0YXJ0KCkKICAgICAgICAgICAgQGludGVycHJldGVyLnN1YkludGVycHJldGVyLnVwZGF0ZSgpCiAgICAgICAgICAgIAogICAgY29tbWFuZENoYW5nZVRpbWVyOiAtPgogICAgICAgIHN3aXRjaCBAcGFyYW1zLm9wZXJhdGlvbgogICAgICAgICAgICB3aGVuIDAgIyBTdGFydAogICAgICAgICAgICAgICAgaWYgQHBhcmFtcy5zdG9wV2F0Y2gKICAgICAgICAgICAgICAgICAgICBHYW1lTWFuYWdlci50aW1lci5zdG9wV2F0Y2ggPSB5ZXMKICAgICAgICAgICAgICAgICAgICBHYW1lTWFuYWdlci50aW1lci5taW51dGVzID0gMAogICAgICAgICAgICAgICAgICAgIEdhbWVNYW5hZ2VyLnRpbWVyLnNlY29uZHMgPSAwCiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgR2FtZU1hbmFnZXIudGltZXIuc3RvcFdhdGNoID0gbm8KICAgICAgICAgICAgICAgICAgICBHYW1lTWFuYWdlci50aW1lci5taW51dGVzID0gQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy5taW51dGVzKQogICAgICAgICAgICAgICAgICAgIEdhbWVNYW5hZ2VyLnRpbWVyLnNlY29uZHMgPSBAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLnNlY29uZHMpCiAgICAgICAgICAgICAgICBHYW1lTWFuYWdlci50aW1lci5zdGFydCgpCiAgICAgICAgICAgIHdoZW4gMSAjIFN0b3AKICAgICAgICAgICAgICAgIEdhbWVNYW5hZ2VyLnRpbWVyLnN0b3AoKQogICAgICAgICAgICB3aGVuIDIgIyBQYXVzZQogICAgICAgICAgICAgICAgR2FtZU1hbmFnZXIudGltZXIucGF1c2UoKQogICAgICAgICAgICB3aGVuIDMgIyBSZXN1bWUKICAgICAgICAgICAgICAgIEdhbWVNYW5hZ2VyLnRpbWVyLnJlc3VtZSgpCiAgICAKICAgIGNvbW1hbmRTaG93QmF0dGxlQW5pbWF0aW9uOiAtPgogICAgICAgIGFuaW1hdGlvbiA9IFJlY29yZE1hbmFnZXIuYW5pbWF0aW9uc1tAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLmFuaW1hdGlvbklkKV0KICAgICAgICBlbmVteSA9IFNjZW5lTWFuYWdlci5zY2VuZS5lbmVteVNwcml0ZXNbQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy5lbmVteUlkKV0KCiAgICAgICAgaWYgZW5lbXk/IGFuZCBhbmltYXRpb24/CiAgICAgICAgICAgIGxvZ2ljID0gbmV3IExvZ2ljX0FuaW1hdGlvbihhbmltYXRpb24pCiAgICAgICAgICAgIGxvZ2ljLnJlcGVhdCA9IEBwYXJhbXMucmVwZWF0CiAgICAgICAgICAgIGlmIEBwYXJhbXMud2FpdEZvckNvbXBsZXRpb24KICAgICAgICAgICAgICAgIEBpbnRlcnByZXRlci5pc1dhaXRpbmcgPSB5ZXMKICAgICAgICAgICAgICAgIGxvZ2ljLm9uRmluaXNoID0gPT4gQGludGVycHJldGVyLmlzV2FpdGluZyA9IG5vCiAgICAgICAgICAgIHNwcml0ZXNldCA9IG5ldyBTcHJpdGVzZXRfQW5pbWF0aW9uKGxvZ2ljKSAgICAKICAgICAgICAgICAgc3ByaXRlc2V0LnRhcmdldC54ID0gZW5lbXkuc3ByaXRlLngKICAgICAgICAgICAgc3ByaXRlc2V0LnRhcmdldC55ID0gZW5lbXkuc3ByaXRlLnkKICAgICAgICAgICAgc3ByaXRlc2V0LnRhcmdldC5zcHJpdGUgPSBlbmVteS5zcHJpdGUKICAgICAgICAgICAgR2FtZU1hbmFnZXIuYW5pbWF0aW9ucy5wdXNoKHNwcml0ZXNldCkKICAgICAgICAgICAgbG9naWMuc3RhcnQoKQogICAgCiAgICBzaG93QW5pbWF0aW9uOiAoZXZlbnQsIHBhcmFtcykgLT4KICAgICAgICBzd2l0Y2ggcGFyYW1zLmFuaW1hdGlvblR5cGUKICAgICAgICAgICAgd2hlbiAwICMgU2ltcGxlCiAgICAgICAgICAgICAgICBhbmltYXRpb24gPSBSZWNvcmRNYW5hZ2VyLnNpbXBsZUFuaW1hdGlvbnNbQG51bWJlclZhbHVlT2YocGFyYW1zLmFuaW1hdGlvbklkKV0KICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaWYgZXZlbnQ/IGFuZCBhbmltYXRpb24/CiAgICAgICAgICAgICAgICAgICAgbG9naWMgPSBuZXcgTG9naWNfU2ltcGxlQW5pbWF0aW9uKGFuaW1hdGlvbikKICAgICAgICAgICAgICAgICAgICBsb2dpYy5yZXBlYXQgPSBwYXJhbXMucmVwZWF0CiAgICAgICAgICAgICAgICAgICAgaWYgcGFyYW1zLndhaXRGb3JDb21wbGV0aW9uCiAgICAgICAgICAgICAgICAgICAgICAgIEBpc1dhaXRpbmcgPSB5ZXMKICAgICAgICAgICAgICAgICAgICAgICAgbG9naWMub25GaW5pc2ggPSA9PiBAaXNXYWl0aW5nID0gbm8KICAgICAgICAgICAgICAgICAgICBzcHJpdGUgPSBuZXcgU3ByaXRlX1NpbXBsZUFuaW1hdGlvbihsb2dpYywgU2NlbmVNYW5hZ2VyLnNjZW5lLm1hcC5tYXBWaWV3cG9ydCkgICAgCiAgICAgICAgICAgICAgICAgICAgc3ByaXRlLnRhcmdldC5zcHJpdGUgPSBTY2VuZU1hbmFnZXIuc2NlbmUubWFwLmV2ZW50c0J5SWRbZXZlbnQuaWRdIAogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIEdhbWVNYW5hZ2VyLmFuaW1hdGlvbnMucHVzaChzcHJpdGUpCiAgICAgICAgICAgICAgICAgICAgbG9naWMuc3RhcnQoKQogICAgICAgICAgICB3aGVuIDEgIyBDb21wbGV4CiAgICAgICAgICAgICAgICBhbmltYXRpb24gPSBSZWNvcmRNYW5hZ2VyLmFuaW1hdGlvbnNbQG51bWJlclZhbHVlT2YocGFyYW1zLmFuaW1hdGlvbklkKV0KCiAgICAgICAgICAgICAgICBpZiBldmVudD8gYW5kIGFuaW1hdGlvbj8KICAgICAgICAgICAgICAgICAgICBsb2dpYyA9IG5ldyBMb2dpY19BbmltYXRpb24oYW5pbWF0aW9uKQogICAgICAgICAgICAgICAgICAgIGxvZ2ljLnJlcGVhdCA9IHBhcmFtcy5yZXBlYXQKICAgICAgICAgICAgICAgICAgICBpZiBwYXJhbXMud2FpdEZvckNvbXBsZXRpb24KICAgICAgICAgICAgICAgICAgICAgICAgQGlzV2FpdGluZyA9IHllcwogICAgICAgICAgICAgICAgICAgICAgICBsb2dpYy5vbkZpbmlzaCA9ID0+IEBpc1dhaXRpbmcgPSBubwogICAgICAgICAgICAgICAgICAgIHNwcml0ZXNldCA9IG5ldyBTcHJpdGVzZXRfQW5pbWF0aW9uKGxvZ2ljLCBTY2VuZU1hbmFnZXIuc2NlbmUubWFwLm1hcFZpZXdwb3J0KSAgICAKICAgICAgICAgICAgICAgICAgICBzcHJpdGVzZXQudGFyZ2V0LnggPSBldmVudC54CiAgICAgICAgICAgICAgICAgICAgc3ByaXRlc2V0LnRhcmdldC55ID0gZXZlbnQueQogICAgICAgICAgICAgICAgICAgIHNwcml0ZXNldC50YXJnZXQuc3ByaXRlID0gU2NlbmVNYW5hZ2VyLnNjZW5lLm1hcC5ldmVudHNCeUlkW2V2ZW50LmlkXSAKICAgICAgICAgICAgICAgICAgICBHYW1lTWFuYWdlci5hbmltYXRpb25zLnB1c2goc3ByaXRlc2V0KQogICAgICAgICAgICAgICAgICAgIGxvZ2ljLnN0YXJ0KCkKICAgIGNvbW1hbmRTaG93QW5pbWF0aW9uR2xvYmFsRXZlbnQ6IC0+CiAgICAgICAgcmV0dXJuIGlmIG5vdCBTY2VuZU1hbmFnZXIuc2NlbmUgaW5zdGFuY2VvZiBTY2VuZV9NYXAKICAgICAgICAKICAgICAgICBldmVudCA9IEBpbnRlcnByZXRlci5nbG9iYWxFdmVudEJ5SWQoQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy5ldmVudElkKSkKICAgICAgICBAaW50ZXJwcmV0ZXIuc2hvd0FuaW1hdGlvbihldmVudCwgQHBhcmFtcykKICAgICAgICAKICAgIGNvbW1hbmRTaG93QW5pbWF0aW9uTWFwRXZlbnQ6IC0+CiAgICAgICAgcmV0dXJuIGlmIG5vdCBTY2VuZU1hbmFnZXIuc2NlbmUgaW5zdGFuY2VvZiBTY2VuZV9NYXAKICAgICAgICAKICAgICAgICBldmVudCA9IEBpbnRlcnByZXRlci5ldmVudEJ5SWQoQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy5ldmVudElkKSkKICAgICAgICBAaW50ZXJwcmV0ZXIuc2hvd0FuaW1hdGlvbihldmVudCwgQHBhcmFtcykKICAgICAgCiAgICBjb21tYW5kQ2hhbmdlVGV4dFNldHRpbmdzOiAtPgogICAgICAgIG51bWJlciA9IEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMubnVtYmVyKQogICAgICAgIHRleHRzID0gR2FtZU1hbmFnZXIudGV4dHMKICAgICAgICBpZiBub3QgdGV4dHNbbnVtYmVyXT8gCiAgICAgICAgICAgIHRleHRzW251bWJlcl0gPSBuZXcgU3ByaXRlX1RleHRQaWN0dXJlKG5ldyBMb2dpY19QaWN0dXJlKCkpCiAgICAgICAgICAgIHRleHRzW251bWJlcl0udmlzaWJsZSA9IG5vCiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgIHRleHRTcHJpdGUgPSB0ZXh0c1tudW1iZXJdCiAgICAgICAgdGV4dFNwcml0ZS5mb250ID0gbmV3IEZvbnQoQGludGVycHJldGVyLnN0cmluZ1ZhbHVlT2YoQHBhcmFtcy5mb250KSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLnNpemUpKQogICAgICAgIHRleHRTcHJpdGUuZm9udC5jb2xvciA9IG5ldyBDb2xvcihAcGFyYW1zLmNvbG9yKQogICAgICAgIHRleHRTcHJpdGUuZm9udC5ib2xkID0gQHBhcmFtcy5ib2xkCiAgICAgICAgdGV4dFNwcml0ZS5mb250Lml0YWxpYyA9IEBwYXJhbXMuaXRhbGljCiAgICAgICAgdGV4dFNwcml0ZS5mb250LmJvcmRlciA9IEBwYXJhbXMub3V0bGluZQogICAgICAgIHRleHRTcHJpdGUuZm9udC5ib3JkZXJDb2xvciA9IG5ldyBDb2xvcihAcGFyYW1zLm91dGxpbmVDb2xvcikKICAgICAgICB0ZXh0U3ByaXRlLmZvbnQuc2hhZG93ID0gQHBhcmFtcy5zaGFkb3cKICAgICAgICB0ZXh0U3ByaXRlLmZvbnQuc2hhZG93Q29sb3IgPSBuZXcgQ29sb3IoQHBhcmFtcy5zaGFkb3dDb2xvcikKICAgICAgICAKICAgICAgICB0ZXh0U3ByaXRlLnJlZnJlc2goKQogICAgICAgIAogICAgY29tbWFuZFNob3dUZXh0OiAtPgogICAgICAgIG51bWJlciA9IEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMubnVtYmVyKQogICAgICAgIHRleHQgPSBAaW50ZXJwcmV0ZXIuc3RyaW5nVmFsdWVPZihAcGFyYW1zLnRleHQpCiAgICAgICAgdGV4dHMgPSBHYW1lTWFuYWdlci50ZXh0cwogICAgICAgIGlmIG5vdCB0ZXh0c1tudW1iZXJdPyB0aGVuIHRleHRzW251bWJlcl0gPSBuZXcgU3ByaXRlX1RleHRQaWN0dXJlKG5ldyBMb2dpY19QaWN0dXJlKCkpCiAgICAgICAgCiAgICAgICAgeCA9IEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMueCkKICAgICAgICB5ID0gQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy55KQoKICAgICAgICB0ZXh0U3ByaXRlID0gdGV4dHNbbnVtYmVyXQogICAgICAgIHRleHRTcHJpdGUudGV4dCA9IHRleHQKICAgICAgICB0ZXh0U3ByaXRlLnJlZnJlc2goKQogICAgICAgIAogICAgICAgIHRleHRTcHJpdGUudmlzaWJsZSA9IHllcwogICAgICAgIHRleHRTcHJpdGUubG9naWMueCA9IGlmIEBwYXJhbXMub3JpZ2luID09IDAgdGhlbiB4IGVsc2UgKHggLSB0ZXh0U3ByaXRlLmJpdG1hcC53aWR0aCAvIDIpCiAgICAgICAgdGV4dFNwcml0ZS5sb2dpYy55ID0gaWYgQHBhcmFtcy5vcmlnaW4gPT0gMCB0aGVuIHkgZWxzZSAoeSAtIHRleHRTcHJpdGUuYml0bWFwLmhlaWdodCAvIDIpCiAgICAgICAgdGV4dFNwcml0ZS5sb2dpYy56b29tWCA9IEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMuc2NhbGVYKSAvIDEwMAogICAgICAgIHRleHRTcHJpdGUubG9naWMuem9vbVkgPSBAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLnNjYWxlWSkgLyAxMDAKICAgICAgICAjcGljdHVyZS5sb2dpYy5hbmdsZSA9IE1hdGguZGVncmVlc1RvUmFkaWFucyhAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLmFuZ2xlKSkKICAgICAgIyAgcGljdHVyZS5sb2dpYy5vcGFjaXR5ID0gQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy5vcGFjaXR5KQogICAgICAgIyBwaWN0dXJlLmJsZW5kaW5nTW9kZSA9IEBwYXJhbXMuYmxlbmRpbmcKICAgICAgICB0ZXh0U3ByaXRlLnogPSAyMDAKICAgICAgICAKICAgIGNvbW1hbmRNb3ZlVGV4dDogLT4KICAgICAgICBudW1iZXIgPSBAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLm51bWJlcikKICAgICAgICBwaWN0dXJlcyA9IEdhbWVNYW5hZ2VyLnBpY3R1cmVzCiAgICAgICAgR2FtZU1hbmFnZXIucGljdHVyZXMgPSBHYW1lTWFuYWdlci50ZXh0cwogICAgICAgIEBpbnRlcnByZXRlci5jb21tYW5kTW92ZVBpY3R1cmUuY2FsbCh0aGlzKQogICAgICAgIEdhbWVNYW5hZ2VyLnBpY3R1cmVzID0gcGljdHVyZXMKICAgICAgICAKICAgIGNvbW1hbmRSb3RhdGVUZXh0OiAtPgogICAgICAgIG51bWJlciA9IEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMubnVtYmVyKQogICAgICAgIHBpY3R1cmVzID0gR2FtZU1hbmFnZXIucGljdHVyZXMKICAgICAgICBHYW1lTWFuYWdlci5waWN0dXJlcyA9IEdhbWVNYW5hZ2VyLnRleHRzCiAgICAgICAgQGludGVycHJldGVyLmNvbW1hbmRSb3RhdGVQaWN0dXJlLmNhbGwodGhpcykKICAgICAgICBHYW1lTWFuYWdlci5waWN0dXJlcyA9IHBpY3R1cmVzICAgIAogICAgICAgIAogICAgY29tbWFuZENvbG9yVGV4dDogLT4KICAgICAgICBudW1iZXIgPSBAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLm51bWJlcikKICAgICAgICB0ZXh0ID0gR2FtZU1hbmFnZXIudGV4dHNbbnVtYmVyXQogICAgICAgIGR1cmF0aW9uID0gQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy5kdXJhdGlvbikKICAgICAgICAKICAgICAgICBpZiB0ZXh0PwogICAgICAgICAgICB0ZXh0LmxvZ2ljLmNvbG9yVG8obmV3IENvbG9yKEBwYXJhbXMuY29sb3IpLCBkdXJhdGlvbikKICAgICAgICAgICAgaWYgQHBhcmFtcy53YWl0Rm9yQ29tcGxldGlvbiBhbmQgbm90IChkdXJhdGlvbiA9PSAwKQogICAgICAgICAgICAgICAgQGludGVycHJldGVyLmlzV2FpdGluZyA9IHllcwogICAgICAgICAgICAgICAgQGludGVycHJldGVyLndhaXRDb3VudGVyID0gZHVyYXRpb24gCiAgICAgICAgICAgICAgICAKICAgIGNvbW1hbmRFcmFzZVRleHQ6IC0+CiAgICAgICAgbnVtYmVyID0gQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy5udW1iZXIpCiAgICAgICAgdGV4dCA9IEdhbWVNYW5hZ2VyLnRleHRzW251bWJlcl0KICAgICAgICAKICAgICAgICBpZiB0ZXh0PyB0aGVuIHRleHQuZGlzcG9zZSgpCiAgICAgICAgR2FtZU1hbmFnZXIudGV4dHNbbnVtYmVyXSA9IG51bGwKICAgICAgICAKICAgIGNvbW1hbmRJbnB1dFRleHQ6IC0+CiAgICAgICAgQGludGVycHJldGVyLmlzV2FpdGluZyA9IHllcwogICAgICAgIGlmIEBpbnRlcnByZXRlci5pc1Byb2Nlc3NpbmdNZXNzYWdlSW5PdGhlckNvbnRleHQoKQogICAgICAgICAgICBAaW50ZXJwcmV0ZXIud2FpdEZvck1lc3NhZ2UoKQogICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgCiAgICAgICAgR2FtZU1hbmFnZXIucGxheWVyLmlzUGxheWVyID0gbm8KICAgICAgICAKICAgICAgICBpZiBHYW1lTWFuYWdlci5pbnB1dFRleHRXaW5kb3dzZXQ/CiAgICAgICAgICAgIEdhbWVNYW5hZ2VyLmlucHV0VGV4dFdpbmRvd3NldC5kaXNwb3NlKCkKICAgICAgICAgICAgCiAgICAgICAgR2FtZU1hbmFnZXIuaW5wdXRUZXh0V2luZG93c2V0ID0gbmV3IFdpbmRvd3NldF9JbnB1dFRleHQoOTAgKiBXaW5kb3dfQmFzZS5zY2FsZSwgMCwgQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy5sZXR0ZXJzKSkKICAgICAgICBHYW1lTWFuYWdlci5pbnB1dFRleHRXaW5kb3dzZXQuZXhlY3V0aW9uQ29udGV4dCA9IEBpbnRlcnByZXRlci5jb250ZXh0CiAgICAgICAgR2FtZU1hbmFnZXIuaW5wdXRUZXh0V2luZG93c2V0LmV2ZW50ID0gR2FtZU1hbmFnZXIubWFwLmN1cnJlbnRFdmVudAogICAgICAgIEdhbWVNYW5hZ2VyLmlucHV0VGV4dFdpbmRvd3NldC5ldmVudC5pc0xvY2tlZCA9IHllcwogICAgICAgIEdhbWVNYW5hZ2VyLmlucHV0VGV4dFdpbmRvd3NldC5vbkFjY2VwdCA9ICh0ZXh0KSA9PiAKICAgICAgICAgICAgQGludGVycHJldGVyLnNldFN0cmluZ1ZhbHVlVG8oQHBhcmFtcy52YXJpYWJsZSwgdGV4dCkKICAgICAgICAgICAgQGludGVycHJldGVyLmlzV2FpdGluZyA9IG5vCiAgICAgICAgICAgIEdhbWVNYW5hZ2VyLnBsYXllci5pc1BsYXllciA9IHllcwogICAgICAgICAgICAKICAgICAgICAgICAgaWYgbm90IEBpbnRlcnByZXRlci5pc01lc3NhZ2VDb21tYW5kKEBpbnRlcnByZXRlci5wb2ludGVyLCBAaW50ZXJwcmV0ZXIuY29tbWFuZHMpCiAgICAgICAgICAgICAgICBHYW1lTWFuYWdlci5tZXNzYWdlV2luZG93LmNsb3NlKCkKICAgICAgICAgICAgICAgIEdhbWVNYW5hZ2VyLmlucHV0VGV4dFdpbmRvd3NldC5ldmVudC5pc0xvY2tlZCA9IG5vCiAgICAgICAgICAgIAogICAgICAgIEdhbWVNYW5hZ2VyLmlucHV0VGV4dFdpbmRvd3NldC5zaG93KHllcywgeWVzKQogICAgY29tbWFuZElucHV0TmFtZTogLT4KICAgICAgICBAaW50ZXJwcmV0ZXIuaXNXYWl0aW5nID0geWVzCiAgICAgICAgCiAgICAgICAgaWYgQGludGVycHJldGVyLmlzUHJvY2Vzc2luZ01lc3NhZ2VJbk90aGVyQ29udGV4dCgpCiAgICAgICAgICAgIEBpbnRlcnByZXRlci53YWl0Rm9yTWVzc2FnZSgpCiAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICAKICAgICAgICBHYW1lTWFuYWdlci5wbGF5ZXIuaXNQbGF5ZXIgPSBubwogICAgICAgIGFjdG9yID0gUmVjb3JkTWFuYWdlci5hY3RvcnNbQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy5hY3RvcklkKV0KCiAgICAgICAgaWYgR2FtZU1hbmFnZXIuaW5wdXRUZXh0V2luZG93c2V0PwogICAgICAgICAgICBHYW1lTWFuYWdlci5pbnB1dFRleHRXaW5kb3dzZXQuZGlzcG9zZSgpCiAgICAgICAgICAgIAogICAgICAgIEdhbWVNYW5hZ2VyLmlucHV0VGV4dFdpbmRvd3NldCA9IG5ldyBXaW5kb3dzZXRfSW5wdXRUZXh0KDcwICogV2luZG93X0Jhc2Uuc2NhbGUsIDAsIEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMubGV0dGVycyksIGFjdG9yKQogICAgICAgIEdhbWVNYW5hZ2VyLmlucHV0VGV4dFdpbmRvd3NldC5leGVjdXRpb25Db250ZXh0ID0gQGludGVycHJldGVyLmNvbnRleHQKICAgICAgICBHYW1lTWFuYWdlci5pbnB1dFRleHRXaW5kb3dzZXQuZXZlbnQgPSBHYW1lTWFuYWdlci5tYXAuY3VycmVudEV2ZW50CiAgICAgICAgR2FtZU1hbmFnZXIuaW5wdXRUZXh0V2luZG93c2V0LmV2ZW50LmlzTG9ja2VkID0geWVzCiAgICAgICAgR2FtZU1hbmFnZXIuaW5wdXRUZXh0V2luZG93c2V0Lm9uQWNjZXB0ID0gKHRleHQpID0+IAogICAgICAgICAgICBhY3RvciA9IFJlY29yZE1hbmFnZXIuYWN0b3JzW0BpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMuYWN0b3JJZCldCiAgICAgICAgICAgIGlmIGFjdG9yPyB0aGVuIGFjdG9yLm5hbWUgPSB0ZXh0CiAgICAgICAgICAgIEBpbnRlcnByZXRlci5pc1dhaXRpbmcgPSBubwogICAgICAgICAgICBHYW1lTWFuYWdlci5wbGF5ZXIuaXNQbGF5ZXIgPSB5ZXMKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIG5vdCBAaW50ZXJwcmV0ZXIuaXNNZXNzYWdlQ29tbWFuZChAaW50ZXJwcmV0ZXIucG9pbnRlciwgQGludGVycHJldGVyLmNvbW1hbmRzKQogICAgICAgICAgICAgICAgR2FtZU1hbmFnZXIubWVzc2FnZVdpbmRvdy5jbG9zZSgpCiAgICAgICAgICAgICAgICBHYW1lTWFuYWdlci5pbnB1dFRleHRXaW5kb3dzZXQuZXZlbnQuaXNMb2NrZWQgPSBubwogICAgICAgICAgICAKICAgICAgICBHYW1lTWFuYWdlci5pbnB1dFRleHRXaW5kb3dzZXQuc2hvdyh5ZXMsIHllcykKICAgICAgICAKICAgIGNvbW1hbmRDaGFuZ2VQbGF5ZXI6IC0+CiAgICAgICAgZXZlbnQgPSBHYW1lTWFuYWdlci5nbG9iYWxFdmVudHNCeUlkW0BpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMuZXZlbnRJZCldCiAgICAgICAgaWYgZXZlbnQ/CiAgICAgICAgICAgIEdhbWVNYW5hZ2VyLnBsYXllci5pc1BsYXllciA9IG5vCiAgICAgICAgICAgIGV2ZW50LmlzUGxheWVyID0geWVzCiAgICAgICAgICAgIEdhbWVNYW5hZ2VyLnBsYXllciA9IGV2ZW50CiAgICAgICAgICAgIAogICAgY29tbWFuZENoYW5nZUdsb2JhbEV2ZW50VmlzaWJpbGl0eTogLT4KICAgICAgICBldmVudCA9IEdhbWVNYW5hZ2VyLmdsb2JhbEV2ZW50c0J5SWRbQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy5ldmVudElkKV0KICAgICAgICBpZiBldmVudD8KICAgICAgICAgICAgZXZlbnQudmlzaWJsZSA9IEBwYXJhbXMudmlzaWJpbGl0eSA9PSAwCiAgICAgICAgICAgIGV2ZW50LnRocm91Z2ggPSBAcGFyYW1zLnZpc2liaWxpdHkgIT0gMAoKICAgICAgICAgICAgCiAgICBjb21tYW5kU2NyaXB0OiAtPgogICAgICAgIHRyeQogICAgICAgICAgICBldmFsKEBwYXJhbXMuc2NyaXB0KQogICAgICAgIGNhdGNoIGV4CiAgICAgICAgICAgIGNvbnNvbGUubG9nKGV4KQogICAgICAgICAgICAKICAgIGNvbW1hbmRGb3JjZUFjdGlvbjogLT4KICAgICAgICBzY2VuZSA9IFNjZW5lTWFuYWdlci5zY2VuZQogICAgICAgIGlmIHNjZW5lIGluc3RhbmNlb2YgU2NlbmVfQmF0dGxlCiAgICAgICAgICAgIHNraWxsID0gUmVjb3JkTWFuYWdlci5za2lsbHNbQGludGVycHJldGVyLm51bWJlclZhbHVlT2YoQHBhcmFtcy5za2lsbElkKV0KICAgICAgICAgICAgdXNlciA9IG51bGwKICAgICAgICAgICAgCiAgICAgICAgICAgIHN3aXRjaCBAcGFyYW1zLnVzZXIKICAgICAgICAgICAgICAgIHdoZW4gMCAjIEJhdHRsZXIKICAgICAgICAgICAgICAgICAgICBiYXR0bGVyVmFsdWUgPSBAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLnVzZXJWYWx1ZSkKICAgICAgICAgICAgICAgICAgICB1c2VyID0gaWYgYmF0dGxlclZhbHVlIDwgNCB0aGVuIHNjZW5lLm1lbWJlcnNbYmF0dGxlclZhbHVlXSBlbHNlIHNjZW5lLmVuZW1pZXNbYmF0dGxlclZhbHVlIC0gNF0KICAgICAgICAgICAgICAgIHdoZW4gMSAjIEFjdG9yCiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coQHBhcmFtcykKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhAcGFyYW1zLnVzZXJWYWx1ZSkKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLnVzZXJWYWx1ZSkpCiAgICAgICAgICAgICAgICAgICAgYWN0b3IgPSBSZWNvcmRNYW5hZ2VyLmFjdG9yc1tAaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZihAcGFyYW1zLnVzZXJWYWx1ZSldCiAgICAgICAgICAgICAgICAgICAgaWYgYWN0b3I/CiAgICAgICAgICAgICAgICAgICAgICAgIGlkcyA9IHNjZW5lLm1lbWJlcnMudG9Qcm9wZXJ0eUFycmF5KCJhY3RvciIpLnRvUHJvcGVydHlBcnJheSgiYWN0b3JJZCIpCiAgICAgICAgICAgICAgICAgICAgICAgIGlkID0gaWRzLmluZGV4T2YoYWN0b3IuaW5kZXgpCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGFjdG9yKQogICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhpZHMpCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGlkKQogICAgICAgICAgICAgICAgICAgICAgICBpZiBpZCAhPSAtMSB0aGVuIHVzZXIgPSBzY2VuZS5tZW1iZXJzW2lkXQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgIHRhcmdldCA9IEBpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMudGFyZ2V0KQogICAgICAgICAgICAKICAgICAgICAgICAgaWYgc2tpbGw/IGFuZCB1c2VyPwogICAgICAgICAgICAgICAgaWYgdGFyZ2V0ID09IDAgIyBMYXN0IFRhcmdldAogICAgICAgICAgICAgICAgICAgIHRhcmdldCA9IHVzZXIubGFzdFRhcmdldCB8fCBzY2VuZS5lbmVtaWVzWzBdCiAgICAgICAgICAgICAgICBlbHNlIGlmIHRhcmdldCA9PSAxICMgUmFuZG9tIE1lbWJlcgogICAgICAgICAgICAgICAgICAgIHRhcmdldCA9IHNjZW5lLm1lbWJlcnNbTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpICogKHNjZW5lLm1lbWJlcnMubGVuZ3RoLTEpKV0KICAgICAgICAgICAgICAgIGVsc2UgaWYgdGFyZ2V0ID09IDIgIyBSYW5kb20gRW5lbXkKICAgICAgICAgICAgICAgICAgICB0YXJnZXQgPSBzY2VuZS5lbmVtaWVzW01hdGgucm91bmQoTWF0aC5yYW5kb20oKSAqIChzY2VuZS5lbmVtaWVzLmxlbmd0aC0xKSldCiAgICAgICAgICAgICAgICBlbHNlIGlmIHRhcmdldCA9PSAzICMgUmFuZG9tIEJhdHRsZXIKICAgICAgICAgICAgICAgICAgICB0YXJnZXQgPSBzY2VuZS5iYXR0bGVyc1tNYXRoLnJvdW5kKE1hdGgucmFuZG9tKCkgKiAoc2NlbmUuYmF0dGxlcnMubGVuZ3RoLTEpKV0KICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICB0YXJnZXQgPSBpZiB0YXJnZXQgPCA4IHRoZW4gc2NlbmUubWVtYmVyc1t0YXJnZXQtNF0gZWxzZSBzY2VuZS5lbmVtaWVzW3RhcmdldC04XQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgc2NlbmUuZm9yY2VBY3Rpb24oc2tpbGwsIHVzZXIsIHRhcmdldCkKICAgICAgICAgICAgICAgIAogICAgY29tbWFuZENoYW5nZUJhdHRsZU11c2ljOiAtPgogICAgICAgIGlmIEBwYXJhbXMubXVzaWM/IGFuZCBAcGFyYW1zLm11c2ljLm5hbWUubGVuZ3RoID4gMAogICAgICAgICAgICBHYW1lTWFuYWdlci5iYXR0bGVNdXNpYyA9IEBwYXJhbXMubXVzaWMKICAgICAgICBlbHNlCiAgICAgICAgICAgIEdhbWVNYW5hZ2VyLmJhdHRsZU11c2ljID0gbnVsbAogICAgICAgICAgICAKICAgIGNvbW1hbmRDaGFuZ2VCYXR0bGVUZXJyYWluOiAtPgogICAgICAgIHRlcnJhaW4gPSBSZWNvcmRNYW5hZ2VyLnRlcnJhaW5zW0BpbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKEBwYXJhbXMudGVycmFpbklkKV0KICAgICAgICAKICAgICAgICBpZiB0ZXJyYWluPwogICAgICAgICAgICBHYW1lTWFuYWdlci5iYXR0bGVUZXJyYWluID0gdGVycmFpbgogICAgICAgIAp3aW5kb3cuQ29tbWFuZEludGVycHJldGVyID0gQ29tbWFuZEludGVycHJldGVyCiAgICAKICAgICAgICAKICAgICAgICA=","compiledContent":"KGZ1bmN0aW9uKCkgewogIHZhciBDb21tYW5kSW50ZXJwcmV0ZXI7CgogIENvbW1hbmRJbnRlcnByZXRlciA9IChmdW5jdGlvbigpIHsKICAgIGZ1bmN0aW9uIENvbW1hbmRJbnRlcnByZXRlcihjb21tYW5kcykgewogICAgICB0aGlzLmNvbW1hbmRzID0gY29tbWFuZHM7CiAgICAgIHRoaXMuY29tbWFuZCA9IG51bGw7CiAgICAgIHRoaXMud2FpdENvdW50ZXIgPSAwOwogICAgICB0aGlzLndhaXRGb3JBY3Rpb25LZXkgPSBmYWxzZTsKICAgICAgdGhpcy5wb2ludGVyID0gMDsKICAgICAgdGhpcy5jb25kaXRpb25zID0gW107CiAgICAgIHRoaXMuaXNSdW5uaW5nID0gZmFsc2U7CiAgICAgIHRoaXMubWVzc2FnZVdpbmRvdyA9IEdhbWVNYW5hZ2VyLm1lc3NhZ2VXaW5kb3c7CiAgICAgIHRoaXMubGFiZWxzID0ge307CiAgICAgIHRoaXMuaXNXYWl0aW5nID0gZmFsc2U7CiAgICAgIHRoaXMuaXNXYWl0aW5nRm9yTWVzc2FnZSA9IGZhbHNlOwogICAgICB0aGlzLmNob2ljZSA9IG51bGw7CiAgICAgIHRoaXMucmVwZWF0ID0gZmFsc2U7CiAgICAgIHRoaXMucGFyZW50T2JqZWN0ID0gbnVsbDsKICAgICAgdGhpcy5zdWJJbnRlcnByZXRlciA9IG51bGw7CiAgICAgIHRoaXMudGVtcE51bWJlcnMgPSBudWxsOwogICAgICB0aGlzLnRlbXBTdHJpbmdzID0gbnVsbDsKICAgICAgdGhpcy50ZW1wQm9vbGVhbnMgPSBudWxsOwogICAgICB0aGlzLmNvbnRleHQgPSB0aGlzOwogICAgfQoKICAgIENvbW1hbmRJbnRlcnByZXRlci5wcm90b3R5cGUuc3RhcnQgPSBmdW5jdGlvbigpIHsKICAgICAgdGhpcy5wb2ludGVyID0gMDsKICAgICAgcmV0dXJuIHRoaXMuaXNSdW5uaW5nID0gdHJ1ZTsKICAgIH07CgogICAgQ29tbWFuZEludGVycHJldGVyLnByb3RvdHlwZS5zdG9wID0gZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiB0aGlzLmlzUnVubmluZyA9IGZhbHNlOwogICAgfTsKCiAgICBDb21tYW5kSW50ZXJwcmV0ZXIucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgX3Jlc3VsdHM7CiAgICAgIGlmICh0aGlzLnN1YkludGVycHJldGVyICE9IG51bGwpIHsKICAgICAgICB0aGlzLnN1YkludGVycHJldGVyLnVwZGF0ZSgpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBHYW1lTWFuYWdlci52YXJpYWJsZVN0b3JlLnRlbXBOdW1iZXJzID0gdGhpcy50ZW1wTnVtYmVyczsKICAgICAgR2FtZU1hbmFnZXIudmFyaWFibGVTdG9yZS50ZW1wU3RyaW5ncyA9IHRoaXMudGVtcFN0cmluZ3M7CiAgICAgIEdhbWVNYW5hZ2VyLnZhcmlhYmxlU3RvcmUudGVtcEJvb2xlYW5zID0gdGhpcy50ZW1wQm9vbGVhbnM7CiAgICAgIGlmICgodGhpcy5jb21tYW5kcyA9PSBudWxsKSB8fCB0aGlzLnBvaW50ZXIgPj0gdGhpcy5jb21tYW5kcy5sZW5ndGgpIHsKICAgICAgICBpZiAodGhpcy5yZXBlYXQpIHsKICAgICAgICAgIHRoaXMuc3RhcnQoKTsKICAgICAgICB9IGVsc2UgaWYgKHRoaXMuaXNSdW5uaW5nKSB7CiAgICAgICAgICB0aGlzLmlzUnVubmluZyA9IGZhbHNlOwogICAgICAgICAgaWYgKHRoaXMub25GaW5pc2ggIT0gbnVsbCkgewogICAgICAgICAgICB0aGlzLm9uRmluaXNoKHRoaXMpOwogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgfQogICAgICBpZiAoIXRoaXMuaXNSdW5uaW5nKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGlmICh0aGlzLndhaXRDb3VudGVyID4gMCkgewogICAgICAgIHRoaXMud2FpdENvdW50ZXItLTsKICAgICAgICB0aGlzLmlzV2FpdGluZyA9IHRoaXMud2FpdENvdW50ZXIgPiAwOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBpZiAodGhpcy5pc1dhaXRpbmdGb3JNZXNzYWdlKSB7CiAgICAgICAgdGhpcy5pc1dhaXRpbmcgPSB0cnVlOwogICAgICAgIGlmICghdGhpcy5pc1Byb2Nlc3NpbmdNZXNzYWdlSW5PdGhlckNvbnRleHQoKSkgewogICAgICAgICAgdGhpcy5pc1dhaXRpbmcgPSBmYWxzZTsKICAgICAgICAgIHRoaXMuaXNXYWl0aW5nRm9yTWVzc2FnZSA9IGZhbHNlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICB9CiAgICAgIC8qCiAgICAgIGlmIEB3YWl0Rm9yQWN0aW9uS2V5IGFuZCBub3QgQG1lc3NhZ2VXaW5kb3cuaXNSdW5uaW5nIGFuZCAoSW5wdXQudHJpZ2dlcihJbnB1dC5DKSBvciBJbnB1dC50cmlnZ2VyKElucHV0LkIpKQogICAgICAgICAgSW5wdXQuY2xlYXIoKQogICAgICAgICAgQHdhaXRGb3JBY3Rpb25LZXkgPSBubwogICAgICAgICAgQGlzV2FpdGluZyA9IG5vCiAgICAgICAgICAKICAgICAgICAgIGlmIEBwb2ludGVyID49IEBjb21tYW5kcy5sZW5ndGggb3IgKEBjb21tYW5kc1tAcG9pbnRlcl0uaWQgIT0gImdzLlNob3dNZXNzYWdlIiBhbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBjb21tYW5kc1tAcG9pbnRlcl0uaWQgIT0gImdzLklucHV0TnVtYmVyIiBhbmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBjb21tYW5kc1tAcG9pbnRlcl0uaWQgIT0gImdzLlNob3dDaG9pY2VzIikKICAgICAgICAgICAgICBAbWVzc2FnZVdpbmRvdy5jbG9zZSgpCiAgICAgICovCgogICAgICBpZiAodGhpcy53YWl0Rm9yQWN0aW9uS2V5IHx8IHRoaXMubWVzc2FnZVdpbmRvdy5pc0Nsb3NpbmcpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgX3Jlc3VsdHMgPSBbXTsKICAgICAgd2hpbGUgKCF0aGlzLmlzV2FpdGluZyAmJiB0aGlzLnBvaW50ZXIgPCB0aGlzLmNvbW1hbmRzLmxlbmd0aCkgewogICAgICAgIF9yZXN1bHRzLnB1c2godGhpcy5leGVjdXRlQ29tbWFuZCh0aGlzLnBvaW50ZXIpKTsKICAgICAgfQogICAgICByZXR1cm4gX3Jlc3VsdHM7CiAgICB9OwoKICAgIENvbW1hbmRJbnRlcnByZXRlci5wcm90b3R5cGUuZXhlY3V0ZUNvbW1hbmQgPSBmdW5jdGlvbihpbmRleCkgewogICAgICB0aGlzLmNvbW1hbmQgPSB0aGlzLmNvbW1hbmRzW2luZGV4XTsKICAgICAgaWYgKHRoaXMuY29tbWFuZC5leGVjdXRlICE9IG51bGwpIHsKICAgICAgICB0aGlzLmNvbW1hbmQuaW50ZXJwcmV0ZXIgPSB0aGlzOwogICAgICAgIHRoaXMuY29tbWFuZC5leGVjdXRlKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgc3dpdGNoICh0aGlzLmNvbW1hbmQubm9kZUlkKSB7CiAgICAgICAgICBjYXNlICJncy5XYWl0Q29tbWFuZCI6CiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5leGVjdXRlID0gdGhpcy5jb21tYW5kV2FpdDsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJncy5Mb29wQ29tbWFuZCI6CiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5leGVjdXRlID0gdGhpcy5jb21tYW5kTG9vcDsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJncy5Mb29wRW5kQ29tbWFuZCI6CiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5leGVjdXRlID0gdGhpcy5jb21tYW5kTG9vcEVuZDsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJncy5CcmVha0xvb3BDb21tYW5kIjoKICAgICAgICAgICAgdGhpcy5jb21tYW5kLmV4ZWN1dGUgPSB0aGlzLmNvbW1hbmRCcmVha0xvb3A7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiZ3MuQ29tbWVudCI6CiAgICAgICAgICAgIHRoaXMuY29tbWFuZHMucmVtb3ZlKHRoaXMuY29tbWFuZCk7CiAgICAgICAgICAgIHRoaXMucG9pbnRlci0tOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgImdzLkVtcHR5Q29tbWFuZCI6CiAgICAgICAgICAgIHRoaXMuY29tbWFuZHMucmVtb3ZlKHRoaXMuY29tbWFuZCk7CiAgICAgICAgICAgIHRoaXMucG9pbnRlci0tOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgImdzLk1vdmVFdmVudCI6CiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5leGVjdXRlID0gdGhpcy5jb21tYW5kTW92ZUV2ZW50OwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgImdzLkNoYW5nZU1hcCI6CiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5leGVjdXRlID0gdGhpcy5jb21tYW5kQ2hhbmdlTWFwOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgImdzLkNoYW5nZU51bWJlclZhcmlhYmxlcyI6CiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5leGVjdXRlID0gdGhpcy5jb21tYW5kQ2hhbmdlTnVtYmVyVmFyaWFibGVzOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgImdzLkNoYW5nZUJvb2xlYW5WYXJpYWJsZXMiOgogICAgICAgICAgICB0aGlzLmNvbW1hbmQuZXhlY3V0ZSA9IHRoaXMuY29tbWFuZENoYW5nZUJvb2xlYW5WYXJpYWJsZXM7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiZ3MuQ2hhbmdlU3RyaW5nVmFyaWFibGVzIjoKICAgICAgICAgICAgdGhpcy5jb21tYW5kLmV4ZWN1dGUgPSB0aGlzLmNvbW1hbmRDaGFuZ2VTdHJpbmdWYXJpYWJsZXM7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiZ3MuQ29uZGl0aW9uIjoKICAgICAgICAgICAgdGhpcy5jb21tYW5kLmV4ZWN1dGUgPSB0aGlzLmNvbW1hbmRDb25kaXRpb247CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiZ3MuRWxzZUNhc2UiOgogICAgICAgICAgICB0aGlzLmNvbW1hbmQuZXhlY3V0ZSA9IHRoaXMuY29tbWFuZENvbmRpdGlvbkVsc2VDYXNlOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgImdzLkVuZENvbmRpdGlvbiI6CiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5leGVjdXRlID0gdGhpcy5jb21tYW5kQ29uZGl0aW9uRW5kOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgImdzLkxhYmVsIjoKICAgICAgICAgICAgdGhpcy5jb21tYW5kLmV4ZWN1dGUgPSB0aGlzLmNvbW1hbmRMYWJlbDsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJncy5KdW1wVG9MYWJlbCI6CiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5leGVjdXRlID0gdGhpcy5jb21tYW5kSnVtcFRvTGFiZWw7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiZ3MuU2hvd01lc3NhZ2UiOgogICAgICAgICAgICB0aGlzLmNvbW1hbmQuZXhlY3V0ZSA9IHRoaXMuY29tbWFuZFNob3dNZXNzYWdlOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgImdzLlNob3dCdWJibGVNZXNzYWdlIjoKICAgICAgICAgICAgdGhpcy5jb21tYW5kLmV4ZWN1dGUgPSB0aGlzLmNvbW1hbmRTaG93QnViYmxlTWVzc2FnZTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJncy5DaGFuZ2VJdGVtcyI6CiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5leGVjdXRlID0gdGhpcy5jb21tYW5kQ2hhbmdlSXRlbXM7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiZ3MuQ2hhbmdlV2VhcG9ucyI6CiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5leGVjdXRlID0gdGhpcy5jb21tYW5kQ2hhbmdlV2VhcG9uczsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJncy5DaGFuZ2VBcm1vcnMiOgogICAgICAgICAgICB0aGlzLmNvbW1hbmQuZXhlY3V0ZSA9IHRoaXMuY29tbWFuZENoYW5nZUFybW9yczsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJncy5DaGFuZ2VNb25leSI6CiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5leGVjdXRlID0gdGhpcy5jb21tYW5kQ2hhbmdlTW9uZXk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiZ3MuQ2hhbmdlV2VhdGhlciI6CiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5leGVjdXRlID0gdGhpcy5jb21tYW5kQ2hhbmdlV2VhdGhlcjsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJncy5TaGFrZVNjcmVlbiI6CiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5leGVjdXRlID0gdGhpcy5jb21tYW5kU2hha2VTY3JlZW47CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiZ3MuVGludFNjcmVlbiI6CiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5leGVjdXRlID0gdGhpcy5jb21tYW5kVGludFNjcmVlbjsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJncy5GbGFzaFNjcmVlbiI6CiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5leGVjdXRlID0gdGhpcy5jb21tYW5kRmxhc2hTY3JlZW47CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiZ3MuU2hvd1BpY3R1cmUiOgogICAgICAgICAgICB0aGlzLmNvbW1hbmQuZXhlY3V0ZSA9IHRoaXMuY29tbWFuZFNob3dQaWN0dXJlOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgImdzLk1vdmVQaWN0dXJlIjoKICAgICAgICAgICAgdGhpcy5jb21tYW5kLmV4ZWN1dGUgPSB0aGlzLmNvbW1hbmRNb3ZlUGljdHVyZTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJncy5UaW50UGljdHVyZSI6CiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5leGVjdXRlID0gdGhpcy5jb21tYW5kVGludFBpY3R1cmU7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiZ3MuUm90YXRlUGljdHVyZSI6CiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5leGVjdXRlID0gdGhpcy5jb21tYW5kUm90YXRlUGljdHVyZTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJncy5FcmFzZVBpY3R1cmUiOgogICAgICAgICAgICB0aGlzLmNvbW1hbmQuZXhlY3V0ZSA9IHRoaXMuY29tbWFuZEVyYXNlUGljdHVyZTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJncy5JbnB1dE51bWJlciI6CiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5leGVjdXRlID0gdGhpcy5jb21tYW5kSW5wdXROdW1iZXI7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiZ3MuU2hvd0Nob2ljZXMiOgogICAgICAgICAgICB0aGlzLmNvbW1hbmQuZXhlY3V0ZSA9IHRoaXMuY29tbWFuZFNob3dDaG9pY2VzOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgImdzLkNob2ljZTEiOgogICAgICAgICAgICB0aGlzLmNvbW1hbmQuZXhlY3V0ZSA9IHRoaXMuY29tbWFuZENob2ljZTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJncy5DaG9pY2UyIjoKICAgICAgICAgICAgdGhpcy5jb21tYW5kLmV4ZWN1dGUgPSB0aGlzLmNvbW1hbmRDaG9pY2U7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiZ3MuQ2hvaWNlMyI6CiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5leGVjdXRlID0gdGhpcy5jb21tYW5kQ2hvaWNlOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgImdzLkNob2ljZTQiOgogICAgICAgICAgICB0aGlzLmNvbW1hbmQuZXhlY3V0ZSA9IHRoaXMuY29tbWFuZENob2ljZTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJncy5DaG9pY2VDYW5jZWwiOgogICAgICAgICAgICB0aGlzLmNvbW1hbmQuZXhlY3V0ZSA9IHRoaXMuY29tbWFuZENob2ljZTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJncy5PcGVuTWVudSI6CiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5leGVjdXRlID0gdGhpcy5jb21tYW5kT3Blbk1lbnU7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiZ3MuT3BlblNhdmVNZW51IjoKICAgICAgICAgICAgdGhpcy5jb21tYW5kLmV4ZWN1dGUgPSB0aGlzLmNvbW1hbmRPcGVuU2F2ZU1lbnU7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiZ3MuUmV0dXJuVG9UaXRsZSI6CiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5leGVjdXRlID0gdGhpcy5jb21tYW5kUmV0dXJuVG9UaXRsZTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJncy5HYW1lT3ZlciI6CiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5leGVjdXRlID0gdGhpcy5jb21tYW5kR2FtZU92ZXI7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiZ3MuT3BlblNob3AiOgogICAgICAgICAgICB0aGlzLmNvbW1hbmQuZXhlY3V0ZSA9IHRoaXMuY29tbWFuZE9wZW5TaG9wOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgImdzLkNoYW5nZVdpbmRvd1NraW4iOgogICAgICAgICAgICB0aGlzLmNvbW1hbmQuZXhlY3V0ZSA9IHRoaXMuY29tbWFuZENoYW5nZVdpbmRvd1NraW47CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiZ3MuQ2hhbmdlQWN0b3JHcmFwaGljIjoKICAgICAgICAgICAgdGhpcy5jb21tYW5kLmV4ZWN1dGUgPSB0aGlzLmNvbW1hbmRDaGFuZ2VBY3RvckdyYXBoaWM7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiZ3MuQ2hhbmdlUGFydHkiOgogICAgICAgICAgICB0aGlzLmNvbW1hbmQuZXhlY3V0ZSA9IHRoaXMuY29tbWFuZENoYW5nZVBhcnR5OwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgImdzLkNoYW5nZU1lbnVBY2Nlc3MiOgogICAgICAgICAgICB0aGlzLmNvbW1hbmQuZXhlY3V0ZSA9IHRoaXMuY29tbWFuZENoYW5nZU1lbnVBY2Nlc3M7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiZ3MuQ2hhbmdlU2F2ZU1lbnVBY2Nlc3MiOgogICAgICAgICAgICB0aGlzLmNvbW1hbmQuZXhlY3V0ZSA9IHRoaXMuY29tbWFuZENoYW5nZVNhdmVNZW51QWNjZXNzOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgImdzLkNoYW5nZUFjdG9yTHAiOgogICAgICAgICAgICB0aGlzLmNvbW1hbmQuZXhlY3V0ZSA9IHRoaXMuY29tbWFuZENoYW5nZUFjdG9yTHA7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiZ3MuQ2hhbmdlQWN0b3JNcCI6CiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5leGVjdXRlID0gdGhpcy5jb21tYW5kQ2hhbmdlQWN0b3JNcDsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJncy5DaGFuZ2VBY3RvckV4cCI6CiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5leGVjdXRlID0gdGhpcy5jb21tYW5kQ2hhbmdlQWN0b3JFeHA7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiZ3MuQ2hhbmdlQWN0b3JDbGFzcyI6CiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5leGVjdXRlID0gdGhpcy5jb21tYW5kQ2hhbmdlQWN0b3JDbGFzczsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJncy5DaGFuZ2VBY3Rvck5hbWUiOgogICAgICAgICAgICB0aGlzLmNvbW1hbmQuZXhlY3V0ZSA9IHRoaXMuY29tbWFuZENoYW5nZUFjdG9yTmFtZTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJncy5DaGFuZ2VBY3RvckxldmVsIjoKICAgICAgICAgICAgdGhpcy5jb21tYW5kLmV4ZWN1dGUgPSB0aGlzLmNvbW1hbmRDaGFuZ2VBY3RvckxldmVsOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgImdzLkNoYW5nZUFjdG9yU3RhdGUiOgogICAgICAgICAgICB0aGlzLmNvbW1hbmQuZXhlY3V0ZSA9IHRoaXMuY29tbWFuZENoYW5nZUFjdG9yU3RhdGU7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiZ3MuQ2hhbmdlQWN0b3JTa2lsbHMiOgogICAgICAgICAgICB0aGlzLmNvbW1hbmQuZXhlY3V0ZSA9IHRoaXMuY29tbWFuZENoYW5nZUFjdG9yU2tpbGxzOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgImdzLkNoYW5nZUFjdG9yRXF1aXBtZW50IjoKICAgICAgICAgICAgdGhpcy5jb21tYW5kLmV4ZWN1dGUgPSB0aGlzLmNvbW1hbmRDaGFuZ2VBY3RvckVxdWlwbWVudDsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJncy5DaGFuZ2VBY3RvclBhcmFtZXRlcnMiOgogICAgICAgICAgICB0aGlzLmNvbW1hbmQuZXhlY3V0ZSA9IHRoaXMuY29tbWFuZENoYW5nZUFjdG9yUGFyYW1ldGVyczsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJncy5QbGF5TXVzaWMiOgogICAgICAgICAgICB0aGlzLmNvbW1hbmQuZXhlY3V0ZSA9IHRoaXMuY29tbWFuZFBsYXlNdXNpYzsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJncy5TdG9wTXVzaWMiOgogICAgICAgICAgICB0aGlzLmNvbW1hbmQuZXhlY3V0ZSA9IHRoaXMuY29tbWFuZFN0b3BNdXNpYzsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJncy5QbGF5U291bmQiOgogICAgICAgICAgICB0aGlzLmNvbW1hbmQuZXhlY3V0ZSA9IHRoaXMuY29tbWFuZFBsYXlTb3VuZDsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJncy5QbGF5QmFja2dyb3VuZFNvdW5kIjoKICAgICAgICAgICAgdGhpcy5jb21tYW5kLmV4ZWN1dGUgPSB0aGlzLmNvbW1hbmRQbGF5QmFja2dyb3VuZFNvdW5kOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgImdzLlN0b3BCYWNrZ3JvdW5kU291bmQiOgogICAgICAgICAgICB0aGlzLmNvbW1hbmQuZXhlY3V0ZSA9IHRoaXMuY29tbWFuZFN0b3BCYWNrZ3JvdW5kU291bmQ7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiZ3MuUGF1c2VNdXNpYyI6CiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5leGVjdXRlID0gdGhpcy5jb21tYW5kUGF1c2VNdXNpYzsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJncy5QYXVzZUJhY2tncm91bmRTb3VuZCI6CiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5leGVjdXRlID0gdGhpcy5jb21tYW5kUGF1c2VCYWNrZ3JvdW5kU291bmQ7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiZ3MuUmVzdW1lTXVzaWMiOgogICAgICAgICAgICB0aGlzLmNvbW1hbmQuZXhlY3V0ZSA9IHRoaXMuY29tbWFuZFJlc3VtZU11c2ljOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgImdzLlJlc3VtZUJhY2tncm91bmRTb3VuZCI6CiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5leGVjdXRlID0gdGhpcy5jb21tYW5kUmVzdW1lQmFja2dyb3VuZFNvdW5kOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgImdzLkNoYW5nZU1hcEVuY291bnRlciI6CiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5leGVjdXRlID0gdGhpcy5jb21tYW5kQ2hhbmdlTWFwRW5jb3VudGVyOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgImdzLkNoYW5nZU1hcFRpbGVzZXQiOgogICAgICAgICAgICB0aGlzLmNvbW1hbmQuZXhlY3V0ZSA9IHRoaXMuY29tbWFuZENoYW5nZU1hcFRpbGVzZXQ7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiZ3MuQ2hhbmdlTWFwVGlsZXMiOgogICAgICAgICAgICB0aGlzLmNvbW1hbmQuZXhlY3V0ZSA9IHRoaXMuY29tbWFuZENoYW5nZU1hcFRpbGVzOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgImdzLkNoYW5nZU1hcFBhcmFsbGF4QmFja2dyb3VuZCI6CiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5leGVjdXRlID0gdGhpcy5jb21tYW5kQ2hhbmdlTWFwUGFyYWxsYXhCYWNrZ3JvdW5kOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgImdzLkdldE1hcExvY2F0aW9uSW5mbyI6CiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5leGVjdXRlID0gdGhpcy5jb21tYW5kR2V0TWFwTG9jYXRpb25JbmZvOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgImdzLlN0YXJ0QmF0dGxlIjoKICAgICAgICAgICAgdGhpcy5jb21tYW5kLmV4ZWN1dGUgPSB0aGlzLmNvbW1hbmRTdGFydEJhdHRsZTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJncy5DaGFuZ2VFbmVteUxwIjoKICAgICAgICAgICAgdGhpcy5jb21tYW5kLmV4ZWN1dGUgPSB0aGlzLmNvbW1hbmRDaGFuZ2VFbmVteUxwOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgImdzLkNoYW5nZUVuZW15TXAiOgogICAgICAgICAgICB0aGlzLmNvbW1hbmQuZXhlY3V0ZSA9IHRoaXMuY29tbWFuZENoYW5nZUVuZW15TXA7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiZ3MuQ2hhbmdlRW5lbXlTdGF0ZSI6CiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5leGVjdXRlID0gdGhpcy5jb21tYW5kQ2hhbmdlRW5lbXlTdGF0ZTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJncy5TaG93RW5lbXkiOgogICAgICAgICAgICB0aGlzLmNvbW1hbmQuZXhlY3V0ZSA9IHRoaXMuY29tbWFuZFNob3dFbmVteTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJncy5UcmFuc2Zvcm1FbmVteSI6CiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5leGVjdXRlID0gdGhpcy5jb21tYW5kVHJhbnNmb3JtRW5lbXk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiZ3MuU2hvd0JhdHRsZUFuaW1hdGlvbiI6CiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5leGVjdXRlID0gdGhpcy5jb21tYW5kU2hvd0JhdHRsZUFuaW1hdGlvbjsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJncy5BYm9ydEJhdHRsZSI6CiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5leGVjdXRlID0gdGhpcy5jb21tYW5kQWJvcnRCYXR0bGU7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiZ3MuU2Nyb2xsTWFwIjoKICAgICAgICAgICAgdGhpcy5jb21tYW5kLmV4ZWN1dGUgPSB0aGlzLmNvbW1hbmRTY3JvbGxNYXA7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiZ3MuU2V0RXZlbnRMb2NhdGlvbiI6CiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5leGVjdXRlID0gdGhpcy5jb21tYW5kU2V0RXZlbnRMb2NhdGlvbjsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJncy5TZXRHbG9iYWxFdmVudExvY2F0aW9uIjoKICAgICAgICAgICAgdGhpcy5jb21tYW5kLmV4ZWN1dGUgPSB0aGlzLmNvbW1hbmRTZXRHbG9iYWxFdmVudExvY2F0aW9uOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgImdzLkNyZWF0ZUV2ZW50IjoKICAgICAgICAgICAgdGhpcy5jb21tYW5kLmV4ZWN1dGUgPSB0aGlzLmNvbW1hbmRDcmVhdGVFdmVudDsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJncy5FcmFzZUV2ZW50IjoKICAgICAgICAgICAgdGhpcy5jb21tYW5kLmV4ZWN1dGUgPSB0aGlzLmNvbW1hbmRFcmFzZUV2ZW50OwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgImdzLkVuZEV2ZW50IjoKICAgICAgICAgICAgdGhpcy5jb21tYW5kLmV4ZWN1dGUgPSB0aGlzLmNvbW1hbmRFbmRFdmVudDsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJncy5DYWxsQ29tbW9uRXZlbnQiOgogICAgICAgICAgICB0aGlzLmNvbW1hbmQuZXhlY3V0ZSA9IHRoaXMuY29tbWFuZENhbGxDb21tb25FdmVudDsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJncy5DaGFuZ2VUaW1lciI6CiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5leGVjdXRlID0gdGhpcy5jb21tYW5kQ2hhbmdlVGltZXI7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiZ3MuU2hvd0FuaW1hdGlvbiI6CiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5leGVjdXRlID0gdGhpcy5jb21tYW5kU2hvd0FuaW1hdGlvbk1hcEV2ZW50OwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgImdzLlNob3dUZXh0IjoKICAgICAgICAgICAgdGhpcy5jb21tYW5kLmV4ZWN1dGUgPSB0aGlzLmNvbW1hbmRTaG93VGV4dDsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJncy5Nb3ZlVGV4dCI6CiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5leGVjdXRlID0gdGhpcy5jb21tYW5kTW92ZVRleHQ7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiZ3MuUm90YXRlVGV4dCI6CiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5leGVjdXRlID0gdGhpcy5jb21tYW5kUm90YXRlVGV4dDsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJncy5Db2xvclRleHQiOgogICAgICAgICAgICB0aGlzLmNvbW1hbmQuZXhlY3V0ZSA9IHRoaXMuY29tbWFuZENvbG9yVGV4dDsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJncy5FcmFzZVRleHQiOgogICAgICAgICAgICB0aGlzLmNvbW1hbmQuZXhlY3V0ZSA9IHRoaXMuY29tbWFuZEVyYXNlVGV4dDsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJncy5DaGFuZ2VUZXh0U2V0dGluZ3MiOgogICAgICAgICAgICB0aGlzLmNvbW1hbmQuZXhlY3V0ZSA9IHRoaXMuY29tbWFuZENoYW5nZVRleHRTZXR0aW5nczsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJncy5JbnB1dFRleHQiOgogICAgICAgICAgICB0aGlzLmNvbW1hbmQuZXhlY3V0ZSA9IHRoaXMuY29tbWFuZElucHV0VGV4dDsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJncy5JbnB1dE5hbWUiOgogICAgICAgICAgICB0aGlzLmNvbW1hbmQuZXhlY3V0ZSA9IHRoaXMuY29tbWFuZElucHV0TmFtZTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJncy5DaGFuZ2VQbGF5ZXIiOgogICAgICAgICAgICB0aGlzLmNvbW1hbmQuZXhlY3V0ZSA9IHRoaXMuY29tbWFuZENoYW5nZVBsYXllcjsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJncy5DaGFuZ2VHbG9iYWxFdmVudFZpc2liaWxpdHkiOgogICAgICAgICAgICB0aGlzLmNvbW1hbmQuZXhlY3V0ZSA9IHRoaXMuY29tbWFuZENoYW5nZUdsb2JhbEV2ZW50VmlzaWJpbGl0eTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJncy5TY3JpcHQiOgogICAgICAgICAgICB0aGlzLmNvbW1hbmQuZXhlY3V0ZSA9IHRoaXMuY29tbWFuZFNjcmlwdDsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJncy5Gb3JjZUFjdGlvbiI6CiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5leGVjdXRlID0gdGhpcy5jb21tYW5kRm9yY2VBY3Rpb247CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiZ3MuQ2hhbmdlQmF0dGxlTXVzaWMiOgogICAgICAgICAgICB0aGlzLmNvbW1hbmQuZXhlY3V0ZSA9IHRoaXMuY29tbWFuZENoYW5nZUJhdHRsZU11c2ljOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgImdzLkNoYW5nZUJhdHRsZVRlcnJhaW4iOgogICAgICAgICAgICB0aGlzLmNvbW1hbmQuZXhlY3V0ZSA9IHRoaXMuY29tbWFuZENoYW5nZUJhdHRsZVRlcnJhaW47CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiZ3MuTW92ZUdsb2JhbEV2ZW50IjoKICAgICAgICAgICAgdGhpcy5jb21tYW5kLmV4ZWN1dGUgPSB0aGlzLmNvbW1hbmRNb3ZlR2xvYmFsRXZlbnQ7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiZ3MuRXJhc2VHbG9iYWxFdmVudCI6CiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5leGVjdXRlID0gdGhpcy5jb21tYW5kRXJhc2VHbG9iYWxFdmVudDsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJncy5FbmRHbG9iYWxFdmVudCI6CiAgICAgICAgICAgIHRoaXMuY29tbWFuZC5leGVjdXRlID0gdGhpcy5jb21tYW5kRW5kR2xvYmFsRXZlbnQ7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiZ3MuU2hvd0FuaW1hdGlvbkdsb2JhbEV2ZW50IjoKICAgICAgICAgICAgdGhpcy5jb21tYW5kLmV4ZWN1dGUgPSB0aGlzLmNvbW1hbmRTaG93QW5pbWF0aW9uR2xvYmFsRXZlbnQ7CiAgICAgICAgfQogICAgICAgIGlmICh0aGlzLmNvbW1hbmQuZXhlY3V0ZSAhPSBudWxsKSB7CiAgICAgICAgICB0aGlzLmNvbW1hbmQuaW50ZXJwcmV0ZXIgPSB0aGlzOwogICAgICAgICAgdGhpcy5jb21tYW5kLmV4ZWN1dGUoKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHRoaXMucG9pbnRlcisrOwogICAgfTsKCiAgICBDb21tYW5kSW50ZXJwcmV0ZXIucHJvdG90eXBlLnNraXAgPSBmdW5jdGlvbihpbmRlbnQsIGJhY2t3YXJkKSB7CiAgICAgIHZhciBfcmVzdWx0cywgX3Jlc3VsdHMxOwogICAgICBpZiAoYmFja3dhcmQpIHsKICAgICAgICB0aGlzLnBvaW50ZXItLTsKICAgICAgICBfcmVzdWx0cyA9IFtdOwogICAgICAgIHdoaWxlICh0aGlzLnBvaW50ZXIgPiAwICYmIHRoaXMuY29tbWFuZHNbdGhpcy5wb2ludGVyXS5pbmRlbnQgIT09IGluZGVudCkgewogICAgICAgICAgX3Jlc3VsdHMucHVzaCh0aGlzLnBvaW50ZXItLSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBfcmVzdWx0czsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnBvaW50ZXIrKzsKICAgICAgICBfcmVzdWx0czEgPSBbXTsKICAgICAgICB3aGlsZSAodGhpcy5wb2ludGVyIDwgdGhpcy5jb21tYW5kLmxlbmd0aCAmJiB0aGlzLmNvbW1hbmRzW3RoaXMucG9pbnRlcl0uaW5kZW50ICE9PSBpbmRlbnQpIHsKICAgICAgICAgIF9yZXN1bHRzMS5wdXNoKHRoaXMucG9pbnRlcisrKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIF9yZXN1bHRzMTsKICAgICAgfQogICAgfTsKCiAgICBDb21tYW5kSW50ZXJwcmV0ZXIucHJvdG90eXBlLmdvVG9OZXh0Tm9kZSA9IGZ1bmN0aW9uKG5vZGVJZCwgaW5kZW50KSB7CiAgICAgIHZhciBfcmVzdWx0czsKICAgICAgdGhpcy5za2lwKGluZGVudCk7CiAgICAgIF9yZXN1bHRzID0gW107CiAgICAgIHdoaWxlICh0aGlzLnBvaW50ZXIgPCB0aGlzLmNvbW1hbmRzLmxlbmd0aCAmJiB0aGlzLmNvbW1hbmRzW3RoaXMucG9pbnRlcl0ubm9kZUlkICE9PSBub2RlSWQpIHsKICAgICAgICBfcmVzdWx0cy5wdXNoKHRoaXMuc2tpcChpbmRlbnQpKTsKICAgICAgfQogICAgICByZXR1cm4gX3Jlc3VsdHM7CiAgICB9OwoKICAgIENvbW1hbmRJbnRlcnByZXRlci5wcm90b3R5cGUubnVtYmVyVmFsdWVBdEluZGV4ID0gZnVuY3Rpb24oc2NvcGUsIGluZGV4KSB7CiAgICAgIHJldHVybiBHYW1lTWFuYWdlci52YXJpYWJsZVN0b3JlLm51bWJlclZhbHVlQXRJbmRleChzY29wZSwgaW5kZXgpOwogICAgfTsKCiAgICBDb21tYW5kSW50ZXJwcmV0ZXIucHJvdG90eXBlLm51bWJlclZhbHVlT2YgPSBmdW5jdGlvbihvYmplY3QpIHsKICAgICAgcmV0dXJuIEdhbWVNYW5hZ2VyLnZhcmlhYmxlU3RvcmUubnVtYmVyVmFsdWVPZihvYmplY3QpOwogICAgfTsKCiAgICBDb21tYW5kSW50ZXJwcmV0ZXIucHJvdG90eXBlLnNldE51bWJlclZhbHVlQXRJbmRleCA9IGZ1bmN0aW9uKHNjb3BlLCBpbmRleCwgdmFsdWUpIHsKICAgICAgcmV0dXJuIEdhbWVNYW5hZ2VyLnZhcmlhYmxlU3RvcmUuc2V0TnVtYmVyVmFsdWVBdEluZGV4KHNjb3BlLCBpbmRleCwgdmFsdWUpOwogICAgfTsKCiAgICBDb21tYW5kSW50ZXJwcmV0ZXIucHJvdG90eXBlLnNldE51bWJlclZhbHVlVG8gPSBmdW5jdGlvbih2YXJpYWJsZSwgdmFsdWUpIHsKICAgICAgcmV0dXJuIEdhbWVNYW5hZ2VyLnZhcmlhYmxlU3RvcmUuc2V0TnVtYmVyVmFsdWVUbyh2YXJpYWJsZSwgdmFsdWUpOwogICAgfTsKCiAgICBDb21tYW5kSW50ZXJwcmV0ZXIucHJvdG90eXBlLnNldEJvb2xlYW5WYWx1ZVRvID0gZnVuY3Rpb24odmFyaWFibGUsIHZhbHVlKSB7CiAgICAgIHJldHVybiBHYW1lTWFuYWdlci52YXJpYWJsZVN0b3JlLnNldEJvb2xlYW5WYWx1ZVRvKHZhcmlhYmxlLCB2YWx1ZSk7CiAgICB9OwoKICAgIENvbW1hbmRJbnRlcnByZXRlci5wcm90b3R5cGUuc2V0U3RyaW5nVmFsdWVUbyA9IGZ1bmN0aW9uKHZhcmlhYmxlLCB2YWx1ZSkgewogICAgICByZXR1cm4gR2FtZU1hbmFnZXIudmFyaWFibGVTdG9yZS5zZXRTdHJpbmdWYWx1ZVRvKHZhcmlhYmxlLCB2YWx1ZSk7CiAgICB9OwoKICAgIENvbW1hbmRJbnRlcnByZXRlci5wcm90b3R5cGUuc3RyaW5nVmFsdWVPZiA9IGZ1bmN0aW9uKG9iamVjdCkgewogICAgICByZXR1cm4gR2FtZU1hbmFnZXIudmFyaWFibGVTdG9yZS5zdHJpbmdWYWx1ZU9mKG9iamVjdCk7CiAgICB9OwoKICAgIENvbW1hbmRJbnRlcnByZXRlci5wcm90b3R5cGUuYm9vbGVhblZhbHVlT2YgPSBmdW5jdGlvbihvYmplY3QpIHsKICAgICAgcmV0dXJuIEdhbWVNYW5hZ2VyLnZhcmlhYmxlU3RvcmUuYm9vbGVhblZhbHVlT2Yob2JqZWN0KTsKICAgIH07CgogICAgQ29tbWFuZEludGVycHJldGVyLnByb3RvdHlwZS5jb21wYXJlID0gZnVuY3Rpb24oYSwgYiwgb3BlcmF0aW9uKSB7CiAgICAgIHN3aXRjaCAob3BlcmF0aW9uKSB7CiAgICAgICAgY2FzZSAwOgogICAgICAgICAgcmV0dXJuIGEgPT09IGI7CiAgICAgICAgY2FzZSAxOgogICAgICAgICAgcmV0dXJuIGEgIT09IGI7CiAgICAgICAgY2FzZSAyOgogICAgICAgICAgcmV0dXJuIGEgPiBiOwogICAgICAgIGNhc2UgMzoKICAgICAgICAgIHJldHVybiBhID49IGI7CiAgICAgICAgY2FzZSA0OgogICAgICAgICAgcmV0dXJuIGEgPCBiOwogICAgICAgIGNhc2UgNToKICAgICAgICAgIHJldHVybiBhIDw9IGI7CiAgICAgIH0KICAgIH07CgogICAgQ29tbWFuZEludGVycHJldGVyLnByb3RvdHlwZS5ldmVudEJ5SWQgPSBmdW5jdGlvbihpZCkgewogICAgICB2YXIgZXZlbnQ7CiAgICAgIGV2ZW50ID0gbnVsbDsKICAgICAgaWYgKGlkID09PSAtMSkgewogICAgICAgIGV2ZW50ID0gR2FtZU1hbmFnZXIubWFwLmN1cnJlbnRFdmVudDsKICAgICAgfSBlbHNlIGlmIChpZCA9PT0gLTIpIHsKICAgICAgICBldmVudCA9IEdhbWVNYW5hZ2VyLnBsYXllcjsKICAgICAgfSBlbHNlIHsKICAgICAgICBldmVudCA9IEdhbWVNYW5hZ2VyLm1hcC5ldmVudHNCeUlkW2lkXTsKICAgICAgfQogICAgICByZXR1cm4gZXZlbnQ7CiAgICB9OwoKICAgIENvbW1hbmRJbnRlcnByZXRlci5wcm90b3R5cGUuZ2xvYmFsRXZlbnRCeUlkID0gZnVuY3Rpb24oaWQpIHsKICAgICAgdmFyIGV2ZW50OwogICAgICBldmVudCA9IG51bGw7CiAgICAgIGV2ZW50ID0gR2FtZU1hbmFnZXIuZ2xvYmFsRXZlbnRzQnlJZFtpZF07CiAgICAgIHJldHVybiBldmVudDsKICAgIH07CgogICAgQ29tbWFuZEludGVycHJldGVyLnByb3RvdHlwZS5udW1iZXJWYWx1ZU9mR2FtZURhdGEgPSBmdW5jdGlvbihnYW1lRGF0YSkgewogICAgICB2YXIgZGF0ZSwgZW5lbXksIGV2ZW50LCBpbnZJdGVtLCBpdGVtLCBtZW1iZXIsIHRpbWVyLCB2YWx1ZTsKICAgICAgdmFsdWUgPSAwOwogICAgICBzd2l0Y2ggKGdhbWVEYXRhLmNvZGUpIHsKICAgICAgICBjYXNlIDA6CiAgICAgICAgICBtZW1iZXIgPSBHYW1lTWFuYWdlci5wYXJ0eS5tZW1iZXJXaXRoSWQodGhpcy5udW1iZXJWYWx1ZU9mKGdhbWVEYXRhLnZhbHVlMSkpOwogICAgICAgICAgaWYgKG1lbWJlciAhPSBudWxsKSB7CiAgICAgICAgICAgIHN3aXRjaCAoZ2FtZURhdGEudmFsdWUxKSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgdmFsdWUgPSBtZW1iZXIubHA7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgICB2YWx1ZSA9IG1lbWJlci5tcDsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgIHZhbHVlID0gbWVtYmVyLmxldmVsOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgdmFsdWUgPSBtZW1iZXIuZXhwOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgICAgdmFsdWUgPSAwOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgIHZhbHVlID0gbWVtYmVyLnBhcmFtZXRlcihnYW1lRGF0YS52YWx1ZTEgLSA1KTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAxOgogICAgICAgICAgc3dpdGNoIChnYW1lRGF0YS52YWx1ZTEpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIHZhbHVlID0gR2FtZU1hbmFnZXIucGFydHkubWVtYmVycy5sZW5ndGg7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICB2YWx1ZSA9IEdhbWVNYW5hZ2VyLnBhcnR5LmxldmVsKCk7CiAgICAgICAgICB9CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDI6CiAgICAgICAgICBtZW1iZXIgPSBHYW1lTWFuYWdlci5wYXJ0eS5tZW1iZXJzW3RoaXMubnVtYmVyVmFsdWVPZihnYW1lRGF0YS52YWx1ZTEpXTsKICAgICAgICAgIGlmIChtZW1iZXIgIT0gbnVsbCkgewogICAgICAgICAgICBzd2l0Y2ggKGdhbWVEYXRhLnZhbHVlMikgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIHZhbHVlID0gbWVtYmVyLmxwOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgICAgdmFsdWUgPSBtZW1iZXIubXA7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICB2YWx1ZSA9IG1lbWJlci5sZXZlbDsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIHZhbHVlID0gbWVtYmVyLmV4cDsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgIHZhbHVlID0gMDsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICB2YWx1ZSA9IG1lbWJlci5wYXJhbWV0ZXIoZ2FtZURhdGEudmFsdWUyIC0gNSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgMzoKICAgICAgICAgIGlmIChTY2VuZU1hbmFnZXIuc2NlbmUgaW5zdGFuY2VvZiBTY2VuZV9CYXR0bGUpIHsKICAgICAgICAgICAgZW5lbXkgPSBTY2VuZU1hbmFnZXIuc2NlbmUuZW5lbWllc1t0aGlzLm51bWJlclZhbHVlT2YoZ2FtZURhdGEudmFsdWUxKV07CiAgICAgICAgICAgIGlmIChlbmVteSAhPSBudWxsKSB7CiAgICAgICAgICAgICAgc3dpdGNoIChnYW1lRGF0YS52YWx1ZTIpIHsKICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgdmFsdWUgPSBlbmVteS5scDsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgICAgIHZhbHVlID0gZW5lbXkubXA7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgdmFsdWUgPSBlbmVteS5wYXJhbWV0ZXIoZ2FtZURhdGEudmFsdWUyIC0gMik7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDQ6CiAgICAgICAgICBpdGVtID0gUmVjb3JkTWFuYWdlci5pdGVtc1t0aGlzLm51bWJlclZhbHVlT2YoZ2FtZURhdGEudmFsdWUxKV07CiAgICAgICAgICBpZiAoaXRlbSAhPSBudWxsKSB7CiAgICAgICAgICAgIGludkl0ZW0gPSBHYW1lTWFuYWdlci5pbnZlbnRvcnkuaXRlbXNbaXRlbS5pbmRleF07CiAgICAgICAgICAgIHN3aXRjaCAoZ2FtZURhdGEudmFsdWUyKSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgdmFsdWUgPSBpbnZJdGVtICE9IG51bGwgPyBpbnZJdGVtLmNvdW50IDogMDsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICAgIHZhbHVlID0gaXRlbS5wcmljZTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSA1OgogICAgICAgICAgaXRlbSA9IFJlY29yZE1hbmFnZXIud2VhcG9uc1t0aGlzLm51bWJlclZhbHVlT2YoZ2FtZURhdGEudmFsdWUxKV07CiAgICAgICAgICBpZiAoaXRlbSAhPSBudWxsKSB7CiAgICAgICAgICAgIGludkl0ZW0gPSBHYW1lTWFuYWdlci5pbnZlbnRvcnkud2VhcG9uc1tpdGVtLmluZGV4XTsKICAgICAgICAgICAgc3dpdGNoIChnYW1lRGF0YS52YWx1ZTIpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICB2YWx1ZSA9IGludkl0ZW0gIT0gbnVsbCA/IGludkl0ZW0uY291bnQgOiAwOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgICAgdmFsdWUgPSBpdGVtLnByaWNlOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDY6CiAgICAgICAgICBpdGVtID0gUmVjb3JkTWFuYWdlci5hcm1vcnNbdGhpcy5udW1iZXJWYWx1ZU9mKGdhbWVEYXRhLnZhbHVlMSldOwogICAgICAgICAgaWYgKGl0ZW0gIT0gbnVsbCkgewogICAgICAgICAgICBpbnZJdGVtID0gR2FtZU1hbmFnZXIuaW52ZW50b3J5LmFybW9yc1tpdGVtLmluZGV4XTsKICAgICAgICAgICAgc3dpdGNoIChnYW1lRGF0YS52YWx1ZTIpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICB2YWx1ZSA9IGludkl0ZW0gIT0gbnVsbCA/IGludkl0ZW0uY291bnQgOiAwOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgICAgdmFsdWUgPSBpdGVtLnByaWNlOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDc6CiAgICAgICAgICBpZiAoU2NlbmVNYW5hZ2VyLnNjZW5lIGluc3RhbmNlb2YgU2NlbmVfTWFwKSB7CiAgICAgICAgICAgIHN3aXRjaCAoZ2FtZURhdGEudmFsdWUxKSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgdmFsdWUgPSAwOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgICAgdmFsdWUgPSBHYW1lTWFuYWdlci5tYXAud2lkdGg7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICB2YWx1ZSA9IEdhbWVNYW5hZ2VyLm1hcC5oZWlnaHQ7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICB2YWx1ZSA9IEdhbWVNYW5hZ2VyLm1hcC5kZXB0aDsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSA4OgogICAgICAgICAgZXZlbnQgPSB0aGlzLmV2ZW50QnlJZCh0aGlzLm51bWJlclZhbHVlT2YoZ2FtZURhdGEudmFsdWUxKSk7CiAgICAgICAgICBpZiAoZXZlbnQgIT0gbnVsbCkgewogICAgICAgICAgICBzd2l0Y2ggKGdhbWVEYXRhLnZhbHVlMikgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIHZhbHVlID0gZXZlbnQuaWQ7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgICB2YWx1ZSA9IGV2ZW50LnR4KCk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICB2YWx1ZSA9IGV2ZW50LnR5KCk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICB2YWx1ZSA9IGV2ZW50LmRpcmVjdGlvbjsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSA5OgogICAgICAgICAgZXZlbnQgPSB0aGlzLmdsb2JhbEV2ZW50QnlJZCh0aGlzLm51bWJlclZhbHVlT2YoZ2FtZURhdGEudmFsdWUxKSk7CiAgICAgICAgICBpZiAoZXZlbnQgIT0gbnVsbCkgewogICAgICAgICAgICBzd2l0Y2ggKGdhbWVEYXRhLnZhbHVlMikgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIHZhbHVlID0gZXZlbnQuaWQ7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgICB2YWx1ZSA9IGV2ZW50LnR4KCk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICB2YWx1ZSA9IGV2ZW50LnR5KCk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICB2YWx1ZSA9IGV2ZW50LmRpcmVjdGlvbjsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAxMDoKICAgICAgICAgIHRpbWVyID0gR2FtZU1hbmFnZXIudGltZXI7CiAgICAgICAgICB2YWx1ZSA9IHRpbWVyLm1pbnV0ZXMgKiA2MCArIHRpbWVyLnNlY29uZHM7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDExOgogICAgICAgICAgZGF0ZSA9IG5ldyBEYXRlKCk7CiAgICAgICAgICBzd2l0Y2ggKGdhbWVEYXRhLnZhbHVlMSkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgdmFsdWUgPSBkYXRlLmdldEZ1bGxZZWFyKCk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICB2YWx1ZSA9IGRhdGUuZ2V0TW9udGgoKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgIHZhbHVlID0gMDsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgIHZhbHVlID0gZGF0ZS5nZXREYXkoKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgIHZhbHVlID0gMDsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgIHZhbHVlID0gZGF0ZS5nZXRIb3VycygpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgdmFsdWUgPSBkYXRlLmdldE1pbnV0ZXMoKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgIHZhbHVlID0gZGF0ZS5nZXRTZWNvbmRzKCk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICB2YWx1ZSA9IGRhdGUuZ2V0TWlsbGlzZWNvbmRzKCk7CiAgICAgICAgICB9CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDEyOgogICAgICAgICAgc3dpdGNoIChnYW1lRGF0YS52YWx1ZTEpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIHZhbHVlID0gSW5wdXQua2V5c1tJbnB1dC5ET1dOXTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgIHZhbHVlID0gSW5wdXQua2V5c1tJbnB1dC5MRUZUXTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgIHZhbHVlID0gSW5wdXQua2V5c1tJbnB1dC5VUF07CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICB2YWx1ZSA9IElucHV0LmtleXNbSW5wdXQuUklHSFRdOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgdmFsdWUgPSBJbnB1dC5rZXlzW0lucHV0LkFdOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgdmFsdWUgPSBJbnB1dC5rZXlzW0lucHV0LkJdOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgdmFsdWUgPSBJbnB1dC5rZXlzW0lucHV0LlhdOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgdmFsdWUgPSBJbnB1dC5rZXlzW0lucHV0LlldOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgdmFsdWUgPSBJbnB1dC5rZXlzW0lucHV0LlNUQVJUXTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgIHZhbHVlID0gSW5wdXQua2V5c1tJbnB1dC5TRUxFQ1RdOwogICAgICAgICAgfQogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAxMzoKICAgICAgICAgIHN3aXRjaCAoZ2FtZURhdGEudmFsdWUxKSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICB2YWx1ZSA9IElucHV0Lk1vdXNlLmJ1dHRvbnNbSW5wdXQuTW91c2UuTEVGVF07CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICB2YWx1ZSA9IElucHV0Lk1vdXNlLmJ1dHRvbnNbSW5wdXQuTW91c2UuTUlERExFXTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgIHZhbHVlID0gSW5wdXQuTW91c2UuYnV0dG9uc1tJbnB1dC5Nb3VzZS5SSUdIVF07CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICB2YWx1ZSA9IElucHV0Lk1vdXNlLndoZWVsOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgdmFsdWUgPSBJbnB1dC5Nb3VzZS54OwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgdmFsdWUgPSBJbnB1dC5Nb3VzZS55OwogICAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiB2YWx1ZTsKICAgIH07CgogICAgQ29tbWFuZEludGVycHJldGVyLnByb3RvdHlwZS5jb21tYW5kV2FpdCA9IGZ1bmN0aW9uKCkgewogICAgICB0aGlzLmludGVycHJldGVyLndhaXRDb3VudGVyID0gdGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKHRoaXMucGFyYW1zLnRpbWUpOwogICAgICByZXR1cm4gdGhpcy5pbnRlcnByZXRlci5pc1dhaXRpbmcgPSB0cnVlOwogICAgfTsKCiAgICBDb21tYW5kSW50ZXJwcmV0ZXIucHJvdG90eXBlLmNvbW1hbmRMb29wID0gZnVuY3Rpb24oKSB7fTsKCiAgICBDb21tYW5kSW50ZXJwcmV0ZXIucHJvdG90eXBlLmNvbW1hbmRMb29wRW5kID0gZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiB0aGlzLmludGVycHJldGVyLnNraXAodGhpcy5pbmRlbnQsIHRydWUpOwogICAgfTsKCiAgICBDb21tYW5kSW50ZXJwcmV0ZXIucHJvdG90eXBlLmNvbW1hbmRCcmVha0xvb3AgPSBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIHRoaXMuaW50ZXJwcmV0ZXIuc2tpcCh0aGlzLmNvbW1hbmQuaW5kZW50IC0gMSk7CiAgICB9OwoKICAgIENvbW1hbmRJbnRlcnByZXRlci5wcm90b3R5cGUuY29tbWFuZE1vdmVFdmVudCA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgZXZlbnQsIGlkLAogICAgICAgIF90aGlzID0gdGhpczsKICAgICAgaWQgPSB0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMuZXZlbnQpOwogICAgICBldmVudCA9IG51bGw7CiAgICAgIGlmIChpZCA9PT0gLTEpIHsKICAgICAgICBldmVudCA9IEdhbWVNYW5hZ2VyLm1hcC5jdXJyZW50RXZlbnQ7CiAgICAgIH0gZWxzZSBpZiAoaWQgPT09IC0yKSB7CiAgICAgICAgZXZlbnQgPSBHYW1lTWFuYWdlci5wbGF5ZXI7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZXZlbnQgPSBHYW1lTWFuYWdlci5tYXAuZXZlbnRzQnlJZFtpZF07CiAgICAgIH0KICAgICAgaWYgKGV2ZW50ICE9IG51bGwpIHsKICAgICAgICBldmVudC5tb3ZlUm91dGUodGhpcy5wYXJhbXMpOwogICAgICAgIGlmICh0aGlzLnBhcmFtcy53YWl0Rm9yQ29tcGxldGlvbikgewogICAgICAgICAgZXZlbnQub25Sb3V0ZUZpbmlzaCA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICBfdGhpcy5pbnRlcnByZXRlci5pc1dhaXRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgZXZlbnQub25Sb3V0ZUZpbmlzaCA9IG51bGw7CiAgICAgICAgICAgIHJldHVybiBldmVudC5tb3ZlUm91dGUoZXZlbnQuYXV0b01vdmVtZW50Um91dGUpOwogICAgICAgICAgfTsKICAgICAgICAgIHJldHVybiB0aGlzLmludGVycHJldGVyLmlzV2FpdGluZyA9IHRydWU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVybiBldmVudC5vblJvdXRlRmluaXNoID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIGV2ZW50Lm9uUm91dGVGaW5pc2ggPSBudWxsOwogICAgICAgICAgICByZXR1cm4gZXZlbnQubW92ZVJvdXRlKGV2ZW50LmF1dG9Nb3ZlbWVudFJvdXRlKTsKICAgICAgICAgIH07CiAgICAgICAgfQogICAgICB9CiAgICB9OwoKICAgIENvbW1hbmRJbnRlcnByZXRlci5wcm90b3R5cGUuY29tbWFuZENoYW5nZU1hcCA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgbG9jYXRpb24sIG1hcDsKICAgICAgc3dpdGNoICh0aGlzLnBhcmFtcy5sb2NhdGlvblR5cGUpIHsKICAgICAgICBjYXNlIDA6CiAgICAgICAgICBtYXAgPSB0aGlzLnBhcmFtcy5kaXJlY3RNYXAubWFwOwogICAgICAgICAgbG9jYXRpb24gPSB0aGlzLnBhcmFtcy5kaXJlY3RNYXAubG9jYXRpb247CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDE6CiAgICAgICAgICBtYXAgPSB7CiAgICAgICAgICAgIHVpZDogdGhpcy5pbnRlcnByZXRlci5zdHJpbmdWYWx1ZU9mKHRoaXMucGFyYW1zLm1hcC51aWQpCiAgICAgICAgICB9OwogICAgICAgICAgbG9jYXRpb24gPSB7CiAgICAgICAgICAgIHg6IHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy5sb2NhdGlvbi54KSwKICAgICAgICAgICAgeTogdGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKHRoaXMucGFyYW1zLmxvY2F0aW9uLnkpCiAgICAgICAgICB9OwogICAgICB9CiAgICAgIGlmIChtYXAudWlkID09PSBHYW1lTWFuYWdlci5jdXJyZW50TWFwSWQpIHsKICAgICAgICByZXR1cm4gdGhpcy5pbnRlcnByZXRlci5zZXRFdmVudExvY2F0aW9uKEdhbWVNYW5hZ2VyLnBsYXllciwgewogICAgICAgICAgeDogbG9jYXRpb24ueCwKICAgICAgICAgIHk6IGxvY2F0aW9uLnksCiAgICAgICAgICBjaGFuZ2VEaXJlY3Rpb246IGZhbHNlCiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSBpZiAobWFwLnVpZCAhPT0gIiIgJiYgbWFwLnVpZCAhPT0gR2FtZU1hbmFnZXIuY3VycmVudE1hcElkKSB7CiAgICAgICAgR2FtZU1hbmFnZXIucGxheWVyLmV2ZW50LnggPSBsb2NhdGlvbi54OwogICAgICAgIEdhbWVNYW5hZ2VyLnBsYXllci5ldmVudC55ID0gbG9jYXRpb24ueTsKICAgICAgICBHYW1lTWFuYWdlci5wbGF5ZXIubWFwVWlkID0gbWFwLnVpZDsKICAgICAgICBHYW1lTWFuYWdlci5wbGF5ZXIubWFwSWQgPSBtYXAudWlkOwogICAgICAgIEdhbWVNYW5hZ2VyLnBsYXllci5pc1BsYXllciA9IHRydWU7CiAgICAgICAgR2FtZU1hbmFnZXIucGxheWVyLmlzTW92aW5nID0gZmFsc2U7CiAgICAgICAgR2FtZU1hbmFnZXIuY3VycmVudE1hcElkID0gbWFwLnVpZDsKICAgICAgICBJbnB1dC5jbGVhcigpOwogICAgICAgIHJldHVybiBTY2VuZU1hbmFnZXIuc3dpdGNoVG8obmV3IFNjZW5lX01hcCgpKTsKICAgICAgfQogICAgfTsKCiAgICBDb21tYW5kSW50ZXJwcmV0ZXIucHJvdG90eXBlLmNvbW1hbmRDaGFuZ2VOdW1iZXJWYXJpYWJsZXMgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGRpZmYsIGVuZCwgaSwgaW5kZXgsIHNjb3BlLCBzb3VyY2UsIHN0YXJ0LCBfaTsKICAgICAgc291cmNlID0gMDsKICAgICAgc3dpdGNoICh0aGlzLnBhcmFtcy5zb3VyY2UpIHsKICAgICAgICBjYXNlIDA6CiAgICAgICAgICBzb3VyY2UgPSB0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMuc291cmNlVmFsdWUxKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgMToKICAgICAgICAgIHN0YXJ0ID0gdGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKHRoaXMucGFyYW1zLnNvdXJjZVZhbHVlMSk7CiAgICAgICAgICBlbmQgPSB0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMuc291cmNlVmFsdWUyKTsKICAgICAgICAgIGRpZmYgPSBlbmQgLSBzdGFydDsKICAgICAgICAgIHNvdXJjZSA9IE1hdGguZmxvb3Ioc3RhcnQgKyBNYXRoLnJhbmRvbSgpICogKGRpZmYgKyAxKSk7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDI6CiAgICAgICAgICBzb3VyY2UgPSB0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlQXRJbmRleCh0aGlzLnBhcmFtcy5zb3VyY2VWYWx1ZTEsIHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy5zb3VyY2VWYWx1ZTIpIC0gMSk7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDM6CiAgICAgICAgICBzb3VyY2UgPSB0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2ZHYW1lRGF0YSh0aGlzLnBhcmFtcy5zb3VyY2VWYWx1ZTEpOwogICAgICB9CiAgICAgIHN3aXRjaCAodGhpcy5wYXJhbXMudGFyZ2V0KSB7CiAgICAgICAgY2FzZSAwOgogICAgICAgICAgc3dpdGNoICh0aGlzLnBhcmFtcy5vcGVyYXRpb24pIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIHRoaXMuaW50ZXJwcmV0ZXIuc2V0TnVtYmVyVmFsdWVUbyh0aGlzLnBhcmFtcy50YXJnZXRWYWx1ZTEsIHNvdXJjZSk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICB0aGlzLmludGVycHJldGVyLnNldE51bWJlclZhbHVlVG8odGhpcy5wYXJhbXMudGFyZ2V0VmFsdWUxLCB0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMudGFyZ2V0VmFsdWUxKSArIHNvdXJjZSk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICB0aGlzLmludGVycHJldGVyLnNldE51bWJlclZhbHVlVG8odGhpcy5wYXJhbXMudGFyZ2V0VmFsdWUxLCB0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMudGFyZ2V0VmFsdWUxKSAtIHNvdXJjZSk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICB0aGlzLmludGVycHJldGVyLnNldE51bWJlclZhbHVlVG8odGhpcy5wYXJhbXMudGFyZ2V0VmFsdWUxLCB0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMudGFyZ2V0VmFsdWUxKSAqIHNvdXJjZSk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICB0aGlzLmludGVycHJldGVyLnNldE51bWJlclZhbHVlVG8odGhpcy5wYXJhbXMudGFyZ2V0VmFsdWUxLCB0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMudGFyZ2V0VmFsdWUxKSAvIHNvdXJjZSk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICB0aGlzLmludGVycHJldGVyLnNldE51bWJlclZhbHVlVG8odGhpcy5wYXJhbXMudGFyZ2V0VmFsdWUxLCB0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMudGFyZ2V0VmFsdWUxKSAlIHNvdXJjZSk7CiAgICAgICAgICB9CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDE6CiAgICAgICAgICBzY29wZSA9IHRoaXMucGFyYW1zLnRhcmdldFZhbHVlMTsKICAgICAgICAgIHN0YXJ0ID0gdGhpcy5wYXJhbXMudGFyZ2V0VmFsdWUyIC0gMTsKICAgICAgICAgIGVuZCA9IHRoaXMucGFyYW1zLnRhcmdldFZhbHVlMyAtIDE7CiAgICAgICAgICBmb3IgKGkgPSBfaSA9IHN0YXJ0OyBzdGFydCA8PSBlbmQgPyBfaSA8PSBlbmQgOiBfaSA+PSBlbmQ7IGkgPSBzdGFydCA8PSBlbmQgPyArK19pIDogLS1faSkgewogICAgICAgICAgICBzd2l0Y2ggKHRoaXMucGFyYW1zLm9wZXJhdGlvbikgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIHRoaXMuaW50ZXJwcmV0ZXIuc2V0TnVtYmVyVmFsdWVBdEluZGV4KHNjb3BlLCBpLCBzb3VyY2UpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgICAgdGhpcy5pbnRlcnByZXRlci5zZXROdW1iZXJWYWx1ZUF0SW5kZXgoc2NvcGUsIGksIHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVBdEluZGV4KHNjb3BlLCBpKSArIHNvdXJjZSk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICB0aGlzLmludGVycHJldGVyLnNldE51bWJlclZhbHVlQXRJbmRleChzY29wZSwgaSwgdGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZUF0SW5kZXgoc2NvcGUsIGkpIC0gc291cmNlKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIHRoaXMuaW50ZXJwcmV0ZXIuc2V0TnVtYmVyVmFsdWVBdEluZGV4KHNjb3BlLCBpLCB0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlQXRJbmRleChzY29wZSwgaSkgKiBzb3VyY2UpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgICAgdGhpcy5pbnRlcnByZXRlci5zZXROdW1iZXJWYWx1ZUF0SW5kZXgoc2NvcGUsIGksIHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVBdEluZGV4KHNjb3BlLCBpKSAvIHNvdXJjZSk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICB0aGlzLmludGVycHJldGVyLnNldE51bWJlclZhbHVlQXRJbmRleChzY29wZSwgaSwgdGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZUF0SW5kZXgoc2NvcGUsIGkpICUgc291cmNlKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAyOgogICAgICAgICAgaW5kZXggPSB0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMudGFyZ2V0VmFsdWUyKSAtIDE7CiAgICAgICAgICBzd2l0Y2ggKHRoaXMucGFyYW1zLm9wZXJhdGlvbikgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgdGhpcy5pbnRlcnByZXRlci5zZXROdW1iZXJWYWx1ZUF0SW5kZXgodGhpcy5wYXJhbXMudGFyZ2V0VmFsdWUxLCBpbmRleCwgc291cmNlKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgIHRoaXMuaW50ZXJwcmV0ZXIuc2V0TnVtYmVyVmFsdWVBdEluZGV4KHRoaXMucGFyYW1zLnRhcmdldFZhbHVlMSwgaW5kZXgsIHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVBdEluZGV4KHRoaXMucGFyYW1zLnRhcmdldFZhbHVlMSwgaW5kZXgpICsgc291cmNlKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgIHRoaXMuaW50ZXJwcmV0ZXIuc2V0TnVtYmVyVmFsdWVBdEluZGV4KHRoaXMucGFyYW1zLnRhcmdldFZhbHVlMSwgaW5kZXgsIHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVBdEluZGV4KHRoaXMucGFyYW1zLnRhcmdldFZhbHVlMSwgaW5kZXgpIC0gc291cmNlKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgIHRoaXMuaW50ZXJwcmV0ZXIuc2V0TnVtYmVyVmFsdWVBdEluZGV4KHRoaXMucGFyYW1zLnRhcmdldFZhbHVlMSwgaW5kZXgsIHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVBdEluZGV4KHRoaXMucGFyYW1zLnRhcmdldFZhbHVlMSwgaW5kZXgpICogc291cmNlKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgIHRoaXMuaW50ZXJwcmV0ZXIuc2V0TnVtYmVyVmFsdWVBdEluZGV4KHRoaXMucGFyYW1zLnRhcmdldFZhbHVlMSwgaW5kZXgsIHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVBdEluZGV4KHRoaXMucGFyYW1zLnRhcmdldFZhbHVlMSwgaW5kZXgpIC8gc291cmNlKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgIHRoaXMuaW50ZXJwcmV0ZXIuc2V0TnVtYmVyVmFsdWVBdEluZGV4KHRoaXMucGFyYW1zLnRhcmdldFZhbHVlMSwgaW5kZXgsIHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVBdEluZGV4KHRoaXMucGFyYW1zLnRhcmdldFZhbHVlMSwgaW5kZXgpICUgc291cmNlKTsKICAgICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gbnVsbDsKICAgIH07CgogICAgQ29tbWFuZEludGVycHJldGVyLnByb3RvdHlwZS5jb21tYW5kQ2hhbmdlQm9vbGVhblZhcmlhYmxlcyA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgaSwgc291cmNlLCB2YXJpYWJsZSwgX2ksIF9yZWYsIF9yZWYxOwogICAgICBzb3VyY2UgPSB0aGlzLmludGVycHJldGVyLmJvb2xlYW5WYWx1ZU9mKHRoaXMucGFyYW1zLnZhbHVlKTsKICAgICAgc3dpdGNoICh0aGlzLnBhcmFtcy50YXJnZXQpIHsKICAgICAgICBjYXNlIDA6CiAgICAgICAgICB0aGlzLmludGVycHJldGVyLnNldEJvb2xlYW5WYWx1ZVRvKHRoaXMucGFyYW1zLnRhcmdldFZhcmlhYmxlLCBzb3VyY2UpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAxOgogICAgICAgICAgdmFyaWFibGUgPSB7CiAgICAgICAgICAgIGluZGV4OiAwLAogICAgICAgICAgICBzY29wZTogdGhpcy5wYXJhbXMudGFyZ2V0UmFuZ2VTY29wZQogICAgICAgICAgfTsKICAgICAgICAgIGZvciAoaSA9IF9pID0gX3JlZiA9IHRoaXMucGFyYW1zLnJhbmdlU3RhcnQsIF9yZWYxID0gdGhpcy5wYXJhbXMucmFuZ2VFbmQ7IF9yZWYgPD0gX3JlZjEgPyBfaSA8PSBfcmVmMSA6IF9pID49IF9yZWYxOyBpID0gX3JlZiA8PSBfcmVmMSA/ICsrX2kgOiAtLV9pKSB7CiAgICAgICAgICAgIHZhcmlhYmxlLmluZGV4ID0gaTsKICAgICAgICAgICAgdGhpcy5pbnRlcnByZXRlci5zZXRCb29sZWFuVmFsdWVUbyh2YXJpYWJsZSwgc291cmNlKTsKICAgICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gbnVsbDsKICAgIH07CgogICAgQ29tbWFuZEludGVycHJldGVyLnByb3RvdHlwZS5jb21tYW5kQ2hhbmdlU3RyaW5nVmFyaWFibGVzID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBpLCBzb3VyY2UsIHZhcmlhYmxlLCBfaSwgX3JlZiwgX3JlZjE7CiAgICAgIHNvdXJjZSA9ICIiOwogICAgICBzd2l0Y2ggKHRoaXMucGFyYW1zLnZhbHVlVHlwZSkgewogICAgICAgIGNhc2UgMDoKICAgICAgICAgIHNvdXJjZSA9IHRoaXMucGFyYW1zLnRleHRWYWx1ZTsKICAgICAgfQogICAgICBzd2l0Y2ggKHRoaXMucGFyYW1zLnRhcmdldCkgewogICAgICAgIGNhc2UgMDoKICAgICAgICAgIHN3aXRjaCAodGhpcy5wYXJhbXMub3BlcmF0aW9uKSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICB0aGlzLmludGVycHJldGVyLnNldFN0cmluZ1ZhbHVlVG8odGhpcy5wYXJhbXMudGFyZ2V0VmFyaWFibGUsIHNvdXJjZSk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICB0aGlzLmludGVycHJldGVyLnNldFN0cmluZ1ZhbHVlVG8odGhpcy5wYXJhbXMudGFyZ2V0VmFyaWFibGUsIHRoaXMuaW50ZXJwcmV0ZXIuc3RyaW5nVmFsdWVPZih0aGlzLnBhcmFtcy50YXJnZXRWYXJpYWJsZSkgKyBzb3VyY2UpOwogICAgICAgICAgfQogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAxOgogICAgICAgICAgdmFyaWFibGUgPSB7CiAgICAgICAgICAgIGluZGV4OiAwLAogICAgICAgICAgICBzY29wZTogdGhpcy5wYXJhbXMudGFyZ2V0UmFuZ2VTY29wZQogICAgICAgICAgfTsKICAgICAgICAgIGZvciAoaSA9IF9pID0gX3JlZiA9IHRoaXMucGFyYW1zLnJhbmdlU3RhcnQsIF9yZWYxID0gdGhpcy5wYXJhbXMucmFuZ2VFbmQ7IF9yZWYgPD0gX3JlZjEgPyBfaSA8PSBfcmVmMSA6IF9pID49IF9yZWYxOyBpID0gX3JlZiA8PSBfcmVmMSA/ICsrX2kgOiAtLV9pKSB7CiAgICAgICAgICAgIHZhcmlhYmxlLmluZGV4ID0gaTsKICAgICAgICAgICAgc3dpdGNoICh0aGlzLnBhcmFtcy5vcGVyYXRpb24pIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICB0aGlzLmludGVycHJldGVyLnNldFN0cmluZ1ZhbHVlVG8odmFyaWFibGUsIHNvdXJjZSk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgICB0aGlzLmludGVycHJldGVyLnNldFN0cmluZ1ZhbHVlVG8odmFyaWFibGUsIHRoaXMuaW50ZXJwcmV0ZXIuc3RyaW5nVmFsdWVPZih2YXJpYWJsZSkgKyBzb3VyY2UpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIG51bGw7CiAgICB9OwoKICAgIENvbW1hbmRJbnRlcnByZXRlci5wcm90b3R5cGUuY29tbWFuZENvbmRpdGlvbiA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgZGF0ZSwgZW5lbXksIGV2ZW50LCBleCwgaXRlbSwgbWVtYmVyLCBvcGVyYW5kQSwgb3BlcmFuZEIsIHJlc3VsdCwgdGV4dDEsIHRleHQyOwogICAgICBvcGVyYW5kQSA9IDA7CiAgICAgIG9wZXJhbmRCID0gMDsKICAgICAgcmVzdWx0ID0gZmFsc2U7CiAgICAgIHN3aXRjaCAodGhpcy5wYXJhbXMuY29kZSkgewogICAgICAgIGNhc2UgMDoKICAgICAgICAgIHJlc3VsdCA9IEdhbWVNYW5hZ2VyLnBhcnR5LmlzTWVtYmVyKFJlY29yZE1hbmFnZXIuYWN0b3JzW3RoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy52YWx1ZTEpXSk7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDE6CiAgICAgICAgICBtZW1iZXIgPSBHYW1lTWFuYWdlci5wYXJ0eS5tZW1iZXJXaXRoSWQodGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZSh0aGlzLnBhcmFtcy52YWx1ZTEpKTsKICAgICAgICAgIGlmIChtZW1iZXIgIT0gbnVsbCkgewogICAgICAgICAgICByZXN1bHQgPSBtZW1iZXIuaGFzU2tpbGwoUmVjb3JkTWFuYWdlci5za2lsbHNbdGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZSh0aGlzLnBhcmFtcy52YWx1ZTIpXSk7CiAgICAgICAgICB9CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDI6CiAgICAgICAgICBtZW1iZXIgPSBHYW1lTWFuYWdlci5wYXJ0eS5tZW1iZXJXaXRoSWQodGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZSh0aGlzLnBhcmFtcy52YWx1ZTEpKTsKICAgICAgICAgIGlmIChtZW1iZXIgIT0gbnVsbCkgewogICAgICAgICAgICByZXN1bHQgPSBtZW1iZXIuaGFzV2VhcG9uKFJlY29yZE1hbmFnZXIud2VhcG9uc1t0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlKHRoaXMucGFyYW1zLnZhbHVlMildKTsKICAgICAgICAgIH0KICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgMzoKICAgICAgICAgIG1lbWJlciA9IEdhbWVNYW5hZ2VyLnBhcnR5Lm1lbWJlcldpdGhJZCh0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlKHRoaXMucGFyYW1zLnZhbHVlMSkpOwogICAgICAgICAgaWYgKG1lbWJlciAhPSBudWxsKSB7CiAgICAgICAgICAgIHJlc3VsdCA9IG1lbWJlci5oYXNBcm1vcihSZWNvcmRNYW5hZ2VyLmFybW9yc1t0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlKHRoaXMucGFyYW1zLnZhbHVlMildKTsKICAgICAgICAgIH0KICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgNDoKICAgICAgICAgIG1lbWJlciA9IEdhbWVNYW5hZ2VyLnBhcnR5Lm1lbWJlcldpdGhJZCh0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlKHRoaXMucGFyYW1zLnZhbHVlMSkpOwogICAgICAgICAgaWYgKG1lbWJlciAhPSBudWxsKSB7CiAgICAgICAgICAgIHJlc3VsdCA9IG1lbWJlci5oYXNDbGFzcyhSZWNvcmRNYW5hZ2VyLmNsYXNzZXNbdGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZSh0aGlzLnBhcmFtcy52YWx1ZTIpXSk7CiAgICAgICAgICB9CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDU6CiAgICAgICAgICBtZW1iZXIgPSBHYW1lTWFuYWdlci5wYXJ0eS5tZW1iZXJXaXRoSWQodGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZSh0aGlzLnBhcmFtcy52YWx1ZTEpKTsKICAgICAgICAgIGlmIChtZW1iZXIgIT0gbnVsbCkgewogICAgICAgICAgICByZXN1bHQgPSBtZW1iZXIuaGFzU3RhdGUoUmVjb3JkTWFuYWdlci5zdGF0ZXNbdGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZSh0aGlzLnBhcmFtcy52YWx1ZTIpXSk7CiAgICAgICAgICB9CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDY6CiAgICAgICAgICBpdGVtID0gR2FtZU1hbmFnZXIuaW52ZW50b3J5Lml0ZW1zW3RoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWUodGhpcy5wYXJhbXMudmFsdWUxKV07CiAgICAgICAgICByZXN1bHQgPSBpdGVtICYmIGl0ZW0uY291bnQgPiAwOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSA3OgogICAgICAgICAgaXRlbSA9IEdhbWVNYW5hZ2VyLmludmVudG9yeS53ZWFwb25zW3RoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWUodGhpcy5wYXJhbXMudmFsdWUxKV07CiAgICAgICAgICByZXN1bHQgPSBpdGVtICYmIGl0ZW0uY291bnQgPiAwOwogICAgICAgICAgaWYgKCFyZXN1bHQgJiYgdGhpcy5wYXJhbXMudmFsdWUyKSB7CiAgICAgICAgICAgIHJlc3VsdCA9IEdhbWVNYW5hZ2VyLnBhcnR5Lmhhc1dlYXBvbihpdGVtKTsKICAgICAgICAgIH0KICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgODoKICAgICAgICAgIGl0ZW0gPSBHYW1lTWFuYWdlci5pbnZlbnRvcnkuYXJtb3JzW3RoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWUodGhpcy5wYXJhbXMudmFsdWUxKV07CiAgICAgICAgICByZXN1bHQgPSBpdGVtICYmIGl0ZW0uY291bnQgPiAwOwogICAgICAgICAgaWYgKCFyZXN1bHQgJiYgdGhpcy5wYXJhbXMudmFsdWUyKSB7CiAgICAgICAgICAgIHJlc3VsdCA9IEdhbWVNYW5hZ2VyLnBhcnR5Lmhhc0FybW9yKGl0ZW0pOwogICAgICAgICAgfQogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSA5OgogICAgICAgICAgbWVtYmVyID0gR2FtZU1hbmFnZXIucGFydHkubWVtYmVyV2l0aElkKHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWUodGhpcy5wYXJhbXMudmFsdWUxKSk7CiAgICAgICAgICBpZiAobWVtYmVyICE9IG51bGwpIHsKICAgICAgICAgICAgc3dpdGNoICh0aGlzLnBhcmFtcy52YWx1ZTIpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICByZXN1bHQgPSB0aGlzLmludGVycHJldGVyLmNvbXBhcmUobWVtYmVyLmxldmVsLCB0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMudmFsdWU0KSwgdGhpcy5wYXJhbXMudmFsdWUzKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRoaXMuaW50ZXJwcmV0ZXIuY29tcGFyZShtZW1iZXIubHAsIHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy52YWx1ZTQpLCB0aGlzLnBhcmFtcy52YWx1ZTMpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgcmVzdWx0ID0gdGhpcy5pbnRlcnByZXRlci5jb21wYXJlKG1lbWJlci5tcCwgdGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKHRoaXMucGFyYW1zLnZhbHVlNCksIHRoaXMucGFyYW1zLnZhbHVlMyk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgcmVzdWx0ID0gdGhpcy5pbnRlcnByZXRlci5jb21wYXJlKG1lbWJlci5wYXJhbWV0ZXIodGhpcy5wYXJhbXMudmFsdWUyIC0gMyksIHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy52YWx1ZTQpLCB0aGlzLnBhcmFtcy52YWx1ZTMpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDEwOgogICAgICAgICAgaWYgKFNjZW5lTWFuYWdlci5zY2VuZSBpbnN0YW5jZW9mIFNjZW5lX0JhdHRsZSkgewogICAgICAgICAgICBlbmVteSA9IFNjZW5lTWFuYWdlci5zY2VuZS5lbmVtaWVzW3RoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWUodGhpcy5wYXJhbXMudmFsdWUxKV07CiAgICAgICAgICAgIGlmIChlbmVteSAhPSBudWxsKSB7CiAgICAgICAgICAgICAgc3dpdGNoICh0aGlzLnBhcmFtcy52YWx1ZTIpIHsKICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gdGhpcy5pbnRlcnByZXRlci5jb21wYXJlKGVuZW15LmxwLCB0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMudmFsdWU0KSwgdGhpcy5wYXJhbXMudmFsdWUzKTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRoaXMuaW50ZXJwcmV0ZXIuY29tcGFyZShlbmVteS5tcCwgdGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKHRoaXMucGFyYW1zLnZhbHVlNCksIHRoaXMucGFyYW1zLnZhbHVlMyk7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gdGhpcy5pbnRlcnByZXRlci5jb21wYXJlKGVuZW15LnBhcmFtZXRlcih0aGlzLnBhcmFtcy52YWx1ZTIgLSAzKSwgdGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKHRoaXMucGFyYW1zLnZhbHVlNCksIHRoaXMucGFyYW1zLnZhbHVlMyk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDExOgogICAgICAgICAgcmVzdWx0ID0gdGhpcy5pbnRlcnByZXRlci5ib29sZWFuVmFsdWVPZih0aGlzLnBhcmFtcy52YWx1ZTEpID09PSAodGhpcy5wYXJhbXMudmFsdWUyID09PSAxKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgMTI6CiAgICAgICAgICByZXN1bHQgPSB0aGlzLmludGVycHJldGVyLmNvbXBhcmUodGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKHRoaXMucGFyYW1zLnZhbHVlMSksIHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy52YWx1ZTMpLCB0aGlzLnBhcmFtcy52YWx1ZTIpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAxMzoKICAgICAgICAgIHRleHQxID0gdGhpcy5pbnRlcnByZXRlci5zdHJpbmdWYWx1ZU9mKHRoaXMucGFyYW1zLnZhbHVlMSk7CiAgICAgICAgICB0ZXh0MiA9IHRoaXMuaW50ZXJwcmV0ZXIuc3RyaW5nVmFsdWVPZih0aGlzLnBhcmFtcy52YWx1ZTMpOwogICAgICAgICAgc3dpdGNoICh0aGlzLnBhcmFtcy52YWx1ZTIpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIHJlc3VsdCA9IHRleHQxID09PSB0ZXh0MjsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgIHJlc3VsdCA9IHRleHQxICE9PSB0ZXh0MjsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgIHJlc3VsdCA9IHRleHQxLmxlbmd0aCA+IHRleHQyLmxlbmd0aDsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgIHJlc3VsdCA9IHRleHQxLmxlbmd0aCA+PSB0ZXh0Mi5sZW5ndGg7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICByZXN1bHQgPSB0ZXh0MS5sZW5ndGggPCB0ZXh0Mi5sZW5ndGg7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICByZXN1bHQgPSB0ZXh0MS5sZW5ndGggPD0gdGV4dDIubGVuZ3RoOwogICAgICAgICAgfQogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAxNDoKICAgICAgICAgIHJlc3VsdCA9IHRoaXMuaW50ZXJwcmV0ZXIuY29tcGFyZShHYW1lTWFuYWdlci5tb25leSwgdGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKHRoaXMucGFyYW1zLnZhbHVlMyksIHRoaXMucGFyYW1zLnZhbHVlMik7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDE1OgogICAgICAgICAgcmVzdWx0ID0gdGhpcy5pbnRlcnByZXRlci5jb21wYXJlKEdhbWVNYW5hZ2VyLnRpbWVyLm1pbnV0ZXMsIHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy52YWx1ZTIpLCB0aGlzLnBhcmFtcy52YWx1ZTEpOwogICAgICAgICAgaWYgKHJlc3VsdCkgewogICAgICAgICAgICByZXN1bHQgPSB0aGlzLmludGVycHJldGVyLmNvbXBhcmUoR2FtZU1hbmFnZXIudGltZXIuc2Vjb25kcywgdGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKHRoaXMucGFyYW1zLnZhbHVlMyksIHRoaXMucGFyYW1zLnZhbHVlMSk7CiAgICAgICAgICB9CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDE2OgogICAgICAgICAgcmVzdWx0ID0gdGhpcy5pbnRlcnByZXRlci5jb21wYXJlKEdhbWVNYW5hZ2VyLmdhbWVUaW1lLmhvdXJzLCB0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMudmFsdWUyKSwgdGhpcy5wYXJhbXMudmFsdWUxKTsKICAgICAgICAgIGlmIChyZXN1bHQpIHsKICAgICAgICAgICAgcmVzdWx0ID0gdGhpcy5pbnRlcnByZXRlci5jb21wYXJlKEdhbWVNYW5hZ2VyLmdhbWVUaW1lLm1pbnV0ZXMsIHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy52YWx1ZTMpLCB0aGlzLnBhcmFtcy52YWx1ZTEpOwogICAgICAgICAgfQogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAxNzoKICAgICAgICAgIGRhdGUgPSBuZXcgRGF0ZSgpOwogICAgICAgICAgc3dpdGNoICh0aGlzLnBhcmFtcy52YWx1ZTEpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIHJlc3VsdCA9IHRoaXMuaW50ZXJwcmV0ZXIuY29tcGFyZShkYXRlLmdldEZ1bGxZZWFyKCksIHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy52YWx1ZTMpLCB0aGlzLnBhcmFtcy52YWx1ZTIpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgcmVzdWx0ID0gdGhpcy5pbnRlcnByZXRlci5jb21wYXJlKGRhdGUuZ2V0TW9udGgoKSwgdGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKHRoaXMucGFyYW1zLnZhbHVlMyksIHRoaXMucGFyYW1zLnZhbHVlMik7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICByZXN1bHQgPSB0aGlzLmludGVycHJldGVyLmNvbXBhcmUoZGF0ZS5nZXRXZWVrKCksIHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy52YWx1ZTMpLCB0aGlzLnBhcmFtcy52YWx1ZTIpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgcmVzdWx0ID0gdGhpcy5pbnRlcnByZXRlci5jb21wYXJlKGRhdGUuZ2V0RGF5KCksIHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy52YWx1ZTMpLCB0aGlzLnBhcmFtcy52YWx1ZTIpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgcmVzdWx0ID0gdGhpcy5pbnRlcnByZXRlci5jb21wYXJlKGRhdGUuZ2V0RGF5T2ZZZWFyKCksIHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy52YWx1ZTMpLCB0aGlzLnBhcmFtcy52YWx1ZTIpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgcmVzdWx0ID0gdGhpcy5pbnRlcnByZXRlci5jb21wYXJlKGRhdGUuZ2V0SG91cnMoKSwgdGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKHRoaXMucGFyYW1zLnZhbHVlMyksIHRoaXMucGFyYW1zLnZhbHVlMik7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICByZXN1bHQgPSB0aGlzLmludGVycHJldGVyLmNvbXBhcmUoZGF0ZS5nZXRNaW51dGVzKCksIHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy52YWx1ZTMpLCB0aGlzLnBhcmFtcy52YWx1ZTIpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgcmVzdWx0ID0gdGhpcy5pbnRlcnByZXRlci5jb21wYXJlKGRhdGUuZ2V0U2Vjb25kcygpLCB0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMudmFsdWUzKSwgdGhpcy5wYXJhbXMudmFsdWUyKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgIHJlc3VsdCA9IHRoaXMuaW50ZXJwcmV0ZXIuY29tcGFyZShkYXRlLmdldE1pbGxpc2Vjb25kcygpLCB0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMudmFsdWUzKSwgdGhpcy5wYXJhbXMudmFsdWUyKTsKICAgICAgICAgIH0KICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgMTg6CiAgICAgICAgICBzd2l0Y2ggKHRoaXMucGFyYW1zLnZhbHVlMSkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgcmVzdWx0ID0gSW5wdXQua2V5c1tJbnB1dC5ET1dOXSA9PT0gKHRoaXMucGFyYW1zLnZhbHVlMiArIDEpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgcmVzdWx0ID0gSW5wdXQua2V5c1tJbnB1dC5MRUZUXSA9PT0gKHRoaXMucGFyYW1zLnZhbHVlMiArIDEpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgcmVzdWx0ID0gSW5wdXQua2V5c1tJbnB1dC5VUF0gPT09ICh0aGlzLnBhcmFtcy52YWx1ZTIgKyAxKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgIHJlc3VsdCA9IElucHV0LmtleXNbSW5wdXQuUklHSFRdID09PSAodGhpcy5wYXJhbXMudmFsdWUyICsgMSk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICByZXN1bHQgPSBJbnB1dC5rZXlzW0lucHV0LkFdID09PSAodGhpcy5wYXJhbXMudmFsdWUyICsgMSk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICByZXN1bHQgPSBJbnB1dC5rZXlzW0lucHV0LkJdID09PSAodGhpcy5wYXJhbXMudmFsdWUyICsgMSk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICByZXN1bHQgPSBJbnB1dC5rZXlzW0lucHV0LlhdID09PSAodGhpcy5wYXJhbXMudmFsdWUyICsgMSk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICByZXN1bHQgPSBJbnB1dC5rZXlzW0lucHV0LlldID09PSAodGhpcy5wYXJhbXMudmFsdWUyICsgMSk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICByZXN1bHQgPSBJbnB1dC5rZXlzW0lucHV0LlNUQVJUXSA9PT0gKHRoaXMucGFyYW1zLnZhbHVlMiArIDEpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgcmVzdWx0ID0gSW5wdXQua2V5c1tJbnB1dC5TRUxFQ1RdID09PSAodGhpcy5wYXJhbXMudmFsdWUyICsgMSk7CiAgICAgICAgICB9CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDE5OgogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgcmVzdWx0ID0gZXZhbCh0aGlzLnBhcmFtcy52YWx1ZTEpOwogICAgICAgICAgfSBjYXRjaCAoX2Vycm9yKSB7CiAgICAgICAgICAgIGV4ID0gX2Vycm9yOwogICAgICAgICAgICBjb25zb2xlLmxvZygiRVJST1IgV0hJTEUgRVZBTFVBVElORyBTQ1JJUFQgSU4gQ09ORElUSU9OIik7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKGV4KTsKICAgICAgICAgIH0KICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgMjA6CiAgICAgICAgICBldmVudCA9IHRoaXMuaW50ZXJwcmV0ZXIuZXZlbnRCeUlkKHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy52YWx1ZTEpKTsKICAgICAgICAgIGlmIChldmVudCAhPSBudWxsKSB7CiAgICAgICAgICAgIHJlc3VsdCA9IHRoaXMucGFyYW1zLnZhbHVlMiA9PT0gMCA/IGV2ZW50LmNhbk1vdmUodGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKHRoaXMucGFyYW1zLnZhbHVlMykpIDogIWV2ZW50LmNhbk1vdmUodGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKHRoaXMucGFyYW1zLnZhbHVlMykpOwogICAgICAgICAgfQogICAgICB9CiAgICAgIGlmICghcmVzdWx0KSB7CiAgICAgICAgdGhpcy5pbnRlcnByZXRlci5za2lwKHRoaXMuaW5kZW50KTsKICAgICAgfQogICAgICB0aGlzLmludGVycHJldGVyLmNvbmRpdGlvbnMucHVzaChyZXN1bHQpOwogICAgICByZXR1cm4gbnVsbDsKICAgIH07CgogICAgQ29tbWFuZEludGVycHJldGVyLnByb3RvdHlwZS5jb21tYW5kQ29uZGl0aW9uRWxzZUNhc2UgPSBmdW5jdGlvbigpIHsKICAgICAgaWYgKHRoaXMuaW50ZXJwcmV0ZXIuY29uZGl0aW9uc1t0aGlzLmludGVycHJldGVyLmNvbmRpdGlvbnMubGVuZ3RoIC0gMV0pIHsKICAgICAgICByZXR1cm4gdGhpcy5pbnRlcnByZXRlci5za2lwKHRoaXMuaW5kZW50KTsKICAgICAgfQogICAgfTsKCiAgICBDb21tYW5kSW50ZXJwcmV0ZXIucHJvdG90eXBlLmNvbW1hbmRDb25kaXRpb25FbmQgPSBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIHRoaXMuaW50ZXJwcmV0ZXIuY29uZGl0aW9ucy5wb3AoKTsKICAgIH07CgogICAgQ29tbWFuZEludGVycHJldGVyLnByb3RvdHlwZS5jb21tYW5kTGFiZWwgPSBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIHRoaXMuaW50ZXJwcmV0ZXIubGFiZWxzW3RoaXMucGFyYW1zLm5hbWVdID0gdGhpcy5pbnRlcnByZXRlci5wb2ludGVyOwogICAgfTsKCiAgICBDb21tYW5kSW50ZXJwcmV0ZXIucHJvdG90eXBlLmNvbW1hbmRKdW1wVG9MYWJlbCA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgaSwgbGFiZWwsIF9pLCBfcmVmLCBfcmVmMSwgX3Jlc3VsdHM7CiAgICAgIGxhYmVsID0gdGhpcy5pbnRlcnByZXRlci5sYWJlbHNbdGhpcy5wYXJhbXMubmFtZV07CiAgICAgIGlmIChsYWJlbCAhPSBudWxsKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuaW50ZXJwcmV0ZXIucG9pbnRlciA9IGxhYmVsOwogICAgICB9IGVsc2UgewogICAgICAgIF9yZXN1bHRzID0gW107CiAgICAgICAgZm9yIChpID0gX2kgPSBfcmVmID0gdGhpcy5pbnRlcnByZXRlci5wb2ludGVyLCBfcmVmMSA9IHRoaXMuaW50ZXJwcmV0ZXIuY29tbWFuZHMubGVuZ3RoOyBfcmVmIDw9IF9yZWYxID8gX2kgPCBfcmVmMSA6IF9pID4gX3JlZjE7IGkgPSBfcmVmIDw9IF9yZWYxID8gKytfaSA6IC0tX2kpIHsKICAgICAgICAgIGlmICh0aGlzLmludGVycHJldGVyLmNvbW1hbmRzW2ldLm5vZGVJZCA9PT0gImdzLkxhYmVsIiAmJiB0aGlzLmludGVycHJldGVyLmNvbW1hbmRzW2ldLnBhcmFtcy5uYW1lID09PSB0aGlzLnBhcmFtcy5uYW1lKSB7CiAgICAgICAgICAgIHRoaXMuaW50ZXJwcmV0ZXIucG9pbnRlciA9IGk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgX3Jlc3VsdHMucHVzaCh2b2lkIDApOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gX3Jlc3VsdHM7CiAgICAgIH0KICAgIH07CgogICAgQ29tbWFuZEludGVycHJldGVyLnByb3RvdHlwZS5pc01lc3NhZ2VDb21tYW5kID0gZnVuY3Rpb24ocG9pbnRlciwgY29tbWFuZHMpIHsKICAgICAgdmFyIHJlc3VsdDsKICAgICAgcmVzdWx0ID0gdHJ1ZTsKICAgICAgaWYgKHBvaW50ZXIgPj0gY29tbWFuZHMubGVuZ3RoIHx8IChjb21tYW5kc1twb2ludGVyXS5pZCAhPT0gImdzLlNob3dNZXNzYWdlIiAmJiBjb21tYW5kc1twb2ludGVyXS5pZCAhPT0gImdzLklucHV0TnVtYmVyIiAmJiBjb21tYW5kc1twb2ludGVyXS5ub2RlSWQgIT09ICJncy5TaG93Q2hvaWNlcyIgJiYgY29tbWFuZHNbcG9pbnRlcl0uaWQgIT09ICJncy5JbnB1dFRleHQiICYmIGNvbW1hbmRzW3BvaW50ZXJdLmlkICE9PSAiZ3MuSW5wdXROYW1lIikpIHsKICAgICAgICByZXN1bHQgPSBmYWxzZTsKICAgICAgfQogICAgICByZXR1cm4gcmVzdWx0OwogICAgfTsKCiAgICBDb21tYW5kSW50ZXJwcmV0ZXIucHJvdG90eXBlLmlzUHJvY2Vzc2luZ01lc3NhZ2VJbk90aGVyQ29udGV4dCA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgZ20sIHJlc3VsdDsKICAgICAgcmVzdWx0ID0gZmFsc2U7CiAgICAgIGdtID0gR2FtZU1hbmFnZXI7CiAgICAgIHJlc3VsdCA9IChnbS5tZXNzYWdlV2luZG93LnZpc2libGUgJiYgZ20ubWVzc2FnZVdpbmRvdy5leGVjdXRpb25Db250ZXh0ICE9PSB0aGlzLmNvbnRleHQpIHx8ICgoZ20uaW5wdXROdW1iZXJXaW5kb3cgIT0gbnVsbCkgJiYgZ20uaW5wdXROdW1iZXJXaW5kb3cudmlzaWJsZSAmJiBnbS5pbnB1dE51bWJlcldpbmRvdy5leGVjdXRpb25Db250ZXh0ICE9PSB0aGlzLmNvbnRleHQpIHx8ICgoZ20uaW5wdXRUZXh0V2luZG93c2V0ICE9IG51bGwpICYmIGdtLmlucHV0VGV4dFdpbmRvd3NldC5hY3RpdmUgJiYgZ20uaW5wdXRUZXh0V2luZG93c2V0LmV4ZWN1dGlvbkNvbnRleHQgIT09IHRoaXMuY29udGV4dCkgfHwgKChnbS5jaG9pY2VXaW5kb3cgIT0gbnVsbCkgJiYgZ20uY2hvaWNlV2luZG93LnZpc2libGUgJiYgZ20uY2hvaWNlV2luZG93LmV4ZWN1dGlvbkNvbnRleHQgIT09IHRoaXMuY29udGV4dCk7CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9OwoKICAgIENvbW1hbmRJbnRlcnByZXRlci5wcm90b3R5cGUud2FpdEZvck1lc3NhZ2UgPSBmdW5jdGlvbigpIHsKICAgICAgdGhpcy5pc1dhaXRpbmdGb3JNZXNzYWdlID0gdHJ1ZTsKICAgICAgdGhpcy5pc1dhaXRpbmcgPSB0cnVlOwogICAgICByZXR1cm4gdGhpcy5wb2ludGVyLS07CiAgICB9OwoKICAgIENvbW1hbmRJbnRlcnByZXRlci5wcm90b3R5cGUuY29tbWFuZFNob3dNZXNzYWdlID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBtZXNzYWdlV2luZG93LAogICAgICAgIF90aGlzID0gdGhpczsKICAgICAgR2FtZU1hbmFnZXIubWFwLmN1cnJlbnRFdmVudC5pc0xvY2tlZCA9IHRydWU7CiAgICAgIG1lc3NhZ2VXaW5kb3cgPSBHYW1lTWFuYWdlci5tZXNzYWdlV2luZG93OwogICAgICBpZiAodGhpcy5pbnRlcnByZXRlci5pc1Byb2Nlc3NpbmdNZXNzYWdlSW5PdGhlckNvbnRleHQoKSkgewogICAgICAgIHRoaXMuaW50ZXJwcmV0ZXIud2FpdEZvck1lc3NhZ2UoKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgbWVzc2FnZVdpbmRvdy5leGVjdXRpb25Db250ZXh0ID0gdGhpcy5pbnRlcnByZXRlci5jb250ZXh0OwogICAgICBtZXNzYWdlV2luZG93LnJlc2l6ZSgpOwogICAgICBtZXNzYWdlV2luZG93Lm1lc3NhZ2UgPSBsY3NtKHRoaXMucGFyYW1zLm1lc3NhZ2UpOwogICAgICBtZXNzYWdlV2luZG93LmZhY2VHcmFwaGljID0gdGhpcy5wYXJhbXMuZmFjZUdyYXBoaWM7CiAgICAgIG1lc3NhZ2VXaW5kb3cuZmFjZVBhdHRlcm4gPSB0aGlzLnBhcmFtcy5mYWNlUGF0dGVybjsKICAgICAgbWVzc2FnZVdpbmRvdy5wb3NpdGlvbiA9IHRoaXMucGFyYW1zLnBvc2l0aW9uOwogICAgICBtZXNzYWdlV2luZG93Lm5hbWUgPSB0aGlzLnBhcmFtcy5uYW1lIHx8ICIiOwogICAgICBtZXNzYWdlV2luZG93Lm9wYWNpdHkgPSB0aGlzLnBhcmFtcy5oaWRlV2luZG93ID8gMCA6IDI1NTsKICAgICAgbWVzc2FnZVdpbmRvdy5zY3JvbGxXaXRoTWFwID0gZmFsc2U7CiAgICAgIG1lc3NhZ2VXaW5kb3cuc2V0Vmlld3BvcnQobnVsbCk7CiAgICAgIG1lc3NhZ2VXaW5kb3cub3BlbigpOwogICAgICBtZXNzYWdlV2luZG93LnN0YXJ0KCk7CiAgICAgIG1lc3NhZ2VXaW5kb3cuZXZlbnQgPSBHYW1lTWFuYWdlci5tYXAuY3VycmVudEV2ZW50OwogICAgICBtZXNzYWdlV2luZG93Lm9uRmluaXNoID0gZnVuY3Rpb24oKSB7CiAgICAgICAgdmFyIGNvbW1hbmRzLCBwb2ludGVyOwogICAgICAgIF90aGlzLmludGVycHJldGVyLmlzV2FpdGluZyA9IGZhbHNlOwogICAgICAgIHBvaW50ZXIgPSBfdGhpcy5pbnRlcnByZXRlci5wb2ludGVyOwogICAgICAgIGNvbW1hbmRzID0gX3RoaXMuaW50ZXJwcmV0ZXIuY29tbWFuZHM7CiAgICAgICAgaWYgKCFfdGhpcy5pbnRlcnByZXRlci5pc01lc3NhZ2VDb21tYW5kKHBvaW50ZXIsIGNvbW1hbmRzKSkgewogICAgICAgICAgR2FtZU1hbmFnZXIubWVzc2FnZVdpbmRvdy5jbG9zZSgpOwogICAgICAgICAgcmV0dXJuIEdhbWVNYW5hZ2VyLm1lc3NhZ2VXaW5kb3cuZXZlbnQuaXNMb2NrZWQgPSBmYWxzZTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIHJldHVybiB0aGlzLmludGVycHJldGVyLmlzV2FpdGluZyA9IHRydWU7CiAgICB9OwoKICAgIENvbW1hbmRJbnRlcnByZXRlci5wcm90b3R5cGUuY29tbWFuZFNob3dCdWJibGVNZXNzYWdlID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBldmVudCwgZXZlbnRTcHJpdGUsIGV4LCBleSwgaSwgbGluZSwgbGluZXMsIGxvbmdlc3RMaW5lLCBtYXAsIG1heFNpemUsIG1lc3NhZ2VXaW5kb3csIHMsIHNpemUsIHRleHQsIF9pLCBfaiwgX2xlbiwgX3JlZiwKICAgICAgICBfdGhpcyA9IHRoaXM7CiAgICAgIG1lc3NhZ2VXaW5kb3cgPSBHYW1lTWFuYWdlci5tZXNzYWdlV2luZG93OwogICAgICBpZiAodGhpcy5pbnRlcnByZXRlci5pc1Byb2Nlc3NpbmdNZXNzYWdlSW5PdGhlckNvbnRleHQoKSkgewogICAgICAgIHRoaXMuaW50ZXJwcmV0ZXIud2FpdEZvck1lc3NhZ2UoKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgcyA9IFdpbmRvd19CYXNlLnNjYWxlOwogICAgICBtYXAgPSBTY2VuZU1hbmFnZXIuc2NlbmUubWFwOwogICAgICBldmVudCA9IHRoaXMuaW50ZXJwcmV0ZXIuZXZlbnRCeUlkKHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy5ldmVudElkKSk7CiAgICAgIGV2ZW50LmlzTG9ja2VkID0gdHJ1ZTsKICAgICAgZXZlbnRTcHJpdGUgPSBtYXAuZXZlbnRzQnlJZFtldmVudC5pZF07CiAgICAgIGV4ID0gZXZlbnRTcHJpdGUueDsKICAgICAgZXkgPSBldmVudFNwcml0ZS55OwogICAgICB0ZXh0ID0gbnVsbDsKICAgICAgbGluZXMgPSBudWxsOwogICAgICBzaXplID0gbnVsbDsKICAgICAgbWF4U2l6ZSA9IDA7CiAgICAgIG1lc3NhZ2VXaW5kb3cuZXhlY3V0aW9uQ29udGV4dCA9IHRoaXMuaW50ZXJwcmV0ZXIuY29udGV4dDsKICAgICAgbWVzc2FnZVdpbmRvdy5tZXNzYWdlID0gbGNzbSh0aGlzLnBhcmFtcy5tZXNzYWdlKTsKICAgICAgdGV4dCA9IG1lc3NhZ2VXaW5kb3cucmVzb2x2ZVBsYWNlaG9sZGVycyhtZXNzYWdlV2luZG93Lm1lc3NhZ2UpOwogICAgICBsaW5lcyA9IHRleHQuc3BsaXQoJ1xuJyk7CiAgICAgIGxvbmdlc3RMaW5lID0gIiI7CiAgICAgIG1lc3NhZ2VXaW5kb3cuY29udGVudHMuZm9udCA9IG1lc3NhZ2VXaW5kb3cubWVzc2FnZUZvbnQ7CiAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gbGluZXMubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsKICAgICAgICBsaW5lID0gbGluZXNbX2ldOwogICAgICAgIHNpemUgPSBtZXNzYWdlV2luZG93LmNvbnRlbnRzLnRleHRTaXplKGxpbmUpOwogICAgICAgIGlmIChzaXplLndpZHRoID4gbWF4U2l6ZSkgewogICAgICAgICAgbG9uZ2VzdExpbmUgPSBsaW5lOwogICAgICAgIH0KICAgICAgfQogICAgICBmb3IgKGkgPSBfaiA9IDAsIF9yZWYgPSBsb25nZXN0TGluZS5sZW5ndGg7IDAgPD0gX3JlZiA/IF9qIDwgX3JlZiA6IF9qID4gX3JlZjsgaSA9IDAgPD0gX3JlZiA/ICsrX2ogOiAtLV9qKSB7CiAgICAgICAgc2l6ZSA9IG1lc3NhZ2VXaW5kb3cuY29udGVudHMudGV4dFNpemUobG9uZ2VzdExpbmUuY2hhckF0KGkpKTsKICAgICAgICBtYXhTaXplICs9IHNpemUud2lkdGg7CiAgICAgIH0KICAgICAgbWVzc2FnZVdpbmRvdy53aWR0aCA9IE1hdGguZmxvb3IobWF4U2l6ZSArIDI0ICogcyk7CiAgICAgIG1lc3NhZ2VXaW5kb3cuaGVpZ2h0ID0gTWF0aC5mbG9vcihsaW5lcy5sZW5ndGggKiAoc2l6ZS5oZWlnaHQgKyAxMCAqIHMpICsgMjIgKiBzKTsKICAgICAgbWVzc2FnZVdpbmRvdy5jb250ZW50cyA9IG5ldyBCaXRtYXAoTWF0aC5mbG9vcihtYXhTaXplKSwgTWF0aC5mbG9vcihsaW5lcy5sZW5ndGggKiAoc2l6ZS5oZWlnaHQgKyAxMCAqIHMpKSk7CiAgICAgIG1lc3NhZ2VXaW5kb3cuY29udGVudHMuZm9udCA9IG1lc3NhZ2VXaW5kb3cubWVzc2FnZUZvbnQ7CiAgICAgIG1lc3NhZ2VXaW5kb3cuZmFjZUdyYXBoaWMgPSBudWxsOwogICAgICBtZXNzYWdlV2luZG93LmZhY2VQYXR0ZXJuID0gMDsKICAgICAgbWVzc2FnZVdpbmRvdy5wb3NpdGlvbiA9IDA7CiAgICAgIG1lc3NhZ2VXaW5kb3cubmFtZSA9IHRoaXMucGFyYW1zLm5hbWUgfHwgIiI7CiAgICAgIG1lc3NhZ2VXaW5kb3cub3BhY2l0eSA9IHRoaXMucGFyYW1zLmhpZGVXaW5kb3cgPyAwIDogMjU1OwogICAgICBtZXNzYWdlV2luZG93Lm9wZW4oKTsKICAgICAgbWVzc2FnZVdpbmRvdy5zdGFydCgpOwogICAgICBtZXNzYWdlV2luZG93LmV2ZW50ID0gZXZlbnQ7CiAgICAgIG1lc3NhZ2VXaW5kb3cuc2Nyb2xsV2l0aE1hcCA9IHRydWU7CiAgICAgIG1lc3NhZ2VXaW5kb3cueCA9IE1hdGguZmxvb3IoTWF0aC5tYXgoZXggLSAobWVzc2FnZVdpbmRvdy53aWR0aCAtIGV2ZW50U3ByaXRlLnNyY1JlY3Qud2lkdGgpIC8gMiwgMCkpOwogICAgICBtZXNzYWdlV2luZG93LnkgPSBNYXRoLmZsb29yKE1hdGgubWF4KGV5IC0gbWVzc2FnZVdpbmRvdy5oZWlnaHQgLSA1ICogcywgMCkpOwogICAgICBtZXNzYWdlV2luZG93Lm9uRmluaXNoID0gZnVuY3Rpb24oKSB7CiAgICAgICAgdmFyIGNvbW1hbmRzLCBwb2ludGVyOwogICAgICAgIF90aGlzLmludGVycHJldGVyLmlzV2FpdGluZyA9IGZhbHNlOwogICAgICAgIHBvaW50ZXIgPSBfdGhpcy5pbnRlcnByZXRlci5wb2ludGVyOwogICAgICAgIGNvbW1hbmRzID0gX3RoaXMuaW50ZXJwcmV0ZXIuY29tbWFuZHM7CiAgICAgICAgaWYgKCFfdGhpcy5pbnRlcnByZXRlci5pc01lc3NhZ2VDb21tYW5kKHBvaW50ZXIsIGNvbW1hbmRzKSkgewogICAgICAgICAgR2FtZU1hbmFnZXIubWVzc2FnZVdpbmRvdy5jbG9zZSgpOwogICAgICAgICAgcmV0dXJuIEdhbWVNYW5hZ2VyLm1lc3NhZ2VXaW5kb3cuZXZlbnQuaXNMb2NrZWQgPSBmYWxzZTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIHJldHVybiB0aGlzLmludGVycHJldGVyLmlzV2FpdGluZyA9IHRydWU7CiAgICB9OwoKICAgIENvbW1hbmRJbnRlcnByZXRlci5wcm90b3R5cGUuX2NvbW1hbmRDaGFuZ2VJdGVtcyA9IGZ1bmN0aW9uKGl0ZW1zLCByZWNvcmRzLCBwYXJhbXMpIHsKICAgICAgdmFyIGl0ZW1JZCwgdmFsdWU7CiAgICAgIHZhbHVlID0gdGhpcy5udW1iZXJWYWx1ZU9mKHBhcmFtcy52YWx1ZSk7CiAgICAgIGl0ZW1JZCA9IHRoaXMubnVtYmVyVmFsdWVPZihwYXJhbXMuaXRlbUlkKTsKICAgICAgaWYgKGl0ZW1zW2l0ZW1JZF0gPT0gbnVsbCkgewogICAgICAgIGl0ZW1zW2l0ZW1JZF0gPSB7CiAgICAgICAgICBpdGVtOiByZWNvcmRzW2l0ZW1JZF0sCiAgICAgICAgICBjb3VudDogMAogICAgICAgIH07CiAgICAgIH0KICAgICAgc3dpdGNoIChwYXJhbXMub3BlcmF0aW9uKSB7CiAgICAgICAgY2FzZSAwOgogICAgICAgICAgcmV0dXJuIGl0ZW1zW2l0ZW1JZF0uY291bnQgPSB2YWx1ZTsKICAgICAgICBjYXNlIDE6CiAgICAgICAgICByZXR1cm4gaXRlbXNbaXRlbUlkXS5jb3VudCArPSB2YWx1ZTsKICAgICAgICBjYXNlIDI6CiAgICAgICAgICByZXR1cm4gaXRlbXNbaXRlbUlkXS5jb3VudCAtPSB2YWx1ZTsKICAgICAgfQogICAgfTsKCiAgICBDb21tYW5kSW50ZXJwcmV0ZXIucHJvdG90eXBlLmNvbW1hbmRDaGFuZ2VJdGVtcyA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gdGhpcy5pbnRlcnByZXRlci5fY29tbWFuZENoYW5nZUl0ZW1zKEdhbWVNYW5hZ2VyLmludmVudG9yeS5pdGVtcywgUmVjb3JkTWFuYWdlci5pdGVtcywgdGhpcy5wYXJhbXMpOwogICAgfTsKCiAgICBDb21tYW5kSW50ZXJwcmV0ZXIucHJvdG90eXBlLmNvbW1hbmRDaGFuZ2VXZWFwb25zID0gZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiB0aGlzLmludGVycHJldGVyLl9jb21tYW5kQ2hhbmdlSXRlbXMoR2FtZU1hbmFnZXIuaW52ZW50b3J5LndlYXBvbnMsIFJlY29yZE1hbmFnZXIud2VhcG9ucywgdGhpcy5wYXJhbXMpOwogICAgfTsKCiAgICBDb21tYW5kSW50ZXJwcmV0ZXIucHJvdG90eXBlLmNvbW1hbmRDaGFuZ2VBcm1vcnMgPSBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIHRoaXMuaW50ZXJwcmV0ZXIuX2NvbW1hbmRDaGFuZ2VJdGVtcyhHYW1lTWFuYWdlci5pbnZlbnRvcnkuYXJtb3JzLCBSZWNvcmRNYW5hZ2VyLmFybW9ycywgdGhpcy5wYXJhbXMpOwogICAgfTsKCiAgICBDb21tYW5kSW50ZXJwcmV0ZXIucHJvdG90eXBlLmNvbW1hbmRDaGFuZ2VNb25leSA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgdmFsdWU7CiAgICAgIHZhbHVlID0gMDsKICAgICAgc3dpdGNoICh0aGlzLnBhcmFtcy5vcGVyYXRpb24pIHsKICAgICAgICBjYXNlIDA6CiAgICAgICAgICB2YWx1ZSA9IHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy52YWx1ZSk7CiAgICAgICAgICByZXR1cm4gR2FtZU1hbmFnZXIubW9uZXkgPSB2YWx1ZTsKICAgICAgICBjYXNlIDE6CiAgICAgICAgICB2YWx1ZSA9IHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy5pbmNyZW1lbnQpOwogICAgICAgICAgcmV0dXJuIEdhbWVNYW5hZ2VyLm1vbmV5ICs9IHZhbHVlOwogICAgICAgIGNhc2UgMjoKICAgICAgICAgIHZhbHVlID0gdGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKHRoaXMucGFyYW1zLmRlY3JlbWVudCk7CiAgICAgICAgICByZXR1cm4gR2FtZU1hbmFnZXIubW9uZXkgLT0gdmFsdWU7CiAgICAgIH0KICAgIH07CgogICAgQ29tbWFuZEludGVycHJldGVyLnByb3RvdHlwZS5jb21tYW5kQ2hhbmdlV2VhdGhlciA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgZHVyYXRpb24sIHBvd2VyLCB3ZWF0aGVyOwogICAgICB3ZWF0aGVyID0gR2FtZU1hbmFnZXIud2VhdGhlcjsKICAgICAgcG93ZXIgPSB0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMucG93ZXIpOwogICAgICBkdXJhdGlvbiA9IHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy5kdXJhdGlvbik7CiAgICAgIGlmICh0aGlzLnBhcmFtcy50eXBlID09PSAwKSB7CiAgICAgICAgcG93ZXIgPSAwOwogICAgICB9IGVsc2UgewogICAgICAgIHdlYXRoZXIudHlwZSA9IHRoaXMucGFyYW1zLnR5cGUgLSAxOwogICAgICAgIGlmICh3ZWF0aGVyLnBvd2VyID09PSAwKSB7CiAgICAgICAgICB3ZWF0aGVyLmN1cnJlbnRQb3dlciA9IDE7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmIChkdXJhdGlvbiA+IDApIHsKICAgICAgICB3ZWF0aGVyLnBvd2VySW5jcmVtZW50ID0gTWF0aC5hYnMocG93ZXIgLSB3ZWF0aGVyLnBvd2VyKSAvIGR1cmF0aW9uOwogICAgICB9IGVsc2UgewogICAgICAgIHdlYXRoZXIuY3VycmVudFBvd2VyID0gcG93ZXI7CiAgICAgIH0KICAgICAgd2VhdGhlci5wb3dlciA9IHBvd2VyOwogICAgICByZXR1cm4gd2VhdGhlci5yZWZyZXNoKCk7CiAgICB9OwoKICAgIENvbW1hbmRJbnRlcnByZXRlci5wcm90b3R5cGUuY29tbWFuZFNoYWtlU2NyZWVuID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBkdXJhdGlvbiwgcG93ZXIsIHNwZWVkOwogICAgICBpZiAodGhpcy5wYXJhbXMuc3RhdHVzID09PSAxKSB7CiAgICAgICAgcmV0dXJuIEdhbWVNYW5hZ2VyLnNjcmVlbi5zdG9wU2hha2UoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBwb3dlciA9IHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy5wb3dlcik7CiAgICAgICAgc3BlZWQgPSB0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMuc3BlZWQpOwogICAgICAgIGR1cmF0aW9uID0gdGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKHRoaXMucGFyYW1zLmR1cmF0aW9uKTsKICAgICAgICBkdXJhdGlvbiA9IGR1cmF0aW9uID09PSAwID8gLTEgOiBkdXJhdGlvbjsKICAgICAgICBHYW1lTWFuYWdlci5zY3JlZW4uc3RhcnRTaGFrZShwb3dlciwgc3BlZWQsIGR1cmF0aW9uKTsKICAgICAgICBpZiAoIShkdXJhdGlvbiA9PT0gLTEpICYmIHRoaXMucGFyYW1zLndhaXRGb3JDb21wbGV0aW9uKSB7CiAgICAgICAgICB0aGlzLmludGVycHJldGVyLmlzV2FpdGluZyA9IHRydWU7CiAgICAgICAgICByZXR1cm4gdGhpcy5pbnRlcnByZXRlci53YWl0Q291bnRlciA9IGR1cmF0aW9uOwogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICBDb21tYW5kSW50ZXJwcmV0ZXIucHJvdG90eXBlLmNvbW1hbmRUaW50U2NyZWVuID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBkdXJhdGlvbjsKICAgICAgZHVyYXRpb24gPSB0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMuZHVyYXRpb24pOwogICAgICBHYW1lTWFuYWdlci5zY3JlZW4udGludCh0aGlzLnBhcmFtcy50b25lLCBkdXJhdGlvbik7CiAgICAgIGlmICh0aGlzLnBhcmFtcy53YWl0Rm9yQ29tcGxldGlvbiAmJiAhZHVyYXRpb24gPT09IDApIHsKICAgICAgICB0aGlzLmludGVycHJldGVyLmlzV2FpdGluZyA9IHRydWU7CiAgICAgICAgcmV0dXJuIHRoaXMuaW50ZXJwcmV0ZXIud2FpdENvdW50ZXIgPSBkdXJhdGlvbjsKICAgICAgfQogICAgfTsKCiAgICBDb21tYW5kSW50ZXJwcmV0ZXIucHJvdG90eXBlLmNvbW1hbmRGbGFzaFNjcmVlbiA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgZHVyYXRpb247CiAgICAgIGR1cmF0aW9uID0gdGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKHRoaXMucGFyYW1zLmR1cmF0aW9uKTsKICAgICAgR3JhcGhpY3Mudmlld3BvcnQuZmxhc2gobmV3IENvbG9yKHRoaXMucGFyYW1zLmNvbG9yKSwgZHVyYXRpb24pOwogICAgICBpZiAodGhpcy5wYXJhbXMud2FpdEZvckNvbXBsZXRpb24gJiYgIWR1cmF0aW9uID09PSAwKSB7CiAgICAgICAgdGhpcy5pbnRlcnByZXRlci5pc1dhaXRpbmcgPSB0cnVlOwogICAgICAgIHJldHVybiB0aGlzLmludGVycHJldGVyLndhaXRDb3VudGVyID0gZHVyYXRpb247CiAgICAgIH0KICAgIH07CgogICAgQ29tbWFuZEludGVycHJldGVyLnByb3RvdHlwZS5jb21tYW5kU2hvd1BpY3R1cmUgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIG51bWJlciwgcGljdHVyZSwgcGljdHVyZXMsIHgsIHk7CiAgICAgIG51bWJlciA9IHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy5udW1iZXIpOwogICAgICBwaWN0dXJlcyA9IEdhbWVNYW5hZ2VyLnBpY3R1cmVzOwogICAgICBpZiAocGljdHVyZXNbbnVtYmVyXSA9PSBudWxsKSB7CiAgICAgICAgcGljdHVyZXNbbnVtYmVyXSA9IG5ldyBTcHJpdGVfUGljdHVyZShuZXcgTG9naWNfUGljdHVyZSgpKTsKICAgICAgfQogICAgICB4ID0gdGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKHRoaXMucGFyYW1zLngpOwogICAgICB5ID0gdGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKHRoaXMucGFyYW1zLnkpOwogICAgICBwaWN0dXJlID0gcGljdHVyZXNbbnVtYmVyXTsKICAgICAgcGljdHVyZS5iaXRtYXAgPSBSZXNvdXJjZU1hbmFnZXIuZ2V0Qml0bWFwKCJHcmFwaGljcy9QaWN0dXJlcy8iICsgdGhpcy5wYXJhbXMuZ3JhcGhpYy5uYW1lKTsKICAgICAgcGljdHVyZS5zcmNSZWN0ID0gbmV3IFJlY3QoMCwgMCwgcGljdHVyZS5iaXRtYXAud2lkdGgsIHBpY3R1cmUuYml0bWFwLmhlaWdodCk7CiAgICAgIHBpY3R1cmUudmlzaWJsZSA9IHRydWU7CiAgICAgIHBpY3R1cmUubG9naWMuem9vbVggPSB0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMuc2NhbGVYKSAvIDEwMDsKICAgICAgcGljdHVyZS5sb2dpYy56b29tWSA9IHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy5zY2FsZVkpIC8gMTAwOwogICAgICB4ID0gdGhpcy5wYXJhbXMub3JpZ2luID09PSAwID8geCA6IHggLSAocGljdHVyZS5iaXRtYXAud2lkdGggKiBwaWN0dXJlLmxvZ2ljLnpvb21YKSAvIDI7CiAgICAgIHkgPSB0aGlzLnBhcmFtcy5vcmlnaW4gPT09IDAgPyB5IDogeSAtIChwaWN0dXJlLmJpdG1hcC5oZWlnaHQgKiBwaWN0dXJlLmxvZ2ljLnpvb21ZKSAvIDI7CiAgICAgIHggPSB0aGlzLnBhcmFtcy5zY3JlZW5PcmlnaW4gPT09IDAgPyB4IDogeCArIEdyYXBoaWNzLndpZHRoIC8gMjsKICAgICAgeSA9IHRoaXMucGFyYW1zLnNjcmVlbk9yaWdpbiA9PT0gMCA/IHkgOiB5ICsgR3JhcGhpY3MuaGVpZ2h0IC8gMjsKICAgICAgcGljdHVyZS5sb2dpYy54ID0geDsKICAgICAgcGljdHVyZS5sb2dpYy55ID0geTsKICAgICAgcGljdHVyZS5sb2dpYy5hbmdsZSA9IE1hdGguZGVncmVlc1RvUmFkaWFucyh0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMuYW5nbGUpKTsKICAgICAgcGljdHVyZS5sb2dpYy5vcGFjaXR5ID0gdGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKHRoaXMucGFyYW1zLm9wYWNpdHkpOwogICAgICBwaWN0dXJlLmJsZW5kaW5nTW9kZSA9IHRoaXMucGFyYW1zLmJsZW5kaW5nOwogICAgICByZXR1cm4gcGljdHVyZS56ID0gMjAwOwogICAgfTsKCiAgICBDb21tYW5kSW50ZXJwcmV0ZXIucHJvdG90eXBlLmNvbW1hbmRNb3ZlUGljdHVyZSA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgZHVyYXRpb24sIG51bWJlciwgcGljdHVyZSwgeCwgeSwgem9vbVgsIHpvb21ZOwogICAgICBudW1iZXIgPSB0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMubnVtYmVyKTsKICAgICAgcGljdHVyZSA9IEdhbWVNYW5hZ2VyLnBpY3R1cmVzW251bWJlcl07CiAgICAgIGlmIChwaWN0dXJlID09IG51bGwpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgem9vbVggPSBwaWN0dXJlLmxvZ2ljLnpvb21YOwogICAgICB6b29tWSA9IHBpY3R1cmUubG9naWMuem9vbVk7CiAgICAgIHggPSB0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMueCk7CiAgICAgIHkgPSB0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMueSk7CiAgICAgIHggPSB0aGlzLnBhcmFtcy5vcmlnaW4gPT09IDAgPyB4IDogeCAtIHBpY3R1cmUuYml0bWFwLndpZHRoICogem9vbVggLyAyOwogICAgICB5ID0gdGhpcy5wYXJhbXMub3JpZ2luID09PSAwID8geSA6IHkgLSBwaWN0dXJlLmJpdG1hcC5oZWlnaHQgKiB6b29tWSAvIDI7CiAgICAgIHggPSB0aGlzLnBhcmFtcy5zY3JlZW5PcmlnaW4gPT09IDAgPyB4IDogeCArIEdyYXBoaWNzLndpZHRoIC8gMjsKICAgICAgeSA9IHRoaXMucGFyYW1zLnNjcmVlbk9yaWdpbiA9PT0gMCA/IHkgOiB5ICsgR3JhcGhpY3MuaGVpZ2h0IC8gMjsKICAgICAgZHVyYXRpb24gPSB0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMuZHVyYXRpb24pOwogICAgICBwaWN0dXJlLmxvZ2ljLm1vdmVUbyh4LCB5LCBkdXJhdGlvbik7CiAgICAgIHBpY3R1cmUubG9naWMuem9vbVRvKHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy5zY2FsZVgpIC8gMTAwLCB0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMuc2NhbGVZKSAvIDEwMCwgZHVyYXRpb24pOwogICAgICBwaWN0dXJlLmxvZ2ljLmJsZW5kVG8odGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKHRoaXMucGFyYW1zLm9wYWNpdHkpLCBkdXJhdGlvbik7CiAgICAgIHBpY3R1cmUuYmxlbmRpbmdNb2RlID0gdGhpcy5wYXJhbXMuYmxlbmRpbmc7CiAgICAgIGlmICh0aGlzLnBhcmFtcy53YWl0Rm9yQ29tcGxldGlvbiAmJiAhKGR1cmF0aW9uID09PSAwKSkgewogICAgICAgIHRoaXMuaW50ZXJwcmV0ZXIuaXNXYWl0aW5nID0gdHJ1ZTsKICAgICAgICByZXR1cm4gdGhpcy5pbnRlcnByZXRlci53YWl0Q291bnRlciA9IGR1cmF0aW9uOwogICAgICB9CiAgICB9OwoKICAgIENvbW1hbmRJbnRlcnByZXRlci5wcm90b3R5cGUuY29tbWFuZFRpbnRQaWN0dXJlID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBkdXJhdGlvbiwgbnVtYmVyLCBwaWN0dXJlOwogICAgICBudW1iZXIgPSB0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMubnVtYmVyKTsKICAgICAgcGljdHVyZSA9IEdhbWVNYW5hZ2VyLnBpY3R1cmVzW251bWJlcl07CiAgICAgIGlmIChwaWN0dXJlID09IG51bGwpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgZHVyYXRpb24gPSB0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMuZHVyYXRpb24pOwogICAgICBwaWN0dXJlLmxvZ2ljLnRpbnRUbyh0aGlzLnBhcmFtcy50b25lLCBkdXJhdGlvbik7CiAgICAgIGlmICh0aGlzLnBhcmFtcy53YWl0Rm9yQ29tcGxldGlvbiAmJiAhKGR1cmF0aW9uID09PSAwKSkgewogICAgICAgIHRoaXMuaW50ZXJwcmV0ZXIuaXNXYWl0aW5nID0gdHJ1ZTsKICAgICAgICByZXR1cm4gdGhpcy5pbnRlcnByZXRlci53YWl0Q291bnRlciA9IGR1cmF0aW9uOwogICAgICB9CiAgICB9OwoKICAgIENvbW1hbmRJbnRlcnByZXRlci5wcm90b3R5cGUuY29tbWFuZFJvdGF0ZVBpY3R1cmUgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGR1cmF0aW9uLCBudW1iZXIsIHBpY3R1cmU7CiAgICAgIG51bWJlciA9IHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy5udW1iZXIpOwogICAgICBwaWN0dXJlID0gR2FtZU1hbmFnZXIucGljdHVyZXNbbnVtYmVyXTsKICAgICAgaWYgKHBpY3R1cmUgPT0gbnVsbCkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBkdXJhdGlvbiA9IHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy5kdXJhdGlvbik7CiAgICAgIGR1cmF0aW9uID0gZHVyYXRpb24gPT09IDAgPyAtMSA6IGR1cmF0aW9uOwogICAgICBwaWN0dXJlLmxvZ2ljLnJvdGF0ZSh0aGlzLnBhcmFtcy5kaXJlY3Rpb24sIHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy5zcGVlZCkgLyAxMDAsIGR1cmF0aW9uKTsKICAgICAgaWYgKHRoaXMucGFyYW1zLndhaXRGb3JDb21wbGV0aW9uICYmICEoZHVyYXRpb24gPT09IDApKSB7CiAgICAgICAgdGhpcy5pbnRlcnByZXRlci5pc1dhaXRpbmcgPSB0cnVlOwogICAgICAgIHJldHVybiB0aGlzLmludGVycHJldGVyLndhaXRDb3VudGVyID0gZHVyYXRpb247CiAgICAgIH0KICAgIH07CgogICAgQ29tbWFuZEludGVycHJldGVyLnByb3RvdHlwZS5jb21tYW5kRXJhc2VQaWN0dXJlID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBudW1iZXIsIHBpY3R1cmU7CiAgICAgIG51bWJlciA9IHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy5udW1iZXIpOwogICAgICBwaWN0dXJlID0gR2FtZU1hbmFnZXIucGljdHVyZXNbbnVtYmVyXTsKICAgICAgaWYgKHBpY3R1cmUgIT0gbnVsbCkgewogICAgICAgIHBpY3R1cmUuZGlzcG9zZSgpOwogICAgICB9CiAgICAgIHJldHVybiBHYW1lTWFuYWdlci5waWN0dXJlc1tudW1iZXJdID0gbnVsbDsKICAgIH07CgogICAgQ29tbWFuZEludGVycHJldGVyLnByb3RvdHlwZS5jb21tYW5kSW5wdXROdW1iZXIgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgdGhpcy5pbnRlcnByZXRlci5pc1dhaXRpbmcgPSB0cnVlOwogICAgICBpZiAodGhpcy5pbnRlcnByZXRlci5pc1Byb2Nlc3NpbmdNZXNzYWdlSW5PdGhlckNvbnRleHQoKSkgewogICAgICAgIHRoaXMuaW50ZXJwcmV0ZXIud2FpdEZvck1lc3NhZ2UoKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgaWYgKEdhbWVNYW5hZ2VyLmlucHV0TnVtYmVyV2luZG93ICE9IG51bGwpIHsKICAgICAgICBHYW1lTWFuYWdlci5pbnB1dE51bWJlcldpbmRvdy5kaXNwb3NlKCk7CiAgICAgIH0KICAgICAgR2FtZU1hbmFnZXIuaW5wdXROdW1iZXJXaW5kb3cgPSBuZXcgV2luZG93X0lucHV0TnVtYmVyKHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy5kaWdpdHMpKTsKICAgICAgR2FtZU1hbmFnZXIuaW5wdXROdW1iZXJXaW5kb3cuZXZlbnQgPSBHYW1lTWFuYWdlci5tYXAuY3VycmVudEV2ZW50OwogICAgICBHYW1lTWFuYWdlci5pbnB1dE51bWJlcldpbmRvdy5ldmVudC5pc0xvY2tlZCA9IHRydWU7CiAgICAgIEdhbWVNYW5hZ2VyLmlucHV0TnVtYmVyV2luZG93LmlzQ2FuY2VsYWJsZSA9IGZhbHNlOwogICAgICBHYW1lTWFuYWdlci5pbnB1dE51bWJlcldpbmRvdy5leGVjdXRpb25Db250ZXh0ID0gdGhpcy5pbnRlcnByZXRlci5jb250ZXh0OwogICAgICBHYW1lTWFuYWdlci5pbnB1dE51bWJlcldpbmRvdy5vbkFjY2VwdCA9IGZ1bmN0aW9uKG51bWJlcikgewogICAgICAgIF90aGlzLmludGVycHJldGVyLnNldE51bWJlclZhbHVlVG8oX3RoaXMucGFyYW1zLnZhcmlhYmxlLCBudW1iZXIpOwogICAgICAgIF90aGlzLmludGVycHJldGVyLmlzV2FpdGluZyA9IGZhbHNlOwogICAgICAgIGlmICghX3RoaXMuaW50ZXJwcmV0ZXIuaXNNZXNzYWdlQ29tbWFuZChfdGhpcy5pbnRlcnByZXRlci5wb2ludGVyLCBfdGhpcy5pbnRlcnByZXRlci5jb21tYW5kcykpIHsKICAgICAgICAgIEdhbWVNYW5hZ2VyLm1lc3NhZ2VXaW5kb3cuY2xvc2UoKTsKICAgICAgICAgIHJldHVybiBHYW1lTWFuYWdlci5pbnB1dE51bWJlcldpbmRvdy5ldmVudC5pc0xvY2tlZCA9IGZhbHNlOwogICAgICAgIH0KICAgICAgfTsKICAgICAgcmV0dXJuIEdhbWVNYW5hZ2VyLmlucHV0TnVtYmVyV2luZG93Lm9wZW4oKTsKICAgIH07CgogICAgQ29tbWFuZEludGVycHJldGVyLnByb3RvdHlwZS5jb21tYW5kU2hvd0Nob2ljZXMgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGNob2ljZXMsCiAgICAgICAgX3RoaXMgPSB0aGlzOwogICAgICBpZiAodGhpcy5pbnRlcnByZXRlci5pc1Byb2Nlc3NpbmdNZXNzYWdlSW5PdGhlckNvbnRleHQoKSkgewogICAgICAgIHRoaXMuaW50ZXJwcmV0ZXIud2FpdEZvck1lc3NhZ2UoKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgaWYgKEdhbWVNYW5hZ2VyLmNob2ljZVdpbmRvdyAhPSBudWxsKSB7CiAgICAgICAgR2FtZU1hbmFnZXIuY2hvaWNlV2luZG93LmRpc3Bvc2UoKTsKICAgICAgfQogICAgICBjb25zb2xlLmxvZyh0aGlzLnBhcmFtcyk7CiAgICAgIGNob2ljZXMgPSBbXTsKICAgICAgaWYgKHRoaXMucGFyYW1zLmNob2ljZVNlbGVjdGVkMSkgewogICAgICAgIGNob2ljZXMucHVzaCh7CiAgICAgICAgICB0ZXh0OiB0aGlzLmludGVycHJldGVyLnN0cmluZ1ZhbHVlT2YodGhpcy5wYXJhbXMuY2hvaWNlMSksCiAgICAgICAgICBpbmRleDogMAogICAgICAgIH0pOwogICAgICB9CiAgICAgIGlmICh0aGlzLnBhcmFtcy5jaG9pY2VTZWxlY3RlZDIpIHsKICAgICAgICBjaG9pY2VzLnB1c2goewogICAgICAgICAgdGV4dDogdGhpcy5pbnRlcnByZXRlci5zdHJpbmdWYWx1ZU9mKHRoaXMucGFyYW1zLmNob2ljZTIpLAogICAgICAgICAgaW5kZXg6IDEKICAgICAgICB9KTsKICAgICAgfQogICAgICBpZiAodGhpcy5wYXJhbXMuY2hvaWNlU2VsZWN0ZWQzKSB7CiAgICAgICAgY2hvaWNlcy5wdXNoKHsKICAgICAgICAgIHRleHQ6IHRoaXMuaW50ZXJwcmV0ZXIuc3RyaW5nVmFsdWVPZih0aGlzLnBhcmFtcy5jaG9pY2UzKSwKICAgICAgICAgIGluZGV4OiAyCiAgICAgICAgfSk7CiAgICAgIH0KICAgICAgaWYgKHRoaXMucGFyYW1zLmNob2ljZVNlbGVjdGVkNCkgewogICAgICAgIGNob2ljZXMucHVzaCh7CiAgICAgICAgICB0ZXh0OiB0aGlzLmludGVycHJldGVyLnN0cmluZ1ZhbHVlT2YodGhpcy5wYXJhbXMuY2hvaWNlNCksCiAgICAgICAgICBpbmRleDogMwogICAgICAgIH0pOwogICAgICB9CiAgICAgIGlmIChjaG9pY2VzLmxlbmd0aCA+IDApIHsKICAgICAgICB0aGlzLmludGVycHJldGVyLmlzV2FpdGluZyA9IHRydWU7CiAgICAgICAgR2FtZU1hbmFnZXIucGxheWVyLmlzUGxheWVyID0gZmFsc2U7CiAgICAgICAgR2FtZU1hbmFnZXIuY2hvaWNlV2luZG93ID0gbmV3IFdpbmRvd19DaG9pY2UoY2hvaWNlcyk7CiAgICAgICAgR2FtZU1hbmFnZXIuY2hvaWNlV2luZG93LmV2ZW50ID0gR2FtZU1hbmFnZXIubWFwLmN1cnJlbnRFdmVudDsKICAgICAgICBHYW1lTWFuYWdlci5jaG9pY2VXaW5kb3cuZXZlbnQuaXNMb2NrZWQgPSB0cnVlOwogICAgICAgIEdhbWVNYW5hZ2VyLmNob2ljZVdpbmRvdy5leGVjdXRpb25Db250ZXh0ID0gdGhpcy5pbnRlcnByZXRlci5jb250ZXh0OwogICAgICAgIEdhbWVNYW5hZ2VyLmNob2ljZVdpbmRvdy5vblNlbGVjdGlvbkFjY2VwdCA9IGZ1bmN0aW9uKHNlbmRlciwgY2hvaWNlKSB7CiAgICAgICAgICBfdGhpcy5pbnRlcnByZXRlci5jaG9pY2UgPSAiZ3MuQ2hvaWNlIiArIChjaG9pY2UuaW5kZXggKyAxKTsKICAgICAgICAgIF90aGlzLmludGVycHJldGVyLmlzV2FpdGluZyA9IGZhbHNlOwogICAgICAgICAgR2FtZU1hbmFnZXIucGxheWVyLmlzUGxheWVyID0gdHJ1ZTsKICAgICAgICAgIGlmICghX3RoaXMuaW50ZXJwcmV0ZXIuaXNNZXNzYWdlQ29tbWFuZChfdGhpcy5pbnRlcnByZXRlci5wb2ludGVyLCBfdGhpcy5pbnRlcnByZXRlci5jb21tYW5kcykpIHsKICAgICAgICAgICAgR2FtZU1hbmFnZXIuY2hvaWNlV2luZG93LmV2ZW50LmlzTG9ja2VkID0gZmFsc2U7CiAgICAgICAgICAgIEdhbWVNYW5hZ2VyLm1lc3NhZ2VXaW5kb3cuY2xvc2UoKTsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBHYW1lTWFuYWdlci5jaG9pY2VXaW5kb3cuY2xvc2UoKTsKICAgICAgICB9OwogICAgICAgIGlmICh0aGlzLnBhcmFtcy5jYW5jZWxDYXNlID4gMCkgewogICAgICAgICAgR2FtZU1hbmFnZXIuY2hvaWNlV2luZG93Lm9uQ2FuY2VsID0gZnVuY3Rpb24oc2VuZGVyKSB7CiAgICAgICAgICAgIGlmIChfdGhpcy5wYXJhbXMuY2FuY2VsQ2FzZSA9PT0gMSkgewogICAgICAgICAgICAgIF90aGlzLmludGVycHJldGVyLmNob2ljZSA9ICJncy5DaG9pY2VDYW5jZWwiOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIF90aGlzLmludGVycHJldGVyLmNob2ljZSA9ICJncy5DaG9pY2UiICsgKF90aGlzLnBhcmFtcy5jYW5jZWxDYXNlIC0gMSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgX3RoaXMuaW50ZXJwcmV0ZXIuaXNXYWl0aW5nID0gZmFsc2U7CiAgICAgICAgICAgIEdhbWVNYW5hZ2VyLnBsYXllci5pc1BsYXllciA9IHRydWU7CiAgICAgICAgICAgIGlmICghX3RoaXMuaW50ZXJwcmV0ZXIuaXNNZXNzYWdlQ29tbWFuZChfdGhpcy5pbnRlcnByZXRlci5wb2ludGVyLCBfdGhpcy5pbnRlcnByZXRlci5jb21tYW5kcykpIHsKICAgICAgICAgICAgICBHYW1lTWFuYWdlci5jaG9pY2VXaW5kb3cuZXZlbnQuaXNMb2NrZWQgPSBmYWxzZTsKICAgICAgICAgICAgICBHYW1lTWFuYWdlci5tZXNzYWdlV2luZG93LmNsb3NlKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIEdhbWVNYW5hZ2VyLmNob2ljZVdpbmRvdy5jbG9zZSgpOwogICAgICAgICAgfTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIEdhbWVNYW5hZ2VyLmNob2ljZVdpbmRvdy5vcGVuKCk7CiAgICAgIH0KICAgIH07CgogICAgQ29tbWFuZEludGVycHJldGVyLnByb3RvdHlwZS5jb21tYW5kQ2hvaWNlID0gZnVuY3Rpb24oKSB7CiAgICAgIGlmICh0aGlzLmludGVycHJldGVyLmNob2ljZSAhPT0gdGhpcy5ub2RlSWQpIHsKICAgICAgICB0aGlzLmludGVycHJldGVyLnNraXAodGhpcy5pbmRlbnQpOwogICAgICAgIHJldHVybiB0aGlzLmludGVycHJldGVyLnBvaW50ZXItLTsKICAgICAgfQogICAgfTsKCiAgICBDb21tYW5kSW50ZXJwcmV0ZXIucHJvdG90eXBlLmNvbW1hbmRPcGVuTWVudSA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gU2NlbmVNYW5hZ2VyLnN3aXRjaFRvKG5ldyBTY2VuZV9NYWluTWVudSgpKTsKICAgIH07CgogICAgQ29tbWFuZEludGVycHJldGVyLnByb3RvdHlwZS5jb21tYW5kT3BlblNhdmVNZW51ID0gZnVuY3Rpb24oKSB7fTsKCiAgICBDb21tYW5kSW50ZXJwcmV0ZXIucHJvdG90eXBlLmNvbW1hbmRSZXR1cm5Ub1RpdGxlID0gZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiBTY2VuZU1hbmFnZXIuc3dpdGNoVG8obmV3IFNjZW5lX1RpdGxlKCkpOwogICAgfTsKCiAgICBDb21tYW5kSW50ZXJwcmV0ZXIucHJvdG90eXBlLmNvbW1hbmRHYW1lT3ZlciA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gU2NlbmVNYW5hZ2VyLnN3aXRjaFRvKG5ldyBTY2VuZV9HYW1lT3ZlcigpKTsKICAgIH07CgogICAgQ29tbWFuZEludGVycHJldGVyLnByb3RvdHlwZS5jb21tYW5kT3BlblNob3AgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGFybW9ycywgaXRlbSwgaXRlbXMsIHJlY29yZCwgc2hvcCwgd2VhcG9ucywgX2ksIF9sZW4sIF9yZWY7CiAgICAgIHNob3AgPSBuZXcgU2NlbmVfU2hvcCgpOwogICAgICBpdGVtcyA9IFtdOwogICAgICB3ZWFwb25zID0gW107CiAgICAgIGFybW9ycyA9IFtdOwogICAgICByZWNvcmQgPSBudWxsOwogICAgICBfcmVmID0gdGhpcy5wYXJhbXMuaXRlbXM7CiAgICAgIGZvciAoX2kgPSAwLCBfbGVuID0gX3JlZi5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykgewogICAgICAgIGl0ZW0gPSBfcmVmW19pXTsKICAgICAgICBzd2l0Y2ggKGl0ZW0udHlwZSkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICByZWNvcmQgPSBSZWNvcmRNYW5hZ2VyLml0ZW1zW2l0ZW0uaXRlbUlkXTsKICAgICAgICAgICAgaXRlbXMucHVzaCh7CiAgICAgICAgICAgICAgaXRlbTogcmVjb3JkLAogICAgICAgICAgICAgIHByaWNlOiBpdGVtLnByaWNlVHlwZSA9PT0gMCA/IHJlY29yZC5wcmljZSA6IGl0ZW0ucHJpY2UKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICByZWNvcmQgPSBSZWNvcmRNYW5hZ2VyLndlYXBvbnNbaXRlbS53ZWFwb25JZF07CiAgICAgICAgICAgIHdlYXBvbnMucHVzaCh7CiAgICAgICAgICAgICAgaXRlbTogcmVjb3JkLAogICAgICAgICAgICAgIHByaWNlOiBpdGVtLnByaWNlVHlwZSA9PT0gMCA/IHJlY29yZC5wcmljZSA6IGl0ZW0ucHJpY2UKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICByZWNvcmQgPSBSZWNvcmRNYW5hZ2VyLmFybW9yc1tpdGVtLmFybW9ySWRdOwogICAgICAgICAgICBhcm1vcnMucHVzaCh7CiAgICAgICAgICAgICAgaXRlbTogcmVjb3JkLAogICAgICAgICAgICAgIHByaWNlOiBpdGVtLnByaWNlVHlwZSA9PT0gMCA/IHJlY29yZC5wcmljZSA6IGl0ZW0ucHJpY2UKICAgICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHNob3AuaXRlbXMgPSBpdGVtczsKICAgICAgc2hvcC53ZWFwb25zID0gd2VhcG9uczsKICAgICAgc2hvcC5hcm1vcnMgPSBhcm1vcnM7CiAgICAgIHNob3AubW9kZSA9IHRoaXMucGFyYW1zLm1vZGU7CiAgICAgIHJldHVybiBTY2VuZU1hbmFnZXIuc3dpdGNoVG8oc2hvcCk7CiAgICB9OwoKICAgIENvbW1hbmRJbnRlcnByZXRlci5wcm90b3R5cGUuY29tbWFuZENoYW5nZVdpbmRvd1NraW4gPSBmdW5jdGlvbigpIHsKICAgICAgR2FtZU1hbmFnZXIud2luZG93U2tpbiA9IFJlc291cmNlTWFuYWdlci5nZXRCaXRtYXAoIkdyYXBoaWNzLyIgKyB0aGlzLnBhcmFtcy5ncmFwaGljLm5hbWUpOwogICAgICByZXR1cm4gR2FtZU1hbmFnZXIud2luZG93U2tpblRvbmUuc2V0KHRoaXMucGFyYW1zLnRvbmUpOwogICAgfTsKCiAgICBDb21tYW5kSW50ZXJwcmV0ZXIucHJvdG90eXBlLmNvbW1hbmRDaGFuZ2VBY3RvckdyYXBoaWMgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGFjdG9yLCBtZW1iZXI7CiAgICAgIGFjdG9yID0gUmVjb3JkTWFuYWdlci5hY3RvcnNbdGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKHRoaXMucGFyYW1zLmFjdG9ySWQpXTsKICAgICAgbWVtYmVyID0gbnVsbDsKICAgICAgaWYgKGFjdG9yICE9IG51bGwpIHsKICAgICAgICBtZW1iZXIgPSBHYW1lTWFuYWdlci5wYXJ0eS5tZW1iZXJCeUlkKGFjdG9yLmluZGV4KTsKICAgICAgICBpZiAodGhpcy5wYXJhbXMuY2hhbmdlQ2hhcmFjdGVyKSB7CiAgICAgICAgICBhY3Rvci5jaGFyYWN0ZXJHcmFwaGljID0gdGhpcy5wYXJhbXMuY2hhcmFjdGVyR3JhcGhpYzsKICAgICAgICAgIGFjdG9yLmNoYXJhY3RlclBhdHRlcm4gPSB0aGlzLnBhcmFtcy5jaGFyYWN0ZXJQYXR0ZXJuOwogICAgICAgIH0KICAgICAgICBpZiAodGhpcy5wYXJhbXMuY2hhbmdlRmFjZSkgewogICAgICAgICAgYWN0b3IuZmFjZUdyYXBoaWMgPSB0aGlzLnBhcmFtcy5mYWNlR3JhcGhpYzsKICAgICAgICAgIGFjdG9yLmZhY2VQYXR0ZXJuID0gdGhpcy5wYXJhbXMuZmFjZVBhdHRlcm47CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmIChtZW1iZXIgIT0gbnVsbCkgewogICAgICAgIGlmICh0aGlzLnBhcmFtcy5jaGFuZ2VDaGFyYWN0ZXIpIHsKICAgICAgICAgIG1lbWJlci5jaGFyYWN0ZXJHcmFwaGljID0gdGhpcy5wYXJhbXMuY2hhcmFjdGVyR3JhcGhpYzsKICAgICAgICAgIG1lbWJlci5jaGFyYWN0ZXJQYXR0ZXJuID0gdGhpcy5wYXJhbXMuY2hhcmFjdGVyUGF0dGVybjsKICAgICAgICB9CiAgICAgICAgaWYgKHRoaXMucGFyYW1zLmNoYW5nZUZhY2UpIHsKICAgICAgICAgIG1lbWJlci5mYWNlR3JhcGhpYyA9IHRoaXMucGFyYW1zLmZhY2VHcmFwaGljOwogICAgICAgICAgcmV0dXJuIG1lbWJlci5mYWNlUGF0dGVybiA9IHRoaXMucGFyYW1zLmZhY2VQYXR0ZXJuOwogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICBDb21tYW5kSW50ZXJwcmV0ZXIucHJvdG90eXBlLmNvbW1hbmRDaGFuZ2VQYXJ0eSA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgYWN0b3I7CiAgICAgIGFjdG9yID0gUmVjb3JkTWFuYWdlci5hY3RvcnNbdGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKHRoaXMucGFyYW1zLmFjdG9ySWQpXTsKICAgICAgaWYgKGFjdG9yICE9IG51bGwpIHsKICAgICAgICBzd2l0Y2ggKHRoaXMucGFyYW1zLm9wZXJhdGlvbikgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICByZXR1cm4gR2FtZU1hbmFnZXIucGFydHkuYWRkKGFjdG9yKTsKICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgcmV0dXJuIEdhbWVNYW5hZ2VyLnBhcnR5LnJlbW92ZShhY3Rvcik7CiAgICAgICAgfQogICAgICB9CiAgICB9OwoKICAgIENvbW1hbmRJbnRlcnByZXRlci5wcm90b3R5cGUuY29tbWFuZENoYW5nZU1lbnVBY2Nlc3MgPSBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIEdhbWVNYW5hZ2VyLm1lbnVBY2Nlc3MgPSB0aGlzLnBhcmFtcy5hY2Nlc3M7CiAgICB9OwoKICAgIENvbW1hbmRJbnRlcnByZXRlci5wcm90b3R5cGUuY29tbWFuZENoYW5nZVNhdmVNZW51QWNjZXNzID0gZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiBHYW1lTWFuYWdlci5zYXZlTWVudUFjY2VzcyA9IHRoaXMucGFyYW1zLmFjY2VzcyA9PT0gMDsKICAgIH07CgogICAgQ29tbWFuZEludGVycHJldGVyLnByb3RvdHlwZS5jaGFuZ2VBY3RvclByb3BlcnR5ID0gZnVuY3Rpb24ocHJvcGVydHksIHBhcmFtcykgewogICAgICB2YXIgYWN0b3IsIG1lbWJlcjsKICAgICAgYWN0b3IgPSBSZWNvcmRNYW5hZ2VyLmFjdG9yc1t0aGlzLm51bWJlclZhbHVlT2YocGFyYW1zLmFjdG9ySWQpXTsKICAgICAgaWYgKGFjdG9yICE9IG51bGwpIHsKICAgICAgICBtZW1iZXIgPSBHYW1lTWFuYWdlci5wYXJ0eS5tZW1iZXJCeUlkKGFjdG9yLmluZGV4KTsKICAgICAgICBpZiAobWVtYmVyICE9IG51bGwpIHsKICAgICAgICAgIHN3aXRjaCAocGFyYW1zLm9wZXJhdGlvbikgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgbWVtYmVyW3Byb3BlcnR5XSA9IHRoaXMubnVtYmVyVmFsdWVPZihwYXJhbXMudmFsdWUpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgbWVtYmVyWyJjaGFuZ2UiICsgcHJvcGVydHkuY2FwaXRhbGl6ZSgpXSh0aGlzLm51bWJlclZhbHVlT2YocGFyYW1zLnZhbHVlKSk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICBtZW1iZXJbImNoYW5nZSIgKyBwcm9wZXJ0eS5jYXBpdGFsaXplKCldKC0odGhpcy5udW1iZXJWYWx1ZU9mKHBhcmFtcy52YWx1ZSkpKTsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChwYXJhbXMuYXZvaWREZWF0aCAmJiBtZW1iZXIubHAgPT09IDApIHsKICAgICAgICAgICAgbWVtYmVyLmxwID0gMTsKICAgICAgICAgIH0KICAgICAgICAgIG1lbWJlci5sZXZlbFVwKG1lbWJlci5sZXZlbCk7CiAgICAgICAgICBtZW1iZXIucmVmcmVzaCgpOwogICAgICAgICAgaWYgKCFHYW1lTWFuYWdlci5wYXJ0eS5pc0FsaXZlKCkpIHsKICAgICAgICAgICAgcmV0dXJuIFNjZW5lTWFuYWdlci5zd2l0Y2hUbyhuZXcgU2NlbmVfR2FtZU92ZXIoKSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9OwoKICAgIENvbW1hbmRJbnRlcnByZXRlci5wcm90b3R5cGUuY29tbWFuZENoYW5nZUFjdG9yTHAgPSBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIHRoaXMuaW50ZXJwcmV0ZXIuY2hhbmdlQWN0b3JQcm9wZXJ0eSgibHAiLCB0aGlzLnBhcmFtcyk7CiAgICB9OwoKICAgIENvbW1hbmRJbnRlcnByZXRlci5wcm90b3R5cGUuY29tbWFuZENoYW5nZUFjdG9yTXAgPSBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIHRoaXMuaW50ZXJwcmV0ZXIuY2hhbmdlQWN0b3JQcm9wZXJ0eSgibXAiLCB0aGlzLnBhcmFtcyk7CiAgICB9OwoKICAgIENvbW1hbmRJbnRlcnByZXRlci5wcm90b3R5cGUuY29tbWFuZENoYW5nZUFjdG9yRXhwID0gZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiB0aGlzLmludGVycHJldGVyLmNoYW5nZUFjdG9yUHJvcGVydHkoImV4cCIsIHRoaXMucGFyYW1zKTsKICAgIH07CgogICAgQ29tbWFuZEludGVycHJldGVyLnByb3RvdHlwZS5jb21tYW5kQ2hhbmdlQWN0b3JDbGFzcyA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgYWN0b3IsIGNsYXp6LCBtZW1iZXI7CiAgICAgIGFjdG9yID0gUmVjb3JkTWFuYWdlci5hY3RvcnNbdGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKHRoaXMucGFyYW1zLmFjdG9ySWQpXTsKICAgICAgY2xhenogPSBSZWNvcmRNYW5hZ2VyLmNsYXNzZXNbdGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKHRoaXMucGFyYW1zLmNsYXNzSWQpXTsKICAgICAgaWYgKChhY3RvciAhPSBudWxsKSAmJiAoY2xhenogIT0gbnVsbCkpIHsKICAgICAgICBhY3RvclsiY2xhc3MiXSA9IGNsYXp6OwogICAgICAgIG1lbWJlciA9IEdhbWVNYW5hZ2VyLnBhcnR5Lm1lbWJlckJ5SWQoYWN0b3IuaW5kZXgpOwogICAgICAgIGlmIChtZW1iZXIgIT0gbnVsbCkgewogICAgICAgICAgbWVtYmVyWyJjbGFzcyJdID0gY2xheno7CiAgICAgICAgICByZXR1cm4gbWVtYmVyLnJlZnJlc2goKTsKICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgQ29tbWFuZEludGVycHJldGVyLnByb3RvdHlwZS5jb21tYW5kQ2hhbmdlQWN0b3JOYW1lID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBhY3RvciwgbWVtYmVyOwogICAgICBhY3RvciA9IFJlY29yZE1hbmFnZXIuYWN0b3JzW3RoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy5hY3RvcklkKV07CiAgICAgIGlmIChhY3RvciAhPSBudWxsKSB7CiAgICAgICAgYWN0b3IubmFtZSA9IHRoaXMuaW50ZXJwcmV0ZXIuc3RyaW5nVmFsdWVPZih0aGlzLnBhcmFtcy5uYW1lKTsKICAgICAgICBtZW1iZXIgPSBHYW1lTWFuYWdlci5wYXJ0eS5tZW1iZXJCeUlkKGFjdG9yLmluZGV4KTsKICAgICAgICBpZiAobWVtYmVyICE9IG51bGwpIHsKICAgICAgICAgIHJldHVybiBtZW1iZXIubmFtZSA9IGFjdG9yLm5hbWU7CiAgICAgICAgfQogICAgICB9CiAgICB9OwoKICAgIENvbW1hbmRJbnRlcnByZXRlci5wcm90b3R5cGUuY29tbWFuZENoYW5nZUFjdG9yTGV2ZWwgPSBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIHRoaXMuaW50ZXJwcmV0ZXIuY2hhbmdlQWN0b3JQcm9wZXJ0eSgibGV2ZWwiLCB0aGlzLnBhcmFtcyk7CiAgICB9OwoKICAgIENvbW1hbmRJbnRlcnByZXRlci5wcm90b3R5cGUuY29tbWFuZENoYW5nZUFjdG9yU3RhdGUgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGFjdG9yLCBtZW1iZXIsIHN0YXRlOwogICAgICBhY3RvciA9IFJlY29yZE1hbmFnZXIuYWN0b3JzW3RoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy5hY3RvcklkKV07CiAgICAgIHN0YXRlID0gUmVjb3JkTWFuYWdlci5zdGF0ZXNbdGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKHRoaXMucGFyYW1zLnN0YXRlSWQpXTsKICAgICAgaWYgKChhY3RvciAhPSBudWxsKSAmJiAoc3RhdGUgIT0gbnVsbCkpIHsKICAgICAgICBtZW1iZXIgPSBHYW1lTWFuYWdlci5wYXJ0eS5tZW1iZXJCeUlkKGFjdG9yLmluZGV4KTsKICAgICAgICBpZiAobWVtYmVyICE9IG51bGwpIHsKICAgICAgICAgIHN3aXRjaCAocC5vcGVyYXRpb24pIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIHJldHVybiBtZW1iZXIuYWRkU3RhdGUoc3RhdGUpOwogICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgcmV0dXJuIG1lbWJlci5yZW1vdmVTdGF0ZShzdGF0ZSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9OwoKICAgIENvbW1hbmRJbnRlcnByZXRlci5wcm90b3R5cGUuY29tbWFuZENoYW5nZUFjdG9yU2tpbGxzID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBhY3RvciwgbWVtYmVyLCBza2lsbDsKICAgICAgYWN0b3IgPSBSZWNvcmRNYW5hZ2VyLmFjdG9yc1t0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMuYWN0b3JJZCldOwogICAgICBza2lsbCA9IFJlY29yZE1hbmFnZXIuc2tpbGxzW3RoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy5za2lsbElkKV07CiAgICAgIGlmICgoYWN0b3IgIT0gbnVsbCkgJiYgKHNraWxsICE9IG51bGwpKSB7CiAgICAgICAgbWVtYmVyID0gR2FtZU1hbmFnZXIucGFydHkubWVtYmVyQnlJZChhY3Rvci5pbmRleCk7CiAgICAgICAgaWYgKG1lbWJlciAhPSBudWxsKSB7CiAgICAgICAgICBzd2l0Y2ggKHRoaXMucGFyYW1zLm9wZXJhdGlvbikgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgcmV0dXJuIG1lbWJlci5hZGRTa2lsbChza2lsbCk7CiAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICByZXR1cm4gbWVtYmVyLnJlbW92ZVNraWxsKHNraWxsKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgQ29tbWFuZEludGVycHJldGVyLnByb3RvdHlwZS5jb21tYW5kQ2hhbmdlQWN0b3JFcXVpcG1lbnQgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGFjdG9yLCBpZCwgbWVtYmVyOwogICAgICBhY3RvciA9IFJlY29yZE1hbmFnZXIuYWN0b3JzW3RoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy5hY3RvcklkKV07CiAgICAgIGlmIChhY3RvciAhPSBudWxsKSB7CiAgICAgICAgbWVtYmVyID0gR2FtZU1hbmFnZXIucGFydHkubWVtYmVyQnlJZChhY3Rvci5pbmRleCk7CiAgICAgICAgaWYgKG1lbWJlciAhPSBudWxsKSB7CiAgICAgICAgICBzd2l0Y2ggKHRoaXMucGFyYW1zLmVxdWlwVHlwZSkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgaWQgPSB0aGlzLnBhcmFtcy53ZWFwb25JZDsKICAgICAgICAgICAgICBpZiAoaWQgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgaWQgPSB0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMud2VhcG9uSWQpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBtZW1iZXIud2VhcG9uID0gUmVjb3JkTWFuYWdlci53ZWFwb25zW2lkXTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgIGlkID0gdGhpcy5wYXJhbXMuc2hpZWxkSWQ7CiAgICAgICAgICAgICAgaWYgKGlkICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIGlkID0gdGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKHRoaXMucGFyYW1zLnNoaWVsZElkKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgbWVtYmVyLnNoaWVsZCA9IFJlY29yZE1hbmFnZXIuYXJtb3JzW2lkXTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgIGlkID0gdGhpcy5wYXJhbXMuaGVhZEFybW9ySWQ7CiAgICAgICAgICAgICAgaWYgKGlkICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIGlkID0gdGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKHRoaXMucGFyYW1zLmhlYWRBcm1vcklkKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgbWVtYmVyLmhlYWQgPSBSZWNvcmRNYW5hZ2VyLmFybW9yc1tpZF07CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICBpZCA9IHRoaXMucGFyYW1zLmJvZHlBcm1vcklkOwogICAgICAgICAgICAgIGlmIChpZCAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICBpZCA9IHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy5ib2R5QXJtb3JJZCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIG1lbWJlci5ib2R5ID0gUmVjb3JkTWFuYWdlci5hcm1vcnNbaWRdOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgaWQgPSB0aGlzLnBhcmFtcy5hY2Nlc3NvcnlJZDsKICAgICAgICAgICAgICBpZiAoaWQgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgaWQgPSB0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMuYWNjZXNzb3J5SWQpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBtZW1iZXIuYWNjZXNzb3J5ID0gUmVjb3JkTWFuYWdlci5hcm1vcnNbaWRdOwogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuIG1lbWJlci5yZWZyZXNoKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9OwoKICAgIENvbW1hbmRJbnRlcnByZXRlci5wcm90b3R5cGUuY29tbWFuZENoYW5nZUFjdG9yUGFyYW1ldGVycyA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgYWN0b3IsIG1lbWJlciwgcGFyYW07CiAgICAgIGFjdG9yID0gUmVjb3JkTWFuYWdlci5hY3RvcnNbdGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKHRoaXMucGFyYW1zLmFjdG9ySWQpXTsKICAgICAgcGFyYW0gPSBNYXRoLm1pbihNYXRoLm1heCh0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMucGFyYW1ldGVyKSwgMCksIDcpOwogICAgICBpZiAoYWN0b3IgIT0gbnVsbCkgewogICAgICAgIG1lbWJlciA9IEdhbWVNYW5hZ2VyLnBhcnR5Lm1lbWJlckJ5SWQoYWN0b3IuaW5kZXgpOwogICAgICAgIGlmIChtZW1iZXIgIT0gbnVsbCkgewogICAgICAgICAgc3dpdGNoIChwLm9wZXJhdGlvbikgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgcmV0dXJuIG1lbWJlci5zZXRCYXNlUGFyYW1ldGVyKHBhcmFtLCB0aGlzLnBhcmFtcy52YWx1ZSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9OwoKICAgIENvbW1hbmRJbnRlcnByZXRlci5wcm90b3R5cGUuY29tbWFuZFBsYXlNdXNpYyA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gQXVkaW9NYW5hZ2VyLnBsYXlNdXNpYyh0aGlzLnBhcmFtcy5tdXNpYy5uYW1lLCB0aGlzLnBhcmFtcy5tdXNpYy52b2x1bWUsIHRoaXMucGFyYW1zLm11c2ljLnBsYXliYWNrUmF0ZSwgdGhpcy5wYXJhbXMuZmFkZUluRHVyYXRpb24pOwogICAgfTsKCiAgICBDb21tYW5kSW50ZXJwcmV0ZXIucHJvdG90eXBlLmNvbW1hbmRTdG9wTXVzaWMgPSBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIEF1ZGlvTWFuYWdlci5zdG9wTXVzaWModGhpcy5wYXJhbXMuZmFkZU91dER1cmF0aW9uKTsKICAgIH07CgogICAgQ29tbWFuZEludGVycHJldGVyLnByb3RvdHlwZS5jb21tYW5kUGF1c2VNdXNpYyA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gQXVkaW9NYW5hZ2VyLnN0b3BNdXNpYyh0aGlzLnBhcmFtcy5mYWRlT3V0RHVyYXRpb24pOwogICAgfTsKCiAgICBDb21tYW5kSW50ZXJwcmV0ZXIucHJvdG90eXBlLmNvbW1hbmRSZXN1bWVNdXNpYyA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gQXVkaW9NYW5hZ2VyLnJlc3VtZU11c2ljKHRoaXMucGFyYW1zLmZhZGVJbkR1cmF0aW9uKTsKICAgIH07CgogICAgQ29tbWFuZEludGVycHJldGVyLnByb3RvdHlwZS5jb21tYW5kUGxheVNvdW5kID0gZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiBBdWRpb01hbmFnZXIucGxheVNvdW5kKHRoaXMucGFyYW1zLnNvdW5kLm5hbWUsIHRoaXMucGFyYW1zLnNvdW5kLnZvbHVtZSwgdGhpcy5wYXJhbXMuc291bmQucGxheWJhY2tSYXRlLCB0aGlzLnBhcmFtcy5tdXNpY0VmZmVjdCk7CiAgICB9OwoKICAgIENvbW1hbmRJbnRlcnByZXRlci5wcm90b3R5cGUuY29tbWFuZFBsYXlCYWNrZ3JvdW5kU291bmQgPSBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIEF1ZGlvTWFuYWdlci5wbGF5QmFja2dyb3VuZFNvdW5kKHRoaXMucGFyYW1zLm11c2ljLm5hbWUsIHRoaXMucGFyYW1zLm11c2ljLnZvbHVtZSwgdGhpcy5wYXJhbXMubXVzaWMucGxheWJhY2tSYXRlLCB0aGlzLnBhcmFtcy5mYWRlSW5EdXJhdGlvbik7CiAgICB9OwoKICAgIENvbW1hbmRJbnRlcnByZXRlci5wcm90b3R5cGUuY29tbWFuZFN0b3BCYWNrZ3JvdW5kU291bmQgPSBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIEF1ZGlvTWFuYWdlci5zdG9wQmFja2dyb3VuZFNvdW5kKHRoaXMucGFyYW1zLmZhZGVPdXREdXJhdGlvbik7CiAgICB9OwoKICAgIENvbW1hbmRJbnRlcnByZXRlci5wcm90b3R5cGUuY29tbWFuZFBhdXNlQmFja2dyb3VuZFNvdW5kID0gZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiBBdWRpb01hbmFnZXIucGF1c2VCYWNrZ3JvdW5kU291bmQoKTsKICAgIH07CgogICAgQ29tbWFuZEludGVycHJldGVyLnByb3RvdHlwZS5jb21tYW5kUmVzdW1lQmFja2dyb3VuZFNvdW5kID0gZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiBBdWRpb01hbmFnZXIucmVzdW1lQmFja2dyb3VuZFNvdW5kKCk7CiAgICB9OwoKICAgIENvbW1hbmRJbnRlcnByZXRlci5wcm90b3R5cGUuY29tbWFuZENoYW5nZU1hcEVuY291bnRlciA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gR2FtZU1hbmFnZXIubWFwRW5jb3VudGVyID0gdGhpcy5wYXJhbXMuYWNjZXNzID09PSAwOwogICAgfTsKCiAgICBDb21tYW5kSW50ZXJwcmV0ZXIucHJvdG90eXBlLmNvbW1hbmRDaGFuZ2VNYXBUaWxlc2V0ID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciB0aWxlc2V0OwogICAgICBpZiAoR2FtZU1hbmFnZXIubWFwICE9IG51bGwpIHsKICAgICAgICB0aWxlc2V0ID0gUmVjb3JkTWFuYWdlci50aWxlc2V0c1t0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMudGlsZXNldElkKV07CiAgICAgICAgaWYgKHRpbGVzZXQgIT0gbnVsbCkgewogICAgICAgICAgR2FtZU1hbmFnZXIubWFwLnRpbGVzZXQgPSBSZWNvcmRNYW5hZ2VyLnRpbGVzZXRzW3RoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy50aWxlc2V0SWQpXTsKICAgICAgICAgIHJldHVybiBHYW1lTWFuYWdlci5tYXAuYXV0b3RpbGVzID0gR2FtZU1hbmFnZXIubWFwLnRpbGVzZXQuYXV0b3RpbGVHcmFwaGljczsKICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgQ29tbWFuZEludGVycHJldGVyLnByb3RvdHlwZS5jb21tYW5kQ2hhbmdlTWFwVGlsZXMgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGxheWVyLCBtYXAsIHRpbGUsIHRpbGVzZXQ7CiAgICAgIG1hcCA9IEdhbWVNYW5hZ2VyLm1hcDsKICAgICAgaWYgKG1hcCAhPSBudWxsKSB7CiAgICAgICAgdGlsZXNldCA9IG1hcC50aWxlc2V0OwogICAgICAgIHRpbGUgPSB0aGlzLnBhcmFtcy5zb3VyY2VUaWxlICsgMzg0OwogICAgICAgIGxheWVyID0gdGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKHRoaXMucGFyYW1zLmxheWVyKTsKICAgICAgICBzd2l0Y2ggKHRoaXMucGFyYW1zLnR5cGUpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgcmV0dXJuIG1hcC5zZXRUaWxlKHRoaXMucGFyYW1zLnRhcmdldFRpbGUgKyAzODQsIHRoaXMucGFyYW1zLnNvdXJjZVRpbGUgKyAzODQsIGxheWVyKTsKICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgcmV0dXJuIG1hcC5zZXRUaWxlKHRoaXMucGFyYW1zLmRpcmVjdExvY2F0aW9uLmxvY2F0aW9uLngsIHRoaXMucGFyYW1zLmRpcmVjdExvY2F0aW9uLmxvY2F0aW9uLnksIGxheWVyLCB0aWxlKTsKICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgcmV0dXJuIG1hcC5zZXRUaWxlKHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy5sb2NhdGlvbi54KSwgdGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKHRoaXMucGFyYW1zLmxvY2F0aW9uLnkpLCBsYXllciwgdGlsZSk7CiAgICAgICAgfQogICAgICB9CiAgICB9OwoKICAgIENvbW1hbmRJbnRlcnByZXRlci5wcm90b3R5cGUuY29tbWFuZENoYW5nZU1hcFBhcmFsbGF4QmFja2dyb3VuZCA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgbWFwOwogICAgICBtYXAgPSBHYW1lTWFuYWdlci5tYXA7CiAgICAgIGlmIChtYXAgIT0gbnVsbCkgewogICAgICAgIG1hcC5wYXJhbGxheEJhY2tncm91bmQgPSB0aGlzLnBhcmFtcy5ncmFwaGljOwogICAgICAgIG1hcC5sb29wUGFyYWxsYXhWZXJ0aWNhbCA9IHRoaXMucGFyYW1zLmxvb3BQYXJhbGxheFZlcnRpY2FsOwogICAgICAgIG1hcC5sb29wUGFyYWxsYXhIb3Jpem9udGFsID0gdGhpcy5wYXJhbXMubG9vcFBhcmFsbGF4SG9yaXpvbnRhbDsKICAgICAgICBtYXAudmVydGljYWxQYXJhbGxheFNjcm9sbCA9IHRoaXMucGFyYW1zLnZlcnRpY2FsUGFyYWxsYXhTY3JvbGw7CiAgICAgICAgcmV0dXJuIG1hcC5ob3Jpem9udGFsUGFyYWxsYXhTY3JvbGwgPSB0aGlzLnBhcmFtcy5ob3Jpem9udGFsUGFyYWxsYXhTY3JvbGw7CiAgICAgIH0KICAgIH07CgogICAgQ29tbWFuZEludGVycHJldGVyLnByb3RvdHlwZS5jb21tYW5kR2V0TWFwTG9jYXRpb25JbmZvID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBpbmZvLCBtYXAsIHR5cGUsIHgsIHk7CiAgICAgIG1hcCA9IEdhbWVNYW5hZ2VyLm1hcDsKICAgICAgaW5mbyA9IG51bGw7CiAgICAgIGlmIChtYXAgIT0gbnVsbCkgewogICAgICAgIHR5cGUgPSB0aGlzLnBhcmFtcy5sb2NhdGlvblR5cGU7CiAgICAgICAgc3dpdGNoICh0eXBlKSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIHggPSB0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMuZGlyZWN0TG9jYXRpb24ubG9jYXRpb24ueCk7CiAgICAgICAgICAgIHkgPSB0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMuZGlyZWN0TG9jYXRpb24ubG9jYXRpb24ueSk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICB4ID0gdGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKHRoaXMucGFyYW1zLmxvY2F0aW9uLngpOwogICAgICAgICAgICB5ID0gdGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKHRoaXMucGFyYW1zLmxvY2F0aW9uLnkpOwogICAgICAgIH0KICAgICAgICBpbmZvID0gbWFwLmxvY2F0aW9uRGF0YSh4LCB5LCB0aGlzLnBhcmFtcy5sb2NhdGlvbkluZm8pOwogICAgICAgIHJldHVybiB0aGlzLmludGVycHJldGVyLnNldE51bWJlclZhbHVlVG8odGhpcy5wYXJhbXMudmFyaWFibGUsIGluZm8pOwogICAgICB9CiAgICB9OwoKICAgIENvbW1hbmRJbnRlcnByZXRlci5wcm90b3R5cGUuY29tbWFuZFN0YXJ0QmF0dGxlID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBzY2VuZTsKICAgICAgR2FtZU1hbmFnZXIudHJvb3AgPSBSZWNvcmRNYW5hZ2VyLnRyb29wc1t0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMudHJvb3BJZCldOwogICAgICBzY2VuZSA9IG5ldyBTY2VuZV9CYXR0bGUoKTsKICAgICAgc2NlbmUubm9Fc2NhcGUgPSB0aGlzLnBhcmFtcy5ub0VzY2FwZTsKICAgICAgc2NlbmUuY29udGludWVPbkxvc2UgPSB0aGlzLnBhcmFtcy5jb250aW51ZU9uTG9zZTsKICAgICAgcmV0dXJuIFNjZW5lTWFuYWdlci5zd2l0Y2hUbyhzY2VuZSk7CiAgICB9OwoKICAgIENvbW1hbmRJbnRlcnByZXRlci5wcm90b3R5cGUuY2hhbmdlRW5lbXlQcm9wZXJ0eSA9IGZ1bmN0aW9uKHByb3BlcnR5LCBwYXJhbXMpIHsKICAgICAgdmFyIGluZGV4LCBzY2VuZTsKICAgICAgaWYgKEdhbWVNYW5hZ2VyLmluQmF0dGxlKSB7CiAgICAgICAgc2NlbmUgPSBTY2VuZU1hbmFnZXIuc2NlbmU7CiAgICAgICAgaW5kZXggPSB0aGlzLm51bWJlclZhbHVlT2YocGFyYW1zLmVuZW15SWQpOwogICAgICAgIGlmIChpbmRleCA+PSAwICYmIGluZGV4IDwgc2NlbmUuZW5lbWllcy5sZW5ndGgpIHsKICAgICAgICAgIHN3aXRjaCAocGFyYW1zLm9wZXJhdGlvbikgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgcmV0dXJuIHNjZW5lLmVuZW1pZXNbaW5kZXhdW3Byb3BlcnR5XSA9IHRoaXMubnVtYmVyVmFsdWVPZihwYXJhbXMudmFsdWUpOwogICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgcmV0dXJuIHNjZW5lLmVuZW1pZXNbaW5kZXhdWyJjaGFuZ2UiICsgcHJvcGVydHkuY2FwaXRhbGl6ZSgpXSh0aGlzLm51bWJlclZhbHVlT2YocGFyYW1zLnZhbHVlKSk7CiAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICByZXR1cm4gc2NlbmUuZW5lbWllc1tpbmRleF1bImNoYW5nZSIgKyBwcm9wZXJ0eS5jYXBpdGFsaXplKCldKC0odGhpcy5udW1iZXJWYWx1ZU9mKHBhcmFtcy52YWx1ZSkpKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgQ29tbWFuZEludGVycHJldGVyLnByb3RvdHlwZS5jb21tYW5kQ2hhbmdlRW5lbXlMcCA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gdGhpcy5pbnRlcnByZXRlci5jaGFuZ2VFbmVteVByb3BlcnR5KCJscCIsIHRoaXMucGFyYW1zKTsKICAgIH07CgogICAgQ29tbWFuZEludGVycHJldGVyLnByb3RvdHlwZS5jb21tYW5kQ2hhbmdlRW5lbXlNcCA9IGZ1bmN0aW9uKCkgewogICAgICByZXR1cm4gdGhpcy5pbnRlcnByZXRlci5jaGFuZ2VFbmVteVByb3BlcnR5KCJtcCIsIHRoaXMucGFyYW1zKTsKICAgIH07CgogICAgQ29tbWFuZEludGVycHJldGVyLnByb3RvdHlwZS5jb21tYW5kQ2hhbmdlRW5lbXlTdGF0ZSA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgZW5lbXksIGluZGV4LCBzY2VuZSwgc3RhdGU7CiAgICAgIGlmIChHYW1lTWFuYWdlci5pbkJhdHRsZSkgewogICAgICAgIHNjZW5lID0gU2NlbmVNYW5hZ2VyLnNjZW5lOwogICAgICAgIGluZGV4ID0gdGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKHRoaXMucGFyYW1zLmVuZW15SWQpOwogICAgICAgIGlmIChpbmRleCA+PSAwICYmIGluZGV4IDwgc2NlbmUuZW5lbWllcy5sZW5ndGgpIHsKICAgICAgICAgIGVuZW15ID0gc2NlbmUuZW5lbWllc1tpbmRleF07CiAgICAgICAgICBzdGF0ZSA9IFJlY29yZE1hbmFnZXIuc3RhdGVzW3RoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy5zdGF0ZUlkKV07CiAgICAgICAgICBpZiAoKGVuZW15ICE9IG51bGwpICYmIChzdGF0ZSAhPSBudWxsKSkgewogICAgICAgICAgICBzd2l0Y2ggKHAub3BlcmF0aW9uKSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgcmV0dXJuIGVuZW15LmFkZFN0YXRlKHN0YXRlKTsKICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgICByZXR1cm4gZW5lbXkucmVtb3ZlU3RhdGUoc3RhdGUpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9OwoKICAgIENvbW1hbmRJbnRlcnByZXRlci5wcm90b3R5cGUuY29tbWFuZFNob3dFbmVteSA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgZW5lbXksIGluZGV4LCBzY2VuZTsKICAgICAgaWYgKEdhbWVNYW5hZ2VyLmluQmF0dGxlKSB7CiAgICAgICAgc2NlbmUgPSBTY2VuZU1hbmFnZXIuc2NlbmU7CiAgICAgICAgaW5kZXggPSB0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMuZW5lbXlJZCk7CiAgICAgICAgaWYgKGluZGV4ID49IDAgJiYgaW5kZXggPCBzY2VuZS5lbmVtaWVzLmxlbmd0aCkgewogICAgICAgICAgZW5lbXkgPSBzY2VuZS5lbmVtaWVzW2luZGV4XTsKICAgICAgICAgIGlmIChlbmVteS5hY3Rvci5pc0FsaXZlICYmIGVuZW15LmlzSGlkZGVuKSB7CiAgICAgICAgICAgIHJldHVybiBlbmVteS5pc0hpZGRlbiA9IGZhbHNlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICBDb21tYW5kSW50ZXJwcmV0ZXIucHJvdG90eXBlLmNvbW1hbmRUcmFuc2Zvcm1FbmVteSA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgaW5kZXgsIHNjZW5lLCB0YXJnZXQ7CiAgICAgIHNjZW5lID0gU2NlbmVNYW5hZ2VyLnNjZW5lOwogICAgICBpZiAoc2NlbmUgaW5zdGFuY2VvZiBTY2VuZV9CYXR0bGUpIHsKICAgICAgICBpbmRleCA9IHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy5lbmVteUlkKTsKICAgICAgICB0YXJnZXQgPSBSZWNvcmRNYW5hZ2VyLmVuZW1pZXNbdGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKHRoaXMucGFyYW1zLnRhcmdldElkKV07CiAgICAgICAgcmV0dXJuIHNjZW5lLnRyYW5zZm9ybUVuZW15KGluZGV4LCB0YXJnZXQpOwogICAgICB9CiAgICB9OwoKICAgIENvbW1hbmRJbnRlcnByZXRlci5wcm90b3R5cGUuY29tbWFuZEFib3J0QmF0dGxlID0gZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiBTY2VuZU1hbmFnZXIuc3dpdGNoVG8obmV3IFNjZW5lX01hcCgpKTsKICAgIH07CgogICAgQ29tbWFuZEludGVycHJldGVyLnByb3RvdHlwZS5jb21tYW5kU2Nyb2xsTWFwID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBkdXJhdGlvbiwgc3RlcHNYLCBzdGVwc1k7CiAgICAgIHN0ZXBzWCA9IHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy5zdGVwc1gpOwogICAgICBzdGVwc1kgPSB0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMuc3RlcHNZKTsKICAgICAgZHVyYXRpb24gPSB0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMuZHVyYXRpb24pOwogICAgICByZXR1cm4gR2FtZU1hbmFnZXIuc2NyZWVuLnNjcm9sbChzdGVwc1gsIHN0ZXBzWSwgZHVyYXRpb24pOwogICAgfTsKCiAgICBDb21tYW5kSW50ZXJwcmV0ZXIucHJvdG90eXBlLnNldEV2ZW50TG9jYXRpb24gPSBmdW5jdGlvbihldmVudCwgcGFyYW1zKSB7CiAgICAgIHZhciB4LCB5OwogICAgICBpZiAoZXZlbnQgIT0gbnVsbCkgewogICAgICAgIHggPSB0aGlzLm51bWJlclZhbHVlT2YocGFyYW1zLngpOwogICAgICAgIHkgPSB0aGlzLm51bWJlclZhbHVlT2YocGFyYW1zLnkpOwogICAgICAgIGV2ZW50LnNldFRpbGVMb2NhdGlvbih4LCB5KTsKICAgICAgICBpZiAocGFyYW1zLmNoYW5nZURpcmVjdGlvbikgewogICAgICAgICAgZXZlbnQuZGlyZWN0aW9uID0gdGhpcy5udW1iZXJWYWx1ZU9mKHBhcmFtcy5kaXJlY3Rpb24pOwogICAgICAgIH0KICAgICAgICBpZiAoZXZlbnQgPT09IEdhbWVNYW5hZ2VyLnBsYXllcikgewogICAgICAgICAgcmV0dXJuIEdhbWVNYW5hZ2VyLnNjcmVlbi5jZW50ZXJPbihldmVudC54LCBldmVudC55KTsKICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgQ29tbWFuZEludGVycHJldGVyLnByb3RvdHlwZS5jb21tYW5kU2V0RXZlbnRMb2NhdGlvbiA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgZXZlbnQsIGV2ZW50SWQ7CiAgICAgIGV2ZW50SWQgPSB0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMuZXZlbnRJZCk7CiAgICAgIGV2ZW50ID0gdGhpcy5pbnRlcnByZXRlci5ldmVudEJ5SWQoZXZlbnRJZCk7CiAgICAgIHJldHVybiB0aGlzLmludGVycHJldGVyLnNldEV2ZW50TG9jYXRpb24oZXZlbnQsIHRoaXMucGFyYW1zKTsKICAgIH07CgogICAgQ29tbWFuZEludGVycHJldGVyLnByb3RvdHlwZS5jb21tYW5kU2V0R2xvYmFsRXZlbnRMb2NhdGlvbiA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgZXZlbnQsIGV2ZW50SWQ7CiAgICAgIGV2ZW50SWQgPSB0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMuZXZlbnRJZCk7CiAgICAgIGV2ZW50ID0gdGhpcy5pbnRlcnByZXRlci5nbG9iYWxFdmVudEJ5SWQoZXZlbnRJZCk7CiAgICAgIHJldHVybiB0aGlzLmludGVycHJldGVyLnNldEV2ZW50TG9jYXRpb24oZXZlbnQsIHRoaXMucGFyYW1zKTsKICAgIH07CgogICAgQ29tbWFuZEludGVycHJldGVyLnByb3RvdHlwZS5jb21tYW5kQ3JlYXRlRXZlbnQgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGRhdGEsIHBhcmFtZXRlcnMsIHBlcm1hbmVudGx5LCB0ZW1wbGF0ZUlkLCB1aWQsIHgsIHk7CiAgICAgIHggPSB0aGlzLnBhcmFtcy5sb2NhdGlvblR5cGUgPT09IDAgPyB0aGlzLnBhcmFtcy5kaXJlY3RMb2NhdGlvbi5sb2NhdGlvbi54IDogdGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKHRoaXMucGFyYW1zLmxvY2F0aW9uLngpOwogICAgICB5ID0gdGhpcy5wYXJhbXMubG9jYXRpb25UeXBlID09PSAwID8gdGhpcy5wYXJhbXMuZGlyZWN0TG9jYXRpb24ubG9jYXRpb24ueSA6IHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy5sb2NhdGlvbi55KTsKICAgICAgdWlkID0gdGhpcy5wYXJhbXMubG9jYXRpb25UeXBlID09PSAwID8gdGhpcy5wYXJhbXMuZGlyZWN0TG9jYXRpb24ubWFwLnVpZCA6IHRoaXMuaW50ZXJwcmV0ZXIuc3RyaW5nVmFsdWVPZih0aGlzLnBhcmFtcy5tYXAudWlkKTsKICAgICAgdGVtcGxhdGVJZCA9IHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy5ldmVudFRlbXBsYXRlSWQpOwogICAgICBwYXJhbWV0ZXJzID0gdGhpcy5wYXJhbXMucGFyYW1ldGVyczsKICAgICAgcGVybWFuZW50bHkgPSB0aGlzLnBhcmFtcy5wZXJtYW5lbnRseTsKICAgICAgaWYgKHVpZCA9PT0gIiIpIHsKICAgICAgICB1aWQgPSBHYW1lTWFuYWdlci5tYXAuaWQ7CiAgICAgIH0KICAgICAgZGF0YSA9IEdhbWVNYW5hZ2VyLmFkZEV2ZW50Q3JlYXRpb24odWlkLCB4LCB5LCB0ZW1wbGF0ZUlkLCBwYXJhbWV0ZXJzLCBwZXJtYW5lbnRseSk7CiAgICAgIGlmIChHYW1lTWFuYWdlci5tYXAuaWQgPT09IHVpZCkgewogICAgICAgIHJldHVybiBHYW1lTWFuYWdlci5tYXAuYWRkRXZlbnRGcm9tRGF0YSh7CiAgICAgICAgICBpZDogZGF0YS5pZCwKICAgICAgICAgIHg6IHgsCiAgICAgICAgICB5OiB5LAogICAgICAgICAgdGVtcGxhdGVJZDogdGVtcGxhdGVJZCwKICAgICAgICAgIHBhcmFtZXRlcnM6IHBhcmFtZXRlcnMKICAgICAgICB9KTsKICAgICAgfQogICAgfTsKCiAgICBDb21tYW5kSW50ZXJwcmV0ZXIucHJvdG90eXBlLmNvbW1hbmRFcmFzZUV2ZW50ID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBldmVudCwgZXZlbnRJZDsKICAgICAgZXZlbnRJZCA9IHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy5ldmVudElkKTsKICAgICAgZXZlbnQgPSBudWxsOwogICAgICBpZiAoZXZlbnRJZCA9PT0gLTEpIHsKICAgICAgICBldmVudCA9IEdhbWVNYW5hZ2VyLm1hcC5jdXJyZW50RXZlbnQ7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZXZlbnQgPSBHYW1lTWFuYWdlci5tYXAuZXZlbnRzQnlJZFtldmVudElkXTsKICAgICAgfQogICAgICBpZiAoZXZlbnQgIT0gbnVsbCkgewogICAgICAgIGV2ZW50LmVyYXNlKCk7CiAgICAgIH0KICAgICAgaWYgKHRoaXMucGFyYW1zLnBlcm1hbmVudGx5KSB7CiAgICAgICAgcmV0dXJuIEdhbWVNYW5hZ2VyLmFkZEV2ZW50RGVsZXRpb24oR2FtZU1hbmFnZXIubWFwLmlkLCBldmVudC5pZCk7CiAgICAgIH0KICAgIH07CgogICAgQ29tbWFuZEludGVycHJldGVyLnByb3RvdHlwZS5jb21tYW5kTW92ZUdsb2JhbEV2ZW50ID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBldmVudCwgaWQsCiAgICAgICAgX3RoaXMgPSB0aGlzOwogICAgICBpZCA9IHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy5ldmVudCk7CiAgICAgIGV2ZW50ID0gdGhpcy5pbnRlcnByZXRlci5nbG9iYWxFdmVudEJ5SWQoaWQpOwogICAgICBpZiAoZXZlbnQgIT0gbnVsbCkgewogICAgICAgIGV2ZW50Lm1vdmVSb3V0ZSh0aGlzLnBhcmFtcyk7CiAgICAgICAgaWYgKHRoaXMucGFyYW1zLndhaXRGb3JDb21wbGV0aW9uKSB7CiAgICAgICAgICBldmVudC5vblJvdXRlRmluaXNoID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIF90aGlzLmludGVycHJldGVyLmlzV2FpdGluZyA9IGZhbHNlOwogICAgICAgICAgICBldmVudC5vblJvdXRlRmluaXNoID0gbnVsbDsKICAgICAgICAgICAgcmV0dXJuIGV2ZW50Lm1vdmVSb3V0ZShldmVudC5hdXRvTW92ZW1lbnRSb3V0ZSk7CiAgICAgICAgICB9OwogICAgICAgICAgcmV0dXJuIHRoaXMuaW50ZXJwcmV0ZXIuaXNXYWl0aW5nID0gdHJ1ZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmV0dXJuIGV2ZW50Lm9uUm91dGVGaW5pc2ggPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgZXZlbnQub25Sb3V0ZUZpbmlzaCA9IG51bGw7CiAgICAgICAgICAgIHJldHVybiBldmVudC5tb3ZlUm91dGUoZXZlbnQuYXV0b01vdmVtZW50Um91dGUpOwogICAgICAgICAgfTsKICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgQ29tbWFuZEludGVycHJldGVyLnByb3RvdHlwZS5jb21tYW5kRXJhc2VHbG9iYWxFdmVudCA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgZXZlbnQsIGV2ZW50SWQ7CiAgICAgIGV2ZW50SWQgPSB0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMuZXZlbnRJZCk7CiAgICAgIGV2ZW50ID0gdGhpcy5pbnRlcnByZXRlci5nbG9iYWxFdmVudEJ5SWQoZXZlbnRJZCk7CiAgICAgIGlmIChldmVudCAhPSBudWxsKSB7CiAgICAgICAgcmV0dXJuIGV2ZW50LmVyYXNlKCk7CiAgICAgIH0KICAgIH07CgogICAgQ29tbWFuZEludGVycHJldGVyLnByb3RvdHlwZS5jb21tYW5kRW5kR2xvYmFsRXZlbnQgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGV2ZW50LCBldmVudElkOwogICAgICBldmVudElkID0gdGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKHRoaXMucGFyYW1zLmV2ZW50SWQpOwogICAgICBldmVudCA9IHRoaXMuaW50ZXJwcmV0ZXIuZ2xvYmFsRXZlbnRCeUlkKGV2ZW50SWQpOwogICAgICBpZiAoZXZlbnQgIT0gbnVsbCkgewogICAgICAgIHJldHVybiBldmVudC5zdG9wKCk7CiAgICAgIH0KICAgIH07CgogICAgQ29tbWFuZEludGVycHJldGVyLnByb3RvdHlwZS5jb21tYW5kRW5kRXZlbnQgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGV2ZW50LCBldmVudElkOwogICAgICBldmVudElkID0gdGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKHRoaXMucGFyYW1zLmV2ZW50SWQpOwogICAgICBldmVudCA9IG51bGw7CiAgICAgIGlmIChldmVudElkID09PSAtMSkgewogICAgICAgIGV2ZW50ID0gR2FtZU1hbmFnZXIubWFwLmN1cnJlbnRFdmVudDsKICAgICAgfSBlbHNlIHsKICAgICAgICBldmVudCA9IEdhbWVNYW5hZ2VyLm1hcC5ldmVudHNCeUlkW2V2ZW50SWRdOwogICAgICB9CiAgICAgIGlmIChldmVudCAhPSBudWxsKSB7CiAgICAgICAgcmV0dXJuIGV2ZW50LnN0b3AoKTsKICAgICAgfQogICAgfTsKCiAgICBDb21tYW5kSW50ZXJwcmV0ZXIucHJvdG90eXBlLmNvbW1hbmRDYWxsQ29tbW9uRXZlbnQgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGNvbW1vbkV2ZW50LCBldmVudElkLAogICAgICAgIF90aGlzID0gdGhpczsKICAgICAgZXZlbnRJZCA9IHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy5ldmVudElkKTsKICAgICAgY29tbW9uRXZlbnQgPSBHYW1lTWFuYWdlci5jb21tb25FdmVudHNbZXZlbnRJZF07CiAgICAgIGlmIChjb21tb25FdmVudCAhPSBudWxsKSB7CiAgICAgICAgdGhpcy5pbnRlcnByZXRlci5zdWJJbnRlcnByZXRlciA9IGNvbW1vbkV2ZW50LmNhbGwodGhpcy5wYXJhbXMucGFyYW1ldGVycyB8fCBbXSk7CiAgICAgICAgdGhpcy5pbnRlcnByZXRlci5jb250ZXh0ID0gdGhpczsKICAgICAgICB0aGlzLmludGVycHJldGVyLnN1YkludGVycHJldGVyLm9uRmluaXNoID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICBfdGhpcy5pbnRlcnByZXRlci5zdWJJbnRlcnByZXRlci5vbkZpbmlzaCA9IG51bGw7CiAgICAgICAgICBfdGhpcy5pbnRlcnByZXRlci5zdWJJbnRlcnByZXRlciA9IG51bGw7CiAgICAgICAgICByZXR1cm4gX3RoaXMuaW50ZXJwcmV0ZXIuaXNXYWl0aW5nID0gZmFsc2U7CiAgICAgICAgfTsKICAgICAgICB0aGlzLmludGVycHJldGVyLmlzV2FpdGluZyA9IHRydWU7CiAgICAgICAgdGhpcy5pbnRlcnByZXRlci5zdWJJbnRlcnByZXRlci5zdGFydCgpOwogICAgICAgIHJldHVybiB0aGlzLmludGVycHJldGVyLnN1YkludGVycHJldGVyLnVwZGF0ZSgpOwogICAgICB9CiAgICB9OwoKICAgIENvbW1hbmRJbnRlcnByZXRlci5wcm90b3R5cGUuY29tbWFuZENoYW5nZVRpbWVyID0gZnVuY3Rpb24oKSB7CiAgICAgIHN3aXRjaCAodGhpcy5wYXJhbXMub3BlcmF0aW9uKSB7CiAgICAgICAgY2FzZSAwOgogICAgICAgICAgaWYgKHRoaXMucGFyYW1zLnN0b3BXYXRjaCkgewogICAgICAgICAgICBHYW1lTWFuYWdlci50aW1lci5zdG9wV2F0Y2ggPSB0cnVlOwogICAgICAgICAgICBHYW1lTWFuYWdlci50aW1lci5taW51dGVzID0gMDsKICAgICAgICAgICAgR2FtZU1hbmFnZXIudGltZXIuc2Vjb25kcyA9IDA7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBHYW1lTWFuYWdlci50aW1lci5zdG9wV2F0Y2ggPSBmYWxzZTsKICAgICAgICAgICAgR2FtZU1hbmFnZXIudGltZXIubWludXRlcyA9IHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy5taW51dGVzKTsKICAgICAgICAgICAgR2FtZU1hbmFnZXIudGltZXIuc2Vjb25kcyA9IHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy5zZWNvbmRzKTsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBHYW1lTWFuYWdlci50aW1lci5zdGFydCgpOwogICAgICAgIGNhc2UgMToKICAgICAgICAgIHJldHVybiBHYW1lTWFuYWdlci50aW1lci5zdG9wKCk7CiAgICAgICAgY2FzZSAyOgogICAgICAgICAgcmV0dXJuIEdhbWVNYW5hZ2VyLnRpbWVyLnBhdXNlKCk7CiAgICAgICAgY2FzZSAzOgogICAgICAgICAgcmV0dXJuIEdhbWVNYW5hZ2VyLnRpbWVyLnJlc3VtZSgpOwogICAgICB9CiAgICB9OwoKICAgIENvbW1hbmRJbnRlcnByZXRlci5wcm90b3R5cGUuY29tbWFuZFNob3dCYXR0bGVBbmltYXRpb24gPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGFuaW1hdGlvbiwgZW5lbXksIGxvZ2ljLCBzcHJpdGVzZXQsCiAgICAgICAgX3RoaXMgPSB0aGlzOwogICAgICBhbmltYXRpb24gPSBSZWNvcmRNYW5hZ2VyLmFuaW1hdGlvbnNbdGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKHRoaXMucGFyYW1zLmFuaW1hdGlvbklkKV07CiAgICAgIGVuZW15ID0gU2NlbmVNYW5hZ2VyLnNjZW5lLmVuZW15U3ByaXRlc1t0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMuZW5lbXlJZCldOwogICAgICBpZiAoKGVuZW15ICE9IG51bGwpICYmIChhbmltYXRpb24gIT0gbnVsbCkpIHsKICAgICAgICBsb2dpYyA9IG5ldyBMb2dpY19BbmltYXRpb24oYW5pbWF0aW9uKTsKICAgICAgICBsb2dpYy5yZXBlYXQgPSB0aGlzLnBhcmFtcy5yZXBlYXQ7CiAgICAgICAgaWYgKHRoaXMucGFyYW1zLndhaXRGb3JDb21wbGV0aW9uKSB7CiAgICAgICAgICB0aGlzLmludGVycHJldGVyLmlzV2FpdGluZyA9IHRydWU7CiAgICAgICAgICBsb2dpYy5vbkZpbmlzaCA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICByZXR1cm4gX3RoaXMuaW50ZXJwcmV0ZXIuaXNXYWl0aW5nID0gZmFsc2U7CiAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgICBzcHJpdGVzZXQgPSBuZXcgU3ByaXRlc2V0X0FuaW1hdGlvbihsb2dpYyk7CiAgICAgICAgc3ByaXRlc2V0LnRhcmdldC54ID0gZW5lbXkuc3ByaXRlLng7CiAgICAgICAgc3ByaXRlc2V0LnRhcmdldC55ID0gZW5lbXkuc3ByaXRlLnk7CiAgICAgICAgc3ByaXRlc2V0LnRhcmdldC5zcHJpdGUgPSBlbmVteS5zcHJpdGU7CiAgICAgICAgR2FtZU1hbmFnZXIuYW5pbWF0aW9ucy5wdXNoKHNwcml0ZXNldCk7CiAgICAgICAgcmV0dXJuIGxvZ2ljLnN0YXJ0KCk7CiAgICAgIH0KICAgIH07CgogICAgQ29tbWFuZEludGVycHJldGVyLnByb3RvdHlwZS5zaG93QW5pbWF0aW9uID0gZnVuY3Rpb24oZXZlbnQsIHBhcmFtcykgewogICAgICB2YXIgYW5pbWF0aW9uLCBsb2dpYywgc3ByaXRlLCBzcHJpdGVzZXQsCiAgICAgICAgX3RoaXMgPSB0aGlzOwogICAgICBzd2l0Y2ggKHBhcmFtcy5hbmltYXRpb25UeXBlKSB7CiAgICAgICAgY2FzZSAwOgogICAgICAgICAgYW5pbWF0aW9uID0gUmVjb3JkTWFuYWdlci5zaW1wbGVBbmltYXRpb25zW3RoaXMubnVtYmVyVmFsdWVPZihwYXJhbXMuYW5pbWF0aW9uSWQpXTsKICAgICAgICAgIGlmICgoZXZlbnQgIT0gbnVsbCkgJiYgKGFuaW1hdGlvbiAhPSBudWxsKSkgewogICAgICAgICAgICBsb2dpYyA9IG5ldyBMb2dpY19TaW1wbGVBbmltYXRpb24oYW5pbWF0aW9uKTsKICAgICAgICAgICAgbG9naWMucmVwZWF0ID0gcGFyYW1zLnJlcGVhdDsKICAgICAgICAgICAgaWYgKHBhcmFtcy53YWl0Rm9yQ29tcGxldGlvbikgewogICAgICAgICAgICAgIHRoaXMuaXNXYWl0aW5nID0gdHJ1ZTsKICAgICAgICAgICAgICBsb2dpYy5vbkZpbmlzaCA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLmlzV2FpdGluZyA9IGZhbHNlOwogICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgc3ByaXRlID0gbmV3IFNwcml0ZV9TaW1wbGVBbmltYXRpb24obG9naWMsIFNjZW5lTWFuYWdlci5zY2VuZS5tYXAubWFwVmlld3BvcnQpOwogICAgICAgICAgICBzcHJpdGUudGFyZ2V0LnNwcml0ZSA9IFNjZW5lTWFuYWdlci5zY2VuZS5tYXAuZXZlbnRzQnlJZFtldmVudC5pZF07CiAgICAgICAgICAgIEdhbWVNYW5hZ2VyLmFuaW1hdGlvbnMucHVzaChzcHJpdGUpOwogICAgICAgICAgICByZXR1cm4gbG9naWMuc3RhcnQoKTsKICAgICAgICAgIH0KICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgMToKICAgICAgICAgIGFuaW1hdGlvbiA9IFJlY29yZE1hbmFnZXIuYW5pbWF0aW9uc1t0aGlzLm51bWJlclZhbHVlT2YocGFyYW1zLmFuaW1hdGlvbklkKV07CiAgICAgICAgICBpZiAoKGV2ZW50ICE9IG51bGwpICYmIChhbmltYXRpb24gIT0gbnVsbCkpIHsKICAgICAgICAgICAgbG9naWMgPSBuZXcgTG9naWNfQW5pbWF0aW9uKGFuaW1hdGlvbik7CiAgICAgICAgICAgIGxvZ2ljLnJlcGVhdCA9IHBhcmFtcy5yZXBlYXQ7CiAgICAgICAgICAgIGlmIChwYXJhbXMud2FpdEZvckNvbXBsZXRpb24pIHsKICAgICAgICAgICAgICB0aGlzLmlzV2FpdGluZyA9IHRydWU7CiAgICAgICAgICAgICAgbG9naWMub25GaW5pc2ggPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5pc1dhaXRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICB9OwogICAgICAgICAgICB9CiAgICAgICAgICAgIHNwcml0ZXNldCA9IG5ldyBTcHJpdGVzZXRfQW5pbWF0aW9uKGxvZ2ljLCBTY2VuZU1hbmFnZXIuc2NlbmUubWFwLm1hcFZpZXdwb3J0KTsKICAgICAgICAgICAgc3ByaXRlc2V0LnRhcmdldC54ID0gZXZlbnQueDsKICAgICAgICAgICAgc3ByaXRlc2V0LnRhcmdldC55ID0gZXZlbnQueTsKICAgICAgICAgICAgc3ByaXRlc2V0LnRhcmdldC5zcHJpdGUgPSBTY2VuZU1hbmFnZXIuc2NlbmUubWFwLmV2ZW50c0J5SWRbZXZlbnQuaWRdOwogICAgICAgICAgICBHYW1lTWFuYWdlci5hbmltYXRpb25zLnB1c2goc3ByaXRlc2V0KTsKICAgICAgICAgICAgcmV0dXJuIGxvZ2ljLnN0YXJ0KCk7CiAgICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgQ29tbWFuZEludGVycHJldGVyLnByb3RvdHlwZS5jb21tYW5kU2hvd0FuaW1hdGlvbkdsb2JhbEV2ZW50ID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBldmVudDsKICAgICAgaWYgKCFTY2VuZU1hbmFnZXIuc2NlbmUgaW5zdGFuY2VvZiBTY2VuZV9NYXApIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgZXZlbnQgPSB0aGlzLmludGVycHJldGVyLmdsb2JhbEV2ZW50QnlJZCh0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMuZXZlbnRJZCkpOwogICAgICByZXR1cm4gdGhpcy5pbnRlcnByZXRlci5zaG93QW5pbWF0aW9uKGV2ZW50LCB0aGlzLnBhcmFtcyk7CiAgICB9OwoKICAgIENvbW1hbmRJbnRlcnByZXRlci5wcm90b3R5cGUuY29tbWFuZFNob3dBbmltYXRpb25NYXBFdmVudCA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgZXZlbnQ7CiAgICAgIGlmICghU2NlbmVNYW5hZ2VyLnNjZW5lIGluc3RhbmNlb2YgU2NlbmVfTWFwKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGV2ZW50ID0gdGhpcy5pbnRlcnByZXRlci5ldmVudEJ5SWQodGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKHRoaXMucGFyYW1zLmV2ZW50SWQpKTsKICAgICAgcmV0dXJuIHRoaXMuaW50ZXJwcmV0ZXIuc2hvd0FuaW1hdGlvbihldmVudCwgdGhpcy5wYXJhbXMpOwogICAgfTsKCiAgICBDb21tYW5kSW50ZXJwcmV0ZXIucHJvdG90eXBlLmNvbW1hbmRDaGFuZ2VUZXh0U2V0dGluZ3MgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIG51bWJlciwgdGV4dFNwcml0ZSwgdGV4dHM7CiAgICAgIG51bWJlciA9IHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy5udW1iZXIpOwogICAgICB0ZXh0cyA9IEdhbWVNYW5hZ2VyLnRleHRzOwogICAgICBpZiAodGV4dHNbbnVtYmVyXSA9PSBudWxsKSB7CiAgICAgICAgdGV4dHNbbnVtYmVyXSA9IG5ldyBTcHJpdGVfVGV4dFBpY3R1cmUobmV3IExvZ2ljX1BpY3R1cmUoKSk7CiAgICAgICAgdGV4dHNbbnVtYmVyXS52aXNpYmxlID0gZmFsc2U7CiAgICAgIH0KICAgICAgdGV4dFNwcml0ZSA9IHRleHRzW251bWJlcl07CiAgICAgIHRleHRTcHJpdGUuZm9udCA9IG5ldyBGb250KHRoaXMuaW50ZXJwcmV0ZXIuc3RyaW5nVmFsdWVPZih0aGlzLnBhcmFtcy5mb250KSwgdGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKHRoaXMucGFyYW1zLnNpemUpKTsKICAgICAgdGV4dFNwcml0ZS5mb250LmNvbG9yID0gbmV3IENvbG9yKHRoaXMucGFyYW1zLmNvbG9yKTsKICAgICAgdGV4dFNwcml0ZS5mb250LmJvbGQgPSB0aGlzLnBhcmFtcy5ib2xkOwogICAgICB0ZXh0U3ByaXRlLmZvbnQuaXRhbGljID0gdGhpcy5wYXJhbXMuaXRhbGljOwogICAgICB0ZXh0U3ByaXRlLmZvbnQuYm9yZGVyID0gdGhpcy5wYXJhbXMub3V0bGluZTsKICAgICAgdGV4dFNwcml0ZS5mb250LmJvcmRlckNvbG9yID0gbmV3IENvbG9yKHRoaXMucGFyYW1zLm91dGxpbmVDb2xvcik7CiAgICAgIHRleHRTcHJpdGUuZm9udC5zaGFkb3cgPSB0aGlzLnBhcmFtcy5zaGFkb3c7CiAgICAgIHRleHRTcHJpdGUuZm9udC5zaGFkb3dDb2xvciA9IG5ldyBDb2xvcih0aGlzLnBhcmFtcy5zaGFkb3dDb2xvcik7CiAgICAgIHJldHVybiB0ZXh0U3ByaXRlLnJlZnJlc2goKTsKICAgIH07CgogICAgQ29tbWFuZEludGVycHJldGVyLnByb3RvdHlwZS5jb21tYW5kU2hvd1RleHQgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIG51bWJlciwgdGV4dCwgdGV4dFNwcml0ZSwgdGV4dHMsIHgsIHk7CiAgICAgIG51bWJlciA9IHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy5udW1iZXIpOwogICAgICB0ZXh0ID0gdGhpcy5pbnRlcnByZXRlci5zdHJpbmdWYWx1ZU9mKHRoaXMucGFyYW1zLnRleHQpOwogICAgICB0ZXh0cyA9IEdhbWVNYW5hZ2VyLnRleHRzOwogICAgICBpZiAodGV4dHNbbnVtYmVyXSA9PSBudWxsKSB7CiAgICAgICAgdGV4dHNbbnVtYmVyXSA9IG5ldyBTcHJpdGVfVGV4dFBpY3R1cmUobmV3IExvZ2ljX1BpY3R1cmUoKSk7CiAgICAgIH0KICAgICAgeCA9IHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy54KTsKICAgICAgeSA9IHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy55KTsKICAgICAgdGV4dFNwcml0ZSA9IHRleHRzW251bWJlcl07CiAgICAgIHRleHRTcHJpdGUudGV4dCA9IHRleHQ7CiAgICAgIHRleHRTcHJpdGUucmVmcmVzaCgpOwogICAgICB0ZXh0U3ByaXRlLnZpc2libGUgPSB0cnVlOwogICAgICB0ZXh0U3ByaXRlLmxvZ2ljLnggPSB0aGlzLnBhcmFtcy5vcmlnaW4gPT09IDAgPyB4IDogeCAtIHRleHRTcHJpdGUuYml0bWFwLndpZHRoIC8gMjsKICAgICAgdGV4dFNwcml0ZS5sb2dpYy55ID0gdGhpcy5wYXJhbXMub3JpZ2luID09PSAwID8geSA6IHkgLSB0ZXh0U3ByaXRlLmJpdG1hcC5oZWlnaHQgLyAyOwogICAgICB0ZXh0U3ByaXRlLmxvZ2ljLnpvb21YID0gdGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKHRoaXMucGFyYW1zLnNjYWxlWCkgLyAxMDA7CiAgICAgIHRleHRTcHJpdGUubG9naWMuem9vbVkgPSB0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMuc2NhbGVZKSAvIDEwMDsKICAgICAgcmV0dXJuIHRleHRTcHJpdGUueiA9IDIwMDsKICAgIH07CgogICAgQ29tbWFuZEludGVycHJldGVyLnByb3RvdHlwZS5jb21tYW5kTW92ZVRleHQgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIG51bWJlciwgcGljdHVyZXM7CiAgICAgIG51bWJlciA9IHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy5udW1iZXIpOwogICAgICBwaWN0dXJlcyA9IEdhbWVNYW5hZ2VyLnBpY3R1cmVzOwogICAgICBHYW1lTWFuYWdlci5waWN0dXJlcyA9IEdhbWVNYW5hZ2VyLnRleHRzOwogICAgICB0aGlzLmludGVycHJldGVyLmNvbW1hbmRNb3ZlUGljdHVyZS5jYWxsKHRoaXMpOwogICAgICByZXR1cm4gR2FtZU1hbmFnZXIucGljdHVyZXMgPSBwaWN0dXJlczsKICAgIH07CgogICAgQ29tbWFuZEludGVycHJldGVyLnByb3RvdHlwZS5jb21tYW5kUm90YXRlVGV4dCA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgbnVtYmVyLCBwaWN0dXJlczsKICAgICAgbnVtYmVyID0gdGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKHRoaXMucGFyYW1zLm51bWJlcik7CiAgICAgIHBpY3R1cmVzID0gR2FtZU1hbmFnZXIucGljdHVyZXM7CiAgICAgIEdhbWVNYW5hZ2VyLnBpY3R1cmVzID0gR2FtZU1hbmFnZXIudGV4dHM7CiAgICAgIHRoaXMuaW50ZXJwcmV0ZXIuY29tbWFuZFJvdGF0ZVBpY3R1cmUuY2FsbCh0aGlzKTsKICAgICAgcmV0dXJuIEdhbWVNYW5hZ2VyLnBpY3R1cmVzID0gcGljdHVyZXM7CiAgICB9OwoKICAgIENvbW1hbmRJbnRlcnByZXRlci5wcm90b3R5cGUuY29tbWFuZENvbG9yVGV4dCA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgZHVyYXRpb24sIG51bWJlciwgdGV4dDsKICAgICAgbnVtYmVyID0gdGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKHRoaXMucGFyYW1zLm51bWJlcik7CiAgICAgIHRleHQgPSBHYW1lTWFuYWdlci50ZXh0c1tudW1iZXJdOwogICAgICBkdXJhdGlvbiA9IHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy5kdXJhdGlvbik7CiAgICAgIGlmICh0ZXh0ICE9IG51bGwpIHsKICAgICAgICB0ZXh0LmxvZ2ljLmNvbG9yVG8obmV3IENvbG9yKHRoaXMucGFyYW1zLmNvbG9yKSwgZHVyYXRpb24pOwogICAgICAgIGlmICh0aGlzLnBhcmFtcy53YWl0Rm9yQ29tcGxldGlvbiAmJiAhKGR1cmF0aW9uID09PSAwKSkgewogICAgICAgICAgdGhpcy5pbnRlcnByZXRlci5pc1dhaXRpbmcgPSB0cnVlOwogICAgICAgICAgcmV0dXJuIHRoaXMuaW50ZXJwcmV0ZXIud2FpdENvdW50ZXIgPSBkdXJhdGlvbjsKICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgQ29tbWFuZEludGVycHJldGVyLnByb3RvdHlwZS5jb21tYW5kRXJhc2VUZXh0ID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBudW1iZXIsIHRleHQ7CiAgICAgIG51bWJlciA9IHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy5udW1iZXIpOwogICAgICB0ZXh0ID0gR2FtZU1hbmFnZXIudGV4dHNbbnVtYmVyXTsKICAgICAgaWYgKHRleHQgIT0gbnVsbCkgewogICAgICAgIHRleHQuZGlzcG9zZSgpOwogICAgICB9CiAgICAgIHJldHVybiBHYW1lTWFuYWdlci50ZXh0c1tudW1iZXJdID0gbnVsbDsKICAgIH07CgogICAgQ29tbWFuZEludGVycHJldGVyLnByb3RvdHlwZS5jb21tYW5kSW5wdXRUZXh0ID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIHRoaXMuaW50ZXJwcmV0ZXIuaXNXYWl0aW5nID0gdHJ1ZTsKICAgICAgaWYgKHRoaXMuaW50ZXJwcmV0ZXIuaXNQcm9jZXNzaW5nTWVzc2FnZUluT3RoZXJDb250ZXh0KCkpIHsKICAgICAgICB0aGlzLmludGVycHJldGVyLndhaXRGb3JNZXNzYWdlKCk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIEdhbWVNYW5hZ2VyLnBsYXllci5pc1BsYXllciA9IGZhbHNlOwogICAgICBpZiAoR2FtZU1hbmFnZXIuaW5wdXRUZXh0V2luZG93c2V0ICE9IG51bGwpIHsKICAgICAgICBHYW1lTWFuYWdlci5pbnB1dFRleHRXaW5kb3dzZXQuZGlzcG9zZSgpOwogICAgICB9CiAgICAgIEdhbWVNYW5hZ2VyLmlucHV0VGV4dFdpbmRvd3NldCA9IG5ldyBXaW5kb3dzZXRfSW5wdXRUZXh0KDkwICogV2luZG93X0Jhc2Uuc2NhbGUsIDAsIHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy5sZXR0ZXJzKSk7CiAgICAgIEdhbWVNYW5hZ2VyLmlucHV0VGV4dFdpbmRvd3NldC5leGVjdXRpb25Db250ZXh0ID0gdGhpcy5pbnRlcnByZXRlci5jb250ZXh0OwogICAgICBHYW1lTWFuYWdlci5pbnB1dFRleHRXaW5kb3dzZXQuZXZlbnQgPSBHYW1lTWFuYWdlci5tYXAuY3VycmVudEV2ZW50OwogICAgICBHYW1lTWFuYWdlci5pbnB1dFRleHRXaW5kb3dzZXQuZXZlbnQuaXNMb2NrZWQgPSB0cnVlOwogICAgICBHYW1lTWFuYWdlci5pbnB1dFRleHRXaW5kb3dzZXQub25BY2NlcHQgPSBmdW5jdGlvbih0ZXh0KSB7CiAgICAgICAgX3RoaXMuaW50ZXJwcmV0ZXIuc2V0U3RyaW5nVmFsdWVUbyhfdGhpcy5wYXJhbXMudmFyaWFibGUsIHRleHQpOwogICAgICAgIF90aGlzLmludGVycHJldGVyLmlzV2FpdGluZyA9IGZhbHNlOwogICAgICAgIEdhbWVNYW5hZ2VyLnBsYXllci5pc1BsYXllciA9IHRydWU7CiAgICAgICAgaWYgKCFfdGhpcy5pbnRlcnByZXRlci5pc01lc3NhZ2VDb21tYW5kKF90aGlzLmludGVycHJldGVyLnBvaW50ZXIsIF90aGlzLmludGVycHJldGVyLmNvbW1hbmRzKSkgewogICAgICAgICAgR2FtZU1hbmFnZXIubWVzc2FnZVdpbmRvdy5jbG9zZSgpOwogICAgICAgICAgcmV0dXJuIEdhbWVNYW5hZ2VyLmlucHV0VGV4dFdpbmRvd3NldC5ldmVudC5pc0xvY2tlZCA9IGZhbHNlOwogICAgICAgIH0KICAgICAgfTsKICAgICAgcmV0dXJuIEdhbWVNYW5hZ2VyLmlucHV0VGV4dFdpbmRvd3NldC5zaG93KHRydWUsIHRydWUpOwogICAgfTsKCiAgICBDb21tYW5kSW50ZXJwcmV0ZXIucHJvdG90eXBlLmNvbW1hbmRJbnB1dE5hbWUgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGFjdG9yLAogICAgICAgIF90aGlzID0gdGhpczsKICAgICAgdGhpcy5pbnRlcnByZXRlci5pc1dhaXRpbmcgPSB0cnVlOwogICAgICBpZiAodGhpcy5pbnRlcnByZXRlci5pc1Byb2Nlc3NpbmdNZXNzYWdlSW5PdGhlckNvbnRleHQoKSkgewogICAgICAgIHRoaXMuaW50ZXJwcmV0ZXIud2FpdEZvck1lc3NhZ2UoKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgR2FtZU1hbmFnZXIucGxheWVyLmlzUGxheWVyID0gZmFsc2U7CiAgICAgIGFjdG9yID0gUmVjb3JkTWFuYWdlci5hY3RvcnNbdGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKHRoaXMucGFyYW1zLmFjdG9ySWQpXTsKICAgICAgaWYgKEdhbWVNYW5hZ2VyLmlucHV0VGV4dFdpbmRvd3NldCAhPSBudWxsKSB7CiAgICAgICAgR2FtZU1hbmFnZXIuaW5wdXRUZXh0V2luZG93c2V0LmRpc3Bvc2UoKTsKICAgICAgfQogICAgICBHYW1lTWFuYWdlci5pbnB1dFRleHRXaW5kb3dzZXQgPSBuZXcgV2luZG93c2V0X0lucHV0VGV4dCg3MCAqIFdpbmRvd19CYXNlLnNjYWxlLCAwLCB0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMubGV0dGVycyksIGFjdG9yKTsKICAgICAgR2FtZU1hbmFnZXIuaW5wdXRUZXh0V2luZG93c2V0LmV4ZWN1dGlvbkNvbnRleHQgPSB0aGlzLmludGVycHJldGVyLmNvbnRleHQ7CiAgICAgIEdhbWVNYW5hZ2VyLmlucHV0VGV4dFdpbmRvd3NldC5ldmVudCA9IEdhbWVNYW5hZ2VyLm1hcC5jdXJyZW50RXZlbnQ7CiAgICAgIEdhbWVNYW5hZ2VyLmlucHV0VGV4dFdpbmRvd3NldC5ldmVudC5pc0xvY2tlZCA9IHRydWU7CiAgICAgIEdhbWVNYW5hZ2VyLmlucHV0VGV4dFdpbmRvd3NldC5vbkFjY2VwdCA9IGZ1bmN0aW9uKHRleHQpIHsKICAgICAgICBhY3RvciA9IFJlY29yZE1hbmFnZXIuYWN0b3JzW190aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YoX3RoaXMucGFyYW1zLmFjdG9ySWQpXTsKICAgICAgICBpZiAoYWN0b3IgIT0gbnVsbCkgewogICAgICAgICAgYWN0b3IubmFtZSA9IHRleHQ7CiAgICAgICAgfQogICAgICAgIF90aGlzLmludGVycHJldGVyLmlzV2FpdGluZyA9IGZhbHNlOwogICAgICAgIEdhbWVNYW5hZ2VyLnBsYXllci5pc1BsYXllciA9IHRydWU7CiAgICAgICAgaWYgKCFfdGhpcy5pbnRlcnByZXRlci5pc01lc3NhZ2VDb21tYW5kKF90aGlzLmludGVycHJldGVyLnBvaW50ZXIsIF90aGlzLmludGVycHJldGVyLmNvbW1hbmRzKSkgewogICAgICAgICAgR2FtZU1hbmFnZXIubWVzc2FnZVdpbmRvdy5jbG9zZSgpOwogICAgICAgICAgcmV0dXJuIEdhbWVNYW5hZ2VyLmlucHV0VGV4dFdpbmRvd3NldC5ldmVudC5pc0xvY2tlZCA9IGZhbHNlOwogICAgICAgIH0KICAgICAgfTsKICAgICAgcmV0dXJuIEdhbWVNYW5hZ2VyLmlucHV0VGV4dFdpbmRvd3NldC5zaG93KHRydWUsIHRydWUpOwogICAgfTsKCiAgICBDb21tYW5kSW50ZXJwcmV0ZXIucHJvdG90eXBlLmNvbW1hbmRDaGFuZ2VQbGF5ZXIgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGV2ZW50OwogICAgICBldmVudCA9IEdhbWVNYW5hZ2VyLmdsb2JhbEV2ZW50c0J5SWRbdGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKHRoaXMucGFyYW1zLmV2ZW50SWQpXTsKICAgICAgaWYgKGV2ZW50ICE9IG51bGwpIHsKICAgICAgICBHYW1lTWFuYWdlci5wbGF5ZXIuaXNQbGF5ZXIgPSBmYWxzZTsKICAgICAgICBldmVudC5pc1BsYXllciA9IHRydWU7CiAgICAgICAgcmV0dXJuIEdhbWVNYW5hZ2VyLnBsYXllciA9IGV2ZW50OwogICAgICB9CiAgICB9OwoKICAgIENvbW1hbmRJbnRlcnByZXRlci5wcm90b3R5cGUuY29tbWFuZENoYW5nZUdsb2JhbEV2ZW50VmlzaWJpbGl0eSA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgZXZlbnQ7CiAgICAgIGV2ZW50ID0gR2FtZU1hbmFnZXIuZ2xvYmFsRXZlbnRzQnlJZFt0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMuZXZlbnRJZCldOwogICAgICBpZiAoZXZlbnQgIT0gbnVsbCkgewogICAgICAgIGV2ZW50LnZpc2libGUgPSB0aGlzLnBhcmFtcy52aXNpYmlsaXR5ID09PSAwOwogICAgICAgIHJldHVybiBldmVudC50aHJvdWdoID0gdGhpcy5wYXJhbXMudmlzaWJpbGl0eSAhPT0gMDsKICAgICAgfQogICAgfTsKCiAgICBDb21tYW5kSW50ZXJwcmV0ZXIucHJvdG90eXBlLmNvbW1hbmRTY3JpcHQgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGV4OwogICAgICB0cnkgewogICAgICAgIHJldHVybiBldmFsKHRoaXMucGFyYW1zLnNjcmlwdCk7CiAgICAgIH0gY2F0Y2ggKF9lcnJvcikgewogICAgICAgIGV4ID0gX2Vycm9yOwogICAgICAgIHJldHVybiBjb25zb2xlLmxvZyhleCk7CiAgICAgIH0KICAgIH07CgogICAgQ29tbWFuZEludGVycHJldGVyLnByb3RvdHlwZS5jb21tYW5kRm9yY2VBY3Rpb24gPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGFjdG9yLCBiYXR0bGVyVmFsdWUsIGlkLCBpZHMsIHNjZW5lLCBza2lsbCwgdGFyZ2V0LCB1c2VyOwogICAgICBzY2VuZSA9IFNjZW5lTWFuYWdlci5zY2VuZTsKICAgICAgaWYgKHNjZW5lIGluc3RhbmNlb2YgU2NlbmVfQmF0dGxlKSB7CiAgICAgICAgc2tpbGwgPSBSZWNvcmRNYW5hZ2VyLnNraWxsc1t0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMuc2tpbGxJZCldOwogICAgICAgIHVzZXIgPSBudWxsOwogICAgICAgIHN3aXRjaCAodGhpcy5wYXJhbXMudXNlcikgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBiYXR0bGVyVmFsdWUgPSB0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMudXNlclZhbHVlKTsKICAgICAgICAgICAgdXNlciA9IGJhdHRsZXJWYWx1ZSA8IDQgPyBzY2VuZS5tZW1iZXJzW2JhdHRsZXJWYWx1ZV0gOiBzY2VuZS5lbmVtaWVzW2JhdHRsZXJWYWx1ZSAtIDRdOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgY29uc29sZS5sb2codGhpcy5wYXJhbXMpOwogICAgICAgICAgICBjb25zb2xlLmxvZyh0aGlzLnBhcmFtcy51c2VyVmFsdWUpOwogICAgICAgICAgICBjb25zb2xlLmxvZyh0aGlzLmludGVycHJldGVyLm51bWJlclZhbHVlT2YodGhpcy5wYXJhbXMudXNlclZhbHVlKSk7CiAgICAgICAgICAgIGFjdG9yID0gUmVjb3JkTWFuYWdlci5hY3RvcnNbdGhpcy5pbnRlcnByZXRlci5udW1iZXJWYWx1ZU9mKHRoaXMucGFyYW1zLnVzZXJWYWx1ZSldOwogICAgICAgICAgICBpZiAoYWN0b3IgIT0gbnVsbCkgewogICAgICAgICAgICAgIGlkcyA9IHNjZW5lLm1lbWJlcnMudG9Qcm9wZXJ0eUFycmF5KCJhY3RvciIpLnRvUHJvcGVydHlBcnJheSgiYWN0b3JJZCIpOwogICAgICAgICAgICAgIGlkID0gaWRzLmluZGV4T2YoYWN0b3IuaW5kZXgpOwogICAgICAgICAgICAgIGNvbnNvbGUubG9nKGFjdG9yKTsKICAgICAgICAgICAgICBjb25zb2xlLmxvZyhpZHMpOwogICAgICAgICAgICAgIGNvbnNvbGUubG9nKGlkKTsKICAgICAgICAgICAgICBpZiAoaWQgIT09IC0xKSB7CiAgICAgICAgICAgICAgICB1c2VyID0gc2NlbmUubWVtYmVyc1tpZF07CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHRhcmdldCA9IHRoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy50YXJnZXQpOwogICAgICAgIGlmICgoc2tpbGwgIT0gbnVsbCkgJiYgKHVzZXIgIT0gbnVsbCkpIHsKICAgICAgICAgIGlmICh0YXJnZXQgPT09IDApIHsKICAgICAgICAgICAgdGFyZ2V0ID0gdXNlci5sYXN0VGFyZ2V0IHx8IHNjZW5lLmVuZW1pZXNbMF07CiAgICAgICAgICB9IGVsc2UgaWYgKHRhcmdldCA9PT0gMSkgewogICAgICAgICAgICB0YXJnZXQgPSBzY2VuZS5tZW1iZXJzW01hdGgucm91bmQoTWF0aC5yYW5kb20oKSAqIChzY2VuZS5tZW1iZXJzLmxlbmd0aCAtIDEpKV07CiAgICAgICAgICB9IGVsc2UgaWYgKHRhcmdldCA9PT0gMikgewogICAgICAgICAgICB0YXJnZXQgPSBzY2VuZS5lbmVtaWVzW01hdGgucm91bmQoTWF0aC5yYW5kb20oKSAqIChzY2VuZS5lbmVtaWVzLmxlbmd0aCAtIDEpKV07CiAgICAgICAgICB9IGVsc2UgaWYgKHRhcmdldCA9PT0gMykgewogICAgICAgICAgICB0YXJnZXQgPSBzY2VuZS5iYXR0bGVyc1tNYXRoLnJvdW5kKE1hdGgucmFuZG9tKCkgKiAoc2NlbmUuYmF0dGxlcnMubGVuZ3RoIC0gMSkpXTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRhcmdldCA9IHRhcmdldCA8IDggPyBzY2VuZS5tZW1iZXJzW3RhcmdldCAtIDRdIDogc2NlbmUuZW5lbWllc1t0YXJnZXQgLSA4XTsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBzY2VuZS5mb3JjZUFjdGlvbihza2lsbCwgdXNlciwgdGFyZ2V0KTsKICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgQ29tbWFuZEludGVycHJldGVyLnByb3RvdHlwZS5jb21tYW5kQ2hhbmdlQmF0dGxlTXVzaWMgPSBmdW5jdGlvbigpIHsKICAgICAgaWYgKCh0aGlzLnBhcmFtcy5tdXNpYyAhPSBudWxsKSAmJiB0aGlzLnBhcmFtcy5tdXNpYy5uYW1lLmxlbmd0aCA+IDApIHsKICAgICAgICByZXR1cm4gR2FtZU1hbmFnZXIuYmF0dGxlTXVzaWMgPSB0aGlzLnBhcmFtcy5tdXNpYzsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gR2FtZU1hbmFnZXIuYmF0dGxlTXVzaWMgPSBudWxsOwogICAgICB9CiAgICB9OwoKICAgIENvbW1hbmRJbnRlcnByZXRlci5wcm90b3R5cGUuY29tbWFuZENoYW5nZUJhdHRsZVRlcnJhaW4gPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIHRlcnJhaW47CiAgICAgIHRlcnJhaW4gPSBSZWNvcmRNYW5hZ2VyLnRlcnJhaW5zW3RoaXMuaW50ZXJwcmV0ZXIubnVtYmVyVmFsdWVPZih0aGlzLnBhcmFtcy50ZXJyYWluSWQpXTsKICAgICAgaWYgKHRlcnJhaW4gIT0gbnVsbCkgewogICAgICAgIHJldHVybiBHYW1lTWFuYWdlci5iYXR0bGVUZXJyYWluID0gdGVycmFpbjsKICAgICAgfQogICAgfTsKCiAgICByZXR1cm4gQ29tbWFuZEludGVycHJldGVyOwoKICB9KSgpOwoKICB3aW5kb3cuQ29tbWFuZEludGVycHJldGVyID0gQ29tbWFuZEludGVycHJldGVyOwoKfSkuY2FsbCh0aGlzKTsK"},{"name":"Main","content":"# ===================================================================\n#\n#   Script: Main\n#   Created on: 2013-05-12                       1\n#\n# ===================================================================\n#\n#   Entry point of your game.\n#\n# ===================================================================\nif not window.$PARAMS? then window.$PARAMS = { resolution: { width: 640, height: 480 }}\n\n$(document).ready ->   \n    settings = GameStorage.getObject(\"settings\") || [0,0]\n    \n    if settings[0] == 1\n        window.Graphics = new Graphics_Canvas()\n        window.Renderer = window.Renderer_Canvas\n    else\n        window.Graphics = new Graphics_OpenGL()\n        window.Renderer = window.Renderer_OpenGL\n        \n    Texture2D.filter = settings[1]\n    \n    try\n        Graphics.initialize($PARAMS.resolution.width, $PARAMS.resolution.height, document.body)\n    catch # Canvas Fallback\n        window.Graphics = new Graphics_Canvas()\n        window.Renderer = window.Renderer_Canvas\n        Graphics.initialize($PARAMS.resolution.width, $PARAMS.resolution.height, document.body)\n        settings[0] = 1\n        GameStorage.setObject(\"settings\", settings)\n        \n    Input.initialize()\n    \n    Font.defaultSize = if Graphics.width == 320 then 9 else 18\n    Window_Base.scale = if Graphics.width == 320 then 0.5 else 1.0\n    Window.padding = if Graphics.width == 320 then 6 else 12\n    Windowset_Base.scale = if Graphics.width == 320 then 0.5 else 1.0\n  \n    #GameStorage.clear()\n\n    SceneManager.switchTo(new Scene_LanguageSelection())\n    window.startTime = new Date()\n    Graphics.onEachFrame => \n        SceneManager.update()\n        Graphics.frameCount++\n \n","compiledContent":"KGZ1bmN0aW9uKCkgewogIGlmICh3aW5kb3cuJFBBUkFNUyA9PSBudWxsKSB7CiAgICB3aW5kb3cuJFBBUkFNUyA9IHsKICAgICAgcmVzb2x1dGlvbjogewogICAgICAgIHdpZHRoOiA2NDAsCiAgICAgICAgaGVpZ2h0OiA0ODAKICAgICAgfQogICAgfTsKICB9CgogICQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCkgewogICAgdmFyIHNldHRpbmdzLAogICAgICBfdGhpcyA9IHRoaXM7CiAgICBzZXR0aW5ncyA9IEdhbWVTdG9yYWdlLmdldE9iamVjdCgic2V0dGluZ3MiKSB8fCBbMCwgMF07CiAgICBpZiAoc2V0dGluZ3NbMF0gPT09IDEpIHsKICAgICAgd2luZG93LkdyYXBoaWNzID0gbmV3IEdyYXBoaWNzX0NhbnZhcygpOwogICAgICB3aW5kb3cuUmVuZGVyZXIgPSB3aW5kb3cuUmVuZGVyZXJfQ2FudmFzOwogICAgfSBlbHNlIHsKICAgICAgd2luZG93LkdyYXBoaWNzID0gbmV3IEdyYXBoaWNzX09wZW5HTCgpOwogICAgICB3aW5kb3cuUmVuZGVyZXIgPSB3aW5kb3cuUmVuZGVyZXJfT3BlbkdMOwogICAgfQogICAgVGV4dHVyZTJELmZpbHRlciA9IHNldHRpbmdzWzFdOwogICAgdHJ5IHsKICAgICAgR3JhcGhpY3MuaW5pdGlhbGl6ZSgkUEFSQU1TLnJlc29sdXRpb24ud2lkdGgsICRQQVJBTVMucmVzb2x1dGlvbi5oZWlnaHQsIGRvY3VtZW50LmJvZHkpOwogICAgfSBjYXRjaCAoX2Vycm9yKSB7CiAgICAgIHdpbmRvdy5HcmFwaGljcyA9IG5ldyBHcmFwaGljc19DYW52YXMoKTsKICAgICAgd2luZG93LlJlbmRlcmVyID0gd2luZG93LlJlbmRlcmVyX0NhbnZhczsKICAgICAgR3JhcGhpY3MuaW5pdGlhbGl6ZSgkUEFSQU1TLnJlc29sdXRpb24ud2lkdGgsICRQQVJBTVMucmVzb2x1dGlvbi5oZWlnaHQsIGRvY3VtZW50LmJvZHkpOwogICAgICBzZXR0aW5nc1swXSA9IDE7CiAgICAgIEdhbWVTdG9yYWdlLnNldE9iamVjdCgic2V0dGluZ3MiLCBzZXR0aW5ncyk7CiAgICB9CiAgICBJbnB1dC5pbml0aWFsaXplKCk7CiAgICBGb250LmRlZmF1bHRTaXplID0gR3JhcGhpY3Mud2lkdGggPT09IDMyMCA/IDkgOiAxODsKICAgIFdpbmRvd19CYXNlLnNjYWxlID0gR3JhcGhpY3Mud2lkdGggPT09IDMyMCA/IDAuNSA6IDEuMDsKICAgIFdpbmRvdy5wYWRkaW5nID0gR3JhcGhpY3Mud2lkdGggPT09IDMyMCA/IDYgOiAxMjsKICAgIFdpbmRvd3NldF9CYXNlLnNjYWxlID0gR3JhcGhpY3Mud2lkdGggPT09IDMyMCA/IDAuNSA6IDEuMDsKICAgIFNjZW5lTWFuYWdlci5zd2l0Y2hUbyhuZXcgU2NlbmVfTGFuZ3VhZ2VTZWxlY3Rpb24oKSk7CiAgICB3aW5kb3cuc3RhcnRUaW1lID0gbmV3IERhdGUoKTsKICAgIHJldHVybiBHcmFwaGljcy5vbkVhY2hGcmFtZShmdW5jdGlvbigpIHsKICAgICAgU2NlbmVNYW5hZ2VyLnVwZGF0ZSgpOwogICAgICByZXR1cm4gR3JhcGhpY3MuZnJhbWVDb3VudCsrOwogICAgfSk7CiAgfSk7Cgp9KS5jYWxsKHRoaXMpOwo=","decoded":true}]},"summary":["name","type"]}